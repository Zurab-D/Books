
<!-- saved from url=(0088)https://www.pdf.investintech.com/preview/62f8a8ca-b0e7-11e7-8b44-002590d31986/index.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><style type="text/css" id="alertifyCSS">.alertify-logs>*{padding:12px 24px;color:#fff;box-shadow:0 2px 5px 0 rgba(0,0,0,.2);border-radius:1px}.alertify-logs>*,.alertify-logs>.default{background:rgba(0,0,0,.8)}.alertify-logs>.error{background:rgba(244,67,54,.8)}.alertify-logs>.success{background:rgba(76,175,80,.9)}.alertify{position:fixed;background-color:rgba(0,0,0,.3);left:0;right:0;top:0;bottom:0;width:100%;height:100%;z-index:2}.alertify.hide{opacity:0;pointer-events:none}.alertify,.alertify.show{box-sizing:border-box;transition:all .33s cubic-bezier(.25,.8,.25,1)}.alertify,.alertify *{box-sizing:border-box}.alertify .dialog{padding:12px}.alertify .alert,.alertify .dialog{width:100%;margin:0 auto;position:relative;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.alertify .alert>*,.alertify .dialog>*{width:400px;max-width:95%;margin:0 auto;text-align:center;padding:12px;background:#fff;box-shadow:0 2px 4px -1px rgba(0,0,0,.14),0 4px 5px 0 rgba(0,0,0,.098),0 1px 10px 0 rgba(0,0,0,.084)}.alertify .alert .msg,.alertify .dialog .msg{padding:12px;margin-bottom:12px;margin:0;text-align:left}.alertify .alert input:not(.form-control),.alertify .dialog input:not(.form-control){margin-bottom:15px;width:100%;font-size:100%;padding:12px}.alertify .alert input:not(.form-control):focus,.alertify .dialog input:not(.form-control):focus{outline-offset:-2px}.alertify .alert nav,.alertify .dialog nav{text-align:right}.alertify .alert nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button),.alertify .dialog nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button){background:transparent;box-sizing:border-box;color:rgba(0,0,0,.87);position:relative;outline:0;border:0;display:inline-block;-webkit-align-items:center;-ms-flex-align:center;-ms-grid-row-align:center;align-items:center;padding:0 6px;margin:6px 8px;line-height:36px;min-height:36px;white-space:nowrap;min-width:88px;text-align:center;text-transform:uppercase;font-size:14px;text-decoration:none;cursor:pointer;border:1px solid transparent;border-radius:2px}.alertify .alert nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button):active,.alertify .alert nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button):hover,.alertify .dialog nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button):active,.alertify .dialog nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button):hover{background-color:rgba(0,0,0,.05)}.alertify .alert nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button):focus,.alertify .dialog nav button:not(.btn):not(.pure-button):not(.md-button):not(.mdl-button):focus{border:1px solid rgba(0,0,0,.1)}.alertify .alert nav button.btn,.alertify .dialog nav button.btn{margin:6px 4px}.alertify-logs{position:fixed;z-index:1}.alertify-logs.bottom,.alertify-logs:not(.top){bottom:16px}.alertify-logs.left,.alertify-logs:not(.right){left:16px}.alertify-logs.left>*,.alertify-logs:not(.right)>*{float:left;-webkit-transform:translateZ(0);transform:translateZ(0);height:auto}.alertify-logs.left>.show,.alertify-logs:not(.right)>.show{left:0}.alertify-logs.left>*,.alertify-logs.left>.hide,.alertify-logs:not(.right)>*,.alertify-logs:not(.right)>.hide{left:-110%}.alertify-logs.right{right:16px}.alertify-logs.right>*{float:right;-webkit-transform:translateZ(0);transform:translateZ(0)}.alertify-logs.right>.show{right:0;opacity:1}.alertify-logs.right>*,.alertify-logs.right>.hide{right:-110%;opacity:0}.alertify-logs.top{top:0}.alertify-logs>*{box-sizing:border-box;transition:all .4s cubic-bezier(.25,.8,.25,1);position:relative;clear:both;-webkit-backface-visibility:hidden;backface-visibility:hidden;-webkit-perspective:1000;perspective:1000;max-height:0;margin:0;padding:0;overflow:hidden;opacity:0;pointer-events:none}.alertify-logs>.show{margin-top:12px;opacity:1;max-height:1000px;padding:12px;pointer-events:auto}</style>
<style type="text/css">
<!--
span.cls_002{font-family:Arial,serif;font-size:28.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_002{font-family:Arial,serif;font-size:28.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_003{font-family:Arial,serif;font-size:18.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_003{font-family:Arial,serif;font-size:18.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_005{font-family:Arial,serif;font-size:16.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_005{font-family:Arial,serif;font-size:16.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_006{font-family:Arial,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_006{font-family:Arial,serif;font-size:14.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_007{font-family:"Palatino Linotype Bold",serif;font-size:10.6px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_007{font-family:"Palatino Linotype Bold",serif;font-size:10.6px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_008{font-family:Arial,serif;font-size:20.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_008{font-family:Arial,serif;font-size:20.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_004{font-family:"Palatino Linotype",serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_004{font-family:"Palatino Linotype",serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_009{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_009{font-family:Arial,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_010{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_010{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_011{font-family:Arial,serif;font-size:30.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_011{font-family:Arial,serif;font-size:30.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_012{font-family:"Palatino Linotype Italic",serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_012{font-family:"Palatino Linotype Italic",serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_013{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_013{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_014{font-family:Arial,serif;font-size:18.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_014{font-family:Arial,serif;font-size:18.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_015{font-family:Arial,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_015{font-family:Arial,serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_016{font-family:Arial,serif;font-size:11.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_016{font-family:Arial,serif;font-size:11.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_017{font-family:Arial,serif;font-size:11.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_017{font-family:Arial,serif;font-size:11.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_018{font-family:"Palatino Linotype Bold",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_018{font-family:"Palatino Linotype Bold",serif;font-size:12.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_019{font-family:"Palatino Linotype Italic",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_019{font-family:"Palatino Linotype Italic",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_020{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_020{font-family:Courier New,serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_021{font-family:Arial,serif;font-size:100.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_021{font-family:Arial,serif;font-size:100.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_022{font-family:Arial,serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_022{font-family:Arial,serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_023{font-family:Arial,serif;font-size:16.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_023{font-family:Arial,serif;font-size:16.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_024{font-family:"Palatino Linotype Bold",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_024{font-family:"Palatino Linotype Bold",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_025{font-family:"Palatino Linotype",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_025{font-family:"Palatino Linotype",serif;font-size:10.1px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_026{font-family:Arial,serif;font-size:11.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_026{font-family:Arial,serif;font-size:11.1px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_027{font-family:Arial,serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
div.cls_027{font-family:Arial,serif;font-size:10.6px;color:rgb(0,0,0);font-weight:normal;font-style:italic;text-decoration: none}
span.cls_028{font-family:Arial,serif;font-size:10.6px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_028{font-family:Arial,serif;font-size:10.6px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_029{font-family:Arial,serif;font-size:13.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_029{font-family:Arial,serif;font-size:13.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_030{font-family:"Palatino Linotype Bold",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_030{font-family:"Palatino Linotype Bold",serif;font-size:9.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_031{font-family:"Palatino Linotype Bold",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_031{font-family:"Palatino Linotype Bold",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_032{font-family:"Palatino Linotype",serif;font-size:9.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_032{font-family:"Palatino Linotype",serif;font-size:9.6px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_033{font-family:"Palatino Linotype",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_033{font-family:"Palatino Linotype",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_034{font-family:"Palatino Linotype Bold",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_034{font-family:"Palatino Linotype Bold",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_035{font-family:Courier New,serif;font-size:9.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_035{font-family:Courier New,serif;font-size:9.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_036{font-family:"Palatino Linotype",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_036{font-family:"Palatino Linotype",serif;font-size:9.2px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_037{font-family:"Palatino Linotype Bold",serif;font-size:6.4px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_037{font-family:"Palatino Linotype Bold",serif;font-size:6.4px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_038{font-family:Courier New,serif;font-size:6.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_038{font-family:Courier New,serif;font-size:6.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_039{font-family:"Palatino Linotype",serif;font-size:6.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
div.cls_039{font-family:"Palatino Linotype",serif;font-size:6.4px;color:rgb(0,0,0);font-weight:normal;font-style:normal;text-decoration: none}
span.cls_040{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_040{font-family:Courier New,serif;font-size:10.1px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
span.cls_041{font-family:Arial,serif;font-size:16.3px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
div.cls_041{font-family:Arial,serif;font-size:16.3px;color:rgb(0,0,0);font-weight:bold;font-style:normal;text-decoration: none}
-->
</style>
<script type="text/javascript" src="./wz_jsgraphics.js"></script>
<style type="text/css">/*.lleo_errorSelection *::-moz-selection,
.lleo_errorSelection *::selection,
.lleo_errorSelection *::-webkit-selection {
    background-color: red !important;
    color: #fff !important;;
}*/

#lleo_dialog,
#lleo_dialog * {
    color: #000 !important;
    font: normal 13px Arial, Helvetica !important;
    line-height: 15px !important;
    margin: 0 !important;
	padding: 0 !important;
	background: none !important;
	border: none 0 !important;
	position: static !important;
	vertical-align: baseline !important;
	overflow: visible !important;
	width: auto !important;
	height: auto !important;
    max-width: none !important;
    max-height: none !important;
	float: none !important;
	visibility: visible !important;
	text-align: left !important;
    text-transform: none !important;
	border-collapse: separate !important;
	border-spacing: 2px !important;
    box-sizing: content-box !important;
    box-shadow: none !important;
    opacity: 1 !important;
    text-shadow: none !important;
    letter-spacing: normal !important;
    -webkit-filter: none !important;
    -moz-filter: none !important;
    filter: none !important;
}
#lleo_dialog *:before,
#lleo_dialog *:after {
    content: '';
}

#lleo_dialog iframe {
	height: 0 !important;
	width: 0 !important;
}

#lleo_dialog {
    position: absolute !important;
    background: #fff !important;
    border: solid 1px #ccc !important;
    padding: 7px 0 0 !important;
    left: -999px;
    top: -999px;
    width: 440px !important;
    overflow: hidden;
    display: block !important;
    z-index: 999999999 !important;
    box-shadow: 8px 16px 30px rgba(0, 0, 0, 0.16) !important;
    border-radius: 3px !important;
    opacity: 0 !important;
    -webkit-transform: translateY(15px);
    -moz-transform: translateY(15px);
    -ms-transform: translateY(15px);
    -o-transform: translateY(15px);
    transform: translateY(15px);
}
#lleo_dialog.lleo_show_small {
    width: 150px !important;
}
#lleo_dialog.lleo_show {
    opacity: 1 !important;
    -webkit-transform: translateY(0);
    -moz-transform: translateY(0);
    -ms-transform: translateY(0);
    -o-transform: translateY(0);
    transform: translateY(0);
    -webkit-transition: -webkit-transform 0.3s, opacity 0.3s !important;
    -moz-transition: -moz-transform 0.3s, opacity 0.3s !important;
    -ms-transition: -ms-transform 0.3s, opacity 0.3s !important;
    -o-transition: -o-transform 0.3s, opacity 0.3s !important;
    transition: transform 0.3s, opacity 0.3s !important;
}
#lleo_dialog.lleo_collapse {
    opacity: 0 !important;
    -webkit-transform: scale(0.25, 0.1) translate(-550px, 100px);
    -moz-transform: scale(0.25, 0.1) translate(-550px, 100px);
    -ms-transform: scale(0.25, 0.1) translate(-550px, 100px);
    -o-transform: scale(0.25, 0.1) translate(-550px, 100px);
    transform: scale(0.25, 0.1) translate(-550px, 100px);
    -webkit-transition: -webkit-transform 0.4s, opacity 0.4s !important;
    -moz-transition: -moz-transform 0.4s, opacity 0.4s !important;
    -ms-transition: -ms-transform 0.4s, opacity 0.4s !important;
    -o-transition: -o-transform 0.4s, opacity 0.4s !important;
    transition: transform 0.4s, opacity 0.4s !important;
}
#lleo_dialog input::-webkit-input-placeholder {
    color: #aaa !important;
}
#lleo_dialog .lleo_has_pic #lleo_word {
	margin-right: 80px !important;
}
#lleo_dialog #lleo_translationsContainer1 {
	position: relative !important;
}
#lleo_dialog #lleo_translationsContainer2 {
	padding: 7px 0 0 !important;
	vertical-align: middle !important;
}
#lleo_dialog #lleo_word {
    color: #000 !important;
    margin: 0 5px 2px 0 !important;
    /*float: left !important;*/
}
#lleo_dialog .lleo_has_sound #lleo_word {
    margin-left: 30px !important;
}
#lleo_dialog #lleo_text {
    font-weight: bold !important;
    color: #d56e00 !important;
    text-decoration: none !important;
    cursor: default !important;
}
/*
#lleo_dialog #lleo_text.lleo_known {
    cursor: pointer !important;
    text-decoration: underline !important;
}
*/
/*#lleo_dialog #lleo_closeBtn {
    position: absolute !important;
    right: 6px !important;
    top: 5px !important;
    line-height: 1px !important;
    text-decoration: none !important;
    font-weight: bold !important;
    font-size: 0 !important;
    color: #aaa !important;
    display: block !important;
	z-index: 9999999999 !important;
	width: 7px !important;
	height: 7px !important;
	padding: 0 !important;
	margin: 0 !important;
}*/

#lleo_dialog #lleo_optionsBtn {
    position: absolute !important; 
    right: 3px !important;
    top: 5px !important;
    line-height: 1px !important;
    text-decoration: none !important;
    font-weight: bold !important;
    font-size: 13px !important;
    color: #aaa !important;
    padding: 2px !important;
	display: none;
}
    #lleo_dialog.lleo_optionsShown #lleo_optionsBtn {
        display: block !important;
    }
    #lleo_dialog #lleo_optionsBtn img {
        width: 12px !important;
        height: 12px !important;
    }
#lleo_dialog #lleo_sound {
    float: left !important;
    width: 16px !important;
    height: 16px !important;
    margin-left: 9px !important;
    margin-right: 3px !important;
    background: 0 0 no-repeat !important;
    cursor: pointer !important;
    display: none !important;
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAfNJREFUeNq0U01IVFEU/u57Oo5WhBRIBBptykWLYBa2soWiEKQQEbrSFsGbVRQKQc2iFqGitXqvjQxCoCJCqyI0aBUtZILaJNUuYWYWo8HovJ/707nP94bnz0rxwvfOuefd8517fi5TSuE4i50YwZ3l37ZhNlpgzFkaaM/G9sHF1YskNrT+7l4PjMOcb78t2JL71uxgB+2UlfxHTtq5N94fIOh/88kWgWfl73ZCSQkpeGg3H091JY6dI2S00qA/N3KO3dDUYhFgEmZGurG+w9FqApIHsVM7kaTF9Nhn0r8Q7hPWQgIRuNaH3AMUA4W/Lkdh04cpFS43G0TgxQTvCdMETVAk3KynIHwXZU/ge8XDt7KH9bKLjU0P2zVO5LsEpSejVRJ9UR18EtfqKegovs9R3Q6w9c/H1o4Aa2Jwm1lIvn9RJ4w9RdRRzqcYrpwycCll4Cy1lnkS3Bc6vfBg28v8aRIfI78zhB/1GygROH3jLyyzMQ0zlUZuZBSlKkeLoegGtTjYLcJ8pF+NakHOFC2J6w+f25mxSfWrWFF/ShXVPTGvtN14NNkVnxlYWJkgZEL7/vwKr55lKSVnaGYWkuYgrgG172uUv47+U7fw0EHaJXmalUQy/HqO6lBzEsVjJC4Q8kd6TETQpjuaGOvjv8b/AgwA/ij1XMx58NIAAAAASUVORK5CYII=) !important;
}
#lleo_dialog .lleo_has_sound #lleo_sound {
    display: block !important;
}

#lleo_dialog #lleo_soundWave {
    border: solid 5px #4495CC !important;
    border-radius: 5px !important;
    position: absolute !important;
    left: -5px !important;
    top: -5px !important;
    right: -5px !important;
    bottom: -5px !important;
    z-index: 0 !important;
    opacity: 0.9 !important;
    display: none !important;
}
    #lleo_dialog #lleo_soundWave.lleo_beforePlaying {
        display: block !important;
    }
    #lleo_dialog #lleo_soundWave.lleo_playing {
        opacity: 0 !important;
        border-width: 20px !important;
        border-radius: 30px !important;

        -webkit-transform: scale(1.07,1.1) !important;
        -moz-transform: scale(1.07,1.1) !important;
        -ms-transform: scale(1.07,1.1) !important;
        transform: scale(1.07,1.1) !important;

        -webkit-transition: all 0.6s !important;
        -moz-transition: all 0.6s !important;
        -ms-transition: all 0.6s !important;
        transition: all 0.6s !important;
    }


#lleo_dialog #lleo_picOuter {
    position: absolute !important;
    float: right !important;
    top: 4px;
    right: 5px;
    z-index: 9 !important;
    display: none !important;
    width: 100px !important;
}
    #lleo_dialog.lleo_optionsShown #lleo_picOuter {
        right: 25px;
    }
#lleo_dialog .lleo_has_pic #lleo_picOuter {
    display: block !important;
}
    #lleo_dialog #lleo_picOuter:hover {
        width: auto !important;
        z-index: 11 !important;
    }
#lleo_dialog #lleo_pic,
#lleo_dialog #lleo_picBig {
    position: absolute !important;
    top: 0 !important;
    right: 0 !important;
    border: solid 2px #fff !important;
    -webkit-border-radius: 2px !important;
    -moz-border-radius: 2px !important;
	border-radius: 2px !important;
    z-index: 1 !important;
}
#lleo_dialog #lleo_pic {
	position: relative !important;
    border: none !important;
	width: 30px !important;
}
#lleo_dialog #lleo_picBig {
    box-shadow: -1px 2px 4px rgba(0,0,0,0.3);
    z-index: 2 !important;
    opacity: 0 !important;
    visibility: hidden !important;
}
    #lleo_dialog #lleo_picOuter:hover #lleo_picBig {
        visibility: visible !important;
        opacity: 1 !important;
        -webkit-transition: opacity 0.3s !important;
        -webkit-transition-delay: 0.3s !important;
    }
#lleo_dialog #lleo_transcription {
    margin: 0 80px 4px 31px !important;
    color: #aaaaaa !important;
}
#lleo_dialog .lleo_no_trans {
    color: #aaa !important;
}

#lleo_dialog .ll-translation-counter {
	float: right !important;
    font-size: 11px !important;
    color: #aaa !important;
    padding: 2px 2px 1px 10px !important;
}

#lleo_dialog .ll-translation-text {
	float: left !important;
	/*width: 80% !important;*/
}

#lleo_dialog #lleo_trans a {
    color: #3F669F !important;
    text-decoration: none !important;
    text-overflow: ellipsis !important;
    padding: 1px 4px !important;
    overflow: hidden !important;
    float: left !important;
    width: 320px !important;
}

#lleo_dialog .ll-translation-item {
    color: #3F669F !important;
    border: solid 1px #fff !important;
    padding: 3px !important;
    width: 100% !important;
    float: left !important;
	-moz-border-radius: 2px !important;
	-webkit-border-radius: 2px !important;
	border-radius: 2px !important;
}

#lleo_dialog .ll-translation-item:hover {
	border: solid 1px #9FC2C9 !important;
    background: #EDF4F6 !important;
	cursor: pointer !important;
}
#lleo_dialog .ll-translation-item:hover .ll-translation-counter {
	color: #83a0a6 !important;
}

#lleo_dialog .ll-translation-marker {
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAQAAAAECAYAAACp8Z5+AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAWSURBVBhXY7RPm/+fAQkwIXNAbMICAJQ8AkvqWg/SAAAAAElFTkSuQmCC) !important;
    display: inline-block !important;
    width: 4px !important;
    height: 4px !important;
    margin: 7px 5px 2px 2px !important;
    float: left !important;
}

#lleo_dialog #lleo_icons {
    color: #aaa !important;
    font-size: 11px !important;
    background: #f8f8f8 !important;
    padding: 10px 10px 10px 16px !important;
}
#lleo_icons a {
    display: inline-block !important;
    width: 16px !important;
    height: 16px !important;
    margin: 0 10px -4px 3px !important;
    text-decoration: none !important;
    opacity: 0.5 !important;
    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHIAAAAQCAYAAADK4SssAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAADopJREFUeNqsWQt0lNWd/33fzGQemUcmzwkhSkhYSSgpJJGVWHlEVEwLq0AFhC520xN0cfcUkHZ7QNetwfac6mp3oR5Ss8c9XaPVhoJCtGwSkYQglQBBNg/IgxBIQl7zyCSZ97f/e7+ZyeShpu7eM/fc797vu9/j/u7v93+MUqlUwuv1IlQ6Ojqk7u5utLaWo/nanfB45tbnsSI6GgsXLhQwpcx/9rCE/0PpOLSL39Pnh9TY2Y1NJXW4NeTFz59agp9uXASfYwR/Xv9dxJ6pxwJBhCIQoKtFuIUAXPRksyTx+U2rVy0TtdrywNhYeviFJAlSsJ1oJNY2ZdfVLeKdiGIb96Kqw45LvU40Dbj42F2mKNyXasCjGTGI0aqmvr6wdseL075fEORl6h+yYWzcDaNeh8Q4E7z0kVPLx//5Il0uTLqHQqGA3z/92qioKHg8Hn5/SZqYogwdOBwO6d19+9DQ0ADdqrmTJhesLML6nQ38uLj4jHSkuJi/a+Q1vd8QxORg6/dBUtDblLzbhBuuOIhJcfhl5QCeyB9DusWA3MO/hf2+e6FwjtFHKGj15Y8M0Cd0KQTpbr8kCBrNsaTn9iXoH3jga5/739nZC7Mj+n7aHBVNwwSUEhuy4rCR6m8vD9ID5MVyeAI4cPo2suI0KMpJgEoU+A5QiCKmg0jT6H49/cP4Tt4i/FXaHLS0d6O57RZ0WvXXvltaWhpOnz7NCbZ371588MEHHLQ9e/bwev78eTzzzDPo7+8PzxFDIO4rKOAgomHihq+9ckxgdd26dWHQSkuBvJ2lmLqTv2kJbQAGot/nw9U7xDa9CQHakY5xFd45f4OdhWZhFtz534GP9k9A9PPWIxGgAu2AgHwP79hYYseRI8q+f/832Kqr4O7t5bt6pioFAmIkiJXXrbCYtbg85MF1q5vv+IFxH6KUApSizLDsJB09F2i3yozoc3pn/CaBVKPr9gC+X3g/3ih5GruL1mPPjx7DwLCdA/x1xWKx4K677kJ6ejpWr14dHt+xYwdSUlKQl5cHvV4/aQ7/GMZEDiDVI9IF4asecqQ4FwzvnaWl/x84hhnJwFAKSiTFaCDS7ifhhEjMu9pJS0dg0SH8Bh28BKqCXSuRxAp+ApMAFBX8Hj6PR3G+uhrDFRXoeekltG3ZjOsbN6L7wH4M/O53GKEX97pc8NGGCckSW9ibdg9anBJqu0ZgpFvNM0ahf8yH75GU7siOx3aqIjHQS8+N0SiRGa/BhR4nLHpVhBSKfEN03erHny+3IinehBf+cQuqzzby8+1dfURuKSy5X1UMBkP4eM6cOfxdmdQuWrSIj7nd7mlAKquqqqTyVXtnvfCFhUkoRi4xswG7V7RIM9lMVvJJHoryM7Gr4hxcLisfO7m3EIcrm1HZ3DmNkYIo79RHFsfjbHMvlGozLTKBKSpJPhUQ3WRvmlpwO1mE1WCGygMk2pxIcHjhlfzBzSDbQ2Jb2C56Bwfhra2F40wtFxHRaMK899+nU/LzGGAvnR+ARSUTNDVaBTVRMI6AO3VjhMCRkGPRUQusutuABbFqDsaJ63akmtQEZhSf5xx1wWTU4eBPfoDBYQeSE818fOV9i/HZpVYcPPQeLPHmWQGZmJgYPmasZGXt2rUcTFaiyVeJBJszMgxi7uxZxFjJrn/tzBnef5MA6iwp4uCFyrjVhieXp6H5wIYw61ip2FUIjcYc7oeO227a2DKjeG0GFib74LPZoVf58NTKuSSiAkr/9CaeeMSFFQeWYsOPv4XCvVl44GdLsbVoMU5mmcLsCrUBWnneRlYa81qHJzHy983UJzBvOTy8ppvV/Nz+2j581GwjGZav27AwBp/dHsUgXcuY1TLgxns0N/y9LjdMhmisJuD+dkMB1j24jJ7jx5vvnsLT+98gJ8cHg147q/XNysoCcziHhoY4C1NTU7F582Y0NjZikDZmXFzcdGkt6f8IxReO/KWKKDAsS4P29EDZOVhJsqqDgC6NMeOSzQrzc+Uhr5SDvPHwOd4/vHF5WFYL0mL48fee/wBHP2lGkl6Dcy+vwVu70nHhYB7WLJmDX/ypFDsbf42erBTZmwPRkfTVRTJXnx2Ln27PnQCSFpm1UhA8KeDnAPI2OM6cCCnoxLzfYkP3qA/dTh/ujPuxxKJF7e0x1BIbB91+LErUYoDA23rsBk5ccyCRGHu224meMT+fGyrxsUb09VtBHiyy1/4DOm7ewcjoOF58vRz6aDUSyGP1zeCxzlSYnLa3t8NqtUKtVnM2LliwALWkLIyJbA00Gs1kaaVJQjD8mOa87H7uMT722LrdMzyOFq9BRrKPQMspeZsDU09AHn1ug7yLXzmKtANlKNtWyEF+tvwcHny1kh8XZBbBQvawzya7+MMuLX7063r85vhlFORasH/7CtouEk5f/xzPf/IykJFI8ubjVl3wqYJSSrbTEwi/ul+SJTUEaESowVuOHXUiGXnJ6oVRLTP50XkGREcp8M41GzpcPjycZICOJPdfzvXhf0a8+GGWnhwfAUdJVtvo/IhnAphAQOJ2Uh2lQrROgzlJsQRmHwFsQrRWQ8wOzJoljG03b97kjMzIyMDWrVu5XaypqcGWLVsQGxsLo9E43dmZzY1n64Ey4Ha9XcP7DFAG4qGT5/BqzSUcenI5Dm3L5+dqyA4yUPPpelZiFR7oozSov+7Cq+XXcKN/lBZbgfmxKchIzyEL74JIjqboVxIkBCAtnAAVj4Ek0SMvZnCxQrLqj6wRUhsJJK097rj8vK4hG+ghKX2fgGL9VanRXEb/i5jH+o/ON5LDI6G8Ve6LX2LuEgg8jVqFnjvD8Hh9s7KLkxzA5GR88cUXOH78OO8zz5W998mTJ9HZ2Ul+g8jlNfK+XwlkKPzIzc2d4U0aJtlVJqche8ecmRCgBZnJxNInZfDoJTItMSSxlSh6uxL1nRNOj9c2iLlaN9bnxeMHaxfC5qAQgZ6aGpeMs1tK8XD8CkhjTlpYGiSAA4LMQ84yr2qatPpD8uqPlFm55dIaBHLzPSZIPgksuls334CaW04MkcyKBOg6Au6znjH0EBtTSMbvn6NDzQ0HOUh+PofNjSzs3g7nOCwJsrnout0fTkR8qY2aAWSz2Qyn0ymHg8HS3NzMEwHDw8Nhh2fGhMBfUljcyexjcQSQjH0hqXz7Inmml3oJOBsHtDAzDYe3FfDz5ec6Z/RaS/YU4KHcxYgzi/DZmzA8dAZdl3uQnLEJ8YYEnNj0Ov7mvT34uLcaUhTJip88WWJWIKAIpyZC3ioHjR1JEZmdCImNZGTx4jiUXbWjMM0IA8lqxXUHD+hXpuoRr1Xil239fLGfINBEan9P7BQ4FQU+V3aOJc4+pVKBzu4+PLWpgI9/WPM5OTi6aVmYyDJ1XKvVchvIWNfa2gqbzYaYmBhcvHiRn3e5XOHMzyQb+U2A3PfudU7I3btXhMeYPczJSkOaRYNtOZnYW7A0bP8YsCWVsrQeICbOFEduLfg2nIONuHz8aZhxBUrVGJRuEZ3XDiHlwT/CGJuOfy3Yi7r/uIIRkmGFjxYnwLIItKi+CSC5LQy24TWakqbjqa/gcS45M0uTNBwoJpvH2x3cS348w8gX+Xib3P/+PTFw+wI41j7C+0voO9lcbt/tTjz+yHIUrs6Fj+59b/YCUpRR2Kk6yeFhVU92U6OO4naUybXb4+XjLHUXWZhkqlQqDhh7z7a2Np4AuHr1aohE4ViTpVfZpvxGQL5UeYfHkCxLFxlDMi/1Ur0cLx44Ws9ldlvOBLAhtvZ+SWbHHRhFa/VOpBvPw2RmwTUF/14JmsEm9NfthmH9CdwTfzcs0YkYcXXCz9ItBKKKHB+fT86weP3+PkLMEo4jg6yMBDEEZIgJbOdXbUjD65eHUHumD0PjPs7wJqsb/1TXh3aKU1MMKiwjb/bDNjtsJKkatYC3Hkrhc/kmXrscP3tmEy43dWJJlhyCMafnk3cO4sKVNlTXX+FMHbQ64HJ7OaCW+Bjk52by8cgyb948XkdGRnifAUjrzG0jT3oEgWN2NDIXq4w0ebMpDMTcXBZLFn9lnpUlAcoigC3Kz+GMZACHEgSRcaTH3g+97xY0qhiMkI0SfGQH6T112lj4XbcheEcxLkbD5RylhVaRrEaRnfSSp+oPhxIdbvezGqWyjEAyRUrWVCBd4+PSRbf79KaQTSL79/cUxtxf0SknSlmsfMUatmHLLDouq0eJrfPj1PjNymSYVBPuhdmkD4cgpz+7ircqqqEimd3+2Cqs/OtvIS87I3zt6JiLJxkYCMyeNkaYGZ5YINtYVVUVls6ysjJuGxn7WDl16hQHmkkua0MAh4H8lb0G+0wFM4PX0BBeBQZiza+2TEqaJ0eAGQpBJuUOYyZinpzkGHJyrNOeoY2ZB3XCGowOV0Cp0/HQQylEwT+ugHrOOrKLenz4+cfosfdCMJDdYZkZryh7qpKcXdnZ1VXBcg4/TkwUF2k0+00KxaNmhSJPIQiT/rLoaGv7/BeDgw+9HDGWpFOh5ckM/KFjBD+pv4MeZ5C19BOVMmiPLzDhlRXJaOwdxVxj9IR/8FE9zl9q5Uy7eq0LNvsoHz97oYXCEDOSE8xIosrklaX6HCNj6O4d4uHJ1MKcmhdeeAF2u5336+rqOOgh23jixAlcuXJlGiOFqX9jsfLpp59Kxz58jXutISCZB7Vq6WZsvdc0499Y1iDTmPe6sYAko09+cC8Ftb29cuBcUrQcyVoz8l+ZsJNmmhP+G2t0SLI1vg6l/QuI3jEEVBqoLQ9DsbgILT19+O4bu3BLHKDFoLCA7SOJZEZSQTpY86X+/TK9XvmEyfR30aK4MUWjyffpdM4NjY2RyaZpXgizsSPeAKxuOZwxq0Wyj360DpFtpsvvm6sPyypbwzXbn5eYTWS206jXUhCv4gLA7sOk1OX2kE1kGaEAv4Y5RVq6RqtR8+OP3vrnaX9jRXq1kvT1/0/8rwADAJ+LRelLmVNwAAAAAElFTkSuQmCC) !important;
}
#lleo_icons a:hover {
    opacity: 1 !important;
}
#lleo_icons a.lleo_google     {background-position:-34px 0 !important;}
#lleo_icons a.lleo_multitran  {background-position:-64px 0 !important;}
#lleo_icons a.lleo_lingvo     {background-position:-51px 0 !important; width: 12px !important;}
#lleo_icons a.lleo_dict       {background-position:-17px 0 !important;}
#lleo_icons a.lleo_linguee    {background-position:-81px 0 !important;}
#lleo_icons a.lleo_michaelis  {background-position:-98px 0 !important;}

#lleo_dialog #lleo_contextContainer {
    margin: 0 !important;
    padding: 3px 15px 8px 10px !important;
    background: #eee !important;
    background: -webkit-gradient(linear, left top, left bottom, from(#fff), to(#eee)) !important;
    background: -moz-linear-gradient(-90deg, #fff, #eee) !important;
    border-bottom: solid 1px #ddd !important;
    border-top-left-radius: 3px !important;
    border-top-right-radius: 3px !important;
    display: none !important;
    overflow: hidden !important;
}
#lleo_dialog .lleo_has_context #lleo_contextContainer {
    display: block !important;
}
#lleo_dialog #lleo_context {
    color: #444 !important;
    text-shadow: 1px 1px 0 #f4f4f4 !important;
    line-height: 12px !important;
    font-size: 11px !important;
    margin-left: 2px !important;
}
#lleo_dialog #lleo_context b {
    line-height: 12px !important;
    color: #000 !important;
    font-weight: bold !important;
    font-size: 11px !important;
}
/*#lleo_dialog #lleo_gBrand {
    color: #aaa !important;
    font-size: 10px !important;
    *//*padding-right: 52px !important;*//*
    padding-bottom: 14px !important;
    margin: -3px 4px 0 4px !important;
    background: left bottom url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADMAAAAPCAYAAABJGff8AAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAcVSURBVHja3FZrbFTHFT4z97W++/KatfHGNrFjMNjFLQ24iiVIFBzCD1SFqj/aRlCUCvjRKlVatUFJVJJGNKUtoRVqgZZWKWCVOEqKQxsaUoypaWzclNgGI9sLtndZv9beh/d133ems3ZAvKTGkfqnZ3U1d++9M+d88535zkGUUsjbpl/PgixiEEz05aHLIzsjo9cwIrrEy4EA7ypLm8rMAX2q850cYGMtmoD3tKOgYwF0QDAUjcFwwoLG33ih5hkZIJwFGjMA8QDRaQuCIzb0ZtbCMe00oCRbwUIwU7EHwo4jYFs6VASWPb3cv+yP7SfO9RCNNFIByLMpB+ybKIRoLgeXZhKweYrAfzP+1h3CABY90n/unafCwSs/xJK7BfMOzVZjq2w92WJlbhyzLeWSyXuCTXgMOKDsh2Dhlp9HoF57DdzTX4H4kteh5iHtzcRo8ph9XQ+DwZFGJME+RQYq5b/99HYLjNch7gi2t35roOONNQX+mh4kF7GnGDjnA70sgCe0eG+tIlcGX3F0wwtSN+gqBwJGvEXBumdVti9ImB/vNcT2DQHBGriMBkh17QZH7dFCgetBbIcywOa9Cm4QecSYx3dsV3Nz8x3Ytm7dio4fP063bNmC4HZ3BWrqpyN950d5qaDHVqeA2gZw8mLgRA9YBCKGDR+8zF2E3eg8AOdoCFuo+YpitswiboAFtwvNb/qcaTmy5+qg3XwjQi7YBLUjBCXsmmMSIbrZUJKHBWr2muZYRyo0vSfWV+YkyMx/YTTZPDyBCh68QeAP/ap5WuX4fobrsZvB3z7mgdyXmeRUvEjTjE5O8gIlBmDRC2LRKigp8QClOSguRfCj0PcZatejHYb455ORxPZaEf5azaOXRET3ahQWUQk9r+fMjgOHVFvg6FN11dhbGYB+SuBaVud8HhHvGx88tT6RMp6JzXxhmZ6OrqfGwC98KyZT0excfPqLgs8R5jwdhyMTr22Q8W+9Dn4kTLi/s3fi3RzfZOa2hJi3gZCKBLnIxzmK2Mb7GRgPEGqBIIpQXl4OevVGeEt+EqDI/7v3QxPaoGa38hxn1RRwP17sdk/lOP67KpiPDX6YXXuxj758I4rSdVUQKSuGnU4ZPMkk3u3Skjsmr3V/bKszPQW+qiZPcSWxcvHtlpJJ2wyLm6DMGm9g54V4ungltj+u9chHuhRytU0hz88Rz8Qqn1J3j/cwkzF4Q3AvedhWoiyneeCdFWy2hU1d28YU5nFJkMUDeN17681gqUPJqH6OvRYlKA34wXR5O1EytDkXy2xi5wgFSpDM0p2RiMBVAmcWpYAmppOrr03FbVxY2+T2+WFJpQ/S4YgWSV8PIsEp2jr7HsAmNl7m0BVp2rbrT0TTb4YNu83xKXXmFjPsjJzmPVUyO/B7BV8dcAV+luGUnwr1jWcS0Wh8bORryvC7Femh/qElmCwu5ZHopDZjTgC5QMJjBNRYkrQWOimw1Pp6KdMP4mCIy0QlqWM6Ebp+fna8+3uUcwcKS1e0SJA7ef1fred8n1NfKFwqFCMm12lKudDw8PulShbnCC0ux7TtG4US7PDghYGxlcltQEiMd5bt4pyB/VhwA5aKDW9p/QfVdStPg5mBYZ1a/0yYO/xg05US6lhOdNlOxus+ikw29s5mfjadQJ1ZBf5dXQFbH6lHG3wcOIwkPnyqjUYsPXvI70dviCKDL8o0MtS/WbeLXi1cvdrSxLTTMgykPcDV/bwq027o6vgKgdtbJ6L9tRK31oXhyQVJM2MmTW2tiuiJvyB1+jvUSD+NJX+fDtLkR13dZZNXT13NYv5iO//g5U1a/7o4gV8FLTgRiqu5M+nULpuQoyYTpFSWNiTT8HtVh59Ajx0cGNazlwfg8/rqXyqLH9pW4ghNfns2HiWZWNx2V6zqivWHvho50zKk902eRYQzTnwRL60ds2r8YfLuoE2+KepGk0DooYaFgMnrP9PNLLXVx830iGzMXGpkuexVxMKJuGUErVQkgbAEBpkTlc4khS/N6hREU2PPWIlAedllVLNLN2H7xAyFmQSBVAbBbP1+sKufexRGPzw52vW34xZFe4Cil6TihzshLv4JTq5zEmfrBjYTwMRAWFQKhQ1X9HzRNKFeRAsrmncUNcQrFKG2ucrAOgOOF8BmopCvI+iTYpLPT475EBgCfJevPCieoyCxIxP2vQIZx7MQ0FKv9/VdELRc/DlP5UZwuIqgYNHSjYmBtzvpoOqSXI9k9eWd833FnJ/82vPx4IV2APcDBZ+pXflkYUxhXK+BsxOb2L8eiFLrHyq3ZI1nacNBuaT+oNPBs7oZfdFIDbeAhLOcUQZcrhwIGv3Mfnn4H1k+HMVwQTY1zdoelj6U/MA2ZmcBcVu0xOAazUiMqTN9Z3U1cRALMiBbuF9dXJjPm13z/4P9R4ABANu4bb16FOo4AAAAAElFTkSuQmCC) no-repeat !important;
    display: inline-block !important;
    float: right !important;
}
#lleo_dialog #lleo_gBrand.hidden {
    display: none !important;
}*/
#lleo_dialog #lleo_translateContextLink {
    color: #444 !important;
    text-shadow: 1px 1px 0 #f4f4f4 !important;
    background: -webkit-gradient(linear, left top, left bottom, from(#f4f4f4), to(#ddd)) !important;
    background: -moz-linear-gradient(-90deg, #f4f4f4, #ddd) !important;
    border: solid 1px !important;
    box-shadow: 1px 1px 0 #f6f6f6 !important;
    border-color: #999 #aaa #aaa #999 !important;
    -moz-border-radius: 2px !important;
	-webkit-border-radius: 2px !important;
	border-radius: 2px !important;
    padding: 0 3px !important;
    font-size: 11px !important;
    text-decoration: none !important;
    margin: 1px 5px 0 !important;
    display: inline-block !important;
    white-space: nowrap !important;
}
#lleo_dialog #lleo_translateContextLink:hover {
    background: #f8f8f8 !important;
}
#lleo_dialog #lleo_translateContextLink.hidden {
    visibility: hidden !important;
}

#lleo_dialog #lleo_setTransForm {
    display: block !important;
    margin-top: 3px !important;
    padding-top: 5px !important;
    /* Set position and background because the form might be overlapped by an image when no translations */
    position: relative !important;
    background: #fff !important;
    z-index: 10 !important;
    padding-bottom: 10px !important;
    padding-left: 16px !important;
}
#lleo_dialog .lleo-custom-translation {
    padding: 4px 5px !important;
    border: solid 1px #ddd !important;
	border-radius: 2px !important;
    width: 90% !important;
    min-width: 270px !important;
    background: -webkit-gradient(linear, 0 0, 0 20, from(#f1f1f1), to(#fff)) !important;
    background: -moz-linear-gradient(-90deg, #f1f1f1, #fff) !important;
	font: normal 13px Arial, Helvetica !important;
	line-height: 15px !important;
}
#lleo_dialog .lleo-custom-translation:hover {
    border: solid 1px #aaa !important;
}
#lleo_dialog .lleo-custom-translation:focus {
    background: #FFFEC9 !important;
}

#lleo_dialog *.hidden {
    display: none !important;
}

#lleo_dialog .infinitive{
    color: #D56E00 !important;
    text-decoration: none;
    border-bottom: 1px dotted #D56E00 !important;
}
#lleo_dialog .infinitive:hover{
    border: none !important;
}

#lleo_dialog .lleo_separator {
    height: 1px !important;
    background: #eee;
    margin-top: 10px !important;
    background: -webkit-linear-gradient(left, rgba(255,255,255,1) 0%,#eee 8%,rgba(255,255,255,1) 80%) !important;
    background: -moz-linear-gradient(left, rgba(255,255,255,1) 0%, #eee 8%, rgba(255,255,255,1) 80%) !important;
    background: -ms-linear-gradient(left, rgba(255,255,255,1) 0%,#eee 8%,rgba(255,255,255,1) 80%) !important;
    background: linear-gradient(to right, rgba(255,255,255,1) 0%,#eee 8%,rgba(255,255,255,1) 80%) !important;
}
#lleo_dialog #lleo_trans {
    /*border-top: 1px solid #eeeeee !important;*/
    padding: 5px 30px 0 14px !important;
    zoom: 1;
}

#lleo_dialog .lleo_clearfix {
	display: block !important;
	clear: both !important;
	visibility: hidden !important;
	height: 0 !important;
	font-size: 0 !important;
}


#lleo_dialog #lleo_picOuter table {
    width: 44px !important;
    position: absolute !important;
    right: 0 !important;
    top: 0 !important;
    vertical-align: middle !important;
}

#lleo_dialog #lleo_picOuter td {
    width: 38px !important;
    height: 38px !important;
    /*border: 1px solid #eeeeee !important;*/
    vertical-align: middle !important;
    text-align: center !important;
}

#lleo_dialog #lleo_picOuter td div {
	height: 38px !important;
	overflow: hidden !important;
}

#lleo_dialog .lleo_empty {
    margin: 0 5px 7px !important;
}

#lleo_youtubeExportBtn {
    margin-left: 10px;
    height: 24px;
}
    #lleo_youtubeExportBtn i {
        display: inline-block;
        width: 16px;
        height: 16px;
        background: 0 0 url(https://d144fqpiyasmrr.cloudfront.net/plugins/all/images/i16.png) !important;
    }
    #lleo_youtubeExportBtn .yt-uix-button-content {
        font-size: 12px;
        line-height: 2px;
    }


/*** Parsed Lyrics Content *****************************/

.lleo_lyrics tran {
    background: transparent !important;
    border-radius: 2px !important;
    text-shadow: none !important;
    cursor: pointer !important;
}
    .lleo_lyrics tran:hover {
        color: #fff !important;
        background: #C77213 !important;
        -webkit-transition: all 0.1s !important;
        -moz-transition: all 0.1s !important;
        -ms-transition: all 0.1s !important;
        -o-transition: all 0.1s !important;
        transition: all 0.1s !important;
    }

.lleo_songName {
    border: solid 1px #ffd47c;
    background: #fff1c2;
    border-radius: 2px;
}

.lleo_hidden_iframe {
    visibility: hidden;
}</style></head>
<body class="vsc-initialized">
<div style="position:absolute;left:50%;margin-left:-270px;top:0px;width:540px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background001.jpg" width="540" height="666"></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:676px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background002.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:70.28px" class="cls_002"><span class="cls_002">Alfresco One 5.x Developer’s</span></div>
<div style="position:absolute;left:56.69px;top:108.58px" class="cls_002"><span class="cls_002">Guide</span></div>
<div style="position:absolute;left:56.69px;top:162.21px" class="cls_003"><span class="cls_003">Second Edition</span></div>
<div style="position:absolute;left:56.69px;top:273.80px" class="cls_005"><span class="cls_005">Discover what it means to be an expert developer by</span></div>
<div style="position:absolute;left:56.69px;top:295.68px" class="cls_005"><span class="cls_005">exploring the latest features available to you in Alfresco One</span></div>
<div style="position:absolute;left:56.69px;top:317.57px" class="cls_005"><span class="cls_005">5.x</span></div>
<div style="position:absolute;left:56.69px;top:404.29px" class="cls_006"><span class="cls_006">Benjamin Chevallereau</span></div>
<div style="position:absolute;left:56.69px;top:423.44px" class="cls_006"><span class="cls_006">Jeff Potts</span></div>
<div style="position:absolute;left:56.69px;top:558.18px" class="cls_007"><span class="cls_007">BIRMINGHAM - MUMBAI</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:1352px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background003.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Alfresco One 5.x Developer’s Guide</span></div>
<div style="position:absolute;left:56.69px;top:107.55px" class="cls_005"><span class="cls_005">Second Edition</span></div>
<div style="position:absolute;left:56.69px;top:151.86px" class="cls_004"><span class="cls_004">Copyright © 2017 Packt Publishing</span></div>
<div style="position:absolute;left:56.69px;top:195.06px" class="cls_004"><span class="cls_004">All rights reserved. No part of this book may be reproduced, stored in a retrieval system, or</span></div>
<div style="position:absolute;left:56.69px;top:207.66px" class="cls_004"><span class="cls_004">transmitted in any form or by any means, without the prior written permission of the</span></div>
<div style="position:absolute;left:56.69px;top:220.26px" class="cls_004"><span class="cls_004">publisher, except in the case of brief quotations embedded in critical articles or reviews.</span></div>
<div style="position:absolute;left:56.69px;top:241.86px" class="cls_004"><span class="cls_004">Every effort has been made in the preparation of this book to ensure the accuracy of the</span></div>
<div style="position:absolute;left:56.69px;top:254.46px" class="cls_004"><span class="cls_004">information presented. However, the information contained in this book is sold without</span></div>
<div style="position:absolute;left:56.69px;top:267.06px" class="cls_004"><span class="cls_004">warranty, either express or implied. Neither the authors, nor Packt Publishing, and its</span></div>
<div style="position:absolute;left:56.69px;top:279.66px" class="cls_004"><span class="cls_004">dealers and distributors will be held liable for any damages caused or alleged to be caused</span></div>
<div style="position:absolute;left:56.69px;top:292.26px" class="cls_004"><span class="cls_004">directly or indirectly by this book.</span></div>
<div style="position:absolute;left:56.69px;top:313.86px" class="cls_004"><span class="cls_004">Packt Publishing has endeavored to provide trademark information about all of the</span></div>
<div style="position:absolute;left:56.69px;top:326.46px" class="cls_004"><span class="cls_004">companies and products mentioned in this book by the appropriate use of capitals.</span></div>
<div style="position:absolute;left:56.69px;top:339.06px" class="cls_004"><span class="cls_004">However, Packt Publishing cannot guarantee the accuracy of this information.</span></div>
<div style="position:absolute;left:56.69px;top:360.66px" class="cls_004"><span class="cls_004">First published: October 2008</span></div>
<div style="position:absolute;left:56.69px;top:382.26px" class="cls_004"><span class="cls_004">Second edition: February 2017</span></div>
<div style="position:absolute;left:56.69px;top:403.86px" class="cls_004"><span class="cls_004">Production reference: 1220217</span></div>
<div style="position:absolute;left:56.69px;top:425.54px" class="cls_009"><span class="cls_009">Published by Packt Publishing Ltd.</span></div>
<div style="position:absolute;left:56.69px;top:437.85px" class="cls_009"><span class="cls_009">Livery Place</span></div>
<div style="position:absolute;left:56.69px;top:450.16px" class="cls_009"><span class="cls_009">35 Livery Street</span></div>
<div style="position:absolute;left:56.69px;top:462.48px" class="cls_009"><span class="cls_009">Birmingham</span></div>
<div style="position:absolute;left:56.69px;top:474.79px" class="cls_009"><span class="cls_009">B3 2PB, UK.</span></div>
<div style="position:absolute;left:56.69px;top:487.02px" class="cls_004"><span class="cls_004">ISBN 978-1-78712-816-3</span></div>
<div style="position:absolute;left:56.69px;top:507.94px" class="cls_010"><span class="cls_010"> </span><a href="http://www.packtpub.com/">www.packtpub.com</a> </div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:2028px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background004.jpg" width="541" height="666"></div>
<div style="position:absolute;left:389.71px;top:69.12px" class="cls_011"><span class="cls_011">Credits</span></div>
<div style="position:absolute;left:133.94px;top:151.71px" class="cls_007"><span class="cls_007">Authors</span></div>
<div style="position:absolute;left:293.45px;top:151.71px" class="cls_007"><span class="cls_007">Copy Editor</span></div>
<div style="position:absolute;left:133.94px;top:176.94px" class="cls_004"><span class="cls_004">Benjamin Chevallereau</span></div>
<div style="position:absolute;left:293.45px;top:176.94px" class="cls_004"><span class="cls_004">Safis Editing</span></div>
<div style="position:absolute;left:133.94px;top:189.54px" class="cls_004"><span class="cls_004">Jeff Potts</span></div>
<div style="position:absolute;left:133.94px;top:222.87px" class="cls_007"><span class="cls_007">Reviewer</span></div>
<div style="position:absolute;left:293.45px;top:222.87px" class="cls_007"><span class="cls_007">Project Coordinator</span></div>
<div style="position:absolute;left:133.94px;top:248.10px" class="cls_004"><span class="cls_004">Bindu Wavell</span></div>
<div style="position:absolute;left:293.45px;top:248.10px" class="cls_004"><span class="cls_004">Ritika Manoj</span></div>
<div style="position:absolute;left:133.94px;top:281.43px" class="cls_007"><span class="cls_007">Commissioning Editor</span></div>
<div style="position:absolute;left:293.45px;top:281.43px" class="cls_007"><span class="cls_007">Proofreader</span></div>
<div style="position:absolute;left:133.94px;top:306.66px" class="cls_004"><span class="cls_004">Amarabha Banerjee</span></div>
<div style="position:absolute;left:293.45px;top:306.66px" class="cls_004"><span class="cls_004">Safis Editing</span></div>
<div style="position:absolute;left:133.94px;top:339.99px" class="cls_007"><span class="cls_007">Acquisition Editor</span></div>
<div style="position:absolute;left:293.45px;top:339.99px" class="cls_007"><span class="cls_007">Indexer</span></div>
<div style="position:absolute;left:133.94px;top:365.22px" class="cls_004"><span class="cls_004">Shweta Pant</span></div>
<div style="position:absolute;left:293.45px;top:365.22px" class="cls_004"><span class="cls_004">Tejal Daruwale Soni</span></div>
<div style="position:absolute;left:133.94px;top:398.55px" class="cls_007"><span class="cls_007">Content Development Editor</span></div>
<div style="position:absolute;left:293.45px;top:398.55px" class="cls_007"><span class="cls_007">Graphics</span></div>
<div style="position:absolute;left:133.94px;top:423.78px" class="cls_004"><span class="cls_004">Aditi Gour</span></div>
<div style="position:absolute;left:293.45px;top:423.78px" class="cls_004"><span class="cls_004">Jason Monteiro</span></div>
<div style="position:absolute;left:133.94px;top:457.11px" class="cls_007"><span class="cls_007">Technical Editor</span></div>
<div style="position:absolute;left:293.45px;top:457.11px" class="cls_007"><span class="cls_007">Production Coordinator</span></div>
<div style="position:absolute;left:133.94px;top:482.34px" class="cls_004"><span class="cls_004">Anushree Arun Tendulkar</span></div>
<div style="position:absolute;left:293.45px;top:482.34px" class="cls_004"><span class="cls_004">Melwyn Dsa</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:2704px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background005.jpg" width="541" height="666"></div>
<div style="position:absolute;left:244.57px;top:69.12px" class="cls_011"><span class="cls_011">About the Authors</span></div>
<div style="position:absolute;left:56.69px;top:128.10px" class="cls_007"><span class="cls_007">Benjamin Chevallereau</span><span class="cls_004"> is a French software architect, based in London, who has been</span></div>
<div style="position:absolute;left:56.69px;top:140.74px" class="cls_004"><span class="cls_004">working on Alfresco projects for the last 8 years and Ephesoft projects for the last 3 years.</span></div>
<div style="position:absolute;left:56.69px;top:153.34px" class="cls_004"><span class="cls_004">He implemented solutions for small companies and global organizations in different</span></div>
<div style="position:absolute;left:56.69px;top:165.94px" class="cls_004"><span class="cls_004">domains such as transport, finance, and government.</span></div>
<div style="position:absolute;left:56.69px;top:187.54px" class="cls_004"><span class="cls_004">He has worked for different Alfresco-recognized partners in France, the UK, and USA,</span></div>
<div style="position:absolute;left:56.69px;top:200.14px" class="cls_004"><span class="cls_004">including Armedia LLC, Zaizi, Michelin / Wipro, and BlueXML. He is also one of the</span></div>
<div style="position:absolute;left:56.69px;top:212.74px" class="cls_004"><span class="cls_004">committers and PMC members of the Apache CMIS Chemistry project.</span></div>
<div style="position:absolute;left:56.69px;top:255.94px" class="cls_007"><span class="cls_007">Jeff Potts</span><span class="cls_004"> is the founder of Metaversant Group, Inc., a consulting firm focused on content</span></div>
<div style="position:absolute;left:56.69px;top:268.58px" class="cls_004"><span class="cls_004">management, search, and workflow. Jeff brings over 20 years of Enterprise Content</span></div>
<div style="position:absolute;left:56.69px;top:281.18px" class="cls_004"><span class="cls_004">Management implementation experience to organizations of all sizes including the Fortune</span></div>
<div style="position:absolute;left:56.69px;top:293.78px" class="cls_004"><span class="cls_004">500. Throughout his consulting career he has worked on a number of projects for clients</span></div>
<div style="position:absolute;left:56.69px;top:306.38px" class="cls_004"><span class="cls_004">across the media and entertainment, airline, consumer packaged goods, and retail sectors.</span></div>
<div style="position:absolute;left:56.69px;top:327.98px" class="cls_004"><span class="cls_004">Jeff began working with and blogging about Alfresco in November of 2005. In 2006 and</span></div>
<div style="position:absolute;left:56.69px;top:340.58px" class="cls_004"><span class="cls_004">2007, he published a series of Alfresco tutorials and published them on his blog,</span></div>
<div style="position:absolute;left:56.69px;top:353.18px" class="cls_010"><span class="cls_010"> </span><a href="http://ecmarchitect.com/">ecmarchitect.com</a> <span class="cls_004">. That work, together with other Community activity in Alfresco's forum,</span></div>
<div style="position:absolute;left:56.69px;top:366.16px" class="cls_004"><span class="cls_004">Wiki site, and JIRA earned him Alfresco's 2007 Community Contributor of the Year Award.</span></div>
<div style="position:absolute;left:56.69px;top:387.76px" class="cls_004"><span class="cls_004">In the past, Mr. Potts has worked for Alfresco Software, Inc. as Chief Community Officer,</span></div>
<div style="position:absolute;left:56.69px;top:400.36px" class="cls_004"><span class="cls_004">Optaros as Senior Practice Director, and Hitachi Consulting as Vice President where he ran</span></div>
<div style="position:absolute;left:56.69px;top:412.96px" class="cls_004"><span class="cls_004">the ECM practice.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:3380px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background006.jpg" width="541" height="666"></div>
<div style="position:absolute;left:222.94px;top:69.12px" class="cls_011"><span class="cls_011">About the Reviewer</span></div>
<div style="position:absolute;left:56.69px;top:128.10px" class="cls_007"><span class="cls_007">Bindu Wavell</span><span class="cls_004"> is the chief architect at Zia Consulting</span><span class="cls_007">.</span><span class="cls_004"> He has been doing enterprise system</span></div>
<div style="position:absolute;left:56.69px;top:140.74px" class="cls_004"><span class="cls_004">integration consulting for the past 24 years. At Zia, Bindu provides guidance and mentoring</span></div>
<div style="position:absolute;left:56.69px;top:153.34px" class="cls_004"><span class="cls_004">around Alfresco architecture and design in addition to working hands on with customers.</span></div>
<div style="position:absolute;left:56.69px;top:165.94px" class="cls_004"><span class="cls_004">He develops processes and technologies to streamline onboarding new developers, delivers</span></div>
<div style="position:absolute;left:56.69px;top:178.54px" class="cls_004"><span class="cls_004">trainings for customer developers and provides support for implementations and delivered</span></div>
<div style="position:absolute;left:56.69px;top:191.14px" class="cls_004"><span class="cls_004">projects.</span></div>
<div style="position:absolute;left:78.29px;top:255.95px" class="cls_012"><span class="cls_012">I would like to thank the whole team at Zia for providing an amazing environment for</span></div>
<div style="position:absolute;left:78.29px;top:268.55px" class="cls_012"><span class="cls_012">learning, discovery and excellence. I’d also like to thank everyone at Alfresco for delivering</span></div>
<div style="position:absolute;left:78.29px;top:281.15px" class="cls_012"><span class="cls_012">such a great content management platform and for continuing to focus on being the best in</span></div>
<div style="position:absolute;left:78.29px;top:293.75px" class="cls_012"><span class="cls_012">the industry.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:4056px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background007.jpg" width="541" height="666"></div>
<div style="position:absolute;left:217.99px;top:69.12px" class="cls_011"><span class="cls_011"> </span><a href="http://www.packtpub.com/">www.PacktPub.com</a> </div>
<div style="position:absolute;left:56.69px;top:128.10px" class="cls_004"><span class="cls_004">For support files and downloads related to your book, please visit </span><a href="http://www.packtpub.com/">www.PacktPub.com</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:150.08px" class="cls_004"><span class="cls_004">Did you know that Packt offers eBook versions of every book published, with PDF and</span></div>
<div style="position:absolute;left:56.69px;top:162.68px" class="cls_004"><span class="cls_004">ePub files available? You can upgrade to the eBook version at </span><a href="http://www.packtpub.com/">www.PacktPub.com</a> <span class="cls_004"> and as a</span></div>
<div style="position:absolute;left:56.69px;top:175.66px" class="cls_004"><span class="cls_004">print book customer, you are entitled to a discount on the eBook copy. Get in touch with us</span></div>
<div style="position:absolute;left:56.69px;top:188.26px" class="cls_004"><span class="cls_004">at </span><span class="cls_013">service@packtpub.com</span><span class="cls_004"> for more details.</span></div>
<div style="position:absolute;left:56.69px;top:210.54px" class="cls_004"><span class="cls_004">At </span><a href="http://www.packtpub.com/">www.PacktPub.com</a> <span class="cls_004">, you can also read a collection of free technical articles, sign up for a</span></div>
<div style="position:absolute;left:56.69px;top:223.52px" class="cls_004"><span class="cls_004">range of free newsletters and receive exclusive discounts and offers on Packt books and</span></div>
<div style="position:absolute;left:56.69px;top:236.12px" class="cls_004"><span class="cls_004">eBooks.</span></div>
<div style="position:absolute;left:56.69px;top:298.29px" class="cls_010"><span class="cls_010"> </span><a href="https://www.packtpub.com/mapt">https://www.packtpub.com/mapt</a> </div>
<div style="position:absolute;left:56.69px;top:318.77px" class="cls_004"><span class="cls_004">Get the most in-demand software skills with Mapt. Mapt gives you full access to all Packt</span></div>
<div style="position:absolute;left:56.69px;top:331.37px" class="cls_004"><span class="cls_004">books and video courses, as well as industry-leading tools to help you plan your personal</span></div>
<div style="position:absolute;left:56.69px;top:343.97px" class="cls_004"><span class="cls_004">development and advance your career.</span></div>
<div style="position:absolute;left:56.69px;top:371.67px" class="cls_014"><span class="cls_014">Why subscribe?</span></div>
<div style="position:absolute;left:104.69px;top:403.14px" class="cls_004"><span class="cls_004">Fully searchable across every book published by Packt</span></div>
<div style="position:absolute;left:104.69px;top:417.90px" class="cls_004"><span class="cls_004">Copy and paste, print, and bookmark content</span></div>
<div style="position:absolute;left:104.69px;top:432.66px" class="cls_004"><span class="cls_004">On demand and accessible via a web browser</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:4732px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background008.jpg" width="541" height="666"></div>
<div style="position:absolute;left:214.63px;top:69.12px" class="cls_011"><span class="cls_011">Customer Feedback</span></div>
<div style="position:absolute;left:56.69px;top:128.10px" class="cls_004"><span class="cls_004">Thanks for purchasing this Packt book. At Packt, quality is at the heart of our editorial</span></div>
<div style="position:absolute;left:56.69px;top:140.70px" class="cls_004"><span class="cls_004">process. To help us improve, please leave us an honest review on this book's Amazon page</span></div>
<div style="position:absolute;left:56.69px;top:153.30px" class="cls_004"><span class="cls_004">at </span><a href="https://www.amazon.com/Alfresco-One-5-x-Developers-Guide-ebook/dp/1787128164">https://www.amazon.com/Alfresco-One-5-x-Developers-Guide-ebook/dp</a> </div>
<div style="position:absolute;left:56.69px;top:166.28px" class="cls_010"><span class="cls_010"> </span><a href="https://www.amazon.com/Alfresco-One-5-x-Developers-Guide-ebook/dp/1787128164">/1787128164</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:209.86px" class="cls_004"><span class="cls_004">If you'd like to join our team of regular reviewers, you can e-mail us at</span></div>
<div style="position:absolute;left:56.69px;top:222.46px" class="cls_013"><span class="cls_013">customerreviews@packtpub.com</span><span class="cls_004">. We award our regular reviewers with free eBooks and</span></div>
<div style="position:absolute;left:56.69px;top:235.74px" class="cls_004"><span class="cls_004">videos in exchange for their valuable feedback. Help us be relentless in improving our</span></div>
<div style="position:absolute;left:56.69px;top:248.34px" class="cls_004"><span class="cls_004">products!</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:5408px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background009.jpg" width="541" height="666"></div>
<div style="position:absolute;left:247.93px;top:69.12px" class="cls_011"><span class="cls_011">Table of Contents</span></div>
<div style="position:absolute;left:56.69px;top:129.93px" class="cls_015"><span class="cls_015">Preface</span></div>
<div style="position:absolute;left:479.72px;top:133.69px" class="cls_009"><span class="cls_009">1</span></div>
<div style="position:absolute;left:56.69px;top:147.33px" class="cls_015"><span class="cls_015">Chapter 1: The Alfresco Platform</span></div>
<div style="position:absolute;left:479.72px;top:151.09px" class="cls_009"><span class="cls_009">8</span></div>
<div style="position:absolute;left:92.69px;top:164.79px" class="cls_016"><span class="cls_016">Alfresco in the real world</span></div>
<div style="position:absolute;left:479.72px;top:167.29px" class="cls_009"><span class="cls_009">8</span></div>
<div style="position:absolute;left:110.69px;top:177.99px" class="cls_017"><span class="cls_017">Basic document management</span></div>
<div style="position:absolute;left:479.72px;top:180.49px" class="cls_009"><span class="cls_009">9</span></div>
<div style="position:absolute;left:110.69px;top:191.19px" class="cls_017"><span class="cls_017">Web content management</span></div>
<div style="position:absolute;left:474.72px;top:193.69px" class="cls_009"><span class="cls_009">12</span></div>
<div style="position:absolute;left:128.69px;top:204.49px" class="cls_009"><span class="cls_009">Content authoring tools</span></div>
<div style="position:absolute;left:474.72px;top:204.49px" class="cls_009"><span class="cls_009">12</span></div>
<div style="position:absolute;left:128.69px;top:215.29px" class="cls_009"><span class="cls_009">Separation of presentation from content</span></div>
<div style="position:absolute;left:474.72px;top:215.29px" class="cls_009"><span class="cls_009">13</span></div>
<div style="position:absolute;left:128.69px;top:226.09px" class="cls_009"><span class="cls_009">Systematic publication or deployment</span></div>
<div style="position:absolute;left:474.72px;top:226.09px" class="cls_009"><span class="cls_009">14</span></div>
<div style="position:absolute;left:128.69px;top:236.89px" class="cls_009"><span class="cls_009">Alfresco WCM example</span></div>
<div style="position:absolute;left:474.72px;top:236.89px" class="cls_009"><span class="cls_009">14</span></div>
<div style="position:absolute;left:110.69px;top:247.59px" class="cls_017"><span class="cls_017">Custom content-centric applications</span></div>
<div style="position:absolute;left:474.72px;top:250.09px" class="cls_009"><span class="cls_009">14</span></div>
<div style="position:absolute;left:92.69px;top:260.79px" class="cls_016"><span class="cls_016">Example used throughout this book</span></div>
<div style="position:absolute;left:474.72px;top:263.29px" class="cls_009"><span class="cls_009">16</span></div>
<div style="position:absolute;left:92.69px;top:273.99px" class="cls_016"><span class="cls_016">Alfresco architecture</span></div>
<div style="position:absolute;left:474.72px;top:276.49px" class="cls_009"><span class="cls_009">18</span></div>
<div style="position:absolute;left:110.69px;top:287.19px" class="cls_017"><span class="cls_017">High-level architecture</span></div>
<div style="position:absolute;left:474.72px;top:289.69px" class="cls_009"><span class="cls_009">19</span></div>
<div style="position:absolute;left:128.69px;top:300.49px" class="cls_009"><span class="cls_009">Add-ons</span></div>
<div style="position:absolute;left:474.72px;top:300.49px" class="cls_009"><span class="cls_009">20</span></div>
<div style="position:absolute;left:110.69px;top:311.19px" class="cls_017"><span class="cls_017">Open source components</span></div>
<div style="position:absolute;left:474.72px;top:313.69px" class="cls_009"><span class="cls_009">20</span></div>
<div style="position:absolute;left:110.69px;top:324.39px" class="cls_017"><span class="cls_017">Major standards and protocols supported</span></div>
<div style="position:absolute;left:474.72px;top:326.89px" class="cls_009"><span class="cls_009">22</span></div>
<div style="position:absolute;left:92.69px;top:337.59px" class="cls_016"><span class="cls_016">Customizing Alfresco</span></div>
<div style="position:absolute;left:474.72px;top:340.09px" class="cls_009"><span class="cls_009">23</span></div>
<div style="position:absolute;left:110.69px;top:350.79px" class="cls_017"><span class="cls_017">Basic customization</span></div>
<div style="position:absolute;left:474.72px;top:353.29px" class="cls_009"><span class="cls_009">23</span></div>
<div style="position:absolute;left:128.69px;top:364.09px" class="cls_009"><span class="cls_009">Dashlets</span></div>
<div style="position:absolute;left:474.72px;top:364.09px" class="cls_009"><span class="cls_009">24</span></div>
<div style="position:absolute;left:128.69px;top:374.89px" class="cls_009"><span class="cls_009">Custom site configuration</span></div>
<div style="position:absolute;left:474.72px;top:374.89px" class="cls_009"><span class="cls_009">26</span></div>
<div style="position:absolute;left:128.69px;top:385.69px" class="cls_009"><span class="cls_009">Rules and actions</span></div>
<div style="position:absolute;left:474.72px;top:385.69px" class="cls_009"><span class="cls_009">27</span></div>
<div style="position:absolute;left:128.69px;top:396.49px" class="cls_009"><span class="cls_009">Simple workflow</span></div>
<div style="position:absolute;left:474.72px;top:396.49px" class="cls_009"><span class="cls_009">27</span></div>
<div style="position:absolute;left:110.69px;top:407.19px" class="cls_017"><span class="cls_017">Advanced customization</span></div>
<div style="position:absolute;left:474.72px;top:409.69px" class="cls_009"><span class="cls_009">28</span></div>
<div style="position:absolute;left:128.69px;top:420.49px" class="cls_009"><span class="cls_009">Examples of advanced customizations</span></div>
<div style="position:absolute;left:474.72px;top:420.49px" class="cls_009"><span class="cls_009">28</span></div>
<div style="position:absolute;left:128.69px;top:431.29px" class="cls_009"><span class="cls_009">Extend the content model</span></div>
<div style="position:absolute;left:474.72px;top:431.29px" class="cls_009"><span class="cls_009">28</span></div>
<div style="position:absolute;left:128.69px;top:442.09px" class="cls_009"><span class="cls_009">Perform automatic operations on content</span></div>
<div style="position:absolute;left:474.72px;top:442.09px" class="cls_009"><span class="cls_009">29</span></div>
<div style="position:absolute;left:128.69px;top:452.89px" class="cls_009"><span class="cls_009">Customize Alfresco Share</span></div>
<div style="position:absolute;left:474.72px;top:452.89px" class="cls_009"><span class="cls_009">29</span></div>
<div style="position:absolute;left:128.69px;top:463.69px" class="cls_009"><span class="cls_009">Create a RESTful API</span></div>
<div style="position:absolute;left:474.72px;top:463.69px" class="cls_009"><span class="cls_009">29</span></div>
<div style="position:absolute;left:128.69px;top:474.49px" class="cls_009"><span class="cls_009">Streamline complex business processes with advanced workflows</span></div>
<div style="position:absolute;left:474.72px;top:474.49px" class="cls_009"><span class="cls_009">30</span></div>
<div style="position:absolute;left:128.69px;top:485.29px" class="cls_009"><span class="cls_009">Integrate with other systems</span></div>
<div style="position:absolute;left:474.72px;top:485.29px" class="cls_009"><span class="cls_009">30</span></div>
<div style="position:absolute;left:92.69px;top:495.99px" class="cls_016"><span class="cls_016">Dusting off your toolbox</span></div>
<div style="position:absolute;left:474.72px;top:498.49px" class="cls_009"><span class="cls_009">30</span></div>
<div style="position:absolute;left:92.69px;top:509.19px" class="cls_016"><span class="cls_016">Understanding Alfresco's editions</span></div>
<div style="position:absolute;left:474.72px;top:511.69px" class="cls_009"><span class="cls_009">31</span></div>
<div style="position:absolute;left:110.69px;top:522.39px" class="cls_017"><span class="cls_017">Significant feature differences</span></div>
<div style="position:absolute;left:474.72px;top:524.89px" class="cls_009"><span class="cls_009">32</span></div>
<div style="position:absolute;left:110.69px;top:535.59px" class="cls_017"><span class="cls_017">What's used in this book</span></div>
<div style="position:absolute;left:474.72px;top:538.09px" class="cls_009"><span class="cls_009">32</span></div>
<div style="position:absolute;left:92.69px;top:548.79px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:474.72px;top:551.29px" class="cls_009"><span class="cls_009">33</span></div>
<div style="position:absolute;left:56.69px;top:564.18px" class="cls_015"><span class="cls_015">Chapter 2: Getting Started with Alfresco</span></div>
<div style="position:absolute;left:474.72px;top:567.94px" class="cls_009"><span class="cls_009">34</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:6084px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background010.jpg" width="541" height="666"></div>
<div style="position:absolute;left:92.69px;top:70.14px" class="cls_016"><span class="cls_016">Introduction to the Alfresco SDK</span></div>
<div style="position:absolute;left:474.72px;top:72.64px" class="cls_009"><span class="cls_009">35</span></div>
<div style="position:absolute;left:110.69px;top:83.34px" class="cls_017"><span class="cls_017">Maven archetypes</span></div>
<div style="position:absolute;left:474.72px;top:85.84px" class="cls_009"><span class="cls_009">35</span></div>
<div style="position:absolute;left:110.69px;top:96.54px" class="cls_017"><span class="cls_017">Install prerequisites</span></div>
<div style="position:absolute;left:474.72px;top:99.04px" class="cls_009"><span class="cls_009">36</span></div>
<div style="position:absolute;left:128.69px;top:109.84px" class="cls_009"><span class="cls_009">Spring Loaded</span></div>
<div style="position:absolute;left:474.72px;top:109.84px" class="cls_009"><span class="cls_009">36</span></div>
<div style="position:absolute;left:128.69px;top:120.64px" class="cls_009"><span class="cls_009">JDK</span></div>
<div style="position:absolute;left:474.72px;top:120.64px" class="cls_009"><span class="cls_009">37</span></div>
<div style="position:absolute;left:128.69px;top:131.44px" class="cls_009"><span class="cls_009">Maven</span></div>
<div style="position:absolute;left:474.72px;top:131.44px" class="cls_009"><span class="cls_009">38</span></div>
<div style="position:absolute;left:110.69px;top:142.14px" class="cls_017"><span class="cls_017">Install STS</span></div>
<div style="position:absolute;left:474.72px;top:144.64px" class="cls_009"><span class="cls_009">39</span></div>
<div style="position:absolute;left:92.69px;top:155.34px" class="cls_016"><span class="cls_016">Create your first application</span></div>
<div style="position:absolute;left:474.72px;top:157.84px" class="cls_009"><span class="cls_009">41</span></div>
<div style="position:absolute;left:110.69px;top:168.54px" class="cls_017"><span class="cls_017">Rapid application development</span></div>
<div style="position:absolute;left:474.72px;top:171.04px" class="cls_009"><span class="cls_009">41</span></div>
<div style="position:absolute;left:110.69px;top:181.74px" class="cls_017"><span class="cls_017">Traditional approach</span></div>
<div style="position:absolute;left:474.72px;top:184.24px" class="cls_009"><span class="cls_009">47</span></div>
<div style="position:absolute;left:110.69px;top:194.94px" class="cls_017"><span class="cls_017">Install Alfresco</span></div>
<div style="position:absolute;left:474.72px;top:197.44px" class="cls_009"><span class="cls_009">50</span></div>
<div style="position:absolute;left:128.69px;top:208.24px" class="cls_009"><span class="cls_009">Download Alfresco</span></div>
<div style="position:absolute;left:474.72px;top:208.24px" class="cls_009"><span class="cls_009">51</span></div>
<div style="position:absolute;left:128.69px;top:219.04px" class="cls_009"><span class="cls_009">Create your virtual machine</span></div>
<div style="position:absolute;left:474.72px;top:219.04px" class="cls_009"><span class="cls_009">51</span></div>
<div style="position:absolute;left:128.69px;top:229.84px" class="cls_009"><span class="cls_009">Deploy your modules</span></div>
<div style="position:absolute;left:474.72px;top:229.84px" class="cls_009"><span class="cls_009">58</span></div>
<div style="position:absolute;left:128.69px;top:240.64px" class="cls_009"><span class="cls_009">Check that your modules are installed</span></div>
<div style="position:absolute;left:474.72px;top:240.64px" class="cls_009"><span class="cls_009">60</span></div>
<div style="position:absolute;left:128.69px;top:251.44px" class="cls_009"><span class="cls_009">Extending Alfresco</span></div>
<div style="position:absolute;left:474.72px;top:251.44px" class="cls_009"><span class="cls_009">61</span></div>
<div style="position:absolute;left:110.69px;top:262.14px" class="cls_017"><span class="cls_017">Understanding the extension mechanism</span></div>
<div style="position:absolute;left:474.72px;top:264.64px" class="cls_009"><span class="cls_009">61</span></div>
<div style="position:absolute;left:128.69px;top:275.44px" class="cls_009"><span class="cls_009">Standard Java web application files</span></div>
<div style="position:absolute;left:474.72px;top:275.44px" class="cls_009"><span class="cls_009">62</span></div>
<div style="position:absolute;left:128.69px;top:286.24px" class="cls_009"><span class="cls_009">Framework files</span></div>
<div style="position:absolute;left:474.72px;top:286.24px" class="cls_009"><span class="cls_009">62</span></div>
<div style="position:absolute;left:146.69px;top:297.04px" class="cls_009"><span class="cls_009">Spring configuration files</span></div>
<div style="position:absolute;left:474.72px;top:297.04px" class="cls_009"><span class="cls_009">62</span></div>
<div style="position:absolute;left:146.69px;top:307.84px" class="cls_009"><span class="cls_009">Alfresco configuration files</span></div>
<div style="position:absolute;left:474.72px;top:307.84px" class="cls_009"><span class="cls_009">63</span></div>
<div style="position:absolute;left:146.69px;top:318.64px" class="cls_009"><span class="cls_009">Solution-specific files</span></div>
<div style="position:absolute;left:474.72px;top:318.64px" class="cls_009"><span class="cls_009">64</span></div>
<div style="position:absolute;left:146.69px;top:329.44px" class="cls_009"><span class="cls_009">Avoid Modifying Alfresco Code and Configuration</span></div>
<div style="position:absolute;left:474.72px;top:329.44px" class="cls_009"><span class="cls_009">65</span></div>
<div style="position:absolute;left:92.69px;top:340.14px" class="cls_016"><span class="cls_016">Troubleshooting</span></div>
<div style="position:absolute;left:474.72px;top:342.64px" class="cls_009"><span class="cls_009">65</span></div>
<div style="position:absolute;left:110.69px;top:353.34px" class="cls_017"><span class="cls_017">Log4j</span></div>
<div style="position:absolute;left:474.72px;top:355.84px" class="cls_009"><span class="cls_009">66</span></div>
<div style="position:absolute;left:110.69px;top:366.54px" class="cls_017"><span class="cls_017">Step-by-step - debugging from within Eclipse</span></div>
<div style="position:absolute;left:474.72px;top:369.04px" class="cls_009"><span class="cls_009">66</span></div>
<div style="position:absolute;left:110.69px;top:379.74px" class="cls_017"><span class="cls_017">Node browser</span></div>
<div style="position:absolute;left:474.72px;top:382.24px" class="cls_009"><span class="cls_009">70</span></div>
<div style="position:absolute;left:92.69px;top:392.94px" class="cls_016"><span class="cls_016">Starting over</span></div>
<div style="position:absolute;left:474.72px;top:395.44px" class="cls_009"><span class="cls_009">72</span></div>
<div style="position:absolute;left:92.69px;top:406.14px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:474.72px;top:408.64px" class="cls_009"><span class="cls_009">73</span></div>
<div style="position:absolute;left:56.69px;top:421.53px" class="cls_015"><span class="cls_015">Chapter 3: Working with Content Models</span></div>
<div style="position:absolute;left:474.72px;top:425.29px" class="cls_009"><span class="cls_009">74</span></div>
<div style="position:absolute;left:92.69px;top:438.99px" class="cls_016"><span class="cls_016">Defining SomeCo's content model</span></div>
<div style="position:absolute;left:474.72px;top:441.49px" class="cls_009"><span class="cls_009">74</span></div>
<div style="position:absolute;left:110.69px;top:452.19px" class="cls_017"><span class="cls_017">Step-by-step - starting the custom content model with custom types</span></div>
<div style="position:absolute;left:474.72px;top:454.69px" class="cls_009"><span class="cls_009">74</span></div>
<div style="position:absolute;left:128.69px;top:465.49px" class="cls_009"><span class="cls_009">Types</span></div>
<div style="position:absolute;left:474.72px;top:465.49px" class="cls_009"><span class="cls_009">78</span></div>
<div style="position:absolute;left:128.69px;top:476.29px" class="cls_009"><span class="cls_009">Properties and property types</span></div>
<div style="position:absolute;left:474.72px;top:476.29px" class="cls_009"><span class="cls_009">79</span></div>
<div style="position:absolute;left:128.69px;top:487.09px" class="cls_009"><span class="cls_009">Constraints</span></div>
<div style="position:absolute;left:474.72px;top:487.09px" class="cls_009"><span class="cls_009">80</span></div>
<div style="position:absolute;left:110.69px;top:497.79px" class="cls_017"><span class="cls_017">Step-by-step - adding properties to types</span></div>
<div style="position:absolute;left:474.72px;top:500.29px" class="cls_009"><span class="cls_009">80</span></div>
<div style="position:absolute;left:110.69px;top:510.99px" class="cls_017"><span class="cls_017">Step-by-step - relating types with associations</span></div>
<div style="position:absolute;left:474.72px;top:513.49px" class="cls_009"><span class="cls_009">82</span></div>
<div style="position:absolute;left:128.69px;top:524.29px" class="cls_009"><span class="cls_009">Associations</span></div>
<div style="position:absolute;left:474.72px;top:524.29px" class="cls_009"><span class="cls_009">83</span></div>
<div style="position:absolute;left:110.69px;top:534.99px" class="cls_017"><span class="cls_017">Step-by-step - adding aspects to the content model</span></div>
<div style="position:absolute;left:474.72px;top:537.49px" class="cls_009"><span class="cls_009">84</span></div>
<div style="position:absolute;left:128.69px;top:548.29px" class="cls_009"><span class="cls_009">Aspects</span></div>
<div style="position:absolute;left:474.72px;top:548.29px" class="cls_009"><span class="cls_009">86</span></div>
<div style="position:absolute;left:110.69px;top:558.99px" class="cls_017"><span class="cls_017">Step-by-step - finishing up the model</span></div>
<div style="position:absolute;left:474.72px;top:561.49px" class="cls_009"><span class="cls_009">87</span></div>
<div style="position:absolute;left:92.69px;top:572.19px" class="cls_016"><span class="cls_016">Manage property indexing</span></div>
<div style="position:absolute;left:474.72px;top:574.69px" class="cls_009"><span class="cls_009">89</span></div>
<div style="position:absolute;left:259.72px;top:605.74px" class="cls_018"><span class="cls_018">[ ii ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:6760px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background011.jpg" width="541" height="666"></div>
<div style="position:absolute;left:92.69px;top:70.14px" class="cls_016"><span class="cls_016">Modeling summary</span></div>
<div style="position:absolute;left:474.72px;top:72.64px" class="cls_009"><span class="cls_009">90</span></div>
<div style="position:absolute;left:110.69px;top:83.34px" class="cls_017"><span class="cls_017">Custom behavior</span></div>
<div style="position:absolute;left:474.72px;top:85.84px" class="cls_009"><span class="cls_009">91</span></div>
<div style="position:absolute;left:92.69px;top:96.54px" class="cls_016"><span class="cls_016">Modeling best practices</span></div>
<div style="position:absolute;left:474.72px;top:99.04px" class="cls_009"><span class="cls_009">92</span></div>
<div style="position:absolute;left:110.69px;top:109.74px" class="cls_017"><span class="cls_017">Out-of-the-box models</span></div>
<div style="position:absolute;left:474.72px;top:112.24px" class="cls_009"><span class="cls_009">94</span></div>
<div style="position:absolute;left:92.69px;top:122.94px" class="cls_016"><span class="cls_016">Configuring the UI</span></div>
<div style="position:absolute;left:474.72px;top:125.44px" class="cls_009"><span class="cls_009">95</span></div>
<div style="position:absolute;left:110.69px;top:136.14px" class="cls_017"><span class="cls_017">Step-by-step - configure Share forms</span></div>
<div style="position:absolute;left:474.72px;top:138.64px" class="cls_009"><span class="cls_009">95</span></div>
<div style="position:absolute;left:110.69px;top:149.34px" class="cls_017"><span class="cls_017">Step-by-step - adding types and aspects to Alfresco Share dropdowns</span></div>
<div style="position:absolute;left:474.72px;top:151.84px" class="cls_009"><span class="cls_009">98</span></div>
<div style="position:absolute;left:110.69px;top:162.54px" class="cls_017"><span class="cls_017">Step-by-step - externalizing display labels</span></div>
<div style="position:absolute;left:469.71px;top:165.04px" class="cls_009"><span class="cls_009">103</span></div>
<div style="position:absolute;left:128.69px;top:175.84px" class="cls_009"><span class="cls_009">Setting up additional locales</span></div>
<div style="position:absolute;left:469.71px;top:175.84px" class="cls_009"><span class="cls_009">105</span></div>
<div style="position:absolute;left:110.69px;top:186.54px" class="cls_017"><span class="cls_017">Step-by-step - adding properties and types to advanced search</span></div>
<div style="position:absolute;left:469.71px;top:189.04px" class="cls_009"><span class="cls_009">105</span></div>
<div style="position:absolute;left:92.69px;top:199.74px" class="cls_016"><span class="cls_016">Working with content programmatically</span></div>
<div style="position:absolute;left:469.71px;top:202.24px" class="cls_009"><span class="cls_009">108</span></div>
<div style="position:absolute;left:110.69px;top:212.94px" class="cls_017"><span class="cls_017">Step-by-step - creating content with JavaScript</span></div>
<div style="position:absolute;left:469.71px;top:215.44px" class="cls_009"><span class="cls_009">108</span></div>
<div style="position:absolute;left:128.69px;top:226.24px" class="cls_009"><span class="cls_009">Knowing when to save documents</span></div>
<div style="position:absolute;left:469.71px;top:226.24px" class="cls_009"><span class="cls_009">110</span></div>
<div style="position:absolute;left:128.69px;top:237.04px" class="cls_009"><span class="cls_009">Using JavaScript for batch manipulation</span></div>
<div style="position:absolute;left:469.71px;top:237.04px" class="cls_009"><span class="cls_009">110</span></div>
<div style="position:absolute;left:128.69px;top:247.84px" class="cls_009"><span class="cls_009">Writing content to the content property</span></div>
<div style="position:absolute;left:469.71px;top:247.84px" class="cls_009"><span class="cls_009">110</span></div>
<div style="position:absolute;left:110.69px;top:258.54px" class="cls_017"><span class="cls_017">Creating content with CMIS</span></div>
<div style="position:absolute;left:469.71px;top:261.04px" class="cls_009"><span class="cls_009">111</span></div>
<div style="position:absolute;left:128.69px;top:271.84px" class="cls_009"><span class="cls_009">Step-by-step - run CmisClientClass to create content</span></div>
<div style="position:absolute;left:469.71px;top:271.84px" class="cls_009"><span class="cls_009">113</span></div>
<div style="position:absolute;left:110.69px;top:282.54px" class="cls_017"><span class="cls_017">Creating associations</span></div>
<div style="position:absolute;left:469.71px;top:285.04px" class="cls_009"><span class="cls_009">114</span></div>
<div style="position:absolute;left:110.69px;top:295.74px" class="cls_017"><span class="cls_017">Searching for content</span></div>
<div style="position:absolute;left:469.71px;top:298.24px" class="cls_009"><span class="cls_009">115</span></div>
<div style="position:absolute;left:110.69px;top:308.94px" class="cls_017"><span class="cls_017">Deleting content</span></div>
<div style="position:absolute;left:469.71px;top:311.44px" class="cls_009"><span class="cls_009">117</span></div>
<div style="position:absolute;left:92.69px;top:322.14px" class="cls_016"><span class="cls_016">Model manager</span></div>
<div style="position:absolute;left:469.71px;top:324.64px" class="cls_009"><span class="cls_009">118</span></div>
<div style="position:absolute;left:92.69px;top:335.34px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:337.84px" class="cls_009"><span class="cls_009">119</span></div>
<div style="position:absolute;left:56.69px;top:350.73px" class="cls_015"><span class="cls_015">Chapter 4: Handling Content Automatically with Actions, Behaviors,</span></div>
<div style="position:absolute;left:56.69px;top:365.13px" class="cls_015"><span class="cls_015">Transformers, and Extractors</span></div>
<div style="position:absolute;left:469.71px;top:368.89px" class="cls_009"><span class="cls_009">120</span></div>
<div style="position:absolute;left:92.69px;top:382.59px" class="cls_016"><span class="cls_016">Encapsulating content operations in actions</span></div>
<div style="position:absolute;left:469.71px;top:385.09px" class="cls_009"><span class="cls_009">120</span></div>
<div style="position:absolute;left:110.69px;top:395.79px" class="cls_017"><span class="cls_017">Step-by-step - creating a basic action</span></div>
<div style="position:absolute;left:469.71px;top:398.29px" class="cls_009"><span class="cls_009">121</span></div>
<div style="position:absolute;left:110.69px;top:408.99px" class="cls_017"><span class="cls_017">Hiding the action from end users</span></div>
<div style="position:absolute;left:469.71px;top:411.49px" class="cls_009"><span class="cls_009">127</span></div>
<div style="position:absolute;left:110.69px;top:422.19px" class="cls_017"><span class="cls_017">Creating actions that require user-specified parameters</span></div>
<div style="position:absolute;left:469.71px;top:424.69px" class="cls_009"><span class="cls_009">127</span></div>
<div style="position:absolute;left:128.69px;top:435.49px" class="cls_009"><span class="cls_009">Step-by-step - creating an action configurable in Alfresco Share</span></div>
<div style="position:absolute;left:469.71px;top:435.49px" class="cls_009"><span class="cls_009">128</span></div>
<div style="position:absolute;left:110.69px;top:446.19px" class="cls_017"><span class="cls_017">Specifying parameters when code executes an action</span></div>
<div style="position:absolute;left:469.71px;top:448.69px" class="cls_009"><span class="cls_009">138</span></div>
<div style="position:absolute;left:92.69px;top:459.39px" class="cls_016"><span class="cls_016">Binding logic to custom types with behaviors</span></div>
<div style="position:absolute;left:469.71px;top:461.89px" class="cls_009"><span class="cls_009">139</span></div>
<div style="position:absolute;left:110.69px;top:472.59px" class="cls_017"><span class="cls_017">Step-by-step - writing a simple behavior in Java</span></div>
<div style="position:absolute;left:469.71px;top:475.09px" class="cls_009"><span class="cls_009">140</span></div>
<div style="position:absolute;left:110.69px;top:485.79px" class="cls_017"><span class="cls_017">Binding to multiple types/aspects</span></div>
<div style="position:absolute;left:469.71px;top:488.29px" class="cls_009"><span class="cls_009">144</span></div>
<div style="position:absolute;left:110.69px;top:498.99px" class="cls_017"><span class="cls_017">Frequency</span></div>
<div style="position:absolute;left:469.71px;top:501.49px" class="cls_009"><span class="cls_009">144</span></div>
<div style="position:absolute;left:110.69px;top:512.19px" class="cls_017"><span class="cls_017">Figuring out to which policies to bind</span></div>
<div style="position:absolute;left:469.71px;top:514.69px" class="cls_009"><span class="cls_009">144</span></div>
<div style="position:absolute;left:110.69px;top:525.39px" class="cls_017"><span class="cls_017">Step-by-step - writing a simple behavior in JavaScript</span></div>
<div style="position:absolute;left:469.71px;top:527.89px" class="cls_009"><span class="cls_009">146</span></div>
<div style="position:absolute;left:110.69px;top:538.59px" class="cls_017"><span class="cls_017">Binding behavior to child types</span></div>
<div style="position:absolute;left:469.71px;top:541.09px" class="cls_009"><span class="cls_009">148</span></div>
<div style="position:absolute;left:128.69px;top:551.89px" class="cls_009"><span class="cls_009">Step-by-step - writing a user ratings calculator</span></div>
<div style="position:absolute;left:469.71px;top:551.89px" class="cls_009"><span class="cls_009">148</span></div>
<div style="position:absolute;left:128.69px;top:562.69px" class="cls_009"><span class="cls_009">Step-by-step - testing the new rating behavior</span></div>
<div style="position:absolute;left:469.71px;top:562.69px" class="cls_009"><span class="cls_009">154</span></div>
<div style="position:absolute;left:110.69px;top:573.39px" class="cls_017"><span class="cls_017">Handling deleted ratings</span></div>
<div style="position:absolute;left:469.71px;top:575.89px" class="cls_009"><span class="cls_009">156</span></div>
<div style="position:absolute;left:257.72px;top:605.74px" class="cls_018"><span class="cls_018">[ iii ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:7436px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background012.jpg" width="541" height="666"></div>
<div style="position:absolute;left:92.69px;top:70.14px" class="cls_016"><span class="cls_016">Extracting metadata from files</span></div>
<div style="position:absolute;left:469.71px;top:72.64px" class="cls_009"><span class="cls_009">159</span></div>
<div style="position:absolute;left:110.69px;top:83.34px" class="cls_017"><span class="cls_017">Customizing metadata extractors</span></div>
<div style="position:absolute;left:469.71px;top:85.84px" class="cls_009"><span class="cls_009">159</span></div>
<div style="position:absolute;left:128.69px;top:96.64px" class="cls_009"><span class="cls_009">Step-by-step - customizing the metadata mapping</span></div>
<div style="position:absolute;left:469.71px;top:96.64px" class="cls_009"><span class="cls_009">159</span></div>
<div style="position:absolute;left:110.69px;top:107.34px" class="cls_017"><span class="cls_017">Overriding the default mapping</span></div>
<div style="position:absolute;left:469.71px;top:109.84px" class="cls_009"><span class="cls_009">165</span></div>
<div style="position:absolute;left:110.69px;top:120.54px" class="cls_017"><span class="cls_017">Leveraging out-of-the-box metadata extractors</span></div>
<div style="position:absolute;left:469.71px;top:123.04px" class="cls_009"><span class="cls_009">165</span></div>
<div style="position:absolute;left:92.69px;top:133.74px" class="cls_016"><span class="cls_016">Transforming content from one format to another</span></div>
<div style="position:absolute;left:469.71px;top:136.24px" class="cls_009"><span class="cls_009">166</span></div>
<div style="position:absolute;left:110.69px;top:146.94px" class="cls_017"><span class="cls_017">Step-by-step - writing a custom transformer</span></div>
<div style="position:absolute;left:469.71px;top:149.44px" class="cls_009"><span class="cls_009">167</span></div>
<div style="position:absolute;left:92.69px;top:160.14px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:162.64px" class="cls_009"><span class="cls_009">170</span></div>
<div style="position:absolute;left:56.69px;top:175.53px" class="cls_015"><span class="cls_015">Chapter 5: Customizing Alfresco Share</span></div>
<div style="position:absolute;left:469.71px;top:179.29px" class="cls_009"><span class="cls_009">171</span></div>
<div style="position:absolute;left:92.69px;top:192.99px" class="cls_016"><span class="cls_016">Knowing when to customize Alfresco Share and when to write your</span></div>
<div style="position:absolute;left:92.69px;top:206.19px" class="cls_016"><span class="cls_016">own</span></div>
<div style="position:absolute;left:469.71px;top:208.69px" class="cls_009"><span class="cls_009">172</span></div>
<div style="position:absolute;left:92.69px;top:219.39px" class="cls_016"><span class="cls_016">Adding new menu items</span></div>
<div style="position:absolute;left:469.71px;top:221.89px" class="cls_009"><span class="cls_009">173</span></div>
<div style="position:absolute;left:110.69px;top:232.59px" class="cls_017"><span class="cls_017">Step-by-step - adding a simple menu item</span></div>
<div style="position:absolute;left:469.71px;top:235.09px" class="cls_009"><span class="cls_009">173</span></div>
<div style="position:absolute;left:92.69px;top:245.79px" class="cls_016"><span class="cls_016">Adding new action items</span></div>
<div style="position:absolute;left:469.71px;top:248.29px" class="cls_009"><span class="cls_009">178</span></div>
<div style="position:absolute;left:110.69px;top:258.99px" class="cls_017"><span class="cls_017">Step-by-step - adding an action item to set the web flag</span></div>
<div style="position:absolute;left:469.71px;top:261.49px" class="cls_009"><span class="cls_009">178</span></div>
<div style="position:absolute;left:110.69px;top:272.19px" class="cls_017"><span class="cls_017">Restricting the action item by permission</span></div>
<div style="position:absolute;left:469.71px;top:274.69px" class="cls_009"><span class="cls_009">182</span></div>
<div style="position:absolute;left:92.69px;top:285.39px" class="cls_016"><span class="cls_016">Writing action evaluators to show/hide UI actions</span></div>
<div style="position:absolute;left:469.71px;top:287.89px" class="cls_009"><span class="cls_009">182</span></div>
<div style="position:absolute;left:110.69px;top:298.59px" class="cls_017"><span class="cls_017">Step-by-step - evaluating whether or not to show the set web flag</span></div>
<div style="position:absolute;left:110.69px;top:311.79px" class="cls_017"><span class="cls_017">actions</span></div>
<div style="position:absolute;left:469.71px;top:314.29px" class="cls_009"><span class="cls_009">183</span></div>
<div style="position:absolute;left:92.69px;top:324.99px" class="cls_016"><span class="cls_016">Changing how Share renders forms</span></div>
<div style="position:absolute;left:469.71px;top:327.49px" class="cls_009"><span class="cls_009">186</span></div>
<div style="position:absolute;left:110.69px;top:338.19px" class="cls_017"><span class="cls_017">Step-by-step - using a text area field</span></div>
<div style="position:absolute;left:469.71px;top:340.69px" class="cls_009"><span class="cls_009">187</span></div>
<div style="position:absolute;left:110.69px;top:351.39px" class="cls_017"><span class="cls_017">Step-by-step - changing the Status field on the Details page to display</span></div>
<div style="position:absolute;left:110.69px;top:364.59px" class="cls_017"><span class="cls_017">as a Stoplight indicator</span></div>
<div style="position:absolute;left:469.71px;top:367.09px" class="cls_009"><span class="cls_009">190</span></div>
<div style="position:absolute;left:110.69px;top:377.79px" class="cls_017"><span class="cls_017">Overriding and customizing components</span></div>
<div style="position:absolute;left:469.71px;top:380.29px" class="cls_009"><span class="cls_009">193</span></div>
<div style="position:absolute;left:92.69px;top:390.99px" class="cls_016"><span class="cls_016">How to use indicators</span></div>
<div style="position:absolute;left:469.71px;top:393.49px" class="cls_009"><span class="cls_009">193</span></div>
<div style="position:absolute;left:110.69px;top:404.19px" class="cls_017"><span class="cls_017">Step-by-step - creating indicators for the status indicator</span></div>
<div style="position:absolute;left:469.71px;top:406.69px" class="cls_009"><span class="cls_009">193</span></div>
<div style="position:absolute;left:92.69px;top:417.39px" class="cls_016"><span class="cls_016">How to create metadata template</span></div>
<div style="position:absolute;left:469.71px;top:419.89px" class="cls_009"><span class="cls_009">195</span></div>
<div style="position:absolute;left:110.69px;top:430.59px" class="cls_017"><span class="cls_017">Step-by-step - create a metadata template for Operations document</span></div>
<div style="position:absolute;left:469.71px;top:433.09px" class="cls_009"><span class="cls_009">196</span></div>
<div style="position:absolute;left:92.69px;top:443.79px" class="cls_016"><span class="cls_016">Creating custom dialogs</span></div>
<div style="position:absolute;left:469.71px;top:446.29px" class="cls_009"><span class="cls_009">198</span></div>
<div style="position:absolute;left:110.69px;top:456.99px" class="cls_017"><span class="cls_017">Step-by-step - creating a dialog to publish Whitepapers</span></div>
<div style="position:absolute;left:469.71px;top:459.49px" class="cls_009"><span class="cls_009">199</span></div>
<div style="position:absolute;left:92.69px;top:470.19px" class="cls_016"><span class="cls_016">Creating custom dashlets</span></div>
<div style="position:absolute;left:469.71px;top:472.69px" class="cls_009"><span class="cls_009">201</span></div>
<div style="position:absolute;left:110.69px;top:483.39px" class="cls_017"><span class="cls_017">Step-by-step - creating a dashlet listing Whitepapers</span></div>
<div style="position:absolute;left:469.71px;top:485.89px" class="cls_009"><span class="cls_009">205</span></div>
<div style="position:absolute;left:110.69px;top:496.59px" class="cls_017"><span class="cls_017">Step-by-step - adding filters to your Dashlet</span></div>
<div style="position:absolute;left:469.71px;top:499.09px" class="cls_009"><span class="cls_009">208</span></div>
<div style="position:absolute;left:92.69px;top:509.79px" class="cls_016"><span class="cls_016">Create custom pages</span></div>
<div style="position:absolute;left:469.71px;top:512.29px" class="cls_009"><span class="cls_009">218</span></div>
<div style="position:absolute;left:110.69px;top:522.99px" class="cls_017"><span class="cls_017">Step-by-step - create a new page to list all Webable documents</span></div>
<div style="position:absolute;left:469.71px;top:525.49px" class="cls_009"><span class="cls_009">218</span></div>
<div style="position:absolute;left:92.69px;top:536.19px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:538.69px" class="cls_009"><span class="cls_009">229</span></div>
<div style="position:absolute;left:56.69px;top:551.58px" class="cls_015"><span class="cls_015">Chapter 6: Creating an Angular Application</span></div>
<div style="position:absolute;left:469.71px;top:555.34px" class="cls_009"><span class="cls_009">230</span></div>
<div style="position:absolute;left:92.69px;top:569.04px" class="cls_016"><span class="cls_016">Understanding the framework</span></div>
<div style="position:absolute;left:469.71px;top:571.54px" class="cls_009"><span class="cls_009">231</span></div>
<div style="position:absolute;left:258.38px;top:605.74px" class="cls_018"><span class="cls_018">[ iv ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:8112px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background013.jpg" width="541" height="666"></div>
<div style="position:absolute;left:110.69px;top:70.14px" class="cls_017"><span class="cls_017">Components</span></div>
<div style="position:absolute;left:469.71px;top:72.64px" class="cls_009"><span class="cls_009">231</span></div>
<div style="position:absolute;left:110.69px;top:83.34px" class="cls_017"><span class="cls_017">Prepare your environments</span></div>
<div style="position:absolute;left:469.71px;top:85.84px" class="cls_009"><span class="cls_009">232</span></div>
<div style="position:absolute;left:110.69px;top:96.54px" class="cls_017"><span class="cls_017">Step-by-step - creating the new virtual machine</span></div>
<div style="position:absolute;left:469.71px;top:99.04px" class="cls_009"><span class="cls_009">235</span></div>
<div style="position:absolute;left:92.69px;top:109.74px" class="cls_016"><span class="cls_016">Creating your first JavaScript application</span></div>
<div style="position:absolute;left:469.71px;top:112.24px" class="cls_009"><span class="cls_009">238</span></div>
<div style="position:absolute;left:110.69px;top:122.94px" class="cls_017"><span class="cls_017">Step-by-step - develop your first custom UI using the JavaScript API</span></div>
<div style="position:absolute;left:469.71px;top:125.44px" class="cls_009"><span class="cls_009">240</span></div>
<div style="position:absolute;left:92.69px;top:136.14px" class="cls_016"><span class="cls_016">Creating your first Angular web application</span></div>
<div style="position:absolute;left:469.71px;top:138.64px" class="cls_009"><span class="cls_009">247</span></div>
<div style="position:absolute;left:110.69px;top:149.34px" class="cls_017"><span class="cls_017">Step-by-step - installing all prerequisites</span></div>
<div style="position:absolute;left:469.71px;top:151.84px" class="cls_009"><span class="cls_009">248</span></div>
<div style="position:absolute;left:110.69px;top:162.54px" class="cls_017"><span class="cls_017">Step-by-step - creating your first Angular application</span></div>
<div style="position:absolute;left:469.71px;top:165.04px" class="cls_009"><span class="cls_009">249</span></div>
<div style="position:absolute;left:110.69px;top:175.74px" class="cls_017"><span class="cls_017">Step-by-step - running the Alfresco demo shell</span></div>
<div style="position:absolute;left:469.71px;top:178.24px" class="cls_009"><span class="cls_009">258</span></div>
<div style="position:absolute;left:92.69px;top:188.94px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:191.44px" class="cls_009"><span class="cls_009">262</span></div>
<div style="position:absolute;left:56.69px;top:204.33px" class="cls_015"><span class="cls_015">Chapter 7: Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:469.71px;top:208.09px" class="cls_009"><span class="cls_009">263</span></div>
<div style="position:absolute;left:92.69px;top:221.79px" class="cls_016"><span class="cls_016">Introducing the Web Script Framework</span></div>
<div style="position:absolute;left:469.71px;top:224.29px" class="cls_009"><span class="cls_009">263</span></div>
<div style="position:absolute;left:110.69px;top:234.99px" class="cls_017"><span class="cls_017">Step-by-step - Hello World web script</span></div>
<div style="position:absolute;left:469.71px;top:237.49px" class="cls_009"><span class="cls_009">265</span></div>
<div style="position:absolute;left:110.69px;top:248.19px" class="cls_017"><span class="cls_017">What just happened?</span></div>
<div style="position:absolute;left:469.71px;top:250.69px" class="cls_009"><span class="cls_009">266</span></div>
<div style="position:absolute;left:110.69px;top:261.39px" class="cls_017"><span class="cls_017">Following the Model-View-Controller pattern</span></div>
<div style="position:absolute;left:469.71px;top:263.89px" class="cls_009"><span class="cls_009">266</span></div>
<div style="position:absolute;left:110.69px;top:274.59px" class="cls_017"><span class="cls_017">Adding controller logic</span></div>
<div style="position:absolute;left:469.71px;top:277.09px" class="cls_009"><span class="cls_009">267</span></div>
<div style="position:absolute;left:110.69px;top:287.79px" class="cls_017"><span class="cls_017">Configuring the Web Script Framework</span></div>
<div style="position:absolute;left:469.71px;top:290.29px" class="cls_009"><span class="cls_009">268</span></div>
<div style="position:absolute;left:128.69px;top:301.09px" class="cls_009"><span class="cls_009">Specifying the HTTP method</span></div>
<div style="position:absolute;left:469.71px;top:301.09px" class="cls_009"><span class="cls_009">268</span></div>
<div style="position:absolute;left:128.69px;top:311.89px" class="cls_009"><span class="cls_009">Specifying arguments</span></div>
<div style="position:absolute;left:469.71px;top:311.89px" class="cls_009"><span class="cls_009">269</span></div>
<div style="position:absolute;left:128.69px;top:322.69px" class="cls_009"><span class="cls_009">Specifying the response format</span></div>
<div style="position:absolute;left:469.71px;top:322.69px" class="cls_009"><span class="cls_009">269</span></div>
<div style="position:absolute;left:110.69px;top:333.39px" class="cls_017"><span class="cls_017">Deploying web scripts</span></div>
<div style="position:absolute;left:469.71px;top:335.89px" class="cls_009"><span class="cls_009">270</span></div>
<div style="position:absolute;left:110.69px;top:346.59px" class="cls_017"><span class="cls_017">Building solutions with the Web Script Framework</span></div>
<div style="position:absolute;left:469.71px;top:349.09px" class="cls_009"><span class="cls_009">271</span></div>
<div style="position:absolute;left:92.69px;top:359.79px" class="cls_016"><span class="cls_016">Planning the SomeCo whitepapers and ratings API</span></div>
<div style="position:absolute;left:469.71px;top:362.29px" class="cls_009"><span class="cls_009">272</span></div>
<div style="position:absolute;left:92.69px;top:372.99px" class="cls_016"><span class="cls_016">Retrieving data with web scripts</span></div>
<div style="position:absolute;left:469.71px;top:375.49px" class="cls_009"><span class="cls_009">274</span></div>
<div style="position:absolute;left:110.69px;top:386.19px" class="cls_017"><span class="cls_017">Step-by-step - writing a web script to list whitepapers</span></div>
<div style="position:absolute;left:469.71px;top:388.69px" class="cls_009"><span class="cls_009">275</span></div>
<div style="position:absolute;left:110.69px;top:399.39px" class="cls_017"><span class="cls_017">Debugging</span></div>
<div style="position:absolute;left:469.71px;top:401.89px" class="cls_009"><span class="cls_009">283</span></div>
<div style="position:absolute;left:110.69px;top:412.59px" class="cls_017"><span class="cls_017">Fast facts</span></div>
<div style="position:absolute;left:469.71px;top:415.09px" class="cls_009"><span class="cls_009">285</span></div>
<div style="position:absolute;left:110.69px;top:425.79px" class="cls_017"><span class="cls_017">Organizing web scripts</span></div>
<div style="position:absolute;left:469.71px;top:428.29px" class="cls_009"><span class="cls_009">286</span></div>
<div style="position:absolute;left:110.69px;top:438.99px" class="cls_017"><span class="cls_017">Overriding web scripts</span></div>
<div style="position:absolute;left:469.71px;top:441.49px" class="cls_009"><span class="cls_009">286</span></div>
<div style="position:absolute;left:110.69px;top:452.19px" class="cls_017"><span class="cls_017">Choosing a URL</span></div>
<div style="position:absolute;left:469.71px;top:454.69px" class="cls_009"><span class="cls_009">287</span></div>
<div style="position:absolute;left:110.69px;top:465.39px" class="cls_017"><span class="cls_017">Choosing between the repository and the classpath</span></div>
<div style="position:absolute;left:469.71px;top:467.89px" class="cls_009"><span class="cls_009">287</span></div>
<div style="position:absolute;left:110.69px;top:478.59px" class="cls_017"><span class="cls_017">Step-by-step - retrieving the rating for a whitepaper</span></div>
<div style="position:absolute;left:469.71px;top:481.09px" class="cls_009"><span class="cls_009">288</span></div>
<div style="position:absolute;left:110.69px;top:491.79px" class="cls_017"><span class="cls_017">Specifying optional arguments</span></div>
<div style="position:absolute;left:469.71px;top:494.29px" class="cls_009"><span class="cls_009">291</span></div>
<div style="position:absolute;left:110.69px;top:504.99px" class="cls_017"><span class="cls_017">Handling errors</span></div>
<div style="position:absolute;left:469.71px;top:507.49px" class="cls_009"><span class="cls_009">292</span></div>
<div style="position:absolute;left:92.69px;top:518.19px" class="cls_016"><span class="cls_016">Writing Java-backed web scripts</span></div>
<div style="position:absolute;left:469.71px;top:520.69px" class="cls_009"><span class="cls_009">295</span></div>
<div style="position:absolute;left:110.69px;top:531.39px" class="cls_017"><span class="cls_017">Step-by-step - writing a Java-backed web script to handle ratings posts</span></div>
<div style="position:absolute;left:469.71px;top:533.89px" class="cls_009"><span class="cls_009">295</span></div>
<div style="position:absolute;left:110.69px;top:544.59px" class="cls_017"><span class="cls_017">Using the correct ID for Web Script Beans</span></div>
<div style="position:absolute;left:469.71px;top:547.09px" class="cls_009"><span class="cls_009">303</span></div>
<div style="position:absolute;left:110.69px;top:557.79px" class="cls_017"><span class="cls_017">Using both Java and JavaScript for controller logic</span></div>
<div style="position:absolute;left:469.71px;top:560.29px" class="cls_009"><span class="cls_009">304</span></div>
<div style="position:absolute;left:92.69px;top:570.99px" class="cls_016"><span class="cls_016">Wiring a web script to UI widgets</span></div>
<div style="position:absolute;left:469.71px;top:573.49px" class="cls_009"><span class="cls_009">304</span></div>
<div style="position:absolute;left:260.38px;top:605.74px" class="cls_018"><span class="cls_018">[ v ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:8788px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background014.jpg" width="541" height="666"></div>
<div style="position:absolute;left:110.69px;top:70.14px" class="cls_017"><span class="cls_017">Step-by-step - using a widget to post ratings</span></div>
<div style="position:absolute;left:469.71px;top:72.64px" class="cls_009"><span class="cls_009">305</span></div>
<div style="position:absolute;left:110.69px;top:83.34px" class="cls_017"><span class="cls_017">Implementing the delete ratings link</span></div>
<div style="position:absolute;left:469.71px;top:85.84px" class="cls_009"><span class="cls_009">308</span></div>
<div style="position:absolute;left:110.69px;top:96.54px" class="cls_017"><span class="cls_017">Adding the web script calls to SomeCo's whitepaper web page</span></div>
<div style="position:absolute;left:469.71px;top:99.04px" class="cls_009"><span class="cls_009">309</span></div>
<div style="position:absolute;left:110.69px;top:109.74px" class="cls_017"><span class="cls_017">Making other types of content rateable</span></div>
<div style="position:absolute;left:469.71px;top:112.24px" class="cls_009"><span class="cls_009">311</span></div>
<div style="position:absolute;left:110.69px;top:122.94px" class="cls_017"><span class="cls_017">Dealing with the cross-domain scripting limitation</span></div>
<div style="position:absolute;left:469.71px;top:125.44px" class="cls_009"><span class="cls_009">311</span></div>
<div style="position:absolute;left:92.69px;top:136.14px" class="cls_016"><span class="cls_016">Handling form data</span></div>
<div style="position:absolute;left:469.71px;top:138.64px" class="cls_009"><span class="cls_009">311</span></div>
<div style="position:absolute;left:110.69px;top:149.34px" class="cls_017"><span class="cls_017">Step-by-step - implementing a form-based Hello World</span></div>
<div style="position:absolute;left:469.71px;top:151.84px" class="cls_009"><span class="cls_009">312</span></div>
<div style="position:absolute;left:110.69px;top:162.54px" class="cls_017"><span class="cls_017">Step-by-step - using file upload in a multipart request</span></div>
<div style="position:absolute;left:469.71px;top:165.04px" class="cls_009"><span class="cls_009">313</span></div>
<div style="position:absolute;left:92.69px;top:175.74px" class="cls_016"><span class="cls_016">Advanced web scripts</span></div>
<div style="position:absolute;left:469.71px;top:178.24px" class="cls_009"><span class="cls_009">316</span></div>
<div style="position:absolute;left:110.69px;top:188.94px" class="cls_017"><span class="cls_017">Dealing with web script authentication</span></div>
<div style="position:absolute;left:469.71px;top:191.44px" class="cls_009"><span class="cls_009">317</span></div>
<div style="position:absolute;left:110.69px;top:202.14px" class="cls_017"><span class="cls_017">Controlling web script cache</span></div>
<div style="position:absolute;left:469.71px;top:204.64px" class="cls_009"><span class="cls_009">318</span></div>
<div style="position:absolute;left:92.69px;top:215.34px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:217.84px" class="cls_009"><span class="cls_009">319</span></div>
<div style="position:absolute;left:56.69px;top:230.73px" class="cls_015"><span class="cls_015">Chapter 8: Advanced Workflow</span></div>
<div style="position:absolute;left:469.71px;top:234.49px" class="cls_009"><span class="cls_009">320</span></div>
<div style="position:absolute;left:92.69px;top:248.19px" class="cls_016"><span class="cls_016">What is a workflow?</span></div>
<div style="position:absolute;left:469.71px;top:250.69px" class="cls_009"><span class="cls_009">321</span></div>
<div style="position:absolute;left:110.69px;top:261.39px" class="cls_017"><span class="cls_017">Workflow options</span></div>
<div style="position:absolute;left:469.71px;top:263.89px" class="cls_009"><span class="cls_009">322</span></div>
<div style="position:absolute;left:128.69px;top:274.69px" class="cls_009"><span class="cls_009">Roll your own</span></div>
<div style="position:absolute;left:469.71px;top:274.69px" class="cls_009"><span class="cls_009">323</span></div>
<div style="position:absolute;left:128.69px;top:285.49px" class="cls_009"><span class="cls_009">Standalone engines</span></div>
<div style="position:absolute;left:469.71px;top:285.49px" class="cls_009"><span class="cls_009">323</span></div>
<div style="position:absolute;left:128.69px;top:296.29px" class="cls_009"><span class="cls_009">Embedded workflow engines</span></div>
<div style="position:absolute;left:469.71px;top:296.29px" class="cls_009"><span class="cls_009">323</span></div>
<div style="position:absolute;left:92.69px;top:306.99px" class="cls_016"><span class="cls_016">Creating process definitions</span></div>
<div style="position:absolute;left:469.71px;top:309.49px" class="cls_009"><span class="cls_009">324</span></div>
<div style="position:absolute;left:110.69px;top:320.19px" class="cls_017"><span class="cls_017">Step-by-step - creating a Hello World process definition</span></div>
<div style="position:absolute;left:469.71px;top:322.69px" class="cls_009"><span class="cls_009">325</span></div>
<div style="position:absolute;left:92.69px;top:333.39px" class="cls_016"><span class="cls_016">Using the Activiti graphical process designer</span></div>
<div style="position:absolute;left:469.71px;top:335.89px" class="cls_009"><span class="cls_009">328</span></div>
<div style="position:absolute;left:110.69px;top:346.59px" class="cls_017"><span class="cls_017">Step-by-Step - using Activiti process designer to create processes</span></div>
<div style="position:absolute;left:469.71px;top:349.09px" class="cls_009"><span class="cls_009">330</span></div>
<div style="position:absolute;left:128.69px;top:359.89px" class="cls_009"><span class="cls_009">Tokens</span></div>
<div style="position:absolute;left:469.71px;top:359.89px" class="cls_009"><span class="cls_009">335</span></div>
<div style="position:absolute;left:128.69px;top:370.69px" class="cls_009"><span class="cls_009">Node types</span></div>
<div style="position:absolute;left:469.71px;top:370.69px" class="cls_009"><span class="cls_009">335</span></div>
<div style="position:absolute;left:128.69px;top:381.49px" class="cls_009"><span class="cls_009">Versioning process definitions</span></div>
<div style="position:absolute;left:469.71px;top:381.49px" class="cls_009"><span class="cls_009">336</span></div>
<div style="position:absolute;left:128.69px;top:392.29px" class="cls_009"><span class="cls_009">Using alternative deployment methods</span></div>
<div style="position:absolute;left:469.71px;top:392.29px" class="cls_009"><span class="cls_009">336</span></div>
<div style="position:absolute;left:92.69px;top:402.99px" class="cls_016"><span class="cls_016">Wiring a process to the Alfresco UI</span></div>
<div style="position:absolute;left:469.71px;top:405.49px" class="cls_009"><span class="cls_009">337</span></div>
<div style="position:absolute;left:110.69px;top:416.19px" class="cls_017"><span class="cls_017">Step-by-step - grabbing the Hello World argument from the user</span></div>
<div style="position:absolute;left:469.71px;top:418.69px" class="cls_009"><span class="cls_009">338</span></div>
<div style="position:absolute;left:128.69px;top:429.49px" class="cls_009"><span class="cls_009">Understanding workflow-specific content models</span></div>
<div style="position:absolute;left:469.71px;top:429.49px" class="cls_009"><span class="cls_009">347</span></div>
<div style="position:absolute;left:92.69px;top:440.19px" class="cls_016"><span class="cls_016">Assigning tasks to users and groups</span></div>
<div style="position:absolute;left:469.71px;top:442.69px" class="cls_009"><span class="cls_009">348</span></div>
<div style="position:absolute;left:110.69px;top:453.39px" class="cls_017"><span class="cls_017">Step-by-step - creating the initial Whitepaper submission workflow</span></div>
<div style="position:absolute;left:469.71px;top:455.89px" class="cls_009"><span class="cls_009">350</span></div>
<div style="position:absolute;left:110.69px;top:466.59px" class="cls_017"><span class="cls_017">Controlling what actions can be taken from the Task Management</span></div>
<div style="position:absolute;left:110.69px;top:479.79px" class="cls_017"><span class="cls_017">dialog</span></div>
<div style="position:absolute;left:469.71px;top:482.29px" class="cls_009"><span class="cls_009">360</span></div>
<div style="position:absolute;left:110.69px;top:492.99px" class="cls_017"><span class="cls_017">Enabling the Workflow Initiator to Select Users and Groups</span></div>
<div style="position:absolute;left:469.71px;top:495.49px" class="cls_009"><span class="cls_009">361</span></div>
<div style="position:absolute;left:110.69px;top:506.19px" class="cls_017"><span class="cls_017">Step-by-step - use dynamic user assignment</span></div>
<div style="position:absolute;left:469.71px;top:508.69px" class="cls_009"><span class="cls_009">362</span></div>
<div style="position:absolute;left:92.69px;top:519.39px" class="cls_016"><span class="cls_016">Adding Logic to Workflows with Listeners and Process Variables</span></div>
<div style="position:absolute;left:469.71px;top:521.89px" class="cls_009"><span class="cls_009">365</span></div>
<div style="position:absolute;left:110.69px;top:532.59px" class="cls_017"><span class="cls_017">Storing Data in Process Variables</span></div>
<div style="position:absolute;left:469.71px;top:535.09px" class="cls_009"><span class="cls_009">365</span></div>
<div style="position:absolute;left:110.69px;top:545.79px" class="cls_017"><span class="cls_017">Step-by-step - adding logic to the Whitepaper submission workflow</span></div>
<div style="position:absolute;left:469.71px;top:548.29px" class="cls_009"><span class="cls_009">367</span></div>
<div style="position:absolute;left:110.69px;top:558.99px" class="cls_017"><span class="cls_017">Getting access to the content in the workflow</span></div>
<div style="position:absolute;left:469.71px;top:561.49px" class="cls_009"><span class="cls_009">370</span></div>
<div style="position:absolute;left:110.69px;top:572.19px" class="cls_017"><span class="cls_017">Using multi-instances</span></div>
<div style="position:absolute;left:469.71px;top:574.69px" class="cls_009"><span class="cls_009">370</span></div>
<div style="position:absolute;left:258.38px;top:605.74px" class="cls_018"><span class="cls_018">[ vi ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:9464px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background015.jpg" width="541" height="666"></div>
<div style="position:absolute;left:92.69px;top:70.14px" class="cls_016"><span class="cls_016">Using the Activiti API</span></div>
<div style="position:absolute;left:469.71px;top:72.64px" class="cls_009"><span class="cls_009">372</span></div>
<div style="position:absolute;left:110.69px;top:83.34px" class="cls_017"><span class="cls_017">Step-by-step - implementing third-party review</span></div>
<div style="position:absolute;left:469.71px;top:85.84px" class="cls_009"><span class="cls_009">373</span></div>
<div style="position:absolute;left:110.69px;top:96.54px" class="cls_017"><span class="cls_017">Making the third-party review more robust</span></div>
<div style="position:absolute;left:469.71px;top:99.04px" class="cls_009"><span class="cls_009">388</span></div>
<div style="position:absolute;left:92.69px;top:109.74px" class="cls_016"><span class="cls_016">Using timers</span></div>
<div style="position:absolute;left:469.71px;top:112.24px" class="cls_009"><span class="cls_009">389</span></div>
<div style="position:absolute;left:110.69px;top:122.94px" class="cls_017"><span class="cls_017">Step-by-step - adding a timer to the third-party review</span></div>
<div style="position:absolute;left:469.71px;top:125.44px" class="cls_009"><span class="cls_009">389</span></div>
<div style="position:absolute;left:92.69px;top:136.14px" class="cls_016"><span class="cls_016">Debugging workflows</span></div>
<div style="position:absolute;left:469.71px;top:138.64px" class="cls_009"><span class="cls_009">392</span></div>
<div style="position:absolute;left:92.69px;top:149.34px" class="cls_016"><span class="cls_016">Comparing Alfresco workflow options</span></div>
<div style="position:absolute;left:469.71px;top:151.84px" class="cls_009"><span class="cls_009">393</span></div>
<div style="position:absolute;left:92.69px;top:162.54px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:165.04px" class="cls_009"><span class="cls_009">394</span></div>
<div style="position:absolute;left:56.69px;top:177.93px" class="cls_015"><span class="cls_015">Chapter 9: Amazing Extensions</span></div>
<div style="position:absolute;left:469.71px;top:181.69px" class="cls_009"><span class="cls_009">396</span></div>
<div style="position:absolute;left:92.69px;top:195.39px" class="cls_016"><span class="cls_016">Configure and use the search manager</span></div>
<div style="position:absolute;left:469.71px;top:197.89px" class="cls_009"><span class="cls_009">396</span></div>
<div style="position:absolute;left:92.69px;top:208.59px" class="cls_016"><span class="cls_016">Configure and use the Smart Folders</span></div>
<div style="position:absolute;left:469.71px;top:211.09px" class="cls_009"><span class="cls_009">401</span></div>
<div style="position:absolute;left:110.69px;top:221.79px" class="cls_017"><span class="cls_017">Step-by-step - create your own Smart Folder template</span></div>
<div style="position:absolute;left:469.71px;top:224.29px" class="cls_009"><span class="cls_009">409</span></div>
<div style="position:absolute;left:92.69px;top:234.99px" class="cls_016"><span class="cls_016">Alfresco mobile</span></div>
<div style="position:absolute;left:469.71px;top:237.49px" class="cls_009"><span class="cls_009">416</span></div>
<div style="position:absolute;left:110.69px;top:248.19px" class="cls_017"><span class="cls_017">Step-by-step - import and run the Alfresco Sample UI</span></div>
<div style="position:absolute;left:469.71px;top:250.69px" class="cls_009"><span class="cls_009">418</span></div>
<div style="position:absolute;left:110.69px;top:261.39px" class="cls_017"><span class="cls_017">Step-by-step - create SomeCo mobile application</span></div>
<div style="position:absolute;left:469.71px;top:263.89px" class="cls_009"><span class="cls_009">427</span></div>
<div style="position:absolute;left:92.69px;top:274.59px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:277.09px" class="cls_009"><span class="cls_009">434</span></div>
<div style="position:absolute;left:56.69px;top:289.98px" class="cls_015"><span class="cls_015">Chapter 10: Security</span></div>
<div style="position:absolute;left:469.71px;top:293.74px" class="cls_009"><span class="cls_009">435</span></div>
<div style="position:absolute;left:92.69px;top:307.44px" class="cls_016"><span class="cls_016">Authenticating and synchronizing with LDAP</span></div>
<div style="position:absolute;left:469.71px;top:309.94px" class="cls_009"><span class="cls_009">435</span></div>
<div style="position:absolute;left:110.69px;top:320.64px" class="cls_017"><span class="cls_017">Step-by-step - setting up a local OpenLDAP server</span></div>
<div style="position:absolute;left:469.71px;top:323.14px" class="cls_009"><span class="cls_009">436</span></div>
<div style="position:absolute;left:110.69px;top:333.84px" class="cls_017"><span class="cls_017">Step-by-step - configuring Alfresco to authenticate against LDAP</span></div>
<div style="position:absolute;left:469.71px;top:336.34px" class="cls_009"><span class="cls_009">442</span></div>
<div style="position:absolute;left:110.69px;top:347.04px" class="cls_017"><span class="cls_017">Step-by-step - configuring chaining</span></div>
<div style="position:absolute;left:469.71px;top:349.54px" class="cls_009"><span class="cls_009">446</span></div>
<div style="position:absolute;left:92.69px;top:360.24px" class="cls_016"><span class="cls_016">Setting up Single Sign-On (SSO)</span></div>
<div style="position:absolute;left:469.71px;top:362.74px" class="cls_009"><span class="cls_009">447</span></div>
<div style="position:absolute;left:110.69px;top:373.44px" class="cls_017"><span class="cls_017">Step-by-step - implementing SSO</span></div>
<div style="position:absolute;left:469.71px;top:375.94px" class="cls_009"><span class="cls_009">448</span></div>
<div style="position:absolute;left:128.69px;top:386.74px" class="cls_009"><span class="cls_009">Logging Out</span></div>
<div style="position:absolute;left:469.71px;top:386.74px" class="cls_009"><span class="cls_009">465</span></div>
<div style="position:absolute;left:110.69px;top:397.44px" class="cls_017"><span class="cls_017">Step-by-step - configuring CAS to use LDAP for authentication</span></div>
<div style="position:absolute;left:469.71px;top:399.94px" class="cls_009"><span class="cls_009">465</span></div>
<div style="position:absolute;left:92.69px;top:410.64px" class="cls_016"><span class="cls_016">Working with security services</span></div>
<div style="position:absolute;left:469.71px;top:413.14px" class="cls_009"><span class="cls_009">472</span></div>
<div style="position:absolute;left:110.69px;top:423.84px" class="cls_017"><span class="cls_017">Securing the admin user</span></div>
<div style="position:absolute;left:469.71px;top:426.34px" class="cls_009"><span class="cls_009">472</span></div>
<div style="position:absolute;left:110.69px;top:437.04px" class="cls_017"><span class="cls_017">Granting additional users admin rights</span></div>
<div style="position:absolute;left:469.71px;top:439.54px" class="cls_009"><span class="cls_009">472</span></div>
<div style="position:absolute;left:110.69px;top:450.24px" class="cls_017"><span class="cls_017">Creating users and Groups Programmatically</span></div>
<div style="position:absolute;left:469.71px;top:452.74px" class="cls_009"><span class="cls_009">474</span></div>
<div style="position:absolute;left:128.69px;top:463.54px" class="cls_009"><span class="cls_009">Step-by-step - creating users and groups through the Java services</span></div>
<div style="position:absolute;left:469.71px;top:463.54px" class="cls_009"><span class="cls_009">477</span></div>
<div style="position:absolute;left:110.69px;top:474.24px" class="cls_017"><span class="cls_017">Understanding permission definitions</span></div>
<div style="position:absolute;left:469.71px;top:476.74px" class="cls_009"><span class="cls_009">483</span></div>
<div style="position:absolute;left:128.69px;top:487.54px" class="cls_009"><span class="cls_009">Permission groups</span></div>
<div style="position:absolute;left:469.71px;top:487.54px" class="cls_009"><span class="cls_009">484</span></div>
<div style="position:absolute;left:128.69px;top:498.34px" class="cls_009"><span class="cls_009">Permissions</span></div>
<div style="position:absolute;left:469.71px;top:498.34px" class="cls_009"><span class="cls_009">486</span></div>
<div style="position:absolute;left:128.69px;top:509.14px" class="cls_009"><span class="cls_009">Permission sets</span></div>
<div style="position:absolute;left:469.71px;top:509.14px" class="cls_009"><span class="cls_009">486</span></div>
<div style="position:absolute;left:128.69px;top:519.94px" class="cls_009"><span class="cls_009">Step-by-step - setting up a publisher custom role</span></div>
<div style="position:absolute;left:469.71px;top:519.94px" class="cls_009"><span class="cls_009">487</span></div>
<div style="position:absolute;left:128.69px;top:530.74px" class="cls_009"><span class="cls_009">Global Permissions</span></div>
<div style="position:absolute;left:469.71px;top:530.74px" class="cls_009"><span class="cls_009">494</span></div>
<div style="position:absolute;left:128.69px;top:541.54px" class="cls_009"><span class="cls_009">Mapping Permissions to Methods</span></div>
<div style="position:absolute;left:469.71px;top:541.54px" class="cls_009"><span class="cls_009">494</span></div>
<div style="position:absolute;left:92.69px;top:552.24px" class="cls_016"><span class="cls_016">Summary</span></div>
<div style="position:absolute;left:469.71px;top:554.74px" class="cls_009"><span class="cls_009">495</span></div>
<div style="position:absolute;left:56.69px;top:567.63px" class="cls_015"><span class="cls_015">Index</span></div>
<div style="position:absolute;left:469.71px;top:571.39px" class="cls_009"><span class="cls_009">497</span></div>
<div style="position:absolute;left:256.38px;top:605.74px" class="cls_018"><span class="cls_018">[ vii ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:10140px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background016.jpg" width="541" height="666"></div>
<div style="position:absolute;left:381.34px;top:69.12px" class="cls_011"><span class="cls_011">Preface</span></div>
<div style="position:absolute;left:56.69px;top:128.10px" class="cls_004"><span class="cls_004">Alfresco is the leading open source platform for Enterprise Content Management. The</span></div>
<div style="position:absolute;left:56.69px;top:140.70px" class="cls_004"><span class="cls_004">evolution of the product has been quite impressive during the last 10 years. The first edition</span></div>
<div style="position:absolute;left:56.69px;top:153.30px" class="cls_004"><span class="cls_004">of this book has been published in 2008, and after 8 years, it really needed an update. This</span></div>
<div style="position:absolute;left:56.69px;top:165.90px" class="cls_004"><span class="cls_004">new book will give you some insights on the most advanced capabilities of the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:178.50px" class="cls_004"><span class="cls_004">platform. This book takes you through the process of customizing and extending the</span></div>
<div style="position:absolute;left:56.69px;top:191.10px" class="cls_004"><span class="cls_004">Alfresco engine, the out-of-the-box user interface Alfresco Share that will suit most of your</span></div>
<div style="position:absolute;left:56.69px;top:203.70px" class="cls_004"><span class="cls_004">requirements in terms of document collaboration. It uses a fictitious professional services</span></div>
<div style="position:absolute;left:56.69px;top:216.30px" class="cls_004"><span class="cls_004">company called "SomeCo" as an example. SomeCo has decided to roll out Alfresco across</span></div>
<div style="position:absolute;left:56.69px;top:228.90px" class="cls_004"><span class="cls_004">the enterprise. Your job is to take advantage of Alfresco's extension mechanism, workflow</span></div>
<div style="position:absolute;left:56.69px;top:241.50px" class="cls_004"><span class="cls_004">engine, and various APIs and SDKs to meet the requirements from SomeCo's various</span></div>
<div style="position:absolute;left:56.69px;top:254.10px" class="cls_004"><span class="cls_004">departments. Although many customizations can be made by editing XML and properties</span></div>
<div style="position:absolute;left:56.69px;top:266.70px" class="cls_004"><span class="cls_004">files, this book is focused on developers. That might mean writing Java code against the</span></div>
<div style="position:absolute;left:56.69px;top:279.30px" class="cls_004"><span class="cls_004">Alfresco API to implement an action or a behavior, maybe creating some server-side</span></div>
<div style="position:absolute;left:56.69px;top:291.90px" class="cls_004"><span class="cls_004">JavaScript to use as the controller of a RESTful web script, or perhaps implementing custom</span></div>
<div style="position:absolute;left:56.69px;top:304.50px" class="cls_004"><span class="cls_004">business logic in an advanced workflow. The point is that all but the most basic</span></div>
<div style="position:absolute;left:56.69px;top:317.10px" class="cls_004"><span class="cls_004">implementations of any ECM platform require code to be written. The goal of this book is to</span></div>
<div style="position:absolute;left:56.69px;top:329.70px" class="cls_004"><span class="cls_004">help you identify patterns, techniques, and specific steps that you can use to become</span></div>
<div style="position:absolute;left:56.69px;top:342.30px" class="cls_004"><span class="cls_004">productive on the platform more quickly. By the end of this book, you will have stepped</span></div>
<div style="position:absolute;left:56.69px;top:354.90px" class="cls_004"><span class="cls_004">through every aspect of the Alfresco platform. You will have performed the same types of</span></div>
<div style="position:absolute;left:56.69px;top:367.50px" class="cls_004"><span class="cls_004">customizations and extensions found in typical Alfresco implementations. You’ll have</span></div>
<div style="position:absolute;left:56.69px;top:380.10px" class="cls_004"><span class="cls_004">discovered the Mobile Alfresco SDK and creates your own mobile application. Finally,</span></div>
<div style="position:absolute;left:56.69px;top:392.70px" class="cls_004"><span class="cls_004">you’ll get a preview of the latest Alfresco Development Framework (ADF) based on</span></div>
<div style="position:absolute;left:56.69px;top:405.30px" class="cls_004"><span class="cls_004">Angular. Most importantly, when someone comes to you and asks, "How would you do</span></div>
<div style="position:absolute;left:56.69px;top:417.90px" class="cls_004"><span class="cls_004">this in Alfresco?", you'll have at least one answer and maybe even some source code to go</span></div>
<div style="position:absolute;left:56.69px;top:430.50px" class="cls_004"><span class="cls_004">with it.</span></div>
<div style="position:absolute;left:56.69px;top:460.25px" class="cls_008"><span class="cls_008">What this book covers</span></div>
<div style="position:absolute;left:56.69px;top:487.99px" class="cls_010"><span class="cls_010">Chapter 1</span><span class="cls_004">, </span><span class="cls_012">The Alfresco Platform</span><span class="cls_004">, is for people new to the Alfresco platform. It walks you</span></div>
<div style="position:absolute;left:56.69px;top:500.97px" class="cls_004"><span class="cls_004">through the capabilities of Alfresco and gives some examples of the types of solutions that</span></div>
<div style="position:absolute;left:56.69px;top:513.57px" class="cls_004"><span class="cls_004">can be built on the platform. You'll also learn what tools and skills are required to</span></div>
<div style="position:absolute;left:56.69px;top:526.17px" class="cls_004"><span class="cls_004">implement Alfresco-based solutions.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:10816px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background017.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Preface</span></div>
<div style="position:absolute;left:56.69px;top:70.51px" class="cls_010"><span class="cls_010">Chapter 2</span><span class="cls_004">, </span><span class="cls_012">Getting Started with Alfresco,</span><span class="cls_004"> is about getting your development environment set</span></div>
<div style="position:absolute;left:56.69px;top:83.49px" class="cls_004"><span class="cls_004">up. Like preparing for a home improvement project, this is the trip to the hardware store to</span></div>
<div style="position:absolute;left:56.69px;top:96.09px" class="cls_004"><span class="cls_004">get the tools and supplies you'll need to get the job done. Throughout the book, you will be</span></div>
<div style="position:absolute;left:56.69px;top:108.69px" class="cls_004"><span class="cls_004">building and deploying changes. So just as in any software development project, it pays to</span></div>
<div style="position:absolute;left:56.69px;top:121.29px" class="cls_004"><span class="cls_004">get that process working up front. You'll also learn about the debugging tools that are</span></div>
<div style="position:absolute;left:56.69px;top:133.89px" class="cls_004"><span class="cls_004">available to you. The chapter includes a short and simple customization example to test out</span></div>
<div style="position:absolute;left:56.69px;top:146.49px" class="cls_004"><span class="cls_004">your setup.</span></div>
<div style="position:absolute;left:56.69px;top:168.09px" class="cls_010"><span class="cls_010">Chapter 3</span><span class="cls_012">, Working with Content Models,</span><span class="cls_004"> starts where all Alfresco projects should begin:</span></div>
<div style="position:absolute;left:56.69px;top:181.07px" class="cls_004"><span class="cls_004">defining the content model. You'll learn how to define the content model as well as how to</span></div>
<div style="position:absolute;left:56.69px;top:193.67px" class="cls_004"><span class="cls_004">expose the model to Alfresco Share. Once you've got it in place, you'll write some Java code</span></div>
<div style="position:absolute;left:56.69px;top:206.27px" class="cls_004"><span class="cls_004">that utilizes the CMIS API to test out the model. This will also be your first taste of the</span></div>
<div style="position:absolute;left:56.69px;top:218.87px" class="cls_004"><span class="cls_004">JavaScript API. The exercises set up the initial content model for SomeCo.</span></div>
<div style="position:absolute;left:56.69px;top:240.48px" class="cls_010"><span class="cls_010">Chapter 4</span><span class="cls_012">, Handling Content Automatically with Actions, Behaviors, Transformers, and</span></div>
<div style="position:absolute;left:56.69px;top:253.46px" class="cls_012"><span class="cls_012">Extractors</span><span class="cls_004">, begins to show you the power of the repository by exposing you to some of the</span></div>
<div style="position:absolute;left:56.69px;top:266.06px" class="cls_004"><span class="cls_004">mechanisms or hooks that can be used to perform "hands off" operations on content. You'll</span></div>
<div style="position:absolute;left:56.69px;top:278.66px" class="cls_004"><span class="cls_004">learn about actions, behaviors, transformers, and metadata extractors. The exercises include</span></div>
<div style="position:absolute;left:56.69px;top:291.26px" class="cls_004"><span class="cls_004">implementing a rule action for SomeCo's Human Resources department to help manage HR</span></div>
<div style="position:absolute;left:56.69px;top:303.86px" class="cls_004"><span class="cls_004">policies, writing a custom behavior to calculate user ratings, and writing a custom metadata</span></div>
<div style="position:absolute;left:56.69px;top:316.46px" class="cls_004"><span class="cls_004">extractor to make Microsoft Project files indexable by SolR.</span></div>
<div style="position:absolute;left:56.69px;top:338.07px" class="cls_010"><span class="cls_010">Chapter 5</span><span class="cls_012">, Customizing Alfresco Share,</span><span class="cls_004"> takes you through Alfresco Share customizations.</span></div>
<div style="position:absolute;left:56.69px;top:351.05px" class="cls_004"><span class="cls_004">First, it establishes whether or not you should be customizing the user interface at all. Once</span></div>
<div style="position:absolute;left:56.69px;top:363.65px" class="cls_004"><span class="cls_004">that's out of the way, you learn how to add new menu or action items, how to create your</span></div>
<div style="position:absolute;left:56.69px;top:376.25px" class="cls_004"><span class="cls_004">own custom metadata template, how to develop new pages and dashlets, and how to define</span></div>
<div style="position:absolute;left:56.69px;top:388.85px" class="cls_004"><span class="cls_004">new dialogs to gather information from a user.</span></div>
<div style="position:absolute;left:56.69px;top:410.45px" class="cls_010"><span class="cls_010">Chapter 6</span><span class="cls_004">, </span><span class="cls_012">Creating an Angular Application</span><span class="cls_004">, shows you how to use the new Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:423.43px" class="cls_004"><span class="cls_004">Development Framework (ADF) released in 2016. First, you start by discovering the new</span></div>
<div style="position:absolute;left:56.69px;top:436.03px" class="cls_004"><span class="cls_004">JavaScript library that you could include in any of your web applications. Then, you</span></div>
<div style="position:absolute;left:56.69px;top:448.63px" class="cls_004"><span class="cls_004">discover the new user interface implemented in AngularJS, and test all available current</span></div>
<div style="position:absolute;left:56.69px;top:461.23px" class="cls_004"><span class="cls_004">components. At the time of writing, this framework is only an early release and is not</span></div>
<div style="position:absolute;left:56.69px;top:473.83px" class="cls_004"><span class="cls_004">suitable for production. However, we are convinced that this framework will become an</span></div>
<div style="position:absolute;left:56.69px;top:486.43px" class="cls_004"><span class="cls_004">important component for any Alfresco developer.</span></div>
<div style="position:absolute;left:56.69px;top:508.04px" class="cls_010"><span class="cls_010">Chapter 7</span><span class="cls_012">, Exposing Content through a RESTful API with Web Scripts,</span><span class="cls_004"> focuses on the web</span></div>
<div style="position:absolute;left:56.69px;top:521.02px" class="cls_004"><span class="cls_004">script framework. Web scripts are an important part of the platform because they allow you</span></div>
<div style="position:absolute;left:56.69px;top:533.62px" class="cls_004"><span class="cls_004">to expose the repository through a RESTful API. The exercises in this chapter are about</span></div>
<div style="position:absolute;left:56.69px;top:546.22px" class="cls_004"><span class="cls_004">creating a set of URLs that can be called from the frontend web site to retrieve and persist</span></div>
<div style="position:absolute;left:56.69px;top:558.82px" class="cls_004"><span class="cls_004">user ratings of objects in the repository.</span></div>
<div style="position:absolute;left:260.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 2 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:11492px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background018.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Preface</span></div>
<div style="position:absolute;left:56.69px;top:70.51px" class="cls_010"><span class="cls_010">Chapter 8</span><span class="cls_012">, Advanced Workflows</span><span class="cls_004">, is about the embedded Activiti workflow engine, how it</span></div>
<div style="position:absolute;left:56.69px;top:83.49px" class="cls_004"><span class="cls_004">works and how to define your own workflows, including how to implement your own</span></div>
<div style="position:absolute;left:56.69px;top:96.09px" class="cls_004"><span class="cls_004">business logic. The chapter includes a comparison between the capabilities of Alfresco's</span></div>
<div style="position:absolute;left:56.69px;top:108.69px" class="cls_004"><span class="cls_004">simple workflow and advanced workflow so that you can decide which one is appropriate</span></div>
<div style="position:absolute;left:56.69px;top:121.29px" class="cls_004"><span class="cls_004">for your needs. By the end of the chapter, you will have built a workflow that SomeCo will</span></div>
<div style="position:absolute;left:56.69px;top:133.89px" class="cls_004"><span class="cls_004">use to review and approve Whitepapers for external publication.</span></div>
<div style="position:absolute;left:56.69px;top:155.49px" class="cls_010"><span class="cls_010">Chapter 9</span><span class="cls_012">, Amazing Extensions, </span><span class="cls_004">shows you one of the most amazing extensions including</span></div>
<div style="position:absolute;left:56.69px;top:168.47px" class="cls_004"><span class="cls_004">the use of facets configured with the search manager. Then, you discover what are smart</span></div>
<div style="position:absolute;left:56.69px;top:181.07px" class="cls_004"><span class="cls_004">folders and how to use them. After, you create your own template for SomeCo</span></div>
<div style="position:absolute;left:56.69px;top:193.67px" class="cls_004"><span class="cls_004">Whitepapers. Finally, you even create your own mobile application connected to your</span></div>
<div style="position:absolute;left:56.69px;top:206.27px" class="cls_004"><span class="cls_004">Alfresco instance.</span></div>
<div style="position:absolute;left:56.69px;top:227.88px" class="cls_010"><span class="cls_010">Chapter 10</span><span class="cls_012">, Security,</span><span class="cls_004"> covers a variety of security-related topics. You'll learn how to define</span></div>
<div style="position:absolute;left:56.69px;top:240.86px" class="cls_004"><span class="cls_004">your own custom roles, and how to create users and groups with the API. Although not</span></div>
<div style="position:absolute;left:56.69px;top:253.46px" class="cls_004"><span class="cls_004">strictly developer-centric, you'll also learn how to configure Alfresco to authenticate and</span></div>
<div style="position:absolute;left:56.69px;top:266.06px" class="cls_004"><span class="cls_004">synchronize with an LDAP directory and how to implement Single Sign-On (SSO) between</span></div>
<div style="position:absolute;left:56.69px;top:278.66px" class="cls_004"><span class="cls_004">Alfresco and other web resources.</span></div>
<div style="position:absolute;left:56.69px;top:308.41px" class="cls_008"><span class="cls_008">What you need for this book</span></div>
<div style="position:absolute;left:56.69px;top:336.14px" class="cls_004"><span class="cls_004">To work through the examples in this book, you will need:</span></div>
<div style="position:absolute;left:104.69px;top:357.87px" class="cls_004"><span class="cls_004">Alfresco. Preferably Enterprise, but Community should work, except for some</span></div>
<div style="position:absolute;left:104.69px;top:370.47px" class="cls_004"><span class="cls_004">advanced chapters. The examples have been tested on Alfresco from 5.1</span></div>
<div style="position:absolute;left:104.69px;top:385.23px" class="cls_004"><span class="cls_004">Spring Tool Suite (STS)</span></div>
<div style="position:absolute;left:104.69px;top:399.99px" class="cls_004"><span class="cls_004">Apache Maven</span></div>
<div style="position:absolute;left:104.69px;top:414.75px" class="cls_004"><span class="cls_004">Vagrant (to create your virtual machines)</span></div>
<div style="position:absolute;left:104.69px;top:429.51px" class="cls_004"><span class="cls_004">Appcelerator (to create your mobile application)</span></div>
<div style="position:absolute;left:56.69px;top:453.40px" class="cls_004"><span class="cls_004">There are other tools or libraries that you will need for certain exercises, which will be</span></div>
<div style="position:absolute;left:56.69px;top:466.00px" class="cls_004"><span class="cls_004">mentioned as necessary.</span></div>
<div style="position:absolute;left:260.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 3 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:12168px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background019.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Preface</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Who this book is for</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">This book will be most useful to developers who are writing code to customize Alfresco for</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">their organization or who are creating custom applications that sit on top of Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:131.58px" class="cls_004"><span class="cls_004">This book is for Java developers, and you will get most from the book if you already work</span></div>
<div style="position:absolute;left:56.69px;top:144.18px" class="cls_004"><span class="cls_004">with Java, but you need not have prior experience on Alfresco. Although Alfresco makes</span></div>
<div style="position:absolute;left:56.69px;top:156.78px" class="cls_004"><span class="cls_004">heavy use of open source frameworks such as Spring, Hibernate, no prior experience using</span></div>
<div style="position:absolute;left:56.69px;top:169.38px" class="cls_004"><span class="cls_004">these is assumed or necessary.</span></div>
<div style="position:absolute;left:56.69px;top:199.13px" class="cls_008"><span class="cls_008">Conventions</span></div>
<div style="position:absolute;left:56.69px;top:226.86px" class="cls_004"><span class="cls_004">In this book, you will find a number of styles of text that distinguish between different</span></div>
<div style="position:absolute;left:56.69px;top:239.46px" class="cls_004"><span class="cls_004">kinds of information. Here are some examples of these styles, and an explanation of their</span></div>
<div style="position:absolute;left:56.69px;top:252.06px" class="cls_004"><span class="cls_004">meaning.</span></div>
<div style="position:absolute;left:56.69px;top:273.66px" class="cls_004"><span class="cls_004">Code words in text are shown as follows: "Let's clarify what's an AMP file or package. An</span></div>
<div style="position:absolute;left:56.69px;top:286.26px" class="cls_004"><span class="cls_004">AMP file is a </span><span class="cls_013">.zip</span><span class="cls_004"> file with the </span><span class="cls_013">.amp</span><span class="cls_004"> extension."</span></div>
<div style="position:absolute;left:56.69px;top:308.54px" class="cls_004"><span class="cls_004">A block of code will be set as follows:</span></div>
<div style="position:absolute;left:74.69px;top:329.46px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:85.49px;top:340.26px" class="cls_010"><span class="cls_010">"rating": {</span></div>
<div style="position:absolute;left:96.29px;top:351.06px" class="cls_010"><span class="cls_010">"average": 1.923,</span></div>
<div style="position:absolute;left:96.29px;top:361.86px" class="cls_010"><span class="cls_010">"count": 13</span></div>
<div style="position:absolute;left:85.49px;top:372.66px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:383.46px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:403.94px" class="cls_004"><span class="cls_004">When we wish to draw your attention to a particular part of a code block, the relevant lines</span></div>
<div style="position:absolute;left:56.69px;top:416.54px" class="cls_004"><span class="cls_004">or items will be made bold:</span></div>
<div style="position:absolute;left:74.69px;top:437.46px" class="cls_010"><span class="cls_010">enableLookups="false"</span></div>
<div style="position:absolute;left:74.69px;top:448.26px" class="cls_010"><span class="cls_010">disableUploadTimeout="true"</span></div>
<div style="position:absolute;left:74.69px;top:459.06px" class="cls_010"><span class="cls_010">acceptCount="100"</span></div>
<div style="position:absolute;left:74.69px;top:469.86px" class="cls_010"><span class="cls_010">scheme="https"</span></div>
<div style="position:absolute;left:74.69px;top:480.66px" class="cls_010"><span class="cls_010">secure="true"</span></div>
<div style="position:absolute;left:74.69px;top:491.46px" class="cls_020"><span class="cls_020">clientAuth="false"</span></div>
<div style="position:absolute;left:74.69px;top:502.26px" class="cls_020"><span class="cls_020">sslProtocol="TLS"</span></div>
<div style="position:absolute;left:74.69px;top:513.06px" class="cls_020"><span class="cls_020">keystoreFile="/root/.keystore"</span></div>
<div style="position:absolute;left:74.69px;top:523.86px" class="cls_020"><span class="cls_020">keystorePass="changeit"</span></div>
<div style="position:absolute;left:56.69px;top:544.34px" class="cls_004"><span class="cls_004">Any command-line input and output is written as follows:</span></div>
<div style="position:absolute;left:74.69px;top:565.26px" class="cls_010"><span class="cls_010">service alfresco start</span></div>
<div style="position:absolute;left:260.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 4 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:12844px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background020.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Preface</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">New terms and important words are shown in bold. Words that you see on the screen, for</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">example, in menus or dialog boxes, appear in the text like this: "When users log in to</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">Alfresco, the first thing that is usually displayed is the </span><span class="cls_007">My Dashboard</span><span class="cls_004"> section."</span></div>
<div style="position:absolute;left:122.09px;top:117.34px" class="cls_004"><span class="cls_004">Warnings or important notes appear in a box like this.</span></div>
<div style="position:absolute;left:122.09px;top:176.74px" class="cls_004"><span class="cls_004">Tips and tricks appear like this.</span></div>
<div style="position:absolute;left:56.69px;top:244.29px" class="cls_008"><span class="cls_008">Reader feedback</span></div>
<div style="position:absolute;left:56.69px;top:272.02px" class="cls_004"><span class="cls_004">Feedback from our readers is always welcome. Let us know what you think about this</span></div>
<div style="position:absolute;left:56.69px;top:284.62px" class="cls_004"><span class="cls_004">book-what you liked or disliked. Reader feedback is important for us as it helps us develop</span></div>
<div style="position:absolute;left:56.69px;top:297.22px" class="cls_004"><span class="cls_004">titles that you will really get the most out of. To send us general feedback, simply e-</span></div>
<div style="position:absolute;left:56.69px;top:309.82px" class="cls_004"><span class="cls_004">mail </span><span class="cls_013">feedback@packtpub.com</span><span class="cls_004">, and mention the book's title in the subject of your</span></div>
<div style="position:absolute;left:56.69px;top:323.10px" class="cls_004"><span class="cls_004">message. If there is a topic that you have expertise in and you are interested in either</span></div>
<div style="position:absolute;left:56.69px;top:335.70px" class="cls_004"><span class="cls_004">writing or contributing to a book, see our author guide at </span><a href="http://www.packtpub.com/authors">www.packtpub.com/authors</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:365.83px" class="cls_008"><span class="cls_008">Customer support</span></div>
<div style="position:absolute;left:56.69px;top:393.56px" class="cls_004"><span class="cls_004">Now that you are the proud owner of a Packt book, we have a number of things to help you</span></div>
<div style="position:absolute;left:56.69px;top:406.16px" class="cls_004"><span class="cls_004">to get the most from your purchase.</span></div>
<div style="position:absolute;left:56.69px;top:433.86px" class="cls_014"><span class="cls_014">Downloading the example code</span></div>
<div style="position:absolute;left:56.69px;top:459.08px" class="cls_004"><span class="cls_004">You can download the example code files for this book from your account at </span><a href="http://www.packtpub.com/">http://www.p</a> </div>
<div style="position:absolute;left:56.69px;top:472.06px" class="cls_010"><span class="cls_010"> </span><a href="http://www.packtpub.com/">acktpub.com</a><span class="cls_004">. If you purchased this book elsewhere, you can visit </span><a href="http://www.packtpub.com/support">http://www.packtpub.c</a> </div>
<div style="position:absolute;left:56.69px;top:485.04px" class="cls_010"><span class="cls_010"> </span><a href="http://www.packtpub.com/support">om/support</a> <span class="cls_004">and register to have the files e-mailed directly to you.</span></div>
<div style="position:absolute;left:56.69px;top:507.02px" class="cls_004"><span class="cls_004">You can download the code files by following these steps:</span></div>
<div style="position:absolute;left:91.32px;top:528.75px" class="cls_004"><span class="cls_004">1. Log in or register to our website using your e-mail address and password.</span></div>
<div style="position:absolute;left:91.32px;top:543.51px" class="cls_004"><span class="cls_004">2. Hover the mouse pointer on the </span><span class="cls_007">SUPPORT</span><span class="cls_004"> tab at the top.</span></div>
<div style="position:absolute;left:91.32px;top:558.30px" class="cls_004"><span class="cls_004">3. Click on </span><span class="cls_007">Code Downloads &amp; Errata</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:573.10px" class="cls_004"><span class="cls_004">4. Enter the name of the book in the </span><span class="cls_007">Search</span><span class="cls_004"> box.</span></div>
<div style="position:absolute;left:260.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 5 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:13520px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background021.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Preface</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Select the book for which you're looking to download the code files.</span></div>
<div style="position:absolute;left:91.32px;top:85.26px" class="cls_004"><span class="cls_004">6. Choose from the drop-down menu where you purchased this book from.</span></div>
<div style="position:absolute;left:91.32px;top:100.02px" class="cls_004"><span class="cls_004">7. Click on </span><span class="cls_007">Code Download</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:123.95px" class="cls_004"><span class="cls_004">Once the file is downloaded, please make sure that you unzip or extract the folder using the</span></div>
<div style="position:absolute;left:56.69px;top:136.55px" class="cls_004"><span class="cls_004">latest version of:</span></div>
<div style="position:absolute;left:104.69px;top:158.28px" class="cls_004"><span class="cls_004">WinRAR / 7-Zip for Windows</span></div>
<div style="position:absolute;left:104.69px;top:173.04px" class="cls_004"><span class="cls_004">Zipeg / iZip / UnRarX for Mac</span></div>
<div style="position:absolute;left:104.69px;top:187.80px" class="cls_004"><span class="cls_004">7-Zip / PeaZip for Linux</span></div>
<div style="position:absolute;left:56.69px;top:211.69px" class="cls_004"><span class="cls_004">The code bundle for the book is also hosted on GitHub at </span><a href="https://github.com/PacktPublishing/Alfresco-One-5x-Developers-GuideAlfresco-One-5x-Developers-Guide">https://github.com/PacktPubl</a> </div>
<div style="position:absolute;left:56.69px;top:224.67px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/PacktPublishing/Alfresco-One-5x-Developers-GuideAlfresco-One-5x-Developers-Guide">ishing/Alfresco-One-5x-Developers-GuideAlfresco-One-5x-Developers-Guide</a> <span class="cls_004">. We</span></div>
<div style="position:absolute;left:56.69px;top:237.65px" class="cls_004"><span class="cls_004">also have other code bundles from our rich catalog of books and videos available at </span><a href="https://github.com/PacktPublishing/">https</a> </div>
<div style="position:absolute;left:56.69px;top:250.63px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/PacktPublishing/">://github.com/PacktPublishing/</a> <span class="cls_004">. Check them out!</span></div>
<div style="position:absolute;left:56.69px;top:278.71px" class="cls_014"><span class="cls_014">Downloading the color images of this book</span></div>
<div style="position:absolute;left:56.69px;top:303.93px" class="cls_004"><span class="cls_004">We also provide you with a PDF file that has color images of the screenshots/diagrams used</span></div>
<div style="position:absolute;left:56.69px;top:316.53px" class="cls_004"><span class="cls_004">in this book. The color images will help you better understand the changes in the output.</span></div>
<div style="position:absolute;left:56.69px;top:329.13px" class="cls_004"><span class="cls_004">You can download this file from </span><a href="https://www.packtpub.com/sites/default/files/downloads/AlfrescoOne5xDevelopersGuide_ColorImages.pdf">https://www.packtpub.com/sites/default/files/down</a> </div>
<div style="position:absolute;left:56.69px;top:342.11px" class="cls_010"><span class="cls_010"> </span><a href="https://www.packtpub.com/sites/default/files/downloads/AlfrescoOne5xDevelopersGuide_ColorImages.pdf">loads/AlfrescoOne5xDevelopersGuide_ColorImages.pdf</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:370.18px" class="cls_014"><span class="cls_014">Errata</span></div>
<div style="position:absolute;left:56.69px;top:395.41px" class="cls_004"><span class="cls_004">Although we have taken every care to ensure the accuracy of our content, mistakes do</span></div>
<div style="position:absolute;left:56.69px;top:408.01px" class="cls_004"><span class="cls_004">happen. If you find a mistake in one of our books-maybe a mistake in the text or the code-</span></div>
<div style="position:absolute;left:56.69px;top:420.61px" class="cls_004"><span class="cls_004">we would be grateful if you could report this to us. By doing so, you can save other readers</span></div>
<div style="position:absolute;left:56.69px;top:433.21px" class="cls_004"><span class="cls_004">from frustration and help us improve subsequent versions of this book. If you find any</span></div>
<div style="position:absolute;left:56.69px;top:445.81px" class="cls_004"><span class="cls_004">errata, please report them by visiting </span><a href="http://www.packtpub.com/submit-errata">http://www.packtpub.com/submit-errata</a> <span class="cls_004">, selecting</span></div>
<div style="position:absolute;left:56.69px;top:458.79px" class="cls_004"><span class="cls_004">your book, clicking on the </span><span class="cls_007">Errata Submission Form</span><span class="cls_004"> link, and entering the details of your</span></div>
<div style="position:absolute;left:56.69px;top:471.42px" class="cls_004"><span class="cls_004">errata. Once your errata are verified, your submission will be accepted and the errata will</span></div>
<div style="position:absolute;left:56.69px;top:484.02px" class="cls_004"><span class="cls_004">be uploaded to our website or added to any list of existing errata under the Errata section of</span></div>
<div style="position:absolute;left:56.69px;top:496.62px" class="cls_004"><span class="cls_004">that title.</span></div>
<div style="position:absolute;left:56.69px;top:518.22px" class="cls_004"><span class="cls_004">To view the previously submitted errata, go to </span><a href="https://www.packtpub.com/books/content/support">https://www.packtpub.com/books/conten</a> </div>
<div style="position:absolute;left:56.69px;top:531.20px" class="cls_010"><span class="cls_010"> </span><a href="https://www.packtpub.com/books/content/support">t/support</a> <span class="cls_004">and enter the name of the book in the search field. The required information will</span></div>
<div style="position:absolute;left:56.69px;top:544.18px" class="cls_004"><span class="cls_004">appear under the </span><span class="cls_007">Errata</span><span class="cls_004"> section.</span></div>
<div style="position:absolute;left:260.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 6 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:14196px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background022.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Preface</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Piracy</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Piracy of copyrighted material on the Internet is an ongoing problem across all media. At</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">Packt, we take the protection of our copyright and licenses very seriously. If you come</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">across any illegal copies of our works in any form on the Internet, please provide us with</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">the location address or website name immediately so that we can pursue a remedy.</span></div>
<div style="position:absolute;left:56.69px;top:154.38px" class="cls_004"><span class="cls_004">Please contact us at </span><span class="cls_013">copyright@packtpub.com</span><span class="cls_004"> with a link to the suspected pirated</span></div>
<div style="position:absolute;left:56.69px;top:167.66px" class="cls_004"><span class="cls_004">material.</span></div>
<div style="position:absolute;left:56.69px;top:189.26px" class="cls_004"><span class="cls_004">We appreciate your help in protecting our authors and our ability to bring you valuable</span></div>
<div style="position:absolute;left:56.69px;top:201.86px" class="cls_004"><span class="cls_004">content.</span></div>
<div style="position:absolute;left:56.69px;top:229.56px" class="cls_014"><span class="cls_014">Questions</span></div>
<div style="position:absolute;left:56.69px;top:254.78px" class="cls_004"><span class="cls_004">If you have a problem with any aspect of this book, you can contact us</span></div>
<div style="position:absolute;left:56.69px;top:267.38px" class="cls_004"><span class="cls_004">at </span><span class="cls_013">questions@packtpub.com</span><span class="cls_004">, and we will do our best to address the problem.</span></div>
<div style="position:absolute;left:260.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 7 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:14872px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background023.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">1</span></div>
<div style="position:absolute;left:196.30px;top:167.48px" class="cls_011"><span class="cls_011">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">This chapter introduces the Alfresco platform and answers the question, </span><span class="cls_022">“</span><span class="cls_012">What can I do with</span></div>
<div style="position:absolute;left:56.69px;top:239.91px" class="cls_012"><span class="cls_012">this thing</span><span class="cls_004">?</span><span class="cls_022">”</span><span class="cls_004"> A few examples will be provided to help answer this question from the </span><span class="cls_012">solving</span></div>
<div style="position:absolute;left:56.69px;top:253.34px" class="cls_012"><span class="cls_012">business problems</span><span class="cls_004"> perspective. The chapter then skims over basic configuration and</span></div>
<div style="position:absolute;left:56.69px;top:265.94px" class="cls_004"><span class="cls_004">customization before introducing the advanced customization concepts covered throughout</span></div>
<div style="position:absolute;left:56.69px;top:278.54px" class="cls_004"><span class="cls_004">the book. The chapter concludes with a brief discussion on the different Alfresco editions</span></div>
<div style="position:absolute;left:56.69px;top:291.14px" class="cls_004"><span class="cls_004">that are available.</span></div>
<div style="position:absolute;left:56.69px;top:312.74px" class="cls_004"><span class="cls_004">In this chapter, we will go through the following points:</span></div>
<div style="position:absolute;left:104.69px;top:334.47px" class="cls_004"><span class="cls_004">Examples of practical solutions built on Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:349.23px" class="cls_004"><span class="cls_004">High-level components of the Alfresco platform</span></div>
<div style="position:absolute;left:104.69px;top:363.99px" class="cls_004"><span class="cls_004">Examples of the types of customizations that you will likely perform as a part of</span></div>
<div style="position:absolute;left:104.69px;top:376.59px" class="cls_004"><span class="cls_004">your implementation</span></div>
<div style="position:absolute;left:104.69px;top:391.35px" class="cls_004"><span class="cls_004">Technologies you will use to extend the platform</span></div>
<div style="position:absolute;left:56.69px;top:432.39px" class="cls_008"><span class="cls_008">Alfresco in the real world</span></div>
<div style="position:absolute;left:56.69px;top:460.12px" class="cls_004"><span class="cls_004">Alfresco will tell you that the product is a platform for </span><span class="cls_007">enterprise content management</span></div>
<div style="position:absolute;left:56.69px;top:472.76px" class="cls_004"><span class="cls_004">(</span><span class="cls_007">ECM</span><span class="cls_004">). But ECM is a somewhat nebulous and nefarious term. What does it really mean? It</span></div>
<div style="position:absolute;left:56.69px;top:485.40px" class="cls_004"><span class="cls_004">depends on who is saying it. ECM vendors usually use it as an umbrella term to describe a</span></div>
<div style="position:absolute;left:56.69px;top:498.00px" class="cls_004"><span class="cls_004">collection of content-centric technologies as follows:</span></div>
<div style="position:absolute;left:104.69px;top:519.73px" class="cls_007"><span class="cls_007">Document management</span><span class="cls_004"> (</span><span class="cls_007">DM</span><span class="cls_004">): This is used for capturing, organizing, and</span></div>
<div style="position:absolute;left:104.69px;top:532.36px" class="cls_004"><span class="cls_004">sharing binary files. These files are typically produced from office-productivity</span></div>
<div style="position:absolute;left:104.69px;top:544.96px" class="cls_004"><span class="cls_004">software, but the scope of the files being managed is unlimited.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:15548px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background024.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_007"><span class="cls_007">Web content management</span><span class="cls_004"> (</span><span class="cls_007">WCM</span><span class="cls_004">): This is used for managing files and content</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">specifically intended to be delivered to the Web. The key theme of WCM is to</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">reduce the </span><span class="cls_022">“</span><span class="cls_004">web developer</span><span class="cls_022">”</span><span class="cls_004"> bottleneck and empower non-technical content</span></div>
<div style="position:absolute;left:104.69px;top:109.17px" class="cls_004"><span class="cls_004">owners to publish their own content.</span></div>
<div style="position:absolute;left:104.69px;top:123.93px" class="cls_007"><span class="cls_007">Digital asset management</span><span class="cls_004"> (</span><span class="cls_007">DAM</span><span class="cls_004">): This is used for managing graphics, video,</span></div>
<div style="position:absolute;left:104.69px;top:136.57px" class="cls_004"><span class="cls_004">and audio. You can think of this as DM with added functionality specific to the</span></div>
<div style="position:absolute;left:104.69px;top:149.17px" class="cls_004"><span class="cls_004">needs of working with rich media such as thumbnailing, transcoding, and</span></div>
<div style="position:absolute;left:104.69px;top:161.77px" class="cls_004"><span class="cls_004">editing. Like WCM, the intent is to streamline the production process.</span></div>
<div style="position:absolute;left:104.69px;top:176.53px" class="cls_007"><span class="cls_007">Records management</span><span class="cls_004">(</span><span class="cls_007">RM</span><span class="cls_004">): This is used for managing content as a legal record.</span></div>
<div style="position:absolute;left:104.69px;top:189.16px" class="cls_004"><span class="cls_004">Like DAM, RM starts with DM and adds functionality specific to the world of RM</span></div>
<div style="position:absolute;left:104.69px;top:201.76px" class="cls_004"><span class="cls_004">such as retention policies, records plans, and audit trails.</span></div>
<div style="position:absolute;left:104.69px;top:216.52px" class="cls_007"><span class="cls_007">Knowledge management</span><span class="cls_004">(</span><span class="cls_007">KM</span><span class="cls_004">): This is used for capturing knowledge from</span></div>
<div style="position:absolute;left:104.69px;top:229.16px" class="cls_004"><span class="cls_004">employees or customers and providing it in a form that others can use.</span></div>
<div style="position:absolute;left:104.69px;top:243.92px" class="cls_007"><span class="cls_007">Case management</span><span class="cls_004">(</span><span class="cls_007">CM</span><span class="cls_004">): This is used managing information related to a case,</span></div>
<div style="position:absolute;left:104.69px;top:256.56px" class="cls_004"><span class="cls_004">such as an insurance claim, an investigation, or personnel processing.</span></div>
<div style="position:absolute;left:104.69px;top:271.32px" class="cls_007"><span class="cls_007">Imaging</span><span class="cls_004"> : This includes capturing, tagging, and routing images of documents</span></div>
<div style="position:absolute;left:104.69px;top:283.95px" class="cls_004"><span class="cls_004">from scanners.</span></div>
<div style="position:absolute;left:56.69px;top:307.84px" class="cls_004"><span class="cls_004">Most people will also include </span><span class="cls_007">collaboration</span><span class="cls_004">, </span><span class="cls_007">search,</span><span class="cls_004"> and occasionally, </span><span class="cls_007">portals</span><span class="cls_004"> as well.</span></div>
<div style="position:absolute;left:56.69px;top:329.48px" class="cls_004"><span class="cls_004">Practitioners have a different perspective. They will say that ECM is less about the</span></div>
<div style="position:absolute;left:56.69px;top:342.08px" class="cls_004"><span class="cls_004">technology and more about how you capture, organize, and share information across the</span></div>
<div style="position:absolute;left:56.69px;top:354.69px" class="cls_004"><span class="cls_004">entire enterprise. For them, the </span><span class="cls_012">how</span><span class="cls_004"> is more important than the </span><span class="cls_012">what</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:376.29px" class="cls_004"><span class="cls_004">What's important to know from an Alfresco perspective is that Alfresco is a platform for</span></div>
<div style="position:absolute;left:56.69px;top:388.89px" class="cls_004"><span class="cls_004">doing all these things.</span></div>
<div style="position:absolute;left:56.69px;top:410.49px" class="cls_004"><span class="cls_004">So rather than worrying about a concise definition of ECM, let's look at a few examples to</span></div>
<div style="position:absolute;left:56.69px;top:423.09px" class="cls_004"><span class="cls_004">illustrate how clients are using Alfresco today, particularly in Alfresco's sweet spots such as</span></div>
<div style="position:absolute;left:56.69px;top:435.69px" class="cls_004"><span class="cls_004">DM and WCM.</span></div>
<div style="position:absolute;left:56.69px;top:472.38px" class="cls_014"><span class="cls_014">Basic document management</span></div>
<div style="position:absolute;left:56.69px;top:497.61px" class="cls_004"><span class="cls_004">Alfresco started its life as a document management repository with some basic services for</span></div>
<div style="position:absolute;left:56.69px;top:510.21px" class="cls_004"><span class="cls_004">document management. Alfresco focused on this smart area initially for two reasons. First,</span></div>
<div style="position:absolute;left:56.69px;top:522.81px" class="cls_004"><span class="cls_004">it allowed Alfresco to establish a strong foundation and then build upon that foundation by</span></div>
<div style="position:absolute;left:56.69px;top:535.41px" class="cls_004"><span class="cls_004">expanding into other areas of ECM. Second, there is a huge market for systems that can</span></div>
<div style="position:absolute;left:56.69px;top:548.01px" class="cls_004"><span class="cls_004">manage unstructured content (aka </span><span class="cls_022">“</span><span class="cls_004">documents</span><span class="cls_022">”</span><span class="cls_004">).</span></div>
<div style="position:absolute;left:260.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 9 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:16224px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background025.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The market is so big because document management is a problem for everyone. All</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">companies generate files that benefit from the kind of features document management</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">provides such as check-in/check-out, versioning, metadata, security, full-text search, and</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">workflow.</span></div>
<div style="position:absolute;left:56.69px;top:129.90px" class="cls_004"><span class="cls_004">Examples of classic document management are often found in insurance, manufacturing,</span></div>
<div style="position:absolute;left:56.69px;top:142.50px" class="cls_004"><span class="cls_004">packaged goods, or other companies with large research and development divisions. As</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">you can imagine, companies such as these deal with thousands of documents every day.</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">The documents are in a variety of formats and languages, and are created and leveraged by</span></div>
<div style="position:absolute;left:56.69px;top:180.30px" class="cls_004"><span class="cls_004">many different types of stakeholders from various parts of the company.</span></div>
<div style="position:absolute;left:56.69px;top:201.90px" class="cls_004"><span class="cls_004">The critical functionality required for basic document management includes things such as:</span></div>
<div style="position:absolute;left:104.69px;top:223.63px" class="cls_007"><span class="cls_007">Easy integration with authoring tools:</span><span class="cls_004"> If users can't get documents into and out</span></div>
<div style="position:absolute;left:104.69px;top:236.27px" class="cls_004"><span class="cls_004">of the repository easily, user adoption will suffer. This means users must be able</span></div>
<div style="position:absolute;left:104.69px;top:248.87px" class="cls_004"><span class="cls_004">to open and save documents to the repository from applications such as</span></div>
<div style="position:absolute;left:104.69px;top:261.47px" class="cls_004"><span class="cls_004">Microsoft Office, Microsoft Windows Explorer, and e-mail.</span></div>
<div style="position:absolute;left:104.69px;top:276.23px" class="cls_007"><span class="cls_007">Security</span><span class="cls_004">: Many documents, particularly legal documents and anything around</span></div>
<div style="position:absolute;left:104.69px;top:288.87px" class="cls_004"><span class="cls_004">new product development, are very sensitive. Employees must be able to log in</span></div>
<div style="position:absolute;left:104.69px;top:301.47px" class="cls_004"><span class="cls_004">with their normal username and password, and see only the documents they</span></div>
<div style="position:absolute;left:104.69px;top:314.07px" class="cls_004"><span class="cls_004">have access to.</span></div>
<div style="position:absolute;left:104.69px;top:328.83px" class="cls_007"><span class="cls_007">Library services</span><span class="cls_004">: This is a grouping of foundational document management</span></div>
<div style="position:absolute;left:104.69px;top:341.46px" class="cls_004"><span class="cls_004">functionality that includes check-in/check-out, versioning, metadata, and search.</span></div>
<div style="position:absolute;left:104.69px;top:354.06px" class="cls_004"><span class="cls_004">The ability to offer these library services is one of the things that sets a document</span></div>
<div style="position:absolute;left:104.69px;top:366.66px" class="cls_004"><span class="cls_004">repository apart from a plain filesystem.</span></div>
<div style="position:absolute;left:104.69px;top:381.42px" class="cls_007"><span class="cls_007">Workflow</span><span class="cls_004">: Quite literally, workflow describes the </span><span class="cls_022">“</span><span class="cls_004">flow of work</span><span class="cls_022">”</span><span class="cls_004"> or business</span></div>
<div style="position:absolute;left:104.69px;top:394.85px" class="cls_004"><span class="cls_004">process related to a document. Requirements vary widely in this area and not</span></div>
<div style="position:absolute;left:104.69px;top:407.45px" class="cls_004"><span class="cls_004">everyone will leverage workflows right away. Workflows can be used to</span></div>
<div style="position:absolute;left:104.69px;top:420.05px" class="cls_004"><span class="cls_004">streamline and automate manual business processes by letting the document</span></div>
<div style="position:absolute;left:104.69px;top:432.65px" class="cls_004"><span class="cls_004">management system keep track of who needs to do what to a document at any</span></div>
<div style="position:absolute;left:104.69px;top:445.25px" class="cls_004"><span class="cls_004">particular time.</span></div>
<div style="position:absolute;left:104.69px;top:460.01px" class="cls_007"><span class="cls_007">Scalability/Reliability</span><span class="cls_004">: The system needs to scale in order to support several</span></div>
<div style="position:absolute;left:104.69px;top:472.65px" class="cls_004"><span class="cls_004">hundred or more users and hundreds of thousands or even millions of</span></div>
<div style="position:absolute;left:104.69px;top:485.25px" class="cls_004"><span class="cls_004">documents with some percentage of growth each year. Because the repository</span></div>
<div style="position:absolute;left:104.69px;top:497.85px" class="cls_004"><span class="cls_004">holds content that's critical to the business, it needs to be highly available.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 10 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:16900px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background026.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_007"><span class="cls_007">Customizable user interface</span><span class="cls_004">: Alfresco is split into two web applications. The first</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">one contains only the core engine capabilities that are required for all Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">installation. The second one is the out-of-the-box Alfresco Share client made for</span></div>
<div style="position:absolute;left:104.69px;top:108.34px" class="cls_004"><span class="cls_004">generic document management, which may be appropriate in many cases. Most</span></div>
<div style="position:absolute;left:104.69px;top:120.94px" class="cls_004"><span class="cls_004">clients will want to make at least some customizations to the web client to help</span></div>
<div style="position:absolute;left:104.69px;top:133.54px" class="cls_004"><span class="cls_004">increase productivity and improve user adoption. It's possible as well to develop</span></div>
<div style="position:absolute;left:104.69px;top:146.14px" class="cls_004"><span class="cls_004">your own frontend from scratch.</span></div>
<div style="position:absolute;left:56.69px;top:170.03px" class="cls_004"><span class="cls_004">The following diagram shows an example of high-level architecture to understand how</span></div>
<div style="position:absolute;left:56.69px;top:182.63px" class="cls_004"><span class="cls_004">basic document management might be implemented:</span></div>
<div style="position:absolute;left:56.69px;top:413.65px" class="cls_004"><span class="cls_004">The diagram shows a single instance of Alfresco authenticating against a </span><span class="cls_007">Directory Server</span></div>
<div style="position:absolute;left:56.69px;top:426.29px" class="cls_007"><span class="cls_007">(</span><span class="cls_004">such as LDAP</span><span class="cls_007">)</span><span class="cls_004">. Some content managers are using Alfresco Share via HTTP/S, while others</span></div>
<div style="position:absolute;left:56.69px;top:438.93px" class="cls_004"><span class="cls_004">are using Windows Explorer, Microsoft Office, and other </span><span class="cls_012">thick clients</span><span class="cls_004"> to work with content</span></div>
<div style="position:absolute;left:56.69px;top:451.53px" class="cls_004"><span class="cls_004">via one or more protocols such as </span><span class="cls_007">CIFS</span><span class="cls_004">, </span><span class="cls_007">WebDAV</span><span class="cls_004">, </span><span class="cls_007">FTP</span><span class="cls_004">, or </span><span class="cls_007">SMTP</span><span class="cls_004">. As noted in the diagram,</span></div>
<div style="position:absolute;left:56.69px;top:464.17px" class="cls_004"><span class="cls_004">Alfresco stores metadata in a relational database and the actual content files on the</span></div>
<div style="position:absolute;left:56.69px;top:476.77px" class="cls_004"><span class="cls_004">filesystem.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 11 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:17576px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background027.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Most of the techniques for customizing Alfresco for DM solutions apply to other ECM</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">solutions such as WCM, RM, Imaging, and DAM. Of course, there are business concepts</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">and technical implementation details specific to each that make them unique, but the details</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">provided in this book apply to all because the specialized solutions are built as extensions to</span></div>
<div style="position:absolute;left:56.69px;top:120.91px" class="cls_004"><span class="cls_004">the core Alfresco repository. This books dedicates an entire chapter, </span><span class="cls_010">Chapter 9</span><span class="cls_004">, </span><span class="cls_012">Amazing</span></div>
<div style="position:absolute;left:56.69px;top:133.89px" class="cls_012"><span class="cls_012">Extensions</span><span class="cls_004">, to some very famous extensions as Alfresco Mobile and Alfresco Analytics.</span></div>
<div style="position:absolute;left:56.69px;top:170.59px" class="cls_014"><span class="cls_014">Web content management</span></div>
<div style="position:absolute;left:56.69px;top:195.81px" class="cls_004"><span class="cls_004">On the surface, WCM is very similar to document management. In both cases, content</span></div>
<div style="position:absolute;left:56.69px;top:208.41px" class="cls_004"><span class="cls_004">owners store files in a repository. Often, the content is assigned metadata, secured, indexed</span></div>
<div style="position:absolute;left:56.69px;top:221.01px" class="cls_004"><span class="cls_004">for search, and routed through a workflow. The most obvious difference between DM and</span></div>
<div style="position:absolute;left:56.69px;top:233.61px" class="cls_004"><span class="cls_004">WCM is that the content being managed is meant specifically to be published on a website</span></div>
<div style="position:absolute;left:56.69px;top:246.21px" class="cls_004"><span class="cls_004">or as part of a web application. Beyond that high-level distinction, there are several other</span></div>
<div style="position:absolute;left:56.69px;top:258.81px" class="cls_004"><span class="cls_004">differences that make WCM worthy of separate discussion. These include:</span></div>
<div style="position:absolute;left:104.69px;top:280.54px" class="cls_004"><span class="cls_004">Content authoring tools used to create content</span></div>
<div style="position:absolute;left:104.69px;top:295.30px" class="cls_004"><span class="cls_004">Separation of presentation from content</span></div>
<div style="position:absolute;left:104.69px;top:310.06px" class="cls_004"><span class="cls_004">Systematic publication or deployment of content</span></div>
<div style="position:absolute;left:56.69px;top:333.95px" class="cls_004"><span class="cls_004">Let's briefly look at each of these.</span></div>
<div style="position:absolute;left:56.69px;top:368.60px" class="cls_023"><span class="cls_023">Content authoring tools</span></div>
<div style="position:absolute;left:56.69px;top:391.31px" class="cls_004"><span class="cls_004">The majority of document management solutions deal with files generated by an office</span></div>
<div style="position:absolute;left:56.69px;top:403.91px" class="cls_004"><span class="cls_004">suite. Of course, there are exceptions such as various types of graphics files, CAD/CAM</span></div>
<div style="position:absolute;left:56.69px;top:416.51px" class="cls_004"><span class="cls_004">drawing formats, and other specialized tools. But mostly, the files are generated by a small</span></div>
<div style="position:absolute;left:56.69px;top:429.11px" class="cls_004"><span class="cls_004">number of different tools and an even smaller number of different software vendors.</span></div>
<div style="position:absolute;left:56.69px;top:450.71px" class="cls_004"><span class="cls_004">In the case of WCM, there is a wide variety of tools involved from text editors to </span><span class="cls_007">integrated</span></div>
<div style="position:absolute;left:56.69px;top:463.35px" class="cls_007"><span class="cls_007">development environments</span><span class="cls_004"> (</span><span class="cls_007">IDE</span><span class="cls_004">s) to graphics programs with multiple vendors in each</span></div>
<div style="position:absolute;left:56.69px;top:475.99px" class="cls_004"><span class="cls_004">category. This means the WCM solution needs to be very flexible in the way it integrates</span></div>
<div style="position:absolute;left:56.69px;top:488.59px" class="cls_004"><span class="cls_004">with authoring tools. The alternative, which is forcing authors to give up their favorite tools</span></div>
<div style="position:absolute;left:56.69px;top:501.19px" class="cls_004"><span class="cls_004">in favor of a standard, can be a management nightmare.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 12 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:18252px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background028.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Separation of presentation from content</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">WCM does not require the separation between content's appearance on the web site and its</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">storage. But many implementations take advantage of this principle because it makes</span></div>
<div style="position:absolute;left:56.69px;top:117.78px" class="cls_004"><span class="cls_004">redesigning the site easier, facilitates multichannel publishing, and enables people to author</span></div>
<div style="position:absolute;left:56.69px;top:130.38px" class="cls_004"><span class="cls_004">content without web skills.</span></div>
<div style="position:absolute;left:56.69px;top:151.98px" class="cls_004"><span class="cls_004">To understand why this is so, think about a website that has its content and presentation of</span></div>
<div style="position:absolute;left:56.69px;top:164.58px" class="cls_004"><span class="cls_004">that content merged together. When it is time to redesign the site, you have to touch every</span></div>
<div style="position:absolute;left:56.69px;top:177.18px" class="cls_004"><span class="cls_004">single web page because every page contains presentation markup. Similarly, content</span></div>
<div style="position:absolute;left:56.69px;top:189.78px" class="cls_004"><span class="cls_004">authoring is limited to people with technical skills. Otherwise, there is a risk that the</span></div>
<div style="position:absolute;left:56.69px;top:202.38px" class="cls_004"><span class="cls_004">content owner (for example, the person writing a press release or a job posting) will</span></div>
<div style="position:absolute;left:56.69px;top:214.98px" class="cls_004"><span class="cls_004">inadvertently clobber the page design.</span></div>
<div style="position:absolute;left:56.69px;top:236.58px" class="cls_004"><span class="cls_004">One way to address this is to separate the content (the press release copy) from the</span></div>
<div style="position:absolute;left:56.69px;top:249.18px" class="cls_004"><span class="cls_004">presentation of that content. A common way to do that is to store the content as</span></div>
<div style="position:absolute;left:56.69px;top:261.78px" class="cls_004"><span class="cls_004">presentation-independent XML. The XML can then be transformed into any presentation</span></div>
<div style="position:absolute;left:56.69px;top:274.38px" class="cls_004"><span class="cls_004">that's needed. A redesign is as simple as changing the presentation in a single place, and</span></div>
<div style="position:absolute;left:56.69px;top:286.98px" class="cls_004"><span class="cls_004">then regenerating all of the pages.</span></div>
<div style="position:absolute;left:56.69px;top:308.58px" class="cls_004"><span class="cls_004">The impact of separating content from presentation is three-fold. First, assuming the content</span></div>
<div style="position:absolute;left:56.69px;top:321.18px" class="cls_004"><span class="cls_004">consumers aren't interested in reading raw XML, something has to be responsible for</span></div>
<div style="position:absolute;left:56.69px;top:333.78px" class="cls_004"><span class="cls_004">transforming the content. Depending on the implementation, it may be up to the WCM</span></div>
<div style="position:absolute;left:56.69px;top:346.38px" class="cls_004"><span class="cls_004">system or a frontend web application.</span></div>
<div style="position:absolute;left:56.69px;top:367.98px" class="cls_004"><span class="cls_004">Second, in the case of static content, any change in the underlying content has to trigger a</span></div>
<div style="position:absolute;left:56.69px;top:380.58px" class="cls_004"><span class="cls_004">transformation so that the presentation will be up-to-date, keeping in mind that there may</span></div>
<div style="position:absolute;left:56.69px;top:393.18px" class="cls_004"><span class="cls_004">be more than one file affected by the change. For example, data from a job posting appears</span></div>
<div style="position:absolute;left:56.69px;top:405.78px" class="cls_004"><span class="cls_004">in the job posting detail as well as the list of job postings. If the posting and the job posting</span></div>
<div style="position:absolute;left:56.69px;top:418.38px" class="cls_004"><span class="cls_004">index are both static, the list has to be regenerated whenever the job posting changes.</span></div>
<div style="position:absolute;left:56.69px;top:439.98px" class="cls_004"><span class="cls_004">Third, content authors lose the benefit of </span><span class="cls_007">WYSIWYG</span><span class="cls_004"> (</span><span class="cls_007">What You See Is What You Get</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:452.62px" class="cls_004"><span class="cls_004">content authoring because the content doesn't immediately look the way it will as soon as it</span></div>
<div style="position:absolute;left:56.69px;top:465.22px" class="cls_004"><span class="cls_004">is published to the web site. The WCM system, then, has to be able to let content authors</span></div>
<div style="position:absolute;left:56.69px;top:477.83px" class="cls_012"><span class="cls_012">preview</span><span class="cls_004"> the content as they author it, preferably in the context of the entire site.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 13 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:18928px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background029.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Systematic publication or deployment</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">A document management system is a lot like a relational database in the sense that it is</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">typically an authoritative, centralized repository. There are exceptions, but for the most</span></div>
<div style="position:absolute;left:56.69px;top:117.78px" class="cls_004"><span class="cls_004">part, content resides in the repository and is retrieved by the systems and applications that</span></div>
<div style="position:absolute;left:56.69px;top:130.38px" class="cls_004"><span class="cls_004">need it. On the other hand, a WCM system often faces a publication or deployment</span></div>
<div style="position:absolute;left:56.69px;top:142.98px" class="cls_004"><span class="cls_004">challenge. Files go into the repository, but must be delivered somewhere to be consumed.</span></div>
<div style="position:absolute;left:56.69px;top:155.58px" class="cls_004"><span class="cls_004">This might happen on a schedule, at the request of a user, as part of a workflow, or all of the</span></div>
<div style="position:absolute;left:56.69px;top:168.18px" class="cls_004"><span class="cls_004">above. Granted, some websites retrieve their content dynamically; but most sites have at</span></div>
<div style="position:absolute;left:56.69px;top:180.78px" class="cls_004"><span class="cls_004">least a subset of content that should be statically delivered to a web server.</span></div>
<div style="position:absolute;left:56.69px;top:215.43px" class="cls_023"><span class="cls_023">Alfresco WCM example</span></div>
<div style="position:absolute;left:56.69px;top:238.15px" class="cls_004"><span class="cls_004">Let's look at an example of a basic corporate website. Most companies have a mix of </span><span class="cls_012">About</span></div>
<div style="position:absolute;left:56.69px;top:250.75px" class="cls_012"><span class="cls_012">Us</span><span class="cls_004"> content that probably doesn't change very often, </span><span class="cls_012">Press releases</span><span class="cls_004"> or </span><span class="cls_012">News</span><span class="cls_004"> sections that</span></div>
<div style="position:absolute;left:56.69px;top:263.35px" class="cls_004"><span class="cls_004">might get updated daily, and maybe some document-based content such as marketing</span></div>
<div style="position:absolute;left:56.69px;top:275.95px" class="cls_004"><span class="cls_004">slicks, product information sheets, technical specifications, and so on. There's also some</span></div>
<div style="position:absolute;left:56.69px;top:288.55px" class="cls_004"><span class="cls_004">content that is used to build the site such as HTML, XML, JavaScript, Flash, CSS, and image</span></div>
<div style="position:absolute;left:56.69px;top:301.15px" class="cls_004"><span class="cls_004">files.</span></div>
<div style="position:absolute;left:56.69px;top:322.75px" class="cls_004"><span class="cls_004">It is likely that there are several different teams with several different skill sets, all</span></div>
<div style="position:absolute;left:56.69px;top:335.36px" class="cls_004"><span class="cls_004">collaborating to produce the site. In this example, suppose the </span><span class="cls_012">About Us</span><span class="cls_004"> and </span><span class="cls_012">News</span><span class="cls_004"> pages</span></div>
<div style="position:absolute;left:56.69px;top:347.96px" class="cls_004"><span class="cls_004">come from the marketing team, the site is built by the web team and the document-based</span></div>
<div style="position:absolute;left:56.69px;top:360.56px" class="cls_004"><span class="cls_004">content can come from many organizations within the company.</span></div>
<div style="position:absolute;left:56.69px;top:382.16px" class="cls_004"><span class="cls_004">Alfresco WCM sits on top of the core Alfresco product to provide additional WCM-specific</span></div>
<div style="position:absolute;left:56.69px;top:394.76px" class="cls_004"><span class="cls_004">functionality. An important distinction between Alfresco WCM and other open source</span></div>
<div style="position:absolute;left:56.69px;top:407.36px" class="cls_007"><span class="cls_007">content management systems</span><span class="cls_004"> (</span><span class="cls_007">CMS</span><span class="cls_004">) is that Alfresco is a </span><span class="cls_012">decoupled</span><span class="cls_004"> CMS while something</span></div>
<div style="position:absolute;left:56.69px;top:420.01px" class="cls_004"><span class="cls_004">such as Drupal is a </span><span class="cls_012">coupled</span><span class="cls_004"> CMS. This means that Alfresco manages the website but does not</span></div>
<div style="position:absolute;left:56.69px;top:432.61px" class="cls_004"><span class="cls_004">concern itself with presentation unlike Drupal, which is both a repository and a</span></div>
<div style="position:absolute;left:56.69px;top:445.21px" class="cls_004"><span class="cls_004">presentation framework. This doesn't mean that Alfresco can only manage static sites. You</span></div>
<div style="position:absolute;left:56.69px;top:457.81px" class="cls_004"><span class="cls_004">can easily query the repository in any number of ways. It just means it is up to you to</span></div>
<div style="position:absolute;left:56.69px;top:470.41px" class="cls_004"><span class="cls_004">provide the frontend from the ground up.</span></div>
<div style="position:absolute;left:56.69px;top:507.10px" class="cls_014"><span class="cls_014">Custom content-centric applications</span></div>
<div style="position:absolute;left:56.69px;top:532.33px" class="cls_004"><span class="cls_004">Content-centric applications are those in which the primary purpose of the application is to</span></div>
<div style="position:absolute;left:56.69px;top:544.93px" class="cls_004"><span class="cls_004">process, produce, archive, collaborate on, or manage unstructured or semi-structured</span></div>
<div style="position:absolute;left:56.69px;top:557.53px" class="cls_004"><span class="cls_004">content.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 14 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:19604px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background030.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The Alfresco Share client is an example of a content-centric application, although it is meant</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">for a very general, all-purpose use case. When solutions are very close to basic document</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">management, Alfresco Share can be customized as previously discussed. At some point, it</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">makes more sense to build a separate custom application with Alfresco as the backend</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">repository for that application.</span></div>
<div style="position:absolute;left:56.69px;top:142.50px" class="cls_004"><span class="cls_004">Consider the sales process within a company, for example. Sales people create proposals.</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">Those proposals are usually routed internally for review and approval, and then are</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">delivered to the client. If the client accepts the proposal, a contract is drawn up and the</span></div>
<div style="position:absolute;left:56.69px;top:180.30px" class="cls_004"><span class="cls_004">product is delivered. The out-of-the-box Alfresco Share could be used to manage these</span></div>
<div style="position:absolute;left:56.69px;top:192.90px" class="cls_004"><span class="cls_004">documents, assign metadata, manage the review process through workflows, and make it</span></div>
<div style="position:absolute;left:56.69px;top:205.50px" class="cls_004"><span class="cls_004">all searchable. But the sales team might be even more productive if it used a purpose-built</span></div>
<div style="position:absolute;left:56.69px;top:218.10px" class="cls_004"><span class="cls_004">user interface. For this solution, a frontend built on top of NodeJS and Angular, a custom</span></div>
<div style="position:absolute;left:56.69px;top:230.70px" class="cls_004"><span class="cls_004">Spring web application, or even a </span><span class="cls_007">custom mobile application</span><span class="cls_004"> might be a good option.</span></div>
<div style="position:absolute;left:56.69px;top:243.34px" class="cls_004"><span class="cls_004">Alfresco would provide the document management services. The frontend would talk to</span></div>
<div style="position:absolute;left:56.69px;top:255.94px" class="cls_004"><span class="cls_004">Alfresco via CMIS or RESTful services.</span></div>
<div style="position:absolute;left:56.69px;top:277.54px" class="cls_004"><span class="cls_004">Another example is using Alfresco in a digitization project. More and more companies are</span></div>
<div style="position:absolute;left:56.69px;top:290.14px" class="cls_004"><span class="cls_004">trying to reduce the use of paper-based process for many different reasons. Alfresco can be</span></div>
<div style="position:absolute;left:56.69px;top:302.74px" class="cls_004"><span class="cls_004">integrated with various scanning solutions as Ephesoft via CMIS, or Kofax via the connector</span></div>
<div style="position:absolute;left:56.69px;top:315.34px" class="cls_004"><span class="cls_004">supported by Alfresco. Documents can be ingested and processed by the scanning solution</span></div>
<div style="position:absolute;left:56.69px;top:327.94px" class="cls_004"><span class="cls_004">and exported to Alfresco. Alfresco will be responsible to store, index and secure the scanned</span></div>
<div style="position:absolute;left:56.69px;top:340.54px" class="cls_004"><span class="cls_004">documents. Using the integrated Activiti framework, Alfresco can automatically start a</span></div>
<div style="position:absolute;left:56.69px;top:353.14px" class="cls_004"><span class="cls_004">process depending of the document type. If an invoice has been scanned, Alfresco will start</span></div>
<div style="position:absolute;left:56.69px;top:365.74px" class="cls_004"><span class="cls_004">a review process for the financial team. If it's a job application, Alfresco will start a new</span></div>
<div style="position:absolute;left:56.69px;top:378.34px" class="cls_004"><span class="cls_004">process for the HR team to track the different stages of this application.</span></div>
<div style="position:absolute;left:56.69px;top:399.94px" class="cls_004"><span class="cls_004">As discussed previously, Alfresco provides two out-of-the-box web applications. The first</span></div>
<div style="position:absolute;left:56.69px;top:412.54px" class="cls_004"><span class="cls_004">one is the Alfresco repository engine. The first one provides only administration capabilities</span></div>
<div style="position:absolute;left:56.69px;top:425.14px" class="cls_004"><span class="cls_004">from a user interface point of view. The second one is the default web interface Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:437.74px" class="cls_004"><span class="cls_004">Share. Many clients appreciate this separation because it gives them complete freedom with</span></div>
<div style="position:absolute;left:56.69px;top:450.34px" class="cls_004"><span class="cls_004">regard to how they build the frontend. Depending of your use case, you may want to use</span></div>
<div style="position:absolute;left:56.69px;top:462.94px" class="cls_004"><span class="cls_004">the standard Alfresco Share user interface; or including some customizations; or even build</span></div>
<div style="position:absolute;left:56.69px;top:475.54px" class="cls_004"><span class="cls_004">the frontend from scratch.</span></div>
<div style="position:absolute;left:56.69px;top:497.14px" class="cls_004"><span class="cls_004">Alfresco Share provides many different options if you need customizations. The basic level</span></div>
<div style="position:absolute;left:56.69px;top:509.74px" class="cls_004"><span class="cls_004">is to configure some forms and pages to display your custom metadata. If you need further</span></div>
<div style="position:absolute;left:56.69px;top:522.34px" class="cls_004"><span class="cls_004">customization, you may want to customize an existing Dashlet or to develop a new one to</span></div>
<div style="position:absolute;left:56.69px;top:534.94px" class="cls_004"><span class="cls_004">add on the user or site dashboard. You may need to create custom actions in the use</span></div>
<div style="position:absolute;left:56.69px;top:547.54px" class="cls_004"><span class="cls_004">interface. If it's not enough, it's even possible to create new pages within Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:560.14px" class="cls_004"><span class="cls_004">reusing the entire UI framework. Finally, if it's not sufficient, Alfresco can be integrated to</span></div>
<div style="position:absolute;left:56.69px;top:572.74px" class="cls_004"><span class="cls_004">any frontend using CMIS or REST API.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 15 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:20280px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background031.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">We'll see in one of the following chapters how Alfresco created tools to generate Angular</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">applications from scratch:</span></div>
<div style="position:absolute;left:56.69px;top:254.12px" class="cls_004"><span class="cls_004">The openness of the Alfresco repository, particularly its ability to be easily exposed as a set</span></div>
<div style="position:absolute;left:56.69px;top:266.72px" class="cls_004"><span class="cls_004">of services, makes Alfresco an ideal platform for content-centric applications. As the</span></div>
<div style="position:absolute;left:56.69px;top:279.32px" class="cls_004"><span class="cls_004">examples have shown, custom content-centric web applications use Alfresco as the</span></div>
<div style="position:absolute;left:56.69px;top:291.92px" class="cls_004"><span class="cls_004">backend. As a result, they have complete flexibility in frontend technology choices from</span></div>
<div style="position:absolute;left:56.69px;top:304.52px" class="cls_004"><span class="cls_004">portals to lower-level frameworks to no framework at all.</span></div>
<div style="position:absolute;left:56.69px;top:347.23px" class="cls_008"><span class="cls_008">Example used throughout this book</span></div>
<div style="position:absolute;left:56.69px;top:374.96px" class="cls_004"><span class="cls_004">In this book, we'll assume we are rolling out Alfresco throughout a consulting firm.</span></div>
<div style="position:absolute;left:56.69px;top:387.56px" class="cls_004"><span class="cls_004">Professional services firms make great examples because they tend to generate a variety of</span></div>
<div style="position:absolute;left:56.69px;top:400.16px" class="cls_004"><span class="cls_004">different documents. The other reason is that document and content management is usually</span></div>
<div style="position:absolute;left:56.69px;top:412.76px" class="cls_004"><span class="cls_004">a big challenge, which is the core to the business. But the examples should be applicable to</span></div>
<div style="position:absolute;left:56.69px;top:425.36px" class="cls_004"><span class="cls_004">any business that generates a significant amount of documents.</span></div>
<div style="position:absolute;left:56.69px;top:446.96px" class="cls_004"><span class="cls_004">The example firm, SomeCo, wants to leverage document and content management</span></div>
<div style="position:absolute;left:56.69px;top:459.56px" class="cls_004"><span class="cls_004">throughout the organization to make it easier to find important information, streamline</span></div>
<div style="position:absolute;left:56.69px;top:472.16px" class="cls_004"><span class="cls_004">certain business processes, and secure sensitive documents.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 16 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:20956px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background032.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">SomeCo's company organization is pretty standard. It consists of operations, sales, human</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">resources, marketing, and finance/legal. Examples of the different types of content each</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">department is concerned with are shown in the following table:</span></div>
<div style="position:absolute;left:60.32px;top:120.91px" class="cls_024"><span class="cls_024">Department</span></div>
<div style="position:absolute;left:144.06px;top:120.91px" class="cls_024"><span class="cls_024">Example document types</span></div>
<div style="position:absolute;left:275.65px;top:120.91px" class="cls_024"><span class="cls_024">Format and process notes</span></div>
<div style="position:absolute;left:60.32px;top:139.45px" class="cls_025"><span class="cls_025">Finance/legal</span></div>
<div style="position:absolute;left:144.06px;top:139.44px" class="cls_004"><span class="cls_004">Client proposals for</span></div>
<div style="position:absolute;left:275.65px;top:138.56px" class="cls_017"><span class="cls_017">• Microsoft Word and Adobe PDF.</span></div>
<div style="position:absolute;left:144.06px;top:152.04px" class="cls_004"><span class="cls_004">project work</span></div>
<div style="position:absolute;left:275.65px;top:151.76px" class="cls_017"><span class="cls_017">• Several iterations between the firm and the</span></div>
<div style="position:absolute;left:144.06px;top:164.64px" class="cls_004"><span class="cls_004">Statements of work</span></div>
<div style="position:absolute;left:275.65px;top:164.96px" class="cls_017"><span class="cls_017">client before a </span><span class="cls_026">final</span><span class="cls_017"> version is completed.</span></div>
<div style="position:absolute;left:144.06px;top:177.24px" class="cls_004"><span class="cls_004">Master services</span></div>
<div style="position:absolute;left:275.65px;top:178.16px" class="cls_017"><span class="cls_017">• Some documents may require internal review</span></div>
<div style="position:absolute;left:144.06px;top:189.84px" class="cls_004"><span class="cls_004">agreements</span></div>
<div style="position:absolute;left:275.65px;top:191.36px" class="cls_017"><span class="cls_017">and approval.</span></div>
<div style="position:absolute;left:144.06px;top:202.44px" class="cls_004"><span class="cls_004">Non-disclosure</span></div>
<div style="position:absolute;left:144.06px;top:215.04px" class="cls_004"><span class="cls_004">agreements</span></div>
<div style="position:absolute;left:60.32px;top:234.16px" class="cls_025"><span class="cls_025">Marketing</span></div>
<div style="position:absolute;left:144.06px;top:234.15px" class="cls_004"><span class="cls_004">Case studies</span></div>
<div style="position:absolute;left:275.65px;top:233.27px" class="cls_017"><span class="cls_017">• Microsoft Word, Microsoft PowerPoint,</span></div>
<div style="position:absolute;left:144.06px;top:246.75px" class="cls_004"><span class="cls_004">Whitepapers</span></div>
<div style="position:absolute;left:275.65px;top:246.47px" class="cls_017"><span class="cls_017">Adobe PDF, and Adobe Flash.</span></div>
<div style="position:absolute;left:144.06px;top:259.35px" class="cls_004"><span class="cls_004">Marketing plans</span></div>
<div style="position:absolute;left:275.65px;top:259.67px" class="cls_017"><span class="cls_017">• Mostly single-author content.</span></div>
<div style="position:absolute;left:144.06px;top:271.95px" class="cls_004"><span class="cls_004">Marketing</span></div>
<div style="position:absolute;left:275.65px;top:272.87px" class="cls_017"><span class="cls_017">• Some content may come from third parties.</span></div>
<div style="position:absolute;left:144.06px;top:284.55px" class="cls_004"><span class="cls_004">slicks/promotional</span></div>
<div style="position:absolute;left:275.65px;top:286.07px" class="cls_017"><span class="cls_017">• Some content may need to be published on</span></div>
<div style="position:absolute;left:144.06px;top:297.15px" class="cls_004"><span class="cls_004">material</span></div>
<div style="position:absolute;left:275.65px;top:299.27px" class="cls_017"><span class="cls_017">the website.</span></div>
<div style="position:absolute;left:60.32px;top:319.87px" class="cls_025"><span class="cls_025">Human</span></div>
<div style="position:absolute;left:144.06px;top:319.86px" class="cls_004"><span class="cls_004">Job postings</span></div>
<div style="position:absolute;left:275.65px;top:318.98px" class="cls_017"><span class="cls_017">• Microsoft Word, Adobe PDF, and HTML.</span></div>
<div style="position:absolute;left:60.32px;top:331.87px" class="cls_025"><span class="cls_025">resources</span></div>
<div style="position:absolute;left:144.06px;top:332.46px" class="cls_004"><span class="cls_004">Resumes</span></div>
<div style="position:absolute;left:275.65px;top:332.18px" class="cls_017"><span class="cls_017">• Single-author content with consumers being</span></div>
<div style="position:absolute;left:144.06px;top:345.06px" class="cls_004"><span class="cls_004">Interview feedback</span></div>
<div style="position:absolute;left:275.65px;top:345.38px" class="cls_017"><span class="cls_017">spread throughout the company.</span></div>
<div style="position:absolute;left:144.06px;top:357.66px" class="cls_004"><span class="cls_004">Offer letters</span></div>
<div style="position:absolute;left:275.65px;top:358.58px" class="cls_017"><span class="cls_017">• Some content formats are unpredictable</span></div>
<div style="position:absolute;left:144.06px;top:370.26px" class="cls_004"><span class="cls_004">Employee profiles</span></div>
<div style="position:absolute;left:275.65px;top:371.78px" class="cls_017"><span class="cls_017">(such as resumes). Some are very standard and</span></div>
<div style="position:absolute;left:144.06px;top:382.86px" class="cls_004"><span class="cls_004">/Biographies</span></div>
<div style="position:absolute;left:275.65px;top:384.98px" class="cls_017"><span class="cls_017">could be templatized (such as offer letters).</span></div>
<div style="position:absolute;left:144.06px;top:395.46px" class="cls_004"><span class="cls_004">Project reviews</span></div>
<div style="position:absolute;left:275.65px;top:398.18px" class="cls_017"><span class="cls_017">• With the exception of job postings, none of</span></div>
<div style="position:absolute;left:144.06px;top:408.06px" class="cls_004"><span class="cls_004">Annual reviews</span></div>
<div style="position:absolute;left:275.65px;top:411.38px" class="cls_017"><span class="cls_017">this content should go near the Web.</span></div>
<div style="position:absolute;left:275.65px;top:424.58px" class="cls_017"><span class="cls_017">• Some content needs strict internal</span></div>
<div style="position:absolute;left:275.65px;top:437.78px" class="cls_017"><span class="cls_017">permissions.</span></div>
<div style="position:absolute;left:60.32px;top:458.38px" class="cls_025"><span class="cls_025">Sales</span></div>
<div style="position:absolute;left:144.06px;top:458.37px" class="cls_004"><span class="cls_004">Forecast</span></div>
<div style="position:absolute;left:275.65px;top:457.49px" class="cls_017"><span class="cls_017">• Microsoft Excel and Microsoft PowerPoint.</span></div>
<div style="position:absolute;left:144.06px;top:470.97px" class="cls_004"><span class="cls_004">Presentations</span></div>
<div style="position:absolute;left:275.65px;top:470.69px" class="cls_017"><span class="cls_017">• Some business process and automated</span></div>
<div style="position:absolute;left:144.06px;top:483.57px" class="cls_004"><span class="cls_004">Proformas</span></div>
<div style="position:absolute;left:275.65px;top:483.89px" class="cls_017"><span class="cls_017">document-handling possibilities such as</span></div>
<div style="position:absolute;left:275.65px;top:497.09px" class="cls_017"><span class="cls_017">forecast.</span></div>
<div style="position:absolute;left:275.65px;top:510.29px" class="cls_017"><span class="cls_017">• </span><span class="cls_026">Searchability</span><span class="cls_017"> of presentations is important.</span></div>
<div style="position:absolute;left:60.32px;top:530.89px" class="cls_025"><span class="cls_025">Operations</span></div>
<div style="position:absolute;left:144.06px;top:530.88px" class="cls_004"><span class="cls_004">Methodology</span></div>
<div style="position:absolute;left:275.65px;top:530.00px" class="cls_017"><span class="cls_017">• All Microsoft Office formats.</span></div>
<div style="position:absolute;left:144.06px;top:543.48px" class="cls_004"><span class="cls_004">Utilization reports</span></div>
<div style="position:absolute;left:275.65px;top:543.20px" class="cls_017"><span class="cls_017">• Some opportunity for integration into</span></div>
<div style="position:absolute;left:144.06px;top:556.08px" class="cls_004"><span class="cls_004">Status reports</span></div>
<div style="position:absolute;left:275.65px;top:556.40px" class="cls_017"><span class="cls_017">enterprise systems such as time tracking and</span></div>
<div style="position:absolute;left:275.65px;top:569.60px" class="cls_017"><span class="cls_017">project management.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 17 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:21632px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background033.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:92.10px" class="cls_004"><span class="cls_004">Examples throughout the rest of the book will show how Alfresco can be implemented and</span></div>
<div style="position:absolute;left:56.69px;top:104.70px" class="cls_004"><span class="cls_004">customized to meet the needs of the various organizations within SomeCo. During a real</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">implementation, time would be spent gathering requirements, selecting the appropriate</span></div>
<div style="position:absolute;left:56.69px;top:129.90px" class="cls_004"><span class="cls_004">components to integrate with the solution, finalizing architecture, and structuring the</span></div>
<div style="position:absolute;left:56.69px;top:142.50px" class="cls_004"><span class="cls_004">project. There are plenty of other books and resources that discuss how to roll out content</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">management across an enterprise and others that cover project methodologies. So none of</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">that will be covered here.</span></div>
<div style="position:absolute;left:56.69px;top:206.45px" class="cls_008"><span class="cls_008">Alfresco architecture</span></div>
<div style="position:absolute;left:56.69px;top:234.18px" class="cls_004"><span class="cls_004">Many of Alfresco's competitors (particularly in the closed-source space) have sprawling</span></div>
<div style="position:absolute;left:56.69px;top:246.78px" class="cls_004"><span class="cls_004">footprints composed of multiple, sometimes competing, technologies that have been</span></div>
<div style="position:absolute;left:56.69px;top:259.38px" class="cls_004"><span class="cls_004">acquired and integrated over time. Some have undergone massive infrastructure overhauls</span></div>
<div style="position:absolute;left:56.69px;top:271.98px" class="cls_004"><span class="cls_004">over the years, resulting in bizarre vestigial tails of sorts. Luckily, Alfresco doesn't suffer</span></div>
<div style="position:absolute;left:56.69px;top:284.58px" class="cls_004"><span class="cls_004">from these traits. On the contrary, Alfresco's architecture shows the following</span></div>
<div style="position:absolute;left:56.69px;top:297.18px" class="cls_004"><span class="cls_004">characteristics:</span></div>
<div style="position:absolute;left:104.69px;top:318.91px" class="cls_004"><span class="cls_004">It is relatively straightforward</span></div>
<div style="position:absolute;left:104.69px;top:333.67px" class="cls_004"><span class="cls_004">It is built with state-of-the-art frameworks and open source components</span></div>
<div style="position:absolute;left:104.69px;top:348.43px" class="cls_004"><span class="cls_004">It supports several important content management and related standards</span></div>
<div style="position:absolute;left:56.69px;top:372.32px" class="cls_004"><span class="cls_004">Let's look at each of these characteristics, starting with a high-level look at the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:384.92px" class="cls_004"><span class="cls_004">architecture.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 18 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:22308px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background034.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">High-level architecture</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">The following diagram shows Alfresco's high-level architecture. By the time you finish this</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">book, you'll be intimately familiar with just about every box in the diagram:</span></div>
<div style="position:absolute;left:56.69px;top:365.68px" class="cls_009"><span class="cls_009">The important takeaways at this point are as follows:</span></div>
<div style="position:absolute;left:104.69px;top:387.05px" class="cls_004"><span class="cls_004">There are many ways to get content into or out of the repository, whether that's</span></div>
<div style="position:absolute;left:104.69px;top:399.65px" class="cls_004"><span class="cls_004">via the protocols (for example CIFS on the diagram) or the APIs on the left.</span></div>
<div style="position:absolute;left:104.69px;top:414.41px" class="cls_004"><span class="cls_004">Alfresco runs as a web application within a servlet container. From Alfresco 5.x,</span></div>
<div style="position:absolute;left:104.69px;top:427.01px" class="cls_004"><span class="cls_004">this web application doesn't provide anymore a user interface for end users. It</span></div>
<div style="position:absolute;left:104.69px;top:439.61px" class="cls_004"><span class="cls_004">includes only an administration console. If you need a user interface, you'll need</span></div>
<div style="position:absolute;left:104.69px;top:452.21px" class="cls_004"><span class="cls_004">to deploy the Alfresco Share web application (in the same container or not) and</span></div>
<div style="position:absolute;left:104.69px;top:464.81px" class="cls_004"><span class="cls_004">an extension package in the Alfresco web application to provide all web scripts</span></div>
<div style="position:absolute;left:104.69px;top:477.41px" class="cls_004"><span class="cls_004">required by Alfresco Share. You can as well implement your own user interface</span></div>
<div style="position:absolute;left:104.69px;top:490.01px" class="cls_004"><span class="cls_004">on top of your Alfresco repository.</span></div>
<div style="position:absolute;left:104.69px;top:504.77px" class="cls_004"><span class="cls_004">Customizations and extensions run as part of the Alfresco repository or Share</span></div>
<div style="position:absolute;left:104.69px;top:517.37px" class="cls_004"><span class="cls_004">web application. An extension mechanism separates customizations from the</span></div>
<div style="position:absolute;left:104.69px;top:529.97px" class="cls_004"><span class="cls_004">core product to keep the path clear for future upgrades.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 19 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:22984px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background035.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Metadata resides in a relational database. In a typical Alfresco installation,</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">content files are usually stored in a different server than Alfresco itself (as</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">compared to filesystem). Solr indexes needs to be located in the system as the Solr</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">web application that can reside in a dedicated server too.</span></div>
<div style="position:absolute;left:56.69px;top:145.24px" class="cls_023"><span class="cls_023">Add-ons</span></div>
<div style="position:absolute;left:56.69px;top:167.95px" class="cls_004"><span class="cls_004">The add-ons are pieces of functionality not found in the core Alfresco distribution. If you</span></div>
<div style="position:absolute;left:56.69px;top:180.55px" class="cls_004"><span class="cls_004">are working with the binary distribution, it means you'll have additional files to download</span></div>
<div style="position:absolute;left:56.69px;top:193.15px" class="cls_004"><span class="cls_004">and install on top of the base Alfresco or Share installation.</span></div>
<div style="position:absolute;left:56.69px;top:214.75px" class="cls_004"><span class="cls_004">Add-ons are provided by Alfresco, third-party software vendors, and members of the</span></div>
<div style="position:absolute;left:56.69px;top:227.35px" class="cls_004"><span class="cls_004">Alfresco community such as partners and customers. Alfresco makes several add-on</span></div>
<div style="position:absolute;left:56.69px;top:239.95px" class="cls_004"><span class="cls_004">modules available such as </span><span class="cls_007">Records Management</span><span class="cls_004">, </span><span class="cls_007">Google Docs</span><span class="cls_004">, </span><span class="cls_007">Office Services</span><span class="cls_004"> or </span><span class="cls_007">Kofax</span></div>
<div style="position:absolute;left:56.69px;top:252.59px" class="cls_004"><span class="cls_004">integration. Members of the Alfresco community create and share add-on modules via the</span></div>
<div style="position:absolute;left:56.69px;top:265.19px" class="cls_007"><span class="cls_007">Alfresco add-Ons</span><span class="cls_004"> (</span><a href="https://addons.alfresco.com/">https://addons.alfresco.com/</a> <span class="cls_004">), a website set up by Alfresco for that</span></div>
<div style="position:absolute;left:56.69px;top:278.17px" class="cls_004"><span class="cls_004">purpose. At the time of writing, this website contains 444 different add-ons compatible with</span></div>
<div style="position:absolute;left:56.69px;top:290.77px" class="cls_004"><span class="cls_004">Alfresco Enterprise and/or Community.</span></div>
<div style="position:absolute;left:56.69px;top:327.47px" class="cls_014"><span class="cls_014">Open source components</span></div>
<div style="position:absolute;left:56.69px;top:352.69px" class="cls_004"><span class="cls_004">One of the reasons Alfresco has been able to create a viable offering so quickly is because it</span></div>
<div style="position:absolute;left:56.69px;top:365.29px" class="cls_004"><span class="cls_004">didn't start from scratch. The Alfresco engineers assembled the product from many finer-</span></div>
<div style="position:absolute;left:56.69px;top:377.89px" class="cls_004"><span class="cls_004">grained open source components. Why does this matter? First, instead of reinventing the</span></div>
<div style="position:absolute;left:56.69px;top:390.49px" class="cls_004"><span class="cls_004">wheel, they used proven components. This saved them time, but it also resulted in a more</span></div>
<div style="position:absolute;left:56.69px;top:403.09px" class="cls_004"><span class="cls_004">robust, more standard-based product. Second, it eases the transition for people new to the</span></div>
<div style="position:absolute;left:56.69px;top:415.69px" class="cls_004"><span class="cls_004">platform. If a developer already knows Spring, for example, many of the customization</span></div>
<div style="position:absolute;left:56.69px;top:428.29px" class="cls_004"><span class="cls_004">concepts are going to be familiar. Alfresco uses </span><span class="cls_007">Surf</span><span class="cls_004">, a Spring framework extension for</span></div>
<div style="position:absolute;left:56.69px;top:440.93px" class="cls_004"><span class="cls_004">building or extending MVC applications. And besides, as a developer, wouldn't you rather</span></div>
<div style="position:absolute;left:56.69px;top:453.53px" class="cls_004"><span class="cls_004">invest your time and effort in learning standard development frameworks rather than</span></div>
<div style="position:absolute;left:56.69px;top:466.13px" class="cls_004"><span class="cls_004">proprietary </span><span class="cls_012">development kits</span><span class="cls_004">?</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 20 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:23660px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background036.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The following table lists some of the major open source components used to build Alfresco:</span></div>
<div style="position:absolute;left:60.32px;top:95.71px" class="cls_024"><span class="cls_024">Open source component</span></div>
<div style="position:absolute;left:295.13px;top:95.71px" class="cls_024"><span class="cls_024">Use in Alfresco</span></div>
<div style="position:absolute;left:60.32px;top:114.25px" class="cls_025"><span class="cls_025">Apache Solr (</span><a href="http://lucene.apache.org/solr/">http://lucene.apache.org/solr</a> </div>
<div style="position:absolute;left:295.13px;top:114.25px" class="cls_025"><span class="cls_025">Full-text and metadata search</span></div>
<div style="position:absolute;left:60.32px;top:126.74px" class="cls_010"><span class="cls_010"> </span><a href="http://lucene.apache.org/solr/">/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:60.32px;top:145.74px" class="cls_025"><span class="cls_025">Hibernate (</span><a href="http://www.hibernate.org/">http://www.hibernate.org/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:145.74px" class="cls_025"><span class="cls_025">Database persistence</span></div>
<div style="position:absolute;left:60.32px;top:164.74px" class="cls_025"><span class="cls_025">FreeMarker (</span><a href="http://freemarker.org/">http://freemarker.org/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:164.74px" class="cls_025"><span class="cls_025">Web script framework views, custom</span></div>
<div style="position:absolute;left:295.13px;top:176.74px" class="cls_025"><span class="cls_025">views in the web client, web client</span></div>
<div style="position:absolute;left:295.13px;top:188.74px" class="cls_025"><span class="cls_025">dashlets, email templates</span></div>
<div style="position:absolute;left:60.32px;top:207.25px" class="cls_025"><span class="cls_025">Mozilla Rhino JavaScript Engine (</span><a href="http://www.mozilla.org/rhino/">http://www.moz</a> </div>
<div style="position:absolute;left:295.13px;top:207.25px" class="cls_025"><span class="cls_025">Web script framework controllers, server-</span></div>
<div style="position:absolute;left:60.32px;top:220.74px" class="cls_010"><span class="cls_010"> </span><a href="http://www.mozilla.org/rhino/">illa.org/rhin</a>o/<span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:219.25px" class="cls_025"><span class="cls_025">side JavaScript, actions</span></div>
<div style="position:absolute;left:60.32px;top:238.74px" class="cls_025"><span class="cls_025">OpenSymphony Quartz (</span><a href="http://www.quartz-scheduler.org/">http://www.quartz-sc</a> </div>
<div style="position:absolute;left:295.13px;top:238.74px" class="cls_025"><span class="cls_025">Scheduling of asynchronous processes</span></div>
<div style="position:absolute;left:60.32px;top:252.23px" class="cls_010"><span class="cls_010"> </span><a href="http://www.quartz-scheduler.org/">heduler.or</a>g/<span class="cls_025">)</span></div>
<div style="position:absolute;left:60.32px;top:270.23px" class="cls_025"><span class="cls_025">Spring ACEGI (</span><a href="http://projects.spring.io/spring-security/">http://projects.spring.io/sp</a> </div>
<div style="position:absolute;left:295.13px;top:270.23px" class="cls_025"><span class="cls_025">Security (authorization), roles, and</span></div>
<div style="position:absolute;left:60.32px;top:283.72px" class="cls_010"><span class="cls_010"> </span><a href="http://projects.spring.io/spring-security/">ring-securit</a>y/<span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:282.23px" class="cls_025"><span class="cls_025">permissions</span></div>
<div style="position:absolute;left:60.32px;top:301.72px" class="cls_025"><span class="cls_025">Apache Axis (</span><a href="http://ws.apache.org/axis/">http://ws.apache.org/axis/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:301.72px" class="cls_025"><span class="cls_025">Web services</span></div>
<div style="position:absolute;left:60.32px;top:320.72px" class="cls_025"><span class="cls_025">LibreOffice (</span><a href="http://www.libreoffice.org/">http://www.libreoffice.org/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:320.72px" class="cls_025"><span class="cls_025">Conversion of office documents into PDF</span></div>
<div style="position:absolute;left:60.32px;top:339.72px" class="cls_025"><span class="cls_025">Apache FOP (</span><a href="http://xmlgraphics.apache.org/fop/">http://xmlgraphics.apache.org</a> </div>
<div style="position:absolute;left:295.13px;top:339.72px" class="cls_025"><span class="cls_025">Transformation of XSL:FO into PDF</span></div>
<div style="position:absolute;left:60.32px;top:353.21px" class="cls_010"><span class="cls_010"> </span><a href="http://xmlgraphics.apache.org/fop/">/fo</a>p/<span class="cls_025">)</span></div>
<div style="position:absolute;left:60.32px;top:371.21px" class="cls_025"><span class="cls_025">Apache POI (</span><a href="http://poi.apache.org/">http://poi.apache.org/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:371.21px" class="cls_025"><span class="cls_025">Metadata extraction from Microsoft</span></div>
<div style="position:absolute;left:295.13px;top:383.21px" class="cls_025"><span class="cls_025">Office files</span></div>
<div style="position:absolute;left:60.32px;top:401.72px" class="cls_025"><span class="cls_025">Activiti (</span><a href="http://www.activiti.org/">http://www.activiti.org/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:401.72px" class="cls_025"><span class="cls_025">Advanced workflow</span></div>
<div style="position:absolute;left:60.32px;top:420.72px" class="cls_025"><span class="cls_025">ImageMagick (</span><a href="http://www.imagemagick.org/">http://www.imagemagick.org/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:420.72px" class="cls_025"><span class="cls_025">Image file manipulation</span></div>
<div style="position:absolute;left:60.32px;top:439.72px" class="cls_025"><span class="cls_025">GhostScript (</span><a href="http://www.ghostscript.com/">http://www.ghostscript.com/</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:295.13px;top:439.72px" class="cls_025"><span class="cls_025">Image file manipulation</span></div>
<div style="position:absolute;left:56.69px;top:480.31px" class="cls_004"><span class="cls_004">Does this mean you have to be an expert in all open source components used to build</span></div>
<div style="position:absolute;left:56.69px;top:492.91px" class="cls_004"><span class="cls_004">Alfresco to successfully implement and customize the product? Not at all! Developers</span></div>
<div style="position:absolute;left:56.69px;top:505.51px" class="cls_004"><span class="cls_004">looking to contribute significant product enhancements to Alfresco or those making major,</span></div>
<div style="position:absolute;left:56.69px;top:518.11px" class="cls_004"><span class="cls_004">deep customizations to the product may require experience with a particular component,</span></div>
<div style="position:absolute;left:56.69px;top:530.71px" class="cls_004"><span class="cls_004">depending on exactly what they are trying to do. Everyone else will be able to customize</span></div>
<div style="position:absolute;left:56.69px;top:543.31px" class="cls_004"><span class="cls_004">and extend Alfresco using basic Java and web application development skills.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 21 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:24336px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background037.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Major standards and protocols supported</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Software vendors love buzz words. As new acronyms climb the hype cycle, vendors</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">scramble to figure out how they can at least appear to support the standard or protocol so</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">that the prospective clients can check that box on the </span><span class="cls_007">Request for proposal </span><span class="cls_004">(</span><span class="cls_007">RFP</span><span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:132.82px" class="cls_004"><span class="cls_004">Commercial open source vendors are still software vendors and thus are no less guilty of</span></div>
<div style="position:absolute;left:56.69px;top:145.42px" class="cls_004"><span class="cls_004">this practice. But because open source software is developed in the open by a community of</span></div>
<div style="position:absolute;left:56.69px;top:158.02px" class="cls_004"><span class="cls_004">developers, its compliance to standards tends to be more genuine. It makes more sense for</span></div>
<div style="position:absolute;left:56.69px;top:170.62px" class="cls_004"><span class="cls_004">an open source project to implement a standard than to go off in some new direction</span></div>
<div style="position:absolute;left:56.69px;top:183.22px" class="cls_004"><span class="cls_004">because it saves time. It promotes interoperability with other open source projects, and</span></div>
<div style="position:absolute;left:56.69px;top:195.82px" class="cls_004"><span class="cls_004">stays true to what open source is all about</span><span class="cls_022">-</span><span class="cls_004">freedom and choice.</span></div>
<div style="position:absolute;left:56.69px;top:218.25px" class="cls_004"><span class="cls_004">Here, are the significant standards and protocols Alfresco supports:</span></div>
<div style="position:absolute;left:60.32px;top:243.46px" class="cls_024"><span class="cls_024">Standard/protocol</span></div>
<div style="position:absolute;left:227.84px;top:243.46px" class="cls_024"><span class="cls_024">Comment</span></div>
<div style="position:absolute;left:60.32px;top:262.00px" class="cls_025"><span class="cls_025">HTTP</span></div>
<div style="position:absolute;left:227.84px;top:262.00px" class="cls_025"><span class="cls_025">The main protocol used to access Alfresco content</span></div>
<div style="position:absolute;left:227.84px;top:274.00px" class="cls_025"><span class="cls_025">repository via for example the Alfresco REST APIs.</span></div>
<div style="position:absolute;left:60.32px;top:292.51px" class="cls_025"><span class="cls_025">CMIS</span></div>
<div style="position:absolute;left:227.84px;top:292.51px" class="cls_025"><span class="cls_025">CMIS is a standard allowing information sharing</span></div>
<div style="position:absolute;left:227.84px;top:304.51px" class="cls_025"><span class="cls_025">between different content management systems. Alfresco</span></div>
<div style="position:absolute;left:227.84px;top:316.51px" class="cls_025"><span class="cls_025">supports the version 1.0. and 1.1 of the CMIS standard.</span></div>
<div style="position:absolute;left:60.32px;top:335.02px" class="cls_025"><span class="cls_025">FTP</span></div>
<div style="position:absolute;left:227.84px;top:335.02px" class="cls_025"><span class="cls_025">Content can be contributed to the repository via FTP.</span></div>
<div style="position:absolute;left:60.32px;top:353.53px" class="cls_025"><span class="cls_025">WebDAV</span></div>
<div style="position:absolute;left:227.84px;top:353.53px" class="cls_025"><span class="cls_025">WebDAV is an HTTP-based protocol commonly</span></div>
<div style="position:absolute;left:227.84px;top:365.53px" class="cls_025"><span class="cls_025">supported by content management vendors. It is one</span></div>
<div style="position:absolute;left:227.84px;top:377.53px" class="cls_025"><span class="cls_025">way to make the repository look like a file system.</span></div>
<div style="position:absolute;left:60.32px;top:396.04px" class="cls_025"><span class="cls_025">CIFS</span></div>
<div style="position:absolute;left:227.84px;top:396.04px" class="cls_025"><span class="cls_025">CIFS allows the repository to be mounted as a shared</span></div>
<div style="position:absolute;left:227.84px;top:408.04px" class="cls_025"><span class="cls_025">drive by other machines. As opposed to WebDAV,</span></div>
<div style="position:absolute;left:227.84px;top:420.04px" class="cls_025"><span class="cls_025">systems (and people) can't tell the difference between an</span></div>
<div style="position:absolute;left:227.84px;top:432.04px" class="cls_025"><span class="cls_025">Alfresco repository mounted as a shared drive through</span></div>
<div style="position:absolute;left:227.84px;top:444.04px" class="cls_025"><span class="cls_025">CIFS and a traditional file server.</span></div>
<div style="position:absolute;left:60.32px;top:462.55px" class="cls_025"><span class="cls_025">IMAP</span></div>
<div style="position:absolute;left:227.84px;top:462.55px" class="cls_025"><span class="cls_025">IMAP protocol is used by any modern email clients.</span></div>
<div style="position:absolute;left:227.84px;top:474.55px" class="cls_025"><span class="cls_025">Directly from your client, you can connect to your</span></div>
<div style="position:absolute;left:227.84px;top:486.55px" class="cls_025"><span class="cls_025">Alfresco repository.</span></div>
<div style="position:absolute;left:60.32px;top:505.06px" class="cls_025"><span class="cls_025">SMTP</span></div>
<div style="position:absolute;left:227.84px;top:505.06px" class="cls_025"><span class="cls_025">It is possible to email content into the repository</span></div>
<div style="position:absolute;left:227.84px;top:517.06px" class="cls_025"><span class="cls_025">(InboundSMTP). A folder can be dedicated as an email</span></div>
<div style="position:absolute;left:227.84px;top:529.06px" class="cls_025"><span class="cls_025">target.</span></div>
<div style="position:absolute;left:60.32px;top:547.57px" class="cls_025"><span class="cls_025">SPP</span></div>
<div style="position:absolute;left:227.84px;top:547.57px" class="cls_025"><span class="cls_025">Enables Alfresco to act as a Microsoft SharePoint Server.</span></div>
<div style="position:absolute;left:227.84px;top:559.57px" class="cls_025"><span class="cls_025">Allows Microsoft Office users to access documents</span></div>
<div style="position:absolute;left:227.84px;top:571.57px" class="cls_025"><span class="cls_025">within the Alfresco repository.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 22 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:25012px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background038.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:60.32px;top:74.14px" class="cls_025"><span class="cls_025">Alfresco Office Services</span></div>
<div style="position:absolute;left:227.84px;top:74.14px" class="cls_025"><span class="cls_025">Using </span><span class="cls_024">Alfresco Office Services</span><span class="cls_025"> (</span><span class="cls_024">AOS</span><span class="cls_025">), you can access</span></div>
<div style="position:absolute;left:227.84px;top:86.18px" class="cls_025"><span class="cls_025">your documents directly via all Microsoft Office</span></div>
<div style="position:absolute;left:227.84px;top:98.18px" class="cls_025"><span class="cls_025">software. AOS replaces and improves the Microsoft</span></div>
<div style="position:absolute;left:227.84px;top:110.18px" class="cls_025"><span class="cls_025">SharePoint protocol available in the previous versions.</span></div>
<div style="position:absolute;left:60.32px;top:128.69px" class="cls_025"><span class="cls_025">SOAP</span></div>
<div style="position:absolute;left:227.84px;top:128.69px" class="cls_025"><span class="cls_025">The Alfresco Web Services API uses SOAP-based web</span></div>
<div style="position:absolute;left:227.84px;top:140.69px" class="cls_025"><span class="cls_025">services.</span></div>
<div style="position:absolute;left:60.32px;top:159.20px" class="cls_025"><span class="cls_025">OpenSearch</span></div>
<div style="position:absolute;left:227.84px;top:159.20px" class="cls_025"><span class="cls_025">Alfresco repositories can be configured as an</span></div>
<div style="position:absolute;left:60.32px;top:171.20px" class="cls_025"><span class="cls_025">(</span><a href="http://www.opensearch.org/">http://www.opensearch.org</a> <span class="cls_025">)</span></div>
<div style="position:absolute;left:227.84px;top:171.20px" class="cls_025"><span class="cls_025">OpenSearch data source, which allows Alfresco to</span></div>
<div style="position:absolute;left:227.84px;top:183.20px" class="cls_025"><span class="cls_025">participate in federated search queries.</span></div>
<div style="position:absolute;left:60.32px;top:201.71px" class="cls_025"><span class="cls_025">XSLT, XSL:FO</span></div>
<div style="position:absolute;left:227.84px;top:201.71px" class="cls_025"><span class="cls_025">Web form data can be transformed using XSL 1.0.</span></div>
<div style="position:absolute;left:60.32px;top:220.22px" class="cls_025"><span class="cls_025">LDAP</span></div>
<div style="position:absolute;left:227.84px;top:220.22px" class="cls_025"><span class="cls_025">Alfresco can authenticate against an LDAP directory or a</span></div>
<div style="position:absolute;left:227.84px;top:232.22px" class="cls_025"><span class="cls_025">Microsoft Active Directory server.</span></div>
<div style="position:absolute;left:56.69px;top:267.87px" class="cls_008"><span class="cls_008">Customizing Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:295.60px" class="cls_004"><span class="cls_004">Alfresco offers a significant amount of functionality out of the box, but most </span><span class="cls_012">implementers</span></div>
<div style="position:absolute;left:56.69px;top:308.20px" class="cls_004"><span class="cls_004">will customize it in some way. At a high level, the types of customizations typically done</span></div>
<div style="position:absolute;left:56.69px;top:320.80px" class="cls_004"><span class="cls_004">during an implementation can be divided into basic customizations and advanced</span></div>
<div style="position:absolute;left:56.69px;top:333.40px" class="cls_004"><span class="cls_004">customizations.</span></div>
<div style="position:absolute;left:56.69px;top:370.10px" class="cls_014"><span class="cls_014">Basic customization</span></div>
<div style="position:absolute;left:56.69px;top:395.32px" class="cls_004"><span class="cls_004">Many Alfresco customizations can be done without writing a single line of code. Some may</span></div>
<div style="position:absolute;left:56.69px;top:407.92px" class="cls_004"><span class="cls_004">be done even by end users through Alfresco Share. Others might require editing a</span></div>
<div style="position:absolute;left:56.69px;top:420.52px" class="cls_004"><span class="cls_004">properties file or an XML file. Let's look at some of them briefly here so that you can get an</span></div>
<div style="position:absolute;left:56.69px;top:433.12px" class="cls_004"><span class="cls_004">idea of what you don't have to code. Other customizations will be introduced in the</span></div>
<div style="position:absolute;left:56.69px;top:445.73px" class="cls_010"><span class="cls_010">Chapter 9</span><span class="cls_004">, </span><span class="cls_012">Amazing Extensions</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 23 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:25688px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background039.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Dashlets</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">When users log in to Alfresco, the first thing that is usually displayed is the </span><span class="cls_007">My Dashboard</span></div>
<div style="position:absolute;left:56.69px;top:105.22px" class="cls_004"><span class="cls_004">section. The dashboard is a user-configurable layout that contains dashlets. (If you are</span></div>
<div style="position:absolute;left:56.69px;top:117.83px" class="cls_004"><span class="cls_004">familiar with portals, think </span><span class="cls_012">portal page</span><span class="cls_004"> and </span><span class="cls_012">portlet</span><span class="cls_004">). Users choose the layout of the dashboard</span></div>
<div style="position:absolute;left:56.69px;top:130.43px" class="cls_004"><span class="cls_004">(number of columns) as well as the specific dashlets they want displayed in each column.</span></div>
<div style="position:absolute;left:56.69px;top:152.03px" class="cls_004"><span class="cls_004">There are a number of dashlets available out of the box, or you can develop your own and</span></div>
<div style="position:absolute;left:56.69px;top:164.63px" class="cls_004"><span class="cls_004">add them to the user-selectable list. Examples of out of the box dashlets include workflow-</span></div>
<div style="position:absolute;left:56.69px;top:177.23px" class="cls_004"><span class="cls_004">related dashlet such as </span><span class="cls_007">My Tasks </span><span class="cls_004">as well as content-related dashlets such as </span><span class="cls_007">My</span></div>
<div style="position:absolute;left:56.69px;top:189.86px" class="cls_007"><span class="cls_007">Documents</span><span class="cls_004">, </span><span class="cls_007">My Sites</span><span class="cls_004"> or </span><span class="cls_007">My Activities</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 24 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:26364px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background040.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Currently most of these dashlets are </span><span class="cls_007">Spring Surf Dashlets</span><span class="cls_004"> (</span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-surf-dashlets.html">http://docs.alfresco.com/5.</a> </div>
<div style="position:absolute;left:56.69px;top:83.48px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-surf-dashlets.html">1/concepts/dev-extensions-share-surf-dashlets.html</a> <span class="cls_004">), but they will eventually</span></div>
<div style="position:absolute;left:56.69px;top:96.46px" class="cls_004"><span class="cls_004">be converted to </span><span class="cls_007">Aikau Dashlets</span><span class="cls_004"> (</span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-aikau-dashlets.html">http://docs.alfresco.com/5.1/concepts/dev-extensi</a> </div>
<div style="position:absolute;left:56.69px;top:109.44px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-aikau-dashlets.html">ons-share-aikau-dashlets.html</a> <span class="cls_004">). Aikau is the new UI framework developed by Alfresco,</span></div>
<div style="position:absolute;left:56.69px;top:122.42px" class="cls_004"><span class="cls_004">and available from Alfresco 4.2.Some of these existing dashlets allows you some</span></div>
<div style="position:absolute;left:56.69px;top:135.02px" class="cls_004"><span class="cls_004">configuration. Here are some examples:</span></div>
<div style="position:absolute;left:104.69px;top:156.75px" class="cls_007"><span class="cls_007">RSS Feed</span><span class="cls_004">: By simply configuring the RSS Feed URL, it will display automatically</span></div>
<div style="position:absolute;left:104.69px;top:169.39px" class="cls_004"><span class="cls_004">the RSS items. The following screenshot  shows a dashlet configured to display</span></div>
<div style="position:absolute;left:104.69px;top:181.99px" class="cls_004"><span class="cls_004">the latest tweets by </span><span class="cls_013">PacktPub</span></div>
<div style="position:absolute;left:104.69px;top:195.27px" class="cls_004"><span class="cls_004">(</span><a href="https://twitrss.me/twitter_user_to_rss/?user=packtpub">https://twitrss.me/twitter_user_to_rss/?user=packtpub</a> <span class="cls_004">):</span></div>
<div style="position:absolute;left:104.69px;top:388.33px" class="cls_007"><span class="cls_007">Saved Search</span><span class="cls_004">: This dashlet runs a specific search each time the dashboard is</span></div>
<div style="position:absolute;left:104.69px;top:400.96px" class="cls_004"><span class="cls_004">loaded:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 25 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:27040px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background041.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_007"><span class="cls_007">Web View</span><span class="cls_004">: This dashlet is used to display any website:</span></div>
<div style="position:absolute;left:56.69px;top:220.47px" class="cls_004"><span class="cls_004">Obviously, developing custom dashlets is probably not something you'd let your business</span></div>
<div style="position:absolute;left:56.69px;top:233.07px" class="cls_004"><span class="cls_004">users do; but it is still considered a basic customization. It can be complex to develop new</span></div>
<div style="position:absolute;left:56.69px;top:245.67px" class="cls_004"><span class="cls_004">dashlet depending if you need to develop new web script for example.</span></div>
<div style="position:absolute;left:56.69px;top:280.32px" class="cls_023"><span class="cls_023">Custom site configuration</span></div>
<div style="position:absolute;left:56.69px;top:303.04px" class="cls_004"><span class="cls_004">The first concept that you'll discover using Alfresco Share is the concept of </span><span class="cls_012">site</span><span class="cls_004">. It's a secured</span></div>
<div style="position:absolute;left:56.69px;top:315.64px" class="cls_004"><span class="cls_004">area in the repository where a team, a project or a suborganization can share and manage</span></div>
<div style="position:absolute;left:56.69px;top:328.24px" class="cls_004"><span class="cls_004">any kind of contents, including documents of course. A site includes multiple pages,</span></div>
<div style="position:absolute;left:56.69px;top:340.84px" class="cls_004"><span class="cls_004">depending mainly of the type of content. Alfresco Share provides the following by default:</span></div>
<div style="position:absolute;left:104.69px;top:362.57px" class="cls_004"><span class="cls_004">A document library page</span></div>
<div style="position:absolute;left:104.69px;top:377.33px" class="cls_004"><span class="cls_004">A calendar page</span></div>
<div style="position:absolute;left:104.69px;top:392.09px" class="cls_004"><span class="cls_004">A Wiki page</span></div>
<div style="position:absolute;left:104.69px;top:406.85px" class="cls_004"><span class="cls_004">A forum page</span></div>
<div style="position:absolute;left:104.69px;top:421.61px" class="cls_004"><span class="cls_004">A data-list page</span></div>
<div style="position:absolute;left:104.69px;top:436.37px" class="cls_004"><span class="cls_004">A links page</span></div>
<div style="position:absolute;left:104.69px;top:451.13px" class="cls_004"><span class="cls_004">A blog page</span></div>
<div style="position:absolute;left:56.69px;top:475.02px" class="cls_004"><span class="cls_004">In each site, you can configure and select only what is needed by the users.</span></div>
<div style="position:absolute;left:56.69px;top:496.62px" class="cls_004"><span class="cls_004">Each Alfresco Share site contains as well a dedicated dashboard that you can entirely</span></div>
<div style="position:absolute;left:56.69px;top:509.22px" class="cls_004"><span class="cls_004">customize with all out-of-the-box dashlets already provided.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 26 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:27716px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background042.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Rules and actions</span></div>
<div style="position:absolute;left:56.69px;top:92.59px" class="cls_004"><span class="cls_004">A rule is something that says, </span><span class="cls_027">“</span><span class="cls_012">When a piece of content is created, updated, or deleted, check these</span></div>
<div style="position:absolute;left:56.69px;top:106.02px" class="cls_012"><span class="cls_012">conditions. If these conditions are met, take these actions</span><span class="cls_027">”</span><span class="cls_004">. Conditions may check whether a piece</span></div>
<div style="position:absolute;left:56.69px;top:119.45px" class="cls_004"><span class="cls_004">of content is a particular mime type, or a specific content type. They may also check</span></div>
<div style="position:absolute;left:56.69px;top:132.05px" class="cls_004"><span class="cls_004">whether a piece of content has a specific aspect applied, or whether the content's name</span></div>
<div style="position:absolute;left:56.69px;top:144.65px" class="cls_004"><span class="cls_004">property matches a particular pattern. Rules can be defined on any folder in the repository.</span></div>
<div style="position:absolute;left:56.69px;top:157.25px" class="cls_004"><span class="cls_004">Child folders can inherit rules from their parent.</span></div>
<div style="position:absolute;left:56.69px;top:178.85px" class="cls_004"><span class="cls_004">Rule actions are repeatable operations that enable us to do things similar to those that can</span></div>
<div style="position:absolute;left:56.69px;top:191.45px" class="cls_004"><span class="cls_004">be done using JavaScript or Java. Out-of-the-box actions include things such as check-in</span></div>
<div style="position:absolute;left:56.69px;top:204.05px" class="cls_004"><span class="cls_004">content, check-out content, move an item to another folder, specialize the type of the</span></div>
<div style="position:absolute;left:56.69px;top:216.65px" class="cls_004"><span class="cls_004">content, add an aspect to the content, transform content from one format to another, and so</span></div>
<div style="position:absolute;left:56.69px;top:229.25px" class="cls_004"><span class="cls_004">on.</span></div>
<div style="position:absolute;left:56.69px;top:250.85px" class="cls_004"><span class="cls_004">Configuring folders to run rule actions is something non-technical users can do through</span></div>
<div style="position:absolute;left:56.69px;top:263.46px" class="cls_004"><span class="cls_004">Alfresco Share. In </span><span class="cls_010">Chapter 4</span><span class="cls_004">, </span><span class="cls_012">Handling Content Automatically with Actions, Behaviors,</span></div>
<div style="position:absolute;left:56.69px;top:276.44px" class="cls_012"><span class="cls_012">Transformers, and Extractors</span><span class="cls_004">, you'll learn how to write your own custom rule actions using</span></div>
<div style="position:absolute;left:56.69px;top:289.04px" class="cls_004"><span class="cls_004">the Alfresco API.</span></div>
<div style="position:absolute;left:56.69px;top:323.69px" class="cls_023"><span class="cls_023">Simple workflow</span></div>
<div style="position:absolute;left:56.69px;top:346.40px" class="cls_004"><span class="cls_004">Alfresco has two options for implementing workflow: simple workflow or advanced</span></div>
<div style="position:absolute;left:56.69px;top:359.00px" class="cls_004"><span class="cls_004">workflow. The good thing about simple workflows is that end users can configure them as</span></div>
<div style="position:absolute;left:56.69px;top:371.60px" class="cls_004"><span class="cls_004">needed without any technical skills or developer support.</span></div>
<div style="position:absolute;left:56.69px;top:393.21px" class="cls_004"><span class="cls_004">Here's how it works. A user creates a rule to </span><span class="cls_012">add simple workflow</span><span class="cls_004"> to a document when it is</span></div>
<div style="position:absolute;left:56.69px;top:405.81px" class="cls_004"><span class="cls_004">placed in the folder. When an item enters a folder with this type of rule applied, it will have</span></div>
<div style="position:absolute;left:56.69px;top:418.41px" class="cls_004"><span class="cls_004">additional UI action items available. The rule to specify the user actions and flow of the</span></div>
<div style="position:absolute;left:56.69px;top:431.01px" class="cls_004"><span class="cls_004">content between folders is configured in the repository action. When the step is invoked, the</span></div>
<div style="position:absolute;left:56.69px;top:443.61px" class="cls_004"><span class="cls_004">content can be copied or moved to another folder. It's also possible to add complexity to a</span></div>
<div style="position:absolute;left:56.69px;top:456.21px" class="cls_004"><span class="cls_004">simple workflow by creating rules for other folders and passing content around from</span></div>
<div style="position:absolute;left:56.69px;top:468.81px" class="cls_004"><span class="cls_004">location to location. For example, there might be folders called </span><span class="cls_013">Draft</span><span class="cls_004">, </span><span class="cls_013">In Review</span><span class="cls_004">, and</span></div>
<div style="position:absolute;left:56.69px;top:482.09px" class="cls_013"><span class="cls_013">Approved</span><span class="cls_004">. The state of a document is determined by the folder in which it resides.</span></div>
<div style="position:absolute;left:56.69px;top:504.37px" class="cls_004"><span class="cls_004">Simple workflows have obvious limitations:</span></div>
<div style="position:absolute;left:104.69px;top:526.10px" class="cls_004"><span class="cls_004">Workflows are limited to serial processes. Content can only move forward or</span></div>
<div style="position:absolute;left:104.69px;top:538.70px" class="cls_004"><span class="cls_004">backward, one step at a time.</span></div>
<div style="position:absolute;left:104.69px;top:553.46px" class="cls_004"><span class="cls_004">Content can only be in only one simple workflow state at a given time.</span></div>
<div style="position:absolute;left:104.69px;top:568.22px" class="cls_004"><span class="cls_004">Content must change physical locations to reflect a change in state.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 27 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:28392px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background043.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">There is no opportunity for capturing (and acting on) process-related metadata.</span></div>
<div style="position:absolute;left:104.69px;top:85.26px" class="cls_004"><span class="cls_004">Tasks can't be assigned to individuals or groups. (Of course, you could limit</span></div>
<div style="position:absolute;left:104.69px;top:97.86px" class="cls_004"><span class="cls_004">folders to specific individuals or groups through permissions, which would have</span></div>
<div style="position:absolute;left:104.69px;top:110.46px" class="cls_004"><span class="cls_004">a similar effect to a task assignment. But you wouldn't be able to easily pull a list</span></div>
<div style="position:absolute;left:104.69px;top:123.06px" class="cls_004"><span class="cls_004">of tasks for a specific user across all simple workflows).</span></div>
<div style="position:absolute;left:104.69px;top:137.82px" class="cls_004"><span class="cls_004">Other than creating additional rules and actions for the folders used in a simple</span></div>
<div style="position:absolute;left:104.69px;top:150.42px" class="cls_004"><span class="cls_004">workflow, there is no way to add logic for decisions or other more complex</span></div>
<div style="position:absolute;left:104.69px;top:163.02px" class="cls_004"><span class="cls_004">constructs. If you need to implement specific behavior depending of the state,</span></div>
<div style="position:absolute;left:104.69px;top:175.62px" class="cls_004"><span class="cls_004">you have to implement additional action and rule attached to each folder.</span></div>
<div style="position:absolute;left:56.69px;top:214.61px" class="cls_014"><span class="cls_014">Advanced customization</span></div>
<div style="position:absolute;left:56.69px;top:239.83px" class="cls_004"><span class="cls_004">The basic configuration and customizations show that there is quite a lot of tweaking and</span></div>
<div style="position:absolute;left:56.69px;top:252.43px" class="cls_004"><span class="cls_004">tailoring that can happen before a developer gets involved. This is a good thing. It means a</span></div>
<div style="position:absolute;left:56.69px;top:265.03px" class="cls_004"><span class="cls_004">good chunk of the customization requirements can be dealt with quickly. In the case of</span></div>
<div style="position:absolute;left:56.69px;top:277.63px" class="cls_004"><span class="cls_004">simple workflows, they can be delegated to the end users altogether! Hopefully, this leaves</span></div>
<div style="position:absolute;left:56.69px;top:290.23px" class="cls_004"><span class="cls_004">more time for the more advanced (and more interesting) customizations required for a</span></div>
<div style="position:absolute;left:56.69px;top:302.83px" class="cls_004"><span class="cls_004">successful implementation.</span></div>
<div style="position:absolute;left:56.69px;top:337.48px" class="cls_023"><span class="cls_023">Examples of advanced customizations</span></div>
<div style="position:absolute;left:56.69px;top:360.19px" class="cls_004"><span class="cls_004">The advanced customizations are the customizations that are likely to require code. They</span></div>
<div style="position:absolute;left:56.69px;top:372.79px" class="cls_004"><span class="cls_004">are the focus of the book. To give you an idea of what's possible (and in an effort to provide</span></div>
<div style="position:absolute;left:56.69px;top:385.39px" class="cls_004"><span class="cls_004">an appetizer before the main meal is served), let's go over some of the areas of advanced</span></div>
<div style="position:absolute;left:56.69px;top:397.99px" class="cls_004"><span class="cls_004">customization.</span></div>
<div style="position:absolute;left:56.69px;top:432.64px" class="cls_023"><span class="cls_023">Extend the content model</span></div>
<div style="position:absolute;left:56.69px;top:455.35px" class="cls_004"><span class="cls_004">Alfresco's out-of-the-box content model can be extended to define your own content types,</span></div>
<div style="position:absolute;left:56.69px;top:467.95px" class="cls_004"><span class="cls_004">content aspects, content metadata (properties), and relationships (associations). The out-of-</span></div>
<div style="position:absolute;left:56.69px;top:480.55px" class="cls_004"><span class="cls_004">the-box model is very generic, and defines only a minimal subset of the metadata that will</span></div>
<div style="position:absolute;left:56.69px;top:493.15px" class="cls_004"><span class="cls_004">probably need to be captured with the content.</span></div>
<div style="position:absolute;left:56.69px;top:514.75px" class="cls_004"><span class="cls_004">For example, SomeCo might want to capture different metadata for its marketing</span></div>
<div style="position:absolute;left:56.69px;top:527.35px" class="cls_004"><span class="cls_004">documents than for its HR documents. Or maybe there is a set of metadata that doesn't</span></div>
<div style="position:absolute;left:56.69px;top:539.95px" class="cls_004"><span class="cls_004">belong to any one content type in particular, but should rather be grouped together in an</span></div>
<div style="position:absolute;left:56.69px;top:552.55px" class="cls_004"><span class="cls_004">aspect and attached to objects as needed. These and other content modeling concepts will be</span></div>
<div style="position:absolute;left:56.69px;top:565.16px" class="cls_004"><span class="cls_004">covered in </span><span class="cls_010">Chapter 3</span><span class="cls_004">, </span><span class="cls_012">Working with Content Models</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 28 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:29068px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background044.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Perform automatic operations on content</span></div>
<div style="position:absolute;left:56.69px;top:92.59px" class="cls_004"><span class="cls_004">There are several </span><span class="cls_012">hooks</span><span class="cls_004"> or places where you can insert logic or take action to handle content</span></div>
<div style="position:absolute;left:56.69px;top:105.19px" class="cls_004"><span class="cls_004">automatically. These include rule actions, behaviors, content transformers, and metadata</span></div>
<div style="position:absolute;left:56.69px;top:117.79px" class="cls_004"><span class="cls_004">extractors. Rule actions have already been discussed. Behaviors are like actions but instead</span></div>
<div style="position:absolute;left:56.69px;top:130.39px" class="cls_004"><span class="cls_004">of being something that an end user can invoke on any piece of content, behaviors are</span></div>
<div style="position:absolute;left:56.69px;top:142.99px" class="cls_004"><span class="cls_004">tightly bound to their content type or aspect. Content transformers, as the name suggests,</span></div>
<div style="position:absolute;left:56.69px;top:155.59px" class="cls_004"><span class="cls_004">transform content from one format to another. Metadata extractors inspect content as it is</span></div>
<div style="position:absolute;left:56.69px;top:168.19px" class="cls_004"><span class="cls_004">added to the repository, and pull out data to store in the content object's properties. These</span></div>
<div style="position:absolute;left:56.69px;top:180.79px" class="cls_004"><span class="cls_004">tools for handling content automatically will all be covered in </span><span class="cls_010">Chapter 4</span><span class="cls_004">, </span><span class="cls_012">Handling Content</span></div>
<div style="position:absolute;left:56.69px;top:193.78px" class="cls_012"><span class="cls_012">Automatically with Actions, Behaviors, Transformers, and Extractors.</span></div>
<div style="position:absolute;left:56.69px;top:228.42px" class="cls_023"><span class="cls_023">Customize Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:251.14px" class="cls_010"><span class="cls_010">C</span><span class="cls_004">hapter 5, </span><span class="cls_012">Customizing Alfresco Share</span><span class="cls_004">, covers Share customization. Just about everything in</span></div>
<div style="position:absolute;left:56.69px;top:264.12px" class="cls_004"><span class="cls_004">the Share web application can be tweaked. In the document library, it's possible to</span></div>
<div style="position:absolute;left:56.69px;top:276.72px" class="cls_004"><span class="cls_004">configure the view of a content, or the edit form depending of the content type. It's possible</span></div>
<div style="position:absolute;left:56.69px;top:289.32px" class="cls_004"><span class="cls_004">as well to define a template renderer that changes the default view in the document list.</span></div>
<div style="position:absolute;left:56.69px;top:301.92px" class="cls_004"><span class="cls_004">Alfresco Share provides as well different views that you can customize, or even create new</span></div>
<div style="position:absolute;left:56.69px;top:314.52px" class="cls_004"><span class="cls_004">ones. And if you want more, you can even create your own page from scratch.</span></div>
<div style="position:absolute;left:56.69px;top:349.16px" class="cls_023"><span class="cls_023">Create a RESTful API</span></div>
<div style="position:absolute;left:56.69px;top:371.88px" class="cls_004"><span class="cls_004">Web scripts are one of the more exciting additions to the Alfresco architecture. The reason is</span></div>
<div style="position:absolute;left:56.69px;top:384.48px" class="cls_004"><span class="cls_004">that RESTful services are typically much easier to work with using scripting languages and</span></div>
<div style="position:absolute;left:56.69px;top:397.08px" class="cls_004"><span class="cls_004">AJAX toolkits than SOAP-based services, because they are invoked through plain old URLs.</span></div>
<div style="position:absolute;left:56.69px;top:418.68px" class="cls_004"><span class="cls_004">The web script framework, based on the </span><span class="cls_007">Model-View-Control</span><span class="cls_004"> (</span><span class="cls_007">MVC</span><span class="cls_004">) pattern, allows you</span></div>
<div style="position:absolute;left:56.69px;top:431.32px" class="cls_004"><span class="cls_004">to build your own RESTful API to the repository. It will be covered in detail in </span><span class="cls_010">Chapter 7</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:444.30px" class="cls_012"><span class="cls_012">Exposing Content through a RESTful API with Web Scripts</span><span class="cls_004">, but the high-level summary is that</span></div>
<div style="position:absolute;left:56.69px;top:456.90px" class="cls_004"><span class="cls_004">URLs get mapped to a controller implemented as JavaScript or Java. The controller</span></div>
<div style="position:absolute;left:56.69px;top:469.50px" class="cls_004"><span class="cls_004">performs whatever logic is needed, then forwards the request to the view. The view is</span></div>
<div style="position:absolute;left:56.69px;top:482.10px" class="cls_004"><span class="cls_004">implemented as a </span><span class="cls_007">FreeMarker</span><span class="cls_004"> template. The template could return anything from markup</span></div>
<div style="position:absolute;left:56.69px;top:494.74px" class="cls_004"><span class="cls_004">to XML to JSON. RESTful services via web scripts are the preferred way to integrate with</span></div>
<div style="position:absolute;left:56.69px;top:507.34px" class="cls_004"><span class="cls_004">the Alfresco repository.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 29 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:29744px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background045.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Streamline complex business processes with advanced</span></div>
<div style="position:absolute;left:56.69px;top:89.07px" class="cls_023"><span class="cls_023">workflows</span></div>
<div style="position:absolute;left:56.69px;top:111.78px" class="cls_004"><span class="cls_004">Advanced workflows provide a way to automate complex business processes. Alfresco's</span></div>
<div style="position:absolute;left:56.69px;top:124.38px" class="cls_004"><span class="cls_004">advanced workflows are executed by the embedded Activiti engine, which is a very</span></div>
<div style="position:absolute;left:56.69px;top:136.98px" class="cls_004"><span class="cls_004">powerful and popular open source workflow engine.</span></div>
<div style="position:absolute;left:56.69px;top:158.58px" class="cls_004"><span class="cls_004">Rather than basic workflows, which are end-user configurable and limited to serial</span></div>
<div style="position:absolute;left:56.69px;top:171.18px" class="cls_004"><span class="cls_004">processes, advanced workflows offer the power of parallel flows, the ability to add logic to</span></div>
<div style="position:absolute;left:56.69px;top:183.78px" class="cls_004"><span class="cls_004">the process via JavaScript and Java, and much more.</span></div>
<div style="position:absolute;left:56.69px;top:205.38px" class="cls_004"><span class="cls_004">A handful of advanced workflows are available out of the box. These are most useful as</span></div>
<div style="position:absolute;left:56.69px;top:217.98px" class="cls_004"><span class="cls_004">starting points for your own custom advanced workflows. Exactly how it has to be done</span></div>
<div style="position:absolute;left:56.69px;top:230.59px" class="cls_004"><span class="cls_004">will be covered in </span><span class="cls_010">Chapter 8</span><span class="cls_004">, </span><span class="cls_012">Advanced Workflows.</span></div>
<div style="position:absolute;left:56.69px;top:265.61px" class="cls_023"><span class="cls_023">Integrate with other systems</span></div>
<div style="position:absolute;left:56.69px;top:288.33px" class="cls_004"><span class="cls_004">Most of the coding and configuration discussed so far can be divided into two parts:</span></div>
<div style="position:absolute;left:104.69px;top:310.06px" class="cls_004"><span class="cls_004">Customizations made to the core Alfresco repository</span></div>
<div style="position:absolute;left:104.69px;top:324.82px" class="cls_004"><span class="cls_004">Customizations made to Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:348.71px" class="cls_004"><span class="cls_004">There is a third bucket to be considered, which is coding and configuration related to</span></div>
<div style="position:absolute;left:56.69px;top:361.31px" class="cls_004"><span class="cls_004">integrating Alfresco with other solutions. Maybe Alfresco needs to authenticate against an</span></div>
<div style="position:absolute;left:56.69px;top:373.91px" class="cls_004"><span class="cls_004">LDAP directory. Maybe a portal will get its content from Alfresco, or perhaps some other</span></div>
<div style="position:absolute;left:56.69px;top:386.51px" class="cls_004"><span class="cls_004">third-party application needs to share content with Alfresco. </span><span class="cls_010">Chapter 9</span><span class="cls_004">, </span><span class="cls_012">Amazing</span></div>
<div style="position:absolute;left:56.69px;top:399.50px" class="cls_012"><span class="cls_012">Extensions</span><span class="cls_004">,</span><span class="cls_012"> </span><span class="cls_004">discusses how to handle security and integration.</span></div>
<div style="position:absolute;left:56.69px;top:438.25px" class="cls_008"><span class="cls_008">Dusting off your toolbox</span></div>
<div style="position:absolute;left:56.69px;top:465.98px" class="cls_004"><span class="cls_004">Looking across both the basic and advanced customizations provides some idea about the</span></div>
<div style="position:absolute;left:56.69px;top:478.58px" class="cls_004"><span class="cls_004">extensibility of the platform. A commonly asked question at this point in the architecture</span></div>
<div style="position:absolute;left:56.69px;top:491.18px" class="cls_004"><span class="cls_004">discussion is, </span><span class="cls_012">Does Alfresco have an API</span><span class="cls_004">? Actually, it has several. Let's look at what APIs are</span></div>
<div style="position:absolute;left:56.69px;top:503.78px" class="cls_004"><span class="cls_004">available and where they are used. This should also give you some idea as to the tools and</span></div>
<div style="position:absolute;left:56.69px;top:516.38px" class="cls_004"><span class="cls_004">skills you'll need to have in your toolbox as you embark on your own projects.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 30 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:30420px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background046.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The following table shows the APIs available and where they are used:</span></div>
<div style="position:absolute;left:60.32px;top:95.71px" class="cls_024"><span class="cls_024">Alfresco API</span></div>
<div style="position:absolute;left:137.35px;top:95.71px" class="cls_024"><span class="cls_024">Where Used</span></div>
<div style="position:absolute;left:293.62px;top:95.71px" class="cls_024"><span class="cls_024">Comments</span></div>
<div style="position:absolute;left:60.32px;top:114.25px" class="cls_025"><span class="cls_025">Foundation</span></div>
<div style="position:absolute;left:137.35px;top:114.25px" class="cls_025"><span class="cls_025">Rule actions, behaviors, Java-</span></div>
<div style="position:absolute;left:293.62px;top:114.25px" class="cls_025"><span class="cls_025">As the name suggests, this is the core</span></div>
<div style="position:absolute;left:60.32px;top:126.25px" class="cls_025"><span class="cls_025">API</span></div>
<div style="position:absolute;left:137.35px;top:126.25px" class="cls_025"><span class="cls_025">based web scripts, web client</span></div>
<div style="position:absolute;left:293.62px;top:126.25px" class="cls_025"><span class="cls_025">Alfresco API.</span></div>
<div style="position:absolute;left:137.35px;top:138.25px" class="cls_025"><span class="cls_025">customizations, Activiti,</span></div>
<div style="position:absolute;left:137.35px;top:150.25px" class="cls_025"><span class="cls_025">standalone applications that</span></div>
<div style="position:absolute;left:137.35px;top:162.25px" class="cls_025"><span class="cls_025">embed the Alfresco repository.</span></div>
<div style="position:absolute;left:60.32px;top:180.76px" class="cls_025"><span class="cls_025">Alfresco One</span></div>
<div style="position:absolute;left:137.35px;top:180.76px" class="cls_025"><span class="cls_025">Web and non-web applications</span></div>
<div style="position:absolute;left:293.62px;top:180.76px" class="cls_025"><span class="cls_025">The Alfresco One API was introduced</span></div>
<div style="position:absolute;left:60.32px;top:192.76px" class="cls_025"><span class="cls_025">API</span></div>
<div style="position:absolute;left:137.35px;top:192.76px" class="cls_025"><span class="cls_025">that need remote access to the</span></div>
<div style="position:absolute;left:293.62px;top:192.76px" class="cls_025"><span class="cls_025">with Alfresco 4.x, and is also present in</span></div>
<div style="position:absolute;left:137.35px;top:204.76px" class="cls_025"><span class="cls_025">repository.</span></div>
<div style="position:absolute;left:293.62px;top:204.76px" class="cls_025"><span class="cls_025">the public cloud version of Alfresco. It</span></div>
<div style="position:absolute;left:293.62px;top:216.76px" class="cls_025"><span class="cls_025">provides the main remote API, and is the</span></div>
<div style="position:absolute;left:293.62px;top:228.76px" class="cls_025"><span class="cls_025">recommended API for developing remote</span></div>
<div style="position:absolute;left:293.62px;top:240.76px" class="cls_025"><span class="cls_025">client applications.</span></div>
<div style="position:absolute;left:60.32px;top:259.27px" class="cls_025"><span class="cls_025">CMIS API</span></div>
<div style="position:absolute;left:137.35px;top:259.27px" class="cls_025"><span class="cls_025">Web and non-web applications</span></div>
<div style="position:absolute;left:293.62px;top:259.27px" class="cls_025"><span class="cls_025">CMIS provides a standardized set of</span></div>
<div style="position:absolute;left:137.35px;top:271.27px" class="cls_025"><span class="cls_025">that need remote access to the</span></div>
<div style="position:absolute;left:293.62px;top:271.27px" class="cls_025"><span class="cls_025">common services for working with</span></div>
<div style="position:absolute;left:137.35px;top:283.27px" class="cls_025"><span class="cls_025">repository.</span></div>
<div style="position:absolute;left:293.62px;top:283.27px" class="cls_025"><span class="cls_025">content repositories. Alfresco provides an</span></div>
<div style="position:absolute;left:293.62px;top:295.27px" class="cls_025"><span class="cls_025">implementation of CMIS Web service and</span></div>
<div style="position:absolute;left:293.62px;top:307.27px" class="cls_025"><span class="cls_025">RESTful bindings.</span></div>
<div style="position:absolute;left:60.32px;top:325.78px" class="cls_025"><span class="cls_025">FreeMarker</span></div>
<div style="position:absolute;left:137.35px;top:325.78px" class="cls_025"><span class="cls_025">Custom views, mail templates,</span></div>
<div style="position:absolute;left:293.62px;top:325.78px" class="cls_025"><span class="cls_025">FreeMarker is an open source templating</span></div>
<div style="position:absolute;left:60.32px;top:337.78px" class="cls_025"><span class="cls_025">API</span></div>
<div style="position:absolute;left:137.35px;top:337.78px" class="cls_025"><span class="cls_025">web script view logic.</span></div>
<div style="position:absolute;left:293.62px;top:337.78px" class="cls_025"><span class="cls_025">engine.</span></div>
<div style="position:absolute;left:60.32px;top:356.29px" class="cls_025"><span class="cls_025">Web script</span></div>
<div style="position:absolute;left:137.35px;top:356.29px" class="cls_025"><span class="cls_025">Web and non-web applications</span></div>
<div style="position:absolute;left:293.62px;top:356.29px" class="cls_025"><span class="cls_025">More of a framework than an API, web</span></div>
<div style="position:absolute;left:60.32px;top:368.29px" class="cls_025"><span class="cls_025">framework</span></div>
<div style="position:absolute;left:137.35px;top:368.29px" class="cls_025"><span class="cls_025">that need to use REST to interact</span></div>
<div style="position:absolute;left:293.62px;top:368.29px" class="cls_025"><span class="cls_025">scripts implement a MVC pattern that</span></div>
<div style="position:absolute;left:137.35px;top:380.29px" class="cls_025"><span class="cls_025">with the repository.</span></div>
<div style="position:absolute;left:293.62px;top:380.29px" class="cls_025"><span class="cls_025">relies on the JavaScript, FreeMarker, and</span></div>
<div style="position:absolute;left:293.62px;top:392.29px" class="cls_025"><span class="cls_025">Foundation APIs.</span></div>
<div style="position:absolute;left:56.69px;top:410.79px" class="cls_004"><span class="cls_004">As the list of APIs shows, knowing Java will be the key to just about any successful</span></div>
<div style="position:absolute;left:56.69px;top:423.39px" class="cls_004"><span class="cls_004">customization effort. FreeMarker and JavaScript are important, but are easily picked up</span></div>
<div style="position:absolute;left:56.69px;top:435.99px" class="cls_004"><span class="cls_004">using Alfresco's code and online resources as references.</span></div>
<div style="position:absolute;left:56.69px;top:474.74px" class="cls_008"><span class="cls_008">Understanding Alfresco's editions</span></div>
<div style="position:absolute;left:56.69px;top:502.47px" class="cls_004"><span class="cls_004">Alfresco has three editions of its ECM products: </span><span class="cls_007">Alfresco One</span><span class="cls_004">, </span><span class="cls_007">Alfresco in the Cloud</span><span class="cls_004">, and</span></div>
<div style="position:absolute;left:56.69px;top:515.11px" class="cls_007"><span class="cls_007">Alfresco Community Edition</span><span class="cls_004">. We won't describe the other BPM products offered by</span></div>
<div style="position:absolute;left:56.69px;top:527.75px" class="cls_004"><span class="cls_004">Alfresco, because they are not in the scope of this book.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 31 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:31096px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background047.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Alfresco One is the package installable on premise supported by Alfresco. It provides</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">hybrid capabilities with selective content-sync to the included SaaS Alfresco in the Cloud.</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">Alfresco One provides as well different modules including content encryption, records</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">management, analytics, and media management.</span></div>
<div style="position:absolute;left:56.69px;top:129.90px" class="cls_004"><span class="cls_004">Alfresco in the cloud offers almost all out-of-the-box features provided by Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:142.50px" class="cls_004"><span class="cls_004">without on-premises installation. It provides full mobile access and workflow for document</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">review and approval. This product is well suited for smaller teams with multiple offices or</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">branches that don't want to manage servers and don't require the full customization, extra</span></div>
<div style="position:absolute;left:56.69px;top:180.30px" class="cls_004"><span class="cls_004">modules or integrations offered by Alfresco One. This product can be used as well in a</span></div>
<div style="position:absolute;left:56.69px;top:192.90px" class="cls_004"><span class="cls_004">hybrid mode. Only documents that need to be shared with the outside world can be</span></div>
<div style="position:absolute;left:56.69px;top:205.50px" class="cls_004"><span class="cls_004">published into Alfresco Cloud. Content can be configured to synchronize between Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:218.10px" class="cls_004"><span class="cls_004">Cloud and on premise Alfresco installations.</span></div>
<div style="position:absolute;left:56.69px;top:239.70px" class="cls_004"><span class="cls_004">Alfresco community is intended for developers and technical enthusiasts who want the</span></div>
<div style="position:absolute;left:56.69px;top:252.30px" class="cls_004"><span class="cls_004">power of Alfresco in non-critical environments. However, some big organizations use</span></div>
<div style="position:absolute;left:56.69px;top:264.90px" class="cls_004"><span class="cls_004">Alfresco community in production. Be aware that Alfresco won't provide any support for</span></div>
<div style="position:absolute;left:56.69px;top:277.50px" class="cls_004"><span class="cls_004">this product. In terms of features, Alfresco community is usually the first product to receive</span></div>
<div style="position:absolute;left:56.69px;top:290.10px" class="cls_004"><span class="cls_004">the new features to allow the community to test. However, some features are provided only</span></div>
<div style="position:absolute;left:56.69px;top:302.70px" class="cls_004"><span class="cls_004">by Alfresco One including the administration console, the content encryption or the Activiti</span></div>
<div style="position:absolute;left:56.69px;top:315.30px" class="cls_004"><span class="cls_004">console.</span></div>
<div style="position:absolute;left:56.69px;top:352.00px" class="cls_014"><span class="cls_014">Significant feature differences</span></div>
<div style="position:absolute;left:56.69px;top:377.22px" class="cls_004"><span class="cls_004">At the time of this writing, the latest supported release from Alfresco is Alfresco One 5.1.</span></div>
<div style="position:absolute;left:56.69px;top:389.82px" class="cls_004"><span class="cls_004">The latest community release is </span><span class="cls_007">Alfresco Community 201605</span><span class="cls_004"> (for May 2016).</span></div>
<div style="position:absolute;left:56.69px;top:426.56px" class="cls_014"><span class="cls_014">What's used in this book</span></div>
<div style="position:absolute;left:56.69px;top:451.78px" class="cls_004"><span class="cls_004">The vast majority of examples used in this book will work on both the Enterprise and</span></div>
<div style="position:absolute;left:56.69px;top:464.38px" class="cls_004"><span class="cls_004">Community editions (5.1 and 201605, respectively). Where a specific release is required, it</span></div>
<div style="position:absolute;left:56.69px;top:476.98px" class="cls_004"><span class="cls_004">will be noted wherever possible.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 32 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:31772px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background048.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">The Alfresco Platform</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">Hopefully, this chapter has given you several ideas about how Alfresco can be used to</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">implement DM, WCM, and custom content-centric applications by walking through</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">examples of each. The details may still be fuzzy, but the goal was to introduce the major</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">components and capabilities of the Alfresco platform.</span></div>
<div style="position:absolute;left:56.69px;top:156.78px" class="cls_004"><span class="cls_004">In this chapter, we discovered in which kind of use case Alfresco is a good fit. The potential</span></div>
<div style="position:absolute;left:56.69px;top:169.38px" class="cls_004"><span class="cls_004">and flexibility of Alfresco can be used to solve a variety of different content-related business</span></div>
<div style="position:absolute;left:56.69px;top:181.98px" class="cls_004"><span class="cls_004">problems. Then, we introduced the different configuration points that you can use in your</span></div>
<div style="position:absolute;left:56.69px;top:194.58px" class="cls_004"><span class="cls_004">organization without writing one line of code. Even if Alfresco provides you a lot of</span></div>
<div style="position:absolute;left:56.69px;top:207.18px" class="cls_004"><span class="cls_004">capabilities, we'll discover in the rest of the book how it can be customized and extended</span></div>
<div style="position:absolute;left:56.69px;top:219.78px" class="cls_004"><span class="cls_004">based on the fictitious consulting firm that we created called SomeCo. Next we covered the</span></div>
<div style="position:absolute;left:56.69px;top:232.38px" class="cls_004"><span class="cls_004">major open source components included in Alfresco, and the different protocols and</span></div>
<div style="position:absolute;left:56.69px;top:244.98px" class="cls_004"><span class="cls_004">standards that can be used to integrate Alfresco in your ecosystem.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 33 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:32448px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background049.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">2</span></div>
<div style="position:absolute;left:104.56px;top:167.48px" class="cls_011"><span class="cls_011">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">Before you can customize Alfresco, you need to get your development environment in</span></div>
<div style="position:absolute;left:56.69px;top:239.07px" class="cls_004"><span class="cls_004">order. In this chapter, you'll learn how to install the </span><span class="cls_007">software development kit</span><span class="cls_004"> (</span><span class="cls_007">SDK</span><span class="cls_004">), how</span></div>
<div style="position:absolute;left:56.69px;top:251.70px" class="cls_004"><span class="cls_004">to build and deploy customizations, helpful debugging tips, and the cleanest and quickest</span></div>
<div style="position:absolute;left:56.69px;top:264.31px" class="cls_004"><span class="cls_004">way to </span><span class="cls_012">reset</span><span class="cls_004"> your Alfresco sandbox. The chapter includes an example that shows how to</span></div>
<div style="position:absolute;left:56.69px;top:276.91px" class="cls_004"><span class="cls_004">package and deploy some extremely basic customizations just to get your feet wet.</span></div>
<div style="position:absolute;left:56.69px;top:289.51px" class="cls_004"><span class="cls_004">Specifically, you are going to learn:</span></div>
<div style="position:absolute;left:104.69px;top:311.24px" class="cls_004"><span class="cls_004">How to install Alfresco on your environment</span></div>
<div style="position:absolute;left:104.69px;top:326.00px" class="cls_004"><span class="cls_004">How to install and configure the software on which the SDK depends</span></div>
<div style="position:absolute;left:104.69px;top:340.76px" class="cls_004"><span class="cls_004">How to extend Alfresco without modifying the Alfresco source code or</span></div>
<div style="position:absolute;left:104.69px;top:353.36px" class="cls_004"><span class="cls_004">configuration</span></div>
<div style="position:absolute;left:104.69px;top:368.12px" class="cls_004"><span class="cls_004">How to package and deploy your customizations</span></div>
<div style="position:absolute;left:104.69px;top:382.88px" class="cls_004"><span class="cls_004">How to use the Eclipse debugger and log4j to troubleshoot problems</span></div>
<div style="position:absolute;left:104.69px;top:397.64px" class="cls_004"><span class="cls_004">How to start clean for testing or debugging purposes</span></div>
<div style="position:absolute;left:56.69px;top:421.53px" class="cls_004"><span class="cls_004">This book will help you how to install Alfresco on your local by creating a virtual machine</span></div>
<div style="position:absolute;left:56.69px;top:434.13px" class="cls_004"><span class="cls_004">to host Alfresco. There are a lot of options to achieve this goal. In this chapter, we'll use</span></div>
<div style="position:absolute;left:56.69px;top:446.73px" class="cls_004"><span class="cls_004">Vagrant and VirtualBox.</span></div>
<div style="position:absolute;left:56.69px;top:468.33px" class="cls_004"><span class="cls_004">It may seem odd to talk about deployment before you've learned how to create something</span></div>
<div style="position:absolute;left:56.69px;top:480.93px" class="cls_004"><span class="cls_004">worth deploying, but these techniques will be used in all subsequent chapters. So you might</span></div>
<div style="position:absolute;left:56.69px;top:493.53px" class="cls_004"><span class="cls_004">as well get everything set up and tested now so that you don't have to deal with it later.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:33124px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background050.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Introduction to the Alfresco SDK</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">Alfresco is providing its SDK as a Maven based development kit. It provides a quick and</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">easy approach to develop your own Alfresco extensions. You can use this SDK in any</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_007"><span class="cls_007">integrated development environment</span><span class="cls_004"> (</span><span class="cls_007">IDE</span><span class="cls_004">), and even in the console. However, we'll use</span></div>
<div style="position:absolute;left:56.69px;top:135.22px" class="cls_007"><span class="cls_007">Spring Tool Suite</span><span class="cls_004"> (</span><span class="cls_007">STS</span><span class="cls_004">) in this chapter. With this SDK you can develop, package, test, run,</span></div>
<div style="position:absolute;left:56.69px;top:147.86px" class="cls_004"><span class="cls_004">document and release your Alfresco extension project. It is important to note that while</span></div>
<div style="position:absolute;left:56.69px;top:160.46px" class="cls_004"><span class="cls_004">previous versions of the Alfresco SDK were based around Ant, the latest versions of the</span></div>
<div style="position:absolute;left:56.69px;top:173.06px" class="cls_004"><span class="cls_004">SDK are based on Maven.</span></div>
<div style="position:absolute;left:56.69px;top:194.66px" class="cls_004"><span class="cls_004">The Alfresco SDK includes three different Maven archetypes described below. These</span></div>
<div style="position:absolute;left:56.69px;top:207.26px" class="cls_004"><span class="cls_004">archetypes aim to provide a standardized approach to development, release, and</span></div>
<div style="position:absolute;left:56.69px;top:219.86px" class="cls_004"><span class="cls_004">deployment of Alfresco extensions.</span></div>
<div style="position:absolute;left:56.69px;top:256.55px" class="cls_014"><span class="cls_014">Maven archetypes</span></div>
<div style="position:absolute;left:56.69px;top:281.78px" class="cls_004"><span class="cls_004">There are three Maven archetypes that can be used to generate Alfresco extension projects.</span></div>
<div style="position:absolute;left:56.69px;top:294.38px" class="cls_004"><span class="cls_004">The following project types, and archetypes, are available:</span></div>
<div style="position:absolute;left:104.69px;top:316.11px" class="cls_007"><span class="cls_007">Alfresco Repository AMP</span><span class="cls_004">: This archetype is used to create extensions for the</span></div>
<div style="position:absolute;left:104.69px;top:328.74px" class="cls_007"><span class="cls_007">Alfresco repository web application</span><span class="cls_004"> (</span><span class="cls_013">alfresco.war</span><span class="cls_004">) in the form of </span><span class="cls_007">Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:342.02px" class="cls_007"><span class="cls_007">Module Packages</span><span class="cls_004"> (</span><span class="cls_007">AMP</span><span class="cls_004">).</span></div>
<div style="position:absolute;left:104.69px;top:356.82px" class="cls_007"><span class="cls_007">Alfresco Share AMP</span><span class="cls_004">: This archetype is used to create extensions for the </span><span class="cls_007">Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:369.46px" class="cls_007"><span class="cls_007">Share web application</span><span class="cls_004"> (</span><span class="cls_013">share.war</span><span class="cls_004">) in the form of AMPs.</span></div>
<div style="position:absolute;left:104.69px;top:384.90px" class="cls_007"><span class="cls_007">Alfresco all-in-one</span><span class="cls_004"> (</span><span class="cls_007">AIO</span><span class="cls_004">): This archetype is used to generate a project including</span></div>
<div style="position:absolute;left:104.69px;top:397.53px" class="cls_004"><span class="cls_004">an Alfresco and a Share module.It allows as well to run the full Alfresco platform</span></div>
<div style="position:absolute;left:104.69px;top:410.13px" class="cls_004"><span class="cls_004">embedded with all minimal components without installing anything like Solr.</span></div>
<div style="position:absolute;left:104.69px;top:422.73px" class="cls_004"><span class="cls_004">However, it doesn't include ImageMagick, LibreOffice.</span></div>
<div style="position:absolute;left:56.69px;top:446.62px" class="cls_004"><span class="cls_004">Let's clarify what's an AMP file or package. An AMP file is a </span><span class="cls_013">.zip</span><span class="cls_004"> file with the </span><span class="cls_013">.amp</span></div>
<div style="position:absolute;left:56.69px;top:459.90px" class="cls_004"><span class="cls_004">extension. The default structure of AMP files is specified by Alfresco. They contain files that</span></div>
<div style="position:absolute;left:56.69px;top:472.50px" class="cls_004"><span class="cls_004">are overlaid on either the </span><span class="cls_013">alfresco.war</span><span class="cls_004"> or </span><span class="cls_013">share.war</span><span class="cls_004"> using the </span><span class="cls_007">module management</span></div>
<div style="position:absolute;left:56.69px;top:485.78px" class="cls_007"><span class="cls_007">tool</span><span class="cls_004"> (</span><span class="cls_007">MMT</span><span class="cls_004">). By default, the structure of an AMP file is not exactly the same as the structure</span></div>
<div style="position:absolute;left:56.69px;top:498.42px" class="cls_004"><span class="cls_004">of the WAR file, a file called </span><span class="cls_013">file-mapping.properties</span><span class="cls_004"> can be placed in the root of the</span></div>
<div style="position:absolute;left:56.69px;top:511.70px" class="cls_004"><span class="cls_004">AMP to instruct MMT how to map files into the target WAR file. Additionally, a file called</span></div>
<div style="position:absolute;left:56.69px;top:524.30px" class="cls_013"><span class="cls_013">module.properties</span><span class="cls_004"> is placed in the root of the AMP file, this file includes the module</span></div>
<div style="position:absolute;left:56.69px;top:537.58px" class="cls_004"><span class="cls_004">name, version and dependency information. Alfresco is moving towards standard JAR</span></div>
<div style="position:absolute;left:56.69px;top:550.18px" class="cls_004"><span class="cls_004">packaging. This will be the default packaging format with the Alfresco SDK 3.0. AMP files</span></div>
<div style="position:absolute;left:56.69px;top:562.78px" class="cls_004"><span class="cls_004">can be used to package custom templates, custom models, web scripts, UI customizations,</span></div>
<div style="position:absolute;left:56.69px;top:575.38px" class="cls_004"><span class="cls_004">and can be used to implement extensive additions to the Alfresco functionality.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 35 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:33800px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background051.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Alfresco, itself, uses the AMP to package and provides extensions to their customers. The</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">typical example is records management. Alfresco provides two different AMP files, one for</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">the repository engine (that will be deployed in the </span><span class="cls_013">alfresco.war</span><span class="cls_004"> web application), the</span></div>
<div style="position:absolute;left:56.69px;top:108.98px" class="cls_004"><span class="cls_004">other one for web client (that will be deployed in the </span><span class="cls_013">share.war</span><span class="cls_004"> web application). We'll see</span></div>
<div style="position:absolute;left:56.69px;top:122.26px" class="cls_004"><span class="cls_004">later how to package and deploy your custom module.</span></div>
<div style="position:absolute;left:56.69px;top:143.86px" class="cls_004"><span class="cls_004">Before starting, be aware that there is a dependency between the version of your Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:156.46px" class="cls_004"><span class="cls_004">instance and the SDK instance:</span></div>
<div style="position:absolute;left:104.69px;top:178.19px" class="cls_004"><span class="cls_004">You should use Alfresco SDK 2.2.x if you use Alfresco 5.1+ (which will be our</span></div>
<div style="position:absolute;left:104.69px;top:190.79px" class="cls_004"><span class="cls_004">case in this book)</span></div>
<div style="position:absolute;left:104.69px;top:205.55px" class="cls_004"><span class="cls_004">You should use Alfresco SDK 2.1.x if you use Alfresco 5.0+ but not 5.1+</span></div>
<div style="position:absolute;left:56.69px;top:229.44px" class="cls_004"><span class="cls_004">For earlier version of Alfresco, we recommend to check the compatibility matrix in the</span></div>
<div style="position:absolute;left:56.69px;top:242.04px" class="cls_004"><span class="cls_004">Alfresco documentation</span></div>
<div style="position:absolute;left:56.69px;top:278.74px" class="cls_014"><span class="cls_014">Install prerequisites</span></div>
<div style="position:absolute;left:56.69px;top:303.96px" class="cls_004"><span class="cls_004">In the following sections, we'll discover how to install all prerequisites required to develop</span></div>
<div style="position:absolute;left:56.69px;top:316.56px" class="cls_004"><span class="cls_004">and package your customizations.</span></div>
<div style="position:absolute;left:56.69px;top:351.21px" class="cls_023"><span class="cls_023">Spring Loaded</span></div>
<div style="position:absolute;left:56.69px;top:373.92px" class="cls_007"><span class="cls_007">Spring Loaded</span><span class="cls_004"> is a JVM agent for reloading class file changes whilst a JVM is running. The</span></div>
<div style="position:absolute;left:56.69px;top:386.56px" class="cls_004"><span class="cls_004">Alfresco SDK's </span><span class="cls_007">rapid application development</span><span class="cls_004"> (</span><span class="cls_007">RAD</span><span class="cls_004">) features uses Spring Loaded to see</span></div>
<div style="position:absolute;left:56.69px;top:399.20px" class="cls_004"><span class="cls_004">the effect of the change directly in a running Alfresco-Tomcat-JVM instance without having</span></div>
<div style="position:absolute;left:56.69px;top:411.80px" class="cls_004"><span class="cls_004">to rebuild JARs, AMPs, and WARs and redeploying them, saving you loads of time.</span></div>
<div style="position:absolute;left:56.69px;top:424.40px" class="cls_004"><span class="cls_004">However, at the time of writing, the Alfresco documentation states that Spring Loaded</span></div>
<div style="position:absolute;left:56.69px;top:437.00px" class="cls_004"><span class="cls_004">works only with the Share AMP archetype (</span><a href="http://docs.alfresco.com/5.1/tasks/alfresco-sdk-install-spring-loaded.html">http://docs.alfresco.com/5.1/tasks/alfre</a> </div>
<div style="position:absolute;left:56.69px;top:449.98px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/alfresco-sdk-install-spring-loaded.html">sco-sdk-install-spring-loaded.html</a> <span class="cls_004">).Be aware that the 3.0 Maven SDK is moving from</span></div>
<div style="position:absolute;left:56.69px;top:462.95px" class="cls_004"><span class="cls_004">Spring Loaded to JRebel.</span></div>
<div style="position:absolute;left:56.69px;top:484.55px" class="cls_004"><span class="cls_004">You just need to download the JAR file and save it somewhere on your environment from</span></div>
<div style="position:absolute;left:56.69px;top:497.15px" class="cls_004"><span class="cls_004">this URL:</span></div>
<div style="position:absolute;left:56.69px;top:518.08px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/spring-projects/spring-loaded">https://github.com/spring-projects/spring-loaded</a> </div>
<div style="position:absolute;left:56.69px;top:538.55px" class="cls_004"><span class="cls_004">At the time of writing, the latest version is 1.2.5. Save the file</span></div>
<div style="position:absolute;left:56.69px;top:551.16px" class="cls_013"><span class="cls_013">springloaded-1.2.5.RELEASE.jar</span><span class="cls_004"> in your home directory.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 36 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:34476px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background052.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">JDK</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">As explained, the Alfresco SDK is based on Maven which requires a JDK. This section</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">explains you how to check that Oracle JDK 1.8 is installed, or install it if it's not the case.</span></div>
<div style="position:absolute;left:56.69px;top:126.78px" class="cls_004"><span class="cls_004">To check if you have the right JDK installed on your environment, open a command console</span></div>
<div style="position:absolute;left:56.69px;top:139.38px" class="cls_004"><span class="cls_004">and type the following command:</span></div>
<div style="position:absolute;left:74.69px;top:160.30px" class="cls_010"><span class="cls_010">javac -version</span></div>
<div style="position:absolute;left:56.69px;top:180.78px" class="cls_004"><span class="cls_004">You'll see a message like this one if it's properly installed:</span></div>
<div style="position:absolute;left:74.69px;top:201.70px" class="cls_010"><span class="cls_010">javac 1.8.0_45</span></div>
<div style="position:absolute;left:56.69px;top:222.18px" class="cls_004"><span class="cls_004">If you get a message like </span><span class="cls_013">Command not found</span><span class="cls_004">, you need to follow the steps given here.</span></div>
<div style="position:absolute;left:56.69px;top:235.46px" class="cls_004"><span class="cls_004">Otherwise, you are good to jump to the following section:</span></div>
<div style="position:absolute;left:91.32px;top:257.19px" class="cls_004"><span class="cls_004">1. If you need to install or to upgrade your JDK, the first step is to download it from</span></div>
<div style="position:absolute;left:104.69px;top:269.79px" class="cls_004"><span class="cls_004">the Oracle JDK website</span></div>
<div style="position:absolute;left:104.69px;top:282.39px" class="cls_004"><span class="cls_004">(</span><a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a> <span class="cls_004">)an</span></div>
<div style="position:absolute;left:104.69px;top:295.37px" class="cls_004"><span class="cls_004">d then follow the Oracle instructions. When it's completed, recheck the version of</span></div>
<div style="position:absolute;left:104.69px;top:307.97px" class="cls_004"><span class="cls_004">the Java compiler as explained. If you get the right version, you can check also</span></div>
<div style="position:absolute;left:104.69px;top:320.57px" class="cls_004"><span class="cls_004">your Java runtime version by typing:</span></div>
<div style="position:absolute;left:117.89px;top:343.78px" class="cls_010"><span class="cls_010">java -version</span></div>
<div style="position:absolute;left:91.32px;top:364.39px" class="cls_004"><span class="cls_004">2. You should see a message like:</span></div>
<div style="position:absolute;left:117.89px;top:387.60px" class="cls_010"><span class="cls_010">java version "1.8.0_45"</span></div>
<div style="position:absolute;left:117.89px;top:398.40px" class="cls_010"><span class="cls_010">Java(TM) SE Runtime Environment (build 1.8.0_45-b14)</span></div>
<div style="position:absolute;left:117.89px;top:409.20px" class="cls_010"><span class="cls_010">Java HotSpot(TM) 64-Bit Server VM (build 25.45-b02, mixed mode)</span></div>
<div style="position:absolute;left:91.32px;top:429.81px" class="cls_004"><span class="cls_004">3. When the JDK is installed, you need to be sure that the environment variable</span></div>
<div style="position:absolute;left:104.69px;top:442.41px" class="cls_013"><span class="cls_013">JAVA_HOME</span><span class="cls_004"> is properly set. Use a method suitable for your system. On Mac OS X</span></div>
<div style="position:absolute;left:104.69px;top:455.69px" class="cls_004"><span class="cls_004">and Linux system, just type the following command:</span></div>
<div style="position:absolute;left:117.89px;top:478.90px" class="cls_010"><span class="cls_010">env | grep JAVA_HOME</span></div>
<div style="position:absolute;left:91.32px;top:499.51px" class="cls_004"><span class="cls_004">4. You should see a message like this one on Mac OS X systems:</span></div>
<div style="position:absolute;left:117.89px;top:522.72px" class="cls_010"><span class="cls_010">JAVA_HOME=/Library/Java/JavaVirtualMachines</span></div>
<div style="position:absolute;left:139.49px;top:533.52px" class="cls_010"><span class="cls_010">/jdk1.8.0_45.jdk/Contents/Home</span></div>
<div style="position:absolute;left:91.32px;top:554.13px" class="cls_004"><span class="cls_004">5. If it's not the case, check the documentation of your system to set this</span></div>
<div style="position:absolute;left:104.69px;top:566.73px" class="cls_004"><span class="cls_004">environment variable.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 37 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:35152px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background053.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Maven</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">Of course, we need to install Maven to be able to use the Alfresco SDK. Maybe you already</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">installed it on your system.</span></div>
<div style="position:absolute;left:91.32px;top:126.91px" class="cls_004"><span class="cls_004">1. To check, just type the following command:</span></div>
<div style="position:absolute;left:117.89px;top:150.12px" class="cls_010"><span class="cls_010">mvn --version</span></div>
<div style="position:absolute;left:91.32px;top:170.73px" class="cls_004"><span class="cls_004">2. If you get an error or a </span><span class="cls_013">Command not found</span><span class="cls_004"> message, you need to install Maven</span></div>
<div style="position:absolute;left:104.69px;top:184.01px" class="cls_004"><span class="cls_004">on your system. Be aware that you'll need to update your Maven installation if</span></div>
<div style="position:absolute;left:104.69px;top:196.61px" class="cls_004"><span class="cls_004">your version is less than 3.2.5. To install Maven, download it from the </span><span class="cls_007">Apache</span></div>
<div style="position:absolute;left:104.69px;top:209.25px" class="cls_007"><span class="cls_007">Maven project website</span><span class="cls_004"> (</span><a href="http://maven.apache.org/download.cgi">http://maven.apache.org/download.cgi</a> <span class="cls_004">) and follow</span></div>
<div style="position:absolute;left:104.69px;top:222.23px" class="cls_004"><span class="cls_004">the platform-specific installation instructions provided by Maven. When</span></div>
<div style="position:absolute;left:104.69px;top:234.83px" class="cls_004"><span class="cls_004">everything will be installed properly, the preceding command will return a</span></div>
<div style="position:absolute;left:104.69px;top:247.43px" class="cls_004"><span class="cls_004">message as follows:</span></div>
<div style="position:absolute;left:117.89px;top:270.64px" class="cls_010"><span class="cls_010">Apache Maven 3.3.3 (7994120775791599e205a5524ec3e0dfe41d4a06;</span></div>
<div style="position:absolute;left:161.09px;top:281.44px" class="cls_010"><span class="cls_010">2015-04-22T12:57:37+01:00)</span></div>
<div style="position:absolute;left:117.89px;top:292.24px" class="cls_010"><span class="cls_010">Maven home: /opt/local/share/java/maven3</span></div>
<div style="position:absolute;left:117.89px;top:303.04px" class="cls_010"><span class="cls_010">Java version: 1.8.0_45, vendor: Oracle Corporation</span></div>
<div style="position:absolute;left:117.89px;top:313.84px" class="cls_010"><span class="cls_010">Java home: /Library/Java/JavaVirtualMachines/</span></div>
<div style="position:absolute;left:161.09px;top:324.64px" class="cls_010"><span class="cls_010">jdk1.8.0_45.jdk/Contents/Home/jre</span></div>
<div style="position:absolute;left:123.29px;top:335.44px" class="cls_010"><span class="cls_010">Default locale: en_US, platform encoding: UTF-8</span></div>
<div style="position:absolute;left:117.89px;top:346.24px" class="cls_010"><span class="cls_010">OS name: "mac os x", version: "10.11.5", arch: "x86_64",</span></div>
<div style="position:absolute;left:139.49px;top:357.04px" class="cls_010"><span class="cls_010">family: "mac"</span></div>
<div style="position:absolute;left:124.19px;top:377.52px" class="cls_004"><span class="cls_004">As you can see, I have the version 3.3.3 installed on my system, and it's</span></div>
<div style="position:absolute;left:124.19px;top:390.12px" class="cls_004"><span class="cls_004">connected to the JDK 8 installed previously.</span></div>
<div style="position:absolute;left:91.32px;top:411.85px" class="cls_004"><span class="cls_004">3. The next step is to be sure that environment variables are properly configured,</span></div>
<div style="position:absolute;left:104.69px;top:424.45px" class="cls_004"><span class="cls_004">following the same procedure as </span><span class="cls_013">JAVA_HOME</span><span class="cls_004">. Use the following command on</span></div>
<div style="position:absolute;left:104.69px;top:437.73px" class="cls_004"><span class="cls_004">Mac OS X and Linux system:</span></div>
<div style="position:absolute;left:117.89px;top:460.94px" class="cls_010"><span class="cls_010">env | grepM2_HOME</span></div>
<div style="position:absolute;left:117.89px;top:471.74px" class="cls_010"><span class="cls_010">env | grepMAVEN_OPTS</span></div>
<div style="position:absolute;left:124.19px;top:503.02px" class="cls_004"><span class="cls_004">And you should see these messages:</span></div>
<div style="position:absolute;left:117.89px;top:523.94px" class="cls_010"><span class="cls_010">M2_HOME=/opt/local/share/java/maven3</span></div>
<div style="position:absolute;left:117.89px;top:534.74px" class="cls_010"><span class="cls_010">MAVEN_OPTS=-Xms2048M -Xmx2048M</span></div>
<div style="position:absolute;left:161.09px;top:545.54px" class="cls_010"><span class="cls_010">-javaagent:/Users/john/springloaded-1.2.5.RELEASE.jar</span></div>
<div style="position:absolute;left:166.49px;top:556.34px" class="cls_010"><span class="cls_010">-noverify</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 38 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:35828px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background054.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. If it's not the case, check the documentation of your system to set this</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">environment variable.</span></div>
<div style="position:absolute;left:124.19px;top:106.99px" class="cls_004"><span class="cls_004">Be aware that the Alfresco SDK will use Alfresco Community Edition</span></div>
<div style="position:absolute;left:124.19px;top:119.59px" class="cls_004"><span class="cls_004">artifacts by default. If you want to use Alfresco One (Enterprise) artifacts,</span></div>
<div style="position:absolute;left:124.19px;top:132.19px" class="cls_004"><span class="cls_004">you'll need to require access to the Alfresco Private Repository. When you</span></div>
<div style="position:absolute;left:124.19px;top:144.79px" class="cls_004"><span class="cls_004">have received a username and a password from Alfresco, you must add your</span></div>
<div style="position:absolute;left:124.19px;top:157.39px" class="cls_004"><span class="cls_004">credentials to the Maven configuration. This is usually done by adding an</span></div>
<div style="position:absolute;left:124.19px;top:169.99px" class="cls_004"><span class="cls_004">entry to the </span><span class="cls_013">settings.xml</span><span class="cls_004"> file, located in your </span><span class="cls_013">.m2</span><span class="cls_004"> directory. Check the</span></div>
<div style="position:absolute;left:124.19px;top:183.27px" class="cls_004"><span class="cls_004">Maven documentation to identify where should be located this folder in your</span></div>
<div style="position:absolute;left:124.19px;top:195.87px" class="cls_004"><span class="cls_004">system. For Linux and Mac OS X that will most likely be </span><span class="cls_013">~/.m2</span><span class="cls_004">. When you</span></div>
<div style="position:absolute;left:124.19px;top:209.15px" class="cls_004"><span class="cls_004">have located this file, just add the following section:</span></div>
<div style="position:absolute;left:117.89px;top:230.07px" class="cls_010"><span class="cls_010">&lt;server&gt;</span></div>
<div style="position:absolute;left:161.09px;top:240.87px" class="cls_010"><span class="cls_010">&lt;id&gt;alfresco-private-repository&lt;/id&gt;</span></div>
<div style="position:absolute;left:161.09px;top:251.67px" class="cls_010"><span class="cls_010">&lt;username&gt;username&lt;/username&gt;</span></div>
<div style="position:absolute;left:161.09px;top:262.47px" class="cls_010"><span class="cls_010">&lt;password&gt;password&lt;/password&gt;</span></div>
<div style="position:absolute;left:117.89px;top:273.27px" class="cls_010"><span class="cls_010">&lt;/server&gt;</span></div>
<div style="position:absolute;left:56.69px;top:308.85px" class="cls_014"><span class="cls_014">Install STS</span></div>
<div style="position:absolute;left:56.69px;top:334.07px" class="cls_004"><span class="cls_004">Obviously, you can use any software development tool to create an Alfresco module. You</span></div>
<div style="position:absolute;left:56.69px;top:346.67px" class="cls_004"><span class="cls_004">can even use the Windows Notepad, but I wish you good luck. In this book, we'll use</span></div>
<div style="position:absolute;left:56.69px;top:359.27px" class="cls_007"><span class="cls_007">Spring Tool Suite</span><span class="cls_004"> (</span><span class="cls_007">STS</span><span class="cls_004">) based on Eclipse. Because Alfresco is based on the Spring</span></div>
<div style="position:absolute;left:56.69px;top:371.91px" class="cls_004"><span class="cls_004">framework, STS seems to be the best tool to develop.</span></div>
<div style="position:absolute;left:56.69px;top:393.51px" class="cls_004"><span class="cls_004">To install STS, open the download page (</span><a href="https://spring.io/tools/sts/all">https://spring.io/tools/sts/all</a> <span class="cls_004">) and</span></div>
<div style="position:absolute;left:56.69px;top:406.49px" class="cls_004"><span class="cls_004">download the version depending of your system. If you are working on Windows, you'll</span></div>
<div style="position:absolute;left:56.69px;top:419.09px" class="cls_004"><span class="cls_004">download a ZIP file. Otherwise, you'll download a TAR.GZ file.</span></div>
<div style="position:absolute;left:56.69px;top:440.69px" class="cls_004"><span class="cls_004">When you have downloaded the file, you just need to unzip it. The first time that STS is</span></div>
<div style="position:absolute;left:56.69px;top:453.29px" class="cls_004"><span class="cls_004">loaded, you'll need to select a workspace:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 39 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:36504px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background055.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:210.71px" class="cls_004"><span class="cls_004">Then, we'll configure the Maven Central repository in STS. Open the STS </span><span class="cls_007">Preferences</span></div>
<div style="position:absolute;left:56.69px;top:223.35px" class="cls_004"><span class="cls_004">window, and open </span><span class="cls_007">Maven</span><span class="cls_004"> | </span><span class="cls_007">Archetypes</span><span class="cls_004">. Then, click on the button </span><span class="cls_007">Add Remote Catalog</span><span class="cls_028">…</span><span class="cls_004">.:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 40 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:37180px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background056.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Provide the </span><span class="cls_007">Maven Central repository</span><span class="cls_004"> (</span><a href="http://repo.maven.apache.org/maven2/">http://repo.maven.apache.org/maven2/</a> <span class="cls_004">) and</span></div>
<div style="position:absolute;left:56.69px;top:83.48px" class="cls_004"><span class="cls_004">add a description. By clicking on the </span><span class="cls_007">Verify</span><span class="cls_028">…</span><span class="cls_004"> button, you can see that this catalog contains</span></div>
<div style="position:absolute;left:56.69px;top:96.91px" class="cls_007"><span class="cls_007">19779</span><span class="cls_004"> archetypes. Validate by clicking on </span><span class="cls_007">Add</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:265.72px" class="cls_004"><span class="cls_004">And that's it. You are now ready to create your first Alfresco application.</span></div>
<div style="position:absolute;left:56.69px;top:304.47px" class="cls_008"><span class="cls_008">Create your first application</span></div>
<div style="position:absolute;left:56.69px;top:332.20px" class="cls_004"><span class="cls_004">We'll first discover how we can use the Maven SDK and RAD to quickly create your own</span></div>
<div style="position:absolute;left:56.69px;top:344.80px" class="cls_004"><span class="cls_004">application. Even if we'll explore this option, we won't use it in the rest of the book. We'll</span></div>
<div style="position:absolute;left:56.69px;top:357.40px" class="cls_004"><span class="cls_004">use a more traditional approach that you'll be able to re-use in your own Alfresco projects.</span></div>
<div style="position:absolute;left:56.69px;top:394.10px" class="cls_014"><span class="cls_014">Rapid application development</span></div>
<div style="position:absolute;left:56.69px;top:419.32px" class="cls_004"><span class="cls_004">In this section, we'll take a small detour to talk about rapid application development. As</span></div>
<div style="position:absolute;left:56.69px;top:431.92px" class="cls_004"><span class="cls_004">explained before, Alfresco SDK provides three different archetypes. One of them is called</span></div>
<div style="position:absolute;left:56.69px;top:444.52px" class="cls_004"><span class="cls_004">the Alfresco AIO archetype. Using this archetype, you can easily implement all your</span></div>
<div style="position:absolute;left:56.69px;top:457.12px" class="cls_004"><span class="cls_004">customization in a unique STS project and run the full Alfresco platform. It means that you</span></div>
<div style="position:absolute;left:56.69px;top:469.72px" class="cls_004"><span class="cls_004">don't need to install Alfresco on your system and it provides a perfect starting point for full-</span></div>
<div style="position:absolute;left:56.69px;top:482.32px" class="cls_004"><span class="cls_004">blown Alfresco projects where the final artifacts should be the customized </span><span class="cls_013">alfresco.war</span></div>
<div style="position:absolute;left:56.69px;top:495.60px" class="cls_004"><span class="cls_004">and </span><span class="cls_013">share.war</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 41 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:37856px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background057.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">In a typical project, you want to develop a reusable module that should be distributed</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">independently. To achieve this goal, we'll discover in the next sections how to install</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">Alfresco on a CentOS system and create modules for Alfresco and Share.</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">To create your first RAD project, click on </span><span class="cls_007">File</span><span class="cls_004"> | </span><span class="cls_007">New</span><span class="cls_004"> | </span><span class="cls_007">Maven Project</span><span class="cls_004">. On this screen, let's</span></div>
<div style="position:absolute;left:56.69px;top:129.94px" class="cls_004"><span class="cls_004">keep the default configuration and click on </span><span class="cls_007">Next &gt;</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 42 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:38532px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background058.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">In the next window, limit the list archetypes by typing </span><span class="cls_013">org.alfresco</span><span class="cls_004"> in the </span><span class="cls_007">Filter</span><span class="cls_004"> field.</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">Only three archetypes will be visible. In this book, we'll use the archetype </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:97.06px" class="cls_013"><span class="cls_013">allinone-archetype</span><span class="cls_004">. You can specify </span><span class="cls_013">enterprise</span><span class="cls_004"> in the </span><span class="cls_007">Profiles</span><span class="cls_004"> field, if you plan to use</span></div>
<div style="position:absolute;left:56.69px;top:110.34px" class="cls_004"><span class="cls_004">Alfresco Enterprise. If you don't, just leave it empty:</span></div>
<div style="position:absolute;left:56.69px;top:405.11px" class="cls_004"><span class="cls_004">In the next screen, provide all information required to create your artifact and click on the</span></div>
<div style="position:absolute;left:56.69px;top:417.71px" class="cls_004"><span class="cls_004">button </span><span class="cls_007">Finish</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:104.69px;top:439.48px" class="cls_007"><span class="cls_007">Group Id</span><span class="cls_004">: </span><span class="cls_013">com.someco</span></div>
<div style="position:absolute;left:104.69px;top:454.92px" class="cls_007"><span class="cls_007">Artifcat Id</span><span class="cls_004">: </span><span class="cls_013">alfresco</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 43 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:39208px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background059.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:329.21px" class="cls_004"><span class="cls_004">When the creation is completed, you should be able to see seven different projects:</span></div>
<div style="position:absolute;left:104.69px;top:350.94px" class="cls_013"><span class="cls_013">alfresco</span><span class="cls_004">: This project is the parent project containing all six other projects.</span></div>
<div style="position:absolute;left:104.69px;top:366.38px" class="cls_013"><span class="cls_013">alfresco-repo-amp</span><span class="cls_004">: This is a repository AMP project, demonstrating sample</span></div>
<div style="position:absolute;left:104.69px;top:379.66px" class="cls_004"><span class="cls_004">project structure and demo component loading</span></div>
<div style="position:absolute;left:104.69px;top:394.42px" class="cls_013"><span class="cls_013">repo</span><span class="cls_004">: This is an </span><span class="cls_013">alfresco.war</span><span class="cls_004"> aggregator project, overlaying the standard</span></div>
<div style="position:absolute;left:104.69px;top:407.70px" class="cls_004"><span class="cls_004">Alfresco WAR with the </span><span class="cls_013">alfresco-repo-amp</span><span class="cls_004"> and any other AMPs and JARs that</span></div>
<div style="position:absolute;left:104.69px;top:420.98px" class="cls_004"><span class="cls_004">have been included as dependencies and configured in the overlay</span></div>
<div style="position:absolute;left:104.69px;top:435.74px" class="cls_013"><span class="cls_013">alfresco-share-amp</span><span class="cls_004">: This is a Share AMP project, demonstrating sample</span></div>
<div style="position:absolute;left:104.69px;top:449.02px" class="cls_004"><span class="cls_004">project structure and demo Aikau page</span></div>
<div style="position:absolute;left:104.69px;top:463.78px" class="cls_013"><span class="cls_013">share</span><span class="cls_004">: A </span><span class="cls_013">share.war</span><span class="cls_004"> aggregator project, overlaying the standard Share WAR</span></div>
<div style="position:absolute;left:104.69px;top:477.06px" class="cls_004"><span class="cls_004">with the </span><span class="cls_013">alfresco-share-amp</span><span class="cls_004"> and any other AMPs and JARs that have been</span></div>
<div style="position:absolute;left:104.69px;top:490.34px" class="cls_004"><span class="cls_004">included as dependencies and configured in the overlay</span></div>
<div style="position:absolute;left:104.69px;top:505.10px" class="cls_013"><span class="cls_013">solr-config</span><span class="cls_004">: This project brings in the Apache Solr4 configuration files</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 44 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:39884px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background060.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_013"><span class="cls_013">runner</span><span class="cls_004">: A Tomcat plus H2 runner, capable of running the custom</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_013"><span class="cls_013">alfresco.war</span><span class="cls_004">, custom </span><span class="cls_013">share.war</span><span class="cls_004">, and </span><span class="cls_013">solr4.war</span><span class="cls_004"> for demo/integration-</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_004"><span class="cls_004">testing purposes</span></div>
<div style="position:absolute;left:56.69px;top:384.17px" class="cls_004"><span class="cls_004">We are not going to explain how to customize Alfresco. We are just going to run Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:396.77px" class="cls_004"><span class="cls_004">directly from STS (you can do it as well using a command-line tool):</span></div>
<div style="position:absolute;left:91.32px;top:418.49px" class="cls_004"><span class="cls_004">1. Click on </span><span class="cls_007">Run</span><span class="cls_004"> | </span><span class="cls_007">Run Configurations</span><span class="cls_028">…</span></div>
<div style="position:absolute;left:91.32px;top:434.08px" class="cls_004"><span class="cls_004">2. Right click on the left-menu item called </span><span class="cls_007">Maven Build</span><span class="cls_004"> and click on </span><span class="cls_007">New</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:448.88px" class="cls_004"><span class="cls_004">3. Select the base directory as the project </span><span class="cls_013">alfresco</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:464.32px" class="cls_004"><span class="cls_004">4. Specify the name </span><span class="cls_013">Run Alfresco</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:479.76px" class="cls_004"><span class="cls_004">5. Specify the goals </span><span class="cls_013">clean install</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:495.20px" class="cls_004"><span class="cls_004">6. But more importantly, specify the profile </span><span class="cls_013">run</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 45 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:40560px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background061.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Finally, click on the </span><span class="cls_007">Run</span><span class="cls_004"> button and Maven will package, deploy and run a</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">Tomcat instance:</span></div>
<div style="position:absolute;left:122.09px;top:427.32px" class="cls_004"><span class="cls_004">If you get an </span><span class="cls_013">out-of-memory</span><span class="cls_004"> error when Alfresco is starting, you may</span></div>
<div style="position:absolute;left:122.09px;top:440.60px" class="cls_004"><span class="cls_004">need to configure some JVM memory parameters to Maven. One way is to</span></div>
<div style="position:absolute;left:122.09px;top:453.20px" class="cls_004"><span class="cls_004">open the </span><span class="cls_007">Environment </span><span class="cls_004">tab, and create a new variable called </span><span class="cls_013">MAVEN_OPTS</span></div>
<div style="position:absolute;left:122.09px;top:466.48px" class="cls_004"><span class="cls_004">and use the following value:</span></div>
<div style="position:absolute;left:122.09px;top:478.30px" class="cls_013"><span class="cls_013">-Xmx1024M -XX:MaxPermSize=512m</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 46 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:41236px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background062.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">When it's completed (and be patient because the process can be long for the very first time),</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">just open a browser on </span><a href="http://localhost:8080/">http://localhost:8080/</a> <span class="cls_004"> and you'll have access to the following</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">page. On this page, you'll be able to open Alfresco, Share, Solr or the new REST API</span></div>
<div style="position:absolute;left:56.69px;top:108.98px" class="cls_004"><span class="cls_004">explorer:</span></div>
<div style="position:absolute;left:56.69px;top:344.50px" class="cls_004"><span class="cls_004">Alfresco is now running the Community edition. You can open Alfresco Share, log in using</span></div>
<div style="position:absolute;left:56.69px;top:357.10px" class="cls_004"><span class="cls_004">the credentials </span><span class="cls_013">admin</span><span class="cls_004"> / </span><span class="cls_013">admin</span><span class="cls_004"> and play will all out-of-the-box features.If you want to run</span></div>
<div style="position:absolute;left:56.69px;top:370.38px" class="cls_004"><span class="cls_004">the Enterprise edition, use the profile run, enterprise, instead of run. If you have an Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:382.98px" class="cls_004"><span class="cls_004">license, you can add it to the following folder path:</span></div>
<div style="position:absolute;left:56.69px;top:404.58px" class="cls_013"><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">resources</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">extension</span><span class="cls_004"> | </span><span class="cls_013">license</span></div>
<div style="position:absolute;left:56.69px;top:441.96px" class="cls_014"><span class="cls_014">Traditional approach</span></div>
<div style="position:absolute;left:56.69px;top:467.18px" class="cls_004"><span class="cls_004">As explained, you can use the AIO archetype for prototyping or if you need to provide</span></div>
<div style="position:absolute;left:56.69px;top:479.78px" class="cls_004"><span class="cls_004">WAR files for deployment, or start a new project. However, if you need to develop an add-</span></div>
<div style="position:absolute;left:56.69px;top:492.38px" class="cls_004"><span class="cls_004">on or reusable component that you want to distribute independently, the two other</span></div>
<div style="position:absolute;left:56.69px;top:504.98px" class="cls_004"><span class="cls_004">archetypes will need to be used. Let's start by deleting the previous project to avoid any</span></div>
<div style="position:absolute;left:56.69px;top:517.58px" class="cls_004"><span class="cls_004">confusion, or switch to another workspace if you want to keep both options in your system.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 47 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:41912px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background063.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Following exactly the same approach as used before, we are going to generate two projects:</span></div>
<div style="position:absolute;left:104.69px;top:92.23px" class="cls_004"><span class="cls_004">Repository project:</span></div>
<div style="position:absolute;left:170.69px;top:104.83px" class="cls_004"><span class="cls_004">Select the artifact: </span><span class="cls_013">alfresco-amp-archetype</span></div>
<div style="position:absolute;left:170.69px;top:120.27px" class="cls_004"><span class="cls_004">Group Id: </span><span class="cls_013">com.someco</span></div>
<div style="position:absolute;left:170.69px;top:135.71px" class="cls_004"><span class="cls_004">Artifact Id: </span><span class="cls_013">repo</span></div>
<div style="position:absolute;left:104.69px;top:153.31px" class="cls_004"><span class="cls_004">Share project:</span></div>
<div style="position:absolute;left:170.69px;top:165.91px" class="cls_004"><span class="cls_004">Select the artifact: </span><span class="cls_013">share-amp-archetype</span></div>
<div style="position:absolute;left:170.69px;top:181.35px" class="cls_004"><span class="cls_004">Group Id: </span><span class="cls_013">com.someco</span></div>
<div style="position:absolute;left:170.69px;top:196.79px" class="cls_004"><span class="cls_004">Artifact Id: </span><span class="cls_013">share</span></div>
<div style="position:absolute;left:56.69px;top:223.52px" class="cls_004"><span class="cls_004">When it's done, you should have two projects in your workspaces:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 48 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:42588px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background064.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">run</span><span class="cls_004"> profile doesn't exist in these archetypes. Instead, these two archetypes includes a</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">profile called </span><span class="cls_013">amp-to-war</span><span class="cls_004">. The first step that we need to do is to create the two Maven</span></div>
<div style="position:absolute;left:56.69px;top:97.06px" class="cls_004"><span class="cls_004">configurations by following the steps explained before:</span></div>
<div style="position:absolute;left:91.32px;top:118.79px" class="cls_004"><span class="cls_004">1.</span></div>
<div style="position:absolute;left:104.69px;top:118.79px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Run</span><span class="cls_004"> | </span><span class="cls_007">Run Configurations</span><span class="cls_028">…</span></div>
<div style="position:absolute;left:91.32px;top:134.38px" class="cls_004"><span class="cls_004">2.</span></div>
<div style="position:absolute;left:104.69px;top:134.38px" class="cls_004"><span class="cls_004">Right click on the left-menu item called </span><span class="cls_007">Maven Build</span><span class="cls_004"> and click on </span><span class="cls_007">New</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:147.02px" class="cls_004"><span class="cls_004">Name: </span><span class="cls_013">Run Alfresco</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:162.46px" class="cls_004"><span class="cls_004">Base directory: Click on the </span><span class="cls_007">Workspace</span><span class="cls_028">…</span><span class="cls_004"> button and select the </span><span class="cls_007">repo</span></div>
<div style="position:absolute;left:152.69px;top:175.89px" class="cls_004"><span class="cls_004">project.</span></div>
<div style="position:absolute;left:152.69px;top:190.65px" class="cls_004"><span class="cls_004">Goals: </span><span class="cls_013">clean install</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:206.09px" class="cls_004"><span class="cls_004">Profiles:</span><span class="cls_013"> amp-to-war</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:221.53px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Apply.</span></div>
<div style="position:absolute;left:91.32px;top:238.48px" class="cls_004"><span class="cls_004">3.</span></div>
<div style="position:absolute;left:104.69px;top:238.48px" class="cls_004"><span class="cls_004">Right click on the left-menu item called </span><span class="cls_007">MavenBuild</span><span class="cls_004"> and click on </span><span class="cls_007">New</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:251.12px" class="cls_004"><span class="cls_004">Name: </span><span class="cls_013">Run Share</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:266.56px" class="cls_004"><span class="cls_004">Base directory: Click on the </span><span class="cls_007">Workspace</span><span class="cls_028">…</span><span class="cls_004"> button and select the </span><span class="cls_007">share</span></div>
<div style="position:absolute;left:152.69px;top:279.99px" class="cls_004"><span class="cls_004">project.</span></div>
<div style="position:absolute;left:152.69px;top:294.75px" class="cls_004"><span class="cls_004">Goals: </span><span class="cls_013">clean install</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:310.19px" class="cls_004"><span class="cls_004">Profiles: </span><span class="cls_013">amp-to-war</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:152.69px;top:325.63px" class="cls_004"><span class="cls_004">Because we don't want to run Share on the same Tomcat port, we need</span></div>
<div style="position:absolute;left:152.69px;top:338.23px" class="cls_004"><span class="cls_004">to change it. Open the tab </span><span class="cls_007">JRE</span><span class="cls_004">, and provide the following </span><span class="cls_007">VM</span></div>
<div style="position:absolute;left:152.69px;top:350.86px" class="cls_007"><span class="cls_007">argument</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:152.69px;top:366.16px" class="cls_013"><span class="cls_013">-Dmaven.tomcat.port=8181</span></div>
<div style="position:absolute;left:152.69px;top:381.10px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Apply.</span></div>
<div style="position:absolute;left:56.69px;top:407.19px" class="cls_004"><span class="cls_004">If you execute these two configurations, the Alfresco repository will run on the port </span><span class="cls_013">8080</span></div>
<div style="position:absolute;left:56.69px;top:420.47px" class="cls_004"><span class="cls_004">(</span><a href="http://localhost:8080/alfresco/">http://localhost:8080/alfresco/</a> <span class="cls_004">) and Alfresco Share will run on the port </span><span class="cls_013">8181</span></div>
<div style="position:absolute;left:56.69px;top:433.75px" class="cls_004"><span class="cls_004">(</span><a href="http://localhost:8181/share/">http://localhost:8181/share/</a> <span class="cls_004">). You can use the default </span><span class="cls_013">admin</span><span class="cls_004">/</span><span class="cls_013">admin</span><span class="cls_004"> credentials to</span></div>
<div style="position:absolute;left:56.69px;top:447.03px" class="cls_004"><span class="cls_004">authenticate.</span></div>
<div style="position:absolute;left:56.69px;top:468.63px" class="cls_004"><span class="cls_004">By default, it will be the Community edition. Following the same principles as the AIO</span></div>
<div style="position:absolute;left:56.69px;top:481.23px" class="cls_004"><span class="cls_004">artifact, you just need to add the profile enterprise to your list of profiles in the Maven</span></div>
<div style="position:absolute;left:56.69px;top:493.83px" class="cls_004"><span class="cls_004">configurations.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 49 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:43264px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background065.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Now, we want to package our modules. In this case, I prefer to create two new Maven</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">configurations:</span></div>
<div style="position:absolute;left:91.32px;top:104.83px" class="cls_004"><span class="cls_004">1. Click on </span><span class="cls_007">Run</span><span class="cls_004"> | </span><span class="cls_007">Run Configurations</span><span class="cls_028">…</span></div>
<div style="position:absolute;left:91.32px;top:120.42px" class="cls_004"><span class="cls_004">2. Right click on the left-menu item called </span><span class="cls_007">Maven Build</span><span class="cls_004"> and click on </span><span class="cls_007">New</span></div>
<div style="position:absolute;left:152.69px;top:133.06px" class="cls_004"><span class="cls_004">Name: </span><span class="cls_013">Package Alfresco Module</span></div>
<div style="position:absolute;left:152.69px;top:148.50px" class="cls_004"><span class="cls_004">Base directory: Click on the </span><span class="cls_007">Workspace</span><span class="cls_028">…</span><span class="cls_004"> button and select the </span><span class="cls_013">repo</span></div>
<div style="position:absolute;left:152.69px;top:161.93px" class="cls_004"><span class="cls_004">project</span></div>
<div style="position:absolute;left:152.69px;top:176.69px" class="cls_004"><span class="cls_004">Goals: </span><span class="cls_013">clean package</span></div>
<div style="position:absolute;left:152.69px;top:192.13px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Apply</span></div>
<div style="position:absolute;left:91.32px;top:209.09px" class="cls_004"><span class="cls_004">3. Right click on the left-menu item called </span><span class="cls_007">Maven Build</span><span class="cls_004"> and click on </span><span class="cls_007">New</span></div>
<div style="position:absolute;left:152.69px;top:221.72px" class="cls_004"><span class="cls_004">Name: </span><span class="cls_013">PackageShare Module</span></div>
<div style="position:absolute;left:152.69px;top:237.16px" class="cls_004"><span class="cls_004">Base directory: Click on the </span><span class="cls_007">Workspace</span><span class="cls_028">…</span><span class="cls_004"> button and select the </span><span class="cls_013">share</span></div>
<div style="position:absolute;left:152.69px;top:250.59px" class="cls_004"><span class="cls_004">project</span></div>
<div style="position:absolute;left:152.69px;top:265.35px" class="cls_004"><span class="cls_004">Goals: </span><span class="cls_013">clean package</span></div>
<div style="position:absolute;left:152.69px;top:280.79px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Apply</span></div>
<div style="position:absolute;left:56.69px;top:306.88px" class="cls_004"><span class="cls_004">Now, you just need to run these two Maven configurations to generate the two AMP</span></div>
<div style="position:absolute;left:56.69px;top:319.48px" class="cls_004"><span class="cls_004">modules in:</span></div>
<div style="position:absolute;left:104.69px;top:341.71px" class="cls_013"><span class="cls_013">/repo/target/repo-1.0-SNAPSHOT.amp</span></div>
<div style="position:absolute;left:104.69px;top:357.15px" class="cls_013"><span class="cls_013">/share/target/share-1.0-SNAPSHOT.amp</span></div>
<div style="position:absolute;left:56.69px;top:381.22px" class="cls_004"><span class="cls_004">Now, we need to figure out what to do with these AMP modules.</span></div>
<div style="position:absolute;left:56.69px;top:417.91px" class="cls_014"><span class="cls_014">Install Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:443.14px" class="cls_004"><span class="cls_004">The goal of this book is to give you an entire prospective on developing an Alfresco project.</span></div>
<div style="position:absolute;left:56.69px;top:455.74px" class="cls_004"><span class="cls_004">The easy way is to use the AIO archetype that bundles Alfresco. However, it probably won't</span></div>
<div style="position:absolute;left:56.69px;top:468.34px" class="cls_004"><span class="cls_004">be the best option in this book. We want to show you as well how to install Alfresco from</span></div>
<div style="position:absolute;left:56.69px;top:480.94px" class="cls_004"><span class="cls_004">scratch. Most developers don't work on the same operating system as the one where</span></div>
<div style="position:absolute;left:56.69px;top:493.54px" class="cls_004"><span class="cls_004">Alfresco will be installed. Depending of your organization, some developers may develop</span></div>
<div style="position:absolute;left:56.69px;top:506.14px" class="cls_004"><span class="cls_004">on a Windows system, a Mac OS system or a Linux system. It may create some issues</span></div>
<div style="position:absolute;left:56.69px;top:518.74px" class="cls_004"><span class="cls_004">depending of the project. It's why we'll use virtual machines to test our development.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 50 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:43940px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background066.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Download Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">Alfresco provides different installers. In this book, we want to install both Alfresco and</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">Share, so we'll use the Alfresco One installer. If you need to install only Alfresco or Share,</span></div>
<div style="position:absolute;left:56.69px;top:117.78px" class="cls_004"><span class="cls_004">you could use the Alfresco One platform or Alfresco Share installer. Depending of the</span></div>
<div style="position:absolute;left:56.69px;top:130.38px" class="cls_004"><span class="cls_004">version that you want to install, you are not following the same steps:</span></div>
<div style="position:absolute;left:104.69px;top:152.11px" class="cls_004"><span class="cls_004">If you want to install the Community version:</span></div>
<div style="position:absolute;left:170.69px;top:164.71px" class="cls_004"><span class="cls_004">Open the following URL:</span></div>
<div style="position:absolute;left:170.69px;top:176.63px" class="cls_010"><span class="cls_010"> </span><a href="https://www.alfresco.com/alfresco-community-download">https://www.alfresco.com/alfresco-community-download</a> </div>
<div style="position:absolute;left:170.69px;top:190.27px" class="cls_004"><span class="cls_004">Download the Linux edition</span></div>
<div style="position:absolute;left:170.69px;top:205.03px" class="cls_004"><span class="cls_004">At the time of writing, the file of the current version is called</span></div>
<div style="position:absolute;left:170.69px;top:216.85px" class="cls_013"><span class="cls_013">alfresco-community-installer-201605-linux-x64.bin</span></div>
<div style="position:absolute;left:104.69px;top:233.95px" class="cls_004"><span class="cls_004">If you want to install the Enterprise version, be aware that you'll need an access</span></div>
<div style="position:absolute;left:104.69px;top:246.55px" class="cls_004"><span class="cls_004">to the support Alfresco system, and you'll need an Alfresco license:</span></div>
<div style="position:absolute;left:170.69px;top:259.15px" class="cls_004"><span class="cls_004">Open the following URL: </span><a href="https://support.alfresco.com/">https://support.alfresco.com</a> </div>
<div style="position:absolute;left:170.69px;top:274.29px" class="cls_004"><span class="cls_004">Authenticate using the credentials provided by Alfresco</span></div>
<div style="position:absolute;left:170.69px;top:289.05px" class="cls_004"><span class="cls_004">Open the </span><span class="cls_007">DOWNLOADS</span><span class="cls_004"> tab</span></div>
<div style="position:absolute;left:170.69px;top:303.85px" class="cls_004"><span class="cls_004">Click on the current version </span><span class="cls_007">Alfresco One 5.1.1</span></div>
<div style="position:absolute;left:170.69px;top:318.65px" class="cls_004"><span class="cls_004">Click on the link to download the Linux installer: </span><span class="cls_013">5.1.1</span></div>
<div style="position:absolute;left:170.69px;top:331.93px" class="cls_013"><span class="cls_013">Alfresco One Linux 64 bit</span><span class="cls_004"> installer</span></div>
<div style="position:absolute;left:170.69px;top:347.37px" class="cls_004"><span class="cls_004">The name of the downloaded file will be: </span><span class="cls_013">alfresco-one-</span></div>
<div style="position:absolute;left:170.69px;top:359.87px" class="cls_013"><span class="cls_013">installer-5.1.1-linux-x64.bin</span></div>
<div style="position:absolute;left:56.69px;top:399.14px" class="cls_023"><span class="cls_023">Create your virtual machine</span></div>
<div style="position:absolute;left:56.69px;top:421.86px" class="cls_004"><span class="cls_004">In this section, we'll use Vagrant and VirtualBox to replicate a real deployment</span></div>
<div style="position:absolute;left:56.69px;top:434.45px" class="cls_004"><span class="cls_004">environment. It's not the purpose of this book to explain deeply how these two tools work.</span></div>
<div style="position:absolute;left:56.69px;top:447.05px" class="cls_004"><span class="cls_004">Vagrant is a software that creates and configures virtual development environments. It can</span></div>
<div style="position:absolute;left:56.69px;top:459.65px" class="cls_004"><span class="cls_004">connect to different virtualization tool, but VirtualBox is free, available on every major</span></div>
<div style="position:absolute;left:56.69px;top:472.26px" class="cls_004"><span class="cls_004">platform, and has built-in support in Vagrant. To be able to follow the next steps, you'll</span></div>
<div style="position:absolute;left:56.69px;top:484.86px" class="cls_004"><span class="cls_004">need to install VirtualBox (</span><a href="https://www.virtualbox.org/wiki/Downloads">https://www.virtualbox.org/wiki/Downloads</a> <span class="cls_004">) and Vagrant</span></div>
<div style="position:absolute;left:56.69px;top:497.83px" class="cls_004"><span class="cls_004">(</span><a href="https://www.vagrantup.com/downloads.html">https://www.vagrantup.com/downloads.html</a> <span class="cls_004">). However, feel free to use any</span></div>
<div style="position:absolute;left:56.69px;top:510.81px" class="cls_004"><span class="cls_004">virtualization method that you are used to.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 51 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:44616px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background067.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Create a file called </span><span class="cls_013">Vagrantfile</span><span class="cls_004"> and add this text:</span></div>
<div style="position:absolute;left:74.69px;top:92.10px" class="cls_010"><span class="cls_010">Vagrant.configure(2) do |config|</span></div>
<div style="position:absolute;left:74.69px;top:102.90px" class="cls_010"><span class="cls_010">config.vm.box = "box-cutter/centos72"</span></div>
<div style="position:absolute;left:85.49px;top:113.70px" class="cls_010"><span class="cls_010"># Redirect Tomcat Port</span></div>
<div style="position:absolute;left:74.69px;top:124.50px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 8080, host: 8080</span></div>
<div style="position:absolute;left:85.49px;top:135.30px" class="cls_010"><span class="cls_010"># Redirect JPDA Debugging Port</span></div>
<div style="position:absolute;left:74.69px;top:146.10px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 8000, host: 8000</span></div>
<div style="position:absolute;left:85.49px;top:156.90px" class="cls_010"><span class="cls_010"># Redirect Custom NodeJS port</span></div>
<div style="position:absolute;left:74.69px;top:167.70px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 9000, host: 9000</span></div>
<div style="position:absolute;left:74.69px;top:178.50px" class="cls_010"><span class="cls_010">config.vm.provider "virtualbox" do |v|</span></div>
<div style="position:absolute;left:74.69px;top:189.30px" class="cls_010"><span class="cls_010">v.memory = 4096</span></div>
<div style="position:absolute;left:74.69px;top:200.10px" class="cls_010"><span class="cls_010">v.cpus = 1</span></div>
<div style="position:absolute;left:85.49px;top:210.90px" class="cls_010"><span class="cls_010">end</span></div>
<div style="position:absolute;left:74.69px;top:221.70px" class="cls_010"><span class="cls_010">end</span></div>
<div style="position:absolute;left:56.69px;top:242.18px" class="cls_004"><span class="cls_004">This Vagrant configuration file specifies that we'll create a new virtual machine based on</span></div>
<div style="position:absolute;left:56.69px;top:254.78px" class="cls_004"><span class="cls_004">Cent OS 7 with one virtual CPU and 4 GB of memory. This file contains as well a port</span></div>
<div style="position:absolute;left:56.69px;top:267.38px" class="cls_004"><span class="cls_004">forwarding rule to allow us to access the Alfresco repository UI and the Alfresco Share UI</span></div>
<div style="position:absolute;left:56.69px;top:279.98px" class="cls_004"><span class="cls_004">from the host system. It forwards as well the port 8000 that we'll use to do some JPDA</span></div>
<div style="position:absolute;left:56.69px;top:292.59px" class="cls_004"><span class="cls_004">debugging. The port 9000 is as well forwarded and will be used in the </span><span class="cls_010">Chapter 6</span><span class="cls_004">,</span><span class="cls_010"> </span><span class="cls_012">Creating</span></div>
<div style="position:absolute;left:56.69px;top:305.57px" class="cls_012"><span class="cls_012">an Angular Application.</span></div>
<div style="position:absolute;left:56.69px;top:327.17px" class="cls_004"><span class="cls_004">The next step is to create the virtual machine:</span></div>
<div style="position:absolute;left:91.32px;top:348.90px" class="cls_004"><span class="cls_004">1. Open a command-line tool.</span></div>
<div style="position:absolute;left:91.32px;top:363.66px" class="cls_004"><span class="cls_004">2. Go to the folder containing the Vagrant file.</span></div>
<div style="position:absolute;left:91.32px;top:378.42px" class="cls_004"><span class="cls_004">3. Type </span><span class="cls_013">vagrant up</span><span class="cls_004">. This command will download the image of Cent OS 7 and</span></div>
<div style="position:absolute;left:104.69px;top:391.70px" class="cls_004"><span class="cls_004">we'll create the VM in VirtualBox.</span></div>
<div style="position:absolute;left:91.32px;top:406.46px" class="cls_004"><span class="cls_004">4. When it's completed, the VM is available and you can login using SSH by typing</span></div>
<div style="position:absolute;left:104.69px;top:419.06px" class="cls_013"><span class="cls_013">vagrant ssh</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:443.63px" class="cls_004"><span class="cls_004">You are now logged in to your VM and ready to install Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:465.23px" class="cls_004"><span class="cls_004">The first step is to transfer the previously downloaded installer into the VM:</span></div>
<div style="position:absolute;left:104.69px;top:486.96px" class="cls_004"><span class="cls_004">By using SCP:</span></div>
<div style="position:absolute;left:124.19px;top:510.85px" class="cls_004"><span class="cls_004">The virtual machine is listening on the port </span><span class="cls_013">2222</span><span class="cls_004"> for SSH. You can use the</span></div>
<div style="position:absolute;left:124.19px;top:524.13px" class="cls_013"><span class="cls_013">scp</span><span class="cls_004"> command by typing:</span></div>
<div style="position:absolute;left:164.69px;top:545.63px" class="cls_013"><span class="cls_013">scp -P 2222 alfresco-one-installer-5.1.1.4-linux-x64</span></div>
<div style="position:absolute;left:170.69px;top:566.63px" class="cls_013"><span class="cls_013">.binvagrant@localhost:/tmp</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 52 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:45292px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background068.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">The password for the </span><span class="cls_013">vagrant</span><span class="cls_004"> user is </span><span class="cls_013">vagrant</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:92.91px" class="cls_004"><span class="cls_004">By using a FTP client. We'll use FileZilla as example:</span></div>
<div style="position:absolute;left:173.32px;top:105.51px" class="cls_004"><span class="cls_004">Start FileZilla.</span></div>
<div style="position:absolute;left:173.32px;top:120.27px" class="cls_004"><span class="cls_004">Create a new connection:</span></div>
<div style="position:absolute;left:236.69px;top:132.87px" class="cls_004"><span class="cls_004">Host: </span><span class="cls_013">localhost</span></div>
<div style="position:absolute;left:236.69px;top:148.31px" class="cls_004"><span class="cls_004">Port: </span><span class="cls_013">2222</span></div>
<div style="position:absolute;left:236.69px;top:163.75px" class="cls_004"><span class="cls_004">Protocol: </span><span class="cls_013">SFTP - SSH File Transfer Protocol</span></div>
<div style="position:absolute;left:236.69px;top:179.19px" class="cls_004"><span class="cls_004">Logon Type: </span><span class="cls_013">Normal</span></div>
<div style="position:absolute;left:236.69px;top:194.63px" class="cls_004"><span class="cls_004">User: </span><span class="cls_013">vagrant</span></div>
<div style="position:absolute;left:236.69px;top:210.07px" class="cls_004"><span class="cls_004">Password: </span><span class="cls_013">vagrant</span></div>
<div style="position:absolute;left:170.69px;top:227.67px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Connect</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:170.69px;top:242.47px" class="cls_004"><span class="cls_004">Then, you just need to drag and drop files between your system</span></div>
<div style="position:absolute;left:170.69px;top:255.07px" class="cls_004"><span class="cls_004">and the virtual machine.</span></div>
<div style="position:absolute;left:56.69px;top:281.12px" class="cls_004"><span class="cls_004">The following installation notes are based on the Enterprise version of Alfresco. But the</span></div>
<div style="position:absolute;left:56.69px;top:293.72px" class="cls_004"><span class="cls_004">steps are exactly the same for the Community version. You just need to use the Community</span></div>
<div style="position:absolute;left:56.69px;top:306.32px" class="cls_004"><span class="cls_004">installer file name, instead of the Enterprise one:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 53 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:45968px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background069.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Now, we are ready to install Alfresco. We could install Alfresco using the root user.</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">However, for security reasons, it's recommended to install Alfresco with another user. The</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">downside of doing that is that Alfresco won't install the service for you, so we'll need it to</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">do it manually:</span></div>
<div style="position:absolute;left:91.32px;top:130.03px" class="cls_004"><span class="cls_004">1. Create the </span><span class="cls_013">alfresco</span><span class="cls_004"> group :</span></div>
<div style="position:absolute;left:117.89px;top:153.92px" class="cls_010"><span class="cls_010">sudo groupadd alfresco</span></div>
<div style="position:absolute;left:91.32px;top:174.53px" class="cls_004"><span class="cls_004">2. Create the </span><span class="cls_013">alfresco</span><span class="cls_004"> user:</span></div>
<div style="position:absolute;left:117.89px;top:198.42px" class="cls_010"><span class="cls_010">sudo adduser-m -g alfresco alfresco</span></div>
<div style="position:absolute;left:91.32px;top:219.03px" class="cls_004"><span class="cls_004">3. Define a password for the </span><span class="cls_013">alfresco</span><span class="cls_004"> user:</span></div>
<div style="position:absolute;left:117.89px;top:242.92px" class="cls_010"><span class="cls_010">sudo passwd alfresco</span></div>
<div style="position:absolute;left:91.32px;top:263.53px" class="cls_004"><span class="cls_004">4. Add the </span><span class="cls_013">vagrant</span><span class="cls_004"> user to the </span><span class="cls_013">alfresco</span><span class="cls_004"> group too:</span></div>
<div style="position:absolute;left:117.89px;top:287.42px" class="cls_010"><span class="cls_010">sudo usermod -a -G alfresco vagrant</span></div>
<div style="position:absolute;left:91.32px;top:308.03px" class="cls_004"><span class="cls_004">5. Create the folder where we'll install Alfresco and give access to our newly created</span></div>
<div style="position:absolute;left:104.69px;top:320.63px" class="cls_004"><span class="cls_004">user:</span></div>
<div style="position:absolute;left:117.89px;top:343.84px" class="cls_010"><span class="cls_010">sudo mkdir /opt/alfresco</span></div>
<div style="position:absolute;left:117.89px;top:354.64px" class="cls_010"><span class="cls_010">sudo chown alfresco:alfresco /opt/alfresco/</span></div>
<div style="position:absolute;left:91.32px;top:375.25px" class="cls_004"><span class="cls_004">6. Install some dependencies not bundled in the Alfresco installer:</span></div>
<div style="position:absolute;left:117.89px;top:398.46px" class="cls_010"><span class="cls_010">sudo yum -y install fontconfiglibSMlibICElibXrenderlibXext</span></div>
<div style="position:absolute;left:128.69px;top:409.26px" class="cls_010"><span class="cls_010">cups-libs libGLU</span></div>
<div style="position:absolute;left:91.32px;top:429.87px" class="cls_004"><span class="cls_004">7. Create the Alfresco service file </span><span class="cls_013">/etc/init.d/alfresco</span><span class="cls_004"> (by using vi, or nano if</span></div>
<div style="position:absolute;left:104.69px;top:443.15px" class="cls_004"><span class="cls_004">you installed it) and add the following content:</span></div>
<div style="position:absolute;left:117.89px;top:466.36px" class="cls_010"><span class="cls_010">#!/bin/sh</span></div>
<div style="position:absolute;left:117.89px;top:487.96px" class="cls_010"><span class="cls_010">RETVAL=0</span></div>
<div style="position:absolute;left:117.89px;top:509.56px" class="cls_010"><span class="cls_010">start () {</span></div>
<div style="position:absolute;left:139.49px;top:520.36px" class="cls_010"><span class="cls_010">/opt/alfresco/alfresco.sh start "$2"</span></div>
<div style="position:absolute;left:139.49px;top:531.16px" class="cls_010"><span class="cls_010">RETVAL=$?</span></div>
<div style="position:absolute;left:139.49px;top:541.96px" class="cls_010"><span class="cls_010">if [ -d "/var/lock/subsys" ]&amp;&amp; [ `id -u` = 0 ] &amp;&amp;</span></div>
<div style="position:absolute;left:150.29px;top:552.76px" class="cls_010"><span class="cls_010">[ $RETVAL -eq 0 ] ; then</span></div>
<div style="position:absolute;left:171.89px;top:563.56px" class="cls_010"><span class="cls_010">touch /var/lock/subsys/alfresco</span></div>
<div style="position:absolute;left:139.49px;top:574.36px" class="cls_010"><span class="cls_010">fi</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 54 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:46644px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background070.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">stop () {</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">/opt/alfresco/alfresco.sh stop "$2"</span></div>
<div style="position:absolute;left:139.49px;top:113.02px" class="cls_010"><span class="cls_010">RETVAL=$?</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:134.62px" class="cls_010"><span class="cls_010">case "$1" in</span></div>
<div style="position:absolute;left:139.49px;top:145.42px" class="cls_010"><span class="cls_010">start)</span></div>
<div style="position:absolute;left:161.09px;top:156.22px" class="cls_010"><span class="cls_010">start "$@"</span></div>
<div style="position:absolute;left:161.09px;top:167.02px" class="cls_010"><span class="cls_010">;;</span></div>
<div style="position:absolute;left:139.49px;top:177.82px" class="cls_010"><span class="cls_010">stop)</span></div>
<div style="position:absolute;left:161.09px;top:188.62px" class="cls_010"><span class="cls_010">stop "$@"</span></div>
<div style="position:absolute;left:161.09px;top:199.42px" class="cls_010"><span class="cls_010">;;</span></div>
<div style="position:absolute;left:139.49px;top:210.22px" class="cls_010"><span class="cls_010">restart)</span></div>
<div style="position:absolute;left:161.09px;top:221.02px" class="cls_010"><span class="cls_010">stop "$@"</span></div>
<div style="position:absolute;left:161.09px;top:231.82px" class="cls_010"><span class="cls_010">start "$@"</span></div>
<div style="position:absolute;left:161.09px;top:242.62px" class="cls_010"><span class="cls_010">;;</span></div>
<div style="position:absolute;left:139.49px;top:253.42px" class="cls_010"><span class="cls_010">*)</span></div>
<div style="position:absolute;left:161.09px;top:264.22px" class="cls_010"><span class="cls_010">/opt/alfresco/alfresco.sh "$@"</span></div>
<div style="position:absolute;left:161.09px;top:275.02px" class="cls_010"><span class="cls_010">RETVAL=$?</span></div>
<div style="position:absolute;left:117.89px;top:285.82px" class="cls_010"><span class="cls_010">esac</span></div>
<div style="position:absolute;left:117.89px;top:296.62px" class="cls_010"><span class="cls_010">exit $RETVAL</span></div>
<div style="position:absolute;left:91.32px;top:326.36px" class="cls_004"><span class="cls_004">8. Make this script executable:</span></div>
<div style="position:absolute;left:117.89px;top:349.57px" class="cls_010"><span class="cls_010">sudo chmod +x /etc/init.d/alfresco</span></div>
<div style="position:absolute;left:91.32px;top:370.18px" class="cls_004"><span class="cls_004">9. Authenticate as </span><span class="cls_013">alfresco</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:394.07px" class="cls_010"><span class="cls_010">sudo su alfresco</span></div>
<div style="position:absolute;left:86.07px;top:414.68px" class="cls_004"><span class="cls_004">10. Make the installer executable:</span></div>
<div style="position:absolute;left:139.49px;top:437.89px" class="cls_010"><span class="cls_010">chmod +x /tmp/alfresco-one-installer-5.1.1.4-linux-x64.bin</span></div>
<div style="position:absolute;left:104.69px;top:458.50px" class="cls_004"><span class="cls_004">Start the installation:</span></div>
<div style="position:absolute;left:139.49px;top:481.71px" class="cls_010"><span class="cls_010">/tmp/alfresco-one-installer-5.1.1.4-linux-x64.bin</span></div>
<div style="position:absolute;left:104.69px;top:502.32px" class="cls_004"><span class="cls_004">First, let's select </span><span class="cls_013">English</span><span class="cls_004"> as installation language:</span></div>
<div style="position:absolute;left:139.49px;top:537.01px" class="cls_010"><span class="cls_010">Language Selection</span></div>
<div style="position:absolute;left:139.49px;top:558.61px" class="cls_010"><span class="cls_010">Please select the installation language</span></div>
<div style="position:absolute;left:139.49px;top:569.41px" class="cls_010"><span class="cls_010">[1] English</span></div>
<div style="position:absolute;left:139.49px;top:580.21px" class="cls_010"><span class="cls_010">[2] French</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 55 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:47320px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background071.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">[3] Spanish</span></div>
<div style="position:absolute;left:139.49px;top:80.62px" class="cls_010"><span class="cls_010">[4] Italian</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">[5] German</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">[6] Japanese</span></div>
<div style="position:absolute;left:139.49px;top:113.02px" class="cls_010"><span class="cls_010">[7] Dutch</span></div>
<div style="position:absolute;left:139.49px;top:123.82px" class="cls_010"><span class="cls_010">[8] Russian</span></div>
<div style="position:absolute;left:139.49px;top:134.62px" class="cls_010"><span class="cls_010">[9] Simplified Chinese</span></div>
<div style="position:absolute;left:139.49px;top:145.42px" class="cls_010"><span class="cls_010">[10] Norwegian</span></div>
<div style="position:absolute;left:139.49px;top:156.22px" class="cls_010"><span class="cls_010">[11] Brazilian Portuguese</span></div>
<div style="position:absolute;left:139.49px;top:167.02px" class="cls_010"><span class="cls_010">Please choose an option [1] : 1</span></div>
<div style="position:absolute;left:104.69px;top:187.63px" class="cls_004"><span class="cls_004">Accept the license (if you install the Enterprise version):</span></div>
<div style="position:absolute;left:139.49px;top:210.84px" class="cls_010"><span class="cls_010">Read the following License Agreement.</span></div>
<div style="position:absolute;left:139.49px;top:221.64px" class="cls_010"><span class="cls_010">You must accept the terms of this</span></div>
<div style="position:absolute;left:139.49px;top:232.44px" class="cls_010"><span class="cls_010">agreement before continuing with the installation.</span></div>
<div style="position:absolute;left:139.49px;top:254.04px" class="cls_010"><span class="cls_010">Press [Enter] to continue:</span></div>
<div style="position:absolute;left:139.49px;top:264.84px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:139.49px;top:286.44px" class="cls_010"><span class="cls_010">Do you accept this license? [y/n]: </span><span class="cls_020">y</span></div>
<div style="position:absolute;left:104.69px;top:307.05px" class="cls_004"><span class="cls_004">The next step is to select the installation type: </span><span class="cls_013">Easy</span><span class="cls_004"> or </span><span class="cls_013">Advanced</span><span class="cls_004">. To simplify</span></div>
<div style="position:absolute;left:104.69px;top:320.33px" class="cls_004"><span class="cls_004">we'll select the </span><span class="cls_013">Easy</span><span class="cls_004"> installation type. It will install all required components</span></div>
<div style="position:absolute;left:104.69px;top:333.61px" class="cls_004"><span class="cls_004">including Java, LibreOffice, ImageMagick, PostgreSQL:</span></div>
<div style="position:absolute;left:139.49px;top:356.82px" class="cls_010"><span class="cls_010">Installation Type</span></div>
<div style="position:absolute;left:139.49px;top:378.42px" class="cls_010"><span class="cls_010">[1] Easy - Install using the default configuration.</span></div>
<div style="position:absolute;left:139.49px;top:389.22px" class="cls_010"><span class="cls_010">[2] Advanced - Configure server ports and service properties.:</span></div>
<div style="position:absolute;left:161.09px;top:400.02px" class="cls_010"><span class="cls_010">Choose optional components to install.</span></div>
<div style="position:absolute;left:139.49px;top:421.62px" class="cls_010"><span class="cls_010">Please choose an option [1] :</span><span class="cls_020">1</span></div>
<div style="position:absolute;left:104.69px;top:442.23px" class="cls_004"><span class="cls_004">Specify that you want to install Alfresco in the </span><span class="cls_013">/opt/alfresco</span><span class="cls_004"> folder:</span></div>
<div style="position:absolute;left:139.49px;top:466.12px" class="cls_010"><span class="cls_010">Installation Folder</span></div>
<div style="position:absolute;left:139.49px;top:476.92px" class="cls_010"><span class="cls_010">Choose a folder to install Alfresco One.</span></div>
<div style="position:absolute;left:139.49px;top:487.72px" class="cls_010"><span class="cls_010">Select a folder: [/home/alfresco/alfresco-one]:</span><span class="cls_020">/opt/alfresco</span></div>
<div style="position:absolute;left:104.69px;top:508.33px" class="cls_004"><span class="cls_004">Specify the admin password. By default, it's recommended to use the same</span></div>
<div style="position:absolute;left:104.69px;top:520.93px" class="cls_004"><span class="cls_004">password as the username:</span></div>
<div style="position:absolute;left:139.49px;top:544.14px" class="cls_010"><span class="cls_010">Admin Password</span></div>
<div style="position:absolute;left:139.49px;top:554.94px" class="cls_010"><span class="cls_010">Specify a password for the Alfresco administrator account.</span></div>
<div style="position:absolute;left:139.49px;top:565.74px" class="cls_010"><span class="cls_010">Admin Password: </span><span class="cls_020">admin</span></div>
<div style="position:absolute;left:139.49px;top:576.54px" class="cls_010"><span class="cls_010">Repeat Password: </span><span class="cls_020">admin</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 56 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:47996px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background072.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">You may receive a warning that the environment is not optimal because there are</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">not enough resources. This is not critical, because it's just a development</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">environment:</span></div>
<div style="position:absolute;left:134.09px;top:118.91px" class="cls_010"><span class="cls_010">Warning</span></div>
<div style="position:absolute;left:134.09px;top:140.51px" class="cls_010"><span class="cls_010">This environment is not configured optimally for Alfresco -</span></div>
<div style="position:absolute;left:155.69px;top:151.31px" class="cls_010"><span class="cls_010">review this list before continuing.</span></div>
<div style="position:absolute;left:134.09px;top:172.91px" class="cls_010"><span class="cls_010">While these issues won't prevent Alfresco from functioning,</span></div>
<div style="position:absolute;left:155.69px;top:183.71px" class="cls_010"><span class="cls_010">some product features might not be available,</span></div>
<div style="position:absolute;left:155.69px;top:194.51px" class="cls_010"><span class="cls_010">or the system might not perform optimally.</span></div>
<div style="position:absolute;left:134.09px;top:216.11px" class="cls_010"><span class="cls_010">Not enough CPUs (cores) available</span></div>
<div style="position:absolute;left:134.09px;top:226.91px" class="cls_010"><span class="cls_010">(2+): 1</span></div>
<div style="position:absolute;left:134.09px;top:248.51px" class="cls_010"><span class="cls_010">Not enough system RAM available</span></div>
<div style="position:absolute;left:134.09px;top:259.31px" class="cls_010"><span class="cls_010">(4.0GB+): 3.70GB</span></div>
<div style="position:absolute;left:134.09px;top:270.11px" class="cls_010"><span class="cls_010">SMTP TCP port in use: 25</span></div>
<div style="position:absolute;left:134.09px;top:291.71px" class="cls_010"><span class="cls_010">Press [Enter] to continue:</span></div>
<div style="position:absolute;left:104.69px;top:312.32px" class="cls_004"><span class="cls_004">We are now ready to start the installation:</span></div>
<div style="position:absolute;left:134.09px;top:335.53px" class="cls_010"><span class="cls_010">Setup is now ready to begin installing</span></div>
<div style="position:absolute;left:139.49px;top:346.33px" class="cls_010"><span class="cls_010">Alfresco One on your computer.</span></div>
<div style="position:absolute;left:134.09px;top:367.93px" class="cls_010"><span class="cls_010">Do you want to continue? [Y/n]: </span><span class="cls_020">Y</span></div>
<div style="position:absolute;left:134.09px;top:378.73px" class="cls_010"><span class="cls_010">---------------------------------------------------------------</span></div>
<div style="position:absolute;left:134.09px;top:389.53px" class="cls_010"><span class="cls_010">Please wait while Setup installs Alfresco One on your computer.</span></div>
<div style="position:absolute;left:134.09px;top:411.13px" class="cls_010"><span class="cls_010">Installing</span></div>
<div style="position:absolute;left:134.09px;top:421.93px" class="cls_010"><span class="cls_010">0% ______________ 50% ______________ 100%</span></div>
<div style="position:absolute;left:134.09px;top:432.73px" class="cls_010"><span class="cls_010">#########################################</span></div>
<div style="position:absolute;left:104.69px;top:453.34px" class="cls_004"><span class="cls_004">Finally, we don't want to read the </span><span class="cls_013">Readme</span><span class="cls_004"> file:</span></div>
<div style="position:absolute;left:134.09px;top:477.23px" class="cls_010"><span class="cls_010">Setup has finished installing Alfresco One on your computer.</span></div>
<div style="position:absolute;left:134.09px;top:488.03px" class="cls_010"><span class="cls_010">View Readme File [Y/n]: </span><span class="cls_020">n</span></div>
<div style="position:absolute;left:104.69px;top:508.64px" class="cls_004"><span class="cls_004">And we don't want to start Alfresco right now:</span></div>
<div style="position:absolute;left:134.09px;top:531.85px" class="cls_010"><span class="cls_010">Launch Alfresco One[Y/n]: </span><span class="cls_020">n</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 57 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:48672px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background073.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:122.09px;top:70.50px" class="cls_004"><span class="cls_004">Be aware that Alfresco provides a </span><span class="cls_007">Day Zero configuration guide</span><span class="cls_004"> that will</span></div>
<div style="position:absolute;left:122.09px;top:83.14px" class="cls_004"><span class="cls_004">help to check and to improve your Alfresco configuration for a production</span></div>
<div style="position:absolute;left:122.09px;top:95.74px" class="cls_004"><span class="cls_004">use </span><a href="http://docs.alfresco.com/5.0/concepts/zeroday-overview.html">http://docs.alfresco.com/5.0/concepts/zeroday-overview.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:142.95px" class="cls_023"><span class="cls_023">Deploy your modules</span></div>
<div style="position:absolute;left:56.69px;top:165.66px" class="cls_004"><span class="cls_004">Before starting Alfresco, we want to deploy our new AMP modules in our virtual machines.</span></div>
<div style="position:absolute;left:56.69px;top:178.26px" class="cls_004"><span class="cls_004">Using your favorite method:</span></div>
<div style="position:absolute;left:104.69px;top:199.99px" class="cls_004"><span class="cls_004">Transfer </span><span class="cls_013">repo-1.0-SNAPSHOT.amp</span><span class="cls_004"> to </span><span class="cls_013">/opt/alfresco/amps</span></div>
<div style="position:absolute;left:104.69px;top:215.43px" class="cls_004"><span class="cls_004">Transfer </span><span class="cls_013">share-1.0-SNAPSHOT.amp</span><span class="cls_004"> to </span><span class="cls_013">/opt/alfresco/amps_share</span></div>
<div style="position:absolute;left:56.69px;top:240.00px" class="cls_004"><span class="cls_004">The next step is to apply the AMP module to the </span><span class="cls_013">alfresco.war</span><span class="cls_004"> and </span><span class="cls_013">share.war</span><span class="cls_004"> files.</span></div>
<div style="position:absolute;left:56.69px;top:253.28px" class="cls_004"><span class="cls_004">Alfresco provides a tool called </span><span class="cls_007">Module Management Tool</span><span class="cls_004"> (</span><span class="cls_007">MMT</span><span class="cls_004">). The MMT program,</span></div>
<div style="position:absolute;left:56.69px;top:265.92px" class="cls_013"><span class="cls_013">alfresco-mmt.jar</span><span class="cls_004">, supports the following:</span></div>
<div style="position:absolute;left:104.69px;top:288.33px" class="cls_004"><span class="cls_004">Installation of AMP files including upgrades to later versions</span></div>
<div style="position:absolute;left:104.69px;top:303.09px" class="cls_004"><span class="cls_004">Uninstallation of installed modules</span></div>
<div style="position:absolute;left:104.69px;top:317.85px" class="cls_004"><span class="cls_004">Listing of currently installed module</span></div>
<div style="position:absolute;left:56.69px;top:341.74px" class="cls_004"><span class="cls_004">This file is deployed in the </span><span class="cls_013">bin</span><span class="cls_004"> directory of the Alfresco installation. In the same folder,</span></div>
<div style="position:absolute;left:56.69px;top:355.02px" class="cls_004"><span class="cls_004">Alfresco provides another program called </span><span class="cls_013">apply_amps.sh</span><span class="cls_004"> on a Linux system. This</span></div>
<div style="position:absolute;left:56.69px;top:368.30px" class="cls_004"><span class="cls_004">executable script used the MMT tool to install AMP module to WAR files.</span></div>
<div style="position:absolute;left:104.69px;top:390.03px" class="cls_004"><span class="cls_004">Open the </span><span class="cls_013">bin</span><span class="cls_004"> folder:</span></div>
<div style="position:absolute;left:117.89px;top:413.92px" class="cls_010"><span class="cls_010">cd /opt/alfresco/bin</span></div>
<div style="position:absolute;left:104.69px;top:434.53px" class="cls_004"><span class="cls_004">Apply the AMP modules:</span></div>
<div style="position:absolute;left:112.49px;top:457.74px" class="cls_010"><span class="cls_010">./apply_amps.sh</span></div>
<div style="position:absolute;left:104.69px;top:478.35px" class="cls_004"><span class="cls_004">When it's installed, you can just start Alfresco:</span></div>
<div style="position:absolute;left:112.49px;top:501.56px" class="cls_010"><span class="cls_010">service alfresco start</span></div>
<div style="position:absolute;left:56.69px;top:522.04px" class="cls_004"><span class="cls_004">You can track the startup of Alfresco by typing the following command:</span></div>
<div style="position:absolute;left:74.69px;top:542.96px" class="cls_010"><span class="cls_010">less+F/opt/alfresco/tomcat/logs/catalina.out</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 58 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:49348px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background074.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You should see the following message that confirms that your Alfresco module is properly</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">installed:</span></div>
<div style="position:absolute;left:74.69px;top:104.02px" class="cls_010"><span class="cls_010">INFO [repo.module.ModuleServiceImpl] [localhost-startStop-1]</span></div>
<div style="position:absolute;left:85.49px;top:114.82px" class="cls_010"><span class="cls_010">Installing module 'repo' version 1.0-SNAPSHOT</span></div>
<div style="position:absolute;left:56.69px;top:135.30px" class="cls_004"><span class="cls_004">When Alfresco is started, you should see the message:</span></div>
<div style="position:absolute;left:74.69px;top:156.22px" class="cls_010"><span class="cls_010">INFO: Server startup in 136101 ms</span></div>
<div style="position:absolute;left:56.69px;top:176.70px" class="cls_004"><span class="cls_004">Then, just open your browser on </span><a href="http://127.0.0.1:8080/share/">http://127.0.0.1:8080/share/</a> <span class="cls_004"> and login as</span></div>
<div style="position:absolute;left:56.69px;top:189.98px" class="cls_013"><span class="cls_013">admin</span><span class="cls_004">/</span><span class="cls_013">admin</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:56.69px;top:501.18px" class="cls_004"><span class="cls_004">The two modules that we just installed contains already some example of customization.</span></div>
<div style="position:absolute;left:56.69px;top:513.78px" class="cls_004"><span class="cls_004">For example, there is a new web script deployed in Alfresco. To test it, just opens the URL</span></div>
<div style="position:absolute;left:56.69px;top:526.38px" class="cls_013"><span class="cls_013"> </span><a href="http://127.0.0.1:8080/alfresco/s/sample/helloworld/">http://127.0.0.1:8080/alfresco/s/sample/helloworld</a> <span class="cls_004"> (you should see a dialog</span></div>
<div style="position:absolute;left:56.69px;top:539.66px" class="cls_004"><span class="cls_004">box where you need to authenticate with the </span><span class="cls_013">admin</span><span class="cls_004"> username):</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 59 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:50024px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background075.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:208.46px" class="cls_004"><span class="cls_004">The Share module contains as well some customization. For example, it includes a new</span></div>
<div style="position:absolute;left:56.69px;top:221.06px" class="cls_004"><span class="cls_004">Aikau page. To test it, just open the URL</span></div>
<div style="position:absolute;left:56.69px;top:233.66px" class="cls_013"><span class="cls_013"> </span><a href="http://127.0.0.1:8080/share/page/dp/ws/simple-page/">http://127.0.0.1:8080/share/page/dp/ws/simple-page</a> <span class="cls_004"> (you should see a login</span></div>
<div style="position:absolute;left:56.69px;top:246.94px" class="cls_004"><span class="cls_004">page where you need to authenticate with the </span><span class="cls_013">admin</span><span class="cls_004"> username):</span></div>
<div style="position:absolute;left:56.69px;top:418.19px" class="cls_023"><span class="cls_023">Check that your modules are installed</span></div>
<div style="position:absolute;left:56.69px;top:440.90px" class="cls_004"><span class="cls_004">Alfresco Enterprise provides different way to check that your modules are installed</span></div>
<div style="position:absolute;left:56.69px;top:453.50px" class="cls_004"><span class="cls_004">properly. As shown previously, we can use the log file to check that the repository module</span></div>
<div style="position:absolute;left:56.69px;top:466.10px" class="cls_004"><span class="cls_004">is installed. As well, if you use the Enterprise edition, you can open the following URL</span></div>
<div style="position:absolute;left:56.69px;top:477.92px" class="cls_013"><span class="cls_013"> </span><a href="http://127.0.0.1:8080/alfresco/service/enterprise/admin/admin-systemsum/">http://127.0.0.1:8080/alfresco/service/enterprise/admin/admin-systemsum</a> </div>
<div style="position:absolute;left:56.69px;top:490.70px" class="cls_013"><span class="cls_013">mary</span><span class="cls_004"> and in bottom right corner, you should see the list of installed modules:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 60 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:50700px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background076.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Alfresco Share provides as well a page to check the list of installed modules. You just need</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">to open the following URL</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_013"><span class="cls_013">http://127.0.0.1:8080/share/page/console/admin-console/module-package</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:56.69px;top:372.70px" class="cls_023"><span class="cls_023">Extending Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:395.41px" class="cls_004"><span class="cls_004">Alfresco provides an extension mechanism that keeps customizations separate from the files</span></div>
<div style="position:absolute;left:56.69px;top:408.01px" class="cls_004"><span class="cls_004">that are a part of the Alfresco distribution. It is important to keep your customizations</span></div>
<div style="position:absolute;left:56.69px;top:420.61px" class="cls_004"><span class="cls_004">separate from Alfresco's in order to help streamline future upgrades and to simplify</span></div>
<div style="position:absolute;left:56.69px;top:433.21px" class="cls_004"><span class="cls_004">troubleshooting.</span></div>
<div style="position:absolute;left:56.69px;top:469.91px" class="cls_014"><span class="cls_014">Understanding the extension mechanism</span></div>
<div style="position:absolute;left:56.69px;top:495.13px" class="cls_004"><span class="cls_004">When you implement Alfresco, you will inevitably identify things you want to tweak and</span></div>
<div style="position:absolute;left:56.69px;top:507.73px" class="cls_004"><span class="cls_004">potentially define an entirely new functionality that you would like to add to the platform.</span></div>
<div style="position:absolute;left:56.69px;top:520.33px" class="cls_004"><span class="cls_004">Because Alfresco is based on the Spring framework, you'll use the same approach with your</span></div>
<div style="position:absolute;left:56.69px;top:532.93px" class="cls_004"><span class="cls_004">own customizations. You will extend the existing or write new Spring beans, Java classes,</span></div>
<div style="position:absolute;left:56.69px;top:545.53px" class="cls_004"><span class="cls_004">Freemarker templates, and other files. The custom files are deployed as a part of the</span></div>
<div style="position:absolute;left:56.69px;top:558.13px" class="cls_004"><span class="cls_004">Alfresco or Share web application. The trick is to override or extend Alfresco with your own</span></div>
<div style="position:absolute;left:56.69px;top:570.73px" class="cls_004"><span class="cls_004">code, while keeping those extensions and customizations separate from the Alfresco core.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 61 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:51376px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background077.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">This means you have to know what goes where and the answer to that depends on what's</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">being extended.</span></div>
<div style="position:absolute;left:56.69px;top:104.70px" class="cls_004"><span class="cls_004">When implementing your solution, you are likely to create or customize one or more of the</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">following types of files:</span></div>
<div style="position:absolute;left:104.69px;top:139.03px" class="cls_004"><span class="cls_004">Standard Java web application files</span></div>
<div style="position:absolute;left:104.69px;top:153.79px" class="cls_004"><span class="cls_004">Framework files (Spring beans and their associated configuration files)</span></div>
<div style="position:absolute;left:104.69px;top:168.55px" class="cls_004"><span class="cls_004">Alfresco configuration files (properties files and XML files)</span></div>
<div style="position:absolute;left:104.69px;top:183.31px" class="cls_004"><span class="cls_004">Solution-specific files (content models, business process definitions, web scripts,</span></div>
<div style="position:absolute;left:104.69px;top:195.91px" class="cls_004"><span class="cls_004">JavaScript, and Freemarker templates)</span></div>
<div style="position:absolute;left:56.69px;top:219.80px" class="cls_004"><span class="cls_004">Let's look at how each of these areas is extended.</span></div>
<div style="position:absolute;left:56.69px;top:254.45px" class="cls_023"><span class="cls_023">Standard Java web application files</span></div>
<div style="position:absolute;left:56.69px;top:277.16px" class="cls_004"><span class="cls_004">Given that you probably have experience developing Java web applications, there is not</span></div>
<div style="position:absolute;left:56.69px;top:289.76px" class="cls_004"><span class="cls_004">much need to go into detail here. The Java classes you develop as a part of your</span></div>
<div style="position:absolute;left:56.69px;top:302.36px" class="cls_004"><span class="cls_004">customization will go into a JAR file. The JAR file will reside in the </span><span class="cls_013">WEB-INF</span><span class="cls_004"> | </span><span class="cls_013">lib</span><span class="cls_004"> folder of</span></div>
<div style="position:absolute;left:56.69px;top:315.64px" class="cls_004"><span class="cls_004">the Alfresco or Share web application. By default, the name of the JAR files is the same</span></div>
<div style="position:absolute;left:56.69px;top:328.24px" class="cls_004"><span class="cls_004">name as the AMP module.</span></div>
<div style="position:absolute;left:56.69px;top:362.89px" class="cls_023"><span class="cls_023">Framework files</span></div>
<div style="position:absolute;left:56.69px;top:385.60px" class="cls_004"><span class="cls_004">Alfresco makes heavy use of the Spring Framework and can be used for plenty of</span></div>
<div style="position:absolute;left:56.69px;top:398.20px" class="cls_004"><span class="cls_004">customizations. You'll discover in the next sections some customization that you can do.</span></div>
<div style="position:absolute;left:56.69px;top:428.80px" class="cls_029"><span class="cls_029">Spring configuration files</span></div>
<div style="position:absolute;left:56.69px;top:448.36px" class="cls_004"><span class="cls_004">Spring configuration files always end in </span><span class="cls_013">-context.xml</span><span class="cls_004">. That's how Spring knows to read</span></div>
<div style="position:absolute;left:56.69px;top:461.64px" class="cls_004"><span class="cls_004">them when the application starts up. Each repository module contains a file called </span><span class="cls_013">module-</span></div>
<div style="position:absolute;left:56.69px;top:474.92px" class="cls_013"><span class="cls_013">context.xml</span><span class="cls_004">. This is used to load the Spring configuration for the module. Usually, this</span></div>
<div style="position:absolute;left:56.69px;top:488.20px" class="cls_004"><span class="cls_004">context file loads other specific context models. If you open the file</span></div>
<div style="position:absolute;left:56.69px;top:500.80px" class="cls_013"><span class="cls_013">repo|src|main|amp|config|alfresco|module|repo|module-context.xml</span><span class="cls_004">, you can</span></div>
<div style="position:absolute;left:56.69px;top:514.08px" class="cls_004"><span class="cls_004">notice that it loads three additional context files located in the sub-directory </span><span class="cls_013">context</span><span class="cls_004">. It</span></div>
<div style="position:absolute;left:56.69px;top:527.36px" class="cls_004"><span class="cls_004">allows to have one context file per component:</span></div>
<div style="position:absolute;left:104.69px;top:549.09px" class="cls_013"><span class="cls_013">bootstrap-context.xml</span><span class="cls_004"> that loads the two content models already defined</span></div>
<div style="position:absolute;left:104.69px;top:564.53px" class="cls_013"><span class="cls_013">service-context.xml</span><span class="cls_004"> that create the custom Java service</span></div>
<div style="position:absolute;left:104.69px;top:579.97px" class="cls_013"><span class="cls_013">webscript-context.xml</span><span class="cls_004"> that create the Java back-end webscript</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 62 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:52052px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background078.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Let's look at an example. Here's the Alfresco Spring bean that's used to tell Alfresco to load</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">the default custom content models already existing in our module:</span></div>
<div style="position:absolute;left:74.69px;top:104.02px" class="cls_010"><span class="cls_010">&lt;bean id="repo.dictionaryBootstrap" parent="dictionaryModelBootstrap"</span></div>
<div style="position:absolute;left:96.29px;top:114.82px" class="cls_010"><span class="cls_010">depends-on="dictionaryBootstrap"&gt;</span></div>
<div style="position:absolute;left:90.89px;top:125.62px" class="cls_010"><span class="cls_010">&lt;property name="models"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:136.42px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:161.09px;top:147.22px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco/module/${project.artifactId}</span></div>
<div style="position:absolute;left:182.69px;top:158.02px" class="cls_010"><span class="cls_010">/model/content-model.xml&lt;/value&gt;</span></div>
<div style="position:absolute;left:155.69px;top:168.82px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco/module/${project.artifactId}</span></div>
<div style="position:absolute;left:182.69px;top:179.62px" class="cls_010"><span class="cls_010">/model/workflow-model.xml&lt;/value&gt;</span></div>
<div style="position:absolute;left:123.29px;top:190.42px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:90.89px;top:201.22px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:212.02px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:56.69px;top:232.50px" class="cls_004"><span class="cls_004">In the Share module, it's slightly different. The Share module contains a file called share-</span></div>
<div style="position:absolute;left:56.69px;top:245.10px" class="cls_013"><span class="cls_013">slingshot-application-context.xml</span><span class="cls_004"> that resides in the folder</span></div>
<div style="position:absolute;left:56.69px;top:258.38px" class="cls_013"><span class="cls_013">share|src|main|amp|config|alfresco|web-extension</span><span class="cls_004">. Right now, this file is only</span></div>
<div style="position:absolute;left:56.69px;top:271.66px" class="cls_004"><span class="cls_004">used to load new messages</span><span class="cls_022">”</span></div>
<div style="position:absolute;left:74.69px;top:293.41px" class="cls_010"><span class="cls_010">&lt;bean id="share.resources"</span></div>
<div style="position:absolute;left:74.69px;top:304.21px" class="cls_010"><span class="cls_010">class="org.springframework.extensions.surf.util.ResourceBundleBootstrapComp</span></div>
<div style="position:absolute;left:74.69px;top:315.01px" class="cls_010"><span class="cls_010">onent"&gt;</span></div>
<div style="position:absolute;left:90.89px;top:325.81px" class="cls_010"><span class="cls_010">&lt;property name="resourceBundles"&gt;</span></div>
<div style="position:absolute;left:123.29px;top:336.61px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:155.69px;top:347.41px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco.web-extension.messages.share&lt;/value&gt;</span></div>
<div style="position:absolute;left:123.29px;top:358.21px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:90.89px;top:369.01px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:379.81px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:56.69px;top:409.29px" class="cls_029"><span class="cls_029">Alfresco configuration files</span></div>
<div style="position:absolute;left:56.69px;top:428.85px" class="cls_004"><span class="cls_004">Not all configurations are handled through standard frameworks such as Spring. Some</span></div>
<div style="position:absolute;left:56.69px;top:441.45px" class="cls_004"><span class="cls_004">configuration changes are made using properties files or Alfresco configuration XML. For</span></div>
<div style="position:absolute;left:56.69px;top:454.05px" class="cls_004"><span class="cls_004">example, the most commonly customized properties file is </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:467.33px" class="cls_013"><span class="cls_013">global.properties</span><span class="cls_004">. In the file located in &lt;TOMCAT_HOME&gt;|shared|classes, you can</span></div>
<div style="position:absolute;left:56.69px;top:480.61px" class="cls_004"><span class="cls_004">find things such as the username and password used to connect to the underlying relational</span></div>
<div style="position:absolute;left:56.69px;top:493.21px" class="cls_004"><span class="cls_004">database, the database driver, and the data directory file path. There are sample properties</span></div>
<div style="position:absolute;left:56.69px;top:505.81px" class="cls_004"><span class="cls_004">in the file called </span><span class="cls_013">alfresco-global.properties.sample</span><span class="cls_004"> located in the same directory.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 63 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:52728px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background079.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The full out of the box </span><span class="cls_013">repository.properties</span><span class="cls_004"> file resides in the JAR file called</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_013"><span class="cls_013">alfresco-repository-5.1.1.jar</span><span class="cls_004"> located in</span></div>
<div style="position:absolute;left:56.69px;top:97.06px" class="cls_013"><span class="cls_013">&lt;TOMCAT_HOME&gt;|webapps|alfresco|WEB-INF|lib</span><span class="cls_004">. To override any of the properties in</span></div>
<div style="position:absolute;left:56.69px;top:110.34px" class="cls_004"><span class="cls_004">that file, add custom values to a file called </span><span class="cls_013">alfresco-global.properties</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:56.69px;top:123.62px" class="cls_013"><span class="cls_013">&lt;TOMCAT_HOME&gt;|shared|classes</span><span class="cls_004">directory or directly in the file included in the repo</span></div>
<div style="position:absolute;left:56.69px;top:136.90px" class="cls_004"><span class="cls_004">module in the directory </span><span class="cls_013">repo|src|main|amp|config|alfresco|module|repo</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:168.18px" class="cls_029"><span class="cls_029">Solution-specific files</span></div>
<div style="position:absolute;left:56.69px;top:187.74px" class="cls_004"><span class="cls_004">There are several types of files that, conceptually, sit on top of the Alfresco platform as a</span></div>
<div style="position:absolute;left:56.69px;top:200.34px" class="cls_004"><span class="cls_004">part of the solution you are implementing with Alfresco. These include files such as content</span></div>
<div style="position:absolute;left:56.69px;top:212.94px" class="cls_004"><span class="cls_004">models, business process definitions, web scripts, server-side JavaScript, and FreeMarker</span></div>
<div style="position:absolute;left:56.69px;top:225.54px" class="cls_004"><span class="cls_004">templates. Alfresco ships several of these with the product in the Alfresco repository and</span></div>
<div style="position:absolute;left:56.69px;top:238.14px" class="cls_004"><span class="cls_004">the Share web applications. Some are purely meant to be used as examples, while others are</span></div>
<div style="position:absolute;left:56.69px;top:250.74px" class="cls_004"><span class="cls_004">functional pieces of the platform. With the exception of content models that can import and</span></div>
<div style="position:absolute;left:56.69px;top:263.34px" class="cls_004"><span class="cls_004">extend Alfresco's out of the box content models, there is no need to extend these files</span></div>
<div style="position:absolute;left:56.69px;top:275.94px" class="cls_004"><span class="cls_004">directly. Instead, your custom versions of these types of files will sit alongside Alfresco's.</span></div>
<div style="position:absolute;left:56.69px;top:297.54px" class="cls_004"><span class="cls_004">These files can live on the file system or in the repository. When they reside on the file</span></div>
<div style="position:absolute;left:56.69px;top:310.14px" class="cls_004"><span class="cls_004">system, they need to be on the classpath. So they should be placed in the </span><span class="cls_007">alfresco|extension</span></div>
<div style="position:absolute;left:56.69px;top:322.78px" class="cls_004"><span class="cls_004">directory. When stored in the repository, each type of file has a designated folder within the</span></div>
<div style="position:absolute;left:56.69px;top:335.38px" class="cls_007"><span class="cls_007">|Company Home|Data Dictionary</span><span class="cls_004"> folder.</span></div>
<div style="position:absolute;left:56.69px;top:357.01px" class="cls_004"><span class="cls_004">For example, suppose you write a JavaScript file to implement the business logic for an</span></div>
<div style="position:absolute;left:56.69px;top:369.61px" class="cls_004"><span class="cls_004">action. Ignoring the details on actions for the moment, you can choose to store that</span></div>
<div style="position:absolute;left:56.69px;top:382.21px" class="cls_004"><span class="cls_004">JavaScript file either on the file system, perhaps in a directory called </span><span class="cls_007">scripts</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:56.69px;top:394.85px" class="cls_013"><span class="cls_013">alfresco|extension</span><span class="cls_004"> directory, or in the repository within the Scripts folder under </span><span class="cls_007">Data</span></div>
<div style="position:absolute;left:56.69px;top:408.13px" class="cls_007"><span class="cls_007">Dictionary</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:429.77px" class="cls_004"><span class="cls_004">Business process definitions can live on the file system and in the repository, but they can</span></div>
<div style="position:absolute;left:56.69px;top:442.37px" class="cls_004"><span class="cls_004">also be deployed directly to the Activiti engine. This will be discussed in the Advanced</span></div>
<div style="position:absolute;left:56.69px;top:454.97px" class="cls_004"><span class="cls_004">Workflow chapter.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 64 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:53404px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background080.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.42px" class="cls_029"><span class="cls_029">Avoid Modifying Alfresco Code and Configuration</span></div>
<div style="position:absolute;left:56.69px;top:88.98px" class="cls_004"><span class="cls_004">It may be tempting to make changes directly to the Alfresco web application. Avoid this</span></div>
<div style="position:absolute;left:56.69px;top:101.59px" class="cls_004"><span class="cls_004">temptation at all costs</span><span class="cls_012">. </span><span class="cls_022">“</span><span class="cls_004">But this is open source,</span><span class="cls_022">”</span><span class="cls_004"> you may say, </span><span class="cls_022">“</span><span class="cls_004">Why can't I change it if I</span></div>
<div style="position:absolute;left:56.69px;top:115.02px" class="cls_004"><span class="cls_004">want to?</span><span class="cls_022">”</span><span class="cls_004">. Yes, it is open source and, yes, you can change it to your heart's content. It will be</span></div>
<div style="position:absolute;left:56.69px;top:128.45px" class="cls_004"><span class="cls_004">up to you to figure out whether a problem is in your code or Alfresco's. You will also have</span></div>
<div style="position:absolute;left:56.69px;top:141.05px" class="cls_004"><span class="cls_004">to devote more time to upgrades than you would have, had you kept your customizations</span></div>
<div style="position:absolute;left:56.69px;top:153.65px" class="cls_004"><span class="cls_004">separate from Alfresco's code.</span></div>
<div style="position:absolute;left:56.69px;top:175.25px" class="cls_004"><span class="cls_004">There are three situations when, try as you might, you may have to touch Alfresco's files.</span></div>
<div style="position:absolute;left:56.69px;top:187.85px" class="cls_004"><span class="cls_004">First, you may identify a bug in the Alfresco source as well as a fix. In this situation, the best</span></div>
<div style="position:absolute;left:56.69px;top:200.45px" class="cls_004"><span class="cls_004">thing to do is to put the fix in place as a temporary measure, file a JIRA ticket, and attach the</span></div>
<div style="position:absolute;left:56.69px;top:213.05px" class="cls_004"><span class="cls_004">fix to the ticket. Alfresco will confirm the bug and implement the fix (sometimes using your</span></div>
<div style="position:absolute;left:56.69px;top:225.65px" class="cls_004"><span class="cls_004">code unchanged and sometimes with its own). Enterprise customers can usually get a patch</span></div>
<div style="position:absolute;left:56.69px;top:238.25px" class="cls_004"><span class="cls_004">right away. Community users may have to run on their own fix until the problem is</span></div>
<div style="position:absolute;left:56.69px;top:250.85px" class="cls_004"><span class="cls_004">resolved in a future build.</span></div>
<div style="position:absolute;left:56.69px;top:272.45px" class="cls_004"><span class="cls_004">The second situation is that sometimes (and this is increasingly rare) there may be a</span></div>
<div style="position:absolute;left:56.69px;top:285.05px" class="cls_004"><span class="cls_004">configuration change or customization that cannot be implemented through the standard</span></div>
<div style="position:absolute;left:56.69px;top:297.65px" class="cls_004"><span class="cls_004">extension mechanism. This is really no different than the previous scenario. If this happens,</span></div>
<div style="position:absolute;left:56.69px;top:310.25px" class="cls_004"><span class="cls_004">treat it like a bug. Make the change then file a ticket. Alfresco's intent is for the product to be</span></div>
<div style="position:absolute;left:56.69px;top:322.85px" class="cls_004"><span class="cls_004">extensible without the need to change the core installation, so anything less than that is a</span></div>
<div style="position:absolute;left:56.69px;top:335.45px" class="cls_004"><span class="cls_004">bug.</span></div>
<div style="position:absolute;left:56.69px;top:357.05px" class="cls_004"><span class="cls_004">The third situation is that you might identify a product enhancement that cannot be</span></div>
<div style="position:absolute;left:56.69px;top:369.65px" class="cls_004"><span class="cls_004">implemented without modifying the source. In this case, it is a very good idea to talk to</span></div>
<div style="position:absolute;left:56.69px;top:382.25px" class="cls_004"><span class="cls_004">Alfresco (either your representative or via the forums) before you start coding, particularly</span></div>
<div style="position:absolute;left:56.69px;top:394.85px" class="cls_004"><span class="cls_004">if it is a big change. They might already be working on the same enhancement. Or, they</span></div>
<div style="position:absolute;left:56.69px;top:407.45px" class="cls_004"><span class="cls_004">might be able to gauge demand for the enhancement as well as provide implementation</span></div>
<div style="position:absolute;left:56.69px;top:420.05px" class="cls_004"><span class="cls_004">advice. If this enhancement is critical to your solution but no one else is interested in it,</span></div>
<div style="position:absolute;left:56.69px;top:432.65px" class="cls_004"><span class="cls_004">you'll have a hard decision to make because it may be a long time before the enhancement</span></div>
<div style="position:absolute;left:56.69px;top:445.25px" class="cls_004"><span class="cls_004">gets incorporated into the product. Moving forward without Alfresco's commitment to</span></div>
<div style="position:absolute;left:56.69px;top:457.85px" class="cls_004"><span class="cls_004">incorporate the enhancement into the product could mean supporting your own fork of the</span></div>
<div style="position:absolute;left:56.69px;top:470.45px" class="cls_004"><span class="cls_004">Alfresco source for the foreseeable future.</span></div>
<div style="position:absolute;left:56.69px;top:509.20px" class="cls_008"><span class="cls_008">Troubleshooting</span></div>
<div style="position:absolute;left:56.69px;top:536.93px" class="cls_004"><span class="cls_004">There are three primary troubleshooting tools you will become intimately familiar with:</span></div>
<div style="position:absolute;left:56.69px;top:549.53px" class="cls_004"><span class="cls_004">Log4j, your favorite Java debugger, and the Alfresco Node Browser. There are other, less-</span></div>
<div style="position:absolute;left:56.69px;top:562.13px" class="cls_004"><span class="cls_004">frequently used tools and techniques that will be discussed when the time is right.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 65 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:54080px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background081.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Log4j</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Most of you are already familiar with this common logging tool, so not a lot of discussion is</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">needed. For everyone else, here are the basics. The verbosity of the log output, the specific</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">classes being logged, and other logging settings are controlled by Log4J property file:</span></div>
<div style="position:absolute;left:56.69px;top:141.78px" class="cls_004"><span class="cls_004">If you are looking at a temporary change, you can update the file </span><span class="cls_013">custom-</span></div>
<div style="position:absolute;left:56.69px;top:155.06px" class="cls_013"><span class="cls_013">log4j.properties</span><span class="cls_004"> in the directory</span></div>
<div style="position:absolute;left:56.69px;top:167.56px" class="cls_013"><span class="cls_013">&lt;TOMCAT_HOME&gt;|shared|classes|alfresco|extension.</span></div>
<div style="position:absolute;left:104.69px;top:189.47px" class="cls_004"><span class="cls_004">Don't forget the JMX option. The JMX interface allows to access Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:202.07px" class="cls_004"><span class="cls_004">Enterprise via a standard JMX console that supports JMX Remoting (JSR-160). It's</span></div>
<div style="position:absolute;left:104.69px;top:214.67px" class="cls_004"><span class="cls_004">a very useful tool to perform on-demand change at runtime without needing to</span></div>
<div style="position:absolute;left:104.69px;top:227.27px" class="cls_004"><span class="cls_004">restart the server.</span></div>
<div style="position:absolute;left:104.69px;top:242.03px" class="cls_004"><span class="cls_004">If you are looking for a more permanent configuration, you can use the</span></div>
<div style="position:absolute;left:104.69px;top:254.63px" class="cls_013"><span class="cls_013">log4j.properties</span><span class="cls_004"> file located in your module in</span></div>
<div style="position:absolute;left:104.69px;top:267.91px" class="cls_013"><span class="cls_013">repo|src|main|amp|config|alfresco|module|repo</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:292.48px" class="cls_004"><span class="cls_004">For example, if you are testing out some server-side JavaScript, you might want to change</span></div>
<div style="position:absolute;left:56.69px;top:305.08px" class="cls_004"><span class="cls_004">the JavaScript-related logger from error to debug like this:</span></div>
<div style="position:absolute;left:74.69px;top:326.00px" class="cls_010"><span class="cls_010">log4j.logger.org.alfresco.repo.jscript=DEBUG</span></div>
<div style="position:absolute;left:56.69px;top:346.48px" class="cls_004"><span class="cls_004">If you want to add your own logger for one of your own Java classes, add a new logger to</span></div>
<div style="position:absolute;left:56.69px;top:359.08px" class="cls_004"><span class="cls_004">the end of the file like this:</span></div>
<div style="position:absolute;left:74.69px;top:380.00px" class="cls_010"><span class="cls_010">log4j.logger.com.someco=DEBUG</span></div>
<div style="position:absolute;left:56.69px;top:400.48px" class="cls_004"><span class="cls_004">Then, within your class, call the logger's methods like this:</span></div>
<div style="position:absolute;left:74.69px;top:421.40px" class="cls_010"><span class="cls_010">public class SetWebFlag extends ActionExecuterAbstractBase {</span></div>
<div style="position:absolute;left:74.69px;top:432.20px" class="cls_010"><span class="cls_010">private static Logger logger = Logger.getLogger(SetWebFlag.class);</span></div>
<div style="position:absolute;left:74.69px;top:443.00px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:74.69px;top:453.80px" class="cls_010"><span class="cls_010">protected void executeImpl(Action action, NodeRefactionedUponNodeRef) {</span></div>
<div style="position:absolute;left:74.69px;top:464.60px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled()) logger.debug("Inside executeImpl");</span></div>
<div style="position:absolute;left:56.69px;top:485.08px" class="cls_004"><span class="cls_004">The call to </span><span class="cls_013">DebugEnabled()</span><span class="cls_004"> isn't required, but it may help a bit with performance.</span></div>
<div style="position:absolute;left:56.69px;top:522.46px" class="cls_014"><span class="cls_014">Step-by-step - debugging from within Eclipse</span></div>
<div style="position:absolute;left:56.69px;top:547.68px" class="cls_004"><span class="cls_004">Like Log4j, stepping through the source code of a web application with a remote debugger</span></div>
<div style="position:absolute;left:56.69px;top:560.28px" class="cls_004"><span class="cls_004">will be familiar to many readers. Just in case it is new to you, this section walks you through</span></div>
<div style="position:absolute;left:56.69px;top:572.88px" class="cls_004"><span class="cls_004">the setup when using STS as your IDE and Alfresco running in a your virtual machine.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 66 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:54756px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background082.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">At a high level, what you are going to do is tell Tomcat to send debug information to a</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">specific port. Then, you will tell STS to listen for that information using the same port. This</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">setup will let you set breakpoints in the source code (both yours and Alfresco's), which will</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">get tripped when the JVM processes a statement that has a breakpoint set.</span></div>
<div style="position:absolute;left:56.69px;top:129.90px" class="cls_004"><span class="cls_004">Follow these steps to set this up:</span></div>
<div style="position:absolute;left:91.32px;top:151.63px" class="cls_004"><span class="cls_004">1. In Tomcat's startup script located in</span></div>
<div style="position:absolute;left:104.69px;top:164.23px" class="cls_013"><span class="cls_013">/opt/alfresco/tomcat/bin/startup.sh</span><span class="cls_004">, change the last line that invokes</span></div>
<div style="position:absolute;left:104.69px;top:177.51px" class="cls_004"><span class="cls_004">Catalina to include </span><span class="cls_013">jpda</span><span class="cls_004">. On Linux, this looks like:</span></div>
<div style="position:absolute;left:128.69px;top:202.08px" class="cls_020"><span class="cls_020">exec</span><span class="cls_030"> "$PRGDIR"/"$EXECUTABLE" jpda start "$@"</span></div>
<div style="position:absolute;left:91.32px;top:222.69px" class="cls_004"><span class="cls_004">2. Start Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:237.45px" class="cls_004"><span class="cls_004">3. In STS, go to the </span><span class="cls_007">Debug Configuration</span><span class="cls_004"> dialog and create a new </span><span class="cls_007">Remote Java</span></div>
<div style="position:absolute;left:104.69px;top:250.09px" class="cls_007"><span class="cls_007">Application.</span><span class="cls_004"> Browse to the project you want to debug. Take the defaults for</span></div>
<div style="position:absolute;left:104.69px;top:262.73px" class="cls_004"><span class="cls_004">everything else:</span></div>
<div style="position:absolute;left:91.32px;top:573.51px" class="cls_004"><span class="cls_004">4. Click </span><span class="cls_007">Debug.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 67 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:55432px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background083.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You are now ready to debug. If you want to try this out on your own, try setting a</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">breakpoint in the HelloWorld webscript. You can navigate to it in STS by going to the </span><span class="cls_007">repo</span></div>
<div style="position:absolute;left:56.69px;top:95.74px" class="cls_004"><span class="cls_004">project, the source folder </span><span class="cls_013">src|main|java</span><span class="cls_004">, in the </span><span class="cls_013">com.someco.repo.demoamp</span><span class="cls_004"> package.</span></div>
<div style="position:absolute;left:56.69px;top:109.02px" class="cls_004"><span class="cls_004">Once you've found the </span><span class="cls_013">executeImpl </span><span class="cls_004">method in the HelloWorldWebScript Java source,</span></div>
<div style="position:absolute;left:56.69px;top:122.30px" class="cls_004"><span class="cls_004">double-click the left margin to set a breakpoint. The checkmark that appears as part of the</span></div>
<div style="position:absolute;left:56.69px;top:134.90px" class="cls_004"><span class="cls_004">breakpoint indicates that this breakpoint is enabled and the class is loaded:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 68 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:56108px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background084.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Now open the HelloWorld webscript URL</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">(</span><a href="http://127.0.0.1:8080/alfresco/s/sample/helloworld/">http://127.0.0.1:8080/alfresco/s/sample/helloworld</a> <span class="cls_004">) in your browser. STS will</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">launch the Debugger perspective. You can then step through the source line by line using</span></div>
<div style="position:absolute;left:56.69px;top:108.98px" class="cls_004"><span class="cls_004">the </span><span class="cls_007">bouncing arrow</span><span class="cls_004"> icons or click the </span><span class="cls_007">green arrow</span><span class="cls_004"> to continue to the next breakpoint:</span></div>
<div style="position:absolute;left:122.09px;top:417.39px" class="cls_004"><span class="cls_004">If you run Alfresco directly from Maven, you can use the command</span></div>
<div style="position:absolute;left:122.09px;top:429.99px" class="cls_004"><span class="cls_004">mvnDebug to start Alfresco in DEBUG mode automatically:</span></div>
<div style="position:absolute;left:122.09px;top:441.91px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/alfresco-sdk-rad-eclipse-remote-debugging.html">http://docs.alfresco.com/5.1/tasks/alfresco-sdk-rad-eclipse-remo</a> </div>
<div style="position:absolute;left:122.09px;top:452.71px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/alfresco-sdk-rad-eclipse-remote-debugging.html">te-debugging.html</a> </div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 69 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:56784px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background085.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Node browser</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">The Alfresco Node Browser is accessible via Alfresco or Share. If you want to use the one</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">embedded in Alfresco (be aware that it's available only in the enterprise version):</span></div>
<div style="position:absolute;left:104.69px;top:129.31px" class="cls_004"><span class="cls_004">Open the Alfresco webapp (</span><a href="http://127.0.0.1:8080/alfresco/">http://127.0.0.1:8080/alfresco/</a> <span class="cls_004">)</span></div>
<div style="position:absolute;left:104.69px;top:144.75px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_013">Alfresco Administration Console (admin only)</span></div>
<div style="position:absolute;left:104.69px;top:160.19px" class="cls_004"><span class="cls_004">In the left menu, click on </span><span class="cls_013">Support Tools|Node Browser</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 70 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:57460px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background086.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you want to use the one embedded in Alfresco Share:</span></div>
<div style="position:absolute;left:104.69px;top:92.23px" class="cls_004"><span class="cls_004">Open the Alfresco webapp (</span><a href="http://127.0.0.1:8080/share/">http://127.0.0.1:8080/share/</a> <span class="cls_004">)</span></div>
<div style="position:absolute;left:104.69px;top:107.67px" class="cls_004"><span class="cls_004">In the top menu, click on </span><span class="cls_013">Admin Tools</span></div>
<div style="position:absolute;left:104.69px;top:123.11px" class="cls_004"><span class="cls_004">In the left menu, click on </span><span class="cls_013">Tools|Node Browser</span></div>
<div style="position:absolute;left:56.69px;top:395.60px" class="cls_004"><span class="cls_004">The Node Browser lets you navigate through the low-level representation of the repository.</span></div>
<div style="position:absolute;left:56.69px;top:408.20px" class="cls_004"><span class="cls_004">Even if you'll use mainly use the store </span><span class="cls_013">workspace://SpacesStore</span><span class="cls_004">, you'll be able to</span></div>
<div style="position:absolute;left:56.69px;top:421.48px" class="cls_004"><span class="cls_004">discover the other available stores. This browser displays useful information about each</span></div>
<div style="position:absolute;left:56.69px;top:434.08px" class="cls_004"><span class="cls_004">node such as its path, unique ID, node reference, type, list of aspects and properties. If you</span></div>
<div style="position:absolute;left:56.69px;top:446.68px" class="cls_004"><span class="cls_004">have an issue on a node, this will be THE tool that you'll need to investigate.</span></div>
<div style="position:absolute;left:56.69px;top:468.28px" class="cls_004"><span class="cls_004">Besides being able to navigate the hierarchy, the Node Browser also provides a search box.</span></div>
<div style="position:absolute;left:56.69px;top:480.88px" class="cls_004"><span class="cls_004">If you know a node's reference, you can go right to it using the Node Browser's search tool.</span></div>
<div style="position:absolute;left:56.69px;top:493.48px" class="cls_004"><span class="cls_004">The search box is also handy for testing out Lucene, Xpath, CMIS SQL-like queries (and</span></div>
<div style="position:absolute;left:56.69px;top:506.08px" class="cls_004"><span class="cls_004">many more</span><span class="cls_022">…</span><span class="cls_004">).</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 71 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:58136px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background087.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Starting over</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">During development, it is quite common to have to start with a fresh repository. Usually</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">this is because you've made a significant change to the model, and you'd rather blow</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">everything away than clean up inconsistencies. The Alfresco repository is made up of three</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">parts: the metadata stored in the relational database, the binary files stored on the file</span></div>
<div style="position:absolute;left:56.69px;top:147.78px" class="cls_004"><span class="cls_004">system and the Solr indexes. To clear out the repository, you have to clear out all three. If</span></div>
<div style="position:absolute;left:56.69px;top:160.38px" class="cls_004"><span class="cls_004">you delete the data directory but not the database, you will see a bunch of data integrity</span></div>
<div style="position:absolute;left:56.69px;top:172.98px" class="cls_004"><span class="cls_004">problems because the binary files that the database knows about are no longer there. Be</span></div>
<div style="position:absolute;left:56.69px;top:185.58px" class="cls_004"><span class="cls_004">sure that Alfresco is stopped.</span></div>
<div style="position:absolute;left:56.69px;top:207.18px" class="cls_004"><span class="cls_004">Let's start by the database:</span></div>
<div style="position:absolute;left:91.32px;top:228.91px" class="cls_004"><span class="cls_004">1. Start PostgreSQL: </span><span class="cls_013">service alfresco start postgresql</span></div>
<div style="position:absolute;left:91.32px;top:244.35px" class="cls_004"><span class="cls_004">2. Recreate the database:</span></div>
<div style="position:absolute;left:117.89px;top:267.56px" class="cls_010"><span class="cls_010">/opt/alfresco/postgresql/bin/psql -U postgres</span></div>
<div style="position:absolute;left:117.89px;top:278.36px" class="cls_010"><span class="cls_010">Password for user postgres: admin</span></div>
<div style="position:absolute;left:117.89px;top:289.16px" class="cls_010"><span class="cls_010">postgres=#DROP DATABASE alfresco;</span></div>
<div style="position:absolute;left:117.89px;top:299.96px" class="cls_010"><span class="cls_010">postgres=#CREATE DATABASE alfresco WITH OWNER alfresco;</span></div>
<div style="position:absolute;left:117.89px;top:310.76px" class="cls_010"><span class="cls_010">postgres=# \q</span></div>
<div style="position:absolute;left:91.32px;top:331.37px" class="cls_004"><span class="cls_004">3. Then, let's delete the binary folders:</span></div>
<div style="position:absolute;left:117.89px;top:354.58px" class="cls_010"><span class="cls_010">rm -rf/opt/alfresco/alf_data/contentstore/*</span></div>
<div style="position:absolute;left:117.89px;top:365.38px" class="cls_010"><span class="cls_010">rm -rf/opt/alfresco/alf_data/contentstore.deleted/*</span></div>
<div style="position:absolute;left:91.32px;top:385.99px" class="cls_004"><span class="cls_004">4. And finally, the Solr indexes:</span></div>
<div style="position:absolute;left:117.89px;top:409.20px" class="cls_010"><span class="cls_010">rm -rf/opt/alfresco/alf_data/solr4/*</span></div>
<div style="position:absolute;left:56.69px;top:429.68px" class="cls_004"><span class="cls_004">You can now restart Alfresco and your instance should be the same as a fresh installation.</span></div>
<div style="position:absolute;left:122.09px;top:451.28px" class="cls_004"><span class="cls_004">If you run Alfresco directly from Maven, you can use the purge profile.</span></div>
<div style="position:absolute;left:122.09px;top:463.88px" class="cls_004"><span class="cls_004">Just type mvn clean -Ppurge and it will delete the database, the content</span></div>
<div style="position:absolute;left:122.09px;top:476.48px" class="cls_004"><span class="cls_004">stores, the index files and the log files:</span></div>
<div style="position:absolute;left:122.09px;top:488.40px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/alfresco-sdk-cmd-reference-repo-amp.html">http://docs.alfresco.com/5.1/concepts/alfresco-sdk-cmd-reference</a> </div>
<div style="position:absolute;left:122.09px;top:499.20px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/alfresco-sdk-cmd-reference-repo-amp.html">-repo-amp.html</a> </div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 72 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:58812px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background088.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Getting Started with Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">This chapter was about getting your development environment ready to go, providing an</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">overview of how the platform is extended, and understanding the debugging tools that are</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">available. Specifically, you learned what is the Alfresco Maven SDK and which archetypes</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">are available. We discovered how to install STS, and all-prerequisites to be able to use the</span></div>
<div style="position:absolute;left:56.69px;top:147.78px" class="cls_004"><span class="cls_004">Alfresco archetypes. Then, we did our first steps extending Alfresco without modifying</span></div>
<div style="position:absolute;left:56.69px;top:160.38px" class="cls_004"><span class="cls_004">Alfresco's source code or configuration. You learned the specific extension technique to use</span></div>
<div style="position:absolute;left:56.69px;top:172.98px" class="cls_004"><span class="cls_004">depending on the type of file being customized.</span></div>
<div style="position:absolute;left:56.69px;top:194.58px" class="cls_004"><span class="cls_004">We learnt what to do when things inevitably go wrong. Familiar techniques such as log4j</span></div>
<div style="position:absolute;left:56.69px;top:207.18px" class="cls_004"><span class="cls_004">and remote debugging are available, just as they would be with any web application. In</span></div>
<div style="position:absolute;left:56.69px;top:219.78px" class="cls_004"><span class="cls_004">addition, the Node Browser can be a useful tool for inspecting the underlying data structure</span></div>
<div style="position:absolute;left:56.69px;top:232.38px" class="cls_004"><span class="cls_004">or testing out search queries.</span></div>
<div style="position:absolute;left:56.69px;top:253.98px" class="cls_004"><span class="cls_004">And we terminated the chapter by understanding how to start clean for testing or</span></div>
<div style="position:absolute;left:56.69px;top:266.58px" class="cls_004"><span class="cls_004">debugging purposes. You learned that dropping and recreating the database as well as</span></div>
<div style="position:absolute;left:56.69px;top:279.18px" class="cls_004"><span class="cls_004">clearing out the data directory followed by a Tomcat restart will always give you a</span></div>
<div style="position:absolute;left:56.69px;top:291.78px" class="cls_004"><span class="cls_004">sparkling new repository to work with.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 73 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:59488px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background089.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">3</span></div>
<div style="position:absolute;left:94.60px;top:167.48px" class="cls_011"><span class="cls_011">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">From setting up the initial content model to programmatically creating, searching for, and</span></div>
<div style="position:absolute;left:56.69px;top:239.07px" class="cls_004"><span class="cls_004">deleting content, how you work with the content in a content management system is a</span></div>
<div style="position:absolute;left:56.69px;top:251.67px" class="cls_004"><span class="cls_004">foundational concept upon which the rest of the solution is built. In this chapter, you'll</span></div>
<div style="position:absolute;left:56.69px;top:264.27px" class="cls_004"><span class="cls_004">learn:</span></div>
<div style="position:absolute;left:104.69px;top:286.00px" class="cls_004"><span class="cls_004">What a repository is and how it is structured</span></div>
<div style="position:absolute;left:104.69px;top:300.76px" class="cls_004"><span class="cls_004">How to make the underlying content model relevant to your business problem by</span></div>
<div style="position:absolute;left:104.69px;top:313.36px" class="cls_004"><span class="cls_004">extending Alfresco's out of the box model with your own content types</span></div>
<div style="position:absolute;left:104.69px;top:328.12px" class="cls_004"><span class="cls_004">What practices are the best for creating your own content models</span></div>
<div style="position:absolute;left:104.69px;top:342.88px" class="cls_004"><span class="cls_004">How to configure Alfresco Share to expose your custom content model via the</span></div>
<div style="position:absolute;left:104.69px;top:355.48px" class="cls_004"><span class="cls_004">user interface</span></div>
<div style="position:absolute;left:104.69px;top:370.24px" class="cls_004"><span class="cls_004">How to interact with the repository via the CMIS and JavaScript APIs</span></div>
<div style="position:absolute;left:56.69px;top:411.28px" class="cls_008"><span class="cls_008">Defining SomeCo's content model</span></div>
<div style="position:absolute;left:56.69px;top:439.01px" class="cls_004"><span class="cls_004">Recall from </span><span class="cls_010">Chapter 1</span><span class="cls_004">, </span><span class="cls_012">The Alfresco Platform</span><span class="cls_004">, that SomeCo is rolling out Alfresco across the</span></div>
<div style="position:absolute;left:56.69px;top:451.99px" class="cls_004"><span class="cls_004">organization. Each department has its own type of content to work with and different</span></div>
<div style="position:absolute;left:56.69px;top:464.59px" class="cls_004"><span class="cls_004">requirements for how it works with that content. SomeCo could just start uploading content</span></div>
<div style="position:absolute;left:56.69px;top:477.19px" class="cls_004"><span class="cls_004">into Alfresco. That would be better than nothing, but it doesn't take advantage of the full</span></div>
<div style="position:absolute;left:56.69px;top:489.79px" class="cls_004"><span class="cls_004">power of the platform, and makes for a really boring (and short) book. SomeCo would be</span></div>
<div style="position:absolute;left:56.69px;top:502.39px" class="cls_004"><span class="cls_004">better off formalizing the different types of content it works with by extending the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:514.99px" class="cls_004"><span class="cls_004">content model to make it SomeCo-specific.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:60164px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background090.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - starting the custom content model</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">with custom types</span></div>
<div style="position:absolute;left:56.69px;top:116.58px" class="cls_004"><span class="cls_004">Let's start small and build the model up over successive examples. First, let's create a</span></div>
<div style="position:absolute;left:56.69px;top:129.18px" class="cls_004"><span class="cls_004">custom content type for Whitepapers, which are a type of marketing document. This is</span></div>
<div style="position:absolute;left:56.69px;top:141.78px" class="cls_004"><span class="cls_004">going to involve creating a content model file, which is expressed as XML, and then telling</span></div>
<div style="position:absolute;left:56.69px;top:154.38px" class="cls_004"><span class="cls_004">Alfresco where to find it using a Spring bean configuration file. The Alfresco repository</span></div>
<div style="position:absolute;left:56.69px;top:166.98px" class="cls_004"><span class="cls_004">Maven archetype already includes a custom content model. We are just going to re-use it.</span></div>
<div style="position:absolute;left:122.09px;top:188.58px" class="cls_004"><span class="cls_004">Be aware that Alfresco provides as well a Model Manger that allows you</span></div>
<div style="position:absolute;left:122.09px;top:201.18px" class="cls_004"><span class="cls_004">to create a custom content model (and the relevant forms) directly from</span></div>
<div style="position:absolute;left:122.09px;top:213.78px" class="cls_004"><span class="cls_004">Alfresco Share. However, we want to explain you in this book the</span></div>
<div style="position:absolute;left:122.09px;top:226.38px" class="cls_004"><span class="cls_004">underlying concepts of a content model, so we'll create the XML content</span></div>
<div style="position:absolute;left:122.09px;top:238.98px" class="cls_004"><span class="cls_004">model file manually. You can find more information about the Model</span></div>
<div style="position:absolute;left:122.09px;top:251.58px" class="cls_004"><span class="cls_004">Manager on this page:</span></div>
<div style="position:absolute;left:122.09px;top:263.50px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/admintools-cmm-intro.html">http://docs.alfresco.com/5.1/concepts/admintools-cmm-intro.html</a> </div>
<div style="position:absolute;left:56.69px;top:283.98px" class="cls_004"><span class="cls_004">To start the content model, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:305.71px" class="cls_004"><span class="cls_004">1. Edit the file </span><span class="cls_013">bootstrap-context.xml</span><span class="cls_004"> located in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004">  |</span></div>
<div style="position:absolute;left:104.69px;top:318.99px" class="cls_013"><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">context</span><span class="cls_004">. A custom model context file is</span></div>
<div style="position:absolute;left:104.69px;top:332.27px" class="cls_004"><span class="cls_004">a Spring bean configuration file. Spring bean configuration files were also</span></div>
<div style="position:absolute;left:104.69px;top:344.88px" class="cls_004"><span class="cls_004">discussed in </span><span class="cls_010">Chapter 2</span><span class="cls_004">, </span><span class="cls_012">Getting Started with Alfresco</span><span class="cls_004">. Remove the reference to the</span></div>
<div style="position:absolute;left:104.69px;top:357.86px" class="cls_004"><span class="cls_004">file </span><span class="cls_013">content-model.xml</span><span class="cls_004">, and replace it by </span><span class="cls_013">scModel.xml</span><span class="cls_004">. Your file should</span></div>
<div style="position:absolute;left:104.69px;top:371.14px" class="cls_004"><span class="cls_004">contain:</span></div>
<div style="position:absolute;left:117.89px;top:394.35px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:405.15px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN'</span></div>
<div style="position:absolute;left:139.49px;top:415.95px" class="cls_010"><span class="cls_010">'</span><a href="http://www.springframework.org/dtd/spring-beans.dtd&#39;/">http://www.springframework.org/dtd/spring-beans.dtd'</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:426.75px" class="cls_010"><span class="cls_010">&lt;beans&gt;</span></div>
<div style="position:absolute;left:139.49px;top:437.55px" class="cls_010"><span class="cls_010">&lt;!-- Registration of new models --&gt;</span></div>
<div style="position:absolute;left:139.49px;top:448.35px" class="cls_010"><span class="cls_010">&lt;bean id="repo.dictionaryBootstrap"</span></div>
<div style="position:absolute;left:161.09px;top:459.15px" class="cls_010"><span class="cls_010">parent="dictionaryModelBootstrap"</span></div>
<div style="position:absolute;left:161.09px;top:469.95px" class="cls_010"><span class="cls_010">depends-on="dictionaryBootstrap"&gt;</span></div>
<div style="position:absolute;left:155.69px;top:491.55px" class="cls_010"><span class="cls_010">&lt;property name="models"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:502.35px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:182.69px;top:513.15px" class="cls_010"><span class="cls_010">&lt;value&gt;</span></div>
<div style="position:absolute;left:204.29px;top:523.95px" class="cls_010"><span class="cls_010">alfresco/module/${project.artifactId}</span></div>
<div style="position:absolute;left:204.29px;top:534.75px" class="cls_010"><span class="cls_010">/model/scModel.xml</span></div>
<div style="position:absolute;left:188.09px;top:545.55px" class="cls_010"><span class="cls_010">&lt;/value&gt;</span></div>
<div style="position:absolute;left:188.09px;top:556.35px" class="cls_010"><span class="cls_010">&lt;value&gt;</span></div>
<div style="position:absolute;left:204.29px;top:567.15px" class="cls_010"><span class="cls_010">alfresco/module/${project.artifactId}</span></div>
<div style="position:absolute;left:204.29px;top:577.95px" class="cls_010"><span class="cls_010">/model/workflow-model.xml</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 75 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:60840px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background091.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:188.09px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/value&gt;</span></div>
<div style="position:absolute;left:177.29px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:161.09px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:113.02px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:91.32px;top:133.63px" class="cls_004"><span class="cls_004">2.</span></div>
<div style="position:absolute;left:104.69px;top:133.63px" class="cls_004"><span class="cls_004">Create a model file that implements the custom content model. We'll create it in</span></div>
<div style="position:absolute;left:104.69px;top:146.23px" class="cls_004"><span class="cls_004">the same folder as existing ones, that is </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:159.51px" class="cls_013"><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">model</span><span class="cls_004">. Create a new XML file in the model</span></div>
<div style="position:absolute;left:104.69px;top:172.79px" class="cls_004"><span class="cls_004">directory called </span><span class="cls_013">scModel.xml</span><span class="cls_004"> (this name matches the value specified in the</span></div>
<div style="position:absolute;left:104.69px;top:186.07px" class="cls_013"><span class="cls_013">bootstrap-context.xml</span><span class="cls_004"> file). The sample file called </span><span class="cls_013">content-model.xml </span><span class="cls_004">can</span></div>
<div style="position:absolute;left:104.69px;top:199.35px" class="cls_004"><span class="cls_004">be kept in the same folder. This one won't be loaded because it's not listed in the</span></div>
<div style="position:absolute;left:104.69px;top:211.95px" class="cls_004"><span class="cls_004">bean that we created previously.</span></div>
<div style="position:absolute;left:91.32px;top:226.71px" class="cls_004"><span class="cls_004">3.</span></div>
<div style="position:absolute;left:104.69px;top:226.71px" class="cls_004"><span class="cls_004">Add the following XML that is used to describe the model, import other models</span></div>
<div style="position:absolute;left:104.69px;top:239.31px" class="cls_004"><span class="cls_004">that this model extends, and declare the model's namespace:</span></div>
<div style="position:absolute;left:117.89px;top:262.52px" class="cls_010"><span class="cls_010">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:273.32px" class="cls_010"><span class="cls_010">&lt;!-- Definition of new Model --&gt;</span></div>
<div style="position:absolute;left:139.49px;top:284.12px" class="cls_010"><span class="cls_010">&lt;model name="sc:somecomodel"</span></div>
<div style="position:absolute;left:161.09px;top:294.92px" class="cls_010"><span class="cls_010">xmlns="</span><a href="http://www.alfresco.org/model/dictionary/1.0" "="">http://www.alfresco.org/model/dictionary/1.0"</a>&gt;</div>
<div style="position:absolute;left:139.49px;top:316.52px" class="cls_010"><span class="cls_010">&lt;!-- Optional meta-data about the model --&gt;</span></div>
<div style="position:absolute;left:161.09px;top:327.32px" class="cls_010"><span class="cls_010">&lt;description&gt;Someco Model&lt;/description&gt;</span></div>
<div style="position:absolute;left:161.09px;top:338.12px" class="cls_010"><span class="cls_010">&lt;author&gt;Optaros&lt;/author&gt;</span></div>
<div style="position:absolute;left:161.09px;top:348.92px" class="cls_010"><span class="cls_010">&lt;version&gt;1.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:139.49px;top:370.52px" class="cls_010"><span class="cls_010">&lt;!-- Imports are required to allow references to</span></div>
<div style="position:absolute;left:161.09px;top:381.32px" class="cls_010"><span class="cls_010">definitions in other models --&gt;</span></div>
<div style="position:absolute;left:161.09px;top:392.12px" class="cls_010"><span class="cls_010">&lt;imports&gt;</span></div>
<div style="position:absolute;left:166.49px;top:413.72px" class="cls_010"><span class="cls_010">&lt;!-- Import Alfresco Dictionary Definitions --&gt;</span></div>
<div style="position:absolute;left:166.49px;top:424.52px" class="cls_010"><span class="cls_010">&lt;import uri="</span><a href="http://www.alfresco.org/model/">http://www.alfresco.org/model</a> </div>
<div style="position:absolute;left:166.49px;top:435.32px" class="cls_010"><span class="cls_010">/dictionary/1.0" prefix="d" /&gt;</span></div>
<div style="position:absolute;left:166.49px;top:456.92px" class="cls_010"><span class="cls_010">&lt;!-- Import Alfresco Content Domain Model Definitions --&gt;</span></div>
<div style="position:absolute;left:166.49px;top:467.72px" class="cls_010"><span class="cls_010">&lt;import uri="</span><a href="http://www.alfresco.org/model/">http://www.alfresco.org/model</a> </div>
<div style="position:absolute;left:171.89px;top:478.52px" class="cls_010"><span class="cls_010">/content/1.0" prefix="cm" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:500.12px" class="cls_010"><span class="cls_010">&lt;/imports&gt;</span></div>
<div style="position:absolute;left:139.49px;top:521.72px" class="cls_010"><span class="cls_010">&lt;!-- Introduction of new namespaces defined by this model --&gt;</span></div>
<div style="position:absolute;left:161.09px;top:532.52px" class="cls_010"><span class="cls_010">&lt;namespaces&gt;</span></div>
<div style="position:absolute;left:182.69px;top:543.32px" class="cls_010"><span class="cls_010">&lt;namespace uri="</span><a href="http://www.someco.com/model/">http://www.someco.com/model</a> </div>
<div style="position:absolute;left:188.09px;top:554.12px" class="cls_010"><span class="cls_010">/content/1.0" prefix="sc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:564.92px" class="cls_010"><span class="cls_010">&lt;/namespaces&gt;</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 76 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:61516px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background092.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Next, add the types. A </span><span class="cls_007">whitepaper</span><span class="cls_004"> is a type of marketing document that, in turn,</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">is only one of several types of content SomeCo deals with. It's a hierarchy</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">(summarized in next diagram). That hierarchy will be reflected in the model.</span></div>
<div style="position:absolute;left:104.69px;top:108.34px" class="cls_004"><span class="cls_004">Creating a base content type for a company is a really common and</span></div>
<div style="position:absolute;left:104.69px;top:120.94px" class="cls_004"><span class="cls_004">recommended pattern. Add this XML to the model file below the </span><span class="cls_013">namespaces</span></div>
<div style="position:absolute;left:104.69px;top:134.22px" class="cls_004"><span class="cls_004">element:</span></div>
<div style="position:absolute;left:117.89px;top:157.43px" class="cls_010"><span class="cls_010">&lt;types&gt;</span></div>
<div style="position:absolute;left:139.49px;top:168.23px" class="cls_010"><span class="cls_010">&lt;!-- Enterprise-wide generic document type --&gt;</span></div>
<div style="position:absolute;left:139.49px;top:179.03px" class="cls_010"><span class="cls_010">&lt;type name="sc:doc"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:189.83px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:161.09px;top:200.63px" class="cls_010"><span class="cls_010">&lt;parent&gt;cm:content&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:222.23px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:139.49px;top:243.83px" class="cls_010"><span class="cls_010">&lt;type name="sc:marketingDoc"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:254.63px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Marketing Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:161.09px;top:265.43px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:doc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:276.23px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:139.49px;top:297.83px" class="cls_010"><span class="cls_010">&lt;type name="sc:whitepaper"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:308.63px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Whitepaper&lt;/title&gt;</span></div>
<div style="position:absolute;left:161.09px;top:319.43px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:marketingDoc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:330.23px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:96.29px;top:351.83px" class="cls_010"><span class="cls_010">&lt;/types&gt;</span></div>
<div style="position:absolute;left:91.32px;top:372.44px" class="cls_004"><span class="cls_004">5. Be sure to close the model tag so the XML is valid.</span></div>
<div style="position:absolute;left:117.89px;top:395.65px" class="cls_010"><span class="cls_010">&lt;/model&gt;</span></div>
<div style="position:absolute;left:91.32px;top:416.26px" class="cls_004"><span class="cls_004">6. Now, we need to package our module using Maven as explained in the previous</span></div>
<div style="position:absolute;left:104.69px;top:428.86px" class="cls_004"><span class="cls_004">chapter. If you want to package it quickly, you can skip the tests for the moment.</span></div>
<div style="position:absolute;left:104.69px;top:441.46px" class="cls_004"><span class="cls_004">You just need to run the following command: </span><span class="cls_013">mvn clean package -</span></div>
<div style="position:absolute;left:104.69px;top:454.74px" class="cls_013"><span class="cls_013">DskipTests=true</span><span class="cls_004">. When you created your file </span><span class="cls_013">repo-1.0-SNAPSHOT.amp</span><span class="cls_004">, you</span></div>
<div style="position:absolute;left:104.69px;top:468.02px" class="cls_004"><span class="cls_004">can move it to your virtual machine (using FileZilla for example).</span></div>
<div style="position:absolute;left:122.09px;top:491.91px" class="cls_004"><span class="cls_004">Before deploying on your virtual machine or any server, it's quite common</span></div>
<div style="position:absolute;left:122.09px;top:504.51px" class="cls_004"><span class="cls_004">that developers wants to run and to test their code in their local machine</span></div>
<div style="position:absolute;left:122.09px;top:517.11px" class="cls_004"><span class="cls_004">first. As explained in the previous chapter, you just need to use the profile</span></div>
<div style="position:absolute;left:122.09px;top:528.93px" class="cls_013"><span class="cls_013">amp-to-war</span></div>
<div style="position:absolute;left:122.09px;top:541.71px" class="cls_004"><span class="cls_004">(</span><a href="http://docs.alfresco.com/5.1/concepts/alfresco-sdk-cmd-reference-repo-amp.html">http://docs.alfresco.com/5.1/concepts/alfresco-sdk-cmd-referenc</a> </div>
<div style="position:absolute;left:122.09px;top:554.69px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/alfresco-sdk-cmd-reference-repo-amp.html">e-repo-amp.html</a> <span class="cls_004">) or just use the </span><span class="cls_013">run.sh</span><span class="cls_004"> or </span><span class="cls_013">run.bat</span><span class="cls_004"> file that will do it for</span></div>
<div style="position:absolute;left:122.09px;top:567.97px" class="cls_004"><span class="cls_004">you.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 77 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:62192px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background093.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Stop Alfresco.</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">service alfresco stop</span></div>
<div style="position:absolute;left:91.32px;top:114.32px" class="cls_004"><span class="cls_004">8. The final step is to deploy the changes and then restart Tomcat so that Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:126.92px" class="cls_004"><span class="cls_004">will load the custom model. Copy the amp file </span><span class="cls_013">repo-1.0-SNAPSHOT.amp</span><span class="cls_004"> to the</span></div>
<div style="position:absolute;left:104.69px;top:140.20px" class="cls_004"><span class="cls_004">folder </span><span class="cls_013">/opt/alfresco-one/amps</span><span class="cls_004">. Execute the bash script that install the AMP</span></div>
<div style="position:absolute;left:104.69px;top:153.48px" class="cls_004"><span class="cls_004">file.</span></div>
<div style="position:absolute;left:117.89px;top:176.69px" class="cls_010"><span class="cls_010">sh /opt/alfresco-one/bin/apply_amps.sh</span></div>
<div style="position:absolute;left:91.32px;top:197.30px" class="cls_004"><span class="cls_004">9. Restart Tomcat.</span></div>
<div style="position:absolute;left:117.89px;top:220.51px" class="cls_010"><span class="cls_010">service alfresco start</span></div>
<div style="position:absolute;left:56.69px;top:240.99px" class="cls_004"><span class="cls_004">Watch the log during the restart. You should see no errors related to loading the custom</span></div>
<div style="position:absolute;left:56.69px;top:253.59px" class="cls_004"><span class="cls_004">model. If there is a problem, the message usually looks something like </span><span class="cls_013">Could not import</span></div>
<div style="position:absolute;left:56.69px;top:266.87px" class="cls_013"><span class="cls_013">bootstrap model</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:289.15px" class="cls_004"><span class="cls_004">With this change in place, the repository is now capable of telling the difference between a</span></div>
<div style="position:absolute;left:56.69px;top:301.75px" class="cls_004"><span class="cls_004">generic piece of content and SomeCo-specific pieces of content such as marketing</span></div>
<div style="position:absolute;left:56.69px;top:314.35px" class="cls_004"><span class="cls_004">documents and whitepapers.</span></div>
<div style="position:absolute;left:56.69px;top:335.95px" class="cls_004"><span class="cls_004">You can easily check that your module is properly installed in your Alfresco repository, just</span></div>
<div style="position:absolute;left:56.69px;top:348.55px" class="cls_004"><span class="cls_004">open your browser on the following URL</span></div>
<div style="position:absolute;left:56.69px;top:361.15px" class="cls_013"><span class="cls_013">http://localhost:8080/alfresco/s/api/dictionary</span><span class="cls_004">. This webscript lists all aspects</span></div>
<div style="position:absolute;left:56.69px;top:374.43px" class="cls_004"><span class="cls_004">and type definitions available in your repository. You'll find that the JSON object returns</span></div>
<div style="position:absolute;left:56.69px;top:387.03px" class="cls_004"><span class="cls_004">the following three types: </span><span class="cls_007">sc:doc</span><span class="cls_004">, </span><span class="cls_007">sc:whitepaper</span><span class="cls_004">, and </span><span class="cls_007">sc:marketingDoc</span><span class="cls_004">. You can as well use</span></div>
<div style="position:absolute;left:56.69px;top:399.67px" class="cls_004"><span class="cls_004">the following URL that will show you only the types defined in the SomeCo content model:</span></div>
<div style="position:absolute;left:56.69px;top:411.49px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/s/api/classes?nsp=sc/">http://localhost:8080/alfresco/s/api/classes?nsp=sc</a> </div>
<div style="position:absolute;left:56.69px;top:446.31px" class="cls_023"><span class="cls_023">Types</span></div>
<div style="position:absolute;left:56.69px;top:469.03px" class="cls_004"><span class="cls_004">Types are like types or classes in programming languages. They can be used to model</span></div>
<div style="position:absolute;left:56.69px;top:481.63px" class="cls_004"><span class="cls_004">business objects, they have properties, and they can inherit from a parent type. </span><span class="cls_022">“</span><span class="cls_004">Content</span><span class="cls_022">”</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:495.06px" class="cls_022"><span class="cls_022">“</span><span class="cls_004">Person</span><span class="cls_022">”</span><span class="cls_004">, and </span><span class="cls_022">“</span><span class="cls_004">Folder</span><span class="cls_022">”</span><span class="cls_004"> are three important types defined out of the box. Examples include</span></div>
<div style="position:absolute;left:56.69px;top:508.49px" class="cls_004"><span class="cls_004">things such as </span><span class="cls_022">“</span><span class="cls_004">Expense Report</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Medical Record</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Movie</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Song</span><span class="cls_022">”</span><span class="cls_004">, and </span><span class="cls_022">“</span><span class="cls_004">Comment</span><span class="cls_022">”</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 78 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:62868px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background094.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Did you notice the names of the types you created in the example? Names are made unique</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">across the repository by using a namespace specific to the model. The namespace has an</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">abbreviation. The model you created for SomeCo defines a custom model, which declares a</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">namespace with the URI of </span><a href="http://www.someco.com/model/content/1.0">http://www.someco.com/model/content/1.0</a> <span class="cls_004"> and a prefix of </span><span class="cls_013">sc</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:121.58px" class="cls_004"><span class="cls_004">Any type defined as a part of the model will have a name prefixed with </span><span class="cls_013">sc:</span><span class="cls_004">. Using</span></div>
<div style="position:absolute;left:56.69px;top:134.86px" class="cls_004"><span class="cls_004">namespaces in this way helps to prevent name collisions when content models are shared</span></div>
<div style="position:absolute;left:56.69px;top:147.46px" class="cls_004"><span class="cls_004">across repositories.</span></div>
<div style="position:absolute;left:56.69px;top:182.11px" class="cls_023"><span class="cls_023">Properties and property types</span></div>
<div style="position:absolute;left:56.69px;top:204.82px" class="cls_004"><span class="cls_004">Properties are pieces of metadata associated with a particular class, both type and aspect are</span></div>
<div style="position:absolute;left:56.69px;top:217.42px" class="cls_004"><span class="cls_004">classes. In the following example, the property is the marketing campaign. The properties of</span></div>
<div style="position:absolute;left:56.69px;top:230.02px" class="cls_004"><span class="cls_004">a SomeCo Expense Report might include things such as </span><span class="cls_022">“</span><span class="cls_004">Employee Name</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Date</span></div>
<div style="position:absolute;left:56.69px;top:243.45px" class="cls_004"><span class="cls_004">submitted</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Project</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Client</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Expense Report Number</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">Total amount</span><span class="cls_022">”</span><span class="cls_004">, and </span><span class="cls_022">“</span><span class="cls_004">Currency</span><span class="cls_022">”</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:256.88px" class="cls_004"><span class="cls_004">The Expense Report might also include a </span><span class="cls_022">“</span><span class="cls_004">content</span><span class="cls_022">”</span><span class="cls_004"> property to hold the actual expense</span></div>
<div style="position:absolute;left:56.69px;top:270.31px" class="cls_004"><span class="cls_004">report file (maybe it is a PDF or an Excel spreadsheet, for example).</span></div>
<div style="position:absolute;left:122.09px;top:291.91px" class="cls_004"><span class="cls_004">You may be wondering about the </span><span class="cls_013">sc:whitepaper</span><span class="cls_004"> type. Will we need to</span></div>
<div style="position:absolute;left:122.09px;top:305.19px" class="cls_004"><span class="cls_004">do anything special to make sure whitepapers can be tied to campaigns as</span></div>
<div style="position:absolute;left:122.09px;top:317.79px" class="cls_004"><span class="cls_004">well? Nope! In Alfresco, content types inherit the properties of their</span></div>
<div style="position:absolute;left:122.09px;top:330.39px" class="cls_004"><span class="cls_004">parent. The </span><span class="cls_013">sc:whitepaper</span><span class="cls_004"> type will automatically have an</span></div>
<div style="position:absolute;left:122.09px;top:343.67px" class="cls_013"><span class="cls_013">sc:campaign</span><span class="cls_004"> property. In fact, it will have all sorts of properties inherited</span></div>
<div style="position:absolute;left:122.09px;top:356.95px" class="cls_004"><span class="cls_004">from its ancestor types. The file name, content property, and creation date</span></div>
<div style="position:absolute;left:122.09px;top:369.55px" class="cls_004"><span class="cls_004">are three important examples.</span></div>
<div style="position:absolute;left:56.69px;top:391.15px" class="cls_004"><span class="cls_004">Property types (or data types) describe the fundamental types of data the repository will</span></div>
<div style="position:absolute;left:56.69px;top:403.75px" class="cls_004"><span class="cls_004">use to store properties. The data type of the </span><span class="cls_013">sc:campaign</span><span class="cls_004"> property is </span><span class="cls_013">d:text</span><span class="cls_004">. Other</span></div>
<div style="position:absolute;left:56.69px;top:417.03px" class="cls_004"><span class="cls_004">examples include things such as dates (</span><span class="cls_013">d:date</span><span class="cls_004"> and </span><span class="cls_013">d:datetime)</span><span class="cls_004">, floats (</span><span class="cls_013">d:float</span><span class="cls_004">),</span></div>
<div style="position:absolute;left:56.69px;top:430.31px" class="cls_004"><span class="cls_004">booleans (</span><span class="cls_013">d:boolean</span><span class="cls_004">), and content that is the property type of the property used to store</span></div>
<div style="position:absolute;left:56.69px;top:443.59px" class="cls_004"><span class="cls_004">content in a node. Because these data types literally are fundamental, they are pretty much</span></div>
<div style="position:absolute;left:56.69px;top:456.19px" class="cls_004"><span class="cls_004">the same for everyone. So they are defined for you out of the box.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 79 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:63544px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background095.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Constraints</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">Constraints can optionally be used to restrict the values that Alfresco will store in a</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">property. In the following example, the </span><span class="cls_013">sc:campaign</span><span class="cls_004"> property uses a LIST constraint.</span></div>
<div style="position:absolute;left:56.69px;top:118.46px" class="cls_004"><span class="cls_004">There are three other types of constraints available: REGEX, MINMAX, and LENGTH.</span></div>
<div style="position:absolute;left:56.69px;top:131.06px" class="cls_004"><span class="cls_004">REGEX is used to make sure that a property value matches a regular expression pattern.</span></div>
<div style="position:absolute;left:56.69px;top:143.66px" class="cls_004"><span class="cls_004">MINMAX provides a numeric range for a property value. LENGTH sets a restriction on the</span></div>
<div style="position:absolute;left:56.69px;top:156.26px" class="cls_004"><span class="cls_004">length of a string.</span></div>
<div style="position:absolute;left:56.69px;top:177.86px" class="cls_004"><span class="cls_004">Constraints can be defined once and reused across a model. For example, out of the box,</span></div>
<div style="position:absolute;left:56.69px;top:190.46px" class="cls_004"><span class="cls_004">Alfresco makes available a constraint named </span><span class="cls_013">cm:filename</span><span class="cls_004"> that defines a regular</span></div>
<div style="position:absolute;left:56.69px;top:203.74px" class="cls_004"><span class="cls_004">expression constraint for file names. If a property in a custom type needs to restrict values</span></div>
<div style="position:absolute;left:56.69px;top:216.34px" class="cls_004"><span class="cls_004">to those matching the filename pattern, the custom model doesn't have to define the</span></div>
<div style="position:absolute;left:56.69px;top:228.94px" class="cls_004"><span class="cls_004">constraint again. It simply refers to the </span><span class="cls_013">cm:filename</span><span class="cls_004"> constraint.</span></div>
<div style="position:absolute;left:56.69px;top:266.32px" class="cls_014"><span class="cls_014">Step-by-step - adding properties to types</span></div>
<div style="position:absolute;left:56.69px;top:291.54px" class="cls_004"><span class="cls_004">The Marketing department thinks in terms of marketing campaigns. In fact, they want to be</span></div>
<div style="position:absolute;left:56.69px;top:304.14px" class="cls_004"><span class="cls_004">able to search by a specific campaign and find all of the content tied to a particular</span></div>
<div style="position:absolute;left:56.69px;top:316.74px" class="cls_004"><span class="cls_004">campaign. Not to hurt the Marketing team's feelings, but the HR, Sales, and Operations</span></div>
<div style="position:absolute;left:56.69px;top:329.34px" class="cls_004"><span class="cls_004">teams couldn't care less about campaigns.</span></div>
<div style="position:absolute;left:56.69px;top:350.94px" class="cls_004"><span class="cls_004">You are going to address this by adding a property to the </span><span class="cls_013">sc:marketingDoc</span><span class="cls_004"> type to</span></div>
<div style="position:absolute;left:56.69px;top:364.22px" class="cls_004"><span class="cls_004">capture the marketing campaigns the document is related to. You could make this property</span></div>
<div style="position:absolute;left:56.69px;top:376.82px" class="cls_004"><span class="cls_004">a text field. But letting users enter a campaign as free-form text is a recipe for disaster if you</span></div>
<div style="position:absolute;left:56.69px;top:389.42px" class="cls_004"><span class="cls_004">care about getting valid search results later because of the potential for misspelling the</span></div>
<div style="position:absolute;left:56.69px;top:402.02px" class="cls_004"><span class="cls_004">campaign name. Plus, SomeCo wants to let each document be associated with multiple</span></div>
<div style="position:absolute;left:56.69px;top:414.62px" class="cls_004"><span class="cls_004">campaigns, which compounds the free-form text entry problem. So, for this particular</span></div>
<div style="position:absolute;left:56.69px;top:427.22px" class="cls_004"><span class="cls_004">property it makes sense to constrain its values to a list of valid campaigns.</span></div>
<div style="position:absolute;left:122.09px;top:448.82px" class="cls_004"><span class="cls_004">In a traditional use case, the list of campaigns may change quite a lot. So,</span></div>
<div style="position:absolute;left:122.09px;top:461.42px" class="cls_004"><span class="cls_004">using a list constraint won't be the best solution in this case. But we'll keep</span></div>
<div style="position:absolute;left:122.09px;top:474.02px" class="cls_004"><span class="cls_004">it like that in this book for an education purpose. A traditional list</span></div>
<div style="position:absolute;left:122.09px;top:486.62px" class="cls_004"><span class="cls_004">constraint would be a list of countries or regions per example. However,</span></div>
<div style="position:absolute;left:122.09px;top:499.22px" class="cls_004"><span class="cls_004">you can make your LIST constraint dynamic. You can create a Java class</span></div>
<div style="position:absolute;left:122.09px;top:511.82px" class="cls_004"><span class="cls_004">that inherits the Alfresco Java class</span></div>
<div style="position:absolute;left:122.09px;top:523.64px" class="cls_013"><span class="cls_013">org.alfresco.repo.dictionary.constraint.ListOfValuesConst</span></div>
<div style="position:absolute;left:122.09px;top:536.42px" class="cls_013"><span class="cls_013">raint</span><span class="cls_004"> and you could connect to a database to retrieve the list of active</span></div>
<div style="position:absolute;left:122.09px;top:549.70px" class="cls_004"><span class="cls_004">campaigns.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 80 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:64220px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background096.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To allow the Marketing team to tag a piece of content with one or more campaigns selected</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">from a list of valid campaign names, update the model by following these steps:</span></div>
<div style="position:absolute;left:91.32px;top:104.83px" class="cls_004"><span class="cls_004">1. Edit the </span><span class="cls_013">scModel.xml</span><span class="cls_004"> file in</span></div>
<div style="position:absolute;left:104.69px;top:118.11px" class="cls_007"><span class="cls_007">repo|src|main|amp|config|alfresco|module|repo|model</span><span class="cls_004">. Replace the</span></div>
<div style="position:absolute;left:104.69px;top:130.75px" class="cls_013"><span class="cls_013">sc:marketingDoc</span><span class="cls_004"> type definition with the following:</span></div>
<div style="position:absolute;left:117.89px;top:154.64px" class="cls_010"><span class="cls_010">&lt;type name="sc:marketingDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:165.44px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Marketing Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:176.24px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:doc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:187.04px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:161.09px;top:197.84px" class="cls_010"><span class="cls_010">&lt;property name="sc:campaign"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:208.64px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:182.69px;top:219.44px" class="cls_010"><span class="cls_010">&lt;multiple&gt;true&lt;/multiple&gt;</span></div>
<div style="position:absolute;left:182.69px;top:230.24px" class="cls_010"><span class="cls_010">&lt;constraints&gt;</span></div>
<div style="position:absolute;left:204.29px;top:241.04px" class="cls_010"><span class="cls_010">&lt;constraint ref="sc:campaignList" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:251.84px" class="cls_010"><span class="cls_010">&lt;/constraints&gt;</span></div>
<div style="position:absolute;left:161.09px;top:262.64px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:273.44px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:117.89px;top:284.24px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:91.32px;top:304.85px" class="cls_004"><span class="cls_004">2. Now, define the campaign list constraint. Between the </span><span class="cls_013">namespaces</span><span class="cls_004"> and </span><span class="cls_013">types</span></div>
<div style="position:absolute;left:104.69px;top:318.13px" class="cls_004"><span class="cls_004">elements, add a new </span><span class="cls_013">constraints</span><span class="cls_004"> element as follows (Be careful, the order that</span></div>
<div style="position:absolute;left:104.69px;top:331.41px" class="cls_004"><span class="cls_004">you define elements in the content model is very important:</span></div>
<div style="position:absolute;left:117.89px;top:354.62px" class="cls_010"><span class="cls_010">&lt;constraints&gt;</span></div>
<div style="position:absolute;left:139.49px;top:365.42px" class="cls_010"><span class="cls_010">&lt;constraint name="sc:campaignList" type="LIST"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:376.22px" class="cls_010"><span class="cls_010">&lt;parameter name="allowedValues"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:387.02px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:204.29px;top:397.82px" class="cls_010"><span class="cls_010">&lt;value&gt;Application Syndication&lt;/value&gt;</span></div>
<div style="position:absolute;left:204.29px;top:408.62px" class="cls_010"><span class="cls_010">&lt;value&gt;Private Event Retailing&lt;/value&gt;</span></div>
<div style="position:absolute;left:204.29px;top:419.42px" class="cls_010"><span class="cls_010">&lt;value&gt;Social Shopping&lt;/value&gt;</span></div>
<div style="position:absolute;left:182.69px;top:430.22px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:161.09px;top:441.02px" class="cls_010"><span class="cls_010">&lt;/parameter&gt;</span></div>
<div style="position:absolute;left:139.49px;top:451.82px" class="cls_010"><span class="cls_010">&lt;/constraint&gt;</span></div>
<div style="position:absolute;left:117.89px;top:462.62px" class="cls_010"><span class="cls_010">&lt;/constraints&gt;</span></div>
<div style="position:absolute;left:91.32px;top:483.23px" class="cls_004"><span class="cls_004">3. Save the </span><span class="cls_013">model</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:498.67px" class="cls_004"><span class="cls_004">4. Stop Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:513.43px" class="cls_004"><span class="cls_004">5. Package and move the module to your virtual Machine.</span></div>
<div style="position:absolute;left:91.32px;top:528.19px" class="cls_004"><span class="cls_004">6. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 81 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:64896px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background097.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:122.09px;top:70.50px" class="cls_004"><span class="cls_004">Here's an important note about the content model schema that may save</span></div>
<div style="position:absolute;left:122.09px;top:83.10px" class="cls_004"><span class="cls_004">you some time: Order matters. For example, if a type has both properties</span></div>
<div style="position:absolute;left:122.09px;top:95.70px" class="cls_004"><span class="cls_004">and associations, properties go first. If you get the order wrong, Alfresco</span></div>
<div style="position:absolute;left:122.09px;top:108.30px" class="cls_004"><span class="cls_004">won't be able to parse your model. There is an XML Schema file that</span></div>
<div style="position:absolute;left:122.09px;top:120.90px" class="cls_004"><span class="cls_004">declares the syntax for a content model XML file. It is called</span></div>
<div style="position:absolute;left:122.09px;top:133.50px" class="cls_013"><span class="cls_013">modelSchema.xsd</span><span class="cls_004">, and it's packaged in the </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:122.09px;top:146.78px" class="cls_013"><span class="cls_013">repository-5.x.jar</span><span class="cls_004"> file (in the directory alfresco | model) that resides</span></div>
<div style="position:absolute;left:122.09px;top:160.06px" class="cls_004"><span class="cls_004">in the Alfresco web application under </span><span class="cls_007">WEB-INF|lib</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:181.70px" class="cls_004"><span class="cls_004">Again, Tomcat should start cleanly with no complaints about the content model. You can</span></div>
<div style="position:absolute;left:56.69px;top:194.30px" class="cls_004"><span class="cls_004">use the two following URLs:</span></div>
<div style="position:absolute;left:104.69px;top:216.03px" class="cls_004"><span class="cls_004">To validate that the property has been added to the type:</span></div>
<div style="position:absolute;left:104.69px;top:227.85px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/s/api/classes/sc_marketingdoc/">http://localhost:8080/alfresco/s/api/classes/sc_marketingDoc</a> </div>
<div style="position:absolute;left:104.69px;top:242.79px" class="cls_004"><span class="cls_004">To validate that the constraint is properly defined:</span></div>
<div style="position:absolute;left:104.69px;top:254.61px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/s/api/classes/sc_marketingdoc/pr/">http://localhost:8080/alfresco/s/api/classes/sc_marketingDoc/pr</a> </div>
<div style="position:absolute;left:104.69px;top:266.61px" class="cls_013"><span class="cls_013">operty/sc_campaign</span></div>
<div style="position:absolute;left:56.69px;top:305.78px" class="cls_014"><span class="cls_014">Step-by-step - relating types with associations</span></div>
<div style="position:absolute;left:56.69px;top:331.00px" class="cls_004"><span class="cls_004">SomeCo has a generic need to be able to identify documents that relate to each other for any</span></div>
<div style="position:absolute;left:56.69px;top:343.60px" class="cls_004"><span class="cls_004">reason. A Whitepaper might be tied to a solution offering data sheet, for example. Or maybe</span></div>
<div style="position:absolute;left:56.69px;top:356.20px" class="cls_004"><span class="cls_004">a project proposal the Legal department has should be related to the project plan the</span></div>
<div style="position:absolute;left:56.69px;top:368.80px" class="cls_004"><span class="cls_004">Operations team is managing. These relationships are called </span><span class="cls_007">associations</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:390.44px" class="cls_004"><span class="cls_004">Let's update the model file to include a related-documents association in the </span><span class="cls_013">sc:doc</span><span class="cls_004"> type so</span></div>
<div style="position:absolute;left:56.69px;top:403.72px" class="cls_004"><span class="cls_004">that any SomeCo document can be related to any other.</span></div>
<div style="position:absolute;left:56.69px;top:425.32px" class="cls_004"><span class="cls_004">To add assocations to the model, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:447.05px" class="cls_004"><span class="cls_004">1. Edit the </span><span class="cls_013">scModel.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:462.48px" class="cls_004"><span class="cls_004">2. Add the following </span><span class="cls_013">associations</span><span class="cls_004"> element to the </span><span class="cls_013">sc:doc</span><span class="cls_004"> type. Notice that the</span></div>
<div style="position:absolute;left:104.69px;top:475.77px" class="cls_004"><span class="cls_004">target of the association must be an </span><span class="cls_013">sc:doc</span><span class="cls_004"> or one of its child types. The</span></div>
<div style="position:absolute;left:104.69px;top:489.04px" class="cls_004"><span class="cls_004">association is not mandatory, and there may be more than one related document:</span></div>
<div style="position:absolute;left:117.89px;top:512.26px" class="cls_010"><span class="cls_010">&lt;type name="sc:doc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:523.05px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:533.85px" class="cls_010"><span class="cls_010">&lt;parent&gt;cm:content&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:544.66px" class="cls_010"><span class="cls_010">&lt;associations&gt;</span></div>
<div style="position:absolute;left:161.09px;top:555.46px" class="cls_010"><span class="cls_010">&lt;association name="sc:relatedDocuments"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:566.26px" class="cls_010"><span class="cls_010">&lt;title&gt;Related Documents&lt;/title&gt;</span></div>
<div style="position:absolute;left:182.69px;top:577.05px" class="cls_010"><span class="cls_010">&lt;source&gt;</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 82 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:65572px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background098.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:204.29px;top:69.82px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:204.29px;top:80.62px" class="cls_010"><span class="cls_010">&lt;many&gt;true&lt;/many&gt;</span></div>
<div style="position:absolute;left:182.69px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/source&gt;</span></div>
<div style="position:absolute;left:182.69px;top:102.22px" class="cls_010"><span class="cls_010">&lt;target&gt;</span></div>
<div style="position:absolute;left:204.29px;top:113.02px" class="cls_010"><span class="cls_010">&lt;class&gt;sc:doc&lt;/class&gt;</span></div>
<div style="position:absolute;left:204.29px;top:123.82px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:204.29px;top:134.62px" class="cls_010"><span class="cls_010">&lt;many&gt;true&lt;/many&gt;</span></div>
<div style="position:absolute;left:182.69px;top:145.42px" class="cls_010"><span class="cls_010">&lt;/target&gt;</span></div>
<div style="position:absolute;left:161.09px;top:156.22px" class="cls_010"><span class="cls_010">&lt;/association&gt;</span></div>
<div style="position:absolute;left:139.49px;top:167.02px" class="cls_010"><span class="cls_010">&lt;/associations&gt;</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:91.32px;top:198.43px" class="cls_004"><span class="cls_004">3. Save the </span><span class="cls_013">model</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:213.87px" class="cls_004"><span class="cls_004">4. Stop Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:228.63px" class="cls_004"><span class="cls_004">5. Package and move the module to your virtual machine.</span></div>
<div style="position:absolute;left:91.32px;top:243.39px" class="cls_004"><span class="cls_004">6. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:56.69px;top:267.28px" class="cls_004"><span class="cls_004">When you restart, watch the log for errors related to the content model. If everything is</span></div>
<div style="position:absolute;left:56.69px;top:279.88px" class="cls_004"><span class="cls_004">clean, keep going. You can as well use the following URL to check that your association is</span></div>
<div style="position:absolute;left:56.69px;top:292.48px" class="cls_004"><span class="cls_004">properly defined:</span></div>
<div style="position:absolute;left:56.69px;top:304.30px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/s/api/classes/sc_doc/">http://localhost:8080/alfresco/s/api/classes/sc_doc</a> </div>
<div style="position:absolute;left:56.69px;top:339.13px" class="cls_023"><span class="cls_023">Associations</span></div>
<div style="position:absolute;left:56.69px;top:361.84px" class="cls_004"><span class="cls_004">Associations define relationships between types. Without associations, models would be</span></div>
<div style="position:absolute;left:56.69px;top:374.44px" class="cls_004"><span class="cls_004">full of types with properties that store </span><span class="cls_022">“</span><span class="cls_004">pointers</span><span class="cls_022">”</span><span class="cls_004"> to other pieces of content. Going back to</span></div>
<div style="position:absolute;left:56.69px;top:387.87px" class="cls_004"><span class="cls_004">the expense report example, suppose each expense is stored as an individual object. In</span></div>
<div style="position:absolute;left:56.69px;top:400.47px" class="cls_004"><span class="cls_004">addition to an Expense Report type, there would also be an Expense type. In this example,</span></div>
<div style="position:absolute;left:56.69px;top:413.07px" class="cls_004"><span class="cls_004">associations can be used to tell Alfresco about the relationship between an Expense Report</span></div>
<div style="position:absolute;left:56.69px;top:425.67px" class="cls_004"><span class="cls_004">and one or more Expenses.</span></div>
<div style="position:absolute;left:56.69px;top:447.27px" class="cls_004"><span class="cls_004">In the </span><span class="cls_013">sc:relatedDocuments</span><span class="cls_004"> association you just defined, note that both the source and</span></div>
<div style="position:absolute;left:56.69px;top:460.55px" class="cls_004"><span class="cls_004">target class of the association is </span><span class="cls_013">sc:doc</span><span class="cls_004">. That's because SomeCo wants to associate</span></div>
<div style="position:absolute;left:56.69px;top:473.83px" class="cls_004"><span class="cls_004">documents with each other regardless of content type. Defining the association at the</span></div>
<div style="position:absolute;left:56.69px;top:486.43px" class="cls_013"><span class="cls_013">sc:doc</span><span class="cls_004"> level allows any instance of </span><span class="cls_013">sc:doc</span><span class="cls_004"> or its children to be associated with zero or</span></div>
<div style="position:absolute;left:56.69px;top:499.71px" class="cls_004"><span class="cls_004">more instances of </span><span class="cls_013">sc:doc</span><span class="cls_004"> or its children. It also assumes that SomeCo is using </span><span class="cls_013">sc:doc</span><span class="cls_004"> or</span></div>
<div style="position:absolute;left:56.69px;top:512.99px" class="cls_004"><span class="cls_004">children of that type for all of its content. Content stored as the more generic </span><span class="cls_013">cm:content</span></div>
<div style="position:absolute;left:56.69px;top:526.27px" class="cls_004"><span class="cls_004">type would not be able to be the target of an </span><span class="cls_013">sc:relatedDocuments</span><span class="cls_004"> association.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 83 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:66248px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background099.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Associations come in two flavors: Peer Associations and Child Associations. (Note that</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">Alfresco refers to Peer Associations simply as </span><span class="cls_022">“</span><span class="cls_004">Associations</span><span class="cls_022">”</span><span class="cls_004">, but that's confusing. So the</span></div>
<div style="position:absolute;left:56.69px;top:96.53px" class="cls_004"><span class="cls_004">book will use the </span><span class="cls_022">“</span><span class="cls_004">Peer</span><span class="cls_022">”</span><span class="cls_004"> distinction.) Peer Associations are just that-they define a</span></div>
<div style="position:absolute;left:56.69px;top:109.96px" class="cls_004"><span class="cls_004">relationship between two objects, but neither is subordinate to the other. Child</span></div>
<div style="position:absolute;left:56.69px;top:122.56px" class="cls_004"><span class="cls_004">Associations, on the other hand, are used when the target of the association (or child)</span></div>
<div style="position:absolute;left:56.69px;top:135.16px" class="cls_004"><span class="cls_004">should not exist when the source (or parent) goes away. This works like a cascaded delete</span></div>
<div style="position:absolute;left:56.69px;top:147.76px" class="cls_004"><span class="cls_004">in a relational database: Delete the parent and the child goes away.</span></div>
<div style="position:absolute;left:56.69px;top:169.36px" class="cls_004"><span class="cls_004">An out-of-the-box association that's easy to relate to is </span><span class="cls_013">cm:contains</span><span class="cls_004">. The </span><span class="cls_013">cm:contains</span></div>
<div style="position:absolute;left:56.69px;top:182.64px" class="cls_004"><span class="cls_004">association defines a Child Association between folders (</span><span class="cls_013">cm:folder)</span><span class="cls_004"> and all other objects</span></div>
<div style="position:absolute;left:56.69px;top:195.92px" class="cls_004"><span class="cls_004">(instances of </span><span class="cls_013">sys:base</span><span class="cls_004"> or its child types). So, for example, a folder named</span></div>
<div style="position:absolute;left:56.69px;top:209.20px" class="cls_013"><span class="cls_013">HumanResources</span><span class="cls_004"> (an instance of </span><span class="cls_013">cm:folder</span><span class="cls_004">) would have a </span><span class="cls_013">cm:contains</span><span class="cls_004"> association</span></div>
<div style="position:absolute;left:56.69px;top:222.48px" class="cls_004"><span class="cls_004">between itself and all of its immediate children. The children could be instances of custom</span></div>
<div style="position:absolute;left:56.69px;top:235.08px" class="cls_004"><span class="cls_004">types like Resume, Policy, or Performance Review. If you delete a folder, the folder's</span></div>
<div style="position:absolute;left:56.69px;top:247.68px" class="cls_004"><span class="cls_004">children are also deleted.</span></div>
<div style="position:absolute;left:56.69px;top:269.28px" class="cls_004"><span class="cls_004">Another example might be a </span><span class="cls_022">“</span><span class="cls_004">Whitepaper</span><span class="cls_022">”</span><span class="cls_004"> and its </span><span class="cls_022">“</span><span class="cls_004">Related Documents</span><span class="cls_022">”</span><span class="cls_004">. Suppose that</span></div>
<div style="position:absolute;left:56.69px;top:282.71px" class="cls_004"><span class="cls_004">SomeCo publishes Whitepapers on its web site. The Whitepaper might be related to other</span></div>
<div style="position:absolute;left:56.69px;top:295.31px" class="cls_004"><span class="cls_004">documents such as product marketing materials or other research. If the relationship</span></div>
<div style="position:absolute;left:56.69px;top:307.91px" class="cls_004"><span class="cls_004">between the Whitepaper and its related documents is formalized, it can be shown in the</span></div>
<div style="position:absolute;left:56.69px;top:320.51px" class="cls_004"><span class="cls_004">user interface. To implement this, as part of the Whitepaper content type, you'd define a</span></div>
<div style="position:absolute;left:56.69px;top:333.11px" class="cls_004"><span class="cls_004">Peer Association. You could use </span><span class="cls_013">sys:base</span><span class="cls_004"> as the target type to allow any piece of content</span></div>
<div style="position:absolute;left:56.69px;top:346.39px" class="cls_004"><span class="cls_004">in the repository to be associated with a Whitepaper, or you could restrict the association to</span></div>
<div style="position:absolute;left:56.69px;top:358.99px" class="cls_004"><span class="cls_004">a specific type. In this case, because it uses a Peer association, related documents don't get</span></div>
<div style="position:absolute;left:56.69px;top:371.59px" class="cls_004"><span class="cls_004">deleted when the Whitepaper gets deleted. You can imagine the headaches that would</span></div>
<div style="position:absolute;left:56.69px;top:384.19px" class="cls_004"><span class="cls_004">cause if that weren't the case!</span></div>
<div style="position:absolute;left:56.69px;top:420.89px" class="cls_014"><span class="cls_014">Step-by-step - adding aspects to the content</span></div>
<div style="position:absolute;left:56.69px;top:442.49px" class="cls_014"><span class="cls_014">model</span></div>
<div style="position:absolute;left:56.69px;top:467.71px" class="cls_004"><span class="cls_004">SomeCo wants to track the client name and, optionally, the project name for pieces of client-</span></div>
<div style="position:absolute;left:56.69px;top:480.31px" class="cls_004"><span class="cls_004">related content. But any piece of content in the repository might be client-related. Proposals</span></div>
<div style="position:absolute;left:56.69px;top:492.91px" class="cls_004"><span class="cls_004">and Status Reports are both project-related, but the two will be in different parts of the</span></div>
<div style="position:absolute;left:56.69px;top:505.51px" class="cls_004"><span class="cls_004">model (one is a type of legal document while the other is a type of operations document).</span></div>
<div style="position:absolute;left:56.69px;top:518.11px" class="cls_004"><span class="cls_004">Whether a piece of content is client-related or not, it transcends department-almost</span></div>
<div style="position:absolute;left:56.69px;top:530.71px" class="cls_004"><span class="cls_004">anything can be client-related. The grouping of properties that need to be tracked for</span></div>
<div style="position:absolute;left:56.69px;top:543.31px" class="cls_004"><span class="cls_004">content that is client-related is called an </span><span class="cls_007">aspect</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 84 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:66924px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background100.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Here's another example. SomeCo would like to selectively pull content from the repository</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">to show on its web site. Again, any piece of content could be published on the site. So an</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">indication of whether or not a piece of content is </span><span class="cls_022">“</span><span class="cls_004">webable</span><span class="cls_022">”</span><span class="cls_004"> should be captured in an aspect.</span></div>
<div style="position:absolute;left:56.69px;top:109.13px" class="cls_004"><span class="cls_004">Specifically, content that needs to be shown on the web site needs to have a flag that</span></div>
<div style="position:absolute;left:56.69px;top:121.73px" class="cls_004"><span class="cls_004">indicates the content is </span><span class="cls_022">“</span><span class="cls_004">active</span><span class="cls_022">”</span><span class="cls_004"> and a date when the content was set to active. These will be</span></div>
<div style="position:absolute;left:56.69px;top:135.16px" class="cls_004"><span class="cls_004">the aspect's properties.</span></div>
<div style="position:absolute;left:56.69px;top:156.76px" class="cls_004"><span class="cls_004">Let's modify the content model to include these two aspects. To add the client-related and</span></div>
<div style="position:absolute;left:56.69px;top:169.36px" class="cls_004"><span class="cls_004">webable aspects to the content model, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:191.09px" class="cls_004"><span class="cls_004">1. Edit the </span><span class="cls_013">scModel.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:206.53px" class="cls_004"><span class="cls_004">2. Add a new </span><span class="cls_013">aspects</span><span class="cls_004"> element after the closing </span><span class="cls_013">types </span><span class="cls_004">tag to contain the new</span></div>
<div style="position:absolute;left:104.69px;top:219.81px" class="cls_004"><span class="cls_004">aspects. Add one </span><span class="cls_013">aspect</span><span class="cls_004"> element to define the client-related aspect and another</span></div>
<div style="position:absolute;left:104.69px;top:233.09px" class="cls_004"><span class="cls_004">to define the web-related aspect. You'll notice that the syntax for the </span><span class="cls_013">aspect</span></div>
<div style="position:absolute;left:104.69px;top:246.37px" class="cls_004"><span class="cls_004">element is identical to the </span><span class="cls_013">type</span><span class="cls_004"> element:</span></div>
<div style="position:absolute;left:117.89px;top:270.26px" class="cls_010"><span class="cls_010">&lt;aspects&gt;</span></div>
<div style="position:absolute;left:139.49px;top:281.06px" class="cls_010"><span class="cls_010">&lt;aspect name="sc:webable"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:291.86px" class="cls_010"><span class="cls_010">&lt;title&gt;SomecoWebable&lt;/title&gt;</span></div>
<div style="position:absolute;left:161.09px;top:302.66px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:182.69px;top:313.46px" class="cls_010"><span class="cls_010">&lt;property name="sc:published"&gt;</span></div>
<div style="position:absolute;left:204.29px;top:324.26px" class="cls_010"><span class="cls_010">&lt;type&gt;d:date&lt;/type&gt;</span></div>
<div style="position:absolute;left:182.69px;top:335.06px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:182.69px;top:345.86px" class="cls_010"><span class="cls_010">&lt;property name="sc:isActive"&gt;</span></div>
<div style="position:absolute;left:204.29px;top:356.66px" class="cls_010"><span class="cls_010">&lt;type&gt;d:boolean&lt;/type&gt;</span></div>
<div style="position:absolute;left:204.29px;top:367.46px" class="cls_010"><span class="cls_010">&lt;default&gt;false&lt;/default&gt;</span></div>
<div style="position:absolute;left:182.69px;top:378.26px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:161.09px;top:389.06px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:139.49px;top:399.86px" class="cls_010"><span class="cls_010">&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:139.49px;top:410.66px" class="cls_010"><span class="cls_010">&lt;aspect name="sc:clientRelated"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:421.46px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Client Metadata&lt;/title&gt;</span></div>
<div style="position:absolute;left:161.09px;top:432.26px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:182.69px;top:443.06px" class="cls_010"><span class="cls_010">&lt;property name="sc:clientName"&gt;</span></div>
<div style="position:absolute;left:204.29px;top:453.86px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:204.29px;top:464.66px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;true&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:182.69px;top:475.46px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:182.69px;top:486.26px" class="cls_010"><span class="cls_010">&lt;property name="sc:projectName"&gt;</span></div>
<div style="position:absolute;left:204.29px;top:497.06px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:204.29px;top:507.86px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:182.69px;top:518.66px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:161.09px;top:529.46px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:139.49px;top:540.26px" class="cls_010"><span class="cls_010">&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:117.89px;top:551.06px" class="cls_010"><span class="cls_010">&lt;/aspects&gt;</span></div>
<div style="position:absolute;left:91.32px;top:571.67px" class="cls_004"><span class="cls_004">3. Save the </span><span class="cls_013">model</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 85 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:67600px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background101.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Stop Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:85.26px" class="cls_004"><span class="cls_004">5. Package and move the module to your virtual machine.</span></div>
<div style="position:absolute;left:91.32px;top:100.02px" class="cls_004"><span class="cls_004">6. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:56.69px;top:123.91px" class="cls_004"><span class="cls_004">Alfresco should start cleanly without making any model-related complaints. Using the two</span></div>
<div style="position:absolute;left:56.69px;top:136.51px" class="cls_004"><span class="cls_004">following URLs, you can check that the aspect have been created properly:</span></div>
<div style="position:absolute;left:104.69px;top:158.74px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/api/classes/sc_webable/">http://localhost:8080/alfresco/service/api/classes/sc_webable</a> </div>
<div style="position:absolute;left:104.69px;top:174.18px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/api/classes/sc_clientrel/">http://localhost:8080/alfresco/service/api/classes/sc_clientRel</a> </div>
<div style="position:absolute;left:104.69px;top:186.18px" class="cls_013"><span class="cls_013">ated</span></div>
<div style="position:absolute;left:56.69px;top:223.30px" class="cls_023"><span class="cls_023">Aspects</span></div>
<div style="position:absolute;left:56.69px;top:246.01px" class="cls_004"><span class="cls_004">To appreciate aspects, first consider how inheritance works and its implications on the</span></div>
<div style="position:absolute;left:56.69px;top:258.61px" class="cls_004"><span class="cls_004">content model. Suppose that SomeCo only wants to display a subset of the repository's</span></div>
<div style="position:absolute;left:56.69px;top:271.22px" class="cls_004"><span class="cls_004">content on the web site. (In fact, this is the case. The SomeCo write-up in </span><span class="cls_010">Chapter 1</span><span class="cls_004">, </span><span class="cls_012">The</span></div>
<div style="position:absolute;left:56.69px;top:284.20px" class="cls_012"><span class="cls_012">Alfresco Platform</span><span class="cls_004">, said that, except for job postings, HR content shouldn't go near the public</span></div>
<div style="position:absolute;left:56.69px;top:296.80px" class="cls_004"><span class="cls_004">web.) In the recent example, webable content needs to have a flag that indicates whether or</span></div>
<div style="position:absolute;left:56.69px;top:309.40px" class="cls_004"><span class="cls_004">not it is </span><span class="cls_022">“</span><span class="cls_004">active</span><span class="cls_022">”</span><span class="cls_004">, and a date that indicates when it became active.</span></div>
<div style="position:absolute;left:56.69px;top:331.83px" class="cls_004"><span class="cls_004">Without aspects, there would only be two options to model these properties. The first</span></div>
<div style="position:absolute;left:56.69px;top:344.43px" class="cls_004"><span class="cls_004">option would be to put the properties on </span><span class="cls_013">sc:doc</span><span class="cls_004">, the root object. All child content types</span></div>
<div style="position:absolute;left:56.69px;top:357.71px" class="cls_004"><span class="cls_004">would inherit from this root type, thus making the properties available everywhere. The</span></div>
<div style="position:absolute;left:56.69px;top:370.31px" class="cls_004"><span class="cls_004">second option would be to individually define the two properties only in the content types</span></div>
<div style="position:absolute;left:56.69px;top:382.91px" class="cls_004"><span class="cls_004">that will be published to the portal.</span></div>
<div style="position:absolute;left:56.69px;top:404.51px" class="cls_004"><span class="cls_004">Neither of these is a great option. In the first option, there would be properties in each and</span></div>
<div style="position:absolute;left:56.69px;top:417.11px" class="cls_004"><span class="cls_004">every piece of content in the repository that may or may not ultimately be used. This can</span></div>
<div style="position:absolute;left:56.69px;top:429.71px" class="cls_004"><span class="cls_004">lead to performance and maintenance problems. The second option too isn't much better for</span></div>
<div style="position:absolute;left:56.69px;top:442.31px" class="cls_004"><span class="cls_004">several reasons. First, it assumes that the content types to be published to the portal are</span></div>
<div style="position:absolute;left:56.69px;top:454.91px" class="cls_004"><span class="cls_004">known when you design the model. Second, it opens up the possibility that the same type</span></div>
<div style="position:absolute;left:56.69px;top:467.51px" class="cls_004"><span class="cls_004">of metadata might get defined differently across content types. Third, it doesn't provide an</span></div>
<div style="position:absolute;left:56.69px;top:480.11px" class="cls_004"><span class="cls_004">easy way to encapsulate behavior or business logic that might be tied to the published date.</span></div>
<div style="position:absolute;left:56.69px;top:492.71px" class="cls_004"><span class="cls_004">Finally, property names must be unique across the model. So you'd have to modify the</span></div>
<div style="position:absolute;left:56.69px;top:505.31px" class="cls_004"><span class="cls_004">names of the properties in every type in which they were used, otherwise it would be a</span></div>
<div style="position:absolute;left:56.69px;top:517.91px" class="cls_004"><span class="cls_004">serious pain later when you try to run queries across types.</span></div>
<div style="position:absolute;left:56.69px;top:539.51px" class="cls_004"><span class="cls_004">As you already know, the best option is to use aspects. Aspects allow </span><span class="cls_022">“</span><span class="cls_004">cross-cutting</span><span class="cls_022">”</span><span class="cls_004"> of the</span></div>
<div style="position:absolute;left:56.69px;top:552.94px" class="cls_004"><span class="cls_004">content model with properties and associations by attaching them to content types (or even</span></div>
<div style="position:absolute;left:56.69px;top:565.54px" class="cls_004"><span class="cls_004">specific instances of content at runtime rather than design time) when and where they are</span></div>
<div style="position:absolute;left:56.69px;top:578.14px" class="cls_004"><span class="cls_004">needed.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 86 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:68276px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background102.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">In this case, SomeCo's webable aspect will be added to any piece of content that needs to be</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">displayed on the web site, regardless of type.</span></div>
<div style="position:absolute;left:56.69px;top:104.70px" class="cls_004"><span class="cls_004">Another nice thing about aspects is that they give you a way to have multiple inheritances.</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">As you saw in the model, types can only inherit from a single parent. But you can add as</span></div>
<div style="position:absolute;left:56.69px;top:129.90px" class="cls_004"><span class="cls_004">many aspects to a type or object instance as you need.</span></div>
<div style="position:absolute;left:56.69px;top:166.60px" class="cls_014"><span class="cls_014">Step-by-step - finishing up the model</span></div>
<div style="position:absolute;left:56.69px;top:191.82px" class="cls_004"><span class="cls_004">Let's finish up the model by doing two things: First, the remaining departments need</span></div>
<div style="position:absolute;left:56.69px;top:204.42px" class="cls_004"><span class="cls_004">content types added to them. Second, there is an out of the box aspect that needs to be</span></div>
<div style="position:absolute;left:56.69px;top:217.02px" class="cls_004"><span class="cls_004">applied to all the content. It's called </span><span class="cls_013">generalclassifiable</span><span class="cls_004">. It allows content to be</span></div>
<div style="position:absolute;left:56.69px;top:230.30px" class="cls_004"><span class="cls_004">categorized. SomeCo wants all of its content to be classifiable as soon as it hits the</span></div>
<div style="position:absolute;left:56.69px;top:242.90px" class="cls_004"><span class="cls_004">repository. To make that happen, you need to define the aspect as mandatory. Because</span></div>
<div style="position:absolute;left:56.69px;top:255.50px" class="cls_004"><span class="cls_004">SomeCo wants it across the board, you can do it on the root type </span><span class="cls_013">sc:doc</span><span class="cls_004">, and have it trickle</span></div>
<div style="position:absolute;left:56.69px;top:268.78px" class="cls_004"><span class="cls_004">down to all of SomeCo's types.</span></div>
<div style="position:absolute;left:56.69px;top:290.38px" class="cls_004"><span class="cls_004">To add the remaining departmental content types as well as make the</span></div>
<div style="position:absolute;left:56.69px;top:302.98px" class="cls_013"><span class="cls_013">generalclassifiable</span><span class="cls_004"> aspect mandatory, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:325.39px" class="cls_004"><span class="cls_004">1. Edit the </span><span class="cls_013">scModel.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:340.83px" class="cls_004"><span class="cls_004">2. Add the the following types:</span></div>
<div style="position:absolute;left:117.89px;top:364.04px" class="cls_010"><span class="cls_010">&lt;type name="sc:hrDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:374.84px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco HR Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:385.64px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:doc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:117.89px;top:396.44px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:117.89px;top:418.04px" class="cls_010"><span class="cls_010">&lt;type name="sc:salesDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:428.84px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Sales Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:439.64px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:doc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:117.89px;top:450.44px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:117.89px;top:472.04px" class="cls_010"><span class="cls_010">&lt;type name="sc:opsDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:482.84px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Operations Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:493.64px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:doc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:117.89px;top:504.44px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:117.89px;top:526.04px" class="cls_010"><span class="cls_010">&lt;type name="sc:legalDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:536.84px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Legal Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:547.64px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:doc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:117.89px;top:558.44px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 87 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:68952px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background103.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Modify the </span><span class="cls_013">sc:doc</span><span class="cls_004"> type to include </span><span class="cls_013">cm:generalclassifiable</span><span class="cls_004"> as a mandatory</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">aspect. Note that you can add as many mandatory aspects as you need:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">&lt;type name="sc:doc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:117.79px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:128.59px" class="cls_010"><span class="cls_010">&lt;parent&gt;cm:content&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:139.39px" class="cls_010"><span class="cls_010">&lt;associations&gt;</span></div>
<div style="position:absolute;left:161.09px;top:150.19px" class="cls_010"><span class="cls_010">&lt;association name="sc:relatedDocuments"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:160.99px" class="cls_010"><span class="cls_010">&lt;title&gt;Related Documents&lt;/title&gt;</span></div>
<div style="position:absolute;left:177.29px;top:171.79px" class="cls_010"><span class="cls_010">&lt;source&gt;</span></div>
<div style="position:absolute;left:204.29px;top:182.59px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:204.29px;top:193.39px" class="cls_010"><span class="cls_010">&lt;many&gt;true&lt;/many&gt;</span></div>
<div style="position:absolute;left:182.69px;top:204.19px" class="cls_010"><span class="cls_010">&lt;/source&gt;</span></div>
<div style="position:absolute;left:182.69px;top:214.99px" class="cls_010"><span class="cls_010">&lt;target&gt;</span></div>
<div style="position:absolute;left:204.29px;top:225.79px" class="cls_010"><span class="cls_010">&lt;class&gt;sc:doc&lt;/class&gt;</span></div>
<div style="position:absolute;left:204.29px;top:236.59px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:204.29px;top:247.39px" class="cls_010"><span class="cls_010">&lt;many&gt;true&lt;/many&gt;</span></div>
<div style="position:absolute;left:182.69px;top:258.19px" class="cls_010"><span class="cls_010">&lt;/target&gt;</span></div>
<div style="position:absolute;left:161.09px;top:268.99px" class="cls_010"><span class="cls_010">&lt;/association&gt;</span></div>
<div style="position:absolute;left:139.49px;top:279.79px" class="cls_010"><span class="cls_010">&lt;/associations&gt;</span></div>
<div style="position:absolute;left:139.49px;top:290.59px" class="cls_010"><span class="cls_010">&lt;mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:161.09px;top:301.39px" class="cls_010"><span class="cls_010">&lt;aspect&gt;cm:generalclassifiable&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:139.49px;top:312.19px" class="cls_010"><span class="cls_010">&lt;/mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:117.89px;top:322.99px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:91.32px;top:343.60px" class="cls_004"><span class="cls_004">4. Save the </span><span class="cls_013">model</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:359.04px" class="cls_004"><span class="cls_004">5. Stop Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:373.80px" class="cls_004"><span class="cls_004">6. Package and move the module to your virtual machine.</span></div>
<div style="position:absolute;left:91.32px;top:388.56px" class="cls_004"><span class="cls_004">7. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:56.69px;top:412.45px" class="cls_004"><span class="cls_004">Watch the log for content model-related errors. If everything starts up cleanly, you are</span></div>
<div style="position:absolute;left:56.69px;top:425.05px" class="cls_004"><span class="cls_004">ready to move on. You can check that everything is properly defined by opening this URL</span></div>
<div style="position:absolute;left:56.69px;top:437.65px" class="cls_004"><span class="cls_004">(</span><a href="http://localhost:8080/alfresco/service/api/classes?nsp=sc/">http://localhost:8080/alfresco/service/api/classes?nsp=sc</a> <span class="cls_004">).In the next set</span></div>
<div style="position:absolute;left:56.69px;top:450.93px" class="cls_004"><span class="cls_004">of examples, you'll configure Alfresco Share so that you can work with your new model.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 88 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:69628px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background104.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Manage property indexing</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">Directly in your content model, you can specify how your properties will be indexed by</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">Solr. Below each property, you can add an index element like this one (that contains the</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">default value):</span></div>
<div style="position:absolute;left:74.69px;top:143.50px" class="cls_010"><span class="cls_010">&lt;index enabled='true'&gt;</span></div>
<div style="position:absolute;left:96.29px;top:154.30px" class="cls_010"><span class="cls_010">&lt;atomic&gt;true&lt;/atomic&gt;</span></div>
<div style="position:absolute;left:96.29px;top:165.10px" class="cls_010"><span class="cls_010">&lt;stored&gt;false&lt;/stored&gt;</span></div>
<div style="position:absolute;left:96.29px;top:175.90px" class="cls_010"><span class="cls_010">&lt;tokenised&gt;true&lt;/tokenised&gt;</span></div>
<div style="position:absolute;left:74.69px;top:186.70px" class="cls_010"><span class="cls_010">&lt;/index&gt;</span></div>
<div style="position:absolute;left:56.69px;top:207.18px" class="cls_004"><span class="cls_004">Here is the list of possible configuration:</span></div>
<div style="position:absolute;left:104.69px;top:228.91px" class="cls_004"><span class="cls_004">Change the enabled attribute to false to do not index this specific property. It</span></div>
<div style="position:absolute;left:104.69px;top:241.51px" class="cls_004"><span class="cls_004">means that you won't be able to search on it.</span></div>
<div style="position:absolute;left:104.69px;top:256.27px" class="cls_004"><span class="cls_004">Change the </span><span class="cls_013">atomic</span><span class="cls_004"> property depending if you want properties to be indexed as</span></div>
<div style="position:absolute;left:104.69px;top:269.55px" class="cls_004"><span class="cls_004">part of the transaction commit (</span><span class="cls_013">true</span><span class="cls_004">), or indexed in the background (</span><span class="cls_013">false</span><span class="cls_004">). For</span></div>
<div style="position:absolute;left:104.69px;top:282.83px" class="cls_004"><span class="cls_004">example, the properties using  </span><span class="cls_013">typed:content</span><span class="cls_004"> are indexed in the background</span></div>
<div style="position:absolute;left:104.69px;top:296.11px" class="cls_004"><span class="cls_004">because some transformations need to be done before indexing.</span></div>
<div style="position:absolute;left:104.69px;top:310.87px" class="cls_004"><span class="cls_004">Change the </span><span class="cls_013">stored</span><span class="cls_004"> property if you want to store the property value in the index.</span></div>
<div style="position:absolute;left:104.69px;top:324.15px" class="cls_004"><span class="cls_004">This property should never be changed in production. Set it to false only for</span></div>
<div style="position:absolute;left:104.69px;top:336.75px" class="cls_004"><span class="cls_004">debugging purposes.</span></div>
<div style="position:absolute;left:104.69px;top:351.51px" class="cls_004"><span class="cls_004">Change the </span><span class="cls_013">tokenised</span><span class="cls_004"> property to control how values are tokenized in the</span></div>
<div style="position:absolute;left:104.69px;top:364.79px" class="cls_004"><span class="cls_004">index. If you use true, the string value will be tokenized before indexing. If you</span></div>
<div style="position:absolute;left:104.69px;top:377.39px" class="cls_004"><span class="cls_004">use false, the string value will be indexed as it is. If you use both, both forms will</span></div>
<div style="position:absolute;left:104.69px;top:389.99px" class="cls_004"><span class="cls_004">be used.</span></div>
<div style="position:absolute;left:56.69px;top:413.88px" class="cls_004"><span class="cls_004">Configuring the indexing of your properties can be very useful and improve your system</span></div>
<div style="position:absolute;left:56.69px;top:426.48px" class="cls_004"><span class="cls_004">greatly. Just be very careful and sure to understand the consequences before deploying a</span></div>
<div style="position:absolute;left:56.69px;top:439.08px" class="cls_004"><span class="cls_004">change in production.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 89 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:70304px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background105.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Modeling summary</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">A content model describes the data being stored in the repository. The content model is</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">critical. Without it, Alfresco would be little more than a file system. Here is a list of key</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">information that the content model provides Alfresco:</span></div>
<div style="position:absolute;left:104.69px;top:144.31px" class="cls_004"><span class="cls_004">Fundamental data types and how those data types should persist to the database.</span></div>
<div style="position:absolute;left:104.69px;top:156.91px" class="cls_004"><span class="cls_004">For example, without a content model, Alfresco wouldn't know the difference</span></div>
<div style="position:absolute;left:104.69px;top:169.51px" class="cls_004"><span class="cls_004">between a string and a date.</span></div>
<div style="position:absolute;left:104.69px;top:184.27px" class="cls_004"><span class="cls_004">Higher order data types such as </span><span class="cls_022">“</span><span class="cls_004">content</span><span class="cls_022">”</span><span class="cls_004"> and </span><span class="cls_022">“</span><span class="cls_004">folder</span><span class="cls_022">”</span><span class="cls_004"> as well as custom content</span></div>
<div style="position:absolute;left:104.69px;top:197.70px" class="cls_004"><span class="cls_004">types such as </span><span class="cls_022">“</span><span class="cls_004">SomeCo Standard Operating Procedure</span><span class="cls_022">”</span><span class="cls_004"> or </span><span class="cls_022">“</span><span class="cls_004">SomeCo Sales</span></div>
<div style="position:absolute;left:104.69px;top:211.13px" class="cls_004"><span class="cls_004">Contract</span><span class="cls_022">”</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:226.72px" class="cls_004"><span class="cls_004">Out-of-the-box aspects such as </span><span class="cls_022">“</span><span class="cls_004">auditable</span><span class="cls_022">”</span><span class="cls_004"> and </span><span class="cls_022">“</span><span class="cls_004">classifiable</span><span class="cls_022">”</span><span class="cls_004"> as well as SomeCo-</span></div>
<div style="position:absolute;left:104.69px;top:240.15px" class="cls_004"><span class="cls_004">specific aspects such as </span><span class="cls_022">“</span><span class="cls_004">rateable</span><span class="cls_022">”</span><span class="cls_004"> or </span><span class="cls_022">“</span><span class="cls_004">client-related</span><span class="cls_022">”</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:255.74px" class="cls_004"><span class="cls_004">Properties (or metadata) specific to each content type.</span></div>
<div style="position:absolute;left:104.69px;top:270.50px" class="cls_004"><span class="cls_004">Constraints placed on properties (such as property values that must match a</span></div>
<div style="position:absolute;left:104.69px;top:283.10px" class="cls_004"><span class="cls_004">certain pattern or property values that must come from a specific list of possible</span></div>
<div style="position:absolute;left:104.69px;top:295.70px" class="cls_004"><span class="cls_004">values).</span></div>
<div style="position:absolute;left:104.69px;top:310.46px" class="cls_004"><span class="cls_004">Relationships or </span><span class="cls_022">“</span><span class="cls_004">associations</span><span class="cls_022">”</span><span class="cls_004"> between content types.</span></div>
<div style="position:absolute;left:56.69px;top:335.18px" class="cls_004"><span class="cls_004">Alfresco content models are built using the following small set of building blocks:</span></div>
<div style="position:absolute;left:104.69px;top:356.91px" class="cls_004"><span class="cls_004">Types</span></div>
<div style="position:absolute;left:104.69px;top:371.67px" class="cls_004"><span class="cls_004">Properties</span></div>
<div style="position:absolute;left:104.69px;top:386.43px" class="cls_004"><span class="cls_004">Property Types</span></div>
<div style="position:absolute;left:104.69px;top:401.19px" class="cls_004"><span class="cls_004">Constraints</span></div>
<div style="position:absolute;left:104.69px;top:415.95px" class="cls_004"><span class="cls_004">Associations</span></div>
<div style="position:absolute;left:104.69px;top:430.71px" class="cls_004"><span class="cls_004">Aspects</span></div>
<div style="position:absolute;left:56.69px;top:454.60px" class="cls_004"><span class="cls_004">When planning your Alfresco implementation, it may make sense to diagram the proposed</span></div>
<div style="position:absolute;left:56.69px;top:467.20px" class="cls_004"><span class="cls_004">content model just as you would a data model in a traditional web application.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 90 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:70980px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background106.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The content model implemented in the examples could be diagrammed as follows:</span></div>
<div style="position:absolute;left:56.69px;top:408.77px" class="cls_004"><span class="cls_004">The Appendix contains similar diagrams for the out of the box content models for your</span></div>
<div style="position:absolute;left:56.69px;top:421.37px" class="cls_004"><span class="cls_004">reference.</span></div>
<div style="position:absolute;left:56.69px;top:458.07px" class="cls_014"><span class="cls_014">Custom behavior</span></div>
<div style="position:absolute;left:56.69px;top:483.29px" class="cls_004"><span class="cls_004">You may find that your custom aspect or custom type needs to have behavior or business</span></div>
<div style="position:absolute;left:56.69px;top:495.89px" class="cls_004"><span class="cls_004">logic associated with it. For example, every time an Expense Report is checked in, you</span></div>
<div style="position:absolute;left:56.69px;top:508.49px" class="cls_004"><span class="cls_004">might want to recalculate the total by iterating through the associated Expenses. One option</span></div>
<div style="position:absolute;left:56.69px;top:521.09px" class="cls_004"><span class="cls_004">would be to incorporate this logic into actions and rules in your Alfresco repository. But</span></div>
<div style="position:absolute;left:56.69px;top:533.69px" class="cls_004"><span class="cls_004">some behaviors are so fundamental to the aspect or type that they should really be </span><span class="cls_022">“</span><span class="cls_004">bound</span><span class="cls_022">”</span></div>
<div style="position:absolute;left:56.69px;top:547.12px" class="cls_004"><span class="cls_004">to the aspect or type, and invoked any time Alfresco works with those objects.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 91 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:71656px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background107.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Behavior really gets out of the realm of modeling and into </span><span class="cls_022">“</span><span class="cls_004">handling content automatically</span><span class="cls_022">”</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:83.94px" class="cls_004"><span class="cls_004">which is the subject of </span><span class="cls_010">Chapter 4</span><span class="cls_004">, </span><span class="cls_012">Handling Content Automatically with Actions, Behaviors,</span></div>
<div style="position:absolute;left:56.69px;top:96.92px" class="cls_012"><span class="cls_012">Transformers, and Extractors</span><span class="cls_004">. For now, just realize that associating business logic with your</span></div>
<div style="position:absolute;left:56.69px;top:109.52px" class="cls_004"><span class="cls_004">custom aspects and types (or overriding out of the box behavior) is possible.</span></div>
<div style="position:absolute;left:56.69px;top:148.27px" class="cls_008"><span class="cls_008">Modeling best practices</span></div>
<div style="position:absolute;left:56.69px;top:176.00px" class="cls_004"><span class="cls_004">Now that you know the building blocks of a content model, it makes sense to consider some</span></div>
<div style="position:absolute;left:56.69px;top:188.60px" class="cls_004"><span class="cls_004">best practices. Here are the top ten:</span></div>
<div style="position:absolute;left:91.32px;top:210.34px" class="cls_004"><span class="cls_004">1.</span></div>
<div style="position:absolute;left:104.69px;top:210.34px" class="cls_012"><span class="cls_012">Don't change Alfresco's out of the box content model.</span><span class="cls_004"> If you can possibly avoid it, do</span></div>
<div style="position:absolute;left:104.69px;top:222.94px" class="cls_004"><span class="cls_004">not change Alfresco's out of the box content model. Instead, extend it with your</span></div>
<div style="position:absolute;left:104.69px;top:235.54px" class="cls_004"><span class="cls_004">own custom content model. If requirements call for several different types of</span></div>
<div style="position:absolute;left:104.69px;top:248.14px" class="cls_004"><span class="cls_004">content to be stored in the repository, create a content type for each one that</span></div>
<div style="position:absolute;left:104.69px;top:260.74px" class="cls_004"><span class="cls_004">extends from </span><span class="cls_013">cm:content</span><span class="cls_004"> or from an enterprise-wide root content type.</span></div>
<div style="position:absolute;left:91.32px;top:276.18px" class="cls_004"><span class="cls_004">2.</span></div>
<div style="position:absolute;left:104.69px;top:276.18px" class="cls_012"><span class="cls_012">Consider implementing an enterprise-wide root type. </span><span class="cls_004">Although the need for a</span></div>
<div style="position:absolute;left:104.69px;top:288.78px" class="cls_004"><span class="cls_004">common ancestor type is lessened through the use of aspects, it still might be a</span></div>
<div style="position:absolute;left:104.69px;top:301.38px" class="cls_004"><span class="cls_004">good idea to define an enterprise-wide root content type such as </span><span class="cls_013">sc:doc</span><span class="cls_004"> from</span></div>
<div style="position:absolute;left:104.69px;top:314.66px" class="cls_004"><span class="cls_004">which all other content types in the repository inherit, if for no other reason, than</span></div>
<div style="position:absolute;left:104.69px;top:327.26px" class="cls_004"><span class="cls_004">it gives content managers a </span><span class="cls_022">“</span><span class="cls_004">catch-all</span><span class="cls_022">”</span><span class="cls_004"> type to use when no other type will do.In</span></div>
<div style="position:absolute;left:104.69px;top:340.69px" class="cls_004"><span class="cls_004">the case that Alfresco is being deployed across multiple departments, it's possible</span></div>
<div style="position:absolute;left:104.69px;top:353.29px" class="cls_004"><span class="cls_004">to add a department-wide root type that extends from the enterprise-wide root</span></div>
<div style="position:absolute;left:104.69px;top:365.89px" class="cls_004"><span class="cls_004">type.</span></div>
<div style="position:absolute;left:91.32px;top:380.66px" class="cls_004"><span class="cls_004">3.</span></div>
<div style="position:absolute;left:104.69px;top:380.66px" class="cls_012"><span class="cls_012">Be conservative early on by adding only what you know you need.</span><span class="cls_004"> A corollary to that is</span></div>
<div style="position:absolute;left:104.69px;top:393.26px" class="cls_004"><span class="cls_004">to be prepared to blow away the repository multiple times, until the content</span></div>
<div style="position:absolute;left:104.69px;top:405.86px" class="cls_004"><span class="cls_004">model stabilizes. Once you get content in the repository (that implements the</span></div>
<div style="position:absolute;left:104.69px;top:418.46px" class="cls_004"><span class="cls_004">types in your model), making model additions is easy, but subtractions aren't. A</span></div>
<div style="position:absolute;left:104.69px;top:431.06px" class="cls_004"><span class="cls_004">good practice is just to keep it in your content model file and add a comment</span></div>
<div style="position:absolute;left:104.69px;top:443.66px" class="cls_004"><span class="cls_004">saying that this property, type or aspect is deprecated. By following this practice,</span></div>
<div style="position:absolute;left:104.69px;top:456.26px" class="cls_004"><span class="cls_004">you are sure that Alfresco won't complain about </span><span class="cls_022">“</span><span class="cls_004">integrity errors</span><span class="cls_022">”</span><span class="cls_004"> and may make</span></div>
<div style="position:absolute;left:104.69px;top:469.69px" class="cls_004"><span class="cls_004">content inaccessible when the content's type or properties don't match the content</span></div>
<div style="position:absolute;left:104.69px;top:482.29px" class="cls_004"><span class="cls_004">model definition.</span></div>
<div style="position:absolute;left:91.32px;top:497.05px" class="cls_004"><span class="cls_004">4.</span></div>
<div style="position:absolute;left:104.69px;top:497.05px" class="cls_012"><span class="cls_012">Take advantage of aspects.</span><span class="cls_004"> In addition to the potential performance and overhead</span></div>
<div style="position:absolute;left:104.69px;top:509.65px" class="cls_004"><span class="cls_004">savings through the use of aspects, aspects promote reuse across the model, the</span></div>
<div style="position:absolute;left:104.69px;top:522.25px" class="cls_004"><span class="cls_004">business logic, and the presentation layer. When working on your model, you</span></div>
<div style="position:absolute;left:104.69px;top:534.85px" class="cls_004"><span class="cls_004">may find that two or more content types have properties in common such as</span></div>
<div style="position:absolute;left:104.69px;top:547.45px" class="cls_013"><span class="cls_013">sc:webable</span><span class="cls_004"> and </span><span class="cls_013">sc:clientRelated</span><span class="cls_004">. Ask yourself if those properties are being</span></div>
<div style="position:absolute;left:104.69px;top:560.73px" class="cls_004"><span class="cls_004">used to describe some higher-level characteristic common across the types that</span></div>
<div style="position:absolute;left:104.69px;top:573.33px" class="cls_004"><span class="cls_004">might be modeled better as an aspect.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 92 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:72332px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background108.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.51px" class="cls_004"><span class="cls_004">5.</span></div>
<div style="position:absolute;left:104.69px;top:70.51px" class="cls_012"><span class="cls_012">It may make sense to define aspect or types that have no properties or associations. </span><span class="cls_004">You</span></div>
<div style="position:absolute;left:104.69px;top:83.11px" class="cls_004"><span class="cls_004">may find yourself defining a type that gets everything it needs through either</span></div>
<div style="position:absolute;left:104.69px;top:95.71px" class="cls_004"><span class="cls_004">inheritance from a parent type or from an aspect (or both). In the SomeCo model</span></div>
<div style="position:absolute;left:104.69px;top:108.31px" class="cls_013"><span class="cls_013">sc:marketingDoc</span><span class="cls_004"> is the only type with a property. You might ask yourself if the</span></div>
<div style="position:absolute;left:104.69px;top:121.59px" class="cls_004"><span class="cls_004">empty type is really necessary. It should at least be considered. It might be worth</span></div>
<div style="position:absolute;left:104.69px;top:134.19px" class="cls_004"><span class="cls_004">it, just to distinguish the content from other types of content for search purposes,</span></div>
<div style="position:absolute;left:104.69px;top:146.79px" class="cls_004"><span class="cls_004">for example. Or, while you might not have any specialized properties or</span></div>
<div style="position:absolute;left:104.69px;top:159.39px" class="cls_004"><span class="cls_004">associations for the content type, you could have specialized behavior that's only</span></div>
<div style="position:absolute;left:104.69px;top:171.99px" class="cls_004"><span class="cls_004">applicable to instances of the content type.</span></div>
<div style="position:absolute;left:91.32px;top:186.75px" class="cls_004"><span class="cls_004">6.</span></div>
<div style="position:absolute;left:104.69px;top:186.75px" class="cls_012"><span class="cls_012">Remember that folders are types too.</span><span class="cls_004"> Like everything else in the repository, folders</span></div>
<div style="position:absolute;left:104.69px;top:199.35px" class="cls_004"><span class="cls_004">are instances of types, which means they can be extended. Content that </span><span class="cls_022">“</span><span class="cls_004">contains</span><span class="cls_022">”</span></div>
<div style="position:absolute;left:104.69px;top:212.78px" class="cls_004"><span class="cls_004">other content is common. In the earlier expense report example, one way to keep</span></div>
<div style="position:absolute;left:104.69px;top:225.38px" class="cls_004"><span class="cls_004">track of the expenses associated with an expense report would be to model the</span></div>
<div style="position:absolute;left:104.69px;top:237.98px" class="cls_004"><span class="cls_004">expense report as a sub-type of </span><span class="cls_013">cm:folder</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:253.43px" class="cls_004"><span class="cls_004">7.</span></div>
<div style="position:absolute;left:104.69px;top:253.43px" class="cls_012"><span class="cls_012">Don't be afraid to have more than one content model XML file.</span><span class="cls_004"> When it is time to</span></div>
<div style="position:absolute;left:104.69px;top:266.03px" class="cls_004"><span class="cls_004">implement your model, keep this in mind: It might make sense to segment your</span></div>
<div style="position:absolute;left:104.69px;top:278.63px" class="cls_004"><span class="cls_004">models into multiple namespaces and multiple XML files. Names should be</span></div>
<div style="position:absolute;left:104.69px;top:291.23px" class="cls_004"><span class="cls_004">descriptive. Don't deploy a model file called </span><span class="cls_013">customModel.xml</span><span class="cls_004"> or</span></div>
<div style="position:absolute;left:104.69px;top:304.51px" class="cls_013"><span class="cls_013">myModel.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:319.95px" class="cls_004"><span class="cls_004">8.</span></div>
<div style="position:absolute;left:104.69px;top:319.95px" class="cls_012"><span class="cls_012">Implement a Java interface that corresponds to each custom content model you define.</span></div>
<div style="position:absolute;left:104.69px;top:332.55px" class="cls_004"><span class="cls_004">Within each content model Java class, define constants that correspond to model</span></div>
<div style="position:absolute;left:104.69px;top:345.15px" class="cls_004"><span class="cls_004">namespaces, type names, property names, aspect names, and so on. You'll find</span></div>
<div style="position:absolute;left:104.69px;top:357.75px" class="cls_004"><span class="cls_004">yourself referring to the qualified name (</span><span class="cls_013">Qname</span><span class="cls_004">, for short) of types, properties,</span></div>
<div style="position:absolute;left:104.69px;top:371.03px" class="cls_004"><span class="cls_004">and aspects quite often; so it helps to have constants defined in an intuitive way.</span></div>
<div style="position:absolute;left:104.69px;top:383.63px" class="cls_004"><span class="cls_004">The constants should be </span><span class="cls_013">QName</span><span class="cls_004"> objects except in cases where the Web Services</span></div>
<div style="position:absolute;left:104.69px;top:396.91px" class="cls_004"><span class="cls_004">API needs to leverage them. The Web Services API doesn't have the </span><span class="cls_013">QName</span><span class="cls_004"> class,</span></div>
<div style="position:absolute;left:104.69px;top:410.19px" class="cls_004"><span class="cls_004">so there will need to be a string representation of the names as well in that case.</span></div>
<div style="position:absolute;left:104.69px;top:422.79px" class="cls_004"><span class="cls_004">You can find an example for the default Alfesco content model here:</span></div>
<div style="position:absolute;left:104.69px;top:434.71px" class="cls_010"><span class="cls_010"> </span><a href="https://gitlab.alfresco.com/platform/alfresco-data-model/blob/master/src/main/java/org/alfresco/model/ContentModel.java">https://gitlab.alfresco.com/platform/alfresco-data-model/blob/master/s</a> </div>
<div style="position:absolute;left:104.69px;top:445.51px" class="cls_010"><span class="cls_010"> </span><a href="https://gitlab.alfresco.com/platform/alfresco-data-model/blob/master/src/main/java/org/alfresco/model/ContentModel.java">rc/main/java/org/alfresco/model/ContentModel.java</a> </div>
<div style="position:absolute;left:91.32px;top:459.16px" class="cls_004"><span class="cls_004">9.</span></div>
<div style="position:absolute;left:104.69px;top:459.16px" class="cls_012"><span class="cls_012">Use the source!</span><span class="cls_004"> The out of the box content model is a great example of what's</span></div>
<div style="position:absolute;left:104.69px;top:471.76px" class="cls_004"><span class="cls_004">possible. The</span></div>
<div style="position:absolute;left:104.69px;top:484.36px" class="cls_013"><span class="cls_013">forumModel</span><span class="cls_004">(</span><a href="https://svn.alfresco.com/repos/alfresco-open-mirror/alfresco/HEAD/root/projects/repository/config/alfresco/model/forumModel.xml">https://svn.alfresco.com/repos/alfresco-open-mirror/alfres</a> </div>
<div style="position:absolute;left:104.69px;top:497.64px" class="cls_010"><span class="cls_010"> </span><a href="https://svn.alfresco.com/repos/alfresco-open-mirror/alfresco/HEAD/root/projects/repository/config/alfresco/model/forumModel.xml">co/HEAD/root/projects/repository/config/alfresco/model/forumModel.xml</a> <span class="cls_004">)</span></div>
<div style="position:absolute;left:104.69px;top:510.61px" class="cls_004"><span class="cls_004">has some particularly useful examples. In the next section you'll learn where the</span></div>
<div style="position:absolute;left:104.69px;top:523.22px" class="cls_004"><span class="cls_004">model files live and what's in each. So you'll know where to look later when you</span></div>
<div style="position:absolute;left:104.69px;top:535.82px" class="cls_004"><span class="cls_004">say to yourself, </span><span class="cls_022">“</span><span class="cls_004">Surely, the folks at Alfresco have done this before</span><span class="cls_022">”</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:560.53px" class="cls_004"><span class="cls_004">This last point is important enough to spend a little more time on. The next section</span></div>
<div style="position:absolute;left:56.69px;top:573.14px" class="cls_004"><span class="cls_004">discusses the out of the box models in additional detail.</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 93 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:73008px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background109.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Out-of-the-box models</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">The Alfresco source code is an indispensable reference tool that you should always have</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">ready along with the documentation, wiki, forums, and Jira. The out of the box content</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">model files are written in XML and get deployed with the Alfresco engine. They can be</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">found in the </span><span class="cls_013">alfresco-repository-5.x.jar</span><span class="cls_004"> and </span><span class="cls_013">alfresco-data-model-5.x.jar</span></div>
<div style="position:absolute;left:56.69px;top:146.06px" class="cls_004"><span class="cls_004">files deployed in the </span><span class="cls_013">alfresco.war</span><span class="cls_004"> file in </span><span class="cls_007">|WEB-INF|lib</span><span class="cls_004">. You'll need to unzip the JAR file</span></div>
<div style="position:absolute;left:56.69px;top:159.34px" class="cls_004"><span class="cls_004">to be able to see all content models in the sub-directory </span><span class="cls_007">alfresco|model</span><span class="cls_004">. The following table</span></div>
<div style="position:absolute;left:56.69px;top:171.98px" class="cls_004"><span class="cls_004">describes several of the model files that can be found in the directory:</span></div>
<div style="position:absolute;left:60.00px;top:199.51px" class="cls_031"><span class="cls_031">File</span></div>
<div style="position:absolute;left:155.45px;top:199.51px" class="cls_031"><span class="cls_031">Namespaces*</span></div>
<div style="position:absolute;left:292.52px;top:199.51px" class="cls_031"><span class="cls_031">Prefix</span></div>
<div style="position:absolute;left:332.35px;top:199.51px" class="cls_031"><span class="cls_031">Imports</span></div>
<div style="position:absolute;left:371.19px;top:199.51px" class="cls_031"><span class="cls_031">Description</span></div>
<div style="position:absolute;left:60.00px;top:216.40px" class="cls_032"><span class="cls_032">dictionaryModel.xml</span></div>
<div style="position:absolute;left:155.45px;top:216.40px" class="cls_032"><span class="cls_032">model|dictionary|1.0</span></div>
<div style="position:absolute;left:292.52px;top:216.40px" class="cls_032"><span class="cls_032">d</span></div>
<div style="position:absolute;left:332.35px;top:216.40px" class="cls_032"><span class="cls_032">None</span></div>
<div style="position:absolute;left:371.19px;top:216.41px" class="cls_033"><span class="cls_033">Fundamental data types</span></div>
<div style="position:absolute;left:371.19px;top:227.35px" class="cls_033"><span class="cls_033">used in all other models</span></div>
<div style="position:absolute;left:371.19px;top:238.28px" class="cls_033"><span class="cls_033">like text, int, Boolean,</span></div>
<div style="position:absolute;left:371.19px;top:249.22px" class="cls_033"><span class="cls_033">datetime, and content. This</span></div>
<div style="position:absolute;left:371.19px;top:260.15px" class="cls_033"><span class="cls_033">is the only model</span></div>
<div style="position:absolute;left:371.19px;top:271.09px" class="cls_033"><span class="cls_033">packaged in alfresco-data-</span></div>
<div style="position:absolute;left:371.19px;top:282.02px" class="cls_033"><span class="cls_033">model-5.x.jar.</span></div>
<div style="position:absolute;left:60.00px;top:298.88px" class="cls_032"><span class="cls_032">systemModel.xml</span></div>
<div style="position:absolute;left:155.45px;top:298.88px" class="cls_032"><span class="cls_032">model|system|1.0</span></div>
<div style="position:absolute;left:292.52px;top:298.88px" class="cls_032"><span class="cls_032">sys</span></div>
<div style="position:absolute;left:332.35px;top:298.88px" class="cls_032"><span class="cls_032">d</span></div>
<div style="position:absolute;left:371.19px;top:298.88px" class="cls_032"><span class="cls_032">System-level objects like</span></div>
<div style="position:absolute;left:155.45px;top:310.36px" class="cls_032"><span class="cls_032">system|registry|1.0</span></div>
<div style="position:absolute;left:292.52px;top:310.36px" class="cls_032"><span class="cls_032">reg</span></div>
<div style="position:absolute;left:371.19px;top:310.36px" class="cls_032"><span class="cls_032">base, store root, and</span></div>
<div style="position:absolute;left:155.45px;top:321.85px" class="cls_032"><span class="cls_032">system|modules|1.0</span></div>
<div style="position:absolute;left:292.52px;top:321.85px" class="cls_032"><span class="cls_032">module</span></div>
<div style="position:absolute;left:371.19px;top:321.85px" class="cls_032"><span class="cls_032">reference.</span></div>
<div style="position:absolute;left:60.00px;top:362.23px" class="cls_032"><span class="cls_032">contentModel.xml</span></div>
<div style="position:absolute;left:155.45px;top:362.23px" class="cls_032"><span class="cls_032">model|content|1.0</span></div>
<div style="position:absolute;left:292.52px;top:362.23px" class="cls_032"><span class="cls_032">cm</span></div>
<div style="position:absolute;left:332.35px;top:362.23px" class="cls_032"><span class="cls_032">d</span></div>
<div style="position:absolute;left:371.19px;top:362.23px" class="cls_032"><span class="cls_032">Types and aspects</span></div>
<div style="position:absolute;left:155.45px;top:373.71px" class="cls_032"><span class="cls_032">model|rendition|1.0</span></div>
<div style="position:absolute;left:292.52px;top:373.71px" class="cls_032"><span class="cls_032">rn</span></div>
<div style="position:absolute;left:332.35px;top:373.71px" class="cls_032"><span class="cls_032">sys</span></div>
<div style="position:absolute;left:371.19px;top:373.71px" class="cls_032"><span class="cls_032">extended most often by</span></div>
<div style="position:absolute;left:155.45px;top:385.19px" class="cls_032"><span class="cls_032">EXIF|exif|1.0</span></div>
<div style="position:absolute;left:292.52px;top:385.19px" class="cls_032"><span class="cls_032">exif</span></div>
<div style="position:absolute;left:371.19px;top:385.19px" class="cls_032"><span class="cls_032">your models like Content,</span></div>
<div style="position:absolute;left:155.45px;top:396.67px" class="cls_032"><span class="cls_032">Audio|audio|1.0</span></div>
<div style="position:absolute;left:292.52px;top:396.67px" class="cls_032"><span class="cls_032">audio</span></div>
<div style="position:absolute;left:371.19px;top:396.67px" class="cls_032"><span class="cls_032">Folder, Versionable, and</span></div>
<div style="position:absolute;left:155.45px;top:408.16px" class="cls_032"><span class="cls_032">WebDAV|webdav|1.0</span></div>
<div style="position:absolute;left:292.52px;top:408.16px" class="cls_032"><span class="cls_032">webdav</span></div>
<div style="position:absolute;left:371.19px;top:408.16px" class="cls_032"><span class="cls_032">Auditable.</span></div>
<div style="position:absolute;left:60.00px;top:460.02px" class="cls_032"><span class="cls_032">bpmModel.xml</span></div>
<div style="position:absolute;left:155.45px;top:460.02px" class="cls_032"><span class="cls_032">model|bpm|1.0</span></div>
<div style="position:absolute;left:292.52px;top:460.02px" class="cls_032"><span class="cls_032">bpm</span></div>
<div style="position:absolute;left:332.35px;top:460.02px" class="cls_032"><span class="cls_032">d</span></div>
<div style="position:absolute;left:371.19px;top:460.02px" class="cls_032"><span class="cls_032">Advanced workflow</span></div>
<div style="position:absolute;left:332.35px;top:471.50px" class="cls_032"><span class="cls_032">sys</span></div>
<div style="position:absolute;left:371.19px;top:471.50px" class="cls_032"><span class="cls_032">types like task and</span></div>
<div style="position:absolute;left:332.35px;top:482.98px" class="cls_032"><span class="cls_032">cm</span></div>
<div style="position:absolute;left:371.19px;top:482.98px" class="cls_032"><span class="cls_032">startTask. Extend these</span></div>
<div style="position:absolute;left:332.35px;top:494.47px" class="cls_032"><span class="cls_032">usr</span></div>
<div style="position:absolute;left:371.19px;top:494.47px" class="cls_032"><span class="cls_032">when writing your own</span></div>
<div style="position:absolute;left:371.19px;top:505.95px" class="cls_032"><span class="cls_032">custom advanced</span></div>
<div style="position:absolute;left:371.19px;top:517.43px" class="cls_032"><span class="cls_032">workflows.</span></div>
<div style="position:absolute;left:60.00px;top:546.33px" class="cls_032"><span class="cls_032">siteModel.xml</span></div>
<div style="position:absolute;left:155.45px;top:546.33px" class="cls_032"><span class="cls_032">model|site|1.0</span></div>
<div style="position:absolute;left:292.52px;top:546.33px" class="cls_032"><span class="cls_032">st</span></div>
<div style="position:absolute;left:332.35px;top:546.33px" class="cls_032"><span class="cls_032">d</span></div>
<div style="position:absolute;left:371.19px;top:546.33px" class="cls_032"><span class="cls_032">Types and aspects related</span></div>
<div style="position:absolute;left:155.45px;top:557.81px" class="cls_032"><span class="cls_032">model|sitecustomproperty|1.0</span></div>
<div style="position:absolute;left:292.52px;top:557.81px" class="cls_032"><span class="cls_032">stcp</span></div>
<div style="position:absolute;left:332.35px;top:557.81px" class="cls_032"><span class="cls_032">cm</span></div>
<div style="position:absolute;left:371.19px;top:557.81px" class="cls_032"><span class="cls_032">to collaboration sites</span></div>
<div style="position:absolute;left:332.35px;top:569.30px" class="cls_032"><span class="cls_032">sys</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 94 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:73684px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background110.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:60.00px;top:73.83px" class="cls_032"><span class="cls_032">forumModel.xml</span></div>
<div style="position:absolute;left:155.45px;top:73.83px" class="cls_032"><span class="cls_032">model|forum|1.0</span></div>
<div style="position:absolute;left:292.52px;top:73.83px" class="cls_032"><span class="cls_032">fm</span></div>
<div style="position:absolute;left:332.35px;top:73.83px" class="cls_032"><span class="cls_032">d</span></div>
<div style="position:absolute;left:371.19px;top:73.83px" class="cls_032"><span class="cls_032">Types and aspects related</span></div>
<div style="position:absolute;left:332.35px;top:85.31px" class="cls_032"><span class="cls_032">cm</span></div>
<div style="position:absolute;left:371.19px;top:85.31px" class="cls_032"><span class="cls_032">to adding discussion</span></div>
<div style="position:absolute;left:371.19px;top:96.80px" class="cls_032"><span class="cls_032">threads to objects like</span></div>
<div style="position:absolute;left:371.19px;top:108.28px" class="cls_032"><span class="cls_032">forum, topic, and post</span></div>
<div style="position:absolute;left:56.69px;top:158.76px" class="cls_004"><span class="cls_004">The table lists the most often referenced models. Alfresco also includes four other model</span></div>
<div style="position:absolute;left:56.69px;top:171.36px" class="cls_004"><span class="cls_004">files related to the calendar, blog, datalist, links pages. It contains as well some models to</span></div>
<div style="position:absolute;left:56.69px;top:183.96px" class="cls_004"><span class="cls_004">manage external integration with Facebook, Twitter, FlickR or Youtube. And many others</span><span class="cls_022">…</span></div>
<div style="position:absolute;left:56.69px;top:206.39px" class="cls_004"><span class="cls_004">In addition to the model files, the </span><span class="cls_013">modelSchema.xsd</span><span class="cls_004"> file can be a good reference. It is</span></div>
<div style="position:absolute;left:56.69px;top:219.67px" class="cls_004"><span class="cls_004">located in </span><span class="cls_007">alfresco|model </span><span class="cls_004">in the </span><span class="cls_013">alfresco-data-model-5.x.jar</span><span class="cls_004"> file. As the name</span></div>
<div style="position:absolute;left:56.69px;top:232.95px" class="cls_004"><span class="cls_004">suggests, it defines the XML vocabulary Alfresco content model XML files must adhere to.</span></div>
<div style="position:absolute;left:56.69px;top:271.70px" class="cls_008"><span class="cls_008">Configuring the UI</span></div>
<div style="position:absolute;left:56.69px;top:299.43px" class="cls_004"><span class="cls_004">Now that the model is defined, you could begin using it right away by writing code against</span></div>
<div style="position:absolute;left:56.69px;top:312.03px" class="cls_004"><span class="cls_004">one of Alfresco's APIs that creates instances of your custom types, adds aspects, and so on.</span></div>
<div style="position:absolute;left:56.69px;top:324.63px" class="cls_004"><span class="cls_004">In practice, it is usually a good idea to do just that to make sure the model behaves as you</span></div>
<div style="position:absolute;left:56.69px;top:337.23px" class="cls_004"><span class="cls_004">expect. But you'd probably like to log in to Alfresco Share to see the fruits of your labor</span></div>
<div style="position:absolute;left:56.69px;top:349.83px" class="cls_004"><span class="cls_004">from the last section, so let's discuss what it takes to make that happen. By the end of this</span></div>
<div style="position:absolute;left:56.69px;top:362.43px" class="cls_004"><span class="cls_004">discussion, you will be able to use Alfresco Share to work with the SomeCo-specific content</span></div>
<div style="position:absolute;left:56.69px;top:375.03px" class="cls_004"><span class="cls_004">model to do things such as these:</span></div>
<div style="position:absolute;left:104.69px;top:396.76px" class="cls_004"><span class="cls_004">Display and update custom properties and associations</span></div>
<div style="position:absolute;left:104.69px;top:411.52px" class="cls_004"><span class="cls_004">Create instances of SomeCo-specific content types</span></div>
<div style="position:absolute;left:104.69px;top:426.28px" class="cls_004"><span class="cls_004">Configure actions that involve SomeCo types and aspects</span></div>
<div style="position:absolute;left:104.69px;top:441.04px" class="cls_004"><span class="cls_004">Use Advanced Search to query with SomeCo-specific parameters</span></div>
<div style="position:absolute;left:56.69px;top:464.93px" class="cls_004"><span class="cls_004">Configuring the UI to expose the custom content model involves overriding and extending</span></div>
<div style="position:absolute;left:56.69px;top:477.53px" class="cls_004"><span class="cls_004">Alfresco's out of the box Share configuration. To do this, you'll use different extension</span></div>
<div style="position:absolute;left:56.69px;top:490.13px" class="cls_004"><span class="cls_004">points provided by Alfresco Share.</span></div>
<div style="position:absolute;left:56.69px;top:526.82px" class="cls_014"><span class="cls_014">Step-by-step - configure Share forms</span></div>
<div style="position:absolute;left:56.69px;top:552.05px" class="cls_004"><span class="cls_004">When a user opens the details page of a content stored as one of the custom types or with</span></div>
<div style="position:absolute;left:56.69px;top:564.65px" class="cls_004"><span class="cls_004">one of the custom aspects attached, the property sheet should show the custom properties.</span></div>
<div style="position:absolute;left:56.69px;top:577.25px" class="cls_004"><span class="cls_004">If there are associations, those should be shown as well:</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 95 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:74360px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background111.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:262.46px" class="cls_004"><span class="cls_004">In order to configure the properties sheet to show custom properties and associations,</span></div>
<div style="position:absolute;left:56.69px;top:275.06px" class="cls_004"><span class="cls_004">follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:296.79px" class="cls_004"><span class="cls_004">1. In the </span><span class="cls_013">share</span><span class="cls_004"> Eclipse project, create a new XML file called </span><span class="cls_013">share-config-</span></div>
<div style="position:absolute;left:104.69px;top:310.07px" class="cls_013"><span class="cls_013">custom.xml</span><span class="cls_004"> in the directory </span><span class="cls_013">share</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">resources</span><span class="cls_004"> | </span><span class="cls_013">META-INF</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:323.35px" class="cls_013"><span class="cls_013">share-config-custom.xml</span><span class="cls_004">. Populate it with an empty </span><span class="cls_013">alfresco-config</span></div>
<div style="position:absolute;left:104.69px;top:336.63px" class="cls_004"><span class="cls_004">element. You'll add child elements to it in the subsequent steps.</span></div>
<div style="position:absolute;left:117.89px;top:359.84px" class="cls_010"><span class="cls_010">&lt;alfresco-config&gt;</span></div>
<div style="position:absolute;left:117.89px;top:370.64px" class="cls_010"><span class="cls_010">&lt;/alfresco-config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:391.25px" class="cls_004"><span class="cls_004">2. To display properties to property sheets, use the </span><span class="cls_013">aspect</span><span class="cls_004"> evaluator for aspects</span></div>
<div style="position:absolute;left:104.69px;top:404.53px" class="cls_004"><span class="cls_004">and the </span><span class="cls_013">node-type</span><span class="cls_004"> evaluator for content types. SomeCo has two aspects that</span></div>
<div style="position:absolute;left:104.69px;top:417.81px" class="cls_004"><span class="cls_004">need to be added to the properties sheet: </span><span class="cls_013">sc:webable</span><span class="cls_004"> and </span><span class="cls_013">sc:clientRelated</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:431.09px" class="cls_004"><span class="cls_004">For </span><span class="cls_013">sc:webable</span><span class="cls_004">, add the following </span><span class="cls_013">config</span><span class="cls_004"> element to </span><span class="cls_013">share-config-</span></div>
<div style="position:absolute;left:104.69px;top:444.37px" class="cls_013"><span class="cls_013">custom.xml</span><span class="cls_004"> as a child of </span><span class="cls_013">alfresco-config</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:112.49px;top:468.26px" class="cls_010"><span class="cls_010">&lt;configevaluator="aspect"condition="sc:webable"&gt;</span></div>
<div style="position:absolute;left:134.09px;top:479.06px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:155.69px;top:489.86px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:177.29px;top:500.66px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:198.89px;top:511.46px" class="cls_010"><span class="cls_010">&lt;show id="sc:published"/&gt;</span></div>
<div style="position:absolute;left:198.89px;top:522.26px" class="cls_010"><span class="cls_010">&lt;show id="sc:isActive"/&gt;</span></div>
<div style="position:absolute;left:188.09px;top:533.06px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:188.09px;top:543.86px" class="cls_010"><span class="cls_010">&lt;appearance&gt;</span></div>
<div style="position:absolute;left:209.69px;top:554.66px" class="cls_010"><span class="cls_010">&lt;field id="sc:isActive"read-only="true"/&gt;</span></div>
<div style="position:absolute;left:188.09px;top:565.46px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:155.69px;top:576.26px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 96 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:75036px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background112.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:134.09px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:112.49px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:101.23px" class="cls_004"><span class="cls_004">3.</span></div>
<div style="position:absolute;left:104.69px;top:101.23px" class="cls_004"><span class="cls_004">Add the </span><span class="cls_013">config</span><span class="cls_004"> element to show the properties for the </span><span class="cls_013">clientRelated</span><span class="cls_004"> aspect</span></div>
<div style="position:absolute;left:104.69px;top:114.51px" class="cls_004"><span class="cls_004">on your own.</span></div>
<div style="position:absolute;left:91.32px;top:129.27px" class="cls_004"><span class="cls_004">4.</span></div>
<div style="position:absolute;left:104.69px;top:129.27px" class="cls_004"><span class="cls_004">Add the following to display the </span><span class="cls_013">relatedDocuments</span><span class="cls_004"> association for SomeCo</span></div>
<div style="position:absolute;left:104.69px;top:142.55px" class="cls_004"><span class="cls_004">documents and Marketing documents:</span></div>
<div style="position:absolute;left:117.89px;top:165.76px" class="cls_010"><span class="cls_010">&lt;config evaluator="node-type" condition="sc:doc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:176.56px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:161.09px;top:187.36px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:198.16px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:204.29px;top:208.96px" class="cls_010"><span class="cls_010">&lt;show id="cm:name" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:219.76px" class="cls_010"><span class="cls_010">&lt;show id="cm:title" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:230.56px" class="cls_010"><span class="cls_010">&lt;show id="cm:description" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:241.36px" class="cls_010"><span class="cls_010">&lt;show id="mimetype" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:252.16px" class="cls_010"><span class="cls_010">&lt;show id="cm:author" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:262.96px" class="cls_010"><span class="cls_010">&lt;show id="size" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:273.76px" class="cls_010"><span class="cls_010">&lt;show id="cm:creator" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:284.56px" class="cls_010"><span class="cls_010">&lt;show id="cm:created" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:295.36px" class="cls_010"><span class="cls_010">&lt;show id="cm:modifier" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:306.16px" class="cls_010"><span class="cls_010">&lt;show id="cm:modified" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:316.96px" class="cls_010"><span class="cls_010">&lt;show id="sc:relatedDocuments" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:327.76px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:338.56px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:349.36px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:360.16px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:117.89px;top:370.96px" class="cls_010"><span class="cls_010">&lt;config evaluator="node-type" condition="sc:marketingDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:381.76px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:161.09px;top:392.56px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:403.36px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:204.29px;top:414.16px" class="cls_010"><span class="cls_010">&lt;show id="cm:name" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:424.96px" class="cls_010"><span class="cls_010">&lt;show id="cm:title" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:435.76px" class="cls_010"><span class="cls_010">&lt;show id="cm:description" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:446.56px" class="cls_010"><span class="cls_010">&lt;show id="mimetype" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:457.36px" class="cls_010"><span class="cls_010">&lt;show id="cm:author" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:468.16px" class="cls_010"><span class="cls_010">&lt;show id="size" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:478.96px" class="cls_010"><span class="cls_010">&lt;show id="cm:creator" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:489.76px" class="cls_010"><span class="cls_010">&lt;show id="cm:created" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:500.56px" class="cls_010"><span class="cls_010">&lt;show id="cm:modifier" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:511.36px" class="cls_010"><span class="cls_010">&lt;show id="cm:modified" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:522.16px" class="cls_010"><span class="cls_010">&lt;show id="sc:campaign" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:532.96px" class="cls_010"><span class="cls_010">&lt;show id="sc:relatedDocuments" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:543.76px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:554.56px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:565.36px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:576.16px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 97 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:75712px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background113.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Do the same by yourself to create the same configuration for the Whitepaper</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">documents using the Marketing document as example.</span></div>
<div style="position:absolute;left:91.32px;top:97.86px" class="cls_004"><span class="cls_004">6. Do the same by yourself to create the same configuration for the HR, Sales,</span></div>
<div style="position:absolute;left:104.69px;top:110.46px" class="cls_004"><span class="cls_004">Operations and Legal documents using the SomeCo document as example.</span></div>
<div style="position:absolute;left:91.32px;top:125.22px" class="cls_004"><span class="cls_004">7. Save the file.</span></div>
<div style="position:absolute;left:56.69px;top:149.11px" class="cls_004"><span class="cls_004">Unfortunately, you don't have an easy way to test your new configuration yet. We need to</span></div>
<div style="position:absolute;left:56.69px;top:161.71px" class="cls_004"><span class="cls_004">follow the next section to be able to specialize a content.</span></div>
<div style="position:absolute;left:122.09px;top:183.31px" class="cls_004"><span class="cls_004">In the previous code, the read-only attribute on the field element for</span></div>
<div style="position:absolute;left:122.09px;top:195.91px" class="cls_013"><span class="cls_013">sc:isActive</span><span class="cls_004"> prevents users from editing the property. It does not,</span></div>
<div style="position:absolute;left:122.09px;top:209.19px" class="cls_004"><span class="cls_004">however, prevent the property from being set through scripts or API calls.</span></div>
<div style="position:absolute;left:122.09px;top:221.79px" class="cls_004"><span class="cls_004">In this case, SomeCo wants it to be </span><span class="cls_022">“</span><span class="cls_004">read-only</span><span class="cls_022">”</span><span class="cls_004">, so that it can be set</span></div>
<div style="position:absolute;left:122.09px;top:235.22px" class="cls_004"><span class="cls_004">through other means such as by actions or during an approval step in a</span></div>
<div style="position:absolute;left:122.09px;top:247.82px" class="cls_004"><span class="cls_004">workflow.</span></div>
<div style="position:absolute;left:56.69px;top:284.52px" class="cls_014"><span class="cls_014">Step-by-step - adding types and aspects to</span></div>
<div style="position:absolute;left:56.69px;top:306.12px" class="cls_014"><span class="cls_014">Alfresco Share dropdowns</span></div>
<div style="position:absolute;left:56.69px;top:331.34px" class="cls_004"><span class="cls_004">When a user uploads a document in Alfresco, it uses the default type </span><span class="cls_013">cm:content</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:344.62px" class="cls_004"><span class="cls_004">However, it's possible to change or to specialize the type through Alfresco Share. As well,</span></div>
<div style="position:absolute;left:56.69px;top:357.22px" class="cls_004"><span class="cls_004">when you want to configure a rule on a folder, you may want to apply it only on documents</span></div>
<div style="position:absolute;left:56.69px;top:369.82px" class="cls_004"><span class="cls_004">using specific content types or aspects. In the create rule screen, the dropdown list will</span></div>
<div style="position:absolute;left:56.69px;top:382.42px" class="cls_004"><span class="cls_004">include automatically your custom types.</span></div>
<div style="position:absolute;left:56.69px;top:404.02px" class="cls_004"><span class="cls_004">Just as you did for custom properties and associations in the previous example, you have to</span></div>
<div style="position:absolute;left:56.69px;top:416.62px" class="cls_004"><span class="cls_004">override Alfresco Share configuration to get custom types and aspects to show up.</span></div>
<div style="position:absolute;left:56.69px;top:438.22px" class="cls_004"><span class="cls_004">To add custom types and aspects to the appropriate dropdowns, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:459.95px" class="cls_004"><span class="cls_004">1. Edit </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:475.39px" class="cls_004"><span class="cls_004">2. To add content types to the list of available types in the </span><span class="cls_007">change type</span><span class="cls_004"> dialog, use</span></div>
<div style="position:absolute;left:104.69px;top:488.03px" class="cls_004"><span class="cls_004">the </span><span class="cls_013">string-compare</span><span class="cls_004"> evaluator and the </span><span class="cls_013">DocumentLibrarycondition</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:117.89px;top:511.92px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:139.49px;top:522.72px" class="cls_010"><span class="cls_010">condition="DocumentLibrary" replace="true"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:533.52px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 98 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:76388px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background114.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. As you can see below, the list of valid child types depends of the parent type.</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">Add the following inside the </span><span class="cls_013">config</span><span class="cls_004"> element:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">&lt;types&gt;</span></div>
<div style="position:absolute;left:139.49px;top:117.79px" class="cls_010"><span class="cls_010">&lt;type name="cm:content"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:128.59px" class="cls_010"><span class="cls_010">&lt;subtype name="smf:smartFolderTemplate" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:139.39px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:doc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:150.19px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:marketingDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:160.99px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:whitepaper" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:171.79px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:hrDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:182.59px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:salesDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:193.39px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:opsDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:204.19px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:legalDoc" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:214.99px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:139.49px;top:236.59px" class="cls_010"><span class="cls_010">&lt;type name="sc:doc"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:247.39px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:marketingDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:258.19px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:whitepaper" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:268.99px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:hrDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:279.79px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:salesDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:290.59px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:opsDoc" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:301.39px" class="cls_010"><span class="cls_010">&lt;subtype name="sc:legalDoc" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:312.19px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:139.49px;top:333.79px" class="cls_010"><span class="cls_010">&lt;type name="cm:folder"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:344.59px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:139.49px;top:366.19px" class="cls_010"><span class="cls_010">&lt;type name="trx:transferTarget"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:376.99px" class="cls_010"><span class="cls_010">&lt;subtype name="trx:fileTransferTarget" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:387.79px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:117.89px;top:398.59px" class="cls_010"><span class="cls_010">&lt;/types&gt;</span></div>
<div style="position:absolute;left:91.32px;top:419.20px" class="cls_004"><span class="cls_004">4. To add aspects to the list of available aspects in the </span><span class="cls_007">manage aspects</span><span class="cls_004"> dialog, use</span></div>
<div style="position:absolute;left:104.69px;top:431.84px" class="cls_004"><span class="cls_004">the same </span><span class="cls_013">config</span><span class="cls_004"> element, just add the following after </span><span class="cls_013">&lt;/types&gt;</span><span class="cls_004"> (note that the</span></div>
<div style="position:absolute;left:104.69px;top:445.12px" class="cls_004"><span class="cls_004">addable and removable tags are empty, it means that we'll use the same list as the</span></div>
<div style="position:absolute;left:104.69px;top:457.72px" class="cls_013"><span class="cls_013">visible</span><span class="cls_004"> tag. It allows to avoid duplication):</span></div>
<div style="position:absolute;left:117.89px;top:481.61px" class="cls_010"><span class="cls_010">&lt;aspects&gt;</span></div>
<div style="position:absolute;left:139.49px;top:492.41px" class="cls_010"><span class="cls_010">&lt;visible&gt;</span></div>
<div style="position:absolute;left:161.09px;top:503.21px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:generalclassifiable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:514.01px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:complianceable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:524.81px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:dublincore" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:535.61px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:effectivity" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:546.41px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:summarizable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:557.21px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:versionable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:568.01px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:templatable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:578.81px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:emailed" /&gt;</span></div>
<div style="position:absolute;left:257.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 99 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:77064px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background115.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">&lt;aspect name="emailserver:aliasable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:80.62px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:taggable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:91.42px" class="cls_010"><span class="cls_010">&lt;aspect name="app:inlineeditable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:102.22px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:geographic" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:113.02px" class="cls_010"><span class="cls_010">&lt;aspect name="exif:exif" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:123.82px" class="cls_010"><span class="cls_010">&lt;aspect name="audio:audio" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:134.62px" class="cls_010"><span class="cls_010">&lt;aspect name="cm:indexControl" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:145.42px" class="cls_010"><span class="cls_010">&lt;aspect name="dp:restrictable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:156.22px" class="cls_010"><span class="cls_010">&lt;aspect name="smf:customConfigSmartFolder" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:167.02px" class="cls_010"><span class="cls_010">&lt;aspect name="smf:systemConfigSmartFolder" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:177.82px" class="cls_010"><span class="cls_010">&lt;aspect name="sc:webable" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:188.62px" class="cls_010"><span class="cls_010">&lt;aspect name="sc:clientRelated" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:199.42px" class="cls_010"><span class="cls_010">&lt;/visible&gt;</span></div>
<div style="position:absolute;left:139.49px;top:210.22px" class="cls_010"><span class="cls_010">&lt;addable&gt;&lt;/addable&gt;</span></div>
<div style="position:absolute;left:139.49px;top:221.02px" class="cls_010"><span class="cls_010">&lt;removeable&gt;&lt;/removeable&gt;</span></div>
<div style="position:absolute;left:117.89px;top:231.82px" class="cls_010"><span class="cls_010">&lt;/aspects&gt;</span></div>
<div style="position:absolute;left:91.32px;top:252.43px" class="cls_004"><span class="cls_004">5. Save the </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:267.87px" class="cls_004"><span class="cls_004">6. Stop Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:282.63px" class="cls_004"><span class="cls_004">7. Package and move the module to your virtual machine. (As usual, feel free to run</span></div>
<div style="position:absolute;left:104.69px;top:295.23px" class="cls_004"><span class="cls_004">first the project from your machine using Maven to test.)</span></div>
<div style="position:absolute;left:91.32px;top:309.99px" class="cls_004"><span class="cls_004">8. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:56.69px;top:333.88px" class="cls_004"><span class="cls_004">Now, let's finally test our configuration. You should be able to log in to Alfresco Share and</span></div>
<div style="position:absolute;left:56.69px;top:346.48px" class="cls_004"><span class="cls_004">upload a document. Open the details page of this document by clicking on the document</span></div>
<div style="position:absolute;left:56.69px;top:359.08px" class="cls_004"><span class="cls_004">name, and click on the </span><span class="cls_007">Change Type </span><span class="cls_004">action in the right toolbar. You should see this dialog:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 100 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:77740px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background116.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Select </span><span class="cls_007">sc:doc</span><span class="cls_004"> and validate. Automatically, the panel </span><span class="cls_007">Properties</span><span class="cls_004"> on the right side is updated</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">and should display your custom association:</span></div>
<div style="position:absolute;left:56.69px;top:286.41px" class="cls_004"><span class="cls_004">If you edit the properties, you'll be able to populate your association. Remember that you</span></div>
<div style="position:absolute;left:56.69px;top:299.01px" class="cls_004"><span class="cls_004">can only create association with </span><span class="cls_013">sc:doc</span><span class="cls_004"> documents. If you want to test this feature, we</span></div>
<div style="position:absolute;left:56.69px;top:312.29px" class="cls_004"><span class="cls_004">recommend you to create multiple files and change the type to all of them to be able to test</span></div>
<div style="position:absolute;left:56.69px;top:324.89px" class="cls_004"><span class="cls_004">the association. Click on the </span><span class="cls_007">Change Type</span><span class="cls_004"> action, and the new list of types should be</span></div>
<div style="position:absolute;left:56.69px;top:337.53px" class="cls_004"><span class="cls_004">shorter:</span></div>
<div style="position:absolute;left:56.69px;top:486.05px" class="cls_004"><span class="cls_004">Select </span><span class="cls_007">sc:whitepaper</span><span class="cls_004">. Automatically, the panel </span><span class="cls_007">Properties</span><span class="cls_004"> on the right side is updated and</span></div>
<div style="position:absolute;left:56.69px;top:498.68px" class="cls_004"><span class="cls_004">should display your custom property related to the campaign:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 101 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:78416px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background117.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:245.96px" class="cls_004"><span class="cls_004">By clicking on the </span><span class="cls_007">Edit Properties </span><span class="cls_004">button, you should see a component that lets you choose</span></div>
<div style="position:absolute;left:56.69px;top:258.60px" class="cls_004"><span class="cls_004">the associated campaigns.</span></div>
<div style="position:absolute;left:56.69px;top:280.20px" class="cls_004"><span class="cls_004">To test the aspect-related changes, click on the </span><span class="cls_007">Manage Aspects</span><span class="cls_004"> action. At the bottom of the</span></div>
<div style="position:absolute;left:56.69px;top:292.84px" class="cls_004"><span class="cls_004">list, you should see the two SomeCo aspects:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 102 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:79092px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background118.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Select the two SomeCo aspects, and check the </span><span class="cls_007">Properties</span><span class="cls_004"> panel. You should see four new</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">properties displayed.</span></div>
<div style="position:absolute;left:56.69px;top:104.74px" class="cls_004"><span class="cls_004">To test the changes related to rules, click on </span><span class="cls_007">Manage Rules</span><span class="cls_004"> action on a folder and create a</span></div>
<div style="position:absolute;left:56.69px;top:117.38px" class="cls_004"><span class="cls_004">new one. If you want to use the type as criteria, you can use the SomeCo types:</span></div>
<div style="position:absolute;left:56.69px;top:273.40px" class="cls_004"><span class="cls_004">You can use as well the aspect as criteria:</span></div>
<div style="position:absolute;left:56.69px;top:493.92px" class="cls_004"><span class="cls_004">Finally, you can check that you can use the SomeCo content types if you want to specialize a</span></div>
<div style="position:absolute;left:56.69px;top:506.52px" class="cls_004"><span class="cls_004">content in the </span><span class="cls_007">Perform Action</span><span class="cls_004"> section. You can use as well the SomeCo aspects in the </span><span class="cls_007">Add</span></div>
<div style="position:absolute;left:56.69px;top:519.15px" class="cls_007"><span class="cls_007">Aspect</span><span class="cls_004"> and </span><span class="cls_007">Remove Aspect</span><span class="cls_004"> action.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 103 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:79768px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background119.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - externalizing display labels</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Note that some labels show the technical name. For example, the </span><span class="cls_007">Properties</span><span class="cls_004"> panel displays</span></div>
<div style="position:absolute;left:56.69px;top:107.62px" class="cls_004"><span class="cls_004">properly the association by displaying </span><span class="cls_007">Related Documents</span><span class="cls_004">. However, it doesn't display</span></div>
<div style="position:absolute;left:56.69px;top:120.26px" class="cls_004"><span class="cls_004">properly the campaign property. The first reason is that we used the tag title on the</span></div>
<div style="position:absolute;left:56.69px;top:132.86px" class="cls_004"><span class="cls_004">association, and not on the campaign property. We could populate directly all titles in the</span></div>
<div style="position:absolute;left:56.69px;top:145.46px" class="cls_004"><span class="cls_004">content model. But a better practice is to externalize the string so that the interface can be</span></div>
<div style="position:absolute;left:56.69px;top:158.06px" class="cls_004"><span class="cls_004">localized if needed.</span></div>
<div style="position:absolute;left:91.32px;top:179.79px" class="cls_004"><span class="cls_004">1. In the </span><span class="cls_013">share</span><span class="cls_004"> Eclipse project, edit the file </span><span class="cls_013">share.properties</span><span class="cls_004"> located in the</span></div>
<div style="position:absolute;left:104.69px;top:193.07px" class="cls_004"><span class="cls_004">directory </span><span class="cls_013">share</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">web-extension</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:206.35px" class="cls_013"><span class="cls_013">message</span><span class="cls_004">. Add the following properties:</span></div>
<div style="position:absolute;left:117.89px;top:230.24px" class="cls_010"><span class="cls_010">type.sc_doc=Someco Document</span></div>
<div style="position:absolute;left:117.89px;top:241.04px" class="cls_010"><span class="cls_010">type.sc_marketingDoc=Someco Marketing Document</span></div>
<div style="position:absolute;left:117.89px;top:251.84px" class="cls_010"><span class="cls_010">type.sc_whitepaper=Someco Whitepaper</span></div>
<div style="position:absolute;left:117.89px;top:262.64px" class="cls_010"><span class="cls_010">type.sc_hrDoc=Someco HR Document</span></div>
<div style="position:absolute;left:117.89px;top:273.44px" class="cls_010"><span class="cls_010">type.sc_salesDoc=Someco Sales Document</span></div>
<div style="position:absolute;left:117.89px;top:284.24px" class="cls_010"><span class="cls_010">type.sc_opsDoc=Someco Operations Document</span></div>
<div style="position:absolute;left:117.89px;top:295.04px" class="cls_010"><span class="cls_010">type.sc_legalDoc=Someco Legal Document</span></div>
<div style="position:absolute;left:117.89px;top:305.84px" class="cls_010"><span class="cls_010">aspect.sc_webable=SomecoWebable</span></div>
<div style="position:absolute;left:117.89px;top:316.64px" class="cls_010"><span class="cls_010">aspect.sc_clientRelated=Someco Client Metadata</span></div>
<div style="position:absolute;left:91.32px;top:337.25px" class="cls_004"><span class="cls_004">2. In the </span><span class="cls_013">repo</span><span class="cls_004"> Eclipse project, create the file </span><span class="cls_013">scModel.properties</span><span class="cls_004"> in the directory</span></div>
<div style="position:absolute;left:104.69px;top:350.52px" class="cls_013"><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">messages</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:363.80px" class="cls_004"><span class="cls_004">Add the following properties:</span></div>
<div style="position:absolute;left:117.89px;top:387.02px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_doc.title=Someco Document</span></div>
<div style="position:absolute;left:117.89px;top:397.82px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_marketingDoc.title=Someco Marketing Document</span></div>
<div style="position:absolute;left:117.89px;top:408.61px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_whitepaper.title=SomecoWhitepaper</span></div>
<div style="position:absolute;left:117.89px;top:419.42px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_hrDoc.title=Someco HR Document</span></div>
<div style="position:absolute;left:117.89px;top:430.21px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_salesDoc.title=Someco Sales Document</span></div>
<div style="position:absolute;left:117.89px;top:441.02px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_opsDoc.title=Someco Operations Document</span></div>
<div style="position:absolute;left:117.89px;top:451.82px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_legalDoc.title=Someco Legal Document</span></div>
<div style="position:absolute;left:117.89px;top:462.61px" class="cls_010"><span class="cls_010">sc_somecomodel.aspect.sc_webable.title=SomecoWebable</span></div>
<div style="position:absolute;left:117.89px;top:473.42px" class="cls_010"><span class="cls_010">sc_somecomodel.aspect.sc_clientRelated.title=Someco Client Metadata</span></div>
<div style="position:absolute;left:117.89px;top:484.21px" class="cls_010"><span class="cls_010">sc_somecomodel.association.sc_relatedDocuments.title=Related</span></div>
<div style="position:absolute;left:74.69px;top:495.02px" class="cls_010"><span class="cls_010">Documents</span></div>
<div style="position:absolute;left:117.89px;top:505.82px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_campaign.title=Campaign</span></div>
<div style="position:absolute;left:117.89px;top:516.61px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_published.title=Published date</span></div>
<div style="position:absolute;left:117.89px;top:527.41px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_isActive.title=Active?</span></div>
<div style="position:absolute;left:117.89px;top:538.22px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_clientName.title=Client Name</span></div>
<div style="position:absolute;left:117.89px;top:549.02px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_projectName.title=Project Name</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 104 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:80444px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background120.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. In the repo Eclipse project, locate the file </span><span class="cls_013">bootstrap-context.xml</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">directory </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_013"><span class="cls_013">context</span><span class="cls_004">. Update the dictionary bootstrap by adding a new property:</span></div>
<div style="position:absolute;left:117.89px;top:120.95px" class="cls_010"><span class="cls_010">&lt;property name="labels"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:131.75px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:142.55px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco/module/${project.artifactId}</span></div>
<div style="position:absolute;left:150.29px;top:153.35px" class="cls_010"><span class="cls_010">/messages/scModel&lt;/value&gt;</span></div>
<div style="position:absolute;left:128.69px;top:164.15px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:117.89px;top:174.95px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:91.32px;top:195.56px" class="cls_004"><span class="cls_004">4. Save these different files.</span></div>
<div style="position:absolute;left:91.32px;top:210.32px" class="cls_004"><span class="cls_004">5. Stop Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:225.08px" class="cls_004"><span class="cls_004">6. Package and move the modules to your virtual machine.</span></div>
<div style="position:absolute;left:91.32px;top:239.84px" class="cls_004"><span class="cls_004">7. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:91.32px;top:254.61px" class="cls_004"><span class="cls_004">8. If you follow the same steps as explained in the previous </span><span class="cls_012">step-by-step</span><span class="cls_004"> instructions,</span></div>
<div style="position:absolute;left:104.69px;top:267.21px" class="cls_004"><span class="cls_004">you should notice that all type, aspect and property titles are properly displayed.</span></div>
<div style="position:absolute;left:56.69px;top:304.14px" class="cls_023"><span class="cls_023">Setting up additional locales</span></div>
<div style="position:absolute;left:56.69px;top:326.86px" class="cls_004"><span class="cls_004">The whole point in externalizing the labels is that Alfresco Share can be localized to</span></div>
<div style="position:absolute;left:56.69px;top:339.46px" class="cls_004"><span class="cls_004">multiple languages. If you want to create a set of labels for a specific locale, you would</span></div>
<div style="position:absolute;left:56.69px;top:352.06px" class="cls_004"><span class="cls_004">create a file in the same directory called </span><span class="cls_013">scModel_[locale].properties</span><span class="cls_004"> with the same</span></div>
<div style="position:absolute;left:56.69px;top:365.34px" class="cls_004"><span class="cls_004">keys and their localized values. For the share project, it's the same step. You need to create a</span></div>
<div style="position:absolute;left:56.69px;top:377.94px" class="cls_004"><span class="cls_004">file in the same directory called </span><span class="cls_013">share_[locale].properties</span><span class="cls_004"> with the same keys and</span></div>
<div style="position:absolute;left:56.69px;top:391.22px" class="cls_004"><span class="cls_004">their localized values. Of course [locale] is just a placeholder for the locale identifier you are</span></div>
<div style="position:absolute;left:56.69px;top:403.82px" class="cls_004"><span class="cls_004">working one. If you want to create a message file containing the French values, the</span></div>
<div style="position:absolute;left:56.69px;top:416.42px" class="cls_004"><span class="cls_004">filenames will be </span><span class="cls_013">scModel_fr.properties</span><span class="cls_004"> and </span><span class="cls_013">share_fr.properties</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:453.79px" class="cls_014"><span class="cls_014">Step-by-step - adding properties and types to</span></div>
<div style="position:absolute;left:56.69px;top:475.39px" class="cls_014"><span class="cls_014">advanced search</span></div>
<div style="position:absolute;left:56.69px;top:500.62px" class="cls_004"><span class="cls_004">When a user runs an advanced search, he or she should be able to restrict search results to</span></div>
<div style="position:absolute;left:56.69px;top:513.22px" class="cls_004"><span class="cls_004">instances of custom types and/or content with specific values for the properties of custom</span></div>
<div style="position:absolute;left:56.69px;top:525.82px" class="cls_004"><span class="cls_004">types. As before, this involves modifying </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 105 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:81120px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background121.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To add custom properties and types to the advanced search dialog, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:92.23px" class="cls_004"><span class="cls_004">1. First, we need to create a search form for each custom content type. Create a new</span></div>
<div style="position:absolute;left:104.69px;top:104.83px" class="cls_013"><span class="cls_013">config</span><span class="cls_004"> element with the </span><span class="cls_013">model-type</span><span class="cls_004"> evaluator and the condition equals to the</span></div>
<div style="position:absolute;left:104.69px;top:118.11px" class="cls_004"><span class="cls_004">content type. Follow this template for the marketing document and whitepaper:</span></div>
<div style="position:absolute;left:117.89px;top:141.32px" class="cls_010"><span class="cls_010">&lt;config evaluator="model-type" condition="sc:marketingDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:152.12px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:161.09px;top:162.92px" class="cls_010"><span class="cls_010">&lt;form id="search"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:173.72px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:182.69px;top:184.52px" class="cls_010"><span class="cls_010">&lt;show id="cm:name" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:195.32px" class="cls_010"><span class="cls_010">&lt;show id="cm:title" force="true" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:206.12px" class="cls_010"><span class="cls_010">&lt;show id="cm:description" force="true" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:216.92px" class="cls_010"><span class="cls_010">&lt;show id="mimetype" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:227.72px" class="cls_010"><span class="cls_010">&lt;show id="cm:modifier" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:238.52px" class="cls_010"><span class="cls_010">&lt;show id="cm:modified" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:249.32px" class="cls_010"><span class="cls_010">&lt;show id="sc:campaign" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:260.12px" class="cls_010"><span class="cls_010">&lt;show id="sc:relatedDocuments" /&gt;</span></div>
<div style="position:absolute;left:171.89px;top:270.92px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:281.72px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:292.52px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:303.32px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:323.93px" class="cls_004"><span class="cls_004">2. Then, use the following templates for the other content types:</span></div>
<div style="position:absolute;left:117.89px;top:347.14px" class="cls_010"><span class="cls_010">&lt;config evaluator="model-type" condition="sc:hrDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:357.94px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:161.09px;top:368.74px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:379.54px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:204.29px;top:390.34px" class="cls_010"><span class="cls_010">&lt;show id="cm:name" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:401.14px" class="cls_010"><span class="cls_010">&lt;show id="cm:title" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:411.94px" class="cls_010"><span class="cls_010">&lt;show id="cm:description" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:422.74px" class="cls_010"><span class="cls_010">&lt;show id="mimetype" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:433.54px" class="cls_010"><span class="cls_010">&lt;show id="cm:author" force="true" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:444.34px" class="cls_010"><span class="cls_010">&lt;show id="size" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:455.14px" class="cls_010"><span class="cls_010">&lt;show id="cm:creator" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:465.94px" class="cls_010"><span class="cls_010">&lt;show id="cm:created" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:476.74px" class="cls_010"><span class="cls_010">&lt;show id="cm:modifier" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:487.54px" class="cls_010"><span class="cls_010">&lt;show id="cm:modified" for-mode="view" /&gt;</span></div>
<div style="position:absolute;left:204.29px;top:498.34px" class="cls_010"><span class="cls_010">&lt;show id="sc:relatedDocuments" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:509.14px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:519.94px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:530.74px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:541.54px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 106 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:81796px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background122.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Finally, we need to enable these new search forms. In the same file, create a new</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">config</span><span class="cls_004"> element using the </span><span class="cls_013">string-compare</span><span class="cls_004"> evaluator and the</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_013"><span class="cls_013">AdvancedSearchcondition</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:120.27px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare" condition="AdvancedSearch"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:131.07px" class="cls_010"><span class="cls_010">&lt;advanced-search&gt;</span></div>
<div style="position:absolute;left:161.09px;top:141.87px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:182.69px;top:152.67px" class="cls_010"><span class="cls_010">&lt;form labelId="type.sc_doc"</span></div>
<div style="position:absolute;left:182.69px;top:163.47px" class="cls_010"><span class="cls_010">descriptionId="search.form.label.sc_doc"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:174.27px" class="cls_010"><span class="cls_010">sc:doc&lt;/form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:185.07px" class="cls_010"><span class="cls_010">&lt;form labelId="type.sc_marketingDoc"</span></div>
<div style="position:absolute;left:182.69px;top:195.87px" class="cls_010"><span class="cls_010">descriptionId="search.form.label.sc_marketingDoc"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:206.67px" class="cls_010"><span class="cls_010">sc:marketingDoc&lt;/form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:217.47px" class="cls_010"><span class="cls_010">&lt;form labelId="type.sc_whitepaper"</span></div>
<div style="position:absolute;left:182.69px;top:228.27px" class="cls_010"><span class="cls_010">descriptionId="search.form.label.sc_whitepaper"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:239.07px" class="cls_010"><span class="cls_010">sc:whitepaper&lt;/form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:249.87px" class="cls_010"><span class="cls_010">&lt;form labelId="type.sc_hrDoc"</span></div>
<div style="position:absolute;left:182.69px;top:260.67px" class="cls_010"><span class="cls_010">descriptionId="search.form.label.sc_hrDoc"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:271.47px" class="cls_010"><span class="cls_010">sc:hrDoc&lt;/form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:282.27px" class="cls_010"><span class="cls_010">&lt;form labelId="type.sc_salesDoc"</span></div>
<div style="position:absolute;left:182.69px;top:293.07px" class="cls_010"><span class="cls_010">descriptionId="search.form.label.sc_salesDoc"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:303.87px" class="cls_010"><span class="cls_010">sc:salesDoc&lt;/form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:325.47px" class="cls_010"><span class="cls_010">&lt;form labelId="type.sc_opsDoc"</span></div>
<div style="position:absolute;left:182.69px;top:336.27px" class="cls_010"><span class="cls_010">descriptionId="search.form.label.sc_opsDoc"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:347.07px" class="cls_010"><span class="cls_010">sc:opsDoc&lt;/form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:357.87px" class="cls_010"><span class="cls_010">&lt;form labelId="type.sc_legalDoc"</span></div>
<div style="position:absolute;left:182.69px;top:368.67px" class="cls_010"><span class="cls_010">descriptionId="search.form.label.sc_legalDoc"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:379.47px" class="cls_010"><span class="cls_010">sc:legalDoc&lt;/form&gt;</span></div>
<div style="position:absolute;left:161.09px;top:390.27px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:139.49px;top:401.07px" class="cls_010"><span class="cls_010">&lt;/advanced-search&gt;</span></div>
<div style="position:absolute;left:117.89px;top:411.87px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:432.48px" class="cls_004"><span class="cls_004">4. Save the </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:447.92px" class="cls_004"><span class="cls_004">5. Stop Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:462.68px" class="cls_004"><span class="cls_004">6. Package and move the module to your virtual Machine.</span></div>
<div style="position:absolute;left:91.32px;top:477.44px" class="cls_004"><span class="cls_004">7. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:91.32px;top:492.20px" class="cls_004"><span class="cls_004">8. To test out this change, log in to Alfresco Share and go to </span><span class="cls_007">Advanced Search</span><span class="cls_004">. The</span></div>
<div style="position:absolute;left:104.69px;top:504.84px" class="cls_004"><span class="cls_004">SomeCo types should be listed in the </span><span class="cls_007">Look For</span><span class="cls_004"> dropdown.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 107 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:82472px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background123.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:400.36px" class="cls_008"><span class="cls_008">Working with content programmatically</span></div>
<div style="position:absolute;left:56.69px;top:428.09px" class="cls_004"><span class="cls_004">Now the repository has a custom model and that model has been exposed to Alfresco Share.</span></div>
<div style="position:absolute;left:56.69px;top:440.69px" class="cls_004"><span class="cls_004">For simple document management solutions, this may be enough. But often, code will also</span></div>
<div style="position:absolute;left:56.69px;top:453.29px" class="cls_004"><span class="cls_004">be required as a part of your implementation. It might be code in a web application that</span></div>
<div style="position:absolute;left:56.69px;top:465.89px" class="cls_004"><span class="cls_004">needs to work with the repository, code that implements custom behavior for custom</span></div>
<div style="position:absolute;left:56.69px;top:478.49px" class="cls_004"><span class="cls_004">content types, code that implements Alfresco Share customizations, or code that</span></div>
<div style="position:absolute;left:56.69px;top:491.09px" class="cls_004"><span class="cls_004">implements a controller for a web script.</span></div>
<div style="position:absolute;left:56.69px;top:512.70px" class="cls_004"><span class="cls_004">As mentioned in </span><span class="cls_010">Chapter 1</span><span class="cls_004">, </span><span class="cls_012">The Alfresco Platform</span><span class="cls_004">, there are several APIs available</span></div>
<div style="position:absolute;left:56.69px;top:525.68px" class="cls_004"><span class="cls_004">depending on what you want to do. Let's learn how to use code to create content, create</span></div>
<div style="position:absolute;left:56.69px;top:538.28px" class="cls_004"><span class="cls_004">associations between content, search for content, and delete content. You'll see a JavaScript</span></div>
<div style="position:absolute;left:56.69px;top:550.88px" class="cls_004"><span class="cls_004">example, several examples using the CMIS API with Java.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 108 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:83148px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background124.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - creating content with JavaScript</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">The first example shows how to specialize some content and add aspects to that content</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">using JavaScript. To specialize content, add aspects, and set properties using JavaScript,</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:141.91px" class="cls_004"><span class="cls_004">1. Create a new file in </span><span class="cls_007">repo|src|scripts </span><span class="cls_004">called </span><span class="cls_013">createWhitepaper.js</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:157.35px" class="cls_004"><span class="cls_004">2. Set up some variables you'll use later in the script. The </span><span class="cls_013">document</span><span class="cls_004"> variable is a</span></div>
<div style="position:absolute;left:104.69px;top:170.63px" class="cls_004"><span class="cls_004">root object that is available when the script is executed against a document.</span></div>
<div style="position:absolute;left:117.89px;top:193.84px" class="cls_010"><span class="cls_010">var contentType = "whitepaper";</span></div>
<div style="position:absolute;left:117.89px;top:204.64px" class="cls_010"><span class="cls_010">var contentName = "wp-";</span></div>
<div style="position:absolute;left:117.89px;top:215.44px" class="cls_010"><span class="cls_010">var timestamp = new Date().getTime();</span></div>
<div style="position:absolute;left:117.89px;top:226.24px" class="cls_010"><span class="cls_010">var extension = document.name.substr(document</span></div>
<div style="position:absolute;left:128.69px;top:237.04px" class="cls_010"><span class="cls_010">.name.lastIndexOf('.') + 1);</span></div>
<div style="position:absolute;left:91.32px;top:257.65px" class="cls_004"><span class="cls_004">3. Write code that will specialize the uploaded document.</span></div>
<div style="position:absolute;left:117.89px;top:280.86px" class="cls_010"><span class="cls_010">document.specializeType("sc:" + contentType);</span></div>
<div style="position:absolute;left:91.32px;top:301.47px" class="cls_004"><span class="cls_004">4. Add a statement that uses the ScriptNode API to add the </span><span class="cls_013">sc:webable</span><span class="cls_004"> aspect.</span></div>
<div style="position:absolute;left:117.89px;top:325.36px" class="cls_010"><span class="cls_010">document.addAspect("sc:webable");</span></div>
<div style="position:absolute;left:91.32px;top:345.97px" class="cls_004"><span class="cls_004">5. Add code to set some properties. These properties include out of the box</span></div>
<div style="position:absolute;left:104.69px;top:358.57px" class="cls_004"><span class="cls_004">properties such as </span><span class="cls_013">cm:name</span><span class="cls_004"> as well as SomeCo-specific properties. Notice the</span></div>
<div style="position:absolute;left:104.69px;top:371.85px" class="cls_013"><span class="cls_013">contentName</span><span class="cls_004"> and </span><span class="cls_013">timestamp</span><span class="cls_004"> variables are being concatenated to make sure the</span></div>
<div style="position:absolute;left:104.69px;top:385.13px" class="cls_004"><span class="cls_004">name is unique on successive runs.</span></div>
<div style="position:absolute;left:117.89px;top:408.34px" class="cls_010"><span class="cls_010">document.properties["cm:name"] = contentName</span></div>
<div style="position:absolute;left:139.49px;top:419.14px" class="cls_010"><span class="cls_010">+ " (" + timestamp + ")." + extension;</span></div>
<div style="position:absolute;left:117.89px;top:429.94px" class="cls_010"><span class="cls_010">document.properties["sc:isActive"] = true;</span></div>
<div style="position:absolute;left:117.89px;top:440.74px" class="cls_010"><span class="cls_010">document.properties["sc:published"] = new Date("07/31/2016");</span></div>
<div style="position:absolute;left:91.32px;top:461.35px" class="cls_004"><span class="cls_004">6. Call save to persist the changes.</span></div>
<div style="position:absolute;left:117.89px;top:484.56px" class="cls_010"><span class="cls_010">document.save();</span></div>
<div style="position:absolute;left:91.32px;top:505.17px" class="cls_004"><span class="cls_004">7. Test the script by uploading it to the repository and then running it against a</span></div>
<div style="position:absolute;left:104.69px;top:517.77px" class="cls_004"><span class="cls_004">folder. Using Alfresco Share, upload the file to the Data </span><span class="cls_013">Dictionary/Scripts</span></div>
<div style="position:absolute;left:104.69px;top:531.05px" class="cls_004"><span class="cls_004">folder.</span></div>
<div style="position:absolute;left:91.32px;top:545.81px" class="cls_004"><span class="cls_004">8. Create a new site called </span><span class="cls_007">Marketing</span><span class="cls_004">, open the </span><span class="cls_007">Document Library</span><span class="cls_004">, create a new</span></div>
<div style="position:absolute;left:104.69px;top:558.45px" class="cls_004"><span class="cls_004">folder called </span><span class="cls_007">Whitepapers</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 109 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:83824px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background125.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. On this newly created folder, click on </span><span class="cls_007">Manage Rules</span><span class="cls_004">, </span><span class="cls_007">Create Rules</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:104.69px;top:94.43px" class="cls_007"><span class="cls_007">Name</span><span class="cls_004">: Create a new whitepaper</span></div>
<div style="position:absolute;left:104.69px;top:109.23px" class="cls_007"><span class="cls_007">When</span><span class="cls_004">: Items are created or enter this folder</span></div>
<div style="position:absolute;left:104.69px;top:124.02px" class="cls_007"><span class="cls_007">If</span><span class="cls_004">: Content of type of sub-type is Content</span></div>
<div style="position:absolute;left:104.69px;top:138.82px" class="cls_007"><span class="cls_007">Perform Action</span><span class="cls_004">: Execute script </span><span class="cls_013">createWhitepaper.js</span></div>
<div style="position:absolute;left:86.07px;top:163.39px" class="cls_004"><span class="cls_004">10. Click on </span><span class="cls_007">Create. </span><span class="cls_004">Open the directory </span><span class="cls_007">Whitepapers</span><span class="cls_004">, and upload a new document.</span></div>
<div style="position:absolute;left:56.69px;top:187.32px" class="cls_004"><span class="cls_004">The new document has been specialized to become a whitepaper. The name should be</span></div>
<div style="position:absolute;left:56.69px;top:199.92px" class="cls_004"><span class="cls_004">changed automatically, and you should notice the additional properties added to the</span></div>
<div style="position:absolute;left:56.69px;top:212.52px" class="cls_004"><span class="cls_004">document. Later in the book, you'll add a new UI action that makes executing scripts even</span></div>
<div style="position:absolute;left:56.69px;top:225.12px" class="cls_004"><span class="cls_004">easier.</span></div>
<div style="position:absolute;left:56.69px;top:259.76px" class="cls_023"><span class="cls_023">Knowing when to save documents</span></div>
<div style="position:absolute;left:56.69px;top:282.48px" class="cls_004"><span class="cls_004">Method calls that affect a node's properties require </span><span class="cls_013">save</span><span class="cls_004"> to persist the changes. If in this</span></div>
<div style="position:absolute;left:56.69px;top:295.76px" class="cls_004"><span class="cls_004">example we were only adding an aspect, we wouldn't have to save the document because</span></div>
<div style="position:absolute;left:56.69px;top:308.36px" class="cls_004"><span class="cls_004">the change is persisted immediately.</span></div>
<div style="position:absolute;left:56.69px;top:343.00px" class="cls_023"><span class="cls_023">Using JavaScript for batch manipulation</span></div>
<div style="position:absolute;left:56.69px;top:365.72px" class="cls_004"><span class="cls_004">During projects you will often find that you need to perform batch operations on nodes in</span></div>
<div style="position:absolute;left:56.69px;top:378.32px" class="cls_004"><span class="cls_004">the repository. You might want to execute an action against all documents in all subfolders</span></div>
<div style="position:absolute;left:56.69px;top:390.92px" class="cls_004"><span class="cls_004">starting at a given path, for example. JavaScript is a quick way to perform such mass</span></div>
<div style="position:absolute;left:56.69px;top:403.52px" class="cls_004"><span class="cls_004">operations and doesn't require code to be compiled and packaged. Be aware that if you</span></div>
<div style="position:absolute;left:56.69px;top:416.12px" class="cls_004"><span class="cls_004">write such a script and run it on an important volume of documents in one shot, all of your</span></div>
<div style="position:absolute;left:56.69px;top:428.72px" class="cls_004"><span class="cls_004">changes will happen in a single transaction. This can be bad for performance of the script</span></div>
<div style="position:absolute;left:56.69px;top:441.32px" class="cls_004"><span class="cls_004">and can adversely affect index tracking.</span></div>
<div style="position:absolute;left:56.69px;top:475.96px" class="cls_023"><span class="cls_023">Writing content to the content property</span></div>
<div style="position:absolute;left:56.69px;top:498.68px" class="cls_004"><span class="cls_004">Properties store data about a node. The terms </span><span class="cls_022">“</span><span class="cls_004">metadata</span><span class="cls_022">”</span><span class="cls_004"> and </span><span class="cls_022">“</span><span class="cls_004">attributes</span><span class="cls_022">”</span><span class="cls_004"> are synonymous</span></div>
<div style="position:absolute;left:56.69px;top:512.11px" class="cls_004"><span class="cls_004">with </span><span class="cls_022">“</span><span class="cls_004">properties</span><span class="cls_022">”</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:534.54px" class="cls_004"><span class="cls_004">Content refers to the main unit of data being managed by the system</span><span class="cls_022">-</span><span class="cls_004">a file. A PDF file, for</span></div>
<div style="position:absolute;left:56.69px;top:547.97px" class="cls_004"><span class="cls_004">example, is a piece of content. Plain-text data such as XML, HTML, or JavaScript are also</span></div>
<div style="position:absolute;left:56.69px;top:560.57px" class="cls_004"><span class="cls_004">examples of content.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 110 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:84500px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background126.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Content is stored as a property on the node. In Alfresco, the content is really stored on the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">file system, but as developers using the API, we don't care about where the content is</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">physically stored. We could have created a whitepaper from scratch and populate the</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">content of the document directly using Javascript.</span></div>
<div style="position:absolute;left:56.69px;top:145.00px" class="cls_014"><span class="cls_014">Creating content with CMIS</span></div>
<div style="position:absolute;left:56.69px;top:170.22px" class="cls_004"><span class="cls_004">JavaScript is fast to develop and very succinct, but it must run on the Alfresco server. CMIS</span></div>
<div style="position:absolute;left:56.69px;top:182.82px" class="cls_004"><span class="cls_004">API is one option to consider when you want to run code on a different machine than the</span></div>
<div style="position:absolute;left:56.69px;top:195.42px" class="cls_004"><span class="cls_004">Alfresco server. CMIS stands for Content Management Interoperability Services and has</span></div>
<div style="position:absolute;left:56.69px;top:208.02px" class="cls_004"><span class="cls_004">been created to improve the interoperability with different ECM solutions.</span></div>
<div style="position:absolute;left:56.69px;top:229.62px" class="cls_004"><span class="cls_004">Let's do another example in this section. We'll try to create a Marketing document in</span></div>
<div style="position:absolute;left:56.69px;top:242.22px" class="cls_004"><span class="cls_004">Alfresco using the Java CMIS API. We'll create a new Maven project for this example.</span></div>
<div style="position:absolute;left:91.32px;top:263.95px" class="cls_004"><span class="cls_004">1. An overview of the steps involved is: create a new Maven project, and add the</span></div>
<div style="position:absolute;left:104.69px;top:276.55px" class="cls_004"><span class="cls_004">CMIS dependency.</span></div>
<div style="position:absolute;left:91.32px;top:291.31px" class="cls_004"><span class="cls_004">2. Authenticate to start a session.</span></div>
<div style="position:absolute;left:91.32px;top:306.07px" class="cls_004"><span class="cls_004">3. Locate the document library and the marketing folder.</span></div>
<div style="position:absolute;left:91.32px;top:320.83px" class="cls_004"><span class="cls_004">4. Create the </span><span class="cls_007">Marketing</span><span class="cls_004"> folder if you didn't do it yet.</span></div>
<div style="position:absolute;left:91.32px;top:335.63px" class="cls_004"><span class="cls_004">5. Create the new node with content.</span></div>
<div style="position:absolute;left:56.69px;top:359.52px" class="cls_004"><span class="cls_004">The Apache Chemistry website (</span><a href="https://chemistry.apache.org/">https://chemistry.apache.org/</a> <span class="cls_004">) provides already a lot</span></div>
<div style="position:absolute;left:56.69px;top:372.50px" class="cls_004"><span class="cls_004">of samples. First, let's create our new Maven project in STS. This time, we won't select any</span></div>
<div style="position:absolute;left:56.69px;top:385.10px" class="cls_004"><span class="cls_004">archetype. Don't forget to check </span><span class="cls_007">Create a simple project (skip archetype selection)</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:104.69px;top:406.87px" class="cls_004"><span class="cls_004">Group Id: </span><span class="cls_013">com.someco</span></div>
<div style="position:absolute;left:104.69px;top:422.31px" class="cls_004"><span class="cls_004">Artifact Id: </span><span class="cls_013">cmis</span></div>
<div style="position:absolute;left:104.69px;top:437.75px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Finish</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:461.67px" class="cls_004"><span class="cls_004">Then, let's open the </span><span class="cls_013">pom.xml</span><span class="cls_004"> file and select the tab </span><span class="cls_007">Dependencies</span><span class="cls_004">. Click on </span><span class="cls_007">Add</span><span class="cls_028">…</span><span class="cls_004">. Provide</span></div>
<div style="position:absolute;left:56.69px;top:475.10px" class="cls_004"><span class="cls_004">the following information:</span></div>
<div style="position:absolute;left:104.69px;top:496.83px" class="cls_004"><span class="cls_004">Group Id: </span><span class="cls_013">org.apache.chemistry.opencmis</span></div>
<div style="position:absolute;left:104.69px;top:512.27px" class="cls_004"><span class="cls_004">Artifcat Id: </span><span class="cls_013">chemistry-opencmis-client-impl</span></div>
<div style="position:absolute;left:104.69px;top:527.71px" class="cls_004"><span class="cls_004">Version: 0.13.0</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 111 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:85176px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background127.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">That's it! We are ready to develop using CMIS. Create the Java</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">class</span><span class="cls_013">com.someco.CmisClient </span><span class="cls_004">with a </span><span class="cls_013">main</span><span class="cls_004"> method. The first thing that we need to do is</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">to create a session to Alfresco:</span></div>
<div style="position:absolute;left:74.69px;top:117.30px" class="cls_010"><span class="cls_010">SessionFactory factory = SessionFactoryImpl.newInstance();</span></div>
<div style="position:absolute;left:74.69px;top:128.10px" class="cls_010"><span class="cls_010">Map&lt;String, String&gt; parameter = new HashMap&lt;String, String&gt;();</span></div>
<div style="position:absolute;left:74.69px;top:138.90px" class="cls_010"><span class="cls_010">parameter.put(SessionParameter.USER, "admin");</span></div>
<div style="position:absolute;left:74.69px;top:149.70px" class="cls_010"><span class="cls_010">parameter.put(SessionParameter.PASSWORD, "admin");</span></div>
<div style="position:absolute;left:74.69px;top:160.50px" class="cls_010"><span class="cls_010">parameter.put(SessionParameter.ATOMPUB_URL,</span></div>
<div style="position:absolute;left:74.69px;top:171.30px" class="cls_010"><span class="cls_010">"</span><a href="http://127.0.0.1:8080/alfresco/api/-default-/public/cmis/versions/1.1/atom/">http://127.0.0.1:8080/alfresco/api/-default-/public/cmis/versions/1.1/atom</a> </div>
<div style="position:absolute;left:74.69px;top:182.10px" class="cls_010"><span class="cls_010">");</span></div>
<div style="position:absolute;left:74.69px;top:192.90px" class="cls_010"><span class="cls_010">parameter.put(SessionParameter.BINDING_TYPE, BindingType.ATOMPUB.value());</span></div>
<div style="position:absolute;left:74.69px;top:203.70px" class="cls_010"><span class="cls_010">parameter.put(SessionParameter.REPOSITORY_ID, "-default-");</span></div>
<div style="position:absolute;left:74.69px;top:214.50px" class="cls_010"><span class="cls_010">Session session = factory.createSession(parameter);</span></div>
<div style="position:absolute;left:56.69px;top:234.98px" class="cls_004"><span class="cls_004">Then, locate the document library folder of the Marketing Site that we created previously:</span></div>
<div style="position:absolute;left:74.69px;top:255.90px" class="cls_010"><span class="cls_010">String path = "/Sites/marketing/documentLibrary";</span></div>
<div style="position:absolute;left:74.69px;top:266.70px" class="cls_010"><span class="cls_010">Folder documentLibrary = (Folder) session.getObjectByPath(path);</span></div>
<div style="position:absolute;left:56.69px;top:287.18px" class="cls_004"><span class="cls_004">In the document library, we try to locate the </span><span class="cls_013">Marketing</span><span class="cls_004"> folder:</span></div>
<div style="position:absolute;left:74.69px;top:308.78px" class="cls_010"><span class="cls_010">Folder marketingFolder = null;</span></div>
<div style="position:absolute;left:74.69px;top:319.58px" class="cls_010"><span class="cls_010">for (CmisObjectchild :documentLibrary.getChildren()) {</span></div>
<div style="position:absolute;left:90.89px;top:330.38px" class="cls_010"><span class="cls_010">if ("Marketing".equals(child.getName())) {</span></div>
<div style="position:absolute;left:123.29px;top:341.18px" class="cls_010"><span class="cls_010">marketingFolder = (Folder) child;</span></div>
<div style="position:absolute;left:90.89px;top:351.98px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:362.78px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:394.06px" class="cls_004"><span class="cls_004">We have to consider that this folder may not exist. So, we need to create it on the fly:</span></div>
<div style="position:absolute;left:74.69px;top:414.98px" class="cls_010"><span class="cls_010">// create the marketing folder if needed</span></div>
<div style="position:absolute;left:74.69px;top:425.78px" class="cls_010"><span class="cls_010">if (marketingFolder == null) {</span></div>
<div style="position:absolute;left:90.89px;top:436.58px" class="cls_010"><span class="cls_010">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();</span></div>
<div style="position:absolute;left:90.89px;top:447.38px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.NAME, "Marketing");</span></div>
<div style="position:absolute;left:90.89px;top:458.18px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.OBJECT_TYPE_ID, "cmis:folder");</span></div>
<div style="position:absolute;left:90.89px;top:468.98px" class="cls_010"><span class="cls_010">marketingFolder = documentLibrary.createFolder(properties);</span></div>
<div style="position:absolute;left:74.69px;top:479.78px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 112 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:85852px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background128.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Now, we are now ready to prepare the creation of our new document. The first step is to</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">prepare the required properties:</span></div>
<div style="position:absolute;left:74.69px;top:104.02px" class="cls_010"><span class="cls_010">// prepare properties</span></div>
<div style="position:absolute;left:74.69px;top:114.82px" class="cls_010"><span class="cls_010">String filename = "My new whitepaper.txt";</span></div>
<div style="position:absolute;left:74.69px;top:125.62px" class="cls_010"><span class="cls_010">Map&lt;String, Object&gt; properties = new HashMap&lt;String, Object&gt;();</span></div>
<div style="position:absolute;left:74.69px;top:136.42px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.NAME, filename);</span></div>
<div style="position:absolute;left:74.69px;top:147.22px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.OBJECT_TYPE_ID, "D:sc:marketingDoc");</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">Then, we can prepare the content. In this sample, we'll create a text file:</span></div>
<div style="position:absolute;left:74.69px;top:188.62px" class="cls_010"><span class="cls_010">// prepare content</span></div>
<div style="position:absolute;left:74.69px;top:199.42px" class="cls_010"><span class="cls_010">String content = "Hello World!";</span></div>
<div style="position:absolute;left:74.69px;top:210.22px" class="cls_010"><span class="cls_010">String mimetype = "text/plain; charset=UTF-8";</span></div>
<div style="position:absolute;left:74.69px;top:221.02px" class="cls_010"><span class="cls_010">byte[] contentBytes = content.getBytes("UTF-8");</span></div>
<div style="position:absolute;left:74.69px;top:231.82px" class="cls_010"><span class="cls_010">ByteArrayInputStream stream = new ByteArrayInputStream(contentBytes);</span></div>
<div style="position:absolute;left:74.69px;top:242.62px" class="cls_010"><span class="cls_010">ContentStreamcontentStream =</span></div>
<div style="position:absolute;left:74.69px;top:253.42px" class="cls_010"><span class="cls_010">session.getObjectFactory().createContentStream(filename,</span></div>
<div style="position:absolute;left:74.69px;top:264.22px" class="cls_010"><span class="cls_010">contentBytes.length, mimetype, stream);</span></div>
<div style="position:absolute;left:56.69px;top:284.70px" class="cls_004"><span class="cls_004">Finally, we are ready to create the document:</span></div>
<div style="position:absolute;left:74.69px;top:305.62px" class="cls_010"><span class="cls_010">// create the document</span></div>
<div style="position:absolute;left:74.69px;top:316.42px" class="cls_010"><span class="cls_010">Document marketingDocument = marketingFolder.createDocument(properties,</span></div>
<div style="position:absolute;left:74.69px;top:327.22px" class="cls_010"><span class="cls_010">contentStream, VersioningState.MAJOR);</span></div>
<div style="position:absolute;left:56.69px;top:347.70px" class="cls_004"><span class="cls_004">Of course, you'll need to import all dependencies in your Java class. STS provides you a</span></div>
<div style="position:absolute;left:56.69px;top:360.30px" class="cls_004"><span class="cls_004">way of doing it quickly by clicking on </span><span class="cls_007">Source|Organize Imports</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:394.98px" class="cls_023"><span class="cls_023">Step-by-step - run CmisClientClass to create content</span></div>
<div style="position:absolute;left:56.69px;top:417.70px" class="cls_004"><span class="cls_004">To run the CmisTest class to create some content, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:439.43px" class="cls_004"><span class="cls_004">1. Right click on the project </span><span class="cls_013">cmis</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:454.87px" class="cls_004"><span class="cls_004">2. Click on </span><span class="cls_007">Run As</span><span class="cls_004">, </span><span class="cls_007">Java Application</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 113 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:86528px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background129.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If everything is successful, you should be able to login to Alfresco Share, and locate your</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">newly created document in the </span><span class="cls_013">Marketing</span><span class="cls_004"> folder.</span></div>
<div style="position:absolute;left:56.69px;top:352.40px" class="cls_014"><span class="cls_014">Creating associations</span></div>
<div style="position:absolute;left:56.69px;top:377.62px" class="cls_004"><span class="cls_004">Now let's switch back to the CMIS API and look at how to create a related-documents</span></div>
<div style="position:absolute;left:56.69px;top:390.22px" class="cls_004"><span class="cls_004">association between two documents.</span></div>
<div style="position:absolute;left:56.69px;top:411.82px" class="cls_004"><span class="cls_004">We'll just update the existing Java code that we wrote previously. The only missing</span></div>
<div style="position:absolute;left:56.69px;top:424.42px" class="cls_004"><span class="cls_004">information is the document that we want to create an association with. To achieve that,</span></div>
<div style="position:absolute;left:56.69px;top:437.02px" class="cls_004"><span class="cls_004">we'll look for a document in the </span><span class="cls_013">Whitepapers</span><span class="cls_004"> folder.</span></div>
<div style="position:absolute;left:56.69px;top:459.30px" class="cls_004"><span class="cls_004">Following the same principles that we used to locate the </span><span class="cls_013">Marketing</span><span class="cls_004"> folder, we can retrieve</span></div>
<div style="position:absolute;left:56.69px;top:472.58px" class="cls_004"><span class="cls_004">all children of the document library and look for the right folder. In this case, we assume</span></div>
<div style="position:absolute;left:56.69px;top:485.18px" class="cls_004"><span class="cls_004">that this folder exists.</span></div>
<div style="position:absolute;left:74.69px;top:506.10px" class="cls_010"><span class="cls_010">Folder whitepaperFolder = null;</span></div>
<div style="position:absolute;left:74.69px;top:516.90px" class="cls_010"><span class="cls_010">for (CmisObjectchild :documentLibrary.getChildren()) {</span></div>
<div style="position:absolute;left:90.89px;top:527.70px" class="cls_010"><span class="cls_010">if ("Whitepapers".equals(child.getName())) {</span></div>
<div style="position:absolute;left:123.29px;top:538.50px" class="cls_010"><span class="cls_010">whitepaperFolder = (Folder) child;</span></div>
<div style="position:absolute;left:90.89px;top:549.30px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:560.10px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 114 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:87204px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background130.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Then, we need to look for any whitepaper in this folder:</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">// look for a whitepaper</span></div>
<div style="position:absolute;left:74.69px;top:102.22px" class="cls_010"><span class="cls_010">Document whitepaper = null;</span></div>
<div style="position:absolute;left:74.69px;top:113.02px" class="cls_010"><span class="cls_010">for (CmisObjectchild :whitepaperFolder.getChildren()) {</span></div>
<div style="position:absolute;left:90.89px;top:123.82px" class="cls_010"><span class="cls_010">if (child.getType().getId().equals("D:sc:whitepaper"))</span></div>
<div style="position:absolute;left:123.29px;top:134.62px" class="cls_010"><span class="cls_010">whitepaper = (Document) child;</span></div>
<div style="position:absolute;left:74.69px;top:145.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:165.90px" class="cls_004"><span class="cls_004">And finally, you can create the association:</span></div>
<div style="position:absolute;left:74.69px;top:186.82px" class="cls_010"><span class="cls_010">properties = new HashMap&lt;String, Object&gt;();</span></div>
<div style="position:absolute;left:74.69px;top:197.62px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.NAME, "a new relationship");</span></div>
<div style="position:absolute;left:74.69px;top:208.42px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.OBJECT_TYPE_ID, "R:sc:relatedDocuments");</span></div>
<div style="position:absolute;left:74.69px;top:219.22px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.SOURCE_ID, marketingDocument.getId());</span></div>
<div style="position:absolute;left:74.69px;top:230.02px" class="cls_010"><span class="cls_010">properties.put(PropertyIds.TARGET_ID, whitepaper.getId());</span></div>
<div style="position:absolute;left:74.69px;top:240.82px" class="cls_010"><span class="cls_010">session.createRelationship(properties);</span></div>
<div style="position:absolute;left:56.69px;top:261.30px" class="cls_004"><span class="cls_004">Re-execute the Java class. Before, you need to delete the file manually from Share. If you</span></div>
<div style="position:absolute;left:56.69px;top:273.90px" class="cls_004"><span class="cls_004">don't do it, you'll have an error indicating that a file already exists with the same name in</span></div>
<div style="position:absolute;left:56.69px;top:286.50px" class="cls_004"><span class="cls_004">the </span><span class="cls_013">Marketing</span><span class="cls_004"> folder. If it's executed successfully, you'll be able that our marketing</span></div>
<div style="position:absolute;left:56.69px;top:299.78px" class="cls_004"><span class="cls_004">document is associated to one of the whitepaper that we created before. Alternatively, the</span></div>
<div style="position:absolute;left:56.69px;top:312.38px" class="cls_004"><span class="cls_004">Node Browser that is available in the Administration Console is a handy way to view</span></div>
<div style="position:absolute;left:56.69px;top:324.98px" class="cls_004"><span class="cls_004">associations.</span></div>
<div style="position:absolute;left:56.69px;top:361.68px" class="cls_014"><span class="cls_014">Searching for content</span></div>
<div style="position:absolute;left:56.69px;top:386.90px" class="cls_004"><span class="cls_004">Now that you have some content in the repository, you can test out the CMIS Search API. In</span></div>
<div style="position:absolute;left:56.69px;top:399.50px" class="cls_004"><span class="cls_004">this example, we'll look for all SomeCo documents available in the repository. And for each</span></div>
<div style="position:absolute;left:56.69px;top:412.10px" class="cls_004"><span class="cls_004">document, we'll display all properties available on each document.</span></div>
<div style="position:absolute;left:56.69px;top:433.70px" class="cls_004"><span class="cls_004">We are going to encapsulate this into a new function:</span></div>
<div style="position:absolute;left:74.69px;top:454.62px" class="cls_010"><span class="cls_010">private static void searchDocuments(Session session) {</span></div>
<div style="position:absolute;left:74.69px;top:465.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:485.90px" class="cls_004"><span class="cls_004">Then, we need to query Alfresco:</span></div>
<div style="position:absolute;left:74.69px;top:506.82px" class="cls_010"><span class="cls_010">ItemIterable&lt;QueryResult&gt; results = session.query("SELECT * FROM sc:doc",</span></div>
<div style="position:absolute;left:74.69px;top:517.62px" class="cls_010"><span class="cls_010">false);</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 115 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:87880px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background131.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Finally, we just have to browse the list of results:</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">for (QueryResulthit : results) {</span></div>
<div style="position:absolute;left:90.89px;top:102.22px" class="cls_010"><span class="cls_010">for (PropertyData&lt;?&gt;property :hit.getProperties()) {</span></div>
<div style="position:absolute;left:123.29px;top:113.02px" class="cls_010"><span class="cls_010">String queryName = property.getQueryName();</span></div>
<div style="position:absolute;left:123.29px;top:123.82px" class="cls_010"><span class="cls_010">Object value = property.getFirstValue();</span></div>
<div style="position:absolute;left:123.29px;top:134.62px" class="cls_010"><span class="cls_010">System.out.println(queryName + ": " + value);</span></div>
<div style="position:absolute;left:90.89px;top:145.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:90.89px;top:156.22px" class="cls_010"><span class="cls_010">System.out.println("--------------------------------------");</span></div>
<div style="position:absolute;left:74.69px;top:167.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:187.50px" class="cls_004"><span class="cls_004">In my repository, I have three documents, including 1 white papers and one marketing</span></div>
<div style="position:absolute;left:56.69px;top:200.10px" class="cls_004"><span class="cls_004">document. Here is an example of document:</span></div>
<div style="position:absolute;left:74.69px;top:221.02px" class="cls_010"><span class="cls_010">alfcmis:nodeRef: workspace://SpacesStore/978751b1-7cc7-4be6-</span></div>
<div style="position:absolute;left:74.69px;top:231.82px" class="cls_010"><span class="cls_010">aed9-2ff33f438df6</span></div>
<div style="position:absolute;left:74.69px;top:242.62px" class="cls_010"><span class="cls_010">cmis:isImmutable: false</span></div>
<div style="position:absolute;left:74.69px;top:253.42px" class="cls_010"><span class="cls_010">cmis:versionLabel: 1.0</span></div>
<div style="position:absolute;left:74.69px;top:264.22px" class="cls_010"><span class="cls_010">cmis:objectTypeId: D:sc:whitepaper</span></div>
<div style="position:absolute;left:74.69px;top:275.02px" class="cls_010"><span class="cls_010">cmis:description: null</span></div>
<div style="position:absolute;left:74.69px;top:285.82px" class="cls_010"><span class="cls_010">cmis:createdBy: admin</span></div>
<div style="position:absolute;left:74.69px;top:296.62px" class="cls_010"><span class="cls_010">cmis:checkinComment: null</span></div>
<div style="position:absolute;left:74.69px;top:307.42px" class="cls_010"><span class="cls_010">cmis:creationDate: java.util.GregorianCalendar[...]</span></div>
<div style="position:absolute;left:74.69px;top:318.22px" class="cls_010"><span class="cls_010">cmis:isMajorVersion: true</span></div>
<div style="position:absolute;left:74.69px;top:329.02px" class="cls_010"><span class="cls_010">cmis:contentStreamFileName: wp- (1471536191073).pdf</span></div>
<div style="position:absolute;left:74.69px;top:339.82px" class="cls_010"><span class="cls_010">cmis:name: wp- (1471536191073).pdf</span></div>
<div style="position:absolute;left:74.69px;top:350.62px" class="cls_010"><span class="cls_010">cmis:isLatestVersion: true</span></div>
<div style="position:absolute;left:74.69px;top:361.42px" class="cls_010"><span class="cls_010">cmis:lastModificationDate: java.util.GregorianCalendar[...]</span></div>
<div style="position:absolute;left:74.69px;top:372.22px" class="cls_010"><span class="cls_010">cmis:contentStreamLength: 141120</span></div>
<div style="position:absolute;left:74.69px;top:383.02px" class="cls_010"><span class="cls_010">cmis:objectId: 978751b1-7cc7-4be6-aed9-2ff33f438df6;1.0</span></div>
<div style="position:absolute;left:74.69px;top:393.82px" class="cls_010"><span class="cls_010">cmis:lastModifiedBy: admin</span></div>
<div style="position:absolute;left:74.69px;top:404.62px" class="cls_010"><span class="cls_010">cmis:secondaryObjectTypeIds: P:rn:renditioned</span></div>
<div style="position:absolute;left:74.69px;top:415.42px" class="cls_010"><span class="cls_010">cmis:contentStreamId: store://2016/8/18/16/3/31dcb9be-4e50-4221-</span></div>
<div style="position:absolute;left:74.69px;top:426.22px" class="cls_010"><span class="cls_010">b8d5-77deb3b044ac.bin</span></div>
<div style="position:absolute;left:74.69px;top:437.02px" class="cls_010"><span class="cls_010">cmis:contentStreamMimeType: application/pdf</span></div>
<div style="position:absolute;left:74.69px;top:447.82px" class="cls_010"><span class="cls_010">cmis:baseTypeId: cmis:document</span></div>
<div style="position:absolute;left:74.69px;top:458.62px" class="cls_010"><span class="cls_010">cmis:changeToken: null</span></div>
<div style="position:absolute;left:74.69px;top:469.42px" class="cls_010"><span class="cls_010">cmis:isPrivateWorkingCopy: false</span></div>
<div style="position:absolute;left:74.69px;top:480.22px" class="cls_010"><span class="cls_010">cmis:versionSeriesCheckedOutBy: null</span></div>
<div style="position:absolute;left:74.69px;top:491.02px" class="cls_010"><span class="cls_010">cmis:isVersionSeriesCheckedOut: false</span></div>
<div style="position:absolute;left:74.69px;top:501.82px" class="cls_010"><span class="cls_010">cmis:versionSeriesId: 978751b1-7cc7-4be6-aed9-2ff33f438df6</span></div>
<div style="position:absolute;left:74.69px;top:512.62px" class="cls_010"><span class="cls_010">cmis:isLatestMajorVersion: true</span></div>
<div style="position:absolute;left:74.69px;top:523.42px" class="cls_010"><span class="cls_010">cmis:versionSeriesCheckedOutId: null</span></div>
<div style="position:absolute;left:74.69px;top:534.22px" class="cls_010"><span class="cls_010">--------------------------------------</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 116 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:88556px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background132.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Deleting content</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Now it is time to clean up after yourself by deleting content from the repository. In this</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">sample, we'll delete all documents in the </span><span class="cls_013">Marketing</span><span class="cls_004"> folder. Like that, you'll be able to</span></div>
<div style="position:absolute;left:56.69px;top:120.86px" class="cls_004"><span class="cls_004">execute a full cycle:</span></div>
<div style="position:absolute;left:91.32px;top:142.59px" class="cls_004"><span class="cls_004">1. Create a new marketing document.</span></div>
<div style="position:absolute;left:91.32px;top:157.35px" class="cls_004"><span class="cls_004">2. Confirm that it's created using the search API.</span></div>
<div style="position:absolute;left:91.32px;top:172.11px" class="cls_004"><span class="cls_004">3. Delete the document created in the step 1.</span></div>
<div style="position:absolute;left:56.69px;top:196.00px" class="cls_004"><span class="cls_004">We are going to encapsulate this into a new function:</span></div>
<div style="position:absolute;left:74.69px;top:216.92px" class="cls_010"><span class="cls_010">private static void deleteDocuments(Session session) {</span></div>
<div style="position:absolute;left:74.69px;top:227.72px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:248.20px" class="cls_004"><span class="cls_004">As previously, we need to look for the document library of the </span><span class="cls_013">Marketing</span><span class="cls_004"> site:</span></div>
<div style="position:absolute;left:74.69px;top:269.80px" class="cls_010"><span class="cls_010">String path = "/Sites/marketing/documentLibrary";</span></div>
<div style="position:absolute;left:74.69px;top:280.60px" class="cls_010"><span class="cls_010">Folder documentLibrary = (Folder) session.getObjectByPath(path);</span></div>
<div style="position:absolute;left:56.69px;top:301.08px" class="cls_004"><span class="cls_004">Then, we need to locate the </span><span class="cls_013">Marketing</span><span class="cls_004"> folder:</span></div>
<div style="position:absolute;left:74.69px;top:322.68px" class="cls_010"><span class="cls_010">Folder marketingFolder = null;</span></div>
<div style="position:absolute;left:74.69px;top:333.48px" class="cls_010"><span class="cls_010">for (CmisObjectchild :documentLibrary.getChildren()) {</span></div>
<div style="position:absolute;left:90.89px;top:344.28px" class="cls_010"><span class="cls_010">if ("Marketing".equals(child.getName())) {</span></div>
<div style="position:absolute;left:123.29px;top:355.08px" class="cls_010"><span class="cls_010">marketingFolder = (Folder) child;</span></div>
<div style="position:absolute;left:90.89px;top:365.88px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:376.68px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:397.16px" class="cls_004"><span class="cls_004">Finally, we delete all children in this folder:</span></div>
<div style="position:absolute;left:74.69px;top:418.08px" class="cls_010"><span class="cls_010">if (marketingFolder != null) {</span></div>
<div style="position:absolute;left:90.89px;top:428.88px" class="cls_010"><span class="cls_010">for (CmisObjectchild :marketingFolder.getChildren()) {</span></div>
<div style="position:absolute;left:123.29px;top:439.68px" class="cls_010"><span class="cls_010">session.delete(child);</span></div>
<div style="position:absolute;left:90.89px;top:450.48px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:461.28px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:122.09px;top:492.56px" class="cls_004"><span class="cls_004">Note that this code deletes every matching object in the marketing folder.</span></div>
<div style="position:absolute;left:122.09px;top:505.17px" class="cls_004"><span class="cls_004">You would definitely want to </span><span class="cls_012">think twice and cut once</span><span class="cls_004"> if you were running</span></div>
<div style="position:absolute;left:122.09px;top:517.77px" class="cls_004"><span class="cls_004">this code on a production repository!</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 117 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:89232px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background133.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Model manager</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">Alfresco provides an interactive tool to design your own custom model. It allows you to</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">add custom types, aspects, and properties. On top of that, you can use the same tool to</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">design the different forms for your content types and aspects. Open Alfresco Share and</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">login as administrator, click on </span><span class="cls_007">Admin Tools</span><span class="cls_004">, click on </span><span class="cls_007">Model Manager</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:357.83px" class="cls_004"><span class="cls_004">We are not going to discover how to use this tool but you'll notice that it follows exactly</span></div>
<div style="position:absolute;left:56.69px;top:370.43px" class="cls_004"><span class="cls_004">what we did to create our custom model manually. You could argue that it would have</span></div>
<div style="position:absolute;left:56.69px;top:383.03px" class="cls_004"><span class="cls_004">been easier to use this tool, instead of creating all these XML and properties file. However, I</span></div>
<div style="position:absolute;left:56.69px;top:395.63px" class="cls_004"><span class="cls_004">think that it's always important to really understand how it's configured and implemented</span></div>
<div style="position:absolute;left:56.69px;top:408.23px" class="cls_004"><span class="cls_004">from a pure technical point of view. Moreover, this tool doesn't cover all possibilities. For</span></div>
<div style="position:absolute;left:56.69px;top:420.83px" class="cls_004"><span class="cls_004">example, it's not possible to create association or child-association using this tool.</span></div>
<div style="position:absolute;left:56.69px;top:442.43px" class="cls_004"><span class="cls_004">I would recommend this tool if you are looking for implementing a quick demonstration.</span></div>
<div style="position:absolute;left:56.69px;top:455.03px" class="cls_004"><span class="cls_004">But I don't think that it's the ideal tool for a real project, that you'll need to package and</span></div>
<div style="position:absolute;left:56.69px;top:467.63px" class="cls_004"><span class="cls_004">deploy in different environments. I recommend you to take a look and make your own</span></div>
<div style="position:absolute;left:56.69px;top:480.23px" class="cls_004"><span class="cls_004">opinion of it. Be aware that you can use the Model Manager first, then export the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:492.83px" class="cls_004"><span class="cls_004">content model and Share form configuration. You can refine these files manually after.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 118 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:89908px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background134.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Working with Content Models</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">This chapter was about customizing Alfresco's content model, configuring Alfresco Share to</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">allow end users to work with the custom content model via the user interface, and using the</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">CMIS API to create, search, update, and delete objects in the repository. Let's recap what we</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">specifically learned.</span></div>
<div style="position:absolute;left:56.69px;top:156.78px" class="cls_004"><span class="cls_004">The Alfresco repository is a hierarchical collection of nodes.</span></div>
<div style="position:absolute;left:56.69px;top:178.38px" class="cls_004"><span class="cls_004">The Alfresco content model defines the data types of nodes and properties, and the</span></div>
<div style="position:absolute;left:56.69px;top:190.98px" class="cls_004"><span class="cls_004">relationships between nodes.</span></div>
<div style="position:absolute;left:56.69px;top:212.58px" class="cls_004"><span class="cls_004">Extending the content model to make it relevant to your business problem involves creating</span></div>
<div style="position:absolute;left:56.69px;top:225.18px" class="cls_004"><span class="cls_004">an XML file to describe the model, then telling Alfresco about it through a Spring bean</span></div>
<div style="position:absolute;left:56.69px;top:237.78px" class="cls_004"><span class="cls_004">configuration file.</span></div>
<div style="position:absolute;left:56.69px;top:259.38px" class="cls_004"><span class="cls_004">The fundamental building blocks used to define the content model include: Types, Aspects,</span></div>
<div style="position:absolute;left:56.69px;top:271.98px" class="cls_004"><span class="cls_004">Properties, and Associations.</span></div>
<div style="position:absolute;left:56.69px;top:293.58px" class="cls_004"><span class="cls_004">Best practices for creating your own content models include using aspects for re-usability,</span></div>
<div style="position:absolute;left:56.69px;top:306.18px" class="cls_004"><span class="cls_004">considering the use of a root content type, and leveraging the out of the box content model</span></div>
<div style="position:absolute;left:56.69px;top:318.78px" class="cls_004"><span class="cls_004">as a reference.</span></div>
<div style="position:absolute;left:56.69px;top:340.38px" class="cls_004"><span class="cls_004">Configuring Alfresco Share to expose your custom content model via the user interface</span></div>
<div style="position:absolute;left:56.69px;top:352.98px" class="cls_004"><span class="cls_004">involves overriding configuration elements in the dedicated XML configuration file.</span></div>
<div style="position:absolute;left:56.69px;top:374.58px" class="cls_004"><span class="cls_004">There are several options for interacting with the repository with code. Examples in this</span></div>
<div style="position:absolute;left:56.69px;top:387.18px" class="cls_004"><span class="cls_004">chapter included the CMIS API and the JavaScript API.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 119 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:90584px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background135.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">4</span></div>
<div style="position:absolute;left:66.22px;top:167.48px" class="cls_011"><span class="cls_011">Handling Content Automatically</span></div>
<div style="position:absolute;left:166.27px;top:203.48px" class="cls_011"><span class="cls_011">with Actions, Behaviors,</span></div>
<div style="position:absolute;left:96.28px;top:239.48px" class="cls_011"><span class="cls_011">Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:298.47px" class="cls_004"><span class="cls_004">Alfresco provides several types of hooks that can be used to perform interesting operations</span></div>
<div style="position:absolute;left:56.69px;top:311.07px" class="cls_004"><span class="cls_004">on content. Whether an operation is triggered by an end user, as is the case with Actions</span></div>
<div style="position:absolute;left:56.69px;top:323.67px" class="cls_004"><span class="cls_004">(sometimes called </span><span class="cls_022">“</span><span class="cls_007">Rule Actions</span><span class="cls_022">“</span><span class="cls_004">), or is handled automatically with Behaviors,</span></div>
<div style="position:absolute;left:56.69px;top:337.10px" class="cls_004"><span class="cls_004">Transformers, or Extractors. This chapter is about leveraging what is already available out</span></div>
<div style="position:absolute;left:56.69px;top:349.70px" class="cls_004"><span class="cls_004">of the box and, more importantly, how to develop your own when what is available doesn't</span></div>
<div style="position:absolute;left:56.69px;top:362.30px" class="cls_004"><span class="cls_004">meet your needs.</span></div>
<div style="position:absolute;left:56.69px;top:383.90px" class="cls_004"><span class="cls_004">By the end of this chapter, you will know how to:</span></div>
<div style="position:absolute;left:104.69px;top:405.63px" class="cls_004"><span class="cls_004">Create your own actions using Java</span></div>
<div style="position:absolute;left:104.69px;top:420.39px" class="cls_004"><span class="cls_004">Bind Java- and JavaScript-based behavior to types and aspects</span></div>
<div style="position:absolute;left:104.69px;top:435.15px" class="cls_004"><span class="cls_004">Configure and extend metadata extractors</span></div>
<div style="position:absolute;left:104.69px;top:449.91px" class="cls_004"><span class="cls_004">Write custom content transformers</span></div>
<div style="position:absolute;left:56.69px;top:490.95px" class="cls_008"><span class="cls_008">Encapsulating content operations in actions</span></div>
<div style="position:absolute;left:56.69px;top:518.68px" class="cls_004"><span class="cls_004">As you might suspect, a repository action is a piece of code that can be executed against a</span></div>
<div style="position:absolute;left:56.69px;top:531.28px" class="cls_004"><span class="cls_004">piece of content. Actions are discrete units of work. Then, you have Share action</span></div>
<div style="position:absolute;left:56.69px;top:543.88px" class="cls_004"><span class="cls_004">representing an action that you can do in Alfresco Share. Some of the out-of-the-box Share</span></div>
<div style="position:absolute;left:56.69px;top:556.48px" class="cls_004"><span class="cls_004">actions are </span><span class="cls_007">Edit Online</span><span class="cls_004">, </span><span class="cls_007">Upload New Version</span><span class="cls_004">, </span><span class="cls_007">Edit Properties</span><span class="cls_004">, </span><span class="cls_007">Move to</span><span class="cls_028">…</span><span class="cls_004">, </span><span class="cls_007">Copy to</span><span class="cls_028">…</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:569.91px" class="cls_007"><span class="cls_007">Start Workflow</span><span class="cls_004">, or </span><span class="cls_007">Delete Document</span><span class="cls_004">.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:91260px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background136.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Most of the out-of-the-box Share actions are not linked directly to a repository action, most</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">of them are linked to the Alfresco repository via webscripts. In this chapter, we will focus</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">only on repository actions, and rules that can be configured in the UI and allow you to</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">execute repository actions based on some criteria. Share actions will be covered in </span><span class="cls_010">Chapter</span></div>
<div style="position:absolute;left:56.69px;top:121.29px" class="cls_010"><span class="cls_010">5</span><span class="cls_004">, </span><span class="cls_012">Customizing Alfresco Share</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:143.27px" class="cls_004"><span class="cls_004">In the last chapter, SomeCo created some metadata related to publishing Whitepapers on</span></div>
<div style="position:absolute;left:56.69px;top:155.87px" class="cls_004"><span class="cls_004">the Web. The </span><span class="cls_007">sc:webable</span><span class="cls_004"> aspect included a flag to identify whether or not a piece of content</span></div>
<div style="position:absolute;left:56.69px;top:168.51px" class="cls_004"><span class="cls_004">should show up on the Web as well as a published date that captures when the flag was set.</span></div>
<div style="position:absolute;left:56.69px;top:190.10px" class="cls_004"><span class="cls_004">The </span><span class="cls_007">sc:isActive</span><span class="cls_004"> flag was configured to be read-only, so SomeCo needs a way to set that flag.</span></div>
<div style="position:absolute;left:56.69px;top:202.74px" class="cls_004"><span class="cls_004">They might want to do it automatically when content is added to a folder, they might want</span></div>
<div style="position:absolute;left:56.69px;top:215.34px" class="cls_004"><span class="cls_004">to set it during a step in a workflow, or through a link in one of Alfresco Share menu. By</span></div>
<div style="position:absolute;left:56.69px;top:227.94px" class="cls_004"><span class="cls_004">using an action, you can write the code once and call it from all of those places.</span></div>
<div style="position:absolute;left:56.69px;top:264.64px" class="cls_014"><span class="cls_014">Step-by-step - creating a basic action</span></div>
<div style="position:absolute;left:56.69px;top:289.86px" class="cls_004"><span class="cls_004">At its most basic, a custom rule action requires three things:</span></div>
<div style="position:absolute;left:104.69px;top:311.59px" class="cls_004"><span class="cls_004">An action executer class.</span></div>
<div style="position:absolute;left:104.69px;top:326.35px" class="cls_004"><span class="cls_004">A Spring bean configuration file.</span></div>
<div style="position:absolute;left:104.69px;top:341.11px" class="cls_004"><span class="cls_004">A properties file to externalize action-related strings (this one is not required per</span></div>
<div style="position:absolute;left:104.69px;top:353.71px" class="cls_004"><span class="cls_004">se but is highly recommended)</span></div>
<div style="position:absolute;left:56.69px;top:377.60px" class="cls_004"><span class="cls_004">Let's create an action to add the </span><span class="cls_007">sc:webable</span><span class="cls_004"> aspect to a document, and set its </span><span class="cls_007">isActive</span><span class="cls_004"> flag</span></div>
<div style="position:absolute;left:56.69px;top:390.24px" class="cls_004"><span class="cls_004">and publish date. By the end of these steps you will have an action that can be executed by</span></div>
<div style="position:absolute;left:56.69px;top:402.84px" class="cls_004"><span class="cls_004">an end user, a step in a workflow (and anywhere else Alfresco JavaScript can run), or a link</span></div>
<div style="position:absolute;left:56.69px;top:415.44px" class="cls_004"><span class="cls_004">in the user interface. Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:437.17px" class="cls_004"><span class="cls_004">1. The first class to create is </span><span class="cls_013">SomeCoModel</span><span class="cls_004">. This class will contain all Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:450.45px" class="cls_004"><span class="cls_004">QName properties represented in our XML content model. Usually, you create</span></div>
<div style="position:absolute;left:104.69px;top:463.05px" class="cls_004"><span class="cls_004">this class at the same time you create the XML content model. Create a new class</span></div>
<div style="position:absolute;left:104.69px;top:475.65px" class="cls_004"><span class="cls_004">in your </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">java </span><span class="cls_004">directory called</span></div>
<div style="position:absolute;left:104.69px;top:488.93px" class="cls_013"><span class="cls_013">com.someco.repo.common.SomeCoModel</span><span class="cls_004">. Then, define the prefix and the</span></div>
<div style="position:absolute;left:104.69px;top:502.21px" class="cls_004"><span class="cls_004">model URI.</span></div>
<div style="position:absolute;left:117.89px;top:525.42px" class="cls_010"><span class="cls_010">public final static String SOMECO_MODEL_PREFIX= "sc";</span></div>
<div style="position:absolute;left:117.89px;top:536.22px" class="cls_010"><span class="cls_010">public final static String SOMECO_MODEL_URI =</span></div>
<div style="position:absolute;left:139.49px;top:547.02px" class="cls_010"><span class="cls_010">"</span><a href="http://www.someco.com/model/content/1.0" ;="" "="">http://www.someco.com/model/content/1.0";</a> </div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 121 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:91936px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background137.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Then, add all </span><span class="cls_013">QName</span><span class="cls_004"> properties for the content types:</span></div>
<div style="position:absolute;left:117.89px;top:94.39px" class="cls_010"><span class="cls_010">public final static QName TYPE_DOC =</span></div>
<div style="position:absolute;left:139.49px;top:105.19px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "doc");</span></div>
<div style="position:absolute;left:117.89px;top:115.99px" class="cls_010"><span class="cls_010">public final static QName TYPE_MARKETINGDOC =</span></div>
<div style="position:absolute;left:139.49px;top:126.79px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "marketingDoc");</span></div>
<div style="position:absolute;left:117.89px;top:137.59px" class="cls_010"><span class="cls_010">public final static QName TYPE_WHITEPAPER =</span></div>
<div style="position:absolute;left:139.49px;top:148.39px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "whitepaper");</span></div>
<div style="position:absolute;left:117.89px;top:159.19px" class="cls_010"><span class="cls_010">public final static QName TYPE_HRDOC =</span></div>
<div style="position:absolute;left:139.49px;top:169.99px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "hrDoc");</span></div>
<div style="position:absolute;left:117.89px;top:180.79px" class="cls_010"><span class="cls_010">public final static QName TYPE_SALESDOC =</span></div>
<div style="position:absolute;left:139.49px;top:191.59px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "salesDoc");</span></div>
<div style="position:absolute;left:117.89px;top:202.39px" class="cls_010"><span class="cls_010">public final static QName TYPE_HRPOLICY =</span></div>
<div style="position:absolute;left:139.49px;top:213.19px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "hrPolicy");</span></div>
<div style="position:absolute;left:117.89px;top:223.99px" class="cls_010"><span class="cls_010">public final static QName TYPE_LEGALDOC =</span></div>
<div style="position:absolute;left:139.49px;top:234.79px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "legalDoc");</span></div>
<div style="position:absolute;left:91.32px;top:266.20px" class="cls_004"><span class="cls_004">3. Then, add all </span><span class="cls_013">QName</span><span class="cls_004"> properties for the aspects:</span></div>
<div style="position:absolute;left:112.49px;top:290.09px" class="cls_010"><span class="cls_010">public final static QName ASPECT_WEBABLE =</span></div>
<div style="position:absolute;left:134.09px;top:300.89px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "webable");</span></div>
<div style="position:absolute;left:112.49px;top:311.69px" class="cls_010"><span class="cls_010">public final static QName ASPECT_CLIENTRELATED =</span></div>
<div style="position:absolute;left:134.09px;top:322.49px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "clientRelated");</span></div>
<div style="position:absolute;left:91.32px;top:353.90px" class="cls_004"><span class="cls_004">4. Then, add all </span><span class="cls_013">QName</span><span class="cls_004"> properties for the properties and the association:</span></div>
<div style="position:absolute;left:112.49px;top:377.79px" class="cls_010"><span class="cls_010">public final static QName PROP_CAMPAIGN =</span></div>
<div style="position:absolute;left:134.09px;top:388.59px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "campaign");</span></div>
<div style="position:absolute;left:112.49px;top:399.39px" class="cls_010"><span class="cls_010">public final static QName PROP_PUBLISHED =</span></div>
<div style="position:absolute;left:134.09px;top:410.19px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "published");</span></div>
<div style="position:absolute;left:112.49px;top:420.99px" class="cls_010"><span class="cls_010">public final static QName PROP_ISACTIVE =</span></div>
<div style="position:absolute;left:134.09px;top:431.79px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "isActive");</span></div>
<div style="position:absolute;left:112.49px;top:442.59px" class="cls_010"><span class="cls_010">public final static QName PROP_CLIENTNAME =</span></div>
<div style="position:absolute;left:134.09px;top:453.39px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "clientName");</span></div>
<div style="position:absolute;left:112.49px;top:464.19px" class="cls_010"><span class="cls_010">public final static QName PROP_PROJECTNAME =</span></div>
<div style="position:absolute;left:134.09px;top:474.99px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "projectName");</span></div>
<div style="position:absolute;left:112.49px;top:485.79px" class="cls_010"><span class="cls_010">public final static QName ASSOC_RELATEDOCUMENTS =</span></div>
<div style="position:absolute;left:134.09px;top:496.59px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "relatedDocuments");</span></div>
<div style="position:absolute;left:91.32px;top:528.00px" class="cls_004"><span class="cls_004">5. You are probably fluent in Java, and you know that you need to import some</span></div>
<div style="position:absolute;left:104.69px;top:540.60px" class="cls_004"><span class="cls_004">Java references. So far, you need only one reference:</span></div>
<div style="position:absolute;left:112.49px;top:563.81px" class="cls_010"><span class="cls_010">import org.alfresco.service.namespace.QName;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 122 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:92612px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background138.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. Then, we are ready to create the Java class representing the action. Create a new</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">class in your </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">java</span><span class="cls_004"> directory called</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_013"><span class="cls_013">com.someco.repo.action.executer.SetWebFlag</span><span class="cls_004">. The class extends</span></div>
<div style="position:absolute;left:104.69px;top:109.66px" class="cls_013"><span class="cls_013">ActionExecuterAbstractBase</span><span class="cls_004">, which means there are two methods that need</span></div>
<div style="position:absolute;left:104.69px;top:122.94px" class="cls_004"><span class="cls_004">to be implemented: </span><span class="cls_013">executeImpl</span><span class="cls_004"> and </span><span class="cls_013">addParameterDefinitions</span><span class="cls_004">. The</span></div>
<div style="position:absolute;left:104.69px;top:136.22px" class="cls_004"><span class="cls_004">skeleton of your Java class should look like:</span></div>
<div style="position:absolute;left:117.89px;top:159.43px" class="cls_010"><span class="cls_010">package com.someco.repo.action.executer;</span></div>
<div style="position:absolute;left:117.89px;top:181.03px" class="cls_010"><span class="cls_010">import java.util.List;</span></div>
<div style="position:absolute;left:117.89px;top:191.83px" class="cls_010"><span class="cls_010">import org.alfresco.repo.action</span></div>
<div style="position:absolute;left:139.49px;top:202.63px" class="cls_010"><span class="cls_010">.executer.ActionExecuterAbstractBase;</span></div>
<div style="position:absolute;left:117.89px;top:213.43px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.Action;</span></div>
<div style="position:absolute;left:117.89px;top:224.23px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.ParameterDefinition;</span></div>
<div style="position:absolute;left:117.89px;top:235.03px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.repository.NodeRef;</span></div>
<div style="position:absolute;left:117.89px;top:256.63px" class="cls_010"><span class="cls_010">public class SetWebFlag</span></div>
<div style="position:absolute;left:139.49px;top:267.43px" class="cls_010"><span class="cls_010">extends ActionExecuterAbstractBase {</span></div>
<div style="position:absolute;left:150.29px;top:289.03px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:150.29px;top:299.83px" class="cls_010"><span class="cls_010">protected void</span></div>
<div style="position:absolute;left:161.09px;top:310.63px" class="cls_010"><span class="cls_010">executeImpl(Action action, NodeRef actionedUponNodeRef) {</span></div>
<div style="position:absolute;left:150.29px;top:321.43px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:150.29px;top:343.03px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:150.29px;top:353.83px" class="cls_010"><span class="cls_010">protected void</span></div>
<div style="position:absolute;left:161.09px;top:364.63px" class="cls_010"><span class="cls_010">addParameterDefinitions(List&lt;ParameterDefinition&gt;</span></div>
<div style="position:absolute;left:74.69px;top:375.43px" class="cls_010"><span class="cls_010">paramList) {</span></div>
<div style="position:absolute;left:150.29px;top:386.23px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:407.83px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:439.24px" class="cls_004"><span class="cls_004">7. First, let's start by defining the static variable representing the only parameter:</span></div>
<div style="position:absolute;left:117.89px;top:462.45px" class="cls_010"><span class="cls_010">public final static String PARAM_ACTIVE = "active";</span></div>
<div style="position:absolute;left:91.32px;top:483.06px" class="cls_004"><span class="cls_004">8. Start implementing the </span><span class="cls_013">executeImpl</span><span class="cls_004"> method. We could add a first check if the</span></div>
<div style="position:absolute;left:104.69px;top:496.34px" class="cls_004"><span class="cls_004">node exists or not, but to minimize our code in this exercise, we'll assume that the</span></div>
<div style="position:absolute;left:104.69px;top:508.94px" class="cls_004"><span class="cls_004">node exists. This code expects a parameter containing the flag indicating how the</span></div>
<div style="position:absolute;left:104.69px;top:521.54px" class="cls_013"><span class="cls_013">isActive</span><span class="cls_004"> property should be set. For now, the parameter is optional. So if it is</span></div>
<div style="position:absolute;left:104.69px;top:534.82px" class="cls_013"><span class="cls_013">null</span><span class="cls_004">, default it to </span><span class="cls_013">true</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:123.29px;top:558.71px" class="cls_010"><span class="cls_010">boolean activeFlag = true;</span></div>
<div style="position:absolute;left:123.29px;top:569.51px" class="cls_010"><span class="cls_010">if (action.getParameterValue(PARAM_ACTIVE) != null)</span></div>
<div style="position:absolute;left:134.09px;top:580.31px" class="cls_010"><span class="cls_010">activeFlag = (Boolean) action.getParameterValue(PARAM_ACTIVE);</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 123 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:93288px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background139.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. Setting the properties appropriately is a two-step process. First, grab the current</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">properties from the node. (The </span><span class="cls_013">nodeService</span><span class="cls_004"> is a dependency that will get set</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">through a Spring bean configuration. The corresponding variable is created in the</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">step 15.)</span></div>
<div style="position:absolute;left:117.89px;top:132.19px" class="cls_010"><span class="cls_010">Map&lt;QName, Serializable&gt; properties =</span></div>
<div style="position:absolute;left:139.49px;top:142.99px" class="cls_010"><span class="cls_010">nodeService.getProperties(actionedUponNodeRef);</span></div>
<div style="position:absolute;left:86.07px;top:163.60px" class="cls_004"><span class="cls_004">10. Then add the new property value to the properties map.</span></div>
<div style="position:absolute;left:117.89px;top:186.81px" class="cls_010"><span class="cls_010">properties.put( SomeCoModel.PROP_ISACTIVE, activeFlag);</span></div>
<div style="position:absolute;left:86.07px;top:207.42px" class="cls_004"><span class="cls_004">11. If the </span><span class="cls_013">activeFlag</span><span class="cls_004"> is being set to </span><span class="cls_013">true</span><span class="cls_004">, set the published date property to the</span></div>
<div style="position:absolute;left:104.69px;top:220.70px" class="cls_004"><span class="cls_004">current date.</span></div>
<div style="position:absolute;left:117.89px;top:243.91px" class="cls_010"><span class="cls_010">if (activeFlag) {</span></div>
<div style="position:absolute;left:144.89px;top:254.71px" class="cls_010"><span class="cls_010">properties.put( SomeCoModel.PROP_PUBLISHED, new Date());</span></div>
<div style="position:absolute;left:117.89px;top:265.51px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:286.12px" class="cls_004"><span class="cls_004">12. Next, check for the aspect. If the aspect has already been added, just set the</span></div>
<div style="position:absolute;left:104.69px;top:298.72px" class="cls_004"><span class="cls_004">properties. Otherwise, it needs to be added. The aspect can be added and the</span></div>
<div style="position:absolute;left:104.69px;top:311.32px" class="cls_004"><span class="cls_004">properties can be set in one step.</span></div>
<div style="position:absolute;left:117.89px;top:334.53px" class="cls_010"><span class="cls_010">// if the aspect has already been added, set the properties</span></div>
<div style="position:absolute;left:117.89px;top:345.33px" class="cls_010"><span class="cls_010">if (nodeService.hasAspect(actionedUponNodeRef,</span></div>
<div style="position:absolute;left:139.49px;top:356.13px" class="cls_010"><span class="cls_010">SomeCoModel.ASPECT_WEBABLE)) {</span></div>
<div style="position:absolute;left:161.09px;top:366.93px" class="cls_010"><span class="cls_010">nodeService.setProperties(actionedUponNodeRef, properties);</span></div>
<div style="position:absolute;left:117.89px;top:377.73px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:134.09px;top:388.53px" class="cls_010"><span class="cls_010">// otherwise, add the aspect and set the properties</span></div>
<div style="position:absolute;left:134.09px;top:399.33px" class="cls_010"><span class="cls_010">nodeService.addAspect(actionedUponNodeRef,</span></div>
<div style="position:absolute;left:139.49px;top:410.13px" class="cls_010"><span class="cls_010">SomeCoModel.ASPECT_WEBABLE, properties);</span></div>
<div style="position:absolute;left:86.07px;top:430.74px" class="cls_004"><span class="cls_004">13. Save the class.</span></div>
<div style="position:absolute;left:86.07px;top:445.50px" class="cls_004"><span class="cls_004">14. Now implement the </span><span class="cls_013">addParameterDefinitions</span><span class="cls_004"> method. This method defines</span></div>
<div style="position:absolute;left:104.69px;top:458.78px" class="cls_004"><span class="cls_004">the parameters our action uses. The method is implemented as follows.</span></div>
<div style="position:absolute;left:117.89px;top:481.99px" class="cls_010"><span class="cls_010">paramList.add(new ParameterDefinitionImpl(PARAM_ACTIVE,</span></div>
<div style="position:absolute;left:166.49px;top:492.79px" class="cls_010"><span class="cls_010">DataTypeDefinition.BOOLEAN,</span></div>
<div style="position:absolute;left:166.49px;top:503.59px" class="cls_010"><span class="cls_010">false,</span></div>
<div style="position:absolute;left:166.49px;top:514.39px" class="cls_010"><span class="cls_010">getParamDisplayLabel(PARAM_ACTIVE)));</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 124 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:93964px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background140.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">15. The last step is to create the local variable for the </span><span class="cls_013">nodeService</span><span class="cls_004"> and the</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">associated setter method. The fastest way to do this is to simply add the local</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">variable and then use STS to generate the setter methods. The class also has a</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">couple of constants, shown below, to make it easier for others to work with the</span></div>
<div style="position:absolute;left:104.69px;top:121.58px" class="cls_004"><span class="cls_004">action class.</span></div>
<div style="position:absolute;left:117.89px;top:144.79px" class="cls_010"><span class="cls_010">protected NodeService nodeService;</span></div>
<div style="position:absolute;left:117.89px;top:155.59px" class="cls_010"><span class="cls_010">public final static String NAME = "set-web-flag";</span></div>
<div style="position:absolute;left:86.07px;top:176.20px" class="cls_004"><span class="cls_004">16. Here is all references that you'll need to add:</span></div>
<div style="position:absolute;left:112.49px;top:199.41px" class="cls_010"><span class="cls_010">import java.io.Serializable;</span></div>
<div style="position:absolute;left:112.49px;top:210.21px" class="cls_010"><span class="cls_010">import java.util.Date;</span></div>
<div style="position:absolute;left:112.49px;top:221.01px" class="cls_010"><span class="cls_010">import java.util.List;</span></div>
<div style="position:absolute;left:112.49px;top:231.81px" class="cls_010"><span class="cls_010">import java.util.Map;</span></div>
<div style="position:absolute;left:112.49px;top:253.41px" class="cls_010"><span class="cls_010">import org.alfresco.repo.action.ParameterDefinitionImpl;</span></div>
<div style="position:absolute;left:112.49px;top:264.21px" class="cls_010"><span class="cls_010">import org.alfresco.repo.action.executer.ActionExecuterAbstractBase;</span></div>
<div style="position:absolute;left:112.49px;top:275.01px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.Action;</span></div>
<div style="position:absolute;left:112.49px;top:285.81px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.ParameterDefinition;</span></div>
<div style="position:absolute;left:112.49px;top:296.61px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.dictionary.DataTypeDefinition;</span></div>
<div style="position:absolute;left:112.49px;top:307.41px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.repository.NodeRef;</span></div>
<div style="position:absolute;left:112.49px;top:318.21px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.repository.NodeService;</span></div>
<div style="position:absolute;left:112.49px;top:329.01px" class="cls_010"><span class="cls_010">import org.alfresco.service.namespace.QName;</span></div>
<div style="position:absolute;left:112.49px;top:350.61px" class="cls_010"><span class="cls_010">import com.someco.repo.common.SomeCoModel;</span></div>
<div style="position:absolute;left:86.07px;top:371.22px" class="cls_004"><span class="cls_004">17. Save the class.</span></div>
<div style="position:absolute;left:86.07px;top:385.98px" class="cls_004"><span class="cls_004">18. Now write a Spring bean configuration file. Call it </span><span class="cls_013">action-context.xml</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:104.69px;top:399.26px" class="cls_004"><span class="cls_004">save it in the directory </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span></div>
<div style="position:absolute;left:104.69px;top:412.54px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">context</span><span class="cls_004">. The content of the config file is shown here:</span></div>
<div style="position:absolute;left:117.89px;top:436.43px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:447.23px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN'</span></div>
<div style="position:absolute;left:139.49px;top:458.03px" class="cls_010"><span class="cls_010">'</span><a href="http://www.springframework.org/dtd/spring-beans.dtd&#39;/">http://www.springframework.org/dtd/spring-beans.dtd'</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:468.83px" class="cls_010"><span class="cls_010">&lt;beans&gt;</span></div>
<div style="position:absolute;left:139.49px;top:479.63px" class="cls_010"><span class="cls_010">&lt;bean id="set-web-flag"</span></div>
<div style="position:absolute;left:161.09px;top:490.43px" class="cls_010"><span class="cls_010">class="com.someco.repo.action.executer.SetWebFlag"</span></div>
<div style="position:absolute;left:161.09px;top:501.23px" class="cls_010"><span class="cls_010">parent="action-executer"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:522.83px" class="cls_010"><span class="cls_010">&lt;property name="nodeService" ref="NodeService" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:533.63px" class="cls_010"><span class="cls_010">&lt;property name="publicAction"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:544.43px" class="cls_010"><span class="cls_010">&lt;value&gt;true&lt;/value&gt;</span></div>
<div style="position:absolute;left:161.09px;top:555.23px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:566.03px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:139.49px;top:576.83px" class="cls_010"><span class="cls_010">&lt;bean id="someco.actionResourceBundles"</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 125 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:94640px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background141.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">class="org.alfresco.i18n.ResourceBundleBootstrapComponent"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:80.62px" class="cls_010"><span class="cls_010">&lt;property name="resourceBundles"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:91.42px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:182.69px;top:102.22px" class="cls_010"><span class="cls_010">&lt;value&gt;</span></div>
<div style="position:absolute;left:204.29px;top:113.02px" class="cls_010"><span class="cls_010">alfresco.module.${project.artifactId}</span></div>
<div style="position:absolute;left:215.09px;top:123.82px" class="cls_010"><span class="cls_010">.messages.action-config</span></div>
<div style="position:absolute;left:182.69px;top:134.62px" class="cls_010"><span class="cls_010">&lt;/value&gt;</span></div>
<div style="position:absolute;left:161.09px;top:145.42px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:156.22px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:167.02px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:86.07px;top:198.43px" class="cls_004"><span class="cls_004">19. Then, edit the file </span><span class="cls_013">module-context.xml</span><span class="cls_004"> located in the  </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span></div>
<div style="position:absolute;left:104.69px;top:211.71px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> directory. You just need to add the</span></div>
<div style="position:absolute;left:104.69px;top:224.99px" class="cls_004"><span class="cls_004">following import:</span></div>
<div style="position:absolute;left:117.89px;top:248.20px" class="cls_010"><span class="cls_010">&lt;import resource="classpath:alfresco/module</span></div>
<div style="position:absolute;left:139.49px;top:259.00px" class="cls_010"><span class="cls_010">/${project.artifactId}/context/action-context.xml" /&gt;</span></div>
<div style="position:absolute;left:86.07px;top:290.41px" class="cls_004"><span class="cls_004">20. Create the I18N properties file </span><span class="cls_013">action-config.properties</span><span class="cls_004"> that will contain</span></div>
<div style="position:absolute;left:104.69px;top:303.69px" class="cls_004"><span class="cls_004">the different labels in the </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:316.97px" class="cls_013"><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">message</span><span class="cls_004"> directory. Be careful to follow the naming convention</span></div>
<div style="position:absolute;left:104.69px;top:330.25px" class="cls_004"><span class="cls_004">that you'll easily understand:</span></div>
<div style="position:absolute;left:117.89px;top:353.46px" class="cls_010"><span class="cls_010">&lt;ACTION NAME&gt;.title=...</span></div>
<div style="position:absolute;left:117.89px;top:364.26px" class="cls_010"><span class="cls_010">&lt;ACTION NAME&gt;.decription=...</span></div>
<div style="position:absolute;left:117.89px;top:375.06px" class="cls_010"><span class="cls_010">&lt;ACTION NAME&gt;.&lt;PARAMETER NAME&gt;.display-label=...</span></div>
<div style="position:absolute;left:117.89px;top:385.86px" class="cls_010"><span class="cls_010">In our case, we'll have:</span></div>
<div style="position:absolute;left:117.89px;top:396.66px" class="cls_010"><span class="cls_010">set-web-flag.title=Sets the SC Web Flag</span></div>
<div style="position:absolute;left:117.89px;top:407.46px" class="cls_010"><span class="cls_010">set-web-flag.decription=This will add the sc:webable aspect</span></div>
<div style="position:absolute;left:139.49px;top:418.26px" class="cls_010"><span class="cls_010">and set the isActive flag.</span></div>
<div style="position:absolute;left:117.89px;top:429.06px" class="cls_010"><span class="cls_010">set-web-flag.active.display-label=Active?</span></div>
<div style="position:absolute;left:86.07px;top:449.67px" class="cls_004"><span class="cls_004">21. Stop Alfresco.</span></div>
<div style="position:absolute;left:86.07px;top:464.43px" class="cls_004"><span class="cls_004">22. Package and move the module to your virtual machine.</span></div>
<div style="position:absolute;left:86.07px;top:479.19px" class="cls_004"><span class="cls_004">23. Deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 126 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:95316px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background142.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">if you try to create a rule on a folder, you should see your new action:</span></div>
<div style="position:absolute;left:56.69px;top:260.27px" class="cls_004"><span class="cls_004">When the rule will be applied to the documents moved or uploaded into this folder, the</span></div>
<div style="position:absolute;left:56.69px;top:272.87px" class="cls_004"><span class="cls_004">aspects and properties will be properly set. At this stage, you can't execute this action by</span></div>
<div style="position:absolute;left:56.69px;top:285.47px" class="cls_004"><span class="cls_004">just clicking on a Share action. We'll cover that in the following chapter.</span></div>
<div style="position:absolute;left:56.69px;top:322.17px" class="cls_014"><span class="cls_014">Hiding the action from end users</span></div>
<div style="position:absolute;left:56.69px;top:347.39px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">publicAction</span><span class="cls_004"> parameter in the actions Spring bean configuration (</span><span class="cls_013">action-</span></div>
<div style="position:absolute;left:56.69px;top:360.67px" class="cls_013"><span class="cls_013">context.xml</span><span class="cls_004">) tells Alfresco whether or not to include the action in the dropdown list. For</span></div>
<div style="position:absolute;left:56.69px;top:373.95px" class="cls_004"><span class="cls_004">now, the flag is set to true. In the next chapter, you'll learn how to trigger the action from a</span></div>
<div style="position:absolute;left:56.69px;top:386.55px" class="cls_004"><span class="cls_004">UI action link. You will be able to make the UI Action Link hide or disappear based on logic</span></div>
<div style="position:absolute;left:56.69px;top:399.15px" class="cls_004"><span class="cls_004">(such as whether or not the current user is a member of a particular group). At that point,</span></div>
<div style="position:absolute;left:56.69px;top:411.75px" class="cls_004"><span class="cls_004">you'll set the flag to false to keep end users from running the action via the Manage</span></div>
<div style="position:absolute;left:56.69px;top:424.35px" class="cls_004"><span class="cls_004">Rulesscreen.</span></div>
<div style="position:absolute;left:56.69px;top:461.05px" class="cls_014"><span class="cls_014">Creating actions that require user-specified</span></div>
<div style="position:absolute;left:56.69px;top:482.65px" class="cls_014"><span class="cls_014">parameters</span></div>
<div style="position:absolute;left:56.69px;top:507.87px" class="cls_004"><span class="cls_004">In the previous example, an end user does not need to specify any parameters for the action</span></div>
<div style="position:absolute;left:56.69px;top:520.47px" class="cls_004"><span class="cls_004">to run successfully. But some actions can be reused much more broadly if they are set up to</span></div>
<div style="position:absolute;left:56.69px;top:533.07px" class="cls_004"><span class="cls_004">allow an end user to specify parameters.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 127 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:95992px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background143.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">For example, imagine that SomeCo's Human Resources department wants to store HR</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">policies in the repository. Suppose they have a three-folder system for keeping track of</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_007"><span class="cls_007">Draft</span><span class="cls_004">, </span><span class="cls_007">Active</span><span class="cls_004">, and </span><span class="cls_007">Archive</span><span class="cls_004"> policies. Policies often replace or supersede existing policies.</span></div>
<div style="position:absolute;left:56.69px;top:108.34px" class="cls_004"><span class="cls_004">The HR department would like to tag a draft policy with the policy it replaces (a policy</span></div>
<div style="position:absolute;left:56.69px;top:120.94px" class="cls_004"><span class="cls_004">sitting in the </span><span class="cls_007">Active</span><span class="cls_004"> folder). The HR Department will move policies from the </span><span class="cls_007">Draft</span><span class="cls_004"> folder to</span></div>
<div style="position:absolute;left:56.69px;top:133.58px" class="cls_004"><span class="cls_004">the </span><span class="cls_007">Active</span><span class="cls_004"> folder. When the draft policy is moved into the </span><span class="cls_007">Active</span><span class="cls_004"> folder, the policy it</span></div>
<div style="position:absolute;left:56.69px;top:146.21px" class="cls_004"><span class="cls_004">replaces should automatically move from the </span><span class="cls_007">Active</span><span class="cls_004"> folder to the </span><span class="cls_007">Archive</span><span class="cls_004"> folder:</span></div>
<div style="position:absolute;left:56.69px;top:260.27px" class="cls_004"><span class="cls_004">The code that moves the old policy from the </span><span class="cls_007">Active</span><span class="cls_004"> folder into the </span><span class="cls_007">Archive</span><span class="cls_004"> folder can be</span></div>
<div style="position:absolute;left:56.69px;top:272.91px" class="cls_004"><span class="cls_004">implemented as an action. The action can be called by a rule that fires when a document is</span></div>
<div style="position:absolute;left:56.69px;top:285.51px" class="cls_004"><span class="cls_004">added to a folder. The action's job is to figure out whether or not the incoming document is</span></div>
<div style="position:absolute;left:56.69px;top:298.11px" class="cls_004"><span class="cls_004">replacing another document in the same folder. If it is, the action needs to move the</span></div>
<div style="position:absolute;left:56.69px;top:310.71px" class="cls_004"><span class="cls_004">replaced document to a target folder. In this case, the target folder is the </span><span class="cls_007">Archive</span><span class="cls_004"> folder.</span></div>
<div style="position:absolute;left:56.69px;top:323.34px" class="cls_004"><span class="cls_004">Without letting the user set the parameter, the target folder would have to be hardcoded.</span></div>
<div style="position:absolute;left:56.69px;top:335.94px" class="cls_004"><span class="cls_004">Instead, you'll create this action with a parameter so that if the target folder ever changes</span></div>
<div style="position:absolute;left:56.69px;top:348.54px" class="cls_004"><span class="cls_004">(from </span><span class="cls_007">Archive</span><span class="cls_004"> to </span><span class="cls_007">Old Policies</span><span class="cls_004">, for example), or if someone else wants to use the action with</span></div>
<div style="position:absolute;left:56.69px;top:361.18px" class="cls_004"><span class="cls_004">their own set of folders, it won't require a code change.</span></div>
<div style="position:absolute;left:56.69px;top:395.83px" class="cls_023"><span class="cls_023">Step-by-step - creating an action configurable in</span></div>
<div style="position:absolute;left:56.69px;top:415.03px" class="cls_023"><span class="cls_023">Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:437.74px" class="cls_004"><span class="cls_004">Before starting, think about similar code that might already exist within Alfresco that you</span></div>
<div style="position:absolute;left:56.69px;top:450.34px" class="cls_004"><span class="cls_004">could leverage for the new action. Alfresco is open source. So it would be a shame to ignore</span></div>
<div style="position:absolute;left:56.69px;top:462.94px" class="cls_004"><span class="cls_004">the source and end up recreating a functionality that already exists. Plus, following the</span></div>
<div style="position:absolute;left:56.69px;top:475.54px" class="cls_004"><span class="cls_004">same pattern to implement our customization will make it easier for someone to support</span></div>
<div style="position:absolute;left:56.69px;top:488.14px" class="cls_004"><span class="cls_004">and share our code with others.</span></div>
<div style="position:absolute;left:56.69px;top:509.74px" class="cls_004"><span class="cls_004">It turns out that there is already an out-of-the-box </span><span class="cls_007">Move</span><span class="cls_004"> action. The out-of-the-box Move</span></div>
<div style="position:absolute;left:56.69px;top:522.38px" class="cls_004"><span class="cls_004">action moves the node against which the action is running to a target folder specified as a</span></div>
<div style="position:absolute;left:56.69px;top:534.98px" class="cls_004"><span class="cls_004">parameter. The difference between Alfresco's Move action and the new custom action is</span></div>
<div style="position:absolute;left:56.69px;top:547.58px" class="cls_004"><span class="cls_004">that the node that needs to be moved isn't the node the action is running against; it's the</span></div>
<div style="position:absolute;left:56.69px;top:560.18px" class="cls_004"><span class="cls_004">node containing the old policy.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 128 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:96668px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background144.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.51px" class="cls_004"><span class="cls_004">The action can get to the old policy because the new policy document has a </span><span class="cls_012">replaces</span></div>
<div style="position:absolute;left:56.69px;top:83.11px" class="cls_004"><span class="cls_004">relationship with the old policy document. So the action will look to see if the newly arrived</span></div>
<div style="position:absolute;left:56.69px;top:95.71px" class="cls_004"><span class="cls_004">document has a </span><span class="cls_012">replaces</span><span class="cls_004"> relationship. If it does, it will grab the target of that relationship (the</span></div>
<div style="position:absolute;left:56.69px;top:108.31px" class="cls_004"><span class="cls_004">document being replaced) and move it to the target folder.</span></div>
<div style="position:absolute;left:56.69px;top:129.91px" class="cls_004"><span class="cls_004">The previous example consisted of an Action Executer class, its Spring bean configuration</span></div>
<div style="position:absolute;left:56.69px;top:142.51px" class="cls_004"><span class="cls_004">file, and a properties file. To create an action that accepts parameters, you will be creating a</span></div>
<div style="position:absolute;left:56.69px;top:155.11px" class="cls_004"><span class="cls_004">UI to set the destination folder, which requires the same ingredients as a basic action.</span></div>
<div style="position:absolute;left:56.69px;top:176.71px" class="cls_004"><span class="cls_004">To create a new action that accesses parameters, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:198.44px" class="cls_004"><span class="cls_004">1. There isn't anything in the SomeCo model related to HR policies. So update </span><span class="cls_013">repo</span></div>
<div style="position:absolute;left:104.69px;top:211.72px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">model</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:225.00px" class="cls_013"><span class="cls_013">scModel.xml</span><span class="cls_004"> with a new type called </span><span class="cls_013">sc:hrPolicy</span><span class="cls_004"> that is a child of </span><span class="cls_013">sc:hrDoc</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:112.49px;top:248.89px" class="cls_010"><span class="cls_010">&lt;type name="sc:hrPolicy"&gt;</span></div>
<div style="position:absolute;left:123.29px;top:259.69px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco HR Policy&lt;/title&gt;</span></div>
<div style="position:absolute;left:155.69px;top:270.49px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:hrDoc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:112.49px;top:281.29px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:91.32px;top:301.90px" class="cls_004"><span class="cls_004">2. Alfresco has a </span><span class="cls_013">cm:replaceable</span><span class="cls_004"> aspect available out of the box that will work</span></div>
<div style="position:absolute;left:104.69px;top:315.18px" class="cls_004"><span class="cls_004">perfectly for this. All HR policies are replaceable. So make the aspect a</span></div>
<div style="position:absolute;left:104.69px;top:327.78px" class="cls_004"><span class="cls_004">mandatory aspect of the new type by adding the following immediately after the</span></div>
<div style="position:absolute;left:104.69px;top:340.38px" class="cls_004"><span class="cls_004">parent element of the </span><span class="cls_013">sc:hrPolicy</span><span class="cls_004"> type:</span></div>
<div style="position:absolute;left:112.49px;top:364.27px" class="cls_010"><span class="cls_010">&lt;mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:123.29px;top:375.07px" class="cls_010"><span class="cls_010">&lt;aspect&gt;cm:replaceable&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:112.49px;top:385.87px" class="cls_010"><span class="cls_010">&lt;/mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:91.32px;top:406.48px" class="cls_004"><span class="cls_004">3. Although the aspect is available out of the box, it isn't configured to show in the</span></div>
<div style="position:absolute;left:104.69px;top:419.08px" class="cls_004"><span class="cls_004">UI by default. So add the following to </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:442.97px" class="cls_010"><span class="cls_010">&lt;config evaluator="aspect" condition="cm:replaceable"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:453.77px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:161.09px;top:464.57px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:182.69px;top:475.37px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:204.29px;top:486.17px" class="cls_010"><span class="cls_010">&lt;show id="cm:replaces" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:496.97px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:507.77px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:518.57px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:529.37px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 129 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:97344px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background145.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Don't forget to add cm:replaceable to the list of visible aspects in the same file.</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">And configure the list of types to make available our new type sc:hrPolicy.</span></div>
<div style="position:absolute;left:91.32px;top:97.86px" class="cls_004"><span class="cls_004">5. Don't forget to add the new type </span><span class="cls_013">sc:hrPolicy</span><span class="cls_004"> to the list of valid childtypes for</span></div>
<div style="position:absolute;left:104.69px;top:111.14px" class="cls_013"><span class="cls_013">cm:content</span><span class="cls_004">, </span><span class="cls_013">sc:doc</span><span class="cls_004"> and </span><span class="cls_013">sc:hrDoc</span><span class="cls_004"> in theshare-config-custom.xml file.</span></div>
<div style="position:absolute;left:91.32px;top:126.58px" class="cls_004"><span class="cls_004">6. And of course, update the Java class SomeCoModel by adding a reference for our</span></div>
<div style="position:absolute;left:104.69px;top:139.18px" class="cls_004"><span class="cls_004">new type:</span></div>
<div style="position:absolute;left:117.89px;top:162.39px" class="cls_010"><span class="cls_010">public final static QName TYPE_HRPOLICY =</span></div>
<div style="position:absolute;left:139.49px;top:173.19px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "hrPolicy");</span></div>
<div style="position:absolute;left:91.32px;top:193.80px" class="cls_004"><span class="cls_004">7. Open the </span><span class="cls_013">share.properties</span><span class="cls_004"> file in the share project and add this line:</span></div>
<div style="position:absolute;left:117.89px;top:217.69px" class="cls_010"><span class="cls_010">aspect.cm_replaceable=Replaceable aspect</span></div>
<div style="position:absolute;left:91.32px;top:238.30px" class="cls_004"><span class="cls_004">8. Before we start the Java code, let's update the scModel.properties by adding the</span></div>
<div style="position:absolute;left:104.69px;top:250.90px" class="cls_004"><span class="cls_004">I18N display label:</span></div>
<div style="position:absolute;left:117.89px;top:274.11px" class="cls_010"><span class="cls_010">sc_somecomodel.type.sc_hrPolicy.title=Someco HR Policy</span></div>
<div style="position:absolute;left:91.32px;top:305.52px" class="cls_004"><span class="cls_004">9. That's all for the model-related changes. Now let's work on the action executer</span></div>
<div style="position:absolute;left:104.69px;top:318.12px" class="cls_004"><span class="cls_004">class. Create your Java class into </span><span class="cls_007">repo|src|man|java</span><span class="cls_004"> and call it</span></div>
<div style="position:absolute;left:104.69px;top:330.76px" class="cls_013"><span class="cls_013">com.someco.repo.action.executer.MoveReplacedActionExecuter</span><span class="cls_004">. The</span></div>
<div style="position:absolute;left:104.69px;top:344.04px" class="cls_004"><span class="cls_004">class extends </span><span class="cls_013">ActionExecuterAbstractBase</span><span class="cls_004">, which means we need to</span></div>
<div style="position:absolute;left:104.69px;top:357.32px" class="cls_004"><span class="cls_004">implement the two same methods as previously: </span><span class="cls_013">executeImpl</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:104.69px;top:370.60px" class="cls_013"><span class="cls_013">addParameterDefinitions</span><span class="cls_004">. Just as in the previous example, the heavy lifting is</span></div>
<div style="position:absolute;left:104.69px;top:383.88px" class="cls_004"><span class="cls_004">done in the </span><span class="cls_013">executeImpl</span><span class="cls_004"> method. You should have something like that:</span></div>
<div style="position:absolute;left:117.89px;top:407.77px" class="cls_010"><span class="cls_010">package com.someco.repo.action.executer;</span></div>
<div style="position:absolute;left:117.89px;top:429.37px" class="cls_010"><span class="cls_010">import java.util.List;</span></div>
<div style="position:absolute;left:117.89px;top:440.17px" class="cls_010"><span class="cls_010">import</span></div>
<div style="position:absolute;left:74.69px;top:450.97px" class="cls_010"><span class="cls_010">org.alfresco.repo.action.executer.ActionExecuterAbstractBase;</span></div>
<div style="position:absolute;left:117.89px;top:461.77px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.Action;</span></div>
<div style="position:absolute;left:117.89px;top:472.57px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.ParameterDefinition;</span></div>
<div style="position:absolute;left:117.89px;top:483.37px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.repository.NodeRef;</span></div>
<div style="position:absolute;left:117.89px;top:504.97px" class="cls_010"><span class="cls_010">public class MoveReplacedActionExecuter extends</span></div>
<div style="position:absolute;left:117.89px;top:515.77px" class="cls_010"><span class="cls_010">ActionExecuterAbstractBase {</span></div>
<div style="position:absolute;left:128.69px;top:537.37px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:128.69px;top:548.17px" class="cls_010"><span class="cls_010">protected void executeImpl(Action ruleAction,</span></div>
<div style="position:absolute;left:139.49px;top:558.97px" class="cls_010"><span class="cls_010">NodeRef actionedUponNodeRef) {</span></div>
<div style="position:absolute;left:139.49px;top:569.77px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 130 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:98020px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background146.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:128.69px;top:69.82px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">protected void</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">addParameterDefinitions(List&lt;ParameterDefinition&gt; paramList) {</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:155.23px" class="cls_004"><span class="cls_004">10. It's the first time that we are going to define a logger in this book. Of course, it's</span></div>
<div style="position:absolute;left:104.69px;top:167.83px" class="cls_004"><span class="cls_004">highly recommended to define loggers in all Java code. Add the following</span></div>
<div style="position:absolute;left:104.69px;top:180.43px" class="cls_013"><span class="cls_013">logger</span><span class="cls_004"> in your class:</span></div>
<div style="position:absolute;left:117.89px;top:204.32px" class="cls_010"><span class="cls_010">private static Logger logger =</span></div>
<div style="position:absolute;left:139.49px;top:215.12px" class="cls_010"><span class="cls_010">Logger.getLogger(MoveReplacedActionExecuter.class);</span></div>
<div style="position:absolute;left:86.07px;top:235.73px" class="cls_004"><span class="cls_004">11. Then define the static variable representing the only parameter:</span></div>
<div style="position:absolute;left:117.89px;top:258.94px" class="cls_010"><span class="cls_010">public static final String PARAM_DESTINATION_FOLDER =</span></div>
<div style="position:absolute;left:139.49px;top:269.74px" class="cls_010"><span class="cls_010">"destination-folder";</span></div>
<div style="position:absolute;left:86.07px;top:290.35px" class="cls_004"><span class="cls_004">12. Let's start by implementing the </span><span class="cls_013">executeImpl</span><span class="cls_004"> method. The first thing to do is to</span></div>
<div style="position:absolute;left:104.69px;top:303.63px" class="cls_004"><span class="cls_004">create the </span><span class="cls_013">QName</span><span class="cls_004"> object for the </span><span class="cls_013">replaces</span><span class="cls_004"> association, and check if some</span></div>
<div style="position:absolute;left:104.69px;top:316.91px" class="cls_004"><span class="cls_004">association are defined on the current object:</span></div>
<div style="position:absolute;left:117.89px;top:340.12px" class="cls_010"><span class="cls_010">QName assocReplacesQname = QName.createQName(</span></div>
<div style="position:absolute;left:117.89px;top:350.92px" class="cls_010"><span class="cls_010">NamespaceService.CONTENT_MODEL_1_0_URI, "replaces");</span></div>
<div style="position:absolute;left:117.89px;top:361.72px" class="cls_010"><span class="cls_010">List&lt;AssociationRef&gt; assocRefs = nodeService.getTargetAssocs(</span></div>
<div style="position:absolute;left:117.89px;top:372.52px" class="cls_010"><span class="cls_010">actionedUponNodeRef, assocReplacesQname);</span></div>
<div style="position:absolute;left:117.89px;top:383.32px" class="cls_010"><span class="cls_010">if (!assocRefs.isEmpty()) {</span></div>
<div style="position:absolute;left:128.69px;top:394.12px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:117.89px;top:404.92px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:436.33px" class="cls_004"><span class="cls_004">13. Then, in the </span><span class="cls_013">if</span><span class="cls_004"> statement, we need to browse all associated items:</span></div>
<div style="position:absolute;left:117.89px;top:460.22px" class="cls_010"><span class="cls_010">NodeRef destinationParent = (NodeRef)</span></div>
<div style="position:absolute;left:117.89px;top:471.02px" class="cls_010"><span class="cls_010">ruleAction.getParameterValue(PARAM_DESTINATION_FOLDER);</span></div>
<div style="position:absolute;left:117.89px;top:481.82px" class="cls_010"><span class="cls_010">for (AssociationRef assocNode : assocRefs) {</span></div>
<div style="position:absolute;left:128.69px;top:492.62px" class="cls_010"><span class="cls_010">try {</span></div>
<div style="position:absolute;left:134.09px;top:503.42px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:128.69px;top:514.22px" class="cls_010"><span class="cls_010">} catch (Exception e) {</span></div>
<div style="position:absolute;left:134.09px;top:525.02px" class="cls_010"><span class="cls_010">logger.error("Error moving the document: " +</span></div>
<div style="position:absolute;left:144.89px;top:535.82px" class="cls_010"><span class="cls_010">assocNode.getTargetRef());</span></div>
<div style="position:absolute;left:128.69px;top:546.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:557.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 131 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:98696px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background147.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">14. Finally, we need to process each association:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">NodeRef replacedDocument = assocNode.getTargetRef();</span></div>
<div style="position:absolute;left:117.89px;top:104.51px" class="cls_010"><span class="cls_010">if (nodeService.exists(replacedDocument) == true) {</span></div>
<div style="position:absolute;left:128.69px;top:115.31px" class="cls_010"><span class="cls_010">fileFolderService.move(replacedDocument,</span></div>
<div style="position:absolute;left:139.49px;top:126.11px" class="cls_010"><span class="cls_010">destinationParent, null);</span></div>
<div style="position:absolute;left:86.07px;top:146.72px" class="cls_004"><span class="cls_004">15. We need to define the parameter to specify the destination folder:</span></div>
<div style="position:absolute;left:117.89px;top:169.93px" class="cls_010"><span class="cls_010">protected void</span></div>
<div style="position:absolute;left:128.69px;top:180.73px" class="cls_010"><span class="cls_010">addParameterDefinitions(List&lt;ParameterDefinition&gt; paramList) {</span></div>
<div style="position:absolute;left:139.49px;top:191.53px" class="cls_010"><span class="cls_010">paramList.add(</span></div>
<div style="position:absolute;left:155.69px;top:202.33px" class="cls_010"><span class="cls_010">new ParameterDefinitionImpl(PARAM_DESTINATION_FOLDER,</span></div>
<div style="position:absolute;left:182.69px;top:213.13px" class="cls_010"><span class="cls_010">DataTypeDefinition.NODE_REF,</span></div>
<div style="position:absolute;left:182.69px;top:223.93px" class="cls_010"><span class="cls_010">true,</span></div>
<div style="position:absolute;left:182.69px;top:234.73px" class="cls_010"><span class="cls_010">getParamDisplayLabel(PARAM_DESTINATION_FOLDER)));</span></div>
<div style="position:absolute;left:117.89px;top:245.53px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:266.14px" class="cls_004"><span class="cls_004">16. Don't forget to define the few constants and variables that we need:</span></div>
<div style="position:absolute;left:117.89px;top:289.35px" class="cls_010"><span class="cls_010">private NodeService nodeService;</span></div>
<div style="position:absolute;left:117.89px;top:300.15px" class="cls_010"><span class="cls_010">private FileFolderService fileFolderService;</span></div>
<div style="position:absolute;left:117.89px;top:310.95px" class="cls_010"><span class="cls_010">public static final String NAME = "move-replaced";</span></div>
<div style="position:absolute;left:86.07px;top:331.56px" class="cls_004"><span class="cls_004">17. By your own, use STS to generate the required setters for the two Alfresco Java</span></div>
<div style="position:absolute;left:104.69px;top:344.16px" class="cls_004"><span class="cls_004">services that we need and the different required imports.</span></div>
<div style="position:absolute;left:86.07px;top:358.92px" class="cls_004"><span class="cls_004">18. That's it for the Java code. Now it is time to tie it all together with the appropriate</span></div>
<div style="position:absolute;left:104.69px;top:371.52px" class="cls_004"><span class="cls_004">Spring bean configuration and properties files. Declare the action executer class</span></div>
<div style="position:absolute;left:104.69px;top:384.12px" class="cls_004"><span class="cls_004">and point to the resource bundle. Edit the file action-context.xml</span><span class="cls_007">.</span><span class="cls_004"> Add the</span></div>
<div style="position:absolute;left:104.69px;top:396.76px" class="cls_004"><span class="cls_004">following:</span></div>
<div style="position:absolute;left:117.89px;top:419.97px" class="cls_010"><span class="cls_010">&lt;bean id="move-replaced"</span></div>
<div style="position:absolute;left:117.89px;top:430.77px" class="cls_010"><span class="cls_010">class="com.someco.repo.action.executer.MoveReplacedActionExecuter"</span></div>
<div style="position:absolute;left:117.89px;top:441.57px" class="cls_010"><span class="cls_010">parent="action-executer"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:452.37px" class="cls_010"><span class="cls_010">&lt;property name="nodeService" ref="NodeService" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:463.17px" class="cls_010"><span class="cls_010">&lt;property name="fileFolderService" ref="FileFolderService" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:473.97px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:494.58px" class="cls_004"><span class="cls_004">19. Update </span><span class="cls_013">action-config.properties</span><span class="cls_004"> with:</span></div>
<div style="position:absolute;left:96.29px;top:518.47px" class="cls_010"><span class="cls_010">move-replaced.title= Move replaced document to folder</span></div>
<div style="position:absolute;left:96.29px;top:529.27px" class="cls_010"><span class="cls_010">move-replaced.description=</span></div>
<div style="position:absolute;left:117.89px;top:540.07px" class="cls_010"><span class="cls_010">This will move the target node of a replaces</span></div>
<div style="position:absolute;left:117.89px;top:550.87px" class="cls_010"><span class="cls_010">association to a specified folder.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 132 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:99372px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background148.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">20. We completed everything for the repo project. Now, let's switch to the Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">Share configuration. Unfortunately, Alfresco Share is not really easy to configure</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">in this case. We'll need to override some files provided by Alfresco Share. The</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">first thing is to create the Javascript file that will handle the displaying of the rule</span></div>
<div style="position:absolute;left:104.69px;top:120.90px" class="cls_004"><span class="cls_004">in the </span><span class="cls_007">Manage Rules</span><span class="cls_004"> screen. Create the file someco-action.js in the directory</span></div>
<div style="position:absolute;left:104.69px;top:133.54px" class="cls_004"><span class="cls_004">share|src|main|amp|web|js|someco. We are not going to explain step by step</span></div>
<div style="position:absolute;left:104.69px;top:146.14px" class="cls_004"><span class="cls_004">how to create this file, but only focus on important steps. The goal is to create a</span></div>
<div style="position:absolute;left:104.69px;top:158.74px" class="cls_004"><span class="cls_004">new Javascript object SomeCo.RuleConfigActionCustom that will replace the</span></div>
<div style="position:absolute;left:104.69px;top:171.34px" class="cls_004"><span class="cls_004">default object. To achieve that, we'll extend the Alfresco Javascript object that</span></div>
<div style="position:absolute;left:104.69px;top:183.94px" class="cls_004"><span class="cls_004">contains all rules:</span></div>
<div style="position:absolute;left:117.89px;top:207.15px" class="cls_010"><span class="cls_010">YAHOO.extend(SomeCo.RuleConfigActionCustom,</span></div>
<div style="position:absolute;left:128.69px;top:217.95px" class="cls_010"><span class="cls_010">Alfresco.RuleConfigAction,</span></div>
<div style="position:absolute;left:123.29px;top:228.75px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:239.55px" class="cls_010"><span class="cls_010">customisations : {</span></div>
<div style="position:absolute;left:139.49px;top:250.35px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:128.69px;top:261.15px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:271.95px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:86.07px;top:292.56px" class="cls_004"><span class="cls_004">21. Then, we'll add the rule for our new rule, and we'll use the Move action as</span></div>
<div style="position:absolute;left:104.69px;top:305.16px" class="cls_004"><span class="cls_004">example:</span></div>
<div style="position:absolute;left:117.89px;top:328.37px" class="cls_010"><span class="cls_010">MoveReplaced : {</span></div>
<div style="position:absolute;left:128.69px;top:339.17px" class="cls_010"><span class="cls_010">text : function(configDef, ruleConfig, configEl) {</span></div>
<div style="position:absolute;left:139.49px;top:349.97px" class="cls_010"><span class="cls_010">this._getParamDef(configDef, "destination-folder")._type =</span></div>
<div style="position:absolute;left:150.29px;top:360.77px" class="cls_010"><span class="cls_010">"path";</span></div>
<div style="position:absolute;left:139.49px;top:371.57px" class="cls_010"><span class="cls_010">return configDef;</span></div>
<div style="position:absolute;left:128.69px;top:382.37px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:128.69px;top:393.17px" class="cls_010"><span class="cls_010">edit : function(configDef, ruleConfig, configEl) {</span></div>
<div style="position:absolute;left:139.49px;top:403.97px" class="cls_010"><span class="cls_010">this._hideParameters(configDef.parameterDefinitions);</span></div>
<div style="position:absolute;left:139.49px;top:414.77px" class="cls_010"><span class="cls_010">configDef.parameterDefinitions.splice(0, 0, {</span></div>
<div style="position:absolute;left:150.29px;top:425.57px" class="cls_010"><span class="cls_010">type : "arca:destination-dialog-button",</span></div>
<div style="position:absolute;left:150.29px;top:436.37px" class="cls_010"><span class="cls_010">displayLabel : this.msg("label.to"),</span></div>
<div style="position:absolute;left:150.29px;top:447.17px" class="cls_010"><span class="cls_010">_buttonLabel : this.msg("button.select-folder"),</span></div>
<div style="position:absolute;left:150.29px;top:457.97px" class="cls_010"><span class="cls_010">_destinationParam : "destination-folder"</span></div>
<div style="position:absolute;left:139.49px;top:468.77px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:139.49px;top:479.57px" class="cls_010"><span class="cls_010">return configDef;</span></div>
<div style="position:absolute;left:128.69px;top:490.37px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:501.17px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 133 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:100048px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background149.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">22. Now, we need to override Alfresco to specify with Javascript object should be</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">instantiated for the </span><span class="cls_007">Manage Rules</span><span class="cls_004"> screen. Create the directory</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">share|src|main|amp|web|WEB-INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:104.69px;top:108.34px" class="cls_004"><span class="cls_004">webscripts|org|alfresco|components|rules|config. Then, copy the file rule-</span></div>
<div style="position:absolute;left:104.69px;top:120.94px" class="cls_004"><span class="cls_004">config-action.get.config.xml from Alfresco share (located in </span><span class="cls_007">WEB-</span></div>
<div style="position:absolute;left:104.69px;top:133.58px" class="cls_007"><span class="cls_007">INF|classes|alfresco|site-webscripts|org|alfresco|rules|config</span><span class="cls_004">) in this</span></div>
<div style="position:absolute;left:104.69px;top:146.21px" class="cls_004"><span class="cls_004">directory. The first change that we need to do is to change the component that</span></div>
<div style="position:absolute;left:104.69px;top:158.81px" class="cls_004"><span class="cls_004">should be used:</span></div>
<div style="position:absolute;left:112.49px;top:182.02px" class="cls_010"><span class="cls_010">&lt;component&gt;SomeCo.RuleConfigActionCustom&lt;/component&gt;</span></div>
<div style="position:absolute;left:86.07px;top:202.63px" class="cls_004"><span class="cls_004">23. Then, we need to match the MoveReplaced customization object defined in</span></div>
<div style="position:absolute;left:104.69px;top:215.23px" class="cls_004"><span class="cls_004">Javascript, and the move-replaced action defined in Alfresco. Just add the</span></div>
<div style="position:absolute;left:104.69px;top:227.83px" class="cls_004"><span class="cls_004">following line in the customise tag:</span></div>
<div style="position:absolute;left:112.49px;top:251.05px" class="cls_010"><span class="cls_010">&lt;action name="move-replaced"&gt;MoveReplaced&lt;/action&gt;</span></div>
<div style="position:absolute;left:86.07px;top:271.65px" class="cls_004"><span class="cls_004">24. There is one last change to do in Alfresco Share. We need to be sure that our</span></div>
<div style="position:absolute;left:104.69px;top:284.25px" class="cls_004"><span class="cls_004">Javascript file will be properly loaded in the </span><span class="cls_007">Manage Rules</span><span class="cls_004"> screen. Copy the file</span></div>
<div style="position:absolute;left:104.69px;top:296.89px" class="cls_004"><span class="cls_004">rule-edit.get.html.ftland rule-details.get.html.ftlfrom Alfresco share in the</span></div>
<div style="position:absolute;left:104.69px;top:309.49px" class="cls_004"><span class="cls_004">directory share|src|main|amp|web|WEB-INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:104.69px;top:322.09px" class="cls_004"><span class="cls_004">webscripts|org|alfresco|components|rules. In each file, identify the markup tag</span></div>
<div style="position:absolute;left:104.69px;top:334.69px" class="cls_004"><span class="cls_004">with the idequals to jsand add the dependency as shown below:</span></div>
<div style="position:absolute;left:117.89px;top:357.90px" class="cls_010"><span class="cls_010">&lt;@markup id="js"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:368.70px" class="cls_010"><span class="cls_010">&lt;#-- JavaScript Dependencies --&gt;</span></div>
<div style="position:absolute;left:128.69px;top:379.50px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:117.89px;top:390.30px" class="cls_010"><span class="cls_010">&lt;@script src="${url.context}/res/js/someco</span></div>
<div style="position:absolute;left:117.89px;top:401.10px" class="cls_010"><span class="cls_010">/someco-action.js" group="rules"/&gt;</span></div>
<div style="position:absolute;left:144.89px;top:411.90px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:117.89px;top:422.70px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:86.07px;top:443.31px" class="cls_004"><span class="cls_004">25. Stop Alfresco.</span></div>
<div style="position:absolute;left:86.07px;top:458.07px" class="cls_004"><span class="cls_004">26. Package and move the modules to your virtual machine.</span></div>
<div style="position:absolute;left:86.07px;top:472.83px" class="cls_004"><span class="cls_004">27. Deploy and restart Tomcat. Note that from now on, when you call the</span></div>
<div style="position:absolute;left:104.69px;top:485.43px" class="cls_004"><span class="cls_004">apply_amps.sh script to install the AMP modules, you'll need to add the option </span><span class="cls_022">“</span><span class="cls_004">-</span></div>
<div style="position:absolute;left:104.69px;top:498.86px" class="cls_004"><span class="cls_004">force</span><span class="cls_022">”</span><span class="cls_004">. It's because we override some Alfresco configuration files.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 134 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:100724px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background150.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You have just created a new type, </span><span class="cls_013">sc:hrPolicy</span><span class="cls_004">, which has a mandatory </span><span class="cls_013">cm:replaces</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">aspect. That means that HR policies can point to other policies in the repository that they</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">will replace once approved. You can also now configure the custom Move Replaced action</span></div>
<div style="position:absolute;left:56.69px;top:108.98px" class="cls_004"><span class="cls_004">against a folder. When setting up the action, the web client will allow the user to specify a</span></div>
<div style="position:absolute;left:56.69px;top:121.58px" class="cls_004"><span class="cls_004">target folder for the replaced document.</span></div>
<div style="position:absolute;left:56.69px;top:143.18px" class="cls_004"><span class="cls_004">To set up a test, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:164.91px" class="cls_004"><span class="cls_004">1. Log in to Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:179.67px" class="cls_004"><span class="cls_004">2. Create a new site called </span><span class="cls_007">Human Resources</span><span class="cls_004">. In the Document Library, create a</span></div>
<div style="position:absolute;left:104.69px;top:192.31px" class="cls_004"><span class="cls_004">folder called </span><span class="cls_007">Policies</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:207.11px" class="cls_004"><span class="cls_004">3. Within </span><span class="cls_007">Policies</span><span class="cls_004">, create folders for </span><span class="cls_007">Draft</span><span class="cls_004">, </span><span class="cls_007">Approved</span><span class="cls_004">, and </span><span class="cls_007">Archived</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 135 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:101400px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background151.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Create a rule on the Policies folder that specializes all documents to </span><span class="cls_007">Someco HR</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_007"><span class="cls_007">Policy</span><span class="cls_004"> and that should apply to subfolders.</span></div>
<div style="position:absolute;left:91.32px;top:355.36px" class="cls_004"><span class="cls_004">5. Upload a document in the </span><span class="cls_007">Approved</span><span class="cls_004"> folder that will represent an </span><span class="cls_007">existing</span></div>
<div style="position:absolute;left:104.69px;top:367.99px" class="cls_007"><span class="cls_007">policy</span><span class="cls_004">, and another document in the </span><span class="cls_007">Draft</span><span class="cls_004"> folder that will represent the new</span></div>
<div style="position:absolute;left:104.69px;top:380.63px" class="cls_004"><span class="cls_004">policy. Edit the </span><span class="cls_007">replaces</span><span class="cls_004"> property of the new policy to point to the </span><span class="cls_007">Existing</span></div>
<div style="position:absolute;left:104.69px;top:393.27px" class="cls_007"><span class="cls_007">Policy</span><span class="cls_004"> document.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 136 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:102076px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background152.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. Create an inbound rule in the </span><span class="cls_007">Approved</span><span class="cls_004"> folder that runs the </span><span class="cls_007">Move Replaced</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">action:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 137 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:102752px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background153.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Now move the </span><span class="cls_007">New Policy</span><span class="cls_004"> document into the </span><span class="cls_007">Approved</span><span class="cls_004"> folder. The action</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">should automatically trigger, moving the </span><span class="cls_007">Existing Policy</span><span class="cls_004"> into the </span><span class="cls_007">Archived</span></div>
<div style="position:absolute;left:104.69px;top:95.78px" class="cls_004"><span class="cls_004">folder:</span></div>
<div style="position:absolute;left:56.69px;top:341.80px" class="cls_014"><span class="cls_014">Specifying parameters when code executes an</span></div>
<div style="position:absolute;left:56.69px;top:363.40px" class="cls_014"><span class="cls_014">action</span></div>
<div style="position:absolute;left:56.69px;top:388.63px" class="cls_004"><span class="cls_004">In this example, the end user is specifying the destination folder when the action is</span></div>
<div style="position:absolute;left:56.69px;top:401.23px" class="cls_004"><span class="cls_004">configured through Alfresco Share. Parameters can also be specified when executing actions</span></div>
<div style="position:absolute;left:56.69px;top:413.83px" class="cls_004"><span class="cls_004">from Java and JavaScript. For example, here is a JavaScript snippet that invokes the</span></div>
<div style="position:absolute;left:56.69px;top:426.43px" class="cls_013"><span class="cls_013">addfeatures</span><span class="cls_004"> action to add an aspect. The </span><span class="cls_013">addfeatures</span><span class="cls_004"> action takes one parameter, which</span></div>
<div style="position:absolute;left:56.69px;top:439.71px" class="cls_004"><span class="cls_004">is the name of the aspect to add:</span></div>
<div style="position:absolute;left:74.69px;top:460.63px" class="cls_010"><span class="cls_010">var aspectName = "sc:clientRelated";</span></div>
<div style="position:absolute;left:74.69px;top:471.43px" class="cls_010"><span class="cls_010">var addAspectAction = actions.create("add-features");</span></div>
<div style="position:absolute;left:74.69px;top:482.23px" class="cls_010"><span class="cls_010">addAspectAction.parameters["aspect-name"] = aspectName;</span></div>
<div style="position:absolute;left:74.69px;top:493.03px" class="cls_010"><span class="cls_010">addAspectAction.execute(document);</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 138 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:103428px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background154.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Executing actions from code is very common, especially when you need to run an action</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">against a number of documents at once. Suppose SomeCo's HR department was already</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">using Alfresco and you are just coming up with this </span><span class="cls_022">“</span><span class="cls_004">Move Replaced</span><span class="cls_022">”</span><span class="cls_004"> idea. You would</span></div>
<div style="position:absolute;left:56.69px;top:109.13px" class="cls_004"><span class="cls_004">need to add the </span><span class="cls_013">cm:replaces</span><span class="cls_004"> aspect to all existing HR policies. You could write JavaScript</span></div>
<div style="position:absolute;left:56.69px;top:122.41px" class="cls_004"><span class="cls_004">similar to the snippet above that would execute the </span><span class="cls_013">addfeatures</span><span class="cls_004"> action against all of the</span></div>
<div style="position:absolute;left:56.69px;top:135.69px" class="cls_004"><span class="cls_004">results in a search query to save you the trouble of doing it manually for each existing</span></div>
<div style="position:absolute;left:56.69px;top:148.29px" class="cls_004"><span class="cls_004">document.</span></div>
<div style="position:absolute;left:56.69px;top:169.89px" class="cls_004"><span class="cls_004">Be aware that actions are usually executed synchronously. It means that they will be</span></div>
<div style="position:absolute;left:56.69px;top:182.49px" class="cls_004"><span class="cls_004">executed in the same transaction. But it's possible to execute an action asynchronously.</span></div>
<div style="position:absolute;left:56.69px;top:221.24px" class="cls_008"><span class="cls_008">Binding logic to custom types with</span></div>
<div style="position:absolute;left:56.69px;top:245.24px" class="cls_008"><span class="cls_008">behaviors</span></div>
<div style="position:absolute;left:56.69px;top:272.97px" class="cls_004"><span class="cls_004">So far, you've seen how to write code that works with custom content types, properties,</span></div>
<div style="position:absolute;left:56.69px;top:285.57px" class="cls_004"><span class="cls_004">aspects, and associations. But the code wasn't tightly coupled to the objects on which it</span></div>
<div style="position:absolute;left:56.69px;top:298.17px" class="cls_004"><span class="cls_004">operated. With an action, the business logic is triggered by something-an item in the user</span></div>
<div style="position:absolute;left:56.69px;top:310.77px" class="cls_004"><span class="cls_004">interface, a schedule, or a workflow-rather than being bound to the content type or aspect.</span></div>
<div style="position:absolute;left:56.69px;top:332.37px" class="cls_004"><span class="cls_004">As you know, a repository action is a piece of code that can be performed against a node.</span></div>
<div style="position:absolute;left:56.69px;top:344.97px" class="cls_004"><span class="cls_004">You don't have one good way of implementing your project. Some argue that the best place</span></div>
<div style="position:absolute;left:56.69px;top:357.57px" class="cls_004"><span class="cls_004">to develop your business logic is within repository actions. It's a good approach because it</span></div>
<div style="position:absolute;left:56.69px;top:370.17px" class="cls_004"><span class="cls_004">means that you can trigger your action using a rule, via a webscript, or via a Javascript</span></div>
<div style="position:absolute;left:56.69px;top:382.77px" class="cls_004"><span class="cls_004">code. I'll go a bit further and I'd say that a repository action should never contain business</span></div>
<div style="position:absolute;left:56.69px;top:395.37px" class="cls_004"><span class="cls_004">logic. All the business logic should be encapsulated in a Java service that is called by a</span></div>
<div style="position:absolute;left:56.69px;top:407.97px" class="cls_004"><span class="cls_004">repository action, or a webscript. It allows to share and re-use your business logic in your</span></div>
<div style="position:absolute;left:56.69px;top:420.57px" class="cls_004"><span class="cls_004">project. In this case, the Java service needs to do some check before executing any code like</span></div>
<div style="position:absolute;left:56.69px;top:433.17px" class="cls_004"><span class="cls_004">checking if the content type of the node is the right one.</span></div>
<div style="position:absolute;left:56.69px;top:454.77px" class="cls_004"><span class="cls_004">But there are times when you want code to be tightly coupled to a content type because you</span></div>
<div style="position:absolute;left:56.69px;top:467.37px" class="cls_004"><span class="cls_004">need to be sure it gets executed, rather than leaving it up to a rule on a folder that triggers</span></div>
<div style="position:absolute;left:56.69px;top:479.97px" class="cls_004"><span class="cls_004">an action or a workflow that does the same. Fortunately, Alfresco provides just such a</span></div>
<div style="position:absolute;left:56.69px;top:492.57px" class="cls_004"><span class="cls_004">mechanism; it's called </span><span class="cls_007">behaviors</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 139 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:104104px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background155.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - writing a simple behavior in Java</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Suppose you want to execute some code every time something happens to a particular type</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">of node. You could write a rule action to do this and then configure a folder to execute the</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">action. But what if the content you want to hook this code to is scattered across the</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">repository? What you need is a behavior. Let us create a simple behavior that binds itself to</span></div>
<div style="position:absolute;left:56.69px;top:145.38px" class="cls_004"><span class="cls_004">a few different policies so you can see when a behavior is triggered based on what's</span></div>
<div style="position:absolute;left:56.69px;top:157.98px" class="cls_004"><span class="cls_004">happening to the content. To create this simple behavior, you'll need:</span></div>
<div style="position:absolute;left:104.69px;top:179.71px" class="cls_004"><span class="cls_004">A Java class to implement the behavior</span></div>
<div style="position:absolute;left:104.69px;top:194.47px" class="cls_004"><span class="cls_004">A Spring bean configuration file to configure the behavior</span></div>
<div style="position:absolute;left:104.69px;top:209.23px" class="cls_004"><span class="cls_004">A type to bind the behavior to</span></div>
<div style="position:absolute;left:104.69px;top:223.99px" class="cls_004"><span class="cls_004">A modified </span><span class="cls_013">log4j.properties</span><span class="cls_004"> file to see debug messages</span></div>
<div style="position:absolute;left:56.69px;top:248.56px" class="cls_004"><span class="cls_004">By the end of these steps, you'll be able to see the policies that get fired when you create,</span></div>
<div style="position:absolute;left:56.69px;top:261.16px" class="cls_004"><span class="cls_004">read, update, and delete content.</span></div>
<div style="position:absolute;left:56.69px;top:282.76px" class="cls_004"><span class="cls_004">To create the policy logger behavior, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:304.49px" class="cls_004"><span class="cls_004">1. Create a new Java class in </span><span class="cls_007">repo|src|main|java</span><span class="cls_004"> called</span></div>
<div style="position:absolute;left:104.69px;top:317.13px" class="cls_013"><span class="cls_013">com.someco.repo.behavior.PolicyLogger</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:332.57px" class="cls_004"><span class="cls_004">2. You're going to bind your behavior to the </span><span class="cls_013">OnCreateNode</span><span class="cls_004">, </span><span class="cls_013">OnContentRead,</span></div>
<div style="position:absolute;left:104.69px;top:345.85px" class="cls_013"><span class="cls_013">OnContentUpdate</span><span class="cls_004">, </span><span class="cls_013">OnUpdateNode</span><span class="cls_004">, and </span><span class="cls_013">OnDeleteNode </span><span class="cls_004">event policies. So the</span></div>
<div style="position:absolute;left:104.69px;top:359.13px" class="cls_004"><span class="cls_004">class needs to implement the appropriate interfaces as follows:</span></div>
<div style="position:absolute;left:117.89px;top:382.34px" class="cls_010"><span class="cls_010">public class PolicyLogger</span></div>
<div style="position:absolute;left:123.29px;top:393.14px" class="cls_010"><span class="cls_010">implements ContentServicePolicies.OnContentUpdatePolicy,</span></div>
<div style="position:absolute;left:188.09px;top:403.94px" class="cls_010"><span class="cls_010">ContentServicePolicies.OnContentReadPolicy,</span></div>
<div style="position:absolute;left:188.09px;top:414.74px" class="cls_010"><span class="cls_010">NodeServicePolicies.OnCreateNodePolicy,</span></div>
<div style="position:absolute;left:188.09px;top:425.54px" class="cls_010"><span class="cls_010">NodeServicePolicies.OnUpdateNodePolicy,</span></div>
<div style="position:absolute;left:188.09px;top:436.34px" class="cls_010"><span class="cls_010">NodeServicePolicies.OnDeleteNodePolicy {</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 140 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:104780px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background156.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Next, set up some local variables. You'll need a logger to log messages when the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">policies are fired, Behavior objects (note the British spelling in the code), and a</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_013"><span class="cls_013">PolicyComponent</span><span class="cls_004"> bean:</span></div>
<div style="position:absolute;left:117.89px;top:119.59px" class="cls_010"><span class="cls_010">private Logger logger = Logger.getLogger(PolicyLogger.class);</span></div>
<div style="position:absolute;left:134.09px;top:130.39px" class="cls_010"><span class="cls_010">//  Behaviours</span></div>
<div style="position:absolute;left:139.49px;top:141.19px" class="cls_010"><span class="cls_010">private Behaviour onContentRead;</span></div>
<div style="position:absolute;left:139.49px;top:151.99px" class="cls_010"><span class="cls_010">private Behaviour onContentUpdate;</span></div>
<div style="position:absolute;left:139.49px;top:162.79px" class="cls_010"><span class="cls_010">private Behaviour onCreateNode;</span></div>
<div style="position:absolute;left:139.49px;top:173.59px" class="cls_010"><span class="cls_010">private Behaviour onUpdateNode;</span></div>
<div style="position:absolute;left:139.49px;top:184.39px" class="cls_010"><span class="cls_010">private Behaviour onDeleteNode;</span></div>
<div style="position:absolute;left:134.09px;top:195.19px" class="cls_010"><span class="cls_010">// Dependencies</span></div>
<div style="position:absolute;left:139.49px;top:205.99px" class="cls_010"><span class="cls_010">private PolicyComponent policyComponent;</span></div>
<div style="position:absolute;left:91.32px;top:226.60px" class="cls_004"><span class="cls_004">4. Create an </span><span class="cls_013">init</span><span class="cls_004"> method that creates the behaviors:</span></div>
<div style="position:absolute;left:117.89px;top:250.49px" class="cls_010"><span class="cls_010">public void init() {</span></div>
<div style="position:absolute;left:128.69px;top:261.29px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:272.09px" class="cls_010"><span class="cls_010">logger.debug("Initializing policy logger behaviour");</span></div>
<div style="position:absolute;left:128.69px;top:282.89px" class="cls_010"><span class="cls_010">// Create behaviours</span></div>
<div style="position:absolute;left:128.69px;top:293.69px" class="cls_010"><span class="cls_010">this.onContentRead = new JavaBehaviour(this,</span></div>
<div style="position:absolute;left:139.49px;top:304.49px" class="cls_010"><span class="cls_010">OnContentReadPolicy.QNAME.getLocalName(),</span></div>
<div style="position:absolute;left:139.49px;top:315.29px" class="cls_010"><span class="cls_010">NotificationFrequency.TRANSACTION_COMMIT);</span></div>
<div style="position:absolute;left:128.69px;top:326.09px" class="cls_010"><span class="cls_010">this.onContentUpdate = new JavaBehaviour(this,</span></div>
<div style="position:absolute;left:139.49px;top:336.89px" class="cls_010"><span class="cls_010">OnContentUpdatePolicy.QNAME.getLocalName(),</span></div>
<div style="position:absolute;left:139.49px;top:347.69px" class="cls_010"><span class="cls_010">NotificationFrequency.TRANSACTION_COMMIT);</span></div>
<div style="position:absolute;left:128.69px;top:358.49px" class="cls_010"><span class="cls_010">this.onCreateNode = new JavaBehaviour(this,</span></div>
<div style="position:absolute;left:139.49px;top:369.29px" class="cls_010"><span class="cls_010">OnCreateNodePolicy.QNAME.getLocalName(),</span></div>
<div style="position:absolute;left:139.49px;top:380.09px" class="cls_010"><span class="cls_010">NotificationFrequency.TRANSACTION_COMMIT);</span></div>
<div style="position:absolute;left:128.69px;top:390.89px" class="cls_010"><span class="cls_010">this.onUpdateNode = new JavaBehaviour(this,</span></div>
<div style="position:absolute;left:139.49px;top:401.69px" class="cls_010"><span class="cls_010">OnUpdateNodePolicy.QNAME.getLocalName(),</span></div>
<div style="position:absolute;left:139.49px;top:412.49px" class="cls_010"><span class="cls_010">NotificationFrequency.TRANSACTION_COMMIT);</span></div>
<div style="position:absolute;left:128.69px;top:423.29px" class="cls_010"><span class="cls_010">this.onDeleteNode = new JavaBehaviour(this,</span></div>
<div style="position:absolute;left:139.49px;top:434.09px" class="cls_010"><span class="cls_010">OnDeleteNodePolicy.QNAME.getLocalName(),</span></div>
<div style="position:absolute;left:139.49px;top:444.89px" class="cls_010"><span class="cls_010">NotificationFrequency.TRANSACTION_COMMIT);</span></div>
<div style="position:absolute;left:117.89px;top:455.69px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:476.30px" class="cls_004"><span class="cls_004">5. Then, bind the behaviors to Alfresco's policies for the SomeCo HR Policy type (it</span></div>
<div style="position:absolute;left:104.69px;top:488.90px" class="cls_004"><span class="cls_004">could be any type, but use this one for this example) by adding the following</span></div>
<div style="position:absolute;left:104.69px;top:501.50px" class="cls_004"><span class="cls_004">code to the </span><span class="cls_013">init</span><span class="cls_004"> method:</span></div>
<div style="position:absolute;left:117.89px;top:525.39px" class="cls_010"><span class="cls_010">// Bind behaviours to node policies</span></div>
<div style="position:absolute;left:117.89px;top:536.19px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:128.69px;top:546.99px" class="cls_010"><span class="cls_010">OnContentReadPolicy.QNAME,</span></div>
<div style="position:absolute;left:128.69px;top:557.79px" class="cls_010"><span class="cls_010">SomeCoModel.TYPE_HRPOLICY,</span></div>
<div style="position:absolute;left:128.69px;top:568.59px" class="cls_010"><span class="cls_010">this.onContentRead);</span></div>
<div style="position:absolute;left:117.89px;top:579.39px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 141 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:105456px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background157.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:128.69px;top:69.82px" class="cls_010"><span class="cls_010">OnContentUpdatePolicy.QNAME,</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">SomeCoModel.TYPE_HRPOLICY,</span></div>
<div style="position:absolute;left:128.69px;top:91.42px" class="cls_010"><span class="cls_010">this.onContentUpdate);</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:128.69px;top:113.02px" class="cls_010"><span class="cls_010">OnCreateNodePolicy.QNAME,</span></div>
<div style="position:absolute;left:128.69px;top:123.82px" class="cls_010"><span class="cls_010">SomeCoModel.TYPE_HRPOLICY,</span></div>
<div style="position:absolute;left:128.69px;top:134.62px" class="cls_010"><span class="cls_010">this.onCreateNode);</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:128.69px;top:156.22px" class="cls_010"><span class="cls_010">OnUpdateNodePolicy.QNAME,</span></div>
<div style="position:absolute;left:128.69px;top:167.02px" class="cls_010"><span class="cls_010">SomeCoModel.TYPE_HRPOLICY,</span></div>
<div style="position:absolute;left:128.69px;top:177.82px" class="cls_010"><span class="cls_010">this.onUpdateNode);</span></div>
<div style="position:absolute;left:117.89px;top:188.62px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:128.69px;top:199.42px" class="cls_010"><span class="cls_010">OnDeleteNodePolicy.QNAME,</span></div>
<div style="position:absolute;left:128.69px;top:210.22px" class="cls_010"><span class="cls_010">SomeCoModel.TYPE_HRPOLICY,</span></div>
<div style="position:absolute;left:128.69px;top:221.02px" class="cls_010"><span class="cls_010">this.onDeleteNode);</span></div>
<div style="position:absolute;left:91.32px;top:241.63px" class="cls_004"><span class="cls_004">6.</span></div>
<div style="position:absolute;left:104.69px;top:241.63px" class="cls_004"><span class="cls_004">Now implement the behaviors. In this case, you're just going to log a message:</span></div>
<div style="position:absolute;left:117.89px;top:264.84px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:275.64px" class="cls_010"><span class="cls_010">public void onContentUpdate(NodeRef nodeRef, boolean flag) {</span></div>
<div style="position:absolute;left:128.69px;top:286.44px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:297.24px" class="cls_010"><span class="cls_010">logger.debug("Content update policy fired");</span></div>
<div style="position:absolute;left:117.89px;top:308.04px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:318.84px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:329.64px" class="cls_010"><span class="cls_010">public void onContentRead(NodeRef nodeRef) {</span></div>
<div style="position:absolute;left:128.69px;top:340.44px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:351.24px" class="cls_010"><span class="cls_010">logger.debug("Content read policy fired");</span></div>
<div style="position:absolute;left:117.89px;top:362.04px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:372.84px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:383.64px" class="cls_010"><span class="cls_010">public void onUpdateNode(NodeRef nodeRef) {</span></div>
<div style="position:absolute;left:128.69px;top:394.44px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:405.24px" class="cls_010"><span class="cls_010">logger.debug("Node update policy fired");</span></div>
<div style="position:absolute;left:117.89px;top:416.04px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:426.84px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:437.64px" class="cls_010"><span class="cls_010">public void onCreateNode(ChildAssociationRef childAssocRef) {</span></div>
<div style="position:absolute;left:128.69px;top:448.44px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:459.24px" class="cls_010"><span class="cls_010">logger.debug("Node create policy fired");</span></div>
<div style="position:absolute;left:117.89px;top:470.04px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:480.84px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:491.64px" class="cls_010"><span class="cls_010">public void onDeleteNode(ChildAssociationRef childAssocRef,</span></div>
<div style="position:absolute;left:123.29px;top:502.44px" class="cls_010"><span class="cls_010">boolean isNodeArchived) {</span></div>
<div style="position:absolute;left:128.69px;top:513.24px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:524.04px" class="cls_010"><span class="cls_010">logger.debug("Node delete policy fired");</span></div>
<div style="position:absolute;left:117.89px;top:534.84px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 142 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:106132px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background158.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Create a setter method for the </span><span class="cls_013">PolicyComponent</span><span class="cls_004"> dependency and add all import</span></div>
<div style="position:absolute;left:104.69px;top:83.79px" class="cls_004"><span class="cls_004">statements (a quick way to do that? </span><span class="cls_012">Ctrl</span><span class="cls_004"> + </span><span class="cls_012">Shift</span><span class="cls_004"> + </span><span class="cls_012">O</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:117.89px;top:107.00px" class="cls_010"><span class="cls_010">public void setPolicyComponent(</span></div>
<div style="position:absolute;left:139.49px;top:117.80px" class="cls_010"><span class="cls_010">PolicyComponent policyComponent) {</span></div>
<div style="position:absolute;left:150.29px;top:128.60px" class="cls_010"><span class="cls_010">this.policyComponent = policyComponent;</span></div>
<div style="position:absolute;left:117.89px;top:139.40px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:160.01px" class="cls_004"><span class="cls_004">8. That's all for the Java class. Create a new Spring bean configuration file in</span></div>
<div style="position:absolute;left:104.69px;top:172.61px" class="cls_007"><span class="cls_007">repo|src|main|amp|config|alfresco|module|repo|context</span><span class="cls_004"> called </span><span class="cls_013">behavior-</span></div>
<div style="position:absolute;left:104.69px;top:185.89px" class="cls_013"><span class="cls_013">context.xml</span><span class="cls_004">. Add the following to register the new bean:</span></div>
<div style="position:absolute;left:117.89px;top:209.78px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:220.58px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN'</span></div>
<div style="position:absolute;left:117.89px;top:231.38px" class="cls_010"><span class="cls_010">'</span><a href="http://www.springframework.org/dtd/spring-beans.dtd&#39;/">http://www.springframework.org/dtd/spring-beans.dtd'</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:242.18px" class="cls_010"><span class="cls_010">&lt;beans&gt;</span></div>
<div style="position:absolute;left:139.49px;top:252.98px" class="cls_010"><span class="cls_010">&lt;bean id="policyLogger"</span></div>
<div style="position:absolute;left:139.49px;top:263.78px" class="cls_010"><span class="cls_010">class="com.someco.repo.behavior.PolicyLogger"</span></div>
<div style="position:absolute;left:139.49px;top:274.58px" class="cls_010"><span class="cls_010">init-method="init"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:285.38px" class="cls_010"><span class="cls_010">&lt;property name="policyComponent"</span></div>
<div style="position:absolute;left:171.89px;top:296.18px" class="cls_010"><span class="cls_010">ref="policyComponent" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:306.98px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:317.78px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:91.32px;top:338.39px" class="cls_004"><span class="cls_004">9. Update your </span><span class="cls_013">module-context.xml</span><span class="cls_004"> by adding:</span></div>
<div style="position:absolute;left:117.89px;top:362.28px" class="cls_010"><span class="cls_010">&lt;import resource="classpath:alfresco</span></div>
<div style="position:absolute;left:117.89px;top:373.08px" class="cls_010"><span class="cls_010">/module/${project.artifactId}/context</span></div>
<div style="position:absolute;left:117.89px;top:383.88px" class="cls_010"><span class="cls_010">/behavior-context.xml" /&gt;</span></div>
<div style="position:absolute;left:86.07px;top:415.29px" class="cls_004"><span class="cls_004">10. Confirm that your </span><span class="cls_013">log4j.properties</span><span class="cls_004"> file (located in</span></div>
<div style="position:absolute;left:104.69px;top:428.57px" class="cls_007"><span class="cls_007">repo|src|main|amp|config|alfresco|module|repo</span><span class="cls_004">) has:</span></div>
<div style="position:absolute;left:117.89px;top:451.81px" class="cls_010"><span class="cls_010">log4j.logger.com.someco=DEBUG</span></div>
<div style="position:absolute;left:86.07px;top:472.42px" class="cls_004"><span class="cls_004">11. Now deploy, restart, and test. When the server starts up, you should see:</span></div>
<div style="position:absolute;left:117.89px;top:495.63px" class="cls_010"><span class="cls_010">DEBUG [repo.behavior.PolicyLogger]</span></div>
<div style="position:absolute;left:117.89px;top:506.43px" class="cls_010"><span class="cls_010">[localhost-startStop-1] Initializing policy logger behaviour</span></div>
<div style="position:absolute;left:56.69px;top:526.91px" class="cls_004"><span class="cls_004">Notice that you've bound the behavior to the HR Policy type. That means the behavior code</span></div>
<div style="position:absolute;left:56.69px;top:539.51px" class="cls_004"><span class="cls_004">will get executed any time Alfresco takes an action against an instance of the type that</span></div>
<div style="position:absolute;left:56.69px;top:552.11px" class="cls_004"><span class="cls_004">matches one of the policies you've bound to. To see this in action, log in to Alfresco and</span></div>
<div style="position:absolute;left:56.69px;top:564.71px" class="cls_004"><span class="cls_004">create, update, and delete a couple of HR Policies. Watch the Tomcat log as you do so.</span></div>
<div style="position:absolute;left:56.69px;top:577.31px" class="cls_004"><span class="cls_004">You'll see that those policies get fired multiple times during a typical transaction.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 143 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:106808px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background159.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Binding to multiple types/aspects</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">In this example, we bound only to the HR Policy type. But there is nothing specific to any</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">particular type in the class you just wrote. If you had behavior logic that was common to</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">multiple content types or aspects, you could bind them to this behavior as well. For</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">example, add the following to the </span><span class="cls_013">init</span><span class="cls_004"> method:</span></div>
<div style="position:absolute;left:74.69px;top:154.38px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:85.49px;top:165.18px" class="cls_010"><span class="cls_010">OnContentReadPolicy.QNAME,</span></div>
<div style="position:absolute;left:85.49px;top:175.98px" class="cls_010"><span class="cls_010">SomeCoModel.ASPECT_CLIENTRELATED,</span></div>
<div style="position:absolute;left:85.49px;top:186.78px" class="cls_010"><span class="cls_010">this.onContentRead);</span></div>
<div style="position:absolute;left:56.69px;top:207.26px" class="cls_004"><span class="cls_004">Now in addition to Operations Document instances, the </span><span class="cls_013">onContentRead</span><span class="cls_004"> behavior code</span></div>
<div style="position:absolute;left:56.69px;top:220.54px" class="cls_004"><span class="cls_004">will fire when reading any content of any type that has SomeCo's client-related aspect.</span></div>
<div style="position:absolute;left:56.69px;top:242.14px" class="cls_004"><span class="cls_004">As a best practice, you should only do this when the behavior is truly common. If you had</span></div>
<div style="position:absolute;left:56.69px;top:254.74px" class="cls_004"><span class="cls_004">behavior unique to Operations Documents and the client-related aspect, those should be</span></div>
<div style="position:absolute;left:56.69px;top:267.34px" class="cls_004"><span class="cls_004">broken into two different classes.</span></div>
<div style="position:absolute;left:56.69px;top:304.04px" class="cls_014"><span class="cls_014">Frequency</span></div>
<div style="position:absolute;left:56.69px;top:329.26px" class="cls_004"><span class="cls_004">Notice that the constructor included a frequency argument. This declares how often your</span></div>
<div style="position:absolute;left:56.69px;top:341.86px" class="cls_004"><span class="cls_004">behavior should be triggered. In the </span><span class="cls_013">PolicyLogger</span><span class="cls_004"> example, you specified</span></div>
<div style="position:absolute;left:56.69px;top:355.14px" class="cls_007"><span class="cls_007">TRANSACTION_COMMIT</span><span class="cls_004">. The other two choices are </span><span class="cls_007">FIRST_EVENT</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:56.69px;top:367.78px" class="cls_007"><span class="cls_007">EVERY_EVENT</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:404.51px" class="cls_014"><span class="cls_014">Figuring out to which policies to bind</span></div>
<div style="position:absolute;left:56.69px;top:429.74px" class="cls_004"><span class="cls_004">There are many out of the box policies to which your behavior can be bound. To find out</span></div>
<div style="position:absolute;left:56.69px;top:442.34px" class="cls_004"><span class="cls_004">what's available, you need to look only as far as the Javadoc. The latest Javadoc is always</span></div>
<div style="position:absolute;left:56.69px;top:454.94px" class="cls_004"><span class="cls_004">available at</span></div>
<div style="position:absolute;left:56.69px;top:467.54px" class="cls_013"><span class="cls_013">http://dev.alfresco.com/resource/docs/java/overview-summary.html</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 144 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:107484px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background160.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To make it easier to read the table, the inner interface that follows the pattern of </span><span class="cls_013">&lt;method-</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_013"><span class="cls_013">name&gt;Policy</span><span class="cls_004"> is omitted. For example, the </span><span class="cls_013">onContentUpdate</span><span class="cls_004"> method is a method of the</span></div>
<div style="position:absolute;left:56.69px;top:97.06px" class="cls_004"><span class="cls_004">inner interface </span><span class="cls_013">OnContentUpdatePolicy</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:60.32px;top:122.95px" class="cls_024"><span class="cls_024">Interface</span></div>
<div style="position:absolute;left:341.98px;top:122.95px" class="cls_024"><span class="cls_024">Method</span></div>
<div style="position:absolute;left:60.32px;top:141.48px" class="cls_004"><span class="cls_004">org.alfresco.repo.content.ContentServicePolicies</span></div>
<div style="position:absolute;left:341.98px;top:141.48px" class="cls_004"><span class="cls_004">onContentUpdate</span></div>
<div style="position:absolute;left:60.32px;top:153.40px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/content/ContentServicePolicies.html">http://dev.alfresco.com/resource/docs/java/org/al</a> </div>
<div style="position:absolute;left:341.98px;top:154.08px" class="cls_004"><span class="cls_004">onContentRead</span></div>
<div style="position:absolute;left:60.32px;top:164.20px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/content/ContentServicePolicies.html">fresco/repo/content/ContentServicePolicies.htm</a>l</div>
<div style="position:absolute;left:341.98px;top:166.68px" class="cls_004"><span class="cls_004">OnContentPropertyUpdate</span></div>
<div style="position:absolute;left:60.32px;top:185.79px" class="cls_004"><span class="cls_004">org.alfresco.repo.copy.CopyServicePolicies</span></div>
<div style="position:absolute;left:341.98px;top:185.79px" class="cls_004"><span class="cls_004">onCopyNode</span></div>
<div style="position:absolute;left:60.32px;top:197.71px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/copy/CopyServicePolicies.html">http://dev.alfresco.com/resource/docs/java/org/al</a> </div>
<div style="position:absolute;left:341.98px;top:198.39px" class="cls_004"><span class="cls_004">onCopyComplete</span></div>
<div style="position:absolute;left:60.32px;top:208.51px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/copy/CopyServicePolicies.html">fresco/repo/copy/CopyServicePolicies.html</a> </div>
<div style="position:absolute;left:341.98px;top:210.99px" class="cls_004"><span class="cls_004">beforeCopyPolicy</span></div>
<div style="position:absolute;left:60.32px;top:242.70px" class="cls_004"><span class="cls_004">org.alfresco.repo.node.NodeServicePolicies</span></div>
<div style="position:absolute;left:341.98px;top:242.70px" class="cls_004"><span class="cls_004">beforeCreateStore</span></div>
<div style="position:absolute;left:60.32px;top:254.62px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/node/NodeServicePolicies.html">http://dev.alfresco.com/resource/docs/java/org/al</a> </div>
<div style="position:absolute;left:341.98px;top:255.30px" class="cls_004"><span class="cls_004">onCreateStore</span></div>
<div style="position:absolute;left:60.32px;top:265.42px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/node/NodeServicePolicies.html">fresco/repo/node/NodeServicePolicies.htm</a>l</div>
<div style="position:absolute;left:341.98px;top:267.90px" class="cls_004"><span class="cls_004">beforeCreateNode</span></div>
<div style="position:absolute;left:341.98px;top:280.50px" class="cls_004"><span class="cls_004">onCreateNode</span></div>
<div style="position:absolute;left:341.98px;top:293.10px" class="cls_004"><span class="cls_004">onMoveNode</span></div>
<div style="position:absolute;left:341.98px;top:305.70px" class="cls_004"><span class="cls_004">beforeUpdateNode</span></div>
<div style="position:absolute;left:341.98px;top:318.30px" class="cls_004"><span class="cls_004">onUpdateNode</span></div>
<div style="position:absolute;left:341.98px;top:330.90px" class="cls_004"><span class="cls_004">onUpdateProperties</span></div>
<div style="position:absolute;left:341.98px;top:343.50px" class="cls_004"><span class="cls_004">beforeDeleteNode</span></div>
<div style="position:absolute;left:341.98px;top:356.10px" class="cls_004"><span class="cls_004">onDeleteNode</span></div>
<div style="position:absolute;left:341.98px;top:368.70px" class="cls_004"><span class="cls_004">beforeAddAspect</span></div>
<div style="position:absolute;left:341.98px;top:381.30px" class="cls_004"><span class="cls_004">onAddAspect</span></div>
<div style="position:absolute;left:341.98px;top:393.90px" class="cls_004"><span class="cls_004">beforeRemoveAspect</span></div>
<div style="position:absolute;left:341.98px;top:406.50px" class="cls_004"><span class="cls_004">onRemoveAspect</span></div>
<div style="position:absolute;left:341.98px;top:419.10px" class="cls_004"><span class="cls_004">onCreateAssociation</span></div>
<div style="position:absolute;left:341.98px;top:431.70px" class="cls_004"><span class="cls_004">beforeDeleteAssociation</span></div>
<div style="position:absolute;left:341.98px;top:444.30px" class="cls_004"><span class="cls_004">onDeleteAssociation</span></div>
<div style="position:absolute;left:341.98px;top:456.90px" class="cls_004"><span class="cls_004">onCreateChildAssociation</span></div>
<div style="position:absolute;left:341.98px;top:469.50px" class="cls_004"><span class="cls_004">beforeDeleteChildAssociation</span></div>
<div style="position:absolute;left:341.98px;top:482.10px" class="cls_004"><span class="cls_004">onDeleteChildAssociation</span></div>
<div style="position:absolute;left:341.98px;top:494.70px" class="cls_004"><span class="cls_004">beforeArchiveNode</span></div>
<div style="position:absolute;left:341.98px;top:507.30px" class="cls_004"><span class="cls_004">beforeMoveNode</span></div>
<div style="position:absolute;left:341.98px;top:519.90px" class="cls_004"><span class="cls_004">beforeSetNodeType</span></div>
<div style="position:absolute;left:341.98px;top:532.50px" class="cls_004"><span class="cls_004">onSetNodeType</span></div>
<div style="position:absolute;left:341.98px;top:545.10px" class="cls_004"><span class="cls_004">onRestoreNode</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 145 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:108160px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background161.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:60.32px;top:74.13px" class="cls_004"><span class="cls_004">org.alfresco.repo.version.VersionServicePolicies</span></div>
<div style="position:absolute;left:341.98px;top:74.13px" class="cls_004"><span class="cls_004">beforeCreateVersion</span></div>
<div style="position:absolute;left:60.32px;top:86.05px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/version/VersionServicePolicies.html">http://dev.alfresco.com/resource/docs/java/org/al</a> </div>
<div style="position:absolute;left:341.98px;top:86.73px" class="cls_004"><span class="cls_004">afterCreateVersion</span></div>
<div style="position:absolute;left:60.32px;top:96.85px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/version/VersionServicePolicies.html">fresco/repo/version/VersionServicePolicies.htm</a>l</div>
<div style="position:absolute;left:341.98px;top:99.33px" class="cls_004"><span class="cls_004">onCreateVersion</span></div>
<div style="position:absolute;left:341.98px;top:111.93px" class="cls_004"><span class="cls_004">calculateVersionLabel</span></div>
<div style="position:absolute;left:341.98px;top:124.53px" class="cls_004"><span class="cls_004">afterVersionRevert</span></div>
<div style="position:absolute;left:341.98px;top:137.13px" class="cls_004"><span class="cls_004">onRevertVersion</span></div>
<div style="position:absolute;left:60.32px;top:156.24px" class="cls_004"><span class="cls_004">org.alfresco.repo.coci.CheckOutCheckInServicePolicies</span></div>
<div style="position:absolute;left:341.98px;top:156.24px" class="cls_004"><span class="cls_004">beforeCancelCheckOut</span></div>
<div style="position:absolute;left:60.32px;top:168.16px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/coci/CheckOutCheckInServicePolicies.html">http://dev.alfresco.com/resource/docs/java/org/al</a> </div>
<div style="position:absolute;left:341.98px;top:168.84px" class="cls_004"><span class="cls_004">onCancelCheckOut</span></div>
<div style="position:absolute;left:60.32px;top:178.96px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/coci/CheckOutCheckInServicePolicies.html">fresco/repo/coci/CheckOutCheckInServicePolicies.h</a> </div>
<div style="position:absolute;left:341.98px;top:181.44px" class="cls_004"><span class="cls_004">beforeCheckIn</span></div>
<div style="position:absolute;left:60.32px;top:189.76px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/coci/CheckOutCheckInServicePolicies.html">tml</a> </div>
<div style="position:absolute;left:341.98px;top:194.04px" class="cls_004"><span class="cls_004">onCheckIn</span></div>
<div style="position:absolute;left:341.98px;top:206.64px" class="cls_004"><span class="cls_004">beforeCheckOut</span></div>
<div style="position:absolute;left:341.98px;top:219.24px" class="cls_004"><span class="cls_004">onCheckOut</span></div>
<div style="position:absolute;left:122.09px;top:244.47px" class="cls_004"><span class="cls_004">Note that there are some other less common available policies in Alfresco.</span></div>
<div style="position:absolute;left:122.09px;top:257.07px" class="cls_004"><span class="cls_004">Use the Javadoc if you are interested by all policies</span></div>
<div style="position:absolute;left:122.09px;top:269.67px" class="cls_004"><span class="cls_004">(</span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/policy/ClassPolicy.html">http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/po</a> </div>
<div style="position:absolute;left:122.09px;top:282.65px" class="cls_010"><span class="cls_010"> </span><a href="http://dev.alfresco.com/resource/docs/java/org/alfresco/repo/policy/ClassPolicy.html">licy/ClassPolicy.html</a> <span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:319.73px" class="cls_014"><span class="cls_014">Step-by-step - writing a simple behavior in</span></div>
<div style="position:absolute;left:56.69px;top:341.33px" class="cls_014"><span class="cls_014">JavaScript</span></div>
<div style="position:absolute;left:56.69px;top:366.55px" class="cls_004"><span class="cls_004">You've seen how to implement a simple behavior in Java. But what if you wanted to</span></div>
<div style="position:absolute;left:56.69px;top:379.15px" class="cls_004"><span class="cls_004">implement the behavior using JavaScript instead? Behaviors can be implemented in</span></div>
<div style="position:absolute;left:56.69px;top:391.75px" class="cls_004"><span class="cls_004">JavaScript and bound to policies through Spring. Let's create an additional behavior using</span></div>
<div style="position:absolute;left:56.69px;top:404.35px" class="cls_004"><span class="cls_004">JavaScript; and we'll bind to the same content type.</span></div>
<div style="position:absolute;left:56.69px;top:425.95px" class="cls_004"><span class="cls_004">The ingredients are the same as in the Java example, except that we'll be creating a</span></div>
<div style="position:absolute;left:56.69px;top:438.55px" class="cls_004"><span class="cls_004">JavaScript file instead of a Java class. This involves:</span></div>
<div style="position:absolute;left:91.32px;top:460.28px" class="cls_004"><span class="cls_004">1. Creating a server-side JavaScript file that implements the behavior.</span></div>
<div style="position:absolute;left:91.32px;top:475.04px" class="cls_004"><span class="cls_004">2. Creating a Spring bean to bind the JavaScript-based behavior to the appropriate</span></div>
<div style="position:absolute;left:104.69px;top:487.64px" class="cls_004"><span class="cls_004">policies.</span></div>
<div style="position:absolute;left:91.32px;top:502.40px" class="cls_004"><span class="cls_004">3. Modifying </span><span class="cls_013">log4j.properties</span><span class="cls_004"> to set the server-side JavaScript log level to</span></div>
<div style="position:absolute;left:104.69px;top:515.68px" class="cls_004"><span class="cls_004">DEBUG.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 146 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:108836px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background162.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To create a JavaScript version of the </span><span class="cls_013">PolicyLogger</span><span class="cls_004">, do the following:</span></div>
<div style="position:absolute;left:91.32px;top:92.91px" class="cls_004"><span class="cls_004">1. In your Eclipse project, create a </span><span class="cls_013">scripts</span><span class="cls_004"> directory under the </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span></div>
<div style="position:absolute;left:104.69px;top:106.19px" class="cls_013"><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">extension</span><span class="cls_004"> folder, and add a file called</span></div>
<div style="position:absolute;left:104.69px;top:119.47px" class="cls_013"><span class="cls_013">onUpdateNode.js</span><span class="cls_004"> with the following content:</span></div>
<div style="position:absolute;left:117.89px;top:143.36px" class="cls_010"><span class="cls_010">var scriptFailed = false;</span></div>
<div style="position:absolute;left:117.89px;top:154.16px" class="cls_010"><span class="cls_010">// Check the arguments</span></div>
<div style="position:absolute;left:117.89px;top:164.96px" class="cls_010"><span class="cls_010">if (behaviour.args == null) {</span></div>
<div style="position:absolute;left:128.69px;top:175.76px" class="cls_010"><span class="cls_010">logger.log("The args have not been set.");</span></div>
<div style="position:absolute;left:128.69px;top:186.56px" class="cls_010"><span class="cls_010">scriptFailed = true;</span></div>
<div style="position:absolute;left:117.89px;top:197.36px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:128.69px;top:208.16px" class="cls_010"><span class="cls_010">if (behaviour.args.length == 1) {</span></div>
<div style="position:absolute;left:139.49px;top:218.96px" class="cls_010"><span class="cls_010">var actedOnNode = behaviour.args[0];</span></div>
<div style="position:absolute;left:139.49px;top:229.76px" class="cls_010"><span class="cls_010">logger.log("You just updated:" + actedOnNode.name);</span></div>
<div style="position:absolute;left:128.69px;top:240.56px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:139.49px;top:251.36px" class="cls_010"><span class="cls_010">logger.log("The number of arguments is incorrect.");</span></div>
<div style="position:absolute;left:139.49px;top:262.16px" class="cls_010"><span class="cls_010">scriptFailed = true;</span></div>
<div style="position:absolute;left:128.69px;top:272.96px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:283.76px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:304.37px" class="cls_004"><span class="cls_004">2. Edit the </span><span class="cls_013">behavior-context.xml</span><span class="cls_004"> file. Java behaviors bind themselves to</span></div>
<div style="position:absolute;left:104.69px;top:317.65px" class="cls_004"><span class="cls_004">policies. JavaScript behaviors, on the other hand, use the Spring bean</span></div>
<div style="position:absolute;left:104.69px;top:330.25px" class="cls_004"><span class="cls_004">configuration to bind to policies. Add the following bean to the file:</span></div>
<div style="position:absolute;left:117.89px;top:353.46px" class="cls_010"><span class="cls_010">&lt;bean id="onUpdateHrPolicy"</span></div>
<div style="position:absolute;left:128.69px;top:364.26px" class="cls_010"><span class="cls_010">class="org.alfresco.repo.policy</span></div>
<div style="position:absolute;left:128.69px;top:375.06px" class="cls_010"><span class="cls_010">.registration.ClassPolicyRegistration"</span></div>
<div style="position:absolute;left:128.69px;top:385.86px" class="cls_010"><span class="cls_010">parent="policyRegistration"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:407.46px" class="cls_010"><span class="cls_010">&lt;property name="policyName"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:418.26px" class="cls_010"><span class="cls_010">&lt;value&gt;{</span><a href="http://www.alfresco.org%7Donupdatenode%3C/value/">http://www.alfresco.org}onUpdateNode&lt;/value</a>&gt;</div>
<div style="position:absolute;left:139.49px;top:429.06px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:439.86px" class="cls_010"><span class="cls_010">&lt;property name="className"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:450.66px" class="cls_010"><span class="cls_010">&lt;value&gt;{</span><a href="http://www.someco.com/model/">http://www.someco.com/model</a> </div>
<div style="position:absolute;left:161.09px;top:461.46px" class="cls_010"><span class="cls_010">/content/1.0}hrPolicy&lt;/value&gt;</span></div>
<div style="position:absolute;left:139.49px;top:472.26px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:483.06px" class="cls_010"><span class="cls_010">&lt;property name="behaviour"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:493.86px" class="cls_010"><span class="cls_010">&lt;bean class="org.alfresco.repo.jscript</span></div>
<div style="position:absolute;left:161.09px;top:504.66px" class="cls_010"><span class="cls_010">.ScriptBehaviour" parent="scriptBehaviour"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:515.46px" class="cls_010"><span class="cls_010">&lt;property name="location"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:526.26px" class="cls_010"><span class="cls_010">&lt;bean class="org.alfresco.repo</span></div>
<div style="position:absolute;left:182.69px;top:537.06px" class="cls_010"><span class="cls_010">.jscript.ClasspathScriptLocation"&gt;</span></div>
<div style="position:absolute;left:193.49px;top:558.66px" class="cls_010"><span class="cls_010">&lt;constructor-arg&gt;</span></div>
<div style="position:absolute;left:204.29px;top:569.46px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco/extension</span></div>
<div style="position:absolute;left:204.29px;top:580.26px" class="cls_010"><span class="cls_010">/scripts/onUpdateNode.js&lt;/value&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 147 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:109512px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background163.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:193.49px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/constructor-arg&gt;</span></div>
<div style="position:absolute;left:182.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:171.89px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:150.29px;top:102.22px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:139.49px;top:113.02px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:144.43px" class="cls_004"><span class="cls_004">3. Edit the</span><span class="cls_013">log4j.properties</span><span class="cls_004"> file (located in</span></div>
<div style="position:absolute;left:104.69px;top:157.71px" class="cls_007"><span class="cls_007">repo|src|main|amp|config|alfresco|module|repo</span><span class="cls_004">). Set</span></div>
<div style="position:absolute;left:104.69px;top:170.35px" class="cls_013"><span class="cls_013">log4j.logger.org.alfresco.repo.jscript.ScriptLogger</span><span class="cls_004"> to </span><span class="cls_013">DEBUG</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:185.79px" class="cls_004"><span class="cls_004">4. Now deploy and test.</span></div>
<div style="position:absolute;left:56.69px;top:209.68px" class="cls_004"><span class="cls_004">To test the JavaScript behavior, create a new HR Policy and watch the log. You should see</span></div>
<div style="position:absolute;left:56.69px;top:222.28px" class="cls_004"><span class="cls_004">multiple JavaScript logger messages.</span></div>
<div style="position:absolute;left:56.69px;top:258.98px" class="cls_014"><span class="cls_014">Binding behavior to child types</span></div>
<div style="position:absolute;left:56.69px;top:284.20px" class="cls_004"><span class="cls_004">In this example, you bound the </span><span class="cls_013">onUpdateNode.js</span><span class="cls_004"> to the </span><span class="cls_013">onUpdateNode</span><span class="cls_004">policy of the</span></div>
<div style="position:absolute;left:56.69px;top:297.48px" class="cls_004"><span class="cls_004">SomeCo HR Policy type. Remember that HR policy is a child of HR Doc. So what will</span></div>
<div style="position:absolute;left:56.69px;top:310.08px" class="cls_004"><span class="cls_004">happen if you bind the policy to the HR Document content type? Children inherit the</span></div>
<div style="position:absolute;left:56.69px;top:322.68px" class="cls_004"><span class="cls_004">behaviors of their parents.</span></div>
<div style="position:absolute;left:56.69px;top:357.32px" class="cls_023"><span class="cls_023">Step-by-step - writing a user ratings calculator</span></div>
<div style="position:absolute;left:56.69px;top:380.04px" class="cls_004"><span class="cls_004">So far, the behaviors you've written have just written log messages, which isn't terribly</span></div>
<div style="position:absolute;left:56.69px;top:392.64px" class="cls_004"><span class="cls_004">exciting. SomeCo's Marketing department has a requirement to consider, though.</span></div>
<div style="position:absolute;left:56.69px;top:405.24px" class="cls_004"><span class="cls_004">Marketing wants to let website users rate Whitepapers on a scale of one to five. They then</span></div>
<div style="position:absolute;left:56.69px;top:417.84px" class="cls_004"><span class="cls_004">want to show the average rating for a given Whitepaper. Once this is in place, they'll be able</span></div>
<div style="position:absolute;left:56.69px;top:430.44px" class="cls_004"><span class="cls_004">to call their website 2.0, which will be a big win for everybody.</span></div>
<div style="position:absolute;left:56.69px;top:452.04px" class="cls_004"><span class="cls_004">You're reading an Alfresco book, so let's assume the decision has been made to persist those</span></div>
<div style="position:absolute;left:56.69px;top:464.64px" class="cls_004"><span class="cls_004">ratings to Alfresco, though in real life that may or may not be the best thing to do (it might</span></div>
<div style="position:absolute;left:56.69px;top:477.24px" class="cls_004"><span class="cls_004">make more sense to store ratings and other user-generated content in a database).</span></div>
<div style="position:absolute;left:56.69px;top:498.84px" class="cls_004"><span class="cls_004">A new type, </span><span class="cls_013">sc:rating</span><span class="cls_004">, will be created to store an individual rating. A new aspect,</span></div>
<div style="position:absolute;left:56.69px;top:512.12px" class="cls_013"><span class="cls_013">sc:rateable</span><span class="cls_004">, will be created to attach to Whitepapers to identify them as something that</span></div>
<div style="position:absolute;left:56.69px;top:525.40px" class="cls_004"><span class="cls_004">can be rated and to store the summary statistics for the Whitepaper. Ratings will be</span></div>
<div style="position:absolute;left:56.69px;top:538.00px" class="cls_004"><span class="cls_004">associated with Whitepapers through child associations. That way, if the Whitepaper goes</span></div>
<div style="position:absolute;left:56.69px;top:550.60px" class="cls_004"><span class="cls_004">away, so will the ratings, which is what we want.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 148 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:110188px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background164.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">A Whitepaper's rating needs to be recalculated either when a new rating is created or when</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">a rating is deleted. One possibility would be to bind the behavior to the </span><span class="cls_013">NodeService</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">policy's </span><span class="cls_013">onCreateChildAssociation</span><span class="cls_004"> and </span><span class="cls_013">onDeleteChildAssociation</span><span class="cls_004"> methods for the</span></div>
<div style="position:absolute;left:56.69px;top:109.66px" class="cls_004"><span class="cls_004">Whitepaper node. But that would mean the behavior would constantly be inspecting the</span></div>
<div style="position:absolute;left:56.69px;top:122.26px" class="cls_004"><span class="cls_004">association type to see if it needs to take any action because there could be other child</span></div>
<div style="position:absolute;left:56.69px;top:134.86px" class="cls_004"><span class="cls_004">associations besides ratings. Instead, the behavior will be bound to the rating node's</span></div>
<div style="position:absolute;left:56.69px;top:147.46px" class="cls_013"><span class="cls_013">onCreateNode</span><span class="cls_004"> and </span><span class="cls_013">onDeleteNode</span><span class="cls_004"> policies. Any time a ratings node is created, the</span></div>
<div style="position:absolute;left:56.69px;top:160.74px" class="cls_004"><span class="cls_004">behavior will re-calculate the Whitepaper's summary statistics.</span></div>
<div style="position:absolute;left:56.69px;top:182.34px" class="cls_004"><span class="cls_004">Here is what you're going to need to do:</span></div>
<div style="position:absolute;left:91.32px;top:204.07px" class="cls_004"><span class="cls_004">1. Extend the SomeCo model with a rateable aspect and a rating type (and perform</span></div>
<div style="position:absolute;left:104.69px;top:216.67px" class="cls_004"><span class="cls_004">all of the UI configuration steps that go with it).</span></div>
<div style="position:absolute;left:91.32px;top:231.43px" class="cls_004"><span class="cls_004">2. Write the custom behavior class and bind it to the appropriate policies.</span></div>
<div style="position:absolute;left:91.32px;top:246.19px" class="cls_004"><span class="cls_004">3. Configure a Spring bean to initialize the behavior class and pass in any</span></div>
<div style="position:absolute;left:104.69px;top:258.79px" class="cls_004"><span class="cls_004">dependencies.</span></div>
<div style="position:absolute;left:91.32px;top:273.55px" class="cls_004"><span class="cls_004">4. Build, deploy, restart, and test. In a later chapter, you'll work on the frontend that</span></div>
<div style="position:absolute;left:104.69px;top:286.15px" class="cls_004"><span class="cls_004">will create ratings via web scripts. In this example, you'll create some server-side</span></div>
<div style="position:absolute;left:104.69px;top:298.75px" class="cls_004"><span class="cls_004">JavaScript to create a few ratings to test out the behavior.</span></div>
<div style="position:absolute;left:56.69px;top:322.64px" class="cls_004"><span class="cls_004">Let's get started. To create a behavior class that calculates the average rating across child</span></div>
<div style="position:absolute;left:56.69px;top:335.24px" class="cls_004"><span class="cls_004">rating objects, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:356.97px" class="cls_004"><span class="cls_004">1. Edit the </span><span class="cls_013">scModel.xml</span><span class="cls_004"> in</span></div>
<div style="position:absolute;left:104.69px;top:370.25px" class="cls_007"><span class="cls_007">repo|src|main|amp|config|alfresco|module|repo|model</span><span class="cls_004">. Add the new rating</span></div>
<div style="position:absolute;left:104.69px;top:382.89px" class="cls_004"><span class="cls_004">type:</span></div>
<div style="position:absolute;left:112.49px;top:406.10px" class="cls_010"><span class="cls_010">&lt;type name="sc:rating"&gt;</span></div>
<div style="position:absolute;left:112.49px;top:416.90px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Rating&lt;/title&gt;</span></div>
<div style="position:absolute;left:112.49px;top:427.70px" class="cls_010"><span class="cls_010">&lt;parent&gt;sys:base&lt;/parent&gt;</span></div>
<div style="position:absolute;left:112.49px;top:438.50px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:123.29px;top:449.30px" class="cls_010"><span class="cls_010">&lt;property name="sc:rating"&gt;</span></div>
<div style="position:absolute;left:155.69px;top:460.10px" class="cls_010"><span class="cls_010">&lt;type&gt;d:int&lt;/type&gt;</span></div>
<div style="position:absolute;left:155.69px;top:470.90px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;true&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:123.29px;top:481.70px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:123.29px;top:492.50px" class="cls_010"><span class="cls_010">&lt;property name="sc:rater"&gt;</span></div>
<div style="position:absolute;left:155.69px;top:503.30px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:155.69px;top:514.10px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;true&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:123.29px;top:524.90px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:112.49px;top:535.70px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:112.49px;top:546.50px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 149 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:110864px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background165.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:122.09px;top:70.50px" class="cls_004"><span class="cls_004">Note that </span><span class="cls_013">sc:rating</span><span class="cls_004"> inherits from </span><span class="cls_013">sys:base</span><span class="cls_004">. That's because there won't</span></div>
<div style="position:absolute;left:122.09px;top:83.78px" class="cls_004"><span class="cls_004">be any content stored in a rating object; it only has properties. This is</span></div>
<div style="position:absolute;left:122.09px;top:96.38px" class="cls_004"><span class="cls_004">sometimes called a </span><span class="cls_022">“</span><span class="cls_004">content-less object</span><span class="cls_022">”</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:130.03px" class="cls_004"><span class="cls_004">2.</span></div>
<div style="position:absolute;left:104.69px;top:130.03px" class="cls_004"><span class="cls_004">Now add the </span><span class="cls_013">sc:rateable</span><span class="cls_004"> aspect. The rateable aspect has one property to store</span></div>
<div style="position:absolute;left:104.69px;top:143.31px" class="cls_004"><span class="cls_004">the average rating, one to store the number of ratings, and one to store the sum of</span></div>
<div style="position:absolute;left:104.69px;top:155.91px" class="cls_004"><span class="cls_004">the ratings. The aspect also defines the child association that keeps track of the</span></div>
<div style="position:absolute;left:104.69px;top:168.51px" class="cls_004"><span class="cls_004">content's related ratings:</span></div>
<div style="position:absolute;left:117.89px;top:191.72px" class="cls_010"><span class="cls_010">&lt;aspect name="sc:rateable"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:202.52px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Rateable&lt;/title&gt;</span></div>
<div style="position:absolute;left:117.89px;top:213.32px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:139.49px;top:224.12px" class="cls_010"><span class="cls_010">&lt;property name="sc:averageRating"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:234.92px" class="cls_010"><span class="cls_010">&lt;type&gt;d:double&lt;/type&gt;</span></div>
<div style="position:absolute;left:161.09px;top:245.72px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:139.49px;top:256.52px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:267.32px" class="cls_010"><span class="cls_010">&lt;property name="sc:totalRating"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:278.12px" class="cls_010"><span class="cls_010">&lt;type&gt;d:int&lt;/type&gt;</span></div>
<div style="position:absolute;left:161.09px;top:288.92px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:139.49px;top:299.72px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:310.52px" class="cls_010"><span class="cls_010">&lt;property name="sc:ratingCount"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:321.32px" class="cls_010"><span class="cls_010">&lt;type&gt;d:int&lt;/type&gt;</span></div>
<div style="position:absolute;left:161.09px;top:332.12px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:139.49px;top:342.92px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:353.72px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:117.89px;top:364.52px" class="cls_010"><span class="cls_010">&lt;associations&gt;</span></div>
<div style="position:absolute;left:139.49px;top:375.32px" class="cls_010"><span class="cls_010">&lt;child-association name="sc:ratings"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:386.12px" class="cls_010"><span class="cls_010">&lt;title&gt;Rating&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:396.92px" class="cls_010"><span class="cls_010">&lt;source&gt;</span></div>
<div style="position:absolute;left:161.09px;top:407.72px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:161.09px;top:418.52px" class="cls_010"><span class="cls_010">&lt;many&gt;true&lt;/many&gt;</span></div>
<div style="position:absolute;left:139.49px;top:429.32px" class="cls_010"><span class="cls_010">&lt;/source&gt;</span></div>
<div style="position:absolute;left:139.49px;top:440.12px" class="cls_010"><span class="cls_010">&lt;target&gt;</span></div>
<div style="position:absolute;left:161.09px;top:450.92px" class="cls_010"><span class="cls_010">&lt;class&gt;sc:rating&lt;/class&gt;</span></div>
<div style="position:absolute;left:161.09px;top:461.72px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:161.09px;top:472.52px" class="cls_010"><span class="cls_010">&lt;many&gt;true&lt;/many&gt;</span></div>
<div style="position:absolute;left:139.49px;top:483.32px" class="cls_010"><span class="cls_010">&lt;/target&gt;</span></div>
<div style="position:absolute;left:139.49px;top:494.12px" class="cls_010"><span class="cls_010">&lt;/child-association&gt;</span></div>
<div style="position:absolute;left:117.89px;top:504.92px" class="cls_010"><span class="cls_010">&lt;/associations&gt;</span></div>
<div style="position:absolute;left:117.89px;top:515.72px" class="cls_010"><span class="cls_010">&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 150 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:111540px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background166.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. In the list of imports, don't forget to add the system definition model:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">&lt;import uri="</span><a href="http://www.alfresco.org/model/system/1.0" "="">http://www.alfresco.org/model/system/1.0"</a> </div>
<div style="position:absolute;left:128.69px;top:104.51px" class="cls_010"><span class="cls_010">prefix="sys" /&gt;</span></div>
<div style="position:absolute;left:91.32px;top:125.12px" class="cls_004"><span class="cls_004">4. Save and close the </span><span class="cls_013">scModel.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:140.56px" class="cls_004"><span class="cls_004">5. Edit </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> in </span><span class="cls_007">share|src|main|resources|META-INF</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:153.84px" class="cls_004"><span class="cls_004">The rateable properties and associations need to show up on property sheets for</span></div>
<div style="position:absolute;left:104.69px;top:166.44px" class="cls_004"><span class="cls_004">objects with the aspect. So add the following:</span></div>
<div style="position:absolute;left:117.89px;top:189.65px" class="cls_010"><span class="cls_010">&lt;config evaluator="aspect" condition="sc:rateable"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:200.45px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:139.49px;top:211.25px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:150.29px;top:222.05px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:232.85px" class="cls_010"><span class="cls_010">&lt;show id="sc:averageRating" read-only="true" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:243.65px" class="cls_010"><span class="cls_010">&lt;show id="sc:ratings" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:254.45px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:139.49px;top:265.25px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:117.89px;top:276.05px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:286.85px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:307.46px" class="cls_004"><span class="cls_004">6. The rateable aspect needs to show up on the </span><span class="cls_007">add aspect</span><span class="cls_004"> list. So add the rateable</span></div>
<div style="position:absolute;left:104.69px;top:320.10px" class="cls_004"><span class="cls_004">aspect to the list of visible aspects in </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:335.54px" class="cls_004"><span class="cls_004">7. Update the </span><span class="cls_013">scModel.properties</span><span class="cls_004"> file in the repo project by adding:</span></div>
<div style="position:absolute;left:117.89px;top:359.43px" class="cls_010"><span class="cls_010">sc_somecomodel.aspect.sc_rateable.title=Someco Rateable</span></div>
<div style="position:absolute;left:117.89px;top:370.23px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_averageRating.title=Average Rating</span></div>
<div style="position:absolute;left:117.89px;top:381.03px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_totalRating.title=Total Rating</span></div>
<div style="position:absolute;left:117.89px;top:391.83px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_ratingCount.title=# of Rating</span></div>
<div style="position:absolute;left:117.89px;top:402.63px" class="cls_010"><span class="cls_010">sc_somecomodel.association.sc_ratings.title=Ratings</span></div>
<div style="position:absolute;left:91.32px;top:423.24px" class="cls_004"><span class="cls_004">8. Update the </span><span class="cls_013">share.properties </span><span class="cls_004">file in the share project by adding:</span></div>
<div style="position:absolute;left:117.89px;top:447.13px" class="cls_010"><span class="cls_010">aspect.sc_rateable=Someco Rateable</span></div>
<div style="position:absolute;left:91.32px;top:467.74px" class="cls_004"><span class="cls_004">9. Modify </span><span class="cls_013">com.someco.repo.common.SomeCoModel</span><span class="cls_004"> to include new constants for</span></div>
<div style="position:absolute;left:104.69px;top:481.02px" class="cls_004"><span class="cls_004">the type, aspect, properties, and association that we just added to the model:</span></div>
<div style="position:absolute;left:117.89px;top:504.23px" class="cls_010"><span class="cls_010">public final static QName TYPE_RATING =</span></div>
<div style="position:absolute;left:128.69px;top:515.03px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "rating");</span></div>
<div style="position:absolute;left:117.89px;top:525.83px" class="cls_010"><span class="cls_010">public final static QName ASPECT_RATEABLE =</span></div>
<div style="position:absolute;left:128.69px;top:536.63px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "rateable");</span></div>
<div style="position:absolute;left:117.89px;top:547.43px" class="cls_010"><span class="cls_010">public final static QName PROP_RATING =</span></div>
<div style="position:absolute;left:128.69px;top:558.23px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "rating");</span></div>
<div style="position:absolute;left:117.89px;top:569.03px" class="cls_010"><span class="cls_010">public final static QName PROP_AVERAGERATING =</span></div>
<div style="position:absolute;left:128.69px;top:579.83px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "averageRating");</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 151 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:112216px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background167.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">public final static QName PROP_TOTALRATING =</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "totalRating");</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">public final static QName PROP_RATINGCOUNT =</span></div>
<div style="position:absolute;left:128.69px;top:102.22px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "ratingCount");</span></div>
<div style="position:absolute;left:117.89px;top:113.02px" class="cls_010"><span class="cls_010">public final static QName ASSOC_RATINGS =</span></div>
<div style="position:absolute;left:128.69px;top:123.82px" class="cls_010"><span class="cls_010">QName.createQName(SOMECO_MODEL_URI, "ratings");</span></div>
<div style="position:absolute;left:86.07px;top:144.43px" class="cls_004"><span class="cls_004">10. Create a new class called </span><span class="cls_013">com.someco.behavior.Rating</span><span class="cls_004">. Let's worry about</span></div>
<div style="position:absolute;left:104.69px;top:157.71px" class="cls_004"><span class="cls_004">how to handle new ratings first and deletions later. Given that, the class</span></div>
<div style="position:absolute;left:104.69px;top:170.31px" class="cls_004"><span class="cls_004">declaration is:</span></div>
<div style="position:absolute;left:117.89px;top:193.52px" class="cls_010"><span class="cls_010">public class Rating</span></div>
<div style="position:absolute;left:134.09px;top:204.32px" class="cls_010"><span class="cls_010">implements NodeServicePolicies.OnCreateNodePolicy {</span></div>
<div style="position:absolute;left:86.07px;top:224.93px" class="cls_004"><span class="cls_004">11. The class has two dependencies that Spring will take care of. One is the</span></div>
<div style="position:absolute;left:104.69px;top:237.53px" class="cls_013"><span class="cls_013">NodeService</span><span class="cls_004">, which will be used to produce the summary statistics, and the</span></div>
<div style="position:absolute;left:104.69px;top:250.81px" class="cls_004"><span class="cls_004">other is the </span><span class="cls_013">PolicyComponent</span><span class="cls_004">, which is used to bind the behavior to the policies.</span></div>
<div style="position:absolute;left:104.69px;top:264.09px" class="cls_004"><span class="cls_004">Add the two local class variables for the dependencies as well as one for the</span></div>
<div style="position:absolute;left:104.69px;top:276.69px" class="cls_013"><span class="cls_013">onCreateNode</span><span class="cls_004"> behavior:</span></div>
<div style="position:absolute;left:134.09px;top:300.58px" class="cls_010"><span class="cls_010">// Dependencies</span></div>
<div style="position:absolute;left:134.09px;top:311.38px" class="cls_010"><span class="cls_010">private NodeService nodeService;</span></div>
<div style="position:absolute;left:134.09px;top:322.18px" class="cls_010"><span class="cls_010">private PolicyComponent policyComponent;</span></div>
<div style="position:absolute;left:134.09px;top:332.98px" class="cls_010"><span class="cls_010">// Behaviours</span></div>
<div style="position:absolute;left:134.09px;top:343.78px" class="cls_010"><span class="cls_010">private Behaviour onCreateNode;</span></div>
<div style="position:absolute;left:86.07px;top:364.39px" class="cls_004"><span class="cls_004">12. Add the </span><span class="cls_013">init</span><span class="cls_004"> method to create and bind the behaviors:</span></div>
<div style="position:absolute;left:117.89px;top:388.28px" class="cls_010"><span class="cls_010">public void init() {</span></div>
<div style="position:absolute;left:128.69px;top:399.08px" class="cls_010"><span class="cls_010">this.onCreateNode = new JavaBehaviour(this,</span></div>
<div style="position:absolute;left:139.49px;top:409.88px" class="cls_010"><span class="cls_010">OnCreateNodePolicy.QNAME.getLocalName(),</span></div>
<div style="position:absolute;left:139.49px;top:420.68px" class="cls_010"><span class="cls_010">NotificationFrequency.TRANSACTION_COMMIT);</span></div>
<div style="position:absolute;left:128.69px;top:431.48px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:139.49px;top:442.28px" class="cls_010"><span class="cls_010">OnCreateNodePolicy.QNAME,</span></div>
<div style="position:absolute;left:139.49px;top:453.08px" class="cls_010"><span class="cls_010">SomeCoModel.TYPE_RATING,</span></div>
<div style="position:absolute;left:139.49px;top:463.88px" class="cls_010"><span class="cls_010">this.onCreateNode);</span></div>
<div style="position:absolute;left:117.89px;top:474.68px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:495.29px" class="cls_004"><span class="cls_004">13. In the </span><span class="cls_013">onCreateNode</span><span class="cls_004"> behavior method, call a method that knows what to do</span></div>
<div style="position:absolute;left:104.69px;top:508.57px" class="cls_004"><span class="cls_004">when ratings are added:</span></div>
<div style="position:absolute;left:117.89px;top:531.78px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:542.58px" class="cls_010"><span class="cls_010">public void onCreateNode(ChildAssociationRef childAssocRef) {</span></div>
<div style="position:absolute;left:128.69px;top:553.38px" class="cls_010"><span class="cls_010">addRating(childAssocRef);</span></div>
<div style="position:absolute;left:117.89px;top:564.18px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 152 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:112892px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background168.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">14.</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Add the </span><span class="cls_013">addRating</span><span class="cls_004"> method. It grabs the running total and rating count from the</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">parent, adds the rating to the total, increments the count, and computes the new</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">average:</span></div>
<div style="position:absolute;left:117.89px;top:119.59px" class="cls_010"><span class="cls_010">public void addRating(ChildAssociationRef childAssocRef) {</span></div>
<div style="position:absolute;left:128.69px;top:130.39px" class="cls_010"><span class="cls_010">// get the parent node</span></div>
<div style="position:absolute;left:128.69px;top:141.19px" class="cls_010"><span class="cls_010">NodeRef parentRef = childAssocRef.getParentRef();</span></div>
<div style="position:absolute;left:128.69px;top:151.99px" class="cls_010"><span class="cls_010">NodeRef childRef = childAssocRef.getChildRef();</span></div>
<div style="position:absolute;left:128.69px;top:173.59px" class="cls_010"><span class="cls_010">Integer total =</span></div>
<div style="position:absolute;left:139.49px;top:184.39px" class="cls_010"><span class="cls_010">(Integer) nodeService.getProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:195.19px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_TOTALRATING);</span></div>
<div style="position:absolute;left:128.69px;top:205.99px" class="cls_010"><span class="cls_010">if (total == null)</span></div>
<div style="position:absolute;left:139.49px;top:216.79px" class="cls_010"><span class="cls_010">total = 0;</span></div>
<div style="position:absolute;left:128.69px;top:227.59px" class="cls_010"><span class="cls_010">Integer count =</span></div>
<div style="position:absolute;left:139.49px;top:238.39px" class="cls_010"><span class="cls_010">(Integer) nodeService.getProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:249.19px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_RATINGCOUNT);</span></div>
<div style="position:absolute;left:128.69px;top:259.99px" class="cls_010"><span class="cls_010">if (count == null)</span></div>
<div style="position:absolute;left:139.49px;top:270.79px" class="cls_010"><span class="cls_010">count = 0;</span></div>
<div style="position:absolute;left:128.69px;top:281.59px" class="cls_010"><span class="cls_010">Integer rating =</span></div>
<div style="position:absolute;left:139.49px;top:292.39px" class="cls_010"><span class="cls_010">(Integer) nodeService.getProperty(childRef,</span></div>
<div style="position:absolute;left:139.49px;top:303.19px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_RATING);</span></div>
<div style="position:absolute;left:128.69px;top:313.99px" class="cls_010"><span class="cls_010">if (rating == null)</span></div>
<div style="position:absolute;left:139.49px;top:324.79px" class="cls_010"><span class="cls_010">rating = 0;</span></div>
<div style="position:absolute;left:128.69px;top:346.39px" class="cls_010"><span class="cls_010">Double average = 0d;</span></div>
<div style="position:absolute;left:128.69px;top:357.19px" class="cls_010"><span class="cls_010">total = total + rating;</span></div>
<div style="position:absolute;left:128.69px;top:367.99px" class="cls_010"><span class="cls_010">count = count + 1;</span></div>
<div style="position:absolute;left:128.69px;top:378.79px" class="cls_010"><span class="cls_010">average = total / new Double(count);</span></div>
<div style="position:absolute;left:128.69px;top:400.39px" class="cls_010"><span class="cls_010">// store the average on the parent node</span></div>
<div style="position:absolute;left:128.69px;top:411.19px" class="cls_010"><span class="cls_010">nodeService.setProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:421.99px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_AVERAGERATING, average);</span></div>
<div style="position:absolute;left:128.69px;top:432.79px" class="cls_010"><span class="cls_010">nodeService.setProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:443.59px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_TOTALRATING, total);</span></div>
<div style="position:absolute;left:128.69px;top:454.39px" class="cls_010"><span class="cls_010">nodeService.setProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:465.19px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_RATINGCOUNT, count);</span></div>
<div style="position:absolute;left:117.89px;top:475.99px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 153 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:113568px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background169.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">15. Add the setters for the NodeService and PolicyComponents:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">public void setNodeService(NodeService nodeService) {</span></div>
<div style="position:absolute;left:128.69px;top:104.51px" class="cls_010"><span class="cls_010">this.nodeService = nodeService;</span></div>
<div style="position:absolute;left:117.89px;top:115.31px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:126.11px" class="cls_010"><span class="cls_010">public void setPolicyComponent(</span></div>
<div style="position:absolute;left:117.89px;top:136.91px" class="cls_010"><span class="cls_010">PolicyComponent policyComponent) {</span></div>
<div style="position:absolute;left:128.69px;top:147.71px" class="cls_010"><span class="cls_010">this.policyComponent = policyComponent;</span></div>
<div style="position:absolute;left:117.89px;top:158.51px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:179.12px" class="cls_004"><span class="cls_004">16. Configure the behavior class as a Spring bean. Edit </span><span class="cls_013">behavior-context.xml</span><span class="cls_004"> in</span></div>
<div style="position:absolute;left:104.69px;top:192.40px" class="cls_004"><span class="cls_004">the</span><span class="cls_007">repo project</span><span class="cls_004">. Add the following bean:</span></div>
<div style="position:absolute;left:117.89px;top:215.65px" class="cls_010"><span class="cls_010">&lt;bean id="ratingBehaviour"</span></div>
<div style="position:absolute;left:128.69px;top:226.45px" class="cls_010"><span class="cls_010">class="com.someco.repo.behavior.Rating"</span></div>
<div style="position:absolute;left:128.69px;top:237.25px" class="cls_010"><span class="cls_010">init-method="init"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:248.05px" class="cls_010"><span class="cls_010">&lt;property name="nodeService" ref="nodeService" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:258.85px" class="cls_010"><span class="cls_010">&lt;property name="policyComponent" ref="policyComponent" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:269.65px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:290.26px" class="cls_004"><span class="cls_004">17. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:56.69px;top:327.20px" class="cls_023"><span class="cls_023">Step-by-step - testing the new rating behavior</span></div>
<div style="position:absolute;left:56.69px;top:349.91px" class="cls_004"><span class="cls_004">In the previous chapter, you used Java to test out the model by writing code against the</span></div>
<div style="position:absolute;left:56.69px;top:362.51px" class="cls_004"><span class="cls_004">CMIS API. This time, create server-side JavaScript you can use any time you need to create</span></div>
<div style="position:absolute;left:56.69px;top:375.11px" class="cls_004"><span class="cls_004">some test rating nodes for a piece of content. To do that, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:396.84px" class="cls_004"><span class="cls_004">1. Create a new Javascript file named </span><span class="cls_013">addTestRating.js </span><span class="cls_004">in the </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:410.12px" class="cls_013"><span class="cls_013">scripts</span><span class="cls_004"> directory (create this folder if it does not exist yet) with the following</span></div>
<div style="position:absolute;left:104.69px;top:423.40px" class="cls_004"><span class="cls_004">content:</span></div>
<div style="position:absolute;left:117.89px;top:446.61px" class="cls_010"><span class="cls_010">// add the aspect to this document if it needs it</span></div>
<div style="position:absolute;left:117.89px;top:457.41px" class="cls_010"><span class="cls_010">if (document.hasAspect("sc:rateable")) {</span></div>
<div style="position:absolute;left:128.69px;top:468.21px" class="cls_010"><span class="cls_010">logger.log("Document already as aspect");</span></div>
<div style="position:absolute;left:117.89px;top:479.01px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:128.69px;top:489.81px" class="cls_010"><span class="cls_010">logger.log("Adding rateable aspect");</span></div>
<div style="position:absolute;left:128.69px;top:500.61px" class="cls_010"><span class="cls_010">document.addAspect("sc:rateable");</span></div>
<div style="position:absolute;left:117.89px;top:511.41px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:522.21px" class="cls_010"><span class="cls_010">// randomly pick a num b/w 1 and 5 inclusive</span></div>
<div style="position:absolute;left:117.89px;top:533.01px" class="cls_010"><span class="cls_010">var ratingValue = Math.floor(Math.random() * 5) + 1;</span></div>
<div style="position:absolute;left:117.89px;top:543.81px" class="cls_010"><span class="cls_010">var props = new Array(2);</span></div>
<div style="position:absolute;left:117.89px;top:554.61px" class="cls_010"><span class="cls_010">props["sc:rating"] = ratingValue;</span></div>
<div style="position:absolute;left:117.89px;top:565.41px" class="cls_010"><span class="cls_010">props["sc:rater"] = person.properties.userName;</span></div>
<div style="position:absolute;left:117.89px;top:576.21px" class="cls_010"><span class="cls_010">// create a new ratings node and set its properties</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 154 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:114244px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background170.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">var ratingsNode = document.createNode("rating"</span></div>
<div style="position:absolute;left:123.29px;top:80.62px" class="cls_010"><span class="cls_010">+ new Date().getTime(),</span></div>
<div style="position:absolute;left:128.69px;top:91.42px" class="cls_010"><span class="cls_010">"sc:rating", props, "sc:ratings");</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">ratingsNode.save();</span></div>
<div style="position:absolute;left:117.89px;top:113.02px" class="cls_010"><span class="cls_010">logger.log("Ratings node saved.");</span></div>
<div style="position:absolute;left:91.32px;top:133.63px" class="cls_004"><span class="cls_004">2. Log in to the Alfresco Share and upload this Javascript file in </span><span class="cls_013">Data Dictionary</span></div>
<div style="position:absolute;left:104.69px;top:146.91px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">Scripts</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:162.35px" class="cls_004"><span class="cls_004">3. Open the </span><span class="cls_007">Marketing</span><span class="cls_004"> site, click on </span><span class="cls_007">Document Library</span><span class="cls_004">, create a new folder called</span></div>
<div style="position:absolute;left:104.69px;top:174.99px" class="cls_007"><span class="cls_007">Test Rating</span><span class="cls_004">, create a new rule on this folder:</span></div>
<div style="position:absolute;left:104.69px;top:198.92px" class="cls_004"><span class="cls_004">Name: Execute addTestRating.js</span></div>
<div style="position:absolute;left:104.69px;top:213.68px" class="cls_004"><span class="cls_004">When: Items are created or enter this folder; Items are updated</span></div>
<div style="position:absolute;left:104.69px;top:228.44px" class="cls_004"><span class="cls_004">Perform Action: Execute Script addTestRating.js</span></div>
<div style="position:absolute;left:91.32px;top:252.33px" class="cls_004"><span class="cls_004">4. When the rule is created, upload a document in this newly created folder.</span></div>
<div style="position:absolute;left:104.69px;top:264.93px" class="cls_004"><span class="cls_004">Automatically, you should see that a new rating has been added automatically:</span></div>
<div style="position:absolute;left:91.32px;top:477.86px" class="cls_004"><span class="cls_004">5. On the same document, just upload a new version, and a new rating should be</span></div>
<div style="position:absolute;left:104.69px;top:490.46px" class="cls_004"><span class="cls_004">added:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 155 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:114920px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background171.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:272.96px" class="cls_004"><span class="cls_004">Every time you create a new version, a new rating (with a random value) will be created as</span></div>
<div style="position:absolute;left:56.69px;top:285.56px" class="cls_004"><span class="cls_004">a child node of that content. If you look at the properties, the average rating should be</span></div>
<div style="position:absolute;left:56.69px;top:298.16px" class="cls_004"><span class="cls_004">updated too.</span></div>
<div style="position:absolute;left:56.69px;top:319.76px" class="cls_004"><span class="cls_004">The default out of the box display for associations is simply a list of paths to the associated</span></div>
<div style="position:absolute;left:56.69px;top:332.36px" class="cls_004"><span class="cls_004">content. That's not helpful, in this case, if you want to see an individual rating value. Right</span></div>
<div style="position:absolute;left:56.69px;top:344.96px" class="cls_004"><span class="cls_004">now, the easiest way is to use the node browser.</span></div>
<div style="position:absolute;left:56.69px;top:381.66px" class="cls_014"><span class="cls_014">Handling deleted ratings</span></div>
<div style="position:absolute;left:56.69px;top:406.88px" class="cls_004"><span class="cls_004">If you edit the properties, you'll notice that each rating has a remove icon. If you delete a</span></div>
<div style="position:absolute;left:56.69px;top:419.48px" class="cls_004"><span class="cls_004">rating, the rating will go away. But you didn't bind </span><span class="cls_013">onDeleteNode</span><span class="cls_004"> to a behavior, so the</span></div>
<div style="position:absolute;left:56.69px;top:432.76px" class="cls_004"><span class="cls_004">average will not get recalculated. Let's see how we can fix that.</span></div>
<div style="position:absolute;left:56.69px;top:454.36px" class="cls_004"><span class="cls_004">To handle deleted ratings, you're going to edit </span><span class="cls_013">com.someco.repo.behavior.Rating</span><span class="cls_004"> to</span></div>
<div style="position:absolute;left:56.69px;top:467.64px" class="cls_004"><span class="cls_004">add a new behavior for </span><span class="cls_013">onDeleteNode</span><span class="cls_004"> that will call a method to recalculate the rating stats.</span></div>
<div style="position:absolute;left:56.69px;top:480.92px" class="cls_004"><span class="cls_004">Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:502.65px" class="cls_004"><span class="cls_004">1. First, the class now needs to implement the </span><span class="cls_013">OnDeleteNodePolicy</span><span class="cls_004">, so update the</span></div>
<div style="position:absolute;left:104.69px;top:515.93px" class="cls_004"><span class="cls_004">class declaration:</span></div>
<div style="position:absolute;left:117.89px;top:539.14px" class="cls_010"><span class="cls_010">public class Rating</span></div>
<div style="position:absolute;left:123.29px;top:549.94px" class="cls_010"><span class="cls_010">implements NodeServicePolicies.OnDeleteNodePolicy,</span></div>
<div style="position:absolute;left:188.09px;top:560.74px" class="cls_010"><span class="cls_010">NodeServicePolicies.OnCreateNodePolicy {</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 156 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:115596px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background172.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Update the </span><span class="cls_013">init</span><span class="cls_004"> method with the appropriate logic to instantiate and bind the</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_013"><span class="cls_013">onDeleteNode</span><span class="cls_004"> behavior:</span></div>
<div style="position:absolute;left:117.89px;top:107.67px" class="cls_010"><span class="cls_010">this.onDeleteNode = new JavaBehaviour(this,</span></div>
<div style="position:absolute;left:128.69px;top:118.47px" class="cls_010"><span class="cls_010">OnDeleteNodePolicy.QNAME.getLocalName(),</span></div>
<div style="position:absolute;left:128.69px;top:129.27px" class="cls_010"><span class="cls_010">NotificationFrequency.TRANSACTION_COMMIT);</span></div>
<div style="position:absolute;left:117.89px;top:140.07px" class="cls_010"><span class="cls_010">this.policyComponent.bindClassBehaviour(</span></div>
<div style="position:absolute;left:139.49px;top:150.87px" class="cls_010"><span class="cls_010">OnDeleteNodePolicy.QNAME,</span></div>
<div style="position:absolute;left:128.69px;top:161.67px" class="cls_010"><span class="cls_010">SomeCoModel.TYPE_RATING, this.onDeleteNode);</span></div>
<div style="position:absolute;left:91.32px;top:182.28px" class="cls_004"><span class="cls_004">3. Add the </span><span class="cls_013">onDeleteNode</span><span class="cls_004"> method. The method calls a method used to recalculate</span></div>
<div style="position:absolute;left:104.69px;top:195.56px" class="cls_004"><span class="cls_004">the rating statistics:</span></div>
<div style="position:absolute;left:112.49px;top:218.77px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:112.49px;top:229.57px" class="cls_010"><span class="cls_010">public void onDeleteNode(ChildAssociationRef childAssocRef,</span></div>
<div style="position:absolute;left:117.89px;top:240.37px" class="cls_010"><span class="cls_010">boolean isNodeArchived) {</span></div>
<div style="position:absolute;left:128.69px;top:251.17px" class="cls_010"><span class="cls_010">if (childAssocRef != null &amp;&amp;</span></div>
<div style="position:absolute;left:134.09px;top:261.97px" class="cls_010"><span class="cls_010">nodeService.exists(childAssocRef.getParentRef()))</span></div>
<div style="position:absolute;left:128.69px;top:272.77px" class="cls_010"><span class="cls_010">recalculateAverage(childAssocRef.getParentRef());</span></div>
<div style="position:absolute;left:117.89px;top:283.57px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:304.18px" class="cls_004"><span class="cls_004">4. Finally, implement the </span><span class="cls_013">recalculateAverage</span><span class="cls_004"> method. The method knows how</span></div>
<div style="position:absolute;left:104.69px;top:317.46px" class="cls_004"><span class="cls_004">to iterate over a node's children to calculate the total rating, rating count, and</span></div>
<div style="position:absolute;left:104.69px;top:330.06px" class="cls_004"><span class="cls_004">average. The reason why it can't use a running total approach like </span><span class="cls_013">addRating</span><span class="cls_004"> is</span></div>
<div style="position:absolute;left:104.69px;top:343.34px" class="cls_004"><span class="cls_004">that by this point, the rating has already been deleted:</span></div>
<div style="position:absolute;left:117.89px;top:366.55px" class="cls_010"><span class="cls_010">public void recalculateAverage(NodeRef parentRef) {</span></div>
<div style="position:absolute;left:128.69px;top:377.35px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:388.15px" class="cls_010"><span class="cls_010">logger.debug("Inside recalculateAverage");</span></div>
<div style="position:absolute;left:123.29px;top:398.95px" class="cls_010"><span class="cls_010">// check the parent to make sure it has the right aspect</span></div>
<div style="position:absolute;left:128.69px;top:409.75px" class="cls_010"><span class="cls_010">if (nodeService.hasAspect(parentRef,</span></div>
<div style="position:absolute;left:150.29px;top:420.55px" class="cls_010"><span class="cls_010">SomeCoModel.ASPECT_RATEABLE)) {</span></div>
<div style="position:absolute;left:139.49px;top:431.35px" class="cls_010"><span class="cls_010">// continue, this is what we want</span></div>
<div style="position:absolute;left:128.69px;top:442.15px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:139.49px;top:452.95px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:144.89px;top:463.75px" class="cls_010"><span class="cls_010">logger.debug("Rating's parent didn't have rateable aspect.");</span></div>
<div style="position:absolute;left:139.49px;top:474.55px" class="cls_010"><span class="cls_010">return;</span></div>
<div style="position:absolute;left:128.69px;top:485.35px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:496.15px" class="cls_010"><span class="cls_010">// get the parent node's children</span></div>
<div style="position:absolute;left:128.69px;top:506.95px" class="cls_010"><span class="cls_010">List&lt;ChildAssociationRef&gt; children = nodeService</span></div>
<div style="position:absolute;left:139.49px;top:517.75px" class="cls_010"><span class="cls_010">.getChildAssocs(parentRef);</span></div>
<div style="position:absolute;left:128.69px;top:528.55px" class="cls_010"><span class="cls_010">Double average = 0d;</span></div>
<div style="position:absolute;left:128.69px;top:539.35px" class="cls_010"><span class="cls_010">int total = 0;</span></div>
<div style="position:absolute;left:128.69px;top:550.15px" class="cls_010"><span class="cls_010">// This actually happens when the last rating is deleted</span></div>
<div style="position:absolute;left:128.69px;top:560.95px" class="cls_010"><span class="cls_010">if (children.size() == 0) {</span></div>
<div style="position:absolute;left:139.49px;top:571.75px" class="cls_010"><span class="cls_010">// No children so no work to do</span></div>
<div style="position:absolute;left:139.49px;top:582.55px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 157 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:116272px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background173.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:150.29px;top:69.82px" class="cls_010"><span class="cls_010">logger.debug("No children found");</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">// iterate through the children to compute the total</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">for (ChildAssociationRef child : children) {</span></div>
<div style="position:absolute;left:150.29px;top:113.02px" class="cls_010"><span class="cls_010">if (nodeService.getType(child.getChildRef())</span></div>
<div style="position:absolute;left:171.89px;top:123.82px" class="cls_010"><span class="cls_010">.equals(SomeCoModel.TYPE_RATING)) {</span></div>
<div style="position:absolute;left:155.69px;top:134.62px" class="cls_010"><span class="cls_010">int rating = (Integer) nodeService.getProperty(</span></div>
<div style="position:absolute;left:171.89px;top:145.42px" class="cls_010"><span class="cls_010">child.getChildRef(), SomeCoModel.PROP_RATING);</span></div>
<div style="position:absolute;left:161.09px;top:156.22px" class="cls_010"><span class="cls_010">total += rating;</span></div>
<div style="position:absolute;left:150.29px;top:167.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:177.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:188.62px" class="cls_010"><span class="cls_010">// compute the average</span></div>
<div style="position:absolute;left:139.49px;top:199.42px" class="cls_010"><span class="cls_010">average = total / (children.size() / 1.0d);</span></div>
<div style="position:absolute;left:139.49px;top:210.22px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:150.29px;top:221.02px" class="cls_010"><span class="cls_010">logger.debug("Computed average:" + average);</span></div>
<div style="position:absolute;left:128.69px;top:231.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:242.62px" class="cls_010"><span class="cls_010">// store the average on the parent node</span></div>
<div style="position:absolute;left:128.69px;top:253.42px" class="cls_010"><span class="cls_010">nodeService.setProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:264.22px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_AVERAGERATING, average);</span></div>
<div style="position:absolute;left:128.69px;top:275.02px" class="cls_010"><span class="cls_010">nodeService.setProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:285.82px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_TOTALRATING, total);</span></div>
<div style="position:absolute;left:128.69px;top:296.62px" class="cls_010"><span class="cls_010">nodeService.setProperty(parentRef,</span></div>
<div style="position:absolute;left:139.49px;top:307.42px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_RATINGCOUNT, children.size());</span></div>
<div style="position:absolute;left:128.69px;top:318.22px" class="cls_010"><span class="cls_010">if (logger.isDebugEnabled())</span></div>
<div style="position:absolute;left:139.49px;top:329.02px" class="cls_010"><span class="cls_010">logger.debug("Property set");</span></div>
<div style="position:absolute;left:117.89px;top:339.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:360.43px" class="cls_004"><span class="cls_004">5. Don't forget to define the few constants and variables that we need:</span></div>
<div style="position:absolute;left:117.89px;top:383.64px" class="cls_010"><span class="cls_010">private static Logger logger =</span></div>
<div style="position:absolute;left:117.89px;top:394.44px" class="cls_010"><span class="cls_010">Logger.getLogger(Rating.class);</span></div>
<div style="position:absolute;left:117.89px;top:405.24px" class="cls_010"><span class="cls_010">private Behaviour onDeleteNode;</span></div>
<div style="position:absolute;left:91.32px;top:425.85px" class="cls_004"><span class="cls_004">6. Now save, deploy, restart, and test.</span></div>
<div style="position:absolute;left:56.69px;top:449.74px" class="cls_004"><span class="cls_004">To summarize, each time that you delete a rating from Alfresco Share, it will recalculate the</span></div>
<div style="position:absolute;left:56.69px;top:462.34px" class="cls_004"><span class="cls_004">average rating. However, we configured a rule on the same folder that create a random</span></div>
<div style="position:absolute;left:56.69px;top:474.94px" class="cls_004"><span class="cls_004">rating each time that the document is updated. It means that, even if you delete all ratings</span></div>
<div style="position:absolute;left:56.69px;top:487.54px" class="cls_004"><span class="cls_004">from the edit form, a new rating will be automatically added.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 158 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:116948px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background174.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Extracting metadata from files</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">Many authoring tools provide a mechanism for capturing metadata within the authoring</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">tool user interface. If certain pieces of metadata are already stored as part of the file, why</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">force content contributors to re-key the metadata when they add the content to the</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">repository? Alfresco can use metadata extractors to inspect the file, extract the metadata,</span></div>
<div style="position:absolute;left:56.69px;top:147.78px" class="cls_004"><span class="cls_004">and save the metadata in the node's properties.</span></div>
<div style="position:absolute;left:56.69px;top:169.38px" class="cls_004"><span class="cls_004">A metadata extractor is a Java class configured as a Spring bean that either gets called when</span></div>
<div style="position:absolute;left:56.69px;top:181.98px" class="cls_004"><span class="cls_004">content is created in the repository, or when the extractor is invoked by a rule action.</span></div>
<div style="position:absolute;left:56.69px;top:194.58px" class="cls_004"><span class="cls_004">Alfresco knows which extractor to use for a given piece of content because metadata</span></div>
<div style="position:absolute;left:56.69px;top:207.18px" class="cls_004"><span class="cls_004">extractors declare the MIME types they support.</span></div>
<div style="position:absolute;left:56.69px;top:228.78px" class="cls_004"><span class="cls_004">Metadata extractors have a default mapping that identifies which pieces of file metadata</span></div>
<div style="position:absolute;left:56.69px;top:241.38px" class="cls_004"><span class="cls_004">should be stored in which node properties. The property mapping can be overridden by</span></div>
<div style="position:absolute;left:56.69px;top:253.98px" class="cls_004"><span class="cls_004">pointing to a custom mapping in the Spring bean configuration.</span></div>
<div style="position:absolute;left:56.69px;top:290.68px" class="cls_014"><span class="cls_014">Customizing metadata extractors</span></div>
<div style="position:absolute;left:56.69px;top:315.90px" class="cls_004"><span class="cls_004">SomeCo would like to set the </span><span class="cls_013">sc:clientName</span><span class="cls_004"> property with the value of the keywords</span></div>
<div style="position:absolute;left:56.69px;top:329.18px" class="cls_004"><span class="cls_004">property in Word files. Alfresco already provides extractors for Word. The Word extractor</span></div>
<div style="position:absolute;left:56.69px;top:341.78px" class="cls_004"><span class="cls_004">knows how to retrieve the keywords from a Word file, but it is not mapped by default.</span></div>
<div style="position:absolute;left:56.69px;top:376.43px" class="cls_023"><span class="cls_023">Step-by-step - customizing the metadata mapping</span></div>
<div style="position:absolute;left:56.69px;top:399.14px" class="cls_004"><span class="cls_004">Let's customize the metadata mapping for the Office extractor so that when SomeCo adds</span></div>
<div style="position:absolute;left:56.69px;top:411.74px" class="cls_004"><span class="cls_004">Office documents to the repository, the keywords property gets stored in the</span></div>
<div style="position:absolute;left:56.69px;top:424.34px" class="cls_013"><span class="cls_013">sc:clientName</span><span class="cls_004"> property. This is just a matter of overriding the default mapping file. To</span></div>
<div style="position:absolute;left:56.69px;top:437.62px" class="cls_004"><span class="cls_004">do that, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:459.35px" class="cls_004"><span class="cls_004">1. Create a new Spring context file in</span></div>
<div style="position:absolute;left:104.69px;top:471.95px" class="cls_007"><span class="cls_007">src|main|amp|config|alfresco|module|repo|context </span><span class="cls_004">within the </span><span class="cls_013">repo</span><span class="cls_004"> project</span></div>
<div style="position:absolute;left:104.69px;top:485.23px" class="cls_004"><span class="cls_004">called </span><span class="cls_013">extractor-context.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 159 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:117624px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background175.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Then, edit the</span><span class="cls_013">extractor-context.xml</span><span class="cls_004"> file that overrides the out-of-the-box</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_013"><span class="cls_013">extracter.Poi</span><span class="cls_004"> bean, and points to a custom mapping file:</span></div>
<div style="position:absolute;left:117.89px;top:107.67px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:118.47px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN'</span></div>
<div style="position:absolute;left:117.89px;top:129.27px" class="cls_010"><span class="cls_010">'</span><a href="http://www.springframework.org/dtd/spring-beans.dtd&#39;/">http://www.springframework.org/dtd/spring-beans.dtd'</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:140.07px" class="cls_010"><span class="cls_010">&lt;beans&gt;</span></div>
<div style="position:absolute;left:117.89px;top:150.87px" class="cls_010"><span class="cls_010">&lt;bean id="extracter.Poi"</span></div>
<div style="position:absolute;left:128.69px;top:161.67px" class="cls_010"><span class="cls_010">class="org.alfresco.repo.content.metadata.PoiMetadataExtracter"</span></div>
<div style="position:absolute;left:128.69px;top:172.47px" class="cls_010"><span class="cls_010">parent="baseMetadataExtracter"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:183.27px" class="cls_010"><span class="cls_010">&lt;property name="inheritDefaultMapping"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:194.07px" class="cls_010"><span class="cls_010">&lt;value&gt;false&lt;/value&gt;</span></div>
<div style="position:absolute;left:139.49px;top:204.87px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:215.67px" class="cls_010"><span class="cls_010">&lt;property name="mappingProperties"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:226.47px" class="cls_010"><span class="cls_010">&lt;bean class="org.springframework.beans</span></div>
<div style="position:absolute;left:161.09px;top:237.27px" class="cls_010"><span class="cls_010">.factory.config.PropertiesFactoryBean"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:248.07px" class="cls_010"><span class="cls_010">&lt;property name="location"&gt;</span></div>
<div style="position:absolute;left:204.29px;top:258.87px" class="cls_010"><span class="cls_010">&lt;value&gt;classpath:alfresco</span></div>
<div style="position:absolute;left:204.29px;top:269.67px" class="cls_010"><span class="cls_010">/module/${project.artifactId}</span></div>
<div style="position:absolute;left:204.29px;top:280.47px" class="cls_010"><span class="cls_010">/extractor-mappings.properties&lt;/value&gt;</span></div>
<div style="position:absolute;left:182.69px;top:291.27px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:161.09px;top:302.07px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:139.49px;top:312.87px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:323.67px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:334.47px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:91.32px;top:355.08px" class="cls_004"><span class="cls_004">3. As usual when we create a new Spring context file, we need to reference it in</span></div>
<div style="position:absolute;left:104.69px;top:367.68px" class="cls_004"><span class="cls_004">your </span><span class="cls_013">module-context.xml</span><span class="cls_004"> file. You should be able to do it by your own now.</span></div>
<div style="position:absolute;left:91.32px;top:383.12px" class="cls_004"><span class="cls_004">4. Create a new file in the </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span></div>
<div style="position:absolute;left:104.69px;top:396.40px" class="cls_004"><span class="cls_004">directory called </span><span class="cls_013">extractor-mappings.properties</span><span class="cls_004">. The custom mapping just</span></div>
<div style="position:absolute;left:104.69px;top:409.68px" class="cls_004"><span class="cls_004">needs to specify what to do with the keywords. The namespace for the property's</span></div>
<div style="position:absolute;left:104.69px;top:422.28px" class="cls_004"><span class="cls_004">content model also has to be declared. The entire contents of the properties file</span></div>
<div style="position:absolute;left:104.69px;top:434.88px" class="cls_004"><span class="cls_004">look like this:</span></div>
<div style="position:absolute;left:117.89px;top:458.09px" class="cls_010"><span class="cls_010">namespace.prefix.cm=</span><a href="http://www.alfresco.org/model/content/1.0/">http://www.alfresco.org/model/content/1.0</a> </div>
<div style="position:absolute;left:117.89px;top:468.89px" class="cls_010"><span class="cls_010">namespace.prefix.sc=</span><a href="http://www.someco.com/model/content/1.0/">http://www.someco.com/model/content/1.0</a> </div>
<div style="position:absolute;left:139.49px;top:479.69px" class="cls_010"><span class="cls_010">author=cm:author</span></div>
<div style="position:absolute;left:139.49px;top:490.49px" class="cls_010"><span class="cls_010">title=cm:title</span></div>
<div style="position:absolute;left:139.49px;top:501.29px" class="cls_010"><span class="cls_010">description=cm:description</span></div>
<div style="position:absolute;left:139.49px;top:512.09px" class="cls_010"><span class="cls_010">created=cm:created</span></div>
<div style="position:absolute;left:139.49px;top:522.89px" class="cls_010"><span class="cls_010">Keywords=sc:clientName</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 160 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:118300px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background176.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Sometimes, it may be tricky to know which extractor will be used by Alfresco. In</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">my test, I'll use a </span><span class="cls_013">*.docx</span><span class="cls_004"> document, and so I know that the </span><span class="cls_013">POIExtractor</span><span class="cls_004"> will</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">be used. To have more details, add these two lines to your </span><span class="cls_013">log4j.properties</span></div>
<div style="position:absolute;left:104.69px;top:109.66px" class="cls_004"><span class="cls_004">(located in </span><span class="cls_013">repo | src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004">):</span></div>
<div style="position:absolute;left:117.89px;top:133.55px" class="cls_010"><span class="cls_010">log4j.logger.org.alfresco.repo.content</span></div>
<div style="position:absolute;left:139.49px;top:144.35px" class="cls_010"><span class="cls_010">.metadata=DEBUG log4j.logger.org.alfresco.repo.content</span></div>
<div style="position:absolute;left:139.49px;top:155.15px" class="cls_010"><span class="cls_010">.metadata.AbstractMappingMetadataExtracter=DEBUG</span></div>
<div style="position:absolute;left:91.32px;top:175.76px" class="cls_004"><span class="cls_004">6. Deploy the change and restart Tomcat.</span></div>
<div style="position:absolute;left:56.69px;top:199.65px" class="cls_004"><span class="cls_004">Now set up a test. When a document is added to SomeCo's Sales folder, three things need to</span></div>
<div style="position:absolute;left:56.69px;top:212.25px" class="cls_004"><span class="cls_004">happen: The document needs to be specialized to </span><span class="cls_013">sc:salesDoc</span><span class="cls_004">, the </span><span class="cls_013">sc:clientRelated</span></div>
<div style="position:absolute;left:56.69px;top:225.53px" class="cls_004"><span class="cls_004">aspect needs to be added, and the metadata needs to get extracted. This is not completely</span></div>
<div style="position:absolute;left:56.69px;top:238.13px" class="cls_004"><span class="cls_004">true; you don't really need to add the aspect manually. The default behavior when you set a</span></div>
<div style="position:absolute;left:56.69px;top:250.73px" class="cls_004"><span class="cls_004">property from an aspect on a node via the Java API is that the aspect is added</span></div>
<div style="position:absolute;left:56.69px;top:263.33px" class="cls_004"><span class="cls_004">automatically. However, it makes your rule cleaner and makes more sense to add the aspect</span></div>
<div style="position:absolute;left:56.69px;top:275.93px" class="cls_004"><span class="cls_004">manually. One way to make sure that happens is to set up an inbound rule on the Sales</span></div>
<div style="position:absolute;left:56.69px;top:288.53px" class="cls_004"><span class="cls_004">folder. Let's do it:</span></div>
<div style="position:absolute;left:91.32px;top:310.26px" class="cls_004"><span class="cls_004">1. Log in to Alfresco Share, and create a new site called </span><span class="cls_007">Sales</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:325.06px" class="cls_004"><span class="cls_004">2. In the </span><span class="cls_007">Document Library</span><span class="cls_004">, create a new folder called </span><span class="cls_007">Public Document</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:339.86px" class="cls_004"><span class="cls_004">3. Create a new rule on this newly created folder:</span></div>
<div style="position:absolute;left:152.69px;top:352.45px" class="cls_004"><span class="cls_004">Name: Create Public Sales Document</span></div>
<div style="position:absolute;left:152.69px;top:367.21px" class="cls_004"><span class="cls_004">When: Items are created or enter this folder</span></div>
<div style="position:absolute;left:91.32px;top:384.14px" class="cls_004"><span class="cls_004">4. If all criteria are met:</span></div>
<div style="position:absolute;left:152.69px;top:396.73px" class="cls_004"><span class="cls_004">Content of type or sub-type is Content</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 161 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:118976px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background177.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Perform Action:</span></div>
<div style="position:absolute;left:139.32px;top:83.10px" class="cls_004"><span class="cls_004">1. Specialise Type to Someco Sales Document</span></div>
<div style="position:absolute;left:139.32px;top:97.86px" class="cls_004"><span class="cls_004">2. Add Aspect Someco Client Metadata</span></div>
<div style="position:absolute;left:139.32px;top:112.62px" class="cls_004"><span class="cls_004">3. Extract common metadata fields</span></div>
<div style="position:absolute;left:91.32px;top:448.46px" class="cls_004"><span class="cls_004">6. Save the rule.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 162 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:119652px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background178.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Create a test Microsoft Office document. (You can use OpenOffice. Just save the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">file as one of the Microsoft Office formats). Use </span><span class="cls_007">File</span><span class="cls_004">, </span><span class="cls_007">Properties</span><span class="cls_004"> to set the</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">Keywords with a client name. Save the file.</span></div>
<div style="position:absolute;left:91.32px;top:351.42px" class="cls_004"><span class="cls_004">8. Add the file to the </span><span class="cls_007">Public Document </span><span class="cls_004">folder. In the properties panel, the </span><span class="cls_007">Client</span></div>
<div style="position:absolute;left:104.69px;top:364.06px" class="cls_007"><span class="cls_007">Name</span><span class="cls_004"> property should default to the value you set using Office:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 163 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:120328px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background179.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You can notice that the list of keywords appears in the </span><span class="cls_007">Description</span><span class="cls_004"> and </span><span class="cls_007">Client Name</span><span class="cls_004"> fields.</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">The main reason is because Apache Tika populates the description automatically in this</span></div>
<div style="position:absolute;left:56.69px;top:95.74px" class="cls_004"><span class="cls_004">case (you can notice that in your log files by inspecting the </span><span class="cls_013">Raw Properties </span><span class="cls_004">generated by</span></div>
<div style="position:absolute;left:56.69px;top:109.02px" class="cls_004"><span class="cls_004">the extractor). To avoid this use case, we just need to edit the file </span><span class="cls_013">extractor-</span></div>
<div style="position:absolute;left:56.69px;top:122.30px" class="cls_013"><span class="cls_013">mappings.properties</span><span class="cls_004"> and change the description mapping:</span></div>
<div style="position:absolute;left:74.69px;top:143.90px" class="cls_010"><span class="cls_010">description=</span></div>
<div style="position:absolute;left:56.69px;top:164.38px" class="cls_004"><span class="cls_004">If it doesn't work, it's probably because you are not customizing the right extractor. If you</span></div>
<div style="position:absolute;left:56.69px;top:176.98px" class="cls_004"><span class="cls_004">added the two lines in your </span><span class="cls_013">log4j.properties</span><span class="cls_004">, you should notice the following</span></div>
<div style="position:absolute;left:56.69px;top:190.26px" class="cls_004"><span class="cls_004">messages. The important message is the </span><span class="cls_013">Get returning</span><span class="cls_004"> one that shows which extractor</span></div>
<div style="position:absolute;left:56.69px;top:203.54px" class="cls_004"><span class="cls_004">that will be used.</span></div>
<div style="position:absolute;left:74.69px;top:224.46px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:235.26px" class="cls_010"><span class="cls_010">Get extractors for application/vnd.openxmlformats-</span></div>
<div style="position:absolute;left:74.69px;top:246.06px" class="cls_010"><span class="cls_010">officedocument.wordprocessingml.document</span></div>
<div style="position:absolute;left:74.69px;top:256.86px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:267.66px" class="cls_010"><span class="cls_010">Finding extractors for application/vnd.openxmlformats-</span></div>
<div style="position:absolute;left:74.69px;top:278.46px" class="cls_010"><span class="cls_010">officedocument.wordprocessingml.document</span></div>
<div style="position:absolute;left:74.69px;top:289.26px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:300.06px" class="cls_010"><span class="cls_010">Find supported:</span></div>
<div style="position:absolute;left:171.89px;top:300.06px" class="cls_010"><span class="cls_010">extracter.TikaAuto</span></div>
<div style="position:absolute;left:74.69px;top:310.86px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:321.66px" class="cls_010"><span class="cls_010">Find unsupported: extracter.PDFBox</span></div>
<div style="position:absolute;left:74.69px;top:332.46px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:343.26px" class="cls_010"><span class="cls_010">Find supported:</span></div>
<div style="position:absolute;left:171.89px;top:343.26px" class="cls_010"><span class="cls_010">extracter.Poi</span></div>
<div style="position:absolute;left:74.69px;top:354.06px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:364.86px" class="cls_010"><span class="cls_010">Find unsupported: extracter.Office</span></div>
<div style="position:absolute;left:74.69px;top:375.66px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:386.46px" class="cls_010"><span class="cls_010">Find unsupported: extracter.Mail</span></div>
<div style="position:absolute;left:74.69px;top:397.26px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:408.06px" class="cls_010"><span class="cls_010">Find unsupported: extracter.Html</span></div>
<div style="position:absolute;left:74.69px;top:418.86px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:429.66px" class="cls_010"><span class="cls_010">Find unsupported: extracter.OpenDocument</span></div>
<div style="position:absolute;left:74.69px;top:440.46px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:451.26px" class="cls_010"><span class="cls_010">Find unsupported: extracter.DWG</span></div>
<div style="position:absolute;left:74.69px;top:462.06px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:472.86px" class="cls_010"><span class="cls_010">Find unsupported: extracter.RFC822</span></div>
<div style="position:absolute;left:74.69px;top:483.66px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:494.46px" class="cls_010"><span class="cls_010">Find unsupported: extracter.MP3</span></div>
<div style="position:absolute;left:74.69px;top:505.26px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:516.06px" class="cls_010"><span class="cls_010">Find unsupported: extracter.Audio</span></div>
<div style="position:absolute;left:74.69px;top:526.86px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:537.66px" class="cls_010"><span class="cls_010">Find unsupported: extracter.OpenOffice</span></div>
<div style="position:absolute;left:74.69px;top:548.46px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:559.26px" class="cls_010"><span class="cls_010">Find unsupported: extracter.JodConverter</span></div>
<div style="position:absolute;left:74.69px;top:570.06px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:580.86px" class="cls_010"><span class="cls_010">Find returning:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 164 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:121004px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background180.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:74.69px;top:69.82px" class="cls_010"><span class="cls_010">[org.alfresco.repo.content.metadata.TikaAutoMetadataExtracter@1b50ea6c,</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">org.alfresco.repo.content.metadata.PoiMetadataExtracter@3cf4021c]</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:102.22px" class="cls_010"><span class="cls_010">Get supported:</span></div>
<div style="position:absolute;left:166.49px;top:102.22px" class="cls_010"><span class="cls_010">extracter.TikaAuto</span></div>
<div style="position:absolute;left:74.69px;top:113.02px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:123.82px" class="cls_010"><span class="cls_010">Get supported:</span></div>
<div style="position:absolute;left:166.49px;top:123.82px" class="cls_010"><span class="cls_010">extracter.Poi</span></div>
<div style="position:absolute;left:74.69px;top:134.62px" class="cls_010"><span class="cls_010">DEBUG [content.metadata.MetadataExtracterRegistry] [http-apr-8080-exec-4]</span></div>
<div style="position:absolute;left:74.69px;top:145.42px" class="cls_010"><span class="cls_010">Get returning:</span></div>
<div style="position:absolute;left:166.49px;top:145.42px" class="cls_010"><span class="cls_010">extracter.Poi</span></div>
<div style="position:absolute;left:56.69px;top:165.90px" class="cls_004"><span class="cls_004">If metadata extraction is automatic, you may be wondering why we explicitly invoked it as</span></div>
<div style="position:absolute;left:56.69px;top:178.50px" class="cls_004"><span class="cls_004">part of the rule. It's a workaround for a little timing problem. Without the rule to explicitly</span></div>
<div style="position:absolute;left:56.69px;top:191.10px" class="cls_004"><span class="cls_004">invoke metadata extraction, Alfresco will perform the metadata extraction on its own</span></div>
<div style="position:absolute;left:56.69px;top:203.70px" class="cls_004"><span class="cls_004">because it recognizes the MIME type and it knows it has a metadata extractor configured</span></div>
<div style="position:absolute;left:56.69px;top:216.30px" class="cls_004"><span class="cls_004">for that MIME type. The problem is that it performs the metadata extraction before it has</span></div>
<div style="position:absolute;left:56.69px;top:228.90px" class="cls_004"><span class="cls_004">added the aspect. So in Alfresco Share, the </span><span class="cls_013">clientName</span><span class="cls_004"> property doesn't default to the</span></div>
<div style="position:absolute;left:56.69px;top:242.18px" class="cls_004"><span class="cls_004">extracted metadata as you've specified. Using a rule to explicitly invoke the extraction</span></div>
<div style="position:absolute;left:56.69px;top:254.78px" class="cls_004"><span class="cls_004">forces Alfresco to add the aspect, then set the property. A side effect to this workaround is</span></div>
<div style="position:absolute;left:56.69px;top:267.38px" class="cls_004"><span class="cls_004">that the extractor gets invoked twice-once by Alfresco when the document is initially</span></div>
<div style="position:absolute;left:56.69px;top:279.98px" class="cls_004"><span class="cls_004">created, and a second time when the rule is fired.</span></div>
<div style="position:absolute;left:56.69px;top:316.68px" class="cls_014"><span class="cls_014">Overriding the default mapping</span></div>
<div style="position:absolute;left:56.69px;top:341.90px" class="cls_004"><span class="cls_004">Note that in this case, in the extractor POI Spring bean, </span><span class="cls_013">inheritDefaultMapping</span><span class="cls_004">, is set to</span></div>
<div style="position:absolute;left:56.69px;top:355.18px" class="cls_013"><span class="cls_013">false</span><span class="cls_004">. This means that we redefine the entire mapping, that we can find in </span><span class="cls_013">alfresco</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:56.69px;top:368.46px" class="cls_013"><span class="cls_013">metadata</span><span class="cls_004"> | </span><span class="cls_013">PoiMetadataExtracter.properties</span><span class="cls_004"> packaged in the </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:381.74px" class="cls_013"><span class="cls_013">repository-5.x.jar</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:419.12px" class="cls_014"><span class="cls_014">Leveraging out-of-the-box metadata extractors</span></div>
<div style="position:absolute;left:56.69px;top:444.34px" class="cls_004"><span class="cls_004">There are several metadata extractors configured out of the box. These include:</span></div>
<div style="position:absolute;left:104.69px;top:466.07px" class="cls_007"><span class="cls_007">Microsoft Office, OpenOffice.org, and Adobe PDF</span><span class="cls_004">: These extract summary</span></div>
<div style="position:absolute;left:104.69px;top:478.71px" class="cls_004"><span class="cls_004">information such as author, title, subject, and created date</span></div>
<div style="position:absolute;left:104.69px;top:493.47px" class="cls_007"><span class="cls_007">HTML</span><span class="cls_004">: This extracts author, title, and description from META tags</span></div>
<div style="position:absolute;left:104.69px;top:508.27px" class="cls_007"><span class="cls_007">MP3</span><span class="cls_004">: This extracts song, album, artist, year, track number, and several other</span></div>
<div style="position:absolute;left:104.69px;top:520.90px" class="cls_004"><span class="cls_004">fields from ID3 tags</span></div>
<div style="position:absolute;left:104.69px;top:535.66px" class="cls_007"><span class="cls_007">XML</span><span class="cls_004">: This extracts Strings from XML using XPath expressions</span></div>
<div style="position:absolute;left:104.69px;top:550.46px" class="cls_007"><span class="cls_007">Mail</span><span class="cls_004">: This extracts typical email information like sent date, originator or subject</span></div>
<div style="position:absolute;left:104.69px;top:563.09px" class="cls_004"><span class="cls_004">line.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 165 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:121680px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background181.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">When you add a piece of content matching any of these types to the repository, Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">invokes the metadata extractor and populates the node's properties as specified in the</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">extractor's default mapping file.</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">A complete list of the out of the box metadata extractors, their class names, bean IDs, and</span></div>
<div style="position:absolute;left:56.69px;top:129.90px" class="cls_004"><span class="cls_004">the out of the box properties they extract is provided in the Appendix.</span></div>
<div style="position:absolute;left:56.69px;top:168.65px" class="cls_008"><span class="cls_008">Transforming content from one format to</span></div>
<div style="position:absolute;left:56.69px;top:192.65px" class="cls_008"><span class="cls_008">another</span></div>
<div style="position:absolute;left:56.69px;top:220.38px" class="cls_004"><span class="cls_004">A content transformer is used to transform content from one format to another. Content</span></div>
<div style="position:absolute;left:56.69px;top:232.98px" class="cls_004"><span class="cls_004">transformers are implemented as a Java class configured as a Spring bean. Alfresco finds the</span></div>
<div style="position:absolute;left:56.69px;top:245.58px" class="cls_004"><span class="cls_004">appropriate transformer based on source and target MIME type. There are two important</span></div>
<div style="position:absolute;left:56.69px;top:258.18px" class="cls_004"><span class="cls_004">use cases for transformers. The first is when an end user triggers a transformation, usually</span></div>
<div style="position:absolute;left:56.69px;top:270.78px" class="cls_004"><span class="cls_004">through an action. The most well-known out of the box example is converting Microsoft</span></div>
<div style="position:absolute;left:56.69px;top:283.38px" class="cls_004"><span class="cls_004">Office documents to PDF. Other out of the box transformers include:</span></div>
<div style="position:absolute;left:104.69px;top:305.11px" class="cls_004"><span class="cls_004">HTML-to-text</span></div>
<div style="position:absolute;left:104.69px;top:319.87px" class="cls_004"><span class="cls_004">Microsoft Excel-to-CSV</span></div>
<div style="position:absolute;left:104.69px;top:334.63px" class="cls_004"><span class="cls_004">Microsoft Word-to-text</span></div>
<div style="position:absolute;left:104.69px;top:349.39px" class="cls_004"><span class="cls_004">PDF-to-text</span></div>
<div style="position:absolute;left:104.69px;top:364.15px" class="cls_004"><span class="cls_004">Images-to-Images</span></div>
<div style="position:absolute;left:56.69px;top:388.04px" class="cls_004"><span class="cls_004">See the Appendix for further details on the out of the box transformers.</span></div>
<div style="position:absolute;left:56.69px;top:409.64px" class="cls_004"><span class="cls_004">The second key transformer use case involves the Solr full-text search engine. Solr indexes</span></div>
<div style="position:absolute;left:56.69px;top:422.24px" class="cls_004"><span class="cls_004">content when it is added to the repository. But the Alfresco Tracker code embedded in Solr</span></div>
<div style="position:absolute;left:56.69px;top:434.84px" class="cls_004"><span class="cls_004">only understands plain text. The Solr process sends queries every 15 seconds by default to</span></div>
<div style="position:absolute;left:56.69px;top:447.44px" class="cls_004"><span class="cls_004">Alfresco to get all changes in the Alfresco repository. After a binary file is added to the</span></div>
<div style="position:absolute;left:56.69px;top:460.04px" class="cls_004"><span class="cls_004">repository and need to be indexed in Solr, Alfresco looks for a transformer that can convert</span></div>
<div style="position:absolute;left:56.69px;top:472.64px" class="cls_004"><span class="cls_004">the file to plain text. The plain text is then sent back to Solr. If there is a content type that</span></div>
<div style="position:absolute;left:56.69px;top:485.24px" class="cls_004"><span class="cls_004">Alfresco doesn't know how to full-text index out of the box, the trick is to write a content</span></div>
<div style="position:absolute;left:56.69px;top:497.84px" class="cls_004"><span class="cls_004">transformer for it and you're in business.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 166 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:122356px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background182.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - writing a custom transformer</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">SomeCo works a lot with Microsoft Project files. The project files have task and resource</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">information that would be useful to search against. But Alfresco doesn't have a content</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">transformer that deals with Microsoft Project files, so out of the box Microsoft Project files</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">aren't full-text indexed. In order to rectify that situation, you're going to have to write a</span></div>
<div style="position:absolute;left:56.69px;top:145.38px" class="cls_004"><span class="cls_004">custom transformer that converts Microsoft Project files to plain text.</span></div>
<div style="position:absolute;left:56.69px;top:166.98px" class="cls_004"><span class="cls_004">Content transformers extend </span><span class="cls_013">AbstractContentTransformer2</span><span class="cls_004">, which implements the</span></div>
<div style="position:absolute;left:56.69px;top:180.26px" class="cls_013"><span class="cls_013">ContentTransformer</span><span class="cls_004"> interface. At a minimum, all that is required for a custom content</span></div>
<div style="position:absolute;left:56.69px;top:193.54px" class="cls_004"><span class="cls_004">transformer is to implement twomethods. The </span><span class="cls_013">transformInternal()</span><span class="cls_004"> method is used to</span></div>
<div style="position:absolute;left:56.69px;top:206.82px" class="cls_004"><span class="cls_004">actually perform the transformation. The </span><span class="cls_013">isTransformable()</span><span class="cls_004"> method is used to specify if</span></div>
<div style="position:absolute;left:56.69px;top:220.10px" class="cls_004"><span class="cls_004">the transformer supports or not the transformation. Obviously, you'll also need an API that</span></div>
<div style="position:absolute;left:56.69px;top:232.70px" class="cls_004"><span class="cls_004">knows how to read the source format.</span></div>
<div style="position:absolute;left:56.69px;top:254.30px" class="cls_004"><span class="cls_004">So, to do this task you'll need to:</span></div>
<div style="position:absolute;left:91.32px;top:276.03px" class="cls_004"><span class="cls_004">1. Write a custom class that extends </span><span class="cls_013">AbstractContentTransformer2</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:291.47px" class="cls_004"><span class="cls_004">2. Configure a Spring bean to declare the new transformer.</span></div>
<div style="position:absolute;left:91.32px;top:306.23px" class="cls_004"><span class="cls_004">3. Tell Alfresco about the Microsoft Project MIME type.</span></div>
<div style="position:absolute;left:56.69px;top:330.12px" class="cls_004"><span class="cls_004">To write a custom content transformer that uses MPXJ to convert Microsoft Project files to</span></div>
<div style="position:absolute;left:56.69px;top:342.72px" class="cls_004"><span class="cls_004">plain text, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:364.45px" class="cls_004"><span class="cls_004">1. Create a new class in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">java</span><span class="cls_004"> called</span></div>
<div style="position:absolute;left:104.69px;top:377.73px" class="cls_013"><span class="cls_013">com.someco.repo.transformer.ProjectToPlainText</span><span class="cls_004"> that extends</span></div>
<div style="position:absolute;left:104.69px;top:391.01px" class="cls_013"><span class="cls_013">AbstractContentTransformer2</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:406.45px" class="cls_004"><span class="cls_004">2. Open your Maven </span><span class="cls_013">pom.xml</span><span class="cls_004"> file in the repo project and add the following</span></div>
<div style="position:absolute;left:104.69px;top:419.73px" class="cls_004"><span class="cls_004">dependency:</span></div>
<div style="position:absolute;left:117.89px;top:442.94px" class="cls_010"><span class="cls_010">&lt;dependency&gt;</span></div>
<div style="position:absolute;left:139.49px;top:453.74px" class="cls_010"><span class="cls_010">&lt;groupId&gt;net.sf.mpxj&lt;/groupId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:464.54px" class="cls_010"><span class="cls_010">&lt;artifactId&gt;mpxj&lt;/artifactId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:475.34px" class="cls_010"><span class="cls_010">&lt;version&gt;5.3.1&lt;/version&gt;</span></div>
<div style="position:absolute;left:117.89px;top:486.14px" class="cls_010"><span class="cls_010">&lt;/dependency&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 167 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:123032px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background183.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Lets's start by the </span><span class="cls_013">isTransformable()</span><span class="cls_004"> method to specify that we can transform</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">from MSProject files to plain text files.</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">public boolean isTransformable(</span></div>
<div style="position:absolute;left:139.49px;top:117.79px" class="cls_010"><span class="cls_010">String sourceMimetype,</span></div>
<div style="position:absolute;left:139.49px;top:128.59px" class="cls_010"><span class="cls_010">String targetMimetype,</span></div>
<div style="position:absolute;left:139.49px;top:139.39px" class="cls_010"><span class="cls_010">TransformationOptions options) {</span></div>
<div style="position:absolute;left:128.69px;top:150.19px" class="cls_010"><span class="cls_010">if ("application/vnd.ms-project"</span></div>
<div style="position:absolute;left:139.49px;top:160.99px" class="cls_010"><span class="cls_010">.equalsIgnoreCase(sourceMimetype)</span></div>
<div style="position:absolute;left:139.49px;top:171.79px" class="cls_010"><span class="cls_010">&amp;&amp; MimetypeMap.MIMETYPE_TEXT_PLAIN</span></div>
<div style="position:absolute;left:139.49px;top:182.59px" class="cls_010"><span class="cls_010">.equalsIgnoreCase(targetMimetype))</span></div>
<div style="position:absolute;left:150.29px;top:193.39px" class="cls_010"><span class="cls_010">return true;</span></div>
<div style="position:absolute;left:150.29px;top:204.19px" class="cls_010"><span class="cls_010">return false;</span></div>
<div style="position:absolute;left:117.89px;top:214.99px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:235.60px" class="cls_004"><span class="cls_004">4. Next is the </span><span class="cls_013">transformInternal()</span><span class="cls_004"> method. It does the bulk of the work,</span></div>
<div style="position:absolute;left:104.69px;top:248.88px" class="cls_004"><span class="cls_004">although the MPXJ library does the heavy lifting. The method uses the MPXJ</span></div>
<div style="position:absolute;left:104.69px;top:261.48px" class="cls_004"><span class="cls_004">library to iterate through the tasks and writes out the task information:</span></div>
<div style="position:absolute;left:117.89px;top:284.69px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:295.49px" class="cls_010"><span class="cls_010">protected void transformInternal(</span></div>
<div style="position:absolute;left:139.49px;top:306.29px" class="cls_010"><span class="cls_010">ContentReader reader,</span></div>
<div style="position:absolute;left:139.49px;top:317.09px" class="cls_010"><span class="cls_010">ContentWriter writer,</span></div>
<div style="position:absolute;left:139.49px;top:327.89px" class="cls_010"><span class="cls_010">TransformationOptions options) throws Exception {</span></div>
<div style="position:absolute;left:128.69px;top:338.69px" class="cls_010"><span class="cls_010">Writer out = new BufferedWriter(</span></div>
<div style="position:absolute;left:139.49px;top:349.49px" class="cls_010"><span class="cls_010">new OutputStreamWriter(writer.getContentOutputStream()));</span></div>
<div style="position:absolute;left:128.69px;top:371.09px" class="cls_010"><span class="cls_010">ProjectFile mpp = new MPPReader().read(</span></div>
<div style="position:absolute;left:139.49px;top:381.89px" class="cls_010"><span class="cls_010">reader.getContentInputStream());</span></div>
<div style="position:absolute;left:128.69px;top:392.69px" class="cls_010"><span class="cls_010">ProjectProperties projectHeader = mpp.getProjectProperties();</span></div>
<div style="position:absolute;left:128.69px;top:403.49px" class="cls_010"><span class="cls_010">List&lt;Task&gt; listAllTasks = mpp.getAllTasks();</span></div>
<div style="position:absolute;left:128.69px;top:414.29px" class="cls_010"><span class="cls_010">List&lt;Resource&gt; listAllResources = mpp.getAllResources();</span></div>
<div style="position:absolute;left:128.69px;top:435.89px" class="cls_010"><span class="cls_010">out.write(projectHeader.getProjectTitle());</span></div>
<div style="position:absolute;left:128.69px;top:446.69px" class="cls_010"><span class="cls_010">for (Task task : listAllTasks) {</span></div>
<div style="position:absolute;left:139.49px;top:457.49px" class="cls_010"><span class="cls_010">out.write("ID:" + task.getID());</span></div>
<div style="position:absolute;left:139.49px;top:468.29px" class="cls_010"><span class="cls_010">out.write(" TASK:" + task.getName());</span></div>
<div style="position:absolute;left:139.49px;top:479.09px" class="cls_010"><span class="cls_010">if (task.getNotes() != null)</span></div>
<div style="position:absolute;left:150.29px;top:489.89px" class="cls_010"><span class="cls_010">out.write(" NOTES:" + task.getNotes());</span></div>
<div style="position:absolute;left:139.49px;top:500.69px" class="cls_010"><span class="cls_010">if (task.getContact() != null)</span></div>
<div style="position:absolute;left:150.29px;top:511.49px" class="cls_010"><span class="cls_010">out.write(" CONTACT:" + task.getContact());</span></div>
<div style="position:absolute;left:139.49px;top:522.29px" class="cls_010"><span class="cls_010">out.write("\r\n");</span></div>
<div style="position:absolute;left:128.69px;top:533.09px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:543.89px" class="cls_010"><span class="cls_010">for (Resource resource : listAllResources) {</span></div>
<div style="position:absolute;left:139.49px;top:554.69px" class="cls_010"><span class="cls_010">out.write("RESOURCE:" + resource.getName());</span></div>
<div style="position:absolute;left:139.49px;top:565.49px" class="cls_010"><span class="cls_010">if (resource.getEmailAddress() != null)</span></div>
<div style="position:absolute;left:150.29px;top:576.29px" class="cls_010"><span class="cls_010">out.write(" EMAIL:" + resource.getEmailAddress());</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 168 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:123708px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background184.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">if (resource.getNotes() != null)</span></div>
<div style="position:absolute;left:150.29px;top:80.62px" class="cls_010"><span class="cls_010">out.write("  NOTES:" + resource.getNotes());</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">out.write("\r\n");</span></div>
<div style="position:absolute;left:128.69px;top:102.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:123.82px" class="cls_010"><span class="cls_010">out.flush();</span></div>
<div style="position:absolute;left:128.69px;top:145.42px" class="cls_010"><span class="cls_010">if (out != null) {</span></div>
<div style="position:absolute;left:139.49px;top:156.22px" class="cls_010"><span class="cls_010">out.close();</span></div>
<div style="position:absolute;left:128.69px;top:167.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:122.09px;top:198.30px" class="cls_004"><span class="cls_004">The labels that get output in all caps (</span><span class="cls_022">“</span><span class="cls_004">NOTES</span><span class="cls_022">”</span><span class="cls_004">, </span><span class="cls_022">“</span><span class="cls_004">CONTACT</span><span class="cls_022">”</span><span class="cls_004">, and so on)</span></div>
<div style="position:absolute;left:122.09px;top:211.73px" class="cls_004"><span class="cls_004">don't do anything special. In fact, they add unnecessarily to the index. But</span></div>
<div style="position:absolute;left:122.09px;top:224.33px" class="cls_004"><span class="cls_004">if you actually want to try to read this output, it helps to have some</span></div>
<div style="position:absolute;left:122.09px;top:236.93px" class="cls_004"><span class="cls_004">markers in there. In a production implementation, it is probably best to</span></div>
<div style="position:absolute;left:122.09px;top:249.53px" class="cls_004"><span class="cls_004">leave them out.</span></div>
<div style="position:absolute;left:91.32px;top:271.26px" class="cls_004"><span class="cls_004">5. That's all for the class. Now create a file in</span></div>
<div style="position:absolute;left:104.69px;top:283.86px" class="cls_013"><span class="cls_013">repo|src|main|amp|config|alfresco|module|repo|context</span><span class="cls_004"> called</span></div>
<div style="position:absolute;left:104.69px;top:297.14px" class="cls_013"><span class="cls_013">transformer-context.xml</span><span class="cls_004"> with the following:</span></div>
<div style="position:absolute;left:117.89px;top:321.03px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:331.83px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN'</span></div>
<div style="position:absolute;left:117.89px;top:342.63px" class="cls_010"><span class="cls_010">'</span><a href="http://www.springframework.org/dtd/spring-beans.dtd&#39;/">http://www.springframework.org/dtd/spring-beans.dtd'</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:353.43px" class="cls_010"><span class="cls_010">&lt;beans&gt;</span></div>
<div style="position:absolute;left:117.89px;top:364.23px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:91.32px;top:384.84px" class="cls_004"><span class="cls_004">6. The bean to add declares the new transformer. The ID follows the Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:397.44px" class="cls_004"><span class="cls_004">convention of starting with </span><span class="cls_022">“</span><span class="cls_013">transformer</span><span class="cls_004">.</span><span class="cls_022">”</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:421.48px" class="cls_010"><span class="cls_010">&lt;bean id="transformer.MSProject"</span></div>
<div style="position:absolute;left:128.69px;top:432.28px" class="cls_010"><span class="cls_010">class="com.someco.repo.transformer.ProjectToPlainText"</span></div>
<div style="position:absolute;left:128.69px;top:443.08px" class="cls_010"><span class="cls_010">parent="baseContentTransformer" /&gt;</span></div>
<div style="position:absolute;left:91.32px;top:463.69px" class="cls_004"><span class="cls_004">7. Update the </span><span class="cls_013">module-context.xml</span><span class="cls_004"> file in your repo project to include your newly</span></div>
<div style="position:absolute;left:104.69px;top:476.97px" class="cls_004"><span class="cls_004">Spring bean context file as usual.</span></div>
<div style="position:absolute;left:91.32px;top:491.73px" class="cls_004"><span class="cls_004">8. Now, we need to define the supported MIME types. Edit the file </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:104.69px;top:505.01px" class="cls_013"><span class="cls_013">global.properties </span><span class="cls_004">located in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span></div>
<div style="position:absolute;left:104.69px;top:518.29px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">module</span><span class="cls_004"> by adding these lines (be extremely careful, Alfresco is following strong</span></div>
<div style="position:absolute;left:104.69px;top:531.57px" class="cls_004"><span class="cls_004">rule to define the property names):</span></div>
<div style="position:absolute;left:117.89px;top:554.78px" class="cls_010"><span class="cls_010">content.transformer.MSProject.priority=100</span></div>
<div style="position:absolute;left:117.89px;top:565.58px" class="cls_010"><span class="cls_010">content.transformer.MSProject.extensions.mpp.txt.supported=true</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 169 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:124384px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background185.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Handling Content Automatically with Actions, Behaviors, Transformers, and Extractors</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:122.09px;top:94.39px" class="cls_004"><span class="cls_004">To see what's going on with the out of the box content transformers, set</span></div>
<div style="position:absolute;left:122.09px;top:106.21px" class="cls_013"><span class="cls_013">log4j.logger.org.alfresco.repo.content.transform.Transfor</span></div>
<div style="position:absolute;left:122.09px;top:118.99px" class="cls_013"><span class="cls_013">merDebug</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:122.09px;top:132.27px" class="cls_013"><span class="cls_013">log4j.logger.org.alfresco.repo.content.transform</span><span class="cls_004"> equals to</span></div>
<div style="position:absolute;left:122.09px;top:145.55px" class="cls_013"><span class="cls_013">DEBUG</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:167.83px" class="cls_004"><span class="cls_004">To test the new content transformer, add a Microsoft Project file anywhere in the repository,</span></div>
<div style="position:absolute;left:56.69px;top:180.43px" class="cls_004"><span class="cls_004">then do a search for a piece of text contained within the file, but not in the file name. The</span></div>
<div style="position:absolute;left:56.69px;top:193.03px" class="cls_004"><span class="cls_004">test should return the Microsoft Project file. This would not have been possible prior to</span></div>
<div style="position:absolute;left:56.69px;top:205.63px" class="cls_004"><span class="cls_004">deploying the custom Microsoft Project-to-Plain Text content transformer. Another option is</span></div>
<div style="position:absolute;left:56.69px;top:218.23px" class="cls_004"><span class="cls_004">to create a rule that transform all Microsoft Project files to text files. Using this method, you</span></div>
<div style="position:absolute;left:56.69px;top:230.83px" class="cls_004"><span class="cls_004">can review exactly what Alfresco generates and indexes.</span></div>
<div style="position:absolute;left:122.09px;top:252.43px" class="cls_004"><span class="cls_004">If you want to test, you can find a sample MS Project file in repo|resources</span></div>
<div style="position:absolute;left:122.09px;top:265.03px" class="cls_004"><span class="cls_004">that we downloaded from </span><a href="http://www.techno-pm.com/p/sample-it-project-plan.html">http://www.techno-pm.com/p/sample-it-pro</a> </div>
<div style="position:absolute;left:122.09px;top:278.01px" class="cls_010"><span class="cls_010"> </span><a href="http://www.techno-pm.com/p/sample-it-project-plan.html">ject-plan.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:328.98px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:356.71px" class="cls_004"><span class="cls_004">This chapter covered four different ways in which you can automatically process content as</span></div>
<div style="position:absolute;left:56.69px;top:369.31px" class="cls_004"><span class="cls_004">it is created, read, updated, and deleted. Specifically, you learned how to:</span></div>
<div style="position:absolute;left:104.69px;top:391.04px" class="cls_004"><span class="cls_004">Write custom actions both with and without action parameters, as well as how to</span></div>
<div style="position:absolute;left:104.69px;top:403.64px" class="cls_004"><span class="cls_004">invoke actions from JavaScript</span></div>
<div style="position:absolute;left:104.69px;top:418.40px" class="cls_004"><span class="cls_004">Bind logic to custom types using behaviors, including the logic that has a deal</span></div>
<div style="position:absolute;left:104.69px;top:431.00px" class="cls_004"><span class="cls_004">with the fact that it may have to wait until an existing transaction completes</span></div>
<div style="position:absolute;left:104.69px;top:445.76px" class="cls_004"><span class="cls_004">Extract metadata from binary files to reduce the amount of re-keying content</span></div>
<div style="position:absolute;left:104.69px;top:458.36px" class="cls_004"><span class="cls_004">contributors have to do when adding content to the repository</span></div>
<div style="position:absolute;left:104.69px;top:473.12px" class="cls_004"><span class="cls_004">Transform content from one format to another to facilitate full-text searching, or</span></div>
<div style="position:absolute;left:104.69px;top:485.72px" class="cls_004"><span class="cls_004">to simply provide a way for users to generate additional output formats from the</span></div>
<div style="position:absolute;left:104.69px;top:498.32px" class="cls_004"><span class="cls_004">same piece of content</span></div>
<div style="position:absolute;left:56.69px;top:522.21px" class="cls_004"><span class="cls_004">When planning your own Alfresco implementations and Alfresco-based solutions, it is</span></div>
<div style="position:absolute;left:56.69px;top:534.81px" class="cls_004"><span class="cls_004">important to keep these hooks in mind. This is because the more code that can be moved</span></div>
<div style="position:absolute;left:56.69px;top:547.41px" class="cls_004"><span class="cls_004">into these areas, the more flexible and end-user configurable your solution will be.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 170 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:125060px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background186.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">5</span></div>
<div style="position:absolute;left:114.61px;top:167.48px" class="cls_011"><span class="cls_011">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">Alfresco Share is an all-purpose user interface for general document management. As such,</span></div>
<div style="position:absolute;left:56.69px;top:239.07px" class="cls_004"><span class="cls_004">it may not be specific enough for the solution you are trying to implement. Or, you may</span></div>
<div style="position:absolute;left:56.69px;top:251.67px" class="cls_004"><span class="cls_004">have the opposite problem-too many choices can confuse the users. The good news is that</span></div>
<div style="position:absolute;left:56.69px;top:264.27px" class="cls_004"><span class="cls_004">Alfresco Share is easily configurable and can be extended.</span></div>
<div style="position:absolute;left:56.69px;top:285.87px" class="cls_004"><span class="cls_004">By the end of this chapter, you will know how to:</span></div>
<div style="position:absolute;left:104.69px;top:307.60px" class="cls_004"><span class="cls_004">Add new action items to the Alfresco Share</span></div>
<div style="position:absolute;left:104.69px;top:322.36px" class="cls_004"><span class="cls_004">Show/hide menu items based on things such as permissions or arbitrary logic</span></div>
<div style="position:absolute;left:104.69px;top:337.12px" class="cls_004"><span class="cls_004">Create custom metadata template to change how Alfresco Share shows repository</span></div>
<div style="position:absolute;left:104.69px;top:349.72px" class="cls_004"><span class="cls_004">data</span></div>
<div style="position:absolute;left:104.69px;top:364.48px" class="cls_004"><span class="cls_004">Create custom dialogs to gather information from a user</span></div>
<div style="position:absolute;left:104.69px;top:379.24px" class="cls_004"><span class="cls_004">Create new pages into Alfresco Share</span></div>
<div style="position:absolute;left:104.69px;top:394.00px" class="cls_004"><span class="cls_004">Create new dashlets into Alfresco Share</span></div>
<div style="position:absolute;left:104.69px;top:408.76px" class="cls_004"><span class="cls_004">Assess whether the solution you are building should be based on a custom</span></div>
<div style="position:absolute;left:104.69px;top:421.36px" class="cls_004"><span class="cls_004">version of Alfresco Share or would be more appropriate as a custom application</span></div>
<div style="position:absolute;left:122.09px;top:445.25px" class="cls_004"><span class="cls_004">It is important to note that with the 4.2 release (and expanded with the 5.1</span></div>
<div style="position:absolute;left:122.09px;top:457.85px" class="cls_004"><span class="cls_004">release), Alfresco introduced a new UI framework called </span><span class="cls_007">Aikau.</span></div>
<div style="position:absolute;left:56.69px;top:504.65px" class="cls_004"><span class="cls_004">There is always more than one option to implement something in Alfresco Share. Today, if</span></div>
<div style="position:absolute;left:56.69px;top:517.25px" class="cls_004"><span class="cls_004">you want to create a page or a dashlet, you have two main options: Aikau or Surf. This book</span></div>
<div style="position:absolute;left:56.69px;top:529.85px" class="cls_004"><span class="cls_004">will cover mainly the use of the Surf framework. The main reason is that Surf is a</span></div>
<div style="position:absolute;left:56.69px;top:542.45px" class="cls_004"><span class="cls_004">framework on the market for quite a while, and you'll find a lot of examples about it online.</span></div>
<div style="position:absolute;left:56.69px;top:555.05px" class="cls_004"><span class="cls_004">If you want to look for Aikau tutorials, Alfresco is providing as well a lot of information</span></div>
<div style="position:absolute;left:56.69px;top:567.65px" class="cls_004"><span class="cls_004">online in their documentation; </span><a href="http://docs.alfresco.com/">http://docs.alfresco.com/</a> </div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:125736px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background187.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Knowing when to customize Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:93.65px" class="cls_008"><span class="cls_008">and when to write your own</span></div>
<div style="position:absolute;left:56.69px;top:121.38px" class="cls_004"><span class="cls_004">Before you set off on that big Alfresco Share customization project you've been dreaming of,</span></div>
<div style="position:absolute;left:56.69px;top:133.98px" class="cls_004"><span class="cls_004">it is important to ask yourself if the Alfresco Share is the right place for your</span></div>
<div style="position:absolute;left:56.69px;top:146.58px" class="cls_004"><span class="cls_004">customizations. The key consideration is how closely does your solution resemble the</span></div>
<div style="position:absolute;left:56.69px;top:159.18px" class="cls_004"><span class="cls_004">generic </span><span class="cls_022">“</span><span class="cls_004">document management</span><span class="cls_022">”</span><span class="cls_004"> use case? If the answer is that it is quite close such that the</span></div>
<div style="position:absolute;left:56.69px;top:172.61px" class="cls_004"><span class="cls_004">list of substantial customizations is fairly small, then proceed. SomeCo's internal rollout is a</span></div>
<div style="position:absolute;left:56.69px;top:185.21px" class="cls_004"><span class="cls_004">good example of this. So far, everything SomeCo is looking to do with Alfresco has been</span></div>
<div style="position:absolute;left:56.69px;top:197.81px" class="cls_004"><span class="cls_004">about managing documents. The customizations have been small tweaks aimed at</span></div>
<div style="position:absolute;left:56.69px;top:210.41px" class="cls_004"><span class="cls_004">streamlining certain tasks for the end users.</span></div>
<div style="position:absolute;left:56.69px;top:232.01px" class="cls_004"><span class="cls_004">However, if your solution is radically different from document management or is composed</span></div>
<div style="position:absolute;left:56.69px;top:244.61px" class="cls_004"><span class="cls_004">of several significant customizations, you should think twice about customizing Share.</span></div>
<div style="position:absolute;left:56.69px;top:257.21px" class="cls_004"><span class="cls_004">Instead, consider building a custom application loosely coupled to the repository through</span></div>
<div style="position:absolute;left:56.69px;top:269.81px" class="cls_004"><span class="cls_004">services. Here's why:</span></div>
<div style="position:absolute;left:104.69px;top:291.54px" class="cls_004"><span class="cls_004">At some point, it takes longer to customize Share to meet the requirements than it</span></div>
<div style="position:absolute;left:104.69px;top:304.14px" class="cls_004"><span class="cls_004">would have to build a custom solution on top of the repository. Solutions that</span></div>
<div style="position:absolute;left:104.69px;top:316.74px" class="cls_004"><span class="cls_004">stray too far from the </span><span class="cls_022">“</span><span class="cls_004">document management</span><span class="cls_022">”</span><span class="cls_004"> use case end up wasting a lot of</span></div>
<div style="position:absolute;left:104.69px;top:330.17px" class="cls_004"><span class="cls_004">development effort removing or hiding Alfresco's out of the box features.</span></div>
<div style="position:absolute;left:104.69px;top:344.93px" class="cls_004"><span class="cls_004">Numerous and/or significant customizations present a heavy maintenance and</span></div>
<div style="position:absolute;left:104.69px;top:357.53px" class="cls_004"><span class="cls_004">upgrade burden, even when you stick to Alfresco's extension mechanism. As the</span></div>
<div style="position:absolute;left:104.69px;top:370.13px" class="cls_004"><span class="cls_004">number and complexity of the customizations increase, make sure what's left of</span></div>
<div style="position:absolute;left:104.69px;top:382.73px" class="cls_004"><span class="cls_004">the web client after you've customized it still adds enough value to compensate</span></div>
<div style="position:absolute;left:104.69px;top:395.33px" class="cls_004"><span class="cls_004">for the costs and overhead.</span></div>
<div style="position:absolute;left:104.69px;top:410.09px" class="cls_004"><span class="cls_004">If your solution could work without Alfresco Share, why lock yourself in? An n-</span></div>
<div style="position:absolute;left:104.69px;top:422.69px" class="cls_004"><span class="cls_004">tier solution leveraging Alfresco to provide </span><span class="cls_022">“</span><span class="cls_004">content as a service</span><span class="cls_022">”</span><span class="cls_004"> will be much</span></div>
<div style="position:absolute;left:104.69px;top:436.12px" class="cls_004"><span class="cls_004">more flexible in the long run.</span></div>
<div style="position:absolute;left:104.69px;top:450.88px" class="cls_004"><span class="cls_004">Alfresco controls the future direction of Share. You can certainly influence</span></div>
<div style="position:absolute;left:104.69px;top:463.48px" class="cls_004"><span class="cls_004">Alfresco's product road map to a much greater extent than you can with</span></div>
<div style="position:absolute;left:104.69px;top:476.08px" class="cls_004"><span class="cls_004">proprietary vendors. But Alfresco, the commercial software company, still has</span></div>
<div style="position:absolute;left:104.69px;top:488.68px" class="cls_004"><span class="cls_004">ultimate control over Alfresco, the product. If you make significant investments</span></div>
<div style="position:absolute;left:104.69px;top:501.28px" class="cls_004"><span class="cls_004">in a solution based on a customized Share, you are risking future migration costs</span></div>
<div style="position:absolute;left:104.69px;top:513.88px" class="cls_004"><span class="cls_004">if and when Alfresco decides to change how Share is built.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 172 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:126412px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background188.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.51px" class="cls_004"><span class="cls_004">All of this can be summarized with the old adage, </span><span class="cls_022">“</span><span class="cls_012">Use the right tool for the right job</span><span class="cls_022">“</span><span class="cls_004">. If the</span></div>
<div style="position:absolute;left:56.69px;top:83.94px" class="cls_004"><span class="cls_004">customizations you are making seem natural and in line with how Share is </span><span class="cls_022">“</span><span class="cls_004">supposed</span><span class="cls_022">”</span><span class="cls_004"> to be</span></div>
<div style="position:absolute;left:56.69px;top:97.37px" class="cls_004"><span class="cls_004">used, you are using the right tool for the right job. If, however, you are constantly </span><span class="cls_022">“</span><span class="cls_004">fighting</span><span class="cls_022">”</span></div>
<div style="position:absolute;left:56.69px;top:110.80px" class="cls_004"><span class="cls_004">with Share features or metaphors, you may be pushing Share beyond what it was originally</span></div>
<div style="position:absolute;left:56.69px;top:123.40px" class="cls_004"><span class="cls_004">intended for. This may cause issues for you down the line.</span></div>
<div style="position:absolute;left:56.69px;top:162.15px" class="cls_008"><span class="cls_008">Adding new menu items</span></div>
<div style="position:absolute;left:56.69px;top:189.88px" class="cls_004"><span class="cls_004">Probably the simplest form of UI customization is adding new menu item in the header. In</span></div>
<div style="position:absolute;left:56.69px;top:202.48px" class="cls_004"><span class="cls_004">our use case, we'll add external URL.</span></div>
<div style="position:absolute;left:56.69px;top:239.17px" class="cls_014"><span class="cls_014">Step-by-step - adding a simple menu item</span></div>
<div style="position:absolute;left:56.69px;top:264.40px" class="cls_004"><span class="cls_004">Suppose SomeCo wanted to add a set of links to the Alfresco user interface. In this case,</span></div>
<div style="position:absolute;left:56.69px;top:277.00px" class="cls_004"><span class="cls_004">Alfresco Share is using the Aikauto display the header of the page. If you want to modify it,</span></div>
<div style="position:absolute;left:56.69px;top:289.60px" class="cls_004"><span class="cls_004">you'll need to use Aikau (and not Surf). To know where Aikau is used in Alfresco Share,</span></div>
<div style="position:absolute;left:56.69px;top:302.20px" class="cls_004"><span class="cls_004">you can check the following page</span></div>
<div style="position:absolute;left:56.69px;top:314.80px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/aikau-intro.html">http://docs.alfresco.com/5.1/concepts/aikau-intro.html</a> <span class="cls_004"> and scroll to the section</span></div>
<div style="position:absolute;left:56.69px;top:327.78px" class="cls_012"><span class="cls_012">Aikau use in Share</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:349.38px" class="cls_004"><span class="cls_004">Let's discover a bit more about Aikau. The main goal of the Aikau framework is to provide</span></div>
<div style="position:absolute;left:56.69px;top:361.98px" class="cls_004"><span class="cls_004">a library of widgets that can be re-used and assembled into a web application. Aikau won't</span></div>
<div style="position:absolute;left:56.69px;top:374.58px" class="cls_004"><span class="cls_004">replace Alfresco Share, but will be used more and more to move from its original Surf</span></div>
<div style="position:absolute;left:56.69px;top:387.18px" class="cls_004"><span class="cls_004">implementation. The main objectives of Aikau are:</span></div>
<div style="position:absolute;left:104.69px;top:408.91px" class="cls_004"><span class="cls_004">Maximize code re-use</span></div>
<div style="position:absolute;left:104.69px;top:423.67px" class="cls_004"><span class="cls_004">Build user interfaces faster</span></div>
<div style="position:absolute;left:104.69px;top:438.43px" class="cls_004"><span class="cls_004">Simplify greatly the customization of page</span></div>
<div style="position:absolute;left:56.69px;top:462.32px" class="cls_004"><span class="cls_004">Don't believe that Aikau and Surf are completely decoupled. For example, an Aikau page is</span></div>
<div style="position:absolute;left:56.69px;top:474.92px" class="cls_004"><span class="cls_004">based on the Surf framework but it makes the composition of the page easier than pure Surf</span></div>
<div style="position:absolute;left:56.69px;top:487.52px" class="cls_004"><span class="cls_004">pages. However, as explained in the previous section, this book will mainly cover the Surf</span></div>
<div style="position:absolute;left:56.69px;top:500.12px" class="cls_004"><span class="cls_004">framework. If you are more interested by Aikau, the Alfresco documentation explains how</span></div>
<div style="position:absolute;left:56.69px;top:512.72px" class="cls_004"><span class="cls_004">to create menus, pages, dashlets and widgets using the Aikau framework on this page</span></div>
<div style="position:absolute;left:56.69px;top:524.64px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-extension-points-introduction.html">http://docs.alfresco.com/5.1/concepts/dev-extensions-share-extension-points-int</a> </div>
<div style="position:absolute;left:56.69px;top:536.12px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-extension-points-introduction.html">roduction.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 173 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:127088px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background189.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Before starting the development, let's dig in the Surf Extension process which is the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">preferred way to customize Alfresco Share. If you open the Alfresco Share deployed web</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">application, and if you look at the folder </span><span class="cls_007">WEB-INF|classes|alfresco</span><span class="cls_004">, you should find a lot</span></div>
<div style="position:absolute;left:56.69px;top:108.34px" class="cls_004"><span class="cls_004">of files ending by -config.xml, such as share-config.xml. These files contain configuration</span></div>
<div style="position:absolute;left:56.69px;top:120.94px" class="cls_004"><span class="cls_004">that are loaded into a Spring bean and used by Alfresco Share to define many aspects of its</span></div>
<div style="position:absolute;left:56.69px;top:133.54px" class="cls_004"><span class="cls_004">behavior. If you want to change this behavior, you won't update this file directly in the web</span></div>
<div style="position:absolute;left:56.69px;top:146.14px" class="cls_004"><span class="cls_004">application. You'll create a file called share-config-custom.xml that we'll introduce later in</span></div>
<div style="position:absolute;left:56.69px;top:158.74px" class="cls_004"><span class="cls_004">this chapter. This file will override the default configuration. Unfortunately, there is no easy</span></div>
<div style="position:absolute;left:56.69px;top:171.34px" class="cls_004"><span class="cls_004">way to modify this file if you don't have access to the server. Moreover, it's not really easy</span></div>
<div style="position:absolute;left:56.69px;top:183.94px" class="cls_004"><span class="cls_004">to split the configuration in different unites, name them, and version them. It's why Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:196.55px" class="cls_004"><span class="cls_004">Share integrates the concept of </span><span class="cls_012">Spring Surf Extension Modules</span><span class="cls_004">. They enable dynamic control</span></div>
<div style="position:absolute;left:56.69px;top:209.15px" class="cls_004"><span class="cls_004">of the Share configuration at runtime. These modules can be deployed and un-deployed</span></div>
<div style="position:absolute;left:56.69px;top:221.75px" class="cls_004"><span class="cls_004">without restarting the server (but it will need a server restart if you install a new</span></div>
<div style="position:absolute;left:56.69px;top:234.35px" class="cls_004"><span class="cls_004">module).Instead of having everything in one long share-config-custom.xml file,</span></div>
<div style="position:absolute;left:56.69px;top:246.95px" class="cls_004"><span class="cls_004">configuration can now be named and kept in different modules so it is easy for an</span></div>
<div style="position:absolute;left:56.69px;top:259.55px" class="cls_004"><span class="cls_004">Administrator to deploy and un-deploy different configuration settings at runtime. We'll</span></div>
<div style="position:absolute;left:56.69px;top:272.15px" class="cls_004"><span class="cls_004">start by creating a new extension module file.</span></div>
<div style="position:absolute;left:91.32px;top:293.88px" class="cls_004"><span class="cls_004">1. First, we need to create an Aikau extension module file. Create a new file called</span></div>
<div style="position:absolute;left:104.69px;top:306.48px" class="cls_013"><span class="cls_013">someco-header.xml</span><span class="cls_004"> in the directory where all extensions are defined</span></div>
<div style="position:absolute;left:104.69px;top:319.76px" class="cls_007"><span class="cls_007">src|main|amp|config|alfresco|web-extension|site-data|extensions</span><span class="cls_004"> located in</span></div>
<div style="position:absolute;left:104.69px;top:332.39px" class="cls_004"><span class="cls_004">the </span><span class="cls_013">share</span><span class="cls_004"> project.</span></div>
<div style="position:absolute;left:117.89px;top:356.28px" class="cls_010"><span class="cls_010">&lt;extension&gt;</span></div>
<div style="position:absolute;left:128.69px;top:367.08px" class="cls_010"><span class="cls_010">&lt;modules&gt;</span></div>
<div style="position:absolute;left:139.49px;top:377.88px" class="cls_010"><span class="cls_010">&lt;module&gt;</span></div>
<div style="position:absolute;left:150.29px;top:388.68px" class="cls_010"><span class="cls_010">&lt;id&gt; Add SomeCo links to header&lt;/id&gt;</span></div>
<div style="position:absolute;left:150.29px;top:399.48px" class="cls_010"><span class="cls_010">&lt;version&gt;1.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:150.29px;top:410.28px" class="cls_010"><span class="cls_010">&lt;auto-deploy&gt;true&lt;/auto-deploy&gt;</span></div>
<div style="position:absolute;left:150.29px;top:421.08px" class="cls_010"><span class="cls_010">&lt;customizations&gt;</span></div>
<div style="position:absolute;left:161.09px;top:431.88px" class="cls_010"><span class="cls_010">&lt;customization&gt;</span></div>
<div style="position:absolute;left:74.69px;top:453.48px" class="cls_010"><span class="cls_010">&lt;targetPackageRoot&gt;org.alfresco.share.header&lt;/targetPackageRoot&gt;</span></div>
<div style="position:absolute;left:171.89px;top:464.28px" class="cls_010"><span class="cls_010">&lt;sourcePackageRoot&gt;com.someco.header&lt;/sourcePackageRoot&gt;</span></div>
<div style="position:absolute;left:161.09px;top:475.08px" class="cls_010"><span class="cls_010">&lt;/customization&gt;</span></div>
<div style="position:absolute;left:150.29px;top:485.88px" class="cls_010"><span class="cls_010">&lt;/customizations&gt;</span></div>
<div style="position:absolute;left:139.49px;top:496.68px" class="cls_010"><span class="cls_010">&lt;/module&gt;</span></div>
<div style="position:absolute;left:128.69px;top:507.48px" class="cls_010"><span class="cls_010">&lt;/modules&gt;</span></div>
<div style="position:absolute;left:117.89px;top:518.28px" class="cls_010"><span class="cls_010">&lt;/extension&gt;</span></div>
<div style="position:absolute;left:91.32px;top:538.89px" class="cls_004"><span class="cls_004">2. As you can see, we configured the module to auto deploy. It means that you</span></div>
<div style="position:absolute;left:104.69px;top:551.49px" class="cls_004"><span class="cls_004">won't have to deploy it manually using the following page</span></div>
<div style="position:absolute;left:104.69px;top:564.09px" class="cls_013"><span class="cls_013">http://localhost:8080/share/page/modules/deploy</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 174 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:127764px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background190.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. If you check the customizations section, we ask Share to look for customizations</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">in the folder </span><span class="cls_007">com|someco|header</span><span class="cls_004">, when awebscript located in the folder</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_007"><span class="cls_007">org|alfresco|share|header</span><span class="cls_004"> is called. What does it really mean? If you open the</span></div>
<div style="position:absolute;left:104.69px;top:108.38px" class="cls_004"><span class="cls_004">Share web application, and look into the folder </span><span class="cls_007">WEB-INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:104.69px;top:121.01px" class="cls_007"><span class="cls_007">webscripts|org|alfresco|share|header</span><span class="cls_004">, you'll find files starting by share-header.</span></div>
<div style="position:absolute;left:104.69px;top:133.65px" class="cls_004"><span class="cls_004">These files represent a web script that is called to render the Share header. What</span></div>
<div style="position:absolute;left:104.69px;top:146.25px" class="cls_004"><span class="cls_004">we need to do is to customize this webscript. To summarize, this extension</span></div>
<div style="position:absolute;left:104.69px;top:158.85px" class="cls_004"><span class="cls_004">mechanism is used to extend any webscriptin Alfresco Share. So, you can hook</span></div>
<div style="position:absolute;left:104.69px;top:171.45px" class="cls_004"><span class="cls_004">into the model object and modify it. Don't worry if it's not clear, it will be clarified</span></div>
<div style="position:absolute;left:104.69px;top:184.05px" class="cls_004"><span class="cls_004">in the following steps.</span></div>
<div style="position:absolute;left:91.32px;top:198.81px" class="cls_004"><span class="cls_004">4. Then, we need to create the directories </span><span class="cls_007">com|someco|header</span><span class="cls_004"> (related to the tag</span></div>
<div style="position:absolute;left:104.69px;top:211.45px" class="cls_004"><span class="cls_004">sourcePackageRoot in the previous step) in the folder</span></div>
<div style="position:absolute;left:104.69px;top:224.05px" class="cls_007"><span class="cls_007">src|main|amp|config|alfresco|web-extension|site-webscripts</span><span class="cls_004">. As you can see,</span></div>
<div style="position:absolute;left:104.69px;top:236.68px" class="cls_004"><span class="cls_004">we are using the web-extension folder that is used to extend Alfresco Share. And</span></div>
<div style="position:absolute;left:104.69px;top:249.28px" class="cls_004"><span class="cls_004">the sub-folder site-webscripts because we want to override the default header</span></div>
<div style="position:absolute;left:104.69px;top:261.88px" class="cls_004"><span class="cls_004">webscript in Alfresco Share (we are mimicking the structure in the Share web</span></div>
<div style="position:absolute;left:104.69px;top:274.48px" class="cls_004"><span class="cls_004">application). Then, create the web script controller called share-header.get.js in</span></div>
<div style="position:absolute;left:104.69px;top:287.08px" class="cls_004"><span class="cls_004">this newly created folder. We just need to override the controller, and we want to</span></div>
<div style="position:absolute;left:104.69px;top:299.68px" class="cls_004"><span class="cls_004">keep all other artifacts unchanged. The first step is to retrieve the object</span></div>
<div style="position:absolute;left:104.69px;top:312.28px" class="cls_004"><span class="cls_004">representing the menu bar:</span></div>
<div style="position:absolute;left:117.89px;top:335.49px" class="cls_010"><span class="cls_010">var headerMenu = widgetUtils.findObject(model.jsonModel, "id",</span></div>
<div style="position:absolute;left:123.29px;top:346.30px" class="cls_010"><span class="cls_010">"HEADER_APP_MENU_BAR");</span></div>
<div style="position:absolute;left:117.89px;top:357.10px" class="cls_010"><span class="cls_010">if (headerMenu != null) {</span></div>
<div style="position:absolute;left:128.69px;top:367.89px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:117.89px;top:378.70px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:399.30px" class="cls_004"><span class="cls_004">5. You have different way to find the widget id </span><span class="cls_013">HEADER_APP_MENU_BAR</span><span class="cls_004">. The first</span></div>
<div style="position:absolute;left:104.69px;top:412.58px" class="cls_004"><span class="cls_004">way is to look at the source code. If you look at the </span><span class="cls_013">file WEB-</span></div>
<div style="position:absolute;left:104.69px;top:425.08px" class="cls_013"><span class="cls_013">INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:104.69px;top:437.86px" class="cls_013"><span class="cls_013">webscripts|org|alfresco|share|header|share-header.get.js</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:104.69px;top:451.14px" class="cls_004"><span class="cls_004">Share web application, you should find two important information. The first one</span></div>
<div style="position:absolute;left:104.69px;top:463.74px" class="cls_004"><span class="cls_004">is that the list of widgets is computed by a function called </span><span class="cls_013">getHeaderModel</span><span class="cls_004"> not</span></div>
<div style="position:absolute;left:104.69px;top:477.02px" class="cls_004"><span class="cls_004">present in this file.</span></div>
<div style="position:absolute;left:117.89px;top:500.23px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:511.03px" class="cls_010"><span class="cls_010">id: "SHARE_VERTICAL_LAYOUT",</span></div>
<div style="position:absolute;left:128.69px;top:521.83px" class="cls_010"><span class="cls_010">name: "alfresco/layout/VerticalWidgets",</span></div>
<div style="position:absolute;left:117.89px;top:532.63px" class="cls_010"><span class="cls_010">config:</span></div>
<div style="position:absolute;left:128.69px;top:543.43px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:554.23px" class="cls_010"><span class="cls_010">widgets: getHeaderModel()</span></div>
<div style="position:absolute;left:128.69px;top:565.03px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:575.83px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 175 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:128440px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background191.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. And at the top of the file, you can see that an external Javascript file is imported:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">&lt;import resource="classpath:/alfresco/site-webscripts</span></div>
<div style="position:absolute;left:128.69px;top:104.51px" class="cls_010"><span class="cls_010">/org/alfresco/share/imports/share-header.lib.js"&gt;</span></div>
<div style="position:absolute;left:91.32px;top:125.12px" class="cls_004"><span class="cls_004">7. If you open the file listed above </span><span class="cls_013">WEB-INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:104.69px;top:138.40px" class="cls_013"><span class="cls_013">webscripts|org|alfresco|share|imports|share-header.lib.js</span><span class="cls_004">, you</span></div>
<div style="position:absolute;left:104.69px;top:151.68px" class="cls_004"><span class="cls_004">can find the function </span><span class="cls_013">getHeaderModel</span><span class="cls_004">, that contains a variable called</span></div>
<div style="position:absolute;left:104.69px;top:164.96px" class="cls_013"><span class="cls_013">headerModel</span><span class="cls_004">, and you can finally see the following widget:</span></div>
<div style="position:absolute;left:139.49px;top:188.85px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:134.09px;top:199.65px" class="cls_010"><span class="cls_010">id: "HEADER_APP_MENU_BAR",</span></div>
<div style="position:absolute;left:134.09px;top:210.45px" class="cls_010"><span class="cls_010">name: "alfresco/header/AlfMenuBar",</span></div>
<div style="position:absolute;left:134.09px;top:221.25px" class="cls_010"><span class="cls_010">align: "left",</span></div>
<div style="position:absolute;left:128.69px;top:232.05px" class="cls_010"><span class="cls_010">config: {</span></div>
<div style="position:absolute;left:144.89px;top:242.85px" class="cls_010"><span class="cls_010">widgets: headerMenus.appItems</span></div>
<div style="position:absolute;left:134.09px;top:253.65px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:264.45px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:285.06px" class="cls_004"><span class="cls_004">8. Another option is to use the debugger mode of your browser, and you should</span></div>
<div style="position:absolute;left:104.69px;top:297.66px" class="cls_004"><span class="cls_004">find the </span><span class="cls_013">widgetId</span><span class="cls_004"> on the HTML tag:</span></div>
<div style="position:absolute;left:117.89px;top:321.55px" class="cls_010"><span class="cls_010">&lt;div class="alfresco-menus-AlfMenuBar"</span></div>
<div style="position:absolute;left:128.69px;top:332.35px" class="cls_010"><span class="cls_010">data-dojo-attach-point="containerNode"</span></div>
<div style="position:absolute;left:128.69px;top:343.15px" class="cls_010"><span class="cls_010">id="HEADER_APP_MENU_BAR"</span></div>
<div style="position:absolute;left:134.09px;top:353.95px" class="cls_010"><span class="cls_010">widgetid="HEADER_APP_MENU_BAR"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:375.55px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:91.32px;top:396.16px" class="cls_004"><span class="cls_004">9. Then, we can define our new dropdown including three links:</span></div>
<div style="position:absolute;left:117.89px;top:419.37px" class="cls_010"><span class="cls_010">headerMenu.config.widgets.push({</span></div>
<div style="position:absolute;left:117.89px;top:430.17px" class="cls_010"><span class="cls_010">id : "HEADER_SOMECO_LINKS",</span></div>
<div style="position:absolute;left:117.89px;top:440.97px" class="cls_010"><span class="cls_010">name : "alfresco/header/AlfMenuBarPopup",</span></div>
<div style="position:absolute;left:117.89px;top:451.77px" class="cls_010"><span class="cls_010">config : {</span></div>
<div style="position:absolute;left:117.89px;top:462.57px" class="cls_010"><span class="cls_010">id : "HEADER_SOMECO_LINKS",</span></div>
<div style="position:absolute;left:117.89px;top:473.37px" class="cls_010"><span class="cls_010">label : "SomeCo Links",</span></div>
<div style="position:absolute;left:117.89px;top:484.17px" class="cls_010"><span class="cls_010">widgets : [ {</span></div>
<div style="position:absolute;left:134.09px;top:494.97px" class="cls_010"><span class="cls_010">id : "HEADER_SOMECO_LINKS_GROUP",</span></div>
<div style="position:absolute;left:134.09px;top:505.77px" class="cls_010"><span class="cls_010">name : "alfresco/menus/AlfMenuGroup",</span></div>
<div style="position:absolute;left:134.09px;top:516.57px" class="cls_010"><span class="cls_010">config : {</span></div>
<div style="position:absolute;left:134.09px;top:527.37px" class="cls_010"><span class="cls_010">widgets : [ {</span></div>
<div style="position:absolute;left:166.49px;top:538.17px" class="cls_010"><span class="cls_010">id : "HEADER_SOMECO_LINKS_CORPORATE",</span></div>
<div style="position:absolute;left:166.49px;top:548.97px" class="cls_010"><span class="cls_010">name : "alfresco/header/AlfMenuItem",</span></div>
<div style="position:absolute;left:166.49px;top:559.77px" class="cls_010"><span class="cls_010">config : {</span></div>
<div style="position:absolute;left:166.49px;top:570.57px" class="cls_010"><span class="cls_010">label : "Corporate Website",</span></div>
<div style="position:absolute;left:166.49px;top:581.37px" class="cls_010"><span class="cls_010">targetUrl : "</span><a href="http://www.alfresco.com/" "="">http://www.alfresco.com"</a>,</div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 176 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:129116px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background192.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:166.49px;top:69.82px" class="cls_010"><span class="cls_010">targetUrlType : "FULL_PATH",</span></div>
<div style="position:absolute;left:166.49px;top:80.62px" class="cls_010"><span class="cls_010">targetUrlLocation : "NEW"</span></div>
<div style="position:absolute;left:166.49px;top:91.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:144.89px;top:102.22px" class="cls_010"><span class="cls_010">}, {</span></div>
<div style="position:absolute;left:166.49px;top:113.02px" class="cls_010"><span class="cls_010">id : "HEADER_SOMECO_LINKS_SEARCHENGINE",</span></div>
<div style="position:absolute;left:166.49px;top:123.82px" class="cls_010"><span class="cls_010">name : "alfresco/header/AlfMenuItem",</span></div>
<div style="position:absolute;left:166.49px;top:134.62px" class="cls_010"><span class="cls_010">config : {</span></div>
<div style="position:absolute;left:166.49px;top:145.42px" class="cls_010"><span class="cls_010">label : "Google",</span></div>
<div style="position:absolute;left:166.49px;top:156.22px" class="cls_010"><span class="cls_010">targetUrl : "</span><a href="http://www.google.com/" "="">http://www.google.com"</a>,</div>
<div style="position:absolute;left:166.49px;top:167.02px" class="cls_010"><span class="cls_010">targetUrlType : "FULL_PATH",</span></div>
<div style="position:absolute;left:166.49px;top:177.82px" class="cls_010"><span class="cls_010">targetUrlLocation : "NEW"</span></div>
<div style="position:absolute;left:166.49px;top:188.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:144.89px;top:199.42px" class="cls_010"><span class="cls_010">}, {</span></div>
<div style="position:absolute;left:166.49px;top:210.22px" class="cls_010"><span class="cls_010">id : "HEADER_SOMECO_LINKS_DOCUMENTATION",</span></div>
<div style="position:absolute;left:166.49px;top:221.02px" class="cls_010"><span class="cls_010">name : "alfresco/header/AlfMenuItem",</span></div>
<div style="position:absolute;left:166.49px;top:231.82px" class="cls_010"><span class="cls_010">config : {</span></div>
<div style="position:absolute;left:166.49px;top:242.62px" class="cls_010"><span class="cls_010">label : "Alfresco Documentation",</span></div>
<div style="position:absolute;left:166.49px;top:253.42px" class="cls_010"><span class="cls_010">targetUrl : "</span><a href="http://docs.alfresco.com/" "="">http://docs.alfresco.com"</a>,</div>
<div style="position:absolute;left:166.49px;top:264.22px" class="cls_010"><span class="cls_010">targetUrlType : "FULL_PATH",</span></div>
<div style="position:absolute;left:166.49px;top:275.02px" class="cls_010"><span class="cls_010">targetUrlLocation : "NEW"</span></div>
<div style="position:absolute;left:166.49px;top:285.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:144.89px;top:296.62px" class="cls_010"><span class="cls_010">} ]</span></div>
<div style="position:absolute;left:134.09px;top:307.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:318.22px" class="cls_010"><span class="cls_010">} ]</span></div>
<div style="position:absolute;left:117.89px;top:329.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:339.82px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:86.07px;top:371.23px" class="cls_004"><span class="cls_004">10. All that we do in this step is to extend a JSON model that we retrieved in the</span></div>
<div style="position:absolute;left:104.69px;top:383.83px" class="cls_004"><span class="cls_004">previous step using the object widgetUtils. Our JSON object is first defining a</span></div>
<div style="position:absolute;left:104.69px;top:396.43px" class="cls_004"><span class="cls_004">menu bar popup (alfresco/header/AlfMenuBarPopup), that contains a menu</span></div>
<div style="position:absolute;left:104.69px;top:409.03px" class="cls_004"><span class="cls_004">group (alfresco/menus/AlfMenuGroup), that contains itself three menu items</span></div>
<div style="position:absolute;left:104.69px;top:421.63px" class="cls_004"><span class="cls_004">(alfresco/header/AlfMenuItem). You may wonder which properties you can use</span></div>
<div style="position:absolute;left:104.69px;top:434.23px" class="cls_004"><span class="cls_004">on each item. You can look at the Alfresco Share source code to find the</span></div>
<div style="position:absolute;left:104.69px;top:446.83px" class="cls_004"><span class="cls_004">inspiration. But, you can look at the Aikau Widgets documentation</span></div>
<div style="position:absolute;left:104.69px;top:459.43px" class="cls_010"><span class="cls_010"> </span><a href="https://dev.alfresco.com/resource/docs/aikau-jsdoc">https://dev.alfresco.com/resource/docs/aikau-jsdoc</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:474.57px" class="cls_004"><span class="cls_004">11. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:56.69px;top:498.46px" class="cls_004"><span class="cls_004">You should now be able to log in and see the different links in the header:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 177 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:129792px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background193.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Adding new action items</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">In the previous example, we just added some generic links in the header but there was no</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">repository action behind that. In the previous chapter, we created some repository actions</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">and we had to use some tricks to be able to test them. And now, in this section, we'll explain</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">how to add a UI action related to the web flag on documents.</span></div>
<div style="position:absolute;left:56.69px;top:171.88px" class="cls_014"><span class="cls_014">Step-by-step - adding an action item to set the</span></div>
<div style="position:absolute;left:56.69px;top:193.48px" class="cls_014"><span class="cls_014">web flag</span></div>
<div style="position:absolute;left:56.69px;top:218.70px" class="cls_004"><span class="cls_004">Recall that a subset of SomeCo's Whitepapers will be available on the Web. Whitepapers</span></div>
<div style="position:absolute;left:56.69px;top:231.30px" class="cls_004"><span class="cls_004">that need to be published to the Web are identified by the </span><span class="cls_013">sc:webable</span><span class="cls_004"> aspect, which</span></div>
<div style="position:absolute;left:56.69px;top:244.58px" class="cls_004"><span class="cls_004">contains an </span><span class="cls_013">isActive</span><span class="cls_004"> flag. SomeCo employees can add or remove a Whitepaper to or from</span></div>
<div style="position:absolute;left:56.69px;top:257.86px" class="cls_004"><span class="cls_004">the Web by setting the flag to true or false. But SomeCo doesn't want just anybody to be</span></div>
<div style="position:absolute;left:56.69px;top:270.46px" class="cls_004"><span class="cls_004">able to set that flag. Alfresco doesn't have field-level security out of the box. So how can this</span></div>
<div style="position:absolute;left:56.69px;top:283.06px" class="cls_004"><span class="cls_004">be implemented?</span></div>
<div style="position:absolute;left:56.69px;top:304.66px" class="cls_004"><span class="cls_004">One way to do this is to configure the property to be read-only in the interface and then use</span></div>
<div style="position:absolute;left:56.69px;top:317.26px" class="cls_004"><span class="cls_004">two actions, available only to the people who need it, to enable or disable this flag.</span></div>
<div style="position:absolute;left:56.69px;top:338.86px" class="cls_004"><span class="cls_004">Let's do just that and let's start by Alfresco Share. All following changes will be done in the</span></div>
<div style="position:absolute;left:56.69px;top:351.46px" class="cls_004"><span class="cls_004">share project.</span></div>
<div style="position:absolute;left:91.32px;top:373.19px" class="cls_004"><span class="cls_004">1. First, we need to create a new </span><span class="cls_013">config</span><span class="cls_004"> element in the </span><span class="cls_013">share-config-</span></div>
<div style="position:absolute;left:104.69px;top:386.47px" class="cls_013"><span class="cls_013">custom.xml</span><span class="cls_004"> file (located in </span><span class="cls_013">share|src|main|resources|META-INF</span><span class="cls_004">)with the</span></div>
<div style="position:absolute;left:104.69px;top:399.75px" class="cls_004"><span class="cls_004">condition attribute equals to </span><span class="cls_013">DocLibActions</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:423.64px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare" condition="DocLibActions"&gt;</span></div>
<div style="position:absolute;left:80.09px;top:434.44px" class="cls_010"><span class="cls_010">&lt;actions&gt;</span></div>
<div style="position:absolute;left:96.29px;top:445.24px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:80.09px;top:456.04px" class="cls_010"><span class="cls_010">&lt;/actions&gt;</span></div>
<div style="position:absolute;left:74.69px;top:466.84px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:74.69px;top:477.64px" class="cls_010"><span class="cls_010">We could have packaged that in a Surf Extension Module to be able to</span></div>
<div style="position:absolute;left:74.69px;top:488.44px" class="cls_010"><span class="cls_010">enable/disable these actions. And it's highly recommended to do it in a</span></div>
<div style="position:absolute;left:74.69px;top:499.24px" class="cls_010"><span class="cls_010">real life project. But to keep this section short and simple enough, we'll</span></div>
<div style="position:absolute;left:74.69px;top:510.04px" class="cls_010"><span class="cls_010">define directly the configuration in this file. However, if you want to</span></div>
<div style="position:absolute;left:74.69px;top:520.84px" class="cls_010"><span class="cls_010">create an extension instead. Just move the config element from the share-</span></div>
<div style="position:absolute;left:74.69px;top:531.64px" class="cls_010"><span class="cls_010">config-custom.xml file, to a new XML file that you'll store in</span></div>
<div style="position:absolute;left:74.69px;top:542.44px" class="cls_010"><span class="cls_010">src|main|amp|config|alfresco|web-extension|site-data|extensions.</span></div>
<div style="position:absolute;left:74.69px;top:553.24px" class="cls_010"><span class="cls_010">&lt;extension&gt;</span></div>
<div style="position:absolute;left:96.29px;top:564.04px" class="cls_010"><span class="cls_010">&lt;modules&gt;</span></div>
<div style="position:absolute;left:117.89px;top:574.84px" class="cls_010"><span class="cls_010">&lt;module&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 178 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:130468px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background194.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">&lt;id&gt;Add SomeCo Document Library Actions&lt;/id&gt;</span></div>
<div style="position:absolute;left:139.49px;top:80.62px" class="cls_010"><span class="cls_010">&lt;version&gt;1.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">&lt;auto-deploy&gt;true&lt;/auto-deploy&gt;</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">&lt;configurations&gt;</span></div>
<div style="position:absolute;left:161.09px;top:113.02px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:161.09px;top:123.82px" class="cls_010"><span class="cls_010">condition="DocLibActions"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:134.62px" class="cls_010"><span class="cls_010">&lt;actions&gt;</span></div>
<div style="position:absolute;left:204.29px;top:145.42px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:182.69px;top:156.22px" class="cls_010"><span class="cls_010">&lt;/actions&gt;</span></div>
<div style="position:absolute;left:161.09px;top:167.02px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:139.49px;top:177.82px" class="cls_010"><span class="cls_010">&lt;/configurations&gt;</span></div>
<div style="position:absolute;left:117.89px;top:188.62px" class="cls_010"><span class="cls_010">&lt;/module&gt;</span></div>
<div style="position:absolute;left:96.29px;top:199.42px" class="cls_010"><span class="cls_010">&lt;/modules&gt;</span></div>
<div style="position:absolute;left:74.69px;top:210.22px" class="cls_010"><span class="cls_010">&lt;/extension&gt;</span></div>
<div style="position:absolute;left:91.32px;top:230.83px" class="cls_004"><span class="cls_004">2. Then, we define the two actions using the type javascript. Other type exists like</span></div>
<div style="position:absolute;left:104.69px;top:243.43px" class="cls_004"><span class="cls_004">link or pagelink. Using the out-of-the-box Javascript handler</span></div>
<div style="position:absolute;left:104.69px;top:256.03px" class="cls_004"><span class="cls_004">onActionSimpleRepoAction, we just need to provide the identifier of the action</span></div>
<div style="position:absolute;left:104.69px;top:268.63px" class="cls_004"><span class="cls_004">within Alfresco. If we need to collect parameters from the user, we'll need to use</span></div>
<div style="position:absolute;left:104.69px;top:281.23px" class="cls_004"><span class="cls_004">the handler onActionFormDialog.</span></div>
<div style="position:absolute;left:74.69px;top:304.44px" class="cls_010"><span class="cls_010">&lt;action id="someco-web-enable" type="javascript" label="actions.someco-web-</span></div>
<div style="position:absolute;left:74.69px;top:315.24px" class="cls_010"><span class="cls_010">enable" icon="someco-web-enable"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:326.04px" class="cls_010"><span class="cls_010">&lt;param name="function"&gt;onActionSimpleRepoAction&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:336.84px" class="cls_010"><span class="cls_010">&lt;param name="action"&gt;set-web-flag&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:347.64px" class="cls_010"><span class="cls_010">&lt;param name="active"&gt;true&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:358.44px" class="cls_010"><span class="cls_010">&lt;param name="successMessage"&gt;message.web-flag.enabled&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:369.24px" class="cls_010"><span class="cls_010">&lt;param name="failureMessage"&gt;message.web-flag.failure&lt;/param&gt;</span></div>
<div style="position:absolute;left:74.69px;top:380.04px" class="cls_010"><span class="cls_010">&lt;/action&gt;</span></div>
<div style="position:absolute;left:74.69px;top:390.84px" class="cls_010"><span class="cls_010">&lt;action id="someco-web-disable" type="javascript" label="actions.someco-</span></div>
<div style="position:absolute;left:74.69px;top:401.64px" class="cls_010"><span class="cls_010">web-disable" icon="someco-web-disable"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:412.44px" class="cls_010"><span class="cls_010">&lt;param name="function"&gt;onActionSimpleRepoAction&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:423.24px" class="cls_010"><span class="cls_010">&lt;param name="action"&gt;set-web-flag&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:434.04px" class="cls_010"><span class="cls_010">&lt;param name="active"&gt;false&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:444.84px" class="cls_010"><span class="cls_010">&lt;param name="successMessage"&gt;message.web-flag.disabled&lt;/param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:455.64px" class="cls_010"><span class="cls_010">&lt;param name="failureMessage"&gt;message.web-flag.failure&lt;/param&gt;</span></div>
<div style="position:absolute;left:74.69px;top:466.44px" class="cls_010"><span class="cls_010">&lt;/action&gt;</span></div>
<div style="position:absolute;left:91.32px;top:487.05px" class="cls_004"><span class="cls_004">3. You can find the available list of parameters on this page </span><a href="http://docs.alfresco.com/5.1/tasks/dev-extensions-share-tutorials-add-action-doclib.html">http://docs.alfresco</a> </div>
<div style="position:absolute;left:104.69px;top:499.35px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/dev-extensions-share-tutorials-add-action-doclib.html">.com/5.1/tasks/dev-extensions-share-tutorials-add-action-doclib.html</a> </div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 179 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:131144px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background195.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. In the same config element, define that you want to display these two actions in</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">the browse and details pages:</span></div>
<div style="position:absolute;left:74.69px;top:106.31px" class="cls_010"><span class="cls_010">&lt;actionGroups&gt;</span></div>
<div style="position:absolute;left:96.29px;top:117.11px" class="cls_010"><span class="cls_010">&lt;actionGroup id="document-browse"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:127.91px" class="cls_010"><span class="cls_010">&lt;action index="400" id="someco-web-enable" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:138.71px" class="cls_010"><span class="cls_010">&lt;action index="400" id="someco-web-disable" /&gt;</span></div>
<div style="position:absolute;left:96.29px;top:149.51px" class="cls_010"><span class="cls_010">&lt;/actionGroup&gt;</span></div>
<div style="position:absolute;left:96.29px;top:160.31px" class="cls_010"><span class="cls_010">&lt;actionGroup id="document-details"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:171.11px" class="cls_010"><span class="cls_010">&lt;action index="400" id="someco-web-enable" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:181.91px" class="cls_010"><span class="cls_010">&lt;action index="400" id="someco-web-disable" /&gt;</span></div>
<div style="position:absolute;left:96.29px;top:192.71px" class="cls_010"><span class="cls_010">&lt;/actionGroup&gt;</span></div>
<div style="position:absolute;left:74.69px;top:203.51px" class="cls_010"><span class="cls_010">&lt;/actionGroups&gt;</span></div>
<div style="position:absolute;left:91.32px;top:224.12px" class="cls_004"><span class="cls_004">5. The index property is used to order the list of actions. If you look at the</span></div>
<div style="position:absolute;left:104.69px;top:236.72px" class="cls_004"><span class="cls_004">corresponding config element in the file </span><span class="cls_013">WEB-INF|classes|alfresco|share-</span></div>
<div style="position:absolute;left:104.69px;top:250.00px" class="cls_013"><span class="cls_013">documentlibrary-config.xml</span><span class="cls_004">, you'll see the index of all out-of-the-box</span></div>
<div style="position:absolute;left:104.69px;top:263.28px" class="cls_004"><span class="cls_004">actions.</span></div>
<div style="position:absolute;left:91.32px;top:278.04px" class="cls_004"><span class="cls_004">6. Edit the file </span><span class="cls_013">share.properties</span><span class="cls_004"> to define the different messages:</span></div>
<div style="position:absolute;left:74.69px;top:301.93px" class="cls_010"><span class="cls_010">actions.someco-web-enable=SC Enable Web Flag</span></div>
<div style="position:absolute;left:74.69px;top:312.73px" class="cls_010"><span class="cls_010">actions.someco-web-disable=SC Disable Web Flag</span></div>
<div style="position:absolute;left:74.69px;top:323.53px" class="cls_010"><span class="cls_010">message.web-flag.enabled=Successfully enabled the SomeCo active flag</span></div>
<div style="position:absolute;left:74.69px;top:334.33px" class="cls_010"><span class="cls_010">message.web-flag.disabled=Successfully disabled the SomeCo active flag</span></div>
<div style="position:absolute;left:74.69px;top:345.13px" class="cls_010"><span class="cls_010">message.web-flag.failure=Error setting the SomeCo Web Flag</span></div>
<div style="position:absolute;left:91.32px;top:365.74px" class="cls_004"><span class="cls_004">7. The two first lines defines the name of the action in Alfresco Share. The naming</span></div>
<div style="position:absolute;left:104.69px;top:378.34px" class="cls_004"><span class="cls_004">convention is easy to guess; it looks like that:</span></div>
<div style="position:absolute;left:74.69px;top:401.55px" class="cls_010"><span class="cls_010">actions.&lt;ACTIONID&gt;=...</span></div>
<div style="position:absolute;left:91.32px;top:422.16px" class="cls_004"><span class="cls_004">8. For the three last lines, we just re-use the keys that we defined in the step 2.</span></div>
<div style="position:absolute;left:91.32px;top:436.92px" class="cls_004"><span class="cls_004">9. The last step is to add the icons. Create the directory</span></div>
<div style="position:absolute;left:104.69px;top:449.52px" class="cls_013"><span class="cls_013">components|documentlibrary|actions</span><span class="cls_004">(to deploy our icons in the same</span></div>
<div style="position:absolute;left:104.69px;top:462.80px" class="cls_004"><span class="cls_004">folder as all other Alfresco Share ones) within the folder </span><span class="cls_013">src|main|amp|web</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:476.09px" class="cls_004"><span class="cls_004">Within this folder, create two icons called </span><span class="cls_012">someco-web-enable-16.png</span><span class="cls_004"> and </span><span class="cls_012">someco-</span></div>
<div style="position:absolute;left:104.69px;top:488.69px" class="cls_012"><span class="cls_012">web-disable-16.png</span><span class="cls_004">.Be careful about the filename. As you easily understand, the</span></div>
<div style="position:absolute;left:104.69px;top:501.29px" class="cls_004"><span class="cls_004">filename must follow this convention:</span></div>
<div style="position:absolute;left:74.69px;top:524.50px" class="cls_010"><span class="cls_010">&lt;ACTIONID&gt;-16.png</span></div>
<div style="position:absolute;left:86.07px;top:545.11px" class="cls_004"><span class="cls_004">10. These icons have to be 16px square icons.</span></div>
<div style="position:absolute;left:86.07px;top:559.87px" class="cls_004"><span class="cls_004">11. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 180 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:131820px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background196.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To test this, log in to Alfresco Share. On both the list of actions in the document list page</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">and the details page, you should see the two new actions. By clicking on it, the sc:active tag</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">should be updated automatically.</span></div>
<div style="position:absolute;left:56.69px;top:272.72px" class="cls_004"><span class="cls_004">On the following screenshot, you can see how actions are displayed on the document detail</span></div>
<div style="position:absolute;left:56.69px;top:285.32px" class="cls_004"><span class="cls_004">page.</span></div>
<div style="position:absolute;left:56.69px;top:546.34px" class="cls_004"><span class="cls_004">You can notice that these two actions are available to everyone and to all documents in the</span></div>
<div style="position:absolute;left:56.69px;top:558.94px" class="cls_004"><span class="cls_004">Alfresco repository. In the next section, we'll create some evaluator to display only these</span></div>
<div style="position:absolute;left:56.69px;top:571.54px" class="cls_004"><span class="cls_004">actions in relevant cases.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 181 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:132496px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background197.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Restricting the action item by permission</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">For the next steps, you'll need to use another user than admin. By default, Alfresco contains</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">another user called </span><span class="cls_013">abeecher</span><span class="cls_004"> but is disabled by default. Use the </span><span class="cls_007">Admin Tools</span><span class="cls_004"> section to re-</span></div>
<div style="position:absolute;left:56.69px;top:120.86px" class="cls_004"><span class="cls_004">enable </span><span class="cls_013">abeecher</span><span class="cls_004"> and pick your own password. If you login using this new username, you</span></div>
<div style="position:absolute;left:56.69px;top:134.14px" class="cls_004"><span class="cls_004">can search for the </span><span class="cls_007">Marketing</span><span class="cls_004"> site (if you keep the default visibility </span><span class="cls_007">Public</span><span class="cls_004">) and join it. This</span></div>
<div style="position:absolute;left:56.69px;top:146.78px" class="cls_004"><span class="cls_004">user becomes </span><span class="cls_007">Consumer</span><span class="cls_004"> of the site and has only read-only permissions on documents. If</span></div>
<div style="position:absolute;left:56.69px;top:159.42px" class="cls_004"><span class="cls_004">you try to click on the two action items created previously, you should get an error. It's</span></div>
<div style="position:absolute;left:56.69px;top:172.02px" class="cls_004"><span class="cls_004">because thisuser has not been granted at least </span><span class="cls_022">“</span><span class="cls_004">write</span><span class="cls_022">”</span><span class="cls_004"> permission on the test Whitepaper.</span></div>
<div style="position:absolute;left:56.69px;top:194.45px" class="cls_004"><span class="cls_004">For each action item in the actions tag, add the following permission configuration:</span></div>
<div style="position:absolute;left:74.69px;top:215.37px" class="cls_010"><span class="cls_010">&lt;permissions&gt;</span></div>
<div style="position:absolute;left:96.29px;top:226.17px" class="cls_010"><span class="cls_010">&lt;permission allow="true"&gt;Write&lt;/permission&gt;</span></div>
<div style="position:absolute;left:74.69px;top:236.97px" class="cls_010"><span class="cls_010">&lt;/permissions&gt;</span></div>
<div style="position:absolute;left:56.69px;top:257.45px" class="cls_004"><span class="cls_004">If you re-deploy, you'll notice that the user </span><span class="cls_013">abeecher</span><span class="cls_004"> can't see anymore these two actions,</span></div>
<div style="position:absolute;left:56.69px;top:270.73px" class="cls_004"><span class="cls_004">but they are still visible for the admin user.</span></div>
<div style="position:absolute;left:122.09px;top:292.33px" class="cls_004"><span class="cls_004">The permission elements that are part of the action's definition in </span><span class="cls_013">share-</span></div>
<div style="position:absolute;left:122.09px;top:305.61px" class="cls_013"><span class="cls_013">config-custom.xml</span><span class="cls_004"> can use any of the permission groups Alfresco</span></div>
<div style="position:absolute;left:122.09px;top:318.88px" class="cls_004"><span class="cls_004">knows about. In this case you specified </span><span class="cls_013">Write</span><span class="cls_004">, which is a lower-level</span></div>
<div style="position:absolute;left:122.09px;top:332.16px" class="cls_004"><span class="cls_004">permission group. But you could also specify one of the higher-level</span></div>
<div style="position:absolute;left:122.09px;top:344.76px" class="cls_004"><span class="cls_004">groups such as </span><span class="cls_013">Coordinator</span><span class="cls_004"> if it makes sense to do so for your solution.</span></div>
<div style="position:absolute;left:122.09px;top:358.04px" class="cls_004"><span class="cls_004">See the Appendix for information on the out of the box permission groups.</span></div>
<div style="position:absolute;left:56.69px;top:396.79px" class="cls_008"><span class="cls_008">Writing action evaluators to show/hide UI</span></div>
<div style="position:absolute;left:56.69px;top:420.79px" class="cls_008"><span class="cls_008">actions</span></div>
<div style="position:absolute;left:56.69px;top:448.52px" class="cls_004"><span class="cls_004">In the previous example, you set up two action items to enable and disable the </span><span class="cls_013">isActive</span></div>
<div style="position:absolute;left:56.69px;top:461.80px" class="cls_004"><span class="cls_004">flag for a webable piece of content. The actions only show up if a user has the appropriate</span></div>
<div style="position:absolute;left:56.69px;top:474.40px" class="cls_004"><span class="cls_004">permissions. But what if SomeCo wants to give several different people or groups </span><span class="cls_013">Write</span></div>
<div style="position:absolute;left:56.69px;top:487.68px" class="cls_004"><span class="cls_004">permission, but only wants a subset of those folks to be able to publish documents to the</span></div>
<div style="position:absolute;left:56.69px;top:500.28px" class="cls_004"><span class="cls_004">Web? Not only that, but isn't it a bit sloppy to show the </span><span class="cls_007">Enable</span><span class="cls_004"> link when the </span><span class="cls_013">isActive</span></div>
<div style="position:absolute;left:56.69px;top:513.56px" class="cls_004"><span class="cls_004">flag is already set to </span><span class="cls_007">True</span><span class="cls_004"> (and </span><span class="cls_007">Disable</span><span class="cls_004"> when it is already set to </span><span class="cls_007">False</span><span class="cls_004">)?</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 182 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:133172px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background198.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Both of these issues are easily addressed using Spring beans and out-of-the-box Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">Share evaluators. Evaluators are used to control if an action item should be displayed or</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">not. If you don't find what you need in the standard evaluators, you can as well create your</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">own evaluator coded in Java (more information here </span><a href="http://docs.alfresco.com/5.1/tasks/dev-extensions-share-tutorials-custom-evaluator.html">http://docs.alfresco.com/5.1/tas</a> </div>
<div style="position:absolute;left:56.69px;top:121.28px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/dev-extensions-share-tutorials-custom-evaluator.html">ks/dev-extensions-share-tutorials-custom-evaluator.html</a> <span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:158.36px" class="cls_014"><span class="cls_014">Step-by-step - evaluating whether or not to show</span></div>
<div style="position:absolute;left:56.69px;top:179.96px" class="cls_014"><span class="cls_014">the set web flag actions</span></div>
<div style="position:absolute;left:56.69px;top:205.18px" class="cls_004"><span class="cls_004">SomeCo wants to create a group called </span><span class="cls_022">“</span><span class="cls_004">SomeCo'sPublisher</span><span class="cls_022">”</span><span class="cls_004"> and populate it with the</span></div>
<div style="position:absolute;left:56.69px;top:218.61px" class="cls_004"><span class="cls_004">people and groups allowed to click the </span><span class="cls_007">Enable</span><span class="cls_004"> and </span><span class="cls_007">Disable</span><span class="cls_004"> Actions created in the previous</span></div>
<div style="position:absolute;left:56.69px;top:231.25px" class="cls_004"><span class="cls_004">example. Additionally, if the flag is set to </span><span class="cls_007">True</span><span class="cls_004">, the </span><span class="cls_007">Enable</span><span class="cls_004"> Action should not be displayed.</span></div>
<div style="position:absolute;left:56.69px;top:243.89px" class="cls_004"><span class="cls_004">If the flag is set to </span><span class="cls_007">False</span><span class="cls_004">, the </span><span class="cls_007">Disable</span><span class="cls_004"> Action should not be displayed. Finally, these actions</span></div>
<div style="position:absolute;left:56.69px;top:256.52px" class="cls_004"><span class="cls_004">should be available only for Whitepapers having the </span><span class="cls_013">sc:webable</span><span class="cls_004"> aspect.</span></div>
<div style="position:absolute;left:56.69px;top:278.80px" class="cls_004"><span class="cls_004">To make this happen, you are going to create someevaluators represented as Spring beans.</span></div>
<div style="position:absolute;left:56.69px;top:291.40px" class="cls_004"><span class="cls_004">And then you'll use them in the file </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:313.68px" class="cls_004"><span class="cls_004">Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:335.41px" class="cls_004"><span class="cls_004">1. Edit the file </span><span class="cls_013">share-slingshot-application-context.xml</span><span class="cls_004">in the directory</span></div>
<div style="position:absolute;left:104.69px;top:348.69px" class="cls_004"><span class="cls_004">src|main|amp|config|alfresco|web-extension. This file contains all Spring beans</span></div>
<div style="position:absolute;left:104.69px;top:361.29px" class="cls_004"><span class="cls_004">evaluator. Add our first evaluator that checks if the user is member of the group</span></div>
<div style="position:absolute;left:104.69px;top:373.89px" class="cls_004"><span class="cls_004">SomecoPublisher.</span></div>
<div style="position:absolute;left:74.69px;top:397.10px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoPublisher"</span></div>
<div style="position:absolute;left:74.69px;top:407.90px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.groupMembership"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:418.70px" class="cls_010"><span class="cls_010">&lt;property name="groups"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:429.50px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:440.30px" class="cls_010"><span class="cls_010">&lt;value&gt;GROUP_SomecoPublisher&lt;/value&gt;</span></div>
<div style="position:absolute;left:117.89px;top:451.10px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:96.29px;top:461.90px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:472.70px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:493.31px" class="cls_004"><span class="cls_004">2. For the identifier of the bean, you are free to use the one that you want. But it's</span></div>
<div style="position:absolute;left:104.69px;top:505.91px" class="cls_004"><span class="cls_004">good to keep the same rules and starts them by </span><span class="cls_013">evaluator.doclib.action</span><span class="cls_004"> if</span></div>
<div style="position:absolute;left:104.69px;top:519.19px" class="cls_004"><span class="cls_004">it's an evaluator for an action. About the parent field, you can't guess it but you</span></div>
<div style="position:absolute;left:104.69px;top:531.79px" class="cls_004"><span class="cls_004">can find all available predefined evaluators here </span><a href="http://docs.alfresco.com/5.1/concepts/doclib-predefined-evaluators-reference.html">http://docs.alfresco.com/5.</a> </div>
<div style="position:absolute;left:104.69px;top:544.77px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/doclib-predefined-evaluators-reference.html">1/concepts/doclib-predefined-evaluators-reference.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 183 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:133848px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background199.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Add the evaluator that checks the content type:</span></div>
<div style="position:absolute;left:74.69px;top:93.71px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoWhitepaper"</span></div>
<div style="position:absolute;left:74.69px;top:104.51px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.nodeType"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:115.31px" class="cls_010"><span class="cls_010">&lt;property name="types"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:126.11px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:136.91px" class="cls_010"><span class="cls_010">&lt;value&gt;sc:whitepaper&lt;/value&gt;</span></div>
<div style="position:absolute;left:117.89px;top:147.71px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:96.29px;top:158.51px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:169.31px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:189.92px" class="cls_004"><span class="cls_004">4. Add the evaluator that checks the aspect:</span></div>
<div style="position:absolute;left:74.69px;top:213.13px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoWebable"</span></div>
<div style="position:absolute;left:74.69px;top:223.93px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.hasAspect"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:234.73px" class="cls_010"><span class="cls_010">&lt;property name="aspects"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:245.53px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:256.33px" class="cls_010"><span class="cls_010">&lt;value&gt;sc:webable&lt;/value&gt;</span></div>
<div style="position:absolute;left:117.89px;top:267.13px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:96.29px;top:277.93px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:288.73px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:309.34px" class="cls_004"><span class="cls_004">5. Finally, we need to create the two evaluators that checks if the whitepaper is</span></div>
<div style="position:absolute;left:104.69px;top:321.94px" class="cls_004"><span class="cls_004">active or not. To simplify, we'll create the first evaluator that checks if the</span></div>
<div style="position:absolute;left:104.69px;top:334.54px" class="cls_004"><span class="cls_004">property sc:isActive is equal to true. The second evaluator will simply be the</span></div>
<div style="position:absolute;left:104.69px;top:347.14px" class="cls_004"><span class="cls_004">negation of the first one.</span></div>
<div style="position:absolute;left:74.69px;top:370.35px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoWebActive"</span></div>
<div style="position:absolute;left:74.69px;top:381.15px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.metadata.value"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:391.95px" class="cls_010"><span class="cls_010">&lt;property name="accessor" value="node.properties.sc:isActive" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:402.75px" class="cls_010"><span class="cls_010">&lt;property name="comparator"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:413.55px" class="cls_010"><span class="cls_010">&lt;bean</span></div>
<div style="position:absolute;left:74.69px;top:424.35px" class="cls_010"><span class="cls_010">class="org.alfresco.web.evaluator.StringEqualsComparator"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:435.15px" class="cls_010"><span class="cls_010">&lt;property name="value" value="true" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:445.95px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:456.75px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:467.55px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:74.69px;top:478.35px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoWebInactive"</span></div>
<div style="position:absolute;left:74.69px;top:489.15px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.isSomecoWebActive"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:499.95px" class="cls_010"><span class="cls_010">&lt;property name="negateOutput" value="true" /&gt;</span></div>
<div style="position:absolute;left:74.69px;top:510.75px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 184 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:134524px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background200.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. We just defined all atomic evaluators that we need. We just need to combine</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">them to properly displays the actions. For the action </span><span class="cls_007">SC Enable Web Flag</span><span class="cls_004">, we</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">want to enable this action on whitepapers having the sc:webable aspect that are</span></div>
<div style="position:absolute;left:104.69px;top:108.34px" class="cls_004"><span class="cls_004">not active yet for SomeCo's publisher. And we want all conditions fulfilled:</span></div>
<div style="position:absolute;left:74.69px;top:131.55px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoPublishable"</span></div>
<div style="position:absolute;left:74.69px;top:142.35px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.chainedMatchAll"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:153.15px" class="cls_010"><span class="cls_010">&lt;property name="evaluators"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:163.95px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:174.75px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoPublisher" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:185.55px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWhitepaper" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:196.35px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebable" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:207.15px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebInactive" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:217.95px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:96.29px;top:228.75px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:239.55px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:260.16px" class="cls_004"><span class="cls_004">7. For the action </span><span class="cls_007">SC Disable Web Flag</span><span class="cls_004">, we just need the same conditions except</span></div>
<div style="position:absolute;left:104.69px;top:272.80px" class="cls_004"><span class="cls_004">that the action will be available on active documents:</span></div>
<div style="position:absolute;left:74.69px;top:296.01px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoUnpublishable"</span></div>
<div style="position:absolute;left:74.69px;top:306.81px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.chainedMatchAll"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:317.61px" class="cls_010"><span class="cls_010">&lt;property name="evaluators"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:328.41px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:339.21px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoPublisher" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:350.01px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWhitepaper" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:360.81px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebable" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:371.61px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebActive" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:382.41px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:96.29px;top:393.21px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:404.01px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:424.62px" class="cls_004"><span class="cls_004">8. We are ready to re-use our evaluators in our Share configuration. Edit the file</span></div>
<div style="position:absolute;left:104.69px;top:437.22px" class="cls_004"><span class="cls_004">share-config-custom.xml and update the two actions that we already defined</span></div>
<div style="position:absolute;left:104.69px;top:449.82px" class="cls_004"><span class="cls_004">previously:</span></div>
<div style="position:absolute;left:74.69px;top:473.03px" class="cls_010"><span class="cls_010">&lt;action id="someco-web-enable" type="javascript" label="actions.someco-web-</span></div>
<div style="position:absolute;left:74.69px;top:483.83px" class="cls_010"><span class="cls_010">enable" icon="someco-web-enable"&gt;</span></div>
<div style="position:absolute;left:107.09px;top:494.63px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:96.29px;top:505.43px" class="cls_010"><span class="cls_010">&lt;evaluator&gt;</span></div>
<div style="position:absolute;left:117.89px;top:516.23px" class="cls_010"><span class="cls_010">evaluator.doclib.action.isSomecoPublishable</span></div>
<div style="position:absolute;left:96.29px;top:527.03px" class="cls_010"><span class="cls_010">&lt;/evaluator&gt;</span></div>
<div style="position:absolute;left:74.69px;top:537.83px" class="cls_010"><span class="cls_010">&lt;/action&gt;</span></div>
<div style="position:absolute;left:74.69px;top:548.63px" class="cls_010"><span class="cls_010">&lt;action id="someco-web-disable" type="javascript" label="actions.someco-</span></div>
<div style="position:absolute;left:74.69px;top:559.43px" class="cls_010"><span class="cls_010">web-disable" icon="someco-web-disable"&gt;</span></div>
<div style="position:absolute;left:107.09px;top:570.23px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:96.29px;top:581.03px" class="cls_010"><span class="cls_010">&lt;evaluator&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 185 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:135200px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background201.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">evaluator.doclib.action.isSomecoUnpublishable</span></div>
<div style="position:absolute;left:96.29px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/evaluator&gt;</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/action&gt;</span></div>
<div style="position:absolute;left:91.32px;top:112.03px" class="cls_004"><span class="cls_004">9. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:56.69px;top:135.92px" class="cls_004"><span class="cls_004">To test the new evaluator classes, log in as either admin or test user, and confirm that you</span></div>
<div style="position:absolute;left:56.69px;top:148.52px" class="cls_004"><span class="cls_004">cannot see either action. That means the group check is working because admin doesn't yet</span></div>
<div style="position:absolute;left:56.69px;top:161.12px" class="cls_004"><span class="cls_004">belong to the </span><span class="cls_022">“</span><span class="cls_004">Publisher</span><span class="cls_022">”</span><span class="cls_004"> group. Once you've confirmed that the group check is functional,</span></div>
<div style="position:absolute;left:56.69px;top:174.55px" class="cls_004"><span class="cls_004">you can create a group called </span><span class="cls_022">“</span><span class="cls_004">SomecoPublishers</span><span class="cls_022">”</span><span class="cls_004"> using the group identifier</span></div>
<div style="position:absolute;left:56.69px;top:187.98px" class="cls_022"><span class="cls_022">“</span><span class="cls_004">SomecoPublisher</span><span class="cls_022">”</span><span class="cls_004"> and assign both admin and your test user to the group. Only one action</span></div>
<div style="position:absolute;left:56.69px;top:201.41px" class="cls_004"><span class="cls_004">should be available, depending on the presence of the webable aspect and the value of the</span></div>
<div style="position:absolute;left:56.69px;top:214.01px" class="cls_013"><span class="cls_013">isActive</span><span class="cls_004"> flag. Note that you may need to re-login to be sure that the group evaluator is</span></div>
<div style="position:absolute;left:56.69px;top:227.29px" class="cls_004"><span class="cls_004">working as expected.</span></div>
<div style="position:absolute;left:56.69px;top:248.89px" class="cls_004"><span class="cls_004">Now you have a relatively secure way to control who can make a document publishable on</span></div>
<div style="position:absolute;left:56.69px;top:261.49px" class="cls_004"><span class="cls_004">SomeCo's website. It's only relatively secure because anyone with write access can still</span></div>
<div style="position:absolute;left:56.69px;top:274.09px" class="cls_004"><span class="cls_004">change that flag through the API. We could change our Java code in our repository action to</span></div>
<div style="position:absolute;left:56.69px;top:286.69px" class="cls_004"><span class="cls_004">add more checks and avoid this kind of issues.</span></div>
<div style="position:absolute;left:56.69px;top:308.29px" class="cls_004"><span class="cls_004">In addition to letting us secure the property, it gives publishers a quick way to set the</span></div>
<div style="position:absolute;left:56.69px;top:320.89px" class="cls_004"><span class="cls_004">publish status. They don't even have to edit the details. They can simply click on menu</span></div>
<div style="position:absolute;left:56.69px;top:333.49px" class="cls_004"><span class="cls_004">items.</span></div>
<div style="position:absolute;left:56.69px;top:355.09px" class="cls_004"><span class="cls_004">From a support perspective, it is also pretty clean:</span></div>
<div style="position:absolute;left:104.69px;top:376.82px" class="cls_004"><span class="cls_004">If someone decides that they want to be able to set the flag from a different place</span></div>
<div style="position:absolute;left:104.69px;top:389.42px" class="cls_004"><span class="cls_004">in the UI, the existing UI action can be mapped to a different action group.</span></div>
<div style="position:absolute;left:104.69px;top:404.18px" class="cls_004"><span class="cls_004">If SomeCo wants to change who can set the flag, they can simply add or remove</span></div>
<div style="position:absolute;left:104.69px;top:416.78px" class="cls_004"><span class="cls_004">users and groups to and from the </span><span class="cls_022">“</span><span class="cls_004">Publisher</span><span class="cls_022">”</span><span class="cls_004"> group.</span></div>
<div style="position:absolute;left:104.69px;top:432.37px" class="cls_004"><span class="cls_004">If the logic ever needs to change (suppose SomeCo wants to start tracking the</span></div>
<div style="position:absolute;left:104.69px;top:444.97px" class="cls_004"><span class="cls_004">date a piece of content was disabled for the Web instead of tracking only the</span></div>
<div style="position:absolute;left:104.69px;top:457.57px" class="cls_004"><span class="cls_004">publish date, for example), the code lives in one place: inside the rule action. The</span></div>
<div style="position:absolute;left:104.69px;top:470.17px" class="cls_004"><span class="cls_004">UI actions wouldn't have to be touched.</span></div>
<div style="position:absolute;left:56.69px;top:511.21px" class="cls_008"><span class="cls_008">Changing how Share renders forms</span></div>
<div style="position:absolute;left:56.69px;top:538.94px" class="cls_004"><span class="cls_004">The majority of the forms configuration are located in the share-config-custom.xml file.</span></div>
<div style="position:absolute;left:56.69px;top:551.54px" class="cls_004"><span class="cls_004">Alfresco provides form controls for most of the data types, but sometimes you want to</span></div>
<div style="position:absolute;left:56.69px;top:564.14px" class="cls_004"><span class="cls_004">customize it. A form control is implemented as a Freemarker template.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 186 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:135876px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background202.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Let's look at a couple of basic examples that can at least get you pointed in the right</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">direction. Suppose that SomeCo's Operations department wants to track status reports in</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">Alfresco. Status reports will be written as documents and uploaded to the Operations space.</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">Two properties will help the Operations team get a feel for the project's status:</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_013"><span class="cls_013">statusSummary</span><span class="cls_004"> will be a text property meant to capture a couple of sentences</span></div>
<div style="position:absolute;left:56.69px;top:134.18px" class="cls_004"><span class="cls_004">summarizing the status report, and </span><span class="cls_013">statusIndicator</span><span class="cls_004"> will be a single-value select box</span></div>
<div style="position:absolute;left:56.69px;top:147.46px" class="cls_004"><span class="cls_004">consisting of color-coded statuses that are </span><span class="cls_013">Red</span><span class="cls_004">, </span><span class="cls_013">Yellow</span><span class="cls_004">, or </span><span class="cls_013">Green</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:169.74px" class="cls_004"><span class="cls_004">Rather than creating a </span><span class="cls_022">“</span><span class="cls_004">status report</span><span class="cls_022">”</span><span class="cls_004"> type, you will model the two status-related properties</span></div>
<div style="position:absolute;left:56.69px;top:183.17px" class="cls_004"><span class="cls_004">as part of a </span><span class="cls_022">“</span><span class="cls_004">status-able</span><span class="cls_022">”</span><span class="cls_004"> aspect that will be applied as mandatory aspect on operational</span></div>
<div style="position:absolute;left:56.69px;top:196.60px" class="cls_004"><span class="cls_004">documents.</span></div>
<div style="position:absolute;left:56.69px;top:218.20px" class="cls_004"><span class="cls_004">You've done enough modeling and Share wiring by this point to know what to do if these</span></div>
<div style="position:absolute;left:56.69px;top:230.80px" class="cls_004"><span class="cls_004">were the only requirements. So let's make it interesting. First, the standard text field that</span></div>
<div style="position:absolute;left:56.69px;top:243.40px" class="cls_004"><span class="cls_004">Alfresco uses to edit text properties isn't going to be very usable for typing a two-sentence</span></div>
<div style="position:absolute;left:56.69px;top:256.00px" class="cls_004"><span class="cls_004">summary. Second, the head of the Operations team is a very visual person. He or she</span></div>
<div style="position:absolute;left:56.69px;top:268.60px" class="cls_004"><span class="cls_004">doesn't want to see the words </span><span class="cls_013">Red</span><span class="cls_004">, </span><span class="cls_013">Yellow</span><span class="cls_004">, or </span><span class="cls_013">Green</span><span class="cls_004"> to know a project's status, but wants</span></div>
<div style="position:absolute;left:56.69px;top:281.88px" class="cls_004"><span class="cls_004">to see a traffic light icon with the appropriate light lit up.</span></div>
<div style="position:absolute;left:56.69px;top:303.48px" class="cls_004"><span class="cls_004">Both of these can be addressed through XML and Freemarkerchanges. In the case of the text</span></div>
<div style="position:absolute;left:56.69px;top:316.08px" class="cls_004"><span class="cls_004">area, Alfresco has provided a text area form control that accepts row and column</span></div>
<div style="position:absolute;left:56.69px;top:328.68px" class="cls_004"><span class="cls_004">arguments. You just need to configure the web client to use it. To display a traffic light</span></div>
<div style="position:absolute;left:56.69px;top:341.28px" class="cls_004"><span class="cls_004">depending on a property value, you'll need to create a new form control and then tell the</span></div>
<div style="position:absolute;left:56.69px;top:353.88px" class="cls_004"><span class="cls_004">web client to use it.</span></div>
<div style="position:absolute;left:56.69px;top:390.58px" class="cls_014"><span class="cls_014">Step-by-step - using a text area field</span></div>
<div style="position:absolute;left:56.69px;top:415.80px" class="cls_004"><span class="cls_004">SomeCo wants to track a status summary and a status indicator for its project status reports.</span></div>
<div style="position:absolute;left:56.69px;top:428.40px" class="cls_004"><span class="cls_004">They want the </span><span class="cls_013">statusSummary</span><span class="cls_004"> property to be edited with a text area that is 50-columns</span></div>
<div style="position:absolute;left:56.69px;top:441.68px" class="cls_004"><span class="cls_004">wide and 5-rows tall. This will involve:</span></div>
<div style="position:absolute;left:91.32px;top:463.41px" class="cls_004"><span class="cls_004">1. Updating the model with a new status-able aspect that contains the status</span></div>
<div style="position:absolute;left:104.69px;top:476.01px" class="cls_004"><span class="cls_004">summary and status indicator properties</span></div>
<div style="position:absolute;left:91.32px;top:490.77px" class="cls_004"><span class="cls_004">2. Updating </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> with configuration settings that show the</span></div>
<div style="position:absolute;left:104.69px;top:504.05px" class="cls_004"><span class="cls_004">new aspect in the appropriate menus and identifying a new form control to use</span></div>
<div style="position:absolute;left:104.69px;top:516.65px" class="cls_004"><span class="cls_004">for the summary property</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 187 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:136552px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background203.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To make this happen, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:92.23px" class="cls_004"><span class="cls_004">1. Edit </span><span class="cls_007">repo|src|main|amp|config|alfresco|module|repo|model|scModel.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:104.87px" class="cls_004"><span class="cls_004">Add a new aspect as follows.</span></div>
<div style="position:absolute;left:117.89px;top:128.08px" class="cls_010"><span class="cls_010">&lt;aspect name="sc:statusable"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:138.88px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Status Tracking&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:149.68px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:150.29px;top:160.48px" class="cls_010"><span class="cls_010">&lt;property name="sc:statusIndicator"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:171.28px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:150.29px;top:182.08px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;true&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:150.29px;top:192.88px" class="cls_010"><span class="cls_010">&lt;default&gt;Green&lt;/default&gt;</span></div>
<div style="position:absolute;left:150.29px;top:203.68px" class="cls_010"><span class="cls_010">&lt;constraints&gt;</span></div>
<div style="position:absolute;left:161.09px;top:214.48px" class="cls_010"><span class="cls_010">&lt;constraint ref="sc:statusIndicatorList" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:225.28px" class="cls_010"><span class="cls_010">&lt;/constraints&gt;</span></div>
<div style="position:absolute;left:139.49px;top:236.08px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:246.88px" class="cls_010"><span class="cls_010">&lt;property name="sc:statusSummary"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:257.68px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:161.09px;top:268.48px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;true&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:139.49px;top:279.28px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:128.69px;top:290.08px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:117.89px;top:300.88px" class="cls_010"><span class="cls_010">&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:91.32px;top:321.49px" class="cls_004"><span class="cls_004">2. The aspect refers to the </span><span class="cls_013">LIST</span><span class="cls_004"> constraint that defines the possible values for the</span></div>
<div style="position:absolute;left:104.69px;top:334.77px" class="cls_004"><span class="cls_004">status indicator. Add the constraint definition to the existing </span><span class="cls_013">constraints</span></div>
<div style="position:absolute;left:104.69px;top:348.05px" class="cls_004"><span class="cls_004">element.</span></div>
<div style="position:absolute;left:112.49px;top:371.26px" class="cls_010"><span class="cls_010">&lt;constraint name="sc:statusIndicatorList" type="LIST"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:382.06px" class="cls_010"><span class="cls_010">&lt;parameter name="allowedValues"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:392.86px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:182.69px;top:403.66px" class="cls_010"><span class="cls_010">&lt;value&gt;Green&lt;/value&gt;</span></div>
<div style="position:absolute;left:182.69px;top:414.46px" class="cls_010"><span class="cls_010">&lt;value&gt;Yellow&lt;/value&gt;</span></div>
<div style="position:absolute;left:182.69px;top:425.26px" class="cls_010"><span class="cls_010">&lt;value&gt;Red&lt;/value&gt;</span></div>
<div style="position:absolute;left:161.09px;top:436.06px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:446.86px" class="cls_010"><span class="cls_010">&lt;/parameter&gt;</span></div>
<div style="position:absolute;left:117.89px;top:457.66px" class="cls_010"><span class="cls_010">&lt;/constraint&gt;</span></div>
<div style="position:absolute;left:91.32px;top:478.27px" class="cls_004"><span class="cls_004">3. Then the define our new aspect as mandatory aspect on our Operations</span></div>
<div style="position:absolute;left:104.69px;top:490.87px" class="cls_004"><span class="cls_004">document:</span></div>
<div style="position:absolute;left:117.89px;top:514.08px" class="cls_010"><span class="cls_010">&lt;type name="sc:opsDoc"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:524.88px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Operations Document&lt;/title&gt;</span></div>
<div style="position:absolute;left:161.09px;top:535.68px" class="cls_010"><span class="cls_010">&lt;parent&gt;sc:doc&lt;/parent&gt;</span></div>
<div style="position:absolute;left:161.09px;top:546.48px" class="cls_010"><span class="cls_010">&lt;mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:161.09px;top:557.28px" class="cls_010"><span class="cls_010">&lt;aspect&gt;sc:statusable&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:161.09px;top:568.08px" class="cls_010"><span class="cls_010">&lt;/mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:117.89px;top:578.88px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 188 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:137228px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background204.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Save and close the model file.</span></div>
<div style="position:absolute;left:91.32px;top:85.26px" class="cls_004"><span class="cls_004">5. Update the scModel.properties properties to add the I18N messages:</span></div>
<div style="position:absolute;left:117.89px;top:108.47px" class="cls_010"><span class="cls_010">sc_somecomodel.aspect.sc_statusable.title=Someco Status Tracking</span></div>
<div style="position:absolute;left:117.89px;top:119.27px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_statusIndicator.title=Status Indicator</span></div>
<div style="position:absolute;left:117.89px;top:130.07px" class="cls_010"><span class="cls_010">sc_somecomodel.property.sc_statusSummary.title=Status Summary</span></div>
<div style="position:absolute;left:91.32px;top:150.68px" class="cls_004"><span class="cls_004">6. Edit the fileshare-config-custom.xml</span><span class="cls_007"> located</span><span class="cls_004"> in the share project and find the</span></div>
<div style="position:absolute;left:104.69px;top:163.32px" class="cls_004"><span class="cls_004">config element with the evaluator attribute equals to node-type, and the</span></div>
<div style="position:absolute;left:104.69px;top:175.92px" class="cls_004"><span class="cls_004">condition attribute to sc:opsDoc. Add the two new fields in the list of visible</span></div>
<div style="position:absolute;left:104.69px;top:188.52px" class="cls_004"><span class="cls_004">fields. And, let's add an </span><span class="cls_013">appearance</span><span class="cls_004"> element to specify that we want to use the</span></div>
<div style="position:absolute;left:104.69px;top:201.80px" class="cls_004"><span class="cls_004">text area form control for the status summary.</span></div>
<div style="position:absolute;left:117.89px;top:225.01px" class="cls_010"><span class="cls_010">&lt;config evaluator="node-type" condition="sc:opsDoc"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:235.81px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:139.49px;top:246.61px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:150.29px;top:257.41px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:268.21px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:161.09px;top:279.01px" class="cls_010"><span class="cls_010">&lt;show id="sc:statusIndicator" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:289.81px" class="cls_010"><span class="cls_010">&lt;show id="sc:statusSummary" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:300.61px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:311.41px" class="cls_010"><span class="cls_010">&lt;appearance&gt;</span></div>
<div style="position:absolute;left:150.29px;top:322.21px" class="cls_010"><span class="cls_010">&lt;field id="sc:statusSummary"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:333.01px" class="cls_010"><span class="cls_010">&lt;control</span></div>
<div style="position:absolute;left:74.69px;top:343.81px" class="cls_010"><span class="cls_010">template="/org/alfresco/components/form/controls/textarea.ftl"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:354.61px" class="cls_010"><span class="cls_010">&lt;control-param name="rows"&gt;5&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:182.69px;top:365.41px" class="cls_010"><span class="cls_010">&lt;control-param name="columns"&gt;50&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:161.09px;top:376.21px" class="cls_010"><span class="cls_010">&lt;/control&gt;</span></div>
<div style="position:absolute;left:150.29px;top:387.01px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:150.29px;top:397.81px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:139.49px;top:408.61px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:128.69px;top:419.41px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:430.21px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:450.82px" class="cls_004"><span class="cls_004">7. You can find all control forms in your deployed Share web application in the</span></div>
<div style="position:absolute;left:104.69px;top:463.42px" class="cls_004"><span class="cls_004">folder WEB-INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:104.69px;top:476.02px" class="cls_004"><span class="cls_004">webscripts|org|alfresco|components|form|controls. For more details on how to</span></div>
<div style="position:absolute;left:104.69px;top:488.62px" class="cls_004"><span class="cls_004">configure them, you can check the following page: </span><a href="http://docs.alfresco.com/5.1/references/forms-reference.html">http://docs.alfresco.com</a> </div>
<div style="position:absolute;left:104.69px;top:501.60px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/references/forms-reference.html">/5.1/references/forms-reference.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:516.74px" class="cls_004"><span class="cls_004">8. Edit the share.properties file to externalize the aspect label.</span></div>
<div style="position:absolute;left:117.89px;top:539.95px" class="cls_010"><span class="cls_010">aspect.sc_statusable=Someco Status Tracking</span></div>
<div style="position:absolute;left:91.32px;top:560.56px" class="cls_004"><span class="cls_004">9. Package, deploy, restart, and test. Don't forget that you need to deploy both</span></div>
<div style="position:absolute;left:104.69px;top:573.16px" class="cls_004"><span class="cls_004">Alfresco and Share.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 189 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:137904px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background205.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To test this change, you first need to create a new site called </span><span class="cls_007">Operations</span><span class="cls_004">.Then, you need to</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">add a document to the </span><span class="cls_007">Document Library</span><span class="cls_004"> and change the type to </span><span class="cls_013">Someco Operations</span></div>
<div style="position:absolute;left:56.69px;top:96.42px" class="cls_013"><span class="cls_013">Document</span><span class="cls_004"> type. When you edit the properties, you should see that a text area of the size</span></div>
<div style="position:absolute;left:56.69px;top:109.70px" class="cls_004"><span class="cls_004">you specified is used for the </span><span class="cls_007">Summary</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:56.69px;top:459.35px" class="cls_014"><span class="cls_014">Step-by-step - changing the Status field on the</span></div>
<div style="position:absolute;left:56.69px;top:480.95px" class="cls_014"><span class="cls_014">Details page to display as a Stoplight indicator</span></div>
<div style="position:absolute;left:56.69px;top:506.18px" class="cls_004"><span class="cls_004">SomeCo wants to show a graphical representation of the status indicator. Alfresco is using</span></div>
<div style="position:absolute;left:56.69px;top:518.78px" class="cls_004"><span class="cls_004">the standard components for displaying and editing the status indicator property. The edit</span></div>
<div style="position:absolute;left:56.69px;top:531.38px" class="cls_004"><span class="cls_004">is fine the way it is, but the display needs to change to show a traffic light. This involves:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 190 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:138580px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background206.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Updating </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> to specify the form control for the status</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">indicator field</span></div>
<div style="position:absolute;left:104.69px;top:98.54px" class="cls_004"><span class="cls_004">Writing a new Freemarker file to implement the custom form control</span></div>
<div style="position:absolute;left:104.69px;top:113.30px" class="cls_004"><span class="cls_004">Finding or creating some traffic light icons</span></div>
<div style="position:absolute;left:56.69px;top:137.19px" class="cls_004"><span class="cls_004">Ready? Let's get started. Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:158.92px" class="cls_004"><span class="cls_004">1. Edit the file </span><span class="cls_007">share-config-custom.xml</span><span class="cls_004"> to specify that you want to use a custom</span></div>
<div style="position:absolute;left:104.69px;top:171.56px" class="cls_004"><span class="cls_004">template form control. We'll update the same config element as the previous</span></div>
<div style="position:absolute;left:104.69px;top:184.16px" class="cls_004"><span class="cls_004">section. We just need to add a new sub-element in the appearance element.</span></div>
<div style="position:absolute;left:74.69px;top:207.37px" class="cls_010"><span class="cls_010">&lt;field id="sc:statusIndicator"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:218.17px" class="cls_010"><span class="cls_010">&lt;control</span></div>
<div style="position:absolute;left:74.69px;top:228.97px" class="cls_010"><span class="cls_010">template="/com/someco/components/form/controls/trafficlight.ftl"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:239.77px" class="cls_010"><span class="cls_010">&lt;control-param name="otpions"&gt;Green,Yellow,Red&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:96.29px;top:250.57px" class="cls_010"><span class="cls_010">&lt;/control&gt;</span></div>
<div style="position:absolute;left:74.69px;top:261.37px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:91.32px;top:281.98px" class="cls_004"><span class="cls_004">2. This was the easy part! Now, we need to create the form control. Locate the</span></div>
<div style="position:absolute;left:104.69px;top:294.58px" class="cls_004"><span class="cls_004">directory </span><span class="cls_007">src|main|amp|config|alfresco|web-extension|site-webscripts</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:104.69px;top:307.22px" class="cls_004"><span class="cls_004">share project. Create the sub-directory </span><span class="cls_007">com|someco|components|form|controls</span></div>
<div style="position:absolute;left:104.69px;top:319.85px" class="cls_004"><span class="cls_004">if it doesn't exist yet. We are not going to start from the scratch. We'll duplicate</span></div>
<div style="position:absolute;left:104.69px;top:332.45px" class="cls_004"><span class="cls_004">the selectone.ftl form control existing in the share web application (if you don't</span></div>
<div style="position:absolute;left:104.69px;top:345.05px" class="cls_004"><span class="cls_004">remember, this file is stored in the folder </span><span class="cls_013">WEB-INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:104.69px;top:358.33px" class="cls_013"><span class="cls_013">webscripts|org|alfresco|components|form|controls</span><span class="cls_004">). Just copy this file</span></div>
<div style="position:absolute;left:104.69px;top:371.61px" class="cls_004"><span class="cls_004">in your project and rename it to trafficlight.ftl.</span></div>
<div style="position:absolute;left:91.32px;top:386.37px" class="cls_004"><span class="cls_004">3. You can notice that the form control manages the view and edit mode within the</span></div>
<div style="position:absolute;left:104.69px;top:398.97px" class="cls_004"><span class="cls_004">same file. In our case, we don't want to change the edit mode. We just want to</span></div>
<div style="position:absolute;left:104.69px;top:411.57px" class="cls_004"><span class="cls_004">display a traffic light in the view mode. Search for the following line:</span></div>
<div style="position:absolute;left:74.69px;top:434.78px" class="cls_010"><span class="cls_010">&lt;span class="viewmode-value"&gt;${valueToShow?html}&lt;/span&gt;</span></div>
<div style="position:absolute;left:91.32px;top:455.39px" class="cls_004"><span class="cls_004">4. And replace it by:</span></div>
<div style="position:absolute;left:74.69px;top:478.60px" class="cls_010"><span class="cls_010">&lt;span class="viewmode-value"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:489.40px" class="cls_010"><span class="cls_010">&lt;#if valueToShow == "Red"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:500.20px" class="cls_010"><span class="cls_010">&lt;imgsrc="${url.context}/res/components/form/images/trafficlight-</span></div>
<div style="position:absolute;left:74.69px;top:511.00px" class="cls_010"><span class="cls_010">red-32.png"</span></div>
<div style="position:absolute;left:117.89px;top:521.80px" class="cls_010"><span class="cls_010">&lt;#elseifvalueToShow == "Yellow"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:532.60px" class="cls_010"><span class="cls_010">&lt;imgsrc="${url.context}/res/components/form/images/trafficlight-</span></div>
<div style="position:absolute;left:74.69px;top:543.40px" class="cls_010"><span class="cls_010">yellow-32.png"</span></div>
<div style="position:absolute;left:117.89px;top:554.20px" class="cls_010"><span class="cls_010">&lt;#else&gt;</span></div>
<div style="position:absolute;left:117.89px;top:565.00px" class="cls_010"><span class="cls_010">&lt;imgsrc="${url.context}/res/components/form/images/trafficlight-</span></div>
<div style="position:absolute;left:74.69px;top:575.80px" class="cls_010"><span class="cls_010">green-32.png"</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 191 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:139256px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background207.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:96.29px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/#if&gt;</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/span&gt;</span></div>
<div style="position:absolute;left:91.32px;top:101.23px" class="cls_004"><span class="cls_004">5. The last step is to copy the traffic light images from the source code provided</span></div>
<div style="position:absolute;left:104.69px;top:113.83px" class="cls_004"><span class="cls_004">with this chapter into your </span><span class="cls_013">share</span><span class="cls_004"> project under</span></div>
<div style="position:absolute;left:104.69px;top:127.11px" class="cls_007"><span class="cls_007">src|main|amp|web|components|form|images</span><span class="cls_004">. We deploy these images to this</span></div>
<div style="position:absolute;left:104.69px;top:139.75px" class="cls_004"><span class="cls_004">folder, because we want to deploy in the folder </span><span class="cls_007">components|form|images</span><span class="cls_004"> when</span></div>
<div style="position:absolute;left:104.69px;top:152.39px" class="cls_004"><span class="cls_004">the AMP module will be installed.</span></div>
<div style="position:absolute;left:91.32px;top:167.15px" class="cls_004"><span class="cls_004">6. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:56.69px;top:191.04px" class="cls_004"><span class="cls_004">To test this, go take a look at the properties of the document you used to test the </span><span class="cls_007">Status</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:56.69px;top:203.67px" class="cls_007"><span class="cls_007">Summary</span><span class="cls_004"> in the previous example. Now, instead of a boring text string, the status is shown</span></div>
<div style="position:absolute;left:56.69px;top:216.31px" class="cls_004"><span class="cls_004">using a visually striking traffic light metaphor:</span></div>
<div style="position:absolute;left:56.69px;top:479.58px" class="cls_004"><span class="cls_004">If you edit the properties, Alfresco should use its default list-constrained, single-value text</span></div>
<div style="position:absolute;left:56.69px;top:492.18px" class="cls_004"><span class="cls_004">field component, which is a drop-down selection list.</span></div>
<div style="position:absolute;left:56.69px;top:513.78px" class="cls_004"><span class="cls_004">It is important to note that if you go back and remove the constraints from your model and</span></div>
<div style="position:absolute;left:56.69px;top:526.38px" class="cls_004"><span class="cls_004">try your test again, the component will still work. Of course, if the string you set for your</span></div>
<div style="position:absolute;left:56.69px;top:538.98px" class="cls_004"><span class="cls_004">status doesn't match any of the three colors, you won't see any traffic light.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 192 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:139932px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background208.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Overriding and customizing components</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">You should now have a basic idea of how you can tweak forms and form controls. If you</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">wanted to do something more complex-say for example you don't like the out of the box</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">multi-value select behavior-you can override it. The steps are similar to what you've seen so</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">far.</span></div>
<div style="position:absolute;left:56.69px;top:171.53px" class="cls_008"><span class="cls_008">How to use indicators</span></div>
<div style="position:absolute;left:56.69px;top:199.26px" class="cls_004"><span class="cls_004">The manager that asked to use traffic lights to have a quick understanding of the status</span></div>
<div style="position:absolute;left:56.69px;top:211.86px" class="cls_004"><span class="cls_004">complained that he/she has to click on each document to be able to see the status. To be</span></div>
<div style="position:absolute;left:56.69px;top:224.46px" class="cls_004"><span class="cls_004">more efficient, it seems that the indicator should be displayed directly in the document list.</span></div>
<div style="position:absolute;left:56.69px;top:237.06px" class="cls_004"><span class="cls_004">Hopefully, Alfresco provides the concept of indicators. A content in Alfresco can have one</span></div>
<div style="position:absolute;left:56.69px;top:249.66px" class="cls_004"><span class="cls_004">or more indicators and are used to reflect certain states. This will involve:</span></div>
<div style="position:absolute;left:91.32px;top:271.39px" class="cls_004"><span class="cls_004">1. Create three evaluators to be able to differentiate the different states</span></div>
<div style="position:absolute;left:91.32px;top:286.15px" class="cls_004"><span class="cls_004">2. Create three indicators for each possible state.</span></div>
<div style="position:absolute;left:56.69px;top:325.14px" class="cls_014"><span class="cls_014">Step-by-step - creating indicators for the status</span></div>
<div style="position:absolute;left:56.69px;top:346.74px" class="cls_014"><span class="cls_014">indicator</span></div>
<div style="position:absolute;left:91.32px;top:378.21px" class="cls_004"><span class="cls_004">1. The first step is to create indicators, as we do for the actions. Update the file</span></div>
<div style="position:absolute;left:104.69px;top:390.81px" class="cls_004"><span class="cls_004">share-slingshot-application-context.xml where you already created all indicators.</span></div>
<div style="position:absolute;left:104.69px;top:403.41px" class="cls_004"><span class="cls_004">We need to create one evaluator for each color of the traffic light:</span></div>
<div style="position:absolute;left:74.69px;top:426.62px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.statusIsGreen"</span></div>
<div style="position:absolute;left:74.69px;top:437.42px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.metadata.value"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:448.22px" class="cls_010"><span class="cls_010">&lt;property name="accessor" value="node.properties.sc:statusIndicator" /&gt;</span></div>
<div style="position:absolute;left:96.29px;top:459.02px" class="cls_010"><span class="cls_010">&lt;property name="comparator"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:469.82px" class="cls_010"><span class="cls_010">&lt;bean class="org.alfresco.web.evaluator.StringEqualsComparator"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:480.62px" class="cls_010"><span class="cls_010">&lt;property name="value" value="Green" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:491.42px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:96.29px;top:502.22px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:513.02px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:74.69px;top:523.82px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.statusIsYellow"</span></div>
<div style="position:absolute;left:74.69px;top:534.62px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.metadata.value"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:545.42px" class="cls_010"><span class="cls_010">&lt;property name="accessor" value="node.properties.sc:statusIndicator" /&gt;</span></div>
<div style="position:absolute;left:96.29px;top:556.22px" class="cls_010"><span class="cls_010">&lt;property name="comparator"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:567.02px" class="cls_010"><span class="cls_010">&lt;bean class="org.alfresco.web.evaluator.StringEqualsComparator"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:577.82px" class="cls_010"><span class="cls_010">&lt;property name="value" value="Yellow" /&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 193 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:140608px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background209.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:96.29px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:74.69px;top:102.22px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.statusIsRed"</span></div>
<div style="position:absolute;left:74.69px;top:113.02px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.metadata.value"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:123.82px" class="cls_010"><span class="cls_010">&lt;property name="accessor" value="node.properties.sc:statusIndicator" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:134.62px" class="cls_010"><span class="cls_010">&lt;property name="comparator"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">&lt;bean class="org.alfresco.web.evaluator.StringEqualsComparator"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:156.22px" class="cls_010"><span class="cls_010">&lt;property name="value" value="Red" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:167.02px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:188.62px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:209.23px" class="cls_004"><span class="cls_004">2. That's it. Now, we can update the same file as usual, </span><span class="cls_013">share-config-</span></div>
<div style="position:absolute;left:104.69px;top:222.51px" class="cls_013"><span class="cls_013">custom.xml</span><span class="cls_004">. Locate the config element with the condition attribute equals to</span></div>
<div style="position:absolute;left:104.69px;top:235.79px" class="cls_004"><span class="cls_004">DocumentLibrary and add these evaluators as sub-element.</span></div>
<div style="position:absolute;left:74.69px;top:259.00px" class="cls_010"><span class="cls_010">&lt;indicators&gt;</span></div>
<div style="position:absolute;left:96.29px;top:269.80px" class="cls_010"><span class="cls_010">&lt;indicator id="trafficlight-red" index="100"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:280.60px" class="cls_010"><span class="cls_010">&lt;evaluator&gt;evaluator.doclib.action.statusIsRed&lt;/evaluator&gt;</span></div>
<div style="position:absolute;left:96.29px;top:291.40px" class="cls_010"><span class="cls_010">&lt;/indicator&gt;</span></div>
<div style="position:absolute;left:96.29px;top:302.20px" class="cls_010"><span class="cls_010">&lt;indicator id="trafficlight-yellow" index="110"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:313.00px" class="cls_010"><span class="cls_010">&lt;evaluator&gt;evaluator.doclib.action.statusIsYellow&lt;/evaluator&gt;</span></div>
<div style="position:absolute;left:96.29px;top:323.80px" class="cls_010"><span class="cls_010">&lt;/indicator&gt;</span></div>
<div style="position:absolute;left:96.29px;top:334.60px" class="cls_010"><span class="cls_010">&lt;indicator id="trafficlight-green" index="120"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:345.40px" class="cls_010"><span class="cls_010">&lt;evaluator&gt;evaluator.doclib.action.statusIsGreen&lt;/evaluator&gt;</span></div>
<div style="position:absolute;left:96.29px;top:356.20px" class="cls_010"><span class="cls_010">&lt;/indicator&gt;</span></div>
<div style="position:absolute;left:74.69px;top:367.00px" class="cls_010"><span class="cls_010">&lt;/indicators&gt;</span></div>
<div style="position:absolute;left:56.69px;top:387.48px" class="cls_004"><span class="cls_004">As you'll easily understand, the index field is used to prioritize the displaying order of the</span></div>
<div style="position:absolute;left:56.69px;top:400.08px" class="cls_004"><span class="cls_004">indicators.</span></div>
<div style="position:absolute;left:56.69px;top:421.68px" class="cls_004"><span class="cls_004">Remember that all our Share customizations are implemented in the same share-config-</span></div>
<div style="position:absolute;left:56.69px;top:434.28px" class="cls_004"><span class="cls_004">custom.xml but you can easily make an extension module as described in the first examples</span></div>
<div style="position:absolute;left:56.69px;top:446.88px" class="cls_004"><span class="cls_004">of this chapter.</span></div>
<div style="position:absolute;left:91.32px;top:468.61px" class="cls_004"><span class="cls_004">1. The last step is to copy the traffic light images from the source code provided</span></div>
<div style="position:absolute;left:104.69px;top:481.21px" class="cls_004"><span class="cls_004">with this chapter into your share project under</span></div>
<div style="position:absolute;left:104.69px;top:493.81px" class="cls_007"><span class="cls_007">src|main|amp|web|components|documentlibrary|indicators</span><span class="cls_004">. By looking at</span></div>
<div style="position:absolute;left:104.69px;top:506.45px" class="cls_004"><span class="cls_004">the filenames, you'll easily guess the naming convention:</span></div>
<div style="position:absolute;left:74.69px;top:529.66px" class="cls_010"><span class="cls_010">&lt;INDICATOR ID&gt;-16.png</span></div>
<div style="position:absolute;left:74.69px;top:540.46px" class="cls_010"><span class="cls_010">&lt;INDICATOR ID&gt;-32.png</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 194 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:141284px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background210.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">Why do we need a 16px and 32px square icons? Because, depending of the</span></div>
<div style="position:absolute;left:124.19px;top:83.10px" class="cls_004"><span class="cls_004">view that you select in Alfresco Share, it won't use the same icon size.</span></div>
<div style="position:absolute;left:91.32px;top:104.83px" class="cls_004"><span class="cls_004">2. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:124.19px;top:128.72px" class="cls_004"><span class="cls_004">Now, you should be able to see a small traffic light next to each </span><span class="cls_007">SomeCo</span></div>
<div style="position:absolute;left:124.19px;top:141.36px" class="cls_007"><span class="cls_007">Operation Document</span><span class="cls_004"> in the </span><span class="cls_007">Document Library</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:56.69px;top:308.57px" class="cls_008"><span class="cls_008">How to create metadata template</span></div>
<div style="position:absolute;left:56.69px;top:336.30px" class="cls_004"><span class="cls_004">You just received a call from the same manager that works with the Operations document.</span></div>
<div style="position:absolute;left:56.69px;top:348.90px" class="cls_004"><span class="cls_004">The indicator is very useful; you can have a quick overview of the status of all documents.</span></div>
<div style="position:absolute;left:56.69px;top:361.50px" class="cls_004"><span class="cls_004">However, when the status is </span><span class="cls_007">Red</span><span class="cls_004">, the only way to get the status summary is to open the</span></div>
<div style="position:absolute;left:56.69px;top:374.13px" class="cls_004"><span class="cls_004">document details page. It would be very helpful if we can see the status summary directly</span></div>
<div style="position:absolute;left:56.69px;top:386.73px" class="cls_004"><span class="cls_004">in the document list. And this manger is proposing that we replace the documentation field,</span></div>
<div style="position:absolute;left:56.69px;top:399.33px" class="cls_004"><span class="cls_004">by the sc:statusSummaryfield. Hopefully again, Alfresco provides the concept of metadata</span></div>
<div style="position:absolute;left:56.69px;top:411.93px" class="cls_004"><span class="cls_004">template. You can define the list of metadata that you want to display depending of the</span></div>
<div style="position:absolute;left:56.69px;top:424.53px" class="cls_004"><span class="cls_004">content type.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 195 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:141960px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background211.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - create a metadata template for</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">Operations document</span></div>
<div style="position:absolute;left:56.69px;top:116.58px" class="cls_004"><span class="cls_004">This configuration may be the easiest one in this book. We decided that we'll remove the</span></div>
<div style="position:absolute;left:56.69px;top:129.18px" class="cls_004"><span class="cls_004">description line and we'll replace it with the status summary. We are lucky, we already</span></div>
<div style="position:absolute;left:56.69px;top:141.78px" class="cls_004"><span class="cls_004">created the evaluator used to identify if the document is an Operation document.</span></div>
<div style="position:absolute;left:91.32px;top:163.51px" class="cls_004"><span class="cls_004">1. This time, we are going to create an extension module to show you how it's</span></div>
<div style="position:absolute;left:104.69px;top:176.11px" class="cls_004"><span class="cls_004">possible. Just a reminder that we always have two ways to package Share</span></div>
<div style="position:absolute;left:104.69px;top:188.71px" class="cls_004"><span class="cls_004">customizations: (1) Integrate that to the module Share configuration file; (2)</span></div>
<div style="position:absolute;left:104.69px;top:201.31px" class="cls_004"><span class="cls_004">Create an extension module. Locate the directory</span></div>
<div style="position:absolute;left:104.69px;top:213.91px" class="cls_007"><span class="cls_007">src|main|amp|config|alfresco|web-extension|site-data|extensions</span><span class="cls_004"> in your</span></div>
<div style="position:absolute;left:104.69px;top:226.55px" class="cls_004"><span class="cls_004">share project. Create a file called </span><span class="cls_013">someco-metadata-template.xml</span><span class="cls_004"> in this</span></div>
<div style="position:absolute;left:104.69px;top:239.83px" class="cls_004"><span class="cls_004">directory. And let's define our extension:</span></div>
<div style="position:absolute;left:74.69px;top:263.04px" class="cls_010"><span class="cls_010">&lt;extension&gt;</span></div>
<div style="position:absolute;left:96.29px;top:273.84px" class="cls_010"><span class="cls_010">&lt;modules&gt;</span></div>
<div style="position:absolute;left:117.89px;top:284.64px" class="cls_010"><span class="cls_010">&lt;module&gt;</span></div>
<div style="position:absolute;left:139.49px;top:295.44px" class="cls_010"><span class="cls_010">&lt;id&gt;SomeCo Document Metadata Template&lt;/id&gt;</span></div>
<div style="position:absolute;left:139.49px;top:306.24px" class="cls_010"><span class="cls_010">&lt;version&gt;1.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:139.49px;top:317.04px" class="cls_010"><span class="cls_010">&lt;auto-deploy&gt;true&lt;/auto-deploy&gt;</span></div>
<div style="position:absolute;left:139.49px;top:327.84px" class="cls_010"><span class="cls_010">&lt;configurations&gt;</span></div>
<div style="position:absolute;left:150.29px;top:338.64px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:74.69px;top:349.44px" class="cls_010"><span class="cls_010">condition="DocumentLibrary"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:360.24px" class="cls_010"><span class="cls_010">&lt;metadata-templates&gt;</span></div>
<div style="position:absolute;left:161.09px;top:381.84px" class="cls_010"><span class="cls_010">&lt;/metadata-templates&gt;</span></div>
<div style="position:absolute;left:150.29px;top:392.64px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:139.49px;top:403.44px" class="cls_010"><span class="cls_010">&lt;/configurations&gt;</span></div>
<div style="position:absolute;left:117.89px;top:414.24px" class="cls_010"><span class="cls_010">&lt;/module&gt;</span></div>
<div style="position:absolute;left:96.29px;top:425.04px" class="cls_010"><span class="cls_010">&lt;/modules&gt;</span></div>
<div style="position:absolute;left:74.69px;top:435.84px" class="cls_010"><span class="cls_010">&lt;/extension&gt;</span></div>
<div style="position:absolute;left:91.32px;top:456.45px" class="cls_004"><span class="cls_004">2. We don't want to start from scratch, we just want to tweak the default template.</span></div>
<div style="position:absolute;left:104.69px;top:469.05px" class="cls_004"><span class="cls_004">Let's retrieve this template. Open the file </span><span class="cls_013">share-documentlibrary-</span></div>
<div style="position:absolute;left:104.69px;top:482.33px" class="cls_013"><span class="cls_013">config.xml</span><span class="cls_004"> located in </span><span class="cls_007">WEB-INF|classes|alfresco</span><span class="cls_004"> of the share web application.</span></div>
<div style="position:absolute;left:104.69px;top:495.61px" class="cls_004"><span class="cls_004">In this file, you should find a template element with the id attribute equals to</span></div>
<div style="position:absolute;left:104.69px;top:508.21px" class="cls_004"><span class="cls_004">default. Copy this template within the element metadata-templates. You don't</span></div>
<div style="position:absolute;left:104.69px;top:520.81px" class="cls_004"><span class="cls_004">want to override the default template, so you want to change the template id to</span></div>
<div style="position:absolute;left:104.69px;top:533.41px" class="cls_004"><span class="cls_004">somecoOperationalDocument.</span></div>
<div style="position:absolute;left:74.69px;top:556.62px" class="cls_010"><span class="cls_010">&lt;template id="somecoOperationalDocument"&gt;</span></div>
<div style="position:absolute;left:90.89px;top:567.42px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:74.69px;top:578.22px" class="cls_010"><span class="cls_010">&lt;/template&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 196 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:142636px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background212.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. The next step is to provide an evaluator to identify only Operation Document.</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">We can re-use the evaluator that we created previously.</span></div>
<div style="position:absolute;left:74.69px;top:106.31px" class="cls_010"><span class="cls_010">&lt;template id="somecoOperationalDocument"&gt;</span></div>
<div style="position:absolute;left:90.89px;top:117.11px" class="cls_010"><span class="cls_010">&lt;evaluator&gt;evaluator.doclib.action.isSomecoOperatonDoc&lt;/evaluator&gt;</span></div>
<div style="position:absolute;left:90.89px;top:127.91px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:74.69px;top:138.71px" class="cls_010"><span class="cls_010">&lt;/template&gt;</span></div>
<div style="position:absolute;left:91.32px;top:159.32px" class="cls_004"><span class="cls_004">4. And finally, we want to replace the line that contains the description. We are</span></div>
<div style="position:absolute;left:104.69px;top:171.92px" class="cls_004"><span class="cls_004">going to replace the line with the index attribute equals to 20 by the following</span></div>
<div style="position:absolute;left:104.69px;top:184.52px" class="cls_004"><span class="cls_004">line.</span></div>
<div style="position:absolute;left:74.69px;top:207.73px" class="cls_010"><span class="cls_010">&lt;line index="20" id="statusSummary"</span></div>
<div style="position:absolute;left:74.69px;top:218.53px" class="cls_010"><span class="cls_010">view="detailed"&gt;{sc_statusSummaryproperty.sc_statusSummary}&lt;/line&gt;</span></div>
<div style="position:absolute;left:124.19px;top:239.01px" class="cls_004"><span class="cls_004">It may be a bit obscure at this point. The </span><span class="cls_013">sc_statusSummary</span><span class="cls_004"> will be mapped</span></div>
<div style="position:absolute;left:124.19px;top:252.29px" class="cls_004"><span class="cls_004">to our custom model, and the following label is mapped to a property that</span></div>
<div style="position:absolute;left:124.19px;top:264.89px" class="cls_004"><span class="cls_004">we define just below in the I18N file.</span></div>
<div style="position:absolute;left:91.32px;top:286.62px" class="cls_004"><span class="cls_004">5. The last step is to create the label for this new line. Open the </span><span class="cls_013">share.properties</span></div>
<div style="position:absolute;left:104.69px;top:299.90px" class="cls_004"><span class="cls_004">file and add the following line.</span></div>
<div style="position:absolute;left:74.69px;top:323.11px" class="cls_010"><span class="cls_010">property.sc_statusSummary=Status Summary</span></div>
<div style="position:absolute;left:91.32px;top:354.52px" class="cls_004"><span class="cls_004">6. Deploy, restart, and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 197 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:143312px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background213.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you refresh your document list, and be sure to be in the </span><span class="cls_007">Detailed View</span><span class="cls_004">, you should be</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">able to see the status summary for all </span><span class="cls_007">Operational</span><span class="cls_004"> documents:</span></div>
<div style="position:absolute;left:56.69px;top:413.85px" class="cls_008"><span class="cls_008">Creating custom dialogs</span></div>
<div style="position:absolute;left:56.69px;top:441.58px" class="cls_004"><span class="cls_004">For the moment, the manager handling operational documents seems pretty satisfied by the</span></div>
<div style="position:absolute;left:56.69px;top:454.18px" class="cls_004"><span class="cls_004">solution that we implemented. We can work and satisfy another manager. If you remember</span></div>
<div style="position:absolute;left:56.69px;top:466.78px" class="cls_004"><span class="cls_004">our work on Whitepapers, we create two actions to enable and disable the Web flag. Each</span></div>
<div style="position:absolute;left:56.69px;top:479.38px" class="cls_004"><span class="cls_004">UI action calls the same action that we defined in the repository. Moreover, when we enable</span></div>
<div style="position:absolute;left:56.69px;top:491.98px" class="cls_004"><span class="cls_004">the Web flag, we update automatically the publish date with the current date. We want to</span></div>
<div style="position:absolute;left:56.69px;top:504.58px" class="cls_004"><span class="cls_004">improve this behavior. We want to be able to set the Web flag to true and to specify when</span></div>
<div style="position:absolute;left:56.69px;top:517.18px" class="cls_004"><span class="cls_004">should be the publish date. This feature will be very useful to plan the publication of the</span></div>
<div style="position:absolute;left:56.69px;top:529.78px" class="cls_004"><span class="cls_004">Whitepapers.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 198 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:143988px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background214.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">In this section, we'll:</span></div>
<div style="position:absolute;left:104.69px;top:92.23px" class="cls_004"><span class="cls_004">Update the Alfresco action to receive the publication date as parameter;</span></div>
<div style="position:absolute;left:104.69px;top:106.99px" class="cls_004"><span class="cls_004">Create a new form in Alfresco Share with an input field for the publication date;</span></div>
<div style="position:absolute;left:104.69px;top:121.75px" class="cls_004"><span class="cls_004">Update the action definition in Alfresco Share to use the new form.</span></div>
<div style="position:absolute;left:56.69px;top:160.74px" class="cls_014"><span class="cls_014">Step-by-step - creating a dialog to publish</span></div>
<div style="position:absolute;left:56.69px;top:182.34px" class="cls_014"><span class="cls_014">Whitepapers</span></div>
<div style="position:absolute;left:56.69px;top:207.56px" class="cls_004"><span class="cls_004">To develop the custom dialog, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:229.29px" class="cls_004"><span class="cls_004">1. First, we'll work on the existing Java class representing our action called</span></div>
<div style="position:absolute;left:104.69px;top:241.89px" class="cls_013"><span class="cls_013">SetWebFlag</span><span class="cls_004">in the</span><span class="cls_013">repo</span><span class="cls_004"> project. Update the method</span></div>
<div style="position:absolute;left:104.69px;top:255.17px" class="cls_013"><span class="cls_013">addParameterDefinitions</span><span class="cls_004"> and add the following line:</span></div>
<div style="position:absolute;left:96.29px;top:279.06px" class="cls_010"><span class="cls_010">paramList.add(new ParameterDefinitionImpl(</span></div>
<div style="position:absolute;left:96.29px;top:289.86px" class="cls_010"><span class="cls_010">PARAM_PUBLISHED, DataTypeDefinition.DATE, false,</span></div>
<div style="position:absolute;left:74.69px;top:300.66px" class="cls_010"><span class="cls_010">getParamDisplayLabel(PARAM_PUBLISHED)));</span></div>
<div style="position:absolute;left:91.32px;top:321.27px" class="cls_004"><span class="cls_004">2. Add the following variable at the top of your class:</span></div>
<div style="position:absolute;left:91.32px;top:336.03px" class="cls_004"><span class="cls_004">3. public final static String PARAM_PUBLISHED = </span><span class="cls_022">“</span><span class="cls_004">published</span><span class="cls_022">”</span><span class="cls_004">;</span></div>
<div style="position:absolute;left:91.32px;top:351.62px" class="cls_004"><span class="cls_004">4. Let's change how we populate the publication date. Locate the following</span></div>
<div style="position:absolute;left:104.69px;top:364.22px" class="cls_004"><span class="cls_004">statement in the </span><span class="cls_013">executeImpl</span><span class="cls_004"> method:</span></div>
<div style="position:absolute;left:117.89px;top:388.11px" class="cls_010"><span class="cls_010">if (activeFlag) {</span></div>
<div style="position:absolute;left:117.89px;top:398.91px" class="cls_010"><span class="cls_010">properties.put(SomeCoModel.PROP_PUBLISHED, new Date());</span></div>
<div style="position:absolute;left:134.09px;top:409.71px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:430.32px" class="cls_004"><span class="cls_004">5. And replace it by:</span></div>
<div style="position:absolute;left:117.89px;top:453.53px" class="cls_010"><span class="cls_010">if (activeFlag) {</span></div>
<div style="position:absolute;left:128.69px;top:464.33px" class="cls_010"><span class="cls_010">Date published = new Date();</span></div>
<div style="position:absolute;left:128.69px;top:475.13px" class="cls_010"><span class="cls_010">if (action.getParameterValue(PARAM_PUBLISHED) != null)</span></div>
<div style="position:absolute;left:139.49px;top:485.93px" class="cls_010"><span class="cls_010">published = (Date) action.getParameterValue(PARAM_PUBLISHED);</span></div>
<div style="position:absolute;left:117.89px;top:496.73px" class="cls_010"><span class="cls_010">properties.put(SomeCoModel.PROP_PUBLISHED, published);</span></div>
<div style="position:absolute;left:117.89px;top:507.53px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:117.89px;top:518.33px" class="cls_010"><span class="cls_010">properties.put(SomeCoModel.PROP_PUBLISHED, null);</span></div>
<div style="position:absolute;left:117.89px;top:529.13px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 199 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:144664px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background215.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. We are done with Alfresco. We can configure Alfresco Share. Open the file share-</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">config-custom.xml located in the share project. Find the action tag with the id</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">attribute equals to someco-web-enable. First, let's replace the function that will be</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">used:</span></div>
<div style="position:absolute;left:117.89px;top:131.51px" class="cls_010"><span class="cls_010">&lt;param name="function"&gt;onActionSimpleRepoAction&lt;/param&gt;</span></div>
<div style="position:absolute;left:117.89px;top:142.31px" class="cls_010"><span class="cls_010">By:</span></div>
<div style="position:absolute;left:117.89px;top:153.11px" class="cls_010"><span class="cls_010">&lt;param name="function"&gt;onActionFormDialog&lt;/param&gt;</span></div>
<div style="position:absolute;left:91.32px;top:173.72px" class="cls_004"><span class="cls_004">7. Then, update the properties referencing the action:</span></div>
<div style="position:absolute;left:117.89px;top:196.93px" class="cls_010"><span class="cls_010">&lt;param name="action"&gt;set-web-flag&lt;/param&gt;</span></div>
<div style="position:absolute;left:117.89px;top:207.73px" class="cls_010"><span class="cls_010">&lt;param name="active"&gt;false&lt;/param&gt;</span></div>
<div style="position:absolute;left:91.32px;top:228.34px" class="cls_004"><span class="cls_004">8. By:</span></div>
<div style="position:absolute;left:117.89px;top:251.55px" class="cls_010"><span class="cls_010">&lt;param name="itemKind"&gt;action&lt;/param&gt;</span></div>
<div style="position:absolute;left:117.89px;top:262.35px" class="cls_010"><span class="cls_010">&lt;param name="itemId"&gt;set-web-flag&lt;/param&gt;</span></div>
<div style="position:absolute;left:117.89px;top:273.15px" class="cls_010"><span class="cls_010">&lt;param name="destination"&gt;{node.nodeRef}&lt;/param&gt;</span></div>
<div style="position:absolute;left:117.89px;top:283.95px" class="cls_010"><span class="cls_010">&lt;param name="mode"&gt;create&lt;/param&gt;</span></div>
<div style="position:absolute;left:91.32px;top:304.56px" class="cls_004"><span class="cls_004">9. You'll find on this page the meaning of all these parameters: </span><a href="http://docs.alfresco.com/5.1/tasks/dev-extensions-share-tutorials-add-action-doclib.html">http://docs.alfre</a> </div>
<div style="position:absolute;left:104.69px;top:316.86px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/dev-extensions-share-tutorials-add-action-doclib.html">sco.com/5.1/tasks/dev-extensions-share-tutorials-add-action-doclib.h</a> </div>
<div style="position:absolute;left:104.69px;top:328.34px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/dev-extensions-share-tutorials-add-action-doclib.html">tml</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:343.48px" class="cls_004"><span class="cls_004">10. Then, we are going to define the form that we'll be used of this action. Add the</span></div>
<div style="position:absolute;left:104.69px;top:356.08px" class="cls_004"><span class="cls_004">following config element that configures that we just want to see the </span><span class="cls_013">published</span></div>
<div style="position:absolute;left:104.69px;top:369.36px" class="cls_004"><span class="cls_004">property in the form:</span></div>
<div style="position:absolute;left:117.89px;top:392.57px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:139.49px;top:403.37px" class="cls_010"><span class="cls_010">condition="set-web-flag"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:414.17px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:155.69px;top:424.97px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:161.09px;top:435.77px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:446.57px" class="cls_010"><span class="cls_010">&lt;show id="published" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:457.37px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:468.17px" class="cls_010"><span class="cls_010">&lt;appearance&gt;</span></div>
<div style="position:absolute;left:161.09px;top:478.97px" class="cls_010"><span class="cls_010">&lt;field id="published"</span></div>
<div style="position:absolute;left:166.49px;top:489.77px" class="cls_010"><span class="cls_010">label-id="property.sc_published"</span></div>
<div style="position:absolute;left:166.49px;top:500.57px" class="cls_010"><span class="cls_010">mandatory="true"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:511.37px" class="cls_010"><span class="cls_010">&lt;control</span></div>
<div style="position:absolute;left:74.69px;top:522.17px" class="cls_010"><span class="cls_010">template="/org/alfresco/components/form/controls/date.ftl" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:532.97px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:150.29px;top:543.77px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:139.49px;top:554.57px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:128.69px;top:565.37px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:576.17px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 200 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:145340px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background216.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. Add the following I18N message to the share.properties file:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">property.sc_published=Published</span></div>
<div style="position:absolute;left:86.07px;top:114.32px" class="cls_004"><span class="cls_004">12. Deploy, restart and test.</span></div>
<div style="position:absolute;left:56.69px;top:138.21px" class="cls_004"><span class="cls_004">After a successful restart, if you click on the action SC Enable Web Flag, you should see a</span></div>
<div style="position:absolute;left:56.69px;top:150.81px" class="cls_004"><span class="cls_004">new dialog. And you should be able to input the publication date:</span></div>
<div style="position:absolute;left:56.69px;top:283.58px" class="cls_004"><span class="cls_004">Input the publication the date and clicking </span><span class="cls_007">OK</span><span class="cls_004"> will execute the against the whitepaper and</span></div>
<div style="position:absolute;left:56.69px;top:296.22px" class="cls_004"><span class="cls_004">will set all properties:</span></div>
<div style="position:absolute;left:56.69px;top:400.39px" class="cls_008"><span class="cls_008">Creating custom dashlets</span></div>
<div style="position:absolute;left:56.69px;top:428.12px" class="cls_004"><span class="cls_004">Alfresco Share includes two special pages called Dashboard, which contains windows</span></div>
<div style="position:absolute;left:56.69px;top:440.72px" class="cls_004"><span class="cls_004">(think Portlets) of content called Dashlets. In the current version, most of these Dashlets are</span></div>
<div style="position:absolute;left:56.69px;top:453.32px" class="cls_004"><span class="cls_004">Spring Surf Dashlets. As I explained in the introduction, Alfresco Share provides two</span></div>
<div style="position:absolute;left:56.69px;top:465.92px" class="cls_004"><span class="cls_004">platforms or technologies to accomplish that: Surf and Aikau. But we'll use only Surf in this</span></div>
<div style="position:absolute;left:56.69px;top:478.52px" class="cls_004"><span class="cls_004">book (except for the menu customization because it's implemented using Aikau and we</span></div>
<div style="position:absolute;left:56.69px;top:491.12px" class="cls_004"><span class="cls_004">don't have other options).</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 201 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:146016px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background217.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">As explained above, Alfresco provides two dashboard: user and site dashboard. Each</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">dashboard can be customized by selecting a layout and add only the relevant dashlets. The</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">user dashboard is customizable by each user, and the site dashboard available for each site</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">is customizable by all Site managers.</span></div>
<div style="position:absolute;left:56.69px;top:352.58px" class="cls_004"><span class="cls_004">The following list displays all available dashlets by default in Alfresco.</span></div>
<div style="position:absolute;left:60.32px;top:377.78px" class="cls_024"><span class="cls_024">Name</span></div>
<div style="position:absolute;left:161.05px;top:377.78px" class="cls_024"><span class="cls_024">Description</span></div>
<div style="position:absolute;left:384.61px;top:377.78px" class="cls_024"><span class="cls_024">User and/or Site</span></div>
<div style="position:absolute;left:384.61px;top:389.78px" class="cls_024"><span class="cls_024">Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:408.33px" class="cls_025"><span class="cls_025">My Activities</span></div>
<div style="position:absolute;left:161.05px;top:408.33px" class="cls_025"><span class="cls_025">Tracks the most recent activities in your sites.</span></div>
<div style="position:absolute;left:384.61px;top:408.33px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:426.84px" class="cls_025"><span class="cls_025">My Meeting</span></div>
<div style="position:absolute;left:161.05px;top:426.84px" class="cls_025"><span class="cls_025">Displays all Meeting Workspace sit&lt;ie&gt;e&lt;/ie&gt;s</span></div>
<div style="position:absolute;left:384.61px;top:426.84px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:438.84px" class="cls_025"><span class="cls_025">Workspaces</span></div>
<div style="position:absolute;left:161.05px;top:438.84px" class="cls_025"><span class="cls_025">that you belong to (Meeting Workspaces are</span></div>
<div style="position:absolute;left:161.05px;top:450.84px" class="cls_025"><span class="cls_025">created in Microsoft Outlook)</span></div>
<div style="position:absolute;left:60.32px;top:469.35px" class="cls_025"><span class="cls_025">My Document</span></div>
<div style="position:absolute;left:161.05px;top:469.35px" class="cls_025"><span class="cls_025">Displays all Document Workspace sites that you</span></div>
<div style="position:absolute;left:384.61px;top:469.35px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:481.35px" class="cls_025"><span class="cls_025">Workspaces</span></div>
<div style="position:absolute;left:161.05px;top:481.35px" class="cls_025"><span class="cls_025">belong to (Document Workspaces are created in</span></div>
<div style="position:absolute;left:161.05px;top:493.35px" class="cls_025"><span class="cls_025">Microsoft Word)</span></div>
<div style="position:absolute;left:60.32px;top:511.86px" class="cls_025"><span class="cls_025">My Tasks</span></div>
<div style="position:absolute;left:161.05px;top:511.86px" class="cls_025"><span class="cls_025">Displays your tasks.</span></div>
<div style="position:absolute;left:384.61px;top:511.86px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:530.37px" class="cls_025"><span class="cls_025">Alfresco Add-ons</span></div>
<div style="position:absolute;left:161.05px;top:530.37px" class="cls_025"><span class="cls_025">Displays the Newest Add-ons feed from the</span></div>
<div style="position:absolute;left:384.61px;top:530.37px" class="cls_025"><span class="cls_025">User &amp; Site</span></div>
<div style="position:absolute;left:60.32px;top:542.37px" class="cls_025"><span class="cls_025">RSS Feed</span></div>
<div style="position:absolute;left:161.05px;top:542.37px" class="cls_025"><span class="cls_025">Alfresco Add-ons website by default.</span></div>
<div style="position:absolute;left:384.61px;top:542.37px" class="cls_025"><span class="cls_025">Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:560.88px" class="cls_025"><span class="cls_025">Saved Search</span></div>
<div style="position:absolute;left:161.05px;top:560.88px" class="cls_025"><span class="cls_025">Displays the results of a pre-configured search.</span></div>
<div style="position:absolute;left:384.61px;top:560.88px" class="cls_025"><span class="cls_025">User &amp; Site</span></div>
<div style="position:absolute;left:384.61px;top:572.88px" class="cls_025"><span class="cls_025">Dashboard</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 202 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:146692px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background218.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:60.32px;top:74.14px" class="cls_025"><span class="cls_025">Content I'm Editing</span></div>
<div style="position:absolute;left:161.05px;top:74.14px" class="cls_025"><span class="cls_025">Displays the last three library items, blog posts</span></div>
<div style="position:absolute;left:384.61px;top:74.14px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:86.14px" class="cls_025"><span class="cls_025">(drafts, not published posts), wiki pages, and</span></div>
<div style="position:absolute;left:161.05px;top:98.14px" class="cls_025"><span class="cls_025">discussion forum posts that you</span></div>
<div style="position:absolute;left:60.32px;top:116.65px" class="cls_025"><span class="cls_025">edited User</span></div>
<div style="position:absolute;left:161.05px;top:116.65px" class="cls_025"><span class="cls_025">Shows a summary of your personal details.</span></div>
<div style="position:absolute;left:384.61px;top:116.65px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:128.65px" class="cls_025"><span class="cls_025">Dashboard My</span></div>
<div style="position:absolute;left:60.32px;top:140.65px" class="cls_025"><span class="cls_025">Profile</span></div>
<div style="position:absolute;left:60.32px;top:159.16px" class="cls_025"><span class="cls_025">My Discussions</span></div>
<div style="position:absolute;left:161.05px;top:159.16px" class="cls_025"><span class="cls_025">Shows the most recent topics created in the</span></div>
<div style="position:absolute;left:384.61px;top:159.16px" class="cls_025"><span class="cls_025">User &amp; Site</span></div>
<div style="position:absolute;left:161.05px;top:171.16px" class="cls_025"><span class="cls_025">discussion forums of your sites.</span></div>
<div style="position:absolute;left:384.61px;top:171.16px" class="cls_025"><span class="cls_025">Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:189.67px" class="cls_025"><span class="cls_025">Site Search</span></div>
<div style="position:absolute;left:161.05px;top:189.67px" class="cls_025"><span class="cls_025">Lets you search all the sites you belong to.</span></div>
<div style="position:absolute;left:384.61px;top:189.67px" class="cls_025"><span class="cls_025">User &amp; Site</span></div>
<div style="position:absolute;left:384.61px;top:201.67px" class="cls_025"><span class="cls_025">Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:220.18px" class="cls_025"><span class="cls_025">My Documents</span></div>
<div style="position:absolute;left:161.05px;top:220.18px" class="cls_025"><span class="cls_025">Tracks your content in all site libraries.</span></div>
<div style="position:absolute;left:384.61px;top:220.18px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:238.69px" class="cls_025"><span class="cls_025">My Sites</span></div>
<div style="position:absolute;left:161.05px;top:238.69px" class="cls_025"><span class="cls_025">Lists the sites you belong to.</span></div>
<div style="position:absolute;left:384.61px;top:238.69px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:257.20px" class="cls_025"><span class="cls_025">My Calendar</span></div>
<div style="position:absolute;left:161.05px;top:257.20px" class="cls_025"><span class="cls_025">Displays upcoming events scheduled for your</span></div>
<div style="position:absolute;left:384.61px;top:257.20px" class="cls_025"><span class="cls_025">User Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:269.20px" class="cls_025"><span class="cls_025">sites</span></div>
<div style="position:absolute;left:60.32px;top:287.71px" class="cls_025"><span class="cls_025">RSS Feed</span></div>
<div style="position:absolute;left:161.05px;top:287.71px" class="cls_025"><span class="cls_025">Displays the Alfresco website feed by default.</span></div>
<div style="position:absolute;left:384.61px;top:287.71px" class="cls_025"><span class="cls_025">User &amp; Site</span></div>
<div style="position:absolute;left:384.61px;top:299.71px" class="cls_025"><span class="cls_025">Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:318.22px" class="cls_025"><span class="cls_025">Web View</span></div>
<div style="position:absolute;left:161.05px;top:318.22px" class="cls_025"><span class="cls_025">Displays the website of your choice.</span></div>
<div style="position:absolute;left:384.61px;top:318.22px" class="cls_025"><span class="cls_025">User &amp; Site</span></div>
<div style="position:absolute;left:384.61px;top:330.22px" class="cls_025"><span class="cls_025">Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:348.73px" class="cls_025"><span class="cls_025">Site Calendar</span></div>
<div style="position:absolute;left:161.05px;top:348.73px" class="cls_025"><span class="cls_025">Lists the upcoming events scheduled in this</span></div>
<div style="position:absolute;left:384.61px;top:348.73px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:360.73px" class="cls_025"><span class="cls_025">site's calendar.</span></div>
<div style="position:absolute;left:60.32px;top:379.24px" class="cls_025"><span class="cls_025">Image Preview</span></div>
<div style="position:absolute;left:161.05px;top:379.24px" class="cls_025"><span class="cls_025">Displays a thumbnail of all images stored in the</span></div>
<div style="position:absolute;left:384.61px;top:379.24px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:391.24px" class="cls_025"><span class="cls_025">site's library.</span></div>
<div style="position:absolute;left:60.32px;top:409.75px" class="cls_025"><span class="cls_025">Site Data Lists</span></div>
<div style="position:absolute;left:161.05px;top:409.75px" class="cls_025"><span class="cls_025">Lists this site's data lists.</span></div>
<div style="position:absolute;left:384.61px;top:409.75px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:428.26px" class="cls_025"><span class="cls_025">Site Profile</span></div>
<div style="position:absolute;left:161.05px;top:428.26px" class="cls_025"><span class="cls_025">Displays a summary of the site details.</span></div>
<div style="position:absolute;left:384.61px;top:428.26px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:446.77px" class="cls_025"><span class="cls_025">Site Members</span></div>
<div style="position:absolute;left:161.05px;top:446.77px" class="cls_025"><span class="cls_025">Displays the current members of this site (to a</span></div>
<div style="position:absolute;left:384.61px;top:446.77px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:458.77px" class="cls_025"><span class="cls_025">maximum of 100 members) and their assigned</span></div>
<div style="position:absolute;left:161.05px;top:470.77px" class="cls_025"><span class="cls_025">roles.</span></div>
<div style="position:absolute;left:60.32px;top:489.28px" class="cls_025"><span class="cls_025">Site Activities</span></div>
<div style="position:absolute;left:161.05px;top:489.28px" class="cls_025"><span class="cls_025">Tracks the most recent activities performed in</span></div>
<div style="position:absolute;left:384.61px;top:489.28px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:501.28px" class="cls_025"><span class="cls_025">this site such as content additions, edits, and</span></div>
<div style="position:absolute;left:161.05px;top:513.28px" class="cls_025"><span class="cls_025">deletions, as well as changes in site membership.</span></div>
<div style="position:absolute;left:60.32px;top:531.79px" class="cls_025"><span class="cls_025">Site Links</span></div>
<div style="position:absolute;left:161.05px;top:531.79px" class="cls_025"><span class="cls_025">Displays the web links compiled by site users.</span></div>
<div style="position:absolute;left:384.61px;top:531.79px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:550.30px" class="cls_025"><span class="cls_025">Site Contributor</span></div>
<div style="position:absolute;left:161.05px;top:550.30px" class="cls_025"><span class="cls_025">Displays a breakdown of all site members</span></div>
<div style="position:absolute;left:384.61px;top:550.30px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:562.30px" class="cls_025"><span class="cls_025">Breakdown</span></div>
<div style="position:absolute;left:161.05px;top:562.30px" class="cls_025"><span class="cls_025">contributing content to the site's library.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 203 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:147368px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background219.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:60.32px;top:74.14px" class="cls_025"><span class="cls_025">Site Content</span></div>
<div style="position:absolute;left:161.05px;top:74.14px" class="cls_025"><span class="cls_025">Lists the library content that has been added or</span></div>
<div style="position:absolute;left:384.61px;top:74.14px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:86.14px" class="cls_025"><span class="cls_025">edited in the past seven days.</span></div>
<div style="position:absolute;left:60.32px;top:104.65px" class="cls_025"><span class="cls_025">Site File Type</span></div>
<div style="position:absolute;left:161.05px;top:104.65px" class="cls_025"><span class="cls_025">Displays a detailed breakdown of all files stored</span></div>
<div style="position:absolute;left:384.61px;top:104.65px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:60.32px;top:116.65px" class="cls_025"><span class="cls_025">Breakdown</span></div>
<div style="position:absolute;left:161.05px;top:116.65px" class="cls_025"><span class="cls_025">in the site's library.</span></div>
<div style="position:absolute;left:60.32px;top:135.16px" class="cls_025"><span class="cls_025">Site Notice</span></div>
<div style="position:absolute;left:161.05px;top:135.16px" class="cls_025"><span class="cls_025">Displays a custom message posted by a site</span></div>
<div style="position:absolute;left:384.61px;top:135.16px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:161.05px;top:147.16px" class="cls_025"><span class="cls_025">manager.</span></div>
<div style="position:absolute;left:60.32px;top:165.67px" class="cls_025"><span class="cls_025">Wiki</span></div>
<div style="position:absolute;left:161.05px;top:165.67px" class="cls_025"><span class="cls_025">Displays a selected page from the site wiki.</span></div>
<div style="position:absolute;left:384.61px;top:165.67px" class="cls_025"><span class="cls_025">Site Dashboard</span></div>
<div style="position:absolute;left:56.69px;top:205.77px" class="cls_004"><span class="cls_004">But sometimes, you need to implement your own dashlets that can be added to the user or</span></div>
<div style="position:absolute;left:56.69px;top:218.37px" class="cls_004"><span class="cls_004">site dashboard. For the moment, we want to create a dashlet that displays all whitepaper</span></div>
<div style="position:absolute;left:56.69px;top:230.97px" class="cls_004"><span class="cls_004">available in the repository. We want to make it available in any dashboard. For the moment,</span></div>
<div style="position:absolute;left:56.69px;top:243.57px" class="cls_004"><span class="cls_004">we'll display only basic information about the whitepapers, and no custom properties that</span></div>
<div style="position:absolute;left:56.69px;top:256.17px" class="cls_004"><span class="cls_004">we defined. The following picture illustrates the different connections:</span></div>
<div style="position:absolute;left:56.69px;top:475.94px" class="cls_004"><span class="cls_004">In our use case, we implemented the call to the Alfresco repository webscript to get a list of</span></div>
<div style="position:absolute;left:56.69px;top:488.54px" class="cls_004"><span class="cls_004">whitepaper in JSON format directly in the controller of the dashlet.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 204 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:148044px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background220.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - creating a dashlet listing</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">Whitepapers</span></div>
<div style="position:absolute;left:56.69px;top:116.58px" class="cls_004"><span class="cls_004">To develop the dashlet, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:138.31px" class="cls_004"><span class="cls_004">1. In the share project, locate the folder </span><span class="cls_007">src|main|amp|config|alfresco|web-</span></div>
<div style="position:absolute;left:104.69px;top:150.95px" class="cls_007"><span class="cls_007">extension</span><span class="cls_004"> and create the following directory </span><span class="cls_007">site-</span></div>
<div style="position:absolute;left:104.69px;top:163.59px" class="cls_007"><span class="cls_007">webscripts|com|someco|components|dashlets</span><span class="cls_004">. The first step is to create the file</span></div>
<div style="position:absolute;left:104.69px;top:176.22px" class="cls_004"><span class="cls_004">whitepaper.get.desc.xml that will describe the dashlet. Notice that we use the</span></div>
<div style="position:absolute;left:104.69px;top:188.82px" class="cls_004"><span class="cls_004">family </span><span class="cls_013">dashlet</span><span class="cls_004"> (instead of </span><span class="cls_013">site-dashlet</span><span class="cls_004"> or </span><span class="cls_013">user-dashlet</span><span class="cls_004">) to be able to use it</span></div>
<div style="position:absolute;left:104.69px;top:202.10px" class="cls_004"><span class="cls_004">on all dashboards.</span></div>
<div style="position:absolute;left:74.69px;top:225.31px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:96.29px;top:236.11px" class="cls_010"><span class="cls_010">&lt;shortname&gt;List of whitepapers&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:96.29px;top:246.91px" class="cls_010"><span class="cls_010">&lt;description&gt;Display all available whitepapers&lt;/description&gt;</span></div>
<div style="position:absolute;left:96.29px;top:257.71px" class="cls_010"><span class="cls_010">&lt;family&gt;dashlet&lt;/family&gt;</span></div>
<div style="position:absolute;left:96.29px;top:268.51px" class="cls_010"><span class="cls_010">&lt;url&gt;/components/dashlets/whitepaper&lt;/url&gt;</span></div>
<div style="position:absolute;left:74.69px;top:279.31px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:91.32px;top:299.92px" class="cls_004"><span class="cls_004">2. Then, create the Javascript controller </span><span class="cls_013">whitepaper.get.js</span><span class="cls_004"> in the same directory</span></div>
<div style="position:absolute;left:104.69px;top:313.20px" class="cls_004"><span class="cls_004">that queries the Search API provided by Alfresco. We'll use the content type to be</span></div>
<div style="position:absolute;left:104.69px;top:325.80px" class="cls_004"><span class="cls_004">able to get all whitepapers. Then we'll populate the model object.</span></div>
<div style="position:absolute;left:74.69px;top:349.01px" class="cls_010"><span class="cls_010">function main() {</span></div>
<div style="position:absolute;left:96.29px;top:359.81px" class="cls_010"><span class="cls_010">var query = "TYPE:sc\\:whitepaper"</span></div>
<div style="position:absolute;left:96.29px;top:370.61px" class="cls_010"><span class="cls_010">var result = remote.call("/slingshot/search?term=" +</span></div>
<div style="position:absolute;left:74.69px;top:381.41px" class="cls_010"><span class="cls_010">encodeURIComponent(query));</span></div>
<div style="position:absolute;left:128.69px;top:392.21px" class="cls_010"><span class="cls_010">if (result.status == 200) {</span></div>
<div style="position:absolute;left:117.89px;top:403.01px" class="cls_010"><span class="cls_010">model.items = JSON.parse(result).items;</span></div>
<div style="position:absolute;left:107.09px;top:413.81px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:96.29px;top:424.61px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:435.41px" class="cls_010"><span class="cls_010">main();</span></div>
<div style="position:absolute;left:124.19px;top:455.89px" class="cls_004"><span class="cls_004">Let's discover a bit this code. First, you can see the use of the object remote</span></div>
<div style="position:absolute;left:124.19px;top:468.49px" class="cls_004"><span class="cls_004">that allows you to make REST calls. In our case, we use it to send a search</span></div>
<div style="position:absolute;left:124.19px;top:481.09px" class="cls_004"><span class="cls_004">query and retrieve the items returned. Them we save the returned items in</span></div>
<div style="position:absolute;left:124.19px;top:493.69px" class="cls_004"><span class="cls_004">the model object that is passed to the Freemarker template for displaying.</span></div>
<div style="position:absolute;left:124.19px;top:506.29px" class="cls_004"><span class="cls_004">You can find all available root objects here: </span><a href="http://docs.alfresco.com/5.1/references/APISurf-rootscoped.html">http://docs.alfresco.com/5.</a> </div>
<div style="position:absolute;left:124.19px;top:519.27px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/references/APISurf-rootscoped.html">1/references/APISurf-rootscoped.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 205 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:148720px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background221.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. In the same directory, we'll create the Freemarker template</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">whitepaper.get.html.ftl that will generate the HTML content. First, we need to</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">declare the CSS dependency:</span></div>
<div style="position:absolute;left:74.69px;top:118.91px" class="cls_010"><span class="cls_010">&lt;@markup id="css"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:129.71px" class="cls_010"><span class="cls_010">&lt;@link rel="stylesheet" type="text/css"</span></div>
<div style="position:absolute;left:74.69px;top:140.51px" class="cls_010"><span class="cls_010">href="${url.context}/res/components/dashlets/whitepaper.css"</span></div>
<div style="position:absolute;left:80.09px;top:151.31px" class="cls_010"><span class="cls_010">group="dashlets"/&gt;</span></div>
<div style="position:absolute;left:74.69px;top:162.11px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:124.19px;top:182.59px" class="cls_004"><span class="cls_004">We are just going to add one CSS rule to have a better displaying. Create the</span></div>
<div style="position:absolute;left:124.19px;top:195.19px" class="cls_004"><span class="cls_004">file share|src|main|amp|web|components|dashlets|whitepaper.css and</span></div>
<div style="position:absolute;left:124.19px;top:207.79px" class="cls_004"><span class="cls_004">just add the following code:</span></div>
<div style="position:absolute;left:74.69px;top:228.71px" class="cls_010"><span class="cls_010">p.whitepaper {</span></div>
<div style="position:absolute;left:90.89px;top:239.51px" class="cls_010"><span class="cls_010">padding-left: 5px;</span></div>
<div style="position:absolute;left:74.69px;top:250.31px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:122.09px;top:270.79px" class="cls_004"><span class="cls_004">You can find more information on the Freemarker syntax in the following</span></div>
<div style="position:absolute;left:122.09px;top:283.39px" class="cls_004"><span class="cls_004">page:</span></div>
<div style="position:absolute;left:122.09px;top:295.31px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-surf-dashlets.html">http://docs.alfresco.com/5.1/concepts/dev-extensions-share-surf-</a> </div>
<div style="position:absolute;left:122.09px;top:306.79px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-surf-dashlets.html">dashlets.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:330.32px" class="cls_004"><span class="cls_004">4. Add the following code that will define the global structure of your dashlet. For</span></div>
<div style="position:absolute;left:104.69px;top:342.92px" class="cls_004"><span class="cls_004">the moment, your dashlet don't display anything.</span></div>
<div style="position:absolute;left:74.69px;top:366.13px" class="cls_010"><span class="cls_010">&lt;@markup id="html"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:376.93px" class="cls_010"><span class="cls_010">&lt;@uniqueIdDiv&gt;</span></div>
<div style="position:absolute;left:74.69px;top:387.73px" class="cls_010"><span class="cls_010">&lt;#assign id = args.htmlid?html&gt;</span></div>
<div style="position:absolute;left:74.69px;top:398.53px" class="cls_010"><span class="cls_010">&lt;#assign dashboardconfig=config.scoped['Dashboard']['dashboard']&gt;</span></div>
<div style="position:absolute;left:85.49px;top:409.33px" class="cls_010"><span class="cls_010">&lt;div class="dashlet"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:420.13px" class="cls_010"><span class="cls_010">&lt;div class="title"&gt;${msg("someco.whitepaper.dashletName")}&lt;/div&gt;</span></div>
<div style="position:absolute;left:117.89px;top:430.93px" class="cls_010"><span class="cls_010">&lt;div id="${id}-whitepapers" class="body scrollableList" &lt;#if</span></div>
<div style="position:absolute;left:74.69px;top:441.73px" class="cls_010"><span class="cls_010">args.height??&gt;style</span></div>
<div style="position:absolute;left:117.89px;top:452.53px" class="cls_010"><span class="cls_010">="height: ${args.height?html}px;"&lt;/#if&gt;&gt;</span></div>
<div style="position:absolute;left:96.29px;top:463.33px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:85.49px;top:474.13px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:74.69px;top:484.93px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:74.69px;top:495.73px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:91.32px;top:516.34px" class="cls_004"><span class="cls_004">5. Then, you are good to add the code that will generate the list of whitepapers. In</span></div>
<div style="position:absolute;left:104.69px;top:528.94px" class="cls_004"><span class="cls_004">our case, we just want to display the name of each document with a link to be</span></div>
<div style="position:absolute;left:104.69px;top:541.54px" class="cls_004"><span class="cls_004">able the details page of each document. Add the following code in the div</span></div>
<div style="position:absolute;left:104.69px;top:554.14px" class="cls_004"><span class="cls_004">element with the class body.</span></div>
<div style="position:absolute;left:74.69px;top:577.35px" class="cls_010"><span class="cls_010">&lt;#list items as item&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 206 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:149396px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background222.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:74.69px;top:69.82px" class="cls_010"><span class="cls_010">&lt;p valign="top" class="whitepaper"&gt;</span></div>
<div style="position:absolute;left:90.89px;top:80.62px" class="cls_010"><span class="cls_010">&lt;a href="${url.context}/page/site/${item.site.shortName}/document-</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">details?nodeRef=${item.nodeRef}"&gt;</span></div>
<div style="position:absolute;left:90.89px;top:102.22px" class="cls_010"><span class="cls_010">${item.displayName}</span></div>
<div style="position:absolute;left:90.89px;top:113.02px" class="cls_010"><span class="cls_010">&lt;/a&gt;</span></div>
<div style="position:absolute;left:74.69px;top:123.82px" class="cls_010"><span class="cls_010">&lt;/p&gt;</span></div>
<div style="position:absolute;left:74.69px;top:134.62px" class="cls_010"><span class="cls_010">&lt;/#list&gt;</span></div>
<div style="position:absolute;left:124.19px;top:155.10px" class="cls_004"><span class="cls_004">Be careful, the code above will work only if whitepapers are stored in Share</span></div>
<div style="position:absolute;left:124.19px;top:167.70px" class="cls_004"><span class="cls_004">sites. If you store them somewhere else, you'll have an error.</span></div>
<div style="position:absolute;left:91.32px;top:189.43px" class="cls_004"><span class="cls_004">6. Finally, create the I18N property file whitepaper.get.properties in the same</span></div>
<div style="position:absolute;left:104.69px;top:202.03px" class="cls_004"><span class="cls_004">directory with the following line:</span></div>
<div style="position:absolute;left:74.69px;top:225.24px" class="cls_010"><span class="cls_010">someco.whitepaper.dashletName=SomeCoWhitePaper List</span></div>
<div style="position:absolute;left:91.32px;top:245.85px" class="cls_004"><span class="cls_004">7. Deploy, restart and test.</span></div>
<div style="position:absolute;left:56.69px;top:269.74px" class="cls_004"><span class="cls_004">To be able to test, login to Alfresco Share and opens your dashboard or any site dashboard.</span></div>
<div style="position:absolute;left:56.69px;top:282.34px" class="cls_004"><span class="cls_004">Click on the configuration icon in the top right corner, and select </span><span class="cls_007">CustomizeDashboard</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:294.98px" class="cls_004"><span class="cls_004">Then, click on </span><span class="cls_007">Add Dashlets</span><span class="cls_004"> and drag and drop the dashlet </span><span class="cls_007">List of whitepapers</span><span class="cls_004"> into the</span></div>
<div style="position:absolute;left:56.69px;top:307.62px" class="cls_007"><span class="cls_007">Column 1</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 207 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:150072px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background223.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you successfully added the dashlet, and you have some whitepapers already created in</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">your repository, you should be able to see the following documents. If you click on each</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">one, you should be able to open the details page of each document.</span></div>
<div style="position:absolute;left:56.69px;top:300.47px" class="cls_004"><span class="cls_004">The Marketing manager is really happy to be able to find all whitepapers in the entire</span></div>
<div style="position:absolute;left:56.69px;top:313.07px" class="cls_004"><span class="cls_004">repository so quickly. However, it will be very nice if we could filter between active and</span></div>
<div style="position:absolute;left:56.69px;top:325.67px" class="cls_004"><span class="cls_004">inactive whitepapers. To accomplish that, we are going to refactor everything and re-use a</span></div>
<div style="position:absolute;left:56.69px;top:338.27px" class="cls_004"><span class="cls_004">component already developed by Alfresco called </span><span class="cls_013">Alfresco.component.SimpleDocList</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:351.55px" class="cls_004"><span class="cls_004">This component provides everything to display a list of documents based on filters.</span></div>
<div style="position:absolute;left:56.69px;top:388.25px" class="cls_014"><span class="cls_014">Step-by-step - adding filters to your Dashlet</span></div>
<div style="position:absolute;left:56.69px;top:413.47px" class="cls_004"><span class="cls_004">In this section, we'll update our dashlet to use the SimpleDocList component, and</span></div>
<div style="position:absolute;left:56.69px;top:426.07px" class="cls_004"><span class="cls_004">implement two filters to display active and inactive whitepapers. To update the dashlet,</span></div>
<div style="position:absolute;left:56.69px;top:438.67px" class="cls_004"><span class="cls_004">follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:460.40px" class="cls_004"><span class="cls_004">1. Because we are going to re-use the Alfresco SimpleDocList component, we can</span></div>
<div style="position:absolute;left:104.69px;top:473.00px" class="cls_004"><span class="cls_004">remove the whitepaper.css that we created previously or you can just empty it.</span></div>
<div style="position:absolute;left:91.32px;top:487.76px" class="cls_004"><span class="cls_004">2. Open the directory </span><span class="cls_007">src|main|amp|config|alfresco|web-extension|site-</span></div>
<div style="position:absolute;left:104.69px;top:500.40px" class="cls_007"><span class="cls_007">webscripts</span><span class="cls_004">and locate the presentation web service that you developed previously</span></div>
<div style="position:absolute;left:104.69px;top:513.04px" class="cls_004"><span class="cls_004">in </span><span class="cls_007">site-webscripts|com|someco|components|dashlets</span><span class="cls_004">. Then, create the XML</span></div>
<div style="position:absolute;left:104.69px;top:525.67px" class="cls_004"><span class="cls_004">file whitepaper.get.config.xml that list all available filters.</span></div>
<div style="position:absolute;left:74.69px;top:548.88px" class="cls_010"><span class="cls_010">&lt;config&gt;</span></div>
<div style="position:absolute;left:96.29px;top:559.68px" class="cls_010"><span class="cls_010">&lt;filters&gt;</span></div>
<div style="position:absolute;left:117.89px;top:570.48px" class="cls_010"><span class="cls_010">&lt;filter type="active" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:581.28px" class="cls_010"><span class="cls_010">&lt;filter type="inactive" /&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 208 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:150748px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background224.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:96.29px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/filters&gt;</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:101.23px" class="cls_004"><span class="cls_004">3. In the same directory, update the I18N properties file whitepaper.get.properties</span></div>
<div style="position:absolute;left:104.69px;top:113.83px" class="cls_004"><span class="cls_004">and add the two following lines.</span></div>
<div style="position:absolute;left:74.69px;top:137.04px" class="cls_010"><span class="cls_010">filter.active=Active</span></div>
<div style="position:absolute;left:74.69px;top:147.84px" class="cls_010"><span class="cls_010">filter.inactive=Inactive</span></div>
<div style="position:absolute;left:91.32px;top:168.45px" class="cls_004"><span class="cls_004">4. In the same directory, we are going to update the Javascript controller</span></div>
<div style="position:absolute;left:104.69px;top:181.05px" class="cls_004"><span class="cls_004">whitepaper.get.js. You can just remove everything in this file. First, we need to</span></div>
<div style="position:absolute;left:104.69px;top:193.65px" class="cls_004"><span class="cls_004">import an Alfresco Javascript library that we'll use to retrieve the user</span></div>
<div style="position:absolute;left:104.69px;top:206.25px" class="cls_004"><span class="cls_004">preferences.</span></div>
<div style="position:absolute;left:74.69px;top:229.46px" class="cls_010"><span class="cls_010">&lt;import</span></div>
<div style="position:absolute;left:74.69px;top:240.26px" class="cls_010"><span class="cls_010">resource="classpath:/alfresco/templates/org/alfresco/import/alfresco-</span></div>
<div style="position:absolute;left:74.69px;top:251.06px" class="cls_010"><span class="cls_010">util.js"&gt;</span></div>
<div style="position:absolute;left:91.32px;top:271.67px" class="cls_004"><span class="cls_004">5. Then, we can implement the first method getFilters() that will be in charge of</span></div>
<div style="position:absolute;left:104.69px;top:284.27px" class="cls_004"><span class="cls_004">retrieving all available filters from the XML file created in the step 2.</span></div>
<div style="position:absolute;left:74.69px;top:307.48px" class="cls_010"><span class="cls_010">function getFilters()</span></div>
<div style="position:absolute;left:74.69px;top:318.28px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:74.69px;top:329.08px" class="cls_010"><span class="cls_010">var myConfig = new XML(config.script),</span></div>
<div style="position:absolute;left:96.29px;top:339.88px" class="cls_010"><span class="cls_010">filters = []</span></div>
<div style="position:absolute;left:90.89px;top:350.68px" class="cls_010"><span class="cls_010">for each (var xmlFilter in myConfig..filter)</span></div>
<div style="position:absolute;left:90.89px;top:361.48px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:96.29px;top:372.28px" class="cls_010"><span class="cls_010">if (xmlFilter.@evaluator.toString() === "" ||</span></div>
<div style="position:absolute;left:74.69px;top:383.08px" class="cls_010"><span class="cls_010">runEvaluator(xmlFilter.@evaluator.toString()))</span></div>
<div style="position:absolute;left:96.29px;top:393.88px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:96.29px;top:404.68px" class="cls_010"><span class="cls_010">filters.push(</span></div>
<div style="position:absolute;left:101.69px;top:415.48px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:107.09px;top:426.28px" class="cls_010"><span class="cls_010">type: xmlFilter.@type.toString(),</span></div>
<div style="position:absolute;left:107.09px;top:437.08px" class="cls_010"><span class="cls_010">parameters: xmlFilter.@parameters.toString()</span></div>
<div style="position:absolute;left:101.69px;top:447.88px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:96.29px;top:458.68px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:90.89px;top:469.48px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:90.89px;top:480.28px" class="cls_010"><span class="cls_010">return filters</span></div>
<div style="position:absolute;left:74.69px;top:491.08px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:511.69px" class="cls_004"><span class="cls_004">6. Add the following line that defines where is located the dashlet on the</span></div>
<div style="position:absolute;left:104.69px;top:524.29px" class="cls_004"><span class="cls_004">dashboard.</span></div>
<div style="position:absolute;left:74.69px;top:547.50px" class="cls_010"><span class="cls_010">var regionId = args['region-id'];</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 209 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:151424px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background225.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Populate the </span><span class="cls_013">model</span><span class="cls_004"> variable with the available filters and the user preferences.</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">We didn't talk about the </span><span class="cls_013">model</span><span class="cls_004"> variable. You'll discover more on the chapter</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_004"><span class="cls_004">dedicated to webscripts. To summarize, the model object is used to transmit</span></div>
<div style="position:absolute;left:104.69px;top:109.66px" class="cls_004"><span class="cls_004">variable between the controller and the Freemarker template. You could ask why</span></div>
<div style="position:absolute;left:104.69px;top:122.26px" class="cls_004"><span class="cls_004">do we need to get the user preferences. For example, if you selected inactive</span></div>
<div style="position:absolute;left:104.69px;top:134.86px" class="cls_004"><span class="cls_004">whitepapers, and then leave the page, we want to display inactive reports the</span></div>
<div style="position:absolute;left:104.69px;top:147.46px" class="cls_004"><span class="cls_004">next time that you open the same page. Append the following code to the</span></div>
<div style="position:absolute;left:104.69px;top:160.06px" class="cls_004"><span class="cls_004">Javascript file:</span></div>
<div style="position:absolute;left:74.69px;top:183.27px" class="cls_010"><span class="cls_010">model.preferences =</span></div>
<div style="position:absolute;left:74.69px;top:194.07px" class="cls_010"><span class="cls_010">AlfrescoUtil.getPreferences("org.alfresco.share.whitepaper.dashlet." +</span></div>
<div style="position:absolute;left:74.69px;top:204.87px" class="cls_010"><span class="cls_010">regionId);</span></div>
<div style="position:absolute;left:74.69px;top:215.67px" class="cls_010"><span class="cls_010">model.filters = getFilters();</span></div>
<div style="position:absolute;left:91.32px;top:236.28px" class="cls_004"><span class="cls_004">8. Then, add the main() method that we'll define our dashlet, and we need to create</span></div>
<div style="position:absolute;left:104.69px;top:248.88px" class="cls_004"><span class="cls_004">as well a resizer object to allow users to change the size of the dashlet.</span></div>
<div style="position:absolute;left:74.69px;top:272.09px" class="cls_010"><span class="cls_010">function main()</span></div>
<div style="position:absolute;left:74.69px;top:282.89px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:96.29px;top:293.69px" class="cls_010"><span class="cls_010">var whitepaper = {</span></div>
<div style="position:absolute;left:96.29px;top:304.49px" class="cls_010"><span class="cls_010">id : "Whitepaper",</span></div>
<div style="position:absolute;left:96.29px;top:315.29px" class="cls_010"><span class="cls_010">name : "Alfresco.dashlet.Whitepaper",</span></div>
<div style="position:absolute;left:96.29px;top:326.09px" class="cls_010"><span class="cls_010">options : {</span></div>
<div style="position:absolute;left:96.29px;top:336.89px" class="cls_010"><span class="cls_010">filter :model.preferences.filter != null ? model.preferences.filter :</span></div>
<div style="position:absolute;left:74.69px;top:347.69px" class="cls_010"><span class="cls_010">"active",</span></div>
<div style="position:absolute;left:96.29px;top:358.49px" class="cls_010"><span class="cls_010">regionId :regionId</span></div>
<div style="position:absolute;left:96.29px;top:369.29px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:90.89px;top:380.09px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:96.29px;top:390.89px" class="cls_010"><span class="cls_010">var dashletResizer = {</span></div>
<div style="position:absolute;left:112.49px;top:401.69px" class="cls_010"><span class="cls_010">id: "DashletResizer",</span></div>
<div style="position:absolute;left:107.09px;top:412.49px" class="cls_010"><span class="cls_010">name: "Alfresco.widget.DashletResizer",</span></div>
<div style="position:absolute;left:90.89px;top:423.29px" class="cls_010"><span class="cls_010">initArgs: [""" + args.htmlid + """, """ + instance.object.id + """],</span></div>
<div style="position:absolute;left:90.89px;top:434.09px" class="cls_010"><span class="cls_010">useMessages: false</span></div>
<div style="position:absolute;left:90.89px;top:444.89px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:74.69px;top:455.69px" class="cls_010"><span class="cls_010">model.widgets = [whitepaper, dashletResizer];</span></div>
<div style="position:absolute;left:74.69px;top:466.49px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:486.97px" class="cls_004"><span class="cls_004">You can find more information about the Alfresco Share client side Javascript API on this</span></div>
<div style="position:absolute;left:56.69px;top:499.57px" class="cls_004"><span class="cls_004">page. Unfortunately, it has not been updated with the 5.x version, but it's a very good</span></div>
<div style="position:absolute;left:56.69px;top:512.17px" class="cls_004"><span class="cls_004">source of information: </span><a href="http://sharextras.org/jsdoc/share/enterprise-4.0.0/">http://sharextras.org/jsdoc/share/enterprise-4.0.0/</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 210 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:152100px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background226.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Let's spend some time about the concept of widgets. In Alfresco Share, pages and dashlets</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">are mainly processed by webscripts. But when client side processing is required (like CSS or</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">Javascript), then we use the concept of widget. The Surf widgets use the YUI framework. In</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">our case above, we instantiate two widgets that will inherit out-of-the-box widgets available</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">in Alfresco Share. You'll see how to do that in the steps below.</span></div>
<div style="position:absolute;left:91.32px;top:142.63px" class="cls_004"><span class="cls_004">1. Finally, add the very important following line:</span></div>
<div style="position:absolute;left:96.29px;top:165.84px" class="cls_010"><span class="cls_010">main();</span></div>
<div style="position:absolute;left:91.32px;top:186.45px" class="cls_004"><span class="cls_004">2. You just completed the Javascript controller. Let's switch to the Freemarker</span></div>
<div style="position:absolute;left:104.69px;top:199.05px" class="cls_004"><span class="cls_004">template whitepaper.get.html.ftl located in the same directory. You can empty</span></div>
<div style="position:absolute;left:104.69px;top:211.65px" class="cls_004"><span class="cls_004">this file too, and we can restart from scratch. Then, add the three following</span></div>
<div style="position:absolute;left:104.69px;top:224.25px" class="cls_004"><span class="cls_004">dependencies to the CSS file (even if it's empty, let's keep it if we need it), the</span></div>
<div style="position:absolute;left:104.69px;top:236.85px" class="cls_004"><span class="cls_004">Javascript file that will create the document list and finally the widget creation</span></div>
<div style="position:absolute;left:104.69px;top:249.45px" class="cls_004"><span class="cls_004">that will trigger the display of the document list.</span></div>
<div style="position:absolute;left:74.69px;top:272.66px" class="cls_010"><span class="cls_010">&lt;@markup id="js"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:283.46px" class="cls_010"><span class="cls_010">&lt;@script type="text/javascript" src="${url.context}/res/components</span></div>
<div style="position:absolute;left:96.29px;top:294.26px" class="cls_010"><span class="cls_010">/dashlets/whitepaper.js" group="dashlets"/&gt;</span></div>
<div style="position:absolute;left:74.69px;top:305.06px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:74.69px;top:315.86px" class="cls_010"><span class="cls_010">&lt;@markup id="css"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:326.66px" class="cls_010"><span class="cls_010">&lt;@link rel="stylesheet" type="text/css" href="${url.context}/res</span></div>
<div style="position:absolute;left:117.89px;top:337.46px" class="cls_010"><span class="cls_010">/components/dashlets/whitepaper.css" group="dashlets"/&gt;</span></div>
<div style="position:absolute;left:74.69px;top:348.26px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:74.69px;top:359.06px" class="cls_010"><span class="cls_010">&lt;@markup id="widgets"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:369.86px" class="cls_010"><span class="cls_010">&lt;@createWidgets group="dashlets"/&gt;</span></div>
<div style="position:absolute;left:74.69px;top:380.66px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:122.09px;top:401.14px" class="cls_004"><span class="cls_004">If you want to know more about the template markup for widgets, you</span></div>
<div style="position:absolute;left:122.09px;top:413.74px" class="cls_004"><span class="cls_004">can look at the following documentation: </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-template-markup.html">http://docs.alfresco.com/5.</a> </div>
<div style="position:absolute;left:122.09px;top:426.72px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/dev-extensions-share-template-markup.html">1/concepts/dev-extensions-share-template-markup.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 211 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:152776px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background227.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Then, create the structure of the dashlet.</span></div>
<div style="position:absolute;left:74.69px;top:93.71px" class="cls_010"><span class="cls_010">&lt;@markup id="html"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:104.51px" class="cls_010"><span class="cls_010">&lt;@uniqueIdDiv&gt;</span></div>
<div style="position:absolute;left:117.89px;top:115.31px" class="cls_010"><span class="cls_010">&lt;#assign id = args.htmlid&gt;</span></div>
<div style="position:absolute;left:117.89px;top:126.11px" class="cls_010"><span class="cls_010">&lt;#assign prefFilter = preferences.filter!"active"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:136.91px" class="cls_010"><span class="cls_010">&lt;div class="dashlet whitepaper resizable yui-resize"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:158.51px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:96.29px;top:169.31px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:74.69px;top:180.11px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:124.19px;top:200.59px" class="cls_004"><span class="cls_004">You may ask why we should implement this kind of HTML and re-using</span></div>
<div style="position:absolute;left:124.19px;top:213.19px" class="cls_004"><span class="cls_004">these CSS classes. The best way to know what you need to use is to look at all</span></div>
<div style="position:absolute;left:124.19px;top:225.79px" class="cls_004"><span class="cls_004">dashlets out-of-the-box already available in Alfresco Share. And for that, you</span></div>
<div style="position:absolute;left:124.19px;top:238.39px" class="cls_004"><span class="cls_004">can check into the Share web application, in the folder WEB-</span></div>
<div style="position:absolute;left:124.19px;top:250.99px" class="cls_004"><span class="cls_004">INF|classes|alfresco|site-webscripts|org|alfresco|components|dashlets.</span></div>
<div style="position:absolute;left:91.32px;top:272.72px" class="cls_004"><span class="cls_004">4. Locate the div element with the class dashlet, and add the HTML code</span></div>
<div style="position:absolute;left:104.69px;top:285.32px" class="cls_004"><span class="cls_004">representing the title.</span></div>
<div style="position:absolute;left:74.69px;top:308.53px" class="cls_010"><span class="cls_010">&lt;div class="title"&gt;${msg("someco.whitepaper.dashletName")}&lt;/div&gt;</span></div>
<div style="position:absolute;left:91.32px;top:329.14px" class="cls_004"><span class="cls_004">5. Then, append the HTML code that will display the list of filters. If you look</span></div>
<div style="position:absolute;left:104.69px;top:341.74px" class="cls_004"><span class="cls_004">carefully, the Freemarker code iterates over the variable filters that we initialized</span></div>
<div style="position:absolute;left:104.69px;top:354.34px" class="cls_004"><span class="cls_004">in the Javascript controller.</span></div>
<div style="position:absolute;left:74.69px;top:377.55px" class="cls_010"><span class="cls_010">&lt;div class="toolbar flat-button"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:388.35px" class="cls_010"><span class="cls_010">&lt;div class="hidden"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:399.15px" class="cls_010"><span class="cls_010">&lt;span class="align-left yui-button yui-menu-button" id="${id}-</span></div>
<div style="position:absolute;left:74.69px;top:409.95px" class="cls_010"><span class="cls_010">filters"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:420.75px" class="cls_010"><span class="cls_010">&lt;span class="first-child"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:431.55px" class="cls_010"><span class="cls_010">&lt;button type="button" tabindex="0"&gt;&lt;/button&gt;</span></div>
<div style="position:absolute;left:117.89px;top:442.35px" class="cls_010"><span class="cls_010">&lt;/span&gt;</span></div>
<div style="position:absolute;left:117.89px;top:453.15px" class="cls_010"><span class="cls_010">&lt;/span&gt;</span></div>
<div style="position:absolute;left:117.89px;top:463.95px" class="cls_010"><span class="cls_010">&lt;select id="${id}-filters-menu"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:474.75px" class="cls_010"><span class="cls_010">&lt;#list filters as filter&gt;</span></div>
<div style="position:absolute;left:139.49px;top:485.55px" class="cls_010"><span class="cls_010">&lt;option value="${filter.type?html}"&gt;${msg("filter." +</span></div>
<div style="position:absolute;left:74.69px;top:496.35px" class="cls_010"><span class="cls_010">filter.type)}&lt;/option&gt;</span></div>
<div style="position:absolute;left:117.89px;top:507.15px" class="cls_010"><span class="cls_010">&lt;/#list&gt;</span></div>
<div style="position:absolute;left:96.29px;top:517.95px" class="cls_010"><span class="cls_010">&lt;/select&gt;</span></div>
<div style="position:absolute;left:96.29px;top:528.75px" class="cls_010"><span class="cls_010">&lt;div class="clear"&gt;&lt;/div&gt;</span></div>
<div style="position:absolute;left:96.29px;top:539.55px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:74.69px;top:550.35px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 212 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:153452px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background228.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. And finally, append the HTML code that will represent the body of the dashlet</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">that will contain the list of documents.</span></div>
<div style="position:absolute;left:74.69px;top:106.31px" class="cls_010"><span class="cls_010">&lt;div class="body scrollableList" &lt;#if args.height??&gt;style="height:</span></div>
<div style="position:absolute;left:74.69px;top:117.11px" class="cls_010"><span class="cls_010">${args.height?html}px;"&lt;/#if&gt;&gt;</span></div>
<div style="position:absolute;left:96.29px;top:127.91px" class="cls_010"><span class="cls_010">&lt;div id="${id}-documents"&gt;&lt;/div&gt;</span></div>
<div style="position:absolute;left:74.69px;top:138.71px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:91.32px;top:159.32px" class="cls_004"><span class="cls_004">7. The dashlet is ready. We just need to create the Javascript file whitepaper.js in</span></div>
<div style="position:absolute;left:104.69px;top:171.92px" class="cls_004"><span class="cls_004">charge of the creation of the document list. This file should be in</span></div>
<div style="position:absolute;left:104.69px;top:184.52px" class="cls_007"><span class="cls_007">share|src|main|amp|web|components|dashlets</span><span class="cls_004">. First, we are going to create</span></div>
<div style="position:absolute;left:104.69px;top:197.16px" class="cls_004"><span class="cls_004">the skeleton of the Javascript file.</span></div>
<div style="position:absolute;left:74.69px;top:220.37px" class="cls_010"><span class="cls_010">(function() {</span></div>
<div style="position:absolute;left:90.89px;top:231.17px" class="cls_010"><span class="cls_010">var Selector = YAHOO.util.Selector;</span></div>
<div style="position:absolute;left:90.89px;top:241.97px" class="cls_010"><span class="cls_010">Alfresco.dashlet.Whitepaper = function Whitepaper_constructor(htmlId) {</span></div>
<div style="position:absolute;left:123.29px;top:252.77px" class="cls_010"><span class="cls_010">return</span></div>
<div style="position:absolute;left:74.69px;top:263.57px" class="cls_010"><span class="cls_010">Alfresco.dashlet.Whitepaper.superclass.constructor.call(this, htmlId);</span></div>
<div style="position:absolute;left:90.89px;top:274.37px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:90.89px;top:295.97px" class="cls_010"><span class="cls_010">YAHOO.extend(Alfresco.dashlet.Whitepaper,</span></div>
<div style="position:absolute;left:74.69px;top:306.77px" class="cls_010"><span class="cls_010">Alfresco.component.SimpleDocList, {</span></div>
<div style="position:absolute;left:123.29px;top:317.57px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:90.89px;top:328.37px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:74.69px;top:339.17px" class="cls_010"><span class="cls_010">})();</span></div>
<div style="position:absolute;left:124.19px;top:359.65px" class="cls_004"><span class="cls_004">You may find this start a bit scaring. The easiest way to start your new</span></div>
<div style="position:absolute;left:124.19px;top:372.25px" class="cls_004"><span class="cls_004">dashlet is usualy just to re-use an existing dashlet (following the same</span></div>
<div style="position:absolute;left:124.19px;top:384.85px" class="cls_004"><span class="cls_004">process as the Freemarker template. All Javascript files used in the out-of-the-</span></div>
<div style="position:absolute;left:124.19px;top:397.45px" class="cls_004"><span class="cls_004">box dashlets are located in components|dashlets in the Share web</span></div>
<div style="position:absolute;left:124.19px;top:410.05px" class="cls_004"><span class="cls_004">application.</span></div>
<div style="position:absolute;left:91.32px;top:431.78px" class="cls_004"><span class="cls_004">8. As you see in the previous code snippet, our dashlet extends the Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:444.38px" class="cls_004"><span class="cls_004">component SimpleDocList but we need to configure it. Insert the following code</span></div>
<div style="position:absolute;left:104.69px;top:456.98px" class="cls_004"><span class="cls_004">in the YAHOO.extend statement.</span></div>
<div style="position:absolute;left:74.69px;top:480.19px" class="cls_010"><span class="cls_010">PREFERENCES_WHITEPAPER_DASHLET : "",</span></div>
<div style="position:absolute;left:74.69px;top:490.99px" class="cls_010"><span class="cls_010">PREFERENCES_WHITEPAPER_DASHLET_FILTER : "",</span></div>
<div style="position:absolute;left:74.69px;top:501.79px" class="cls_010"><span class="cls_010">onReady : function Whitepaper_onReady() {</span></div>
<div style="position:absolute;left:90.89px;top:512.59px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:74.69px;top:523.39px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:74.69px;top:534.19px" class="cls_010"><span class="cls_010">getParameters : function Whitepaper_getParameters() {</span></div>
<div style="position:absolute;left:90.89px;top:544.99px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:74.69px;top:555.79px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:74.69px;top:566.59px" class="cls_010"><span class="cls_010">getWebscriptUrl : function Whitepaper_getWebscriptUrl() {</span></div>
<div style="position:absolute;left:90.89px;top:577.39px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 213 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:154128px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background229.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:74.69px;top:69.82px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">onFilterChange : function Whitepaper_onFilterChange(p_sType, p_aArgs) {</span></div>
<div style="position:absolute;left:90.89px;top:91.42px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:74.69px;top:102.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:122.09px;top:122.70px" class="cls_004"><span class="cls_004">You can find more information about this Javascript component on this</span></div>
<div style="position:absolute;left:122.09px;top:135.30px" class="cls_004"><span class="cls_004">page: </span><a href="http://sharextras.org/jsdoc/share/enterprise-4.0.0/symbols/Alfresco.component.SimpleDocList.html">http://sharextras.org/jsdoc/share/enterprise-4.0.0/symbol</a> </div>
<div style="position:absolute;left:122.09px;top:148.28px" class="cls_010"><span class="cls_010"> </span><a href="http://sharextras.org/jsdoc/share/enterprise-4.0.0/symbols/Alfresco.component.SimpleDocList.html">s/Alfresco.component.SimpleDocList.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:182.23px" class="cls_004"><span class="cls_004">9. Now, we are going to populate each method. Let's start by getWebscriptUrl(). We</span></div>
<div style="position:absolute;left:104.69px;top:194.83px" class="cls_004"><span class="cls_004">are going to use the same webscript.</span></div>
<div style="position:absolute;left:74.69px;top:218.04px" class="cls_010"><span class="cls_010">getWebscriptUrl : function Whitepaper_getWebscriptUrl() {</span></div>
<div style="position:absolute;left:85.49px;top:228.84px" class="cls_010"><span class="cls_010">return Alfresco.constants.PROXY_URI + "slingshot/search";</span></div>
<div style="position:absolute;left:74.69px;top:239.64px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:124.19px;top:260.12px" class="cls_004"><span class="cls_004">You may wonder where comes from the variable</span></div>
<div style="position:absolute;left:124.19px;top:272.72px" class="cls_013"><span class="cls_013">Alfresco.constants.PROXY_URI</span><span class="cls_004">. This is one of the Javascript variable</span></div>
<div style="position:absolute;left:124.19px;top:286.00px" class="cls_004"><span class="cls_004">that is always available on every page. These variables are defined in the</span></div>
<div style="position:absolute;left:124.19px;top:298.60px" class="cls_004"><span class="cls_004">following freemarker file </span><span class="cls_013">WEB-INF|classes|alfresco|site-</span></div>
<div style="position:absolute;left:124.19px;top:311.10px" class="cls_013"><span class="cls_013">webscripts|org|alfresco|components|head|resources.get.html.f</span></div>
<div style="position:absolute;left:124.19px;top:323.88px" class="cls_013"><span class="cls_013">tl</span><span class="cls_004"> in the Share web application. If you look at the source code of all Alfresco</span></div>
<div style="position:absolute;left:124.19px;top:337.16px" class="cls_004"><span class="cls_004">Share pages, you'll notice that this variable is defined.</span></div>
<div style="position:absolute;left:86.07px;top:358.89px" class="cls_004"><span class="cls_004">10. Then, we populate the </span><span class="cls_013">getParameters()</span><span class="cls_004"> method that will be called each time</span></div>
<div style="position:absolute;left:104.69px;top:372.17px" class="cls_004"><span class="cls_004">that the list of documents is loaded. We'll use the same query as previously, but</span></div>
<div style="position:absolute;left:104.69px;top:384.77px" class="cls_004"><span class="cls_004">we'll add a new filter on the property sc:isActive.</span></div>
<div style="position:absolute;left:74.69px;top:407.98px" class="cls_010"><span class="cls_010">getParameters : function Whitepaper_getParameters() {</span></div>
<div style="position:absolute;left:74.69px;top:418.78px" class="cls_010"><span class="cls_010">var param = "term=";</span></div>
<div style="position:absolute;left:74.69px;top:429.58px" class="cls_010"><span class="cls_010">var query = "+TYPE:sc\\:whitepaper";</span></div>
<div style="position:absolute;left:74.69px;top:440.38px" class="cls_010"><span class="cls_010">if (this.widgets.filter.value == "inactive")</span></div>
<div style="position:absolute;left:96.29px;top:451.18px" class="cls_010"><span class="cls_010">query += " +sc\\:isActive:false";</span></div>
<div style="position:absolute;left:85.49px;top:461.98px" class="cls_010"><span class="cls_010">else</span></div>
<div style="position:absolute;left:96.29px;top:472.78px" class="cls_010"><span class="cls_010">query += " +sc\\:isActive:true";</span></div>
<div style="position:absolute;left:74.69px;top:483.58px" class="cls_010"><span class="cls_010">param += encodeURIComponent(query);</span></div>
<div style="position:absolute;left:85.49px;top:494.38px" class="cls_010"><span class="cls_010">return param;</span></div>
<div style="position:absolute;left:74.69px;top:505.18px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 214 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:154804px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background230.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. Then, we need to populate the method onFilterChange() that will update the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">selected value, save the filter in the user preferences and reload the document list.</span></div>
<div style="position:absolute;left:74.69px;top:106.31px" class="cls_010"><span class="cls_010">onFilterChange : function Whitepaper_onFilterChange(p_sType, p_aArgs) {</span></div>
<div style="position:absolute;left:74.69px;top:117.11px" class="cls_010"><span class="cls_010">var menuItem = p_aArgs[1];</span></div>
<div style="position:absolute;left:85.49px;top:127.91px" class="cls_010"><span class="cls_010">if (menuItem) {</span></div>
<div style="position:absolute;left:74.69px;top:138.71px" class="cls_010"><span class="cls_010">this.widgets.filter.set("label", menuItem.cfg.getProperty("text") + " " +</span></div>
<div style="position:absolute;left:74.69px;top:149.51px" class="cls_010"><span class="cls_010">Alfresco.constants.MENU_ARROW_SYMBOL);</span></div>
<div style="position:absolute;left:74.69px;top:160.31px" class="cls_010"><span class="cls_010">this.widgets.filter.value = menuItem.value;</span></div>
<div style="position:absolute;left:74.69px;top:171.11px" class="cls_010"><span class="cls_010">this.services.preferences.set(this.PREFERENCES_WHITEPAPER_DASHLET_FILTER,</span></div>
<div style="position:absolute;left:74.69px;top:181.91px" class="cls_010"><span class="cls_010">this.widgets.filter.value);</span></div>
<div style="position:absolute;left:74.69px;top:192.71px" class="cls_010"><span class="cls_010">this.reloadDataTable();</span></div>
<div style="position:absolute;left:85.49px;top:203.51px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:214.31px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:234.92px" class="cls_004"><span class="cls_004">12. Finally, we'll work on the onReady() method which is the longest one. We'll go</span></div>
<div style="position:absolute;left:104.69px;top:247.52px" class="cls_004"><span class="cls_004">step by step. First, we populate the two global variables.</span></div>
<div style="position:absolute;left:74.69px;top:270.73px" class="cls_010"><span class="cls_010">this.PREFERENCES_WHITEPAPER_DASHLET =</span></div>
<div style="position:absolute;left:74.69px;top:281.53px" class="cls_010"><span class="cls_010">this.services.preferences.getDashletId(this, "whitepaper");</span></div>
<div style="position:absolute;left:74.69px;top:292.33px" class="cls_010"><span class="cls_010">this.PREFERENCES_WHITEPAPER_DASHLET_FILTER =</span></div>
<div style="position:absolute;left:74.69px;top:303.13px" class="cls_010"><span class="cls_010">this.PREFERENCES_WHITEPAPER_DASHLET + ".filter";</span></div>
<div style="position:absolute;left:86.07px;top:323.74px" class="cls_004"><span class="cls_004">13. Then, we create the dropdown filter.</span></div>
<div style="position:absolute;left:74.69px;top:346.95px" class="cls_010"><span class="cls_010">this.widgets.filter = Alfresco.util.createYUIButton(this, "filters",</span></div>
<div style="position:absolute;left:74.69px;top:357.75px" class="cls_010"><span class="cls_010">this.onFilterChange, {</span></div>
<div style="position:absolute;left:74.69px;top:368.55px" class="cls_010"><span class="cls_010">type : "menu",</span></div>
<div style="position:absolute;left:74.69px;top:379.35px" class="cls_010"><span class="cls_010">menu : "filters-menu",</span></div>
<div style="position:absolute;left:74.69px;top:390.15px" class="cls_010"><span class="cls_010">lazyloadmenu : false</span></div>
<div style="position:absolute;left:74.69px;top:400.95px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:122.09px;top:421.43px" class="cls_004"><span class="cls_004">You can check the following documentation to have more information on</span></div>
<div style="position:absolute;left:122.09px;top:434.03px" class="cls_004"><span class="cls_004">Alfresco.util: </span><a href="http://sharextras.org/jsdoc/share/enterprise-4.0.0/symbols/Alfresco.util.html">http://sharextras.org/jsdoc/share/enterprise-4.0.</a> </div>
<div style="position:absolute;left:122.09px;top:447.01px" class="cls_010"><span class="cls_010"> </span><a href="http://sharextras.org/jsdoc/share/enterprise-4.0.0/symbols/Alfresco.util.html">0/symbols/Alfresco.util.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:480.96px" class="cls_004"><span class="cls_004">14. We retrieve the current filter, and we update the widget properties. Then, we</span></div>
<div style="position:absolute;left:104.69px;top:493.56px" class="cls_004"><span class="cls_004">specify that we want to use the simple view mode of the document list.</span></div>
<div style="position:absolute;left:74.69px;top:516.77px" class="cls_010"><span class="cls_010">var filter = this.options.filter;</span></div>
<div style="position:absolute;left:74.69px;top:527.57px" class="cls_010"><span class="cls_010">filter = filter != null ? filter : "active";</span></div>
<div style="position:absolute;left:74.69px;top:538.37px" class="cls_010"><span class="cls_010">this.widgets.filter.set("label", this.msg("filter." + filter) + " " +</span></div>
<div style="position:absolute;left:74.69px;top:549.17px" class="cls_010"><span class="cls_010">Alfresco.constants.MENU_ARROW_SYMBOL);</span></div>
<div style="position:absolute;left:74.69px;top:559.97px" class="cls_010"><span class="cls_010">this.widgets.filter.value = filter;</span></div>
<div style="position:absolute;left:74.69px;top:570.77px" class="cls_010"><span class="cls_010">this.options.simpleView = true;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 215 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:155480px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background231.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">15. The toolbar is now created; we can remove the hidden CSS class to make it</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">visible.</span></div>
<div style="position:absolute;left:74.69px;top:106.31px" class="cls_010"><span class="cls_010">Dom.removeClass(Selector.query(".toolbar div", this.id, true), "hidden");</span></div>
<div style="position:absolute;left:86.07px;top:126.92px" class="cls_004"><span class="cls_004">16. Then, we can call the parent method in the SimpleDocList component that will</span></div>
<div style="position:absolute;left:104.69px;top:139.52px" class="cls_004"><span class="cls_004">create the YUI2 datatable.</span></div>
<div style="position:absolute;left:74.69px;top:162.73px" class="cls_010"><span class="cls_010">Alfresco.dashlet.Whitepaper.superclass.onReady.apply(this, arguments);</span></div>
<div style="position:absolute;left:86.07px;top:183.34px" class="cls_004"><span class="cls_004">17. Unfortunately, the JSON returned by the Alfresco Search API doesn't match</span></div>
<div style="position:absolute;left:104.69px;top:195.94px" class="cls_004"><span class="cls_004">what's expected by the </span><span class="cls_013">SimpleDocList</span><span class="cls_004"> component. For example, the filename is</span></div>
<div style="position:absolute;left:104.69px;top:209.22px" class="cls_004"><span class="cls_004">returned in a field called name, but the </span><span class="cls_013">SimpleDocList</span><span class="cls_004"> component is expecting</span></div>
<div style="position:absolute;left:104.69px;top:222.50px" class="cls_004"><span class="cls_004">it in the field </span><span class="cls_013">fieldName</span><span class="cls_004">. Some minor other changes need to be done is the</span></div>
<div style="position:absolute;left:104.69px;top:235.78px" class="cls_013"><span class="cls_013">onReady</span><span class="cls_004"> function. To accomplish that, we'll bind the event</span></div>
<div style="position:absolute;left:104.69px;top:249.06px" class="cls_013"><span class="cls_013">onDataReturnSetRows</span><span class="cls_004"> provided by the YUI2 </span><span class="cls_013">DataTable</span><span class="cls_004"> component (this</span></div>
<div style="position:absolute;left:104.69px;top:262.34px" class="cls_004"><span class="cls_004">DataTableYUI component is the one used by the </span><span class="cls_013">SimpleDocList</span><span class="cls_004"> component).</span></div>
<div style="position:absolute;left:74.69px;top:286.23px" class="cls_010"><span class="cls_010">var me = this,</span></div>
<div style="position:absolute;left:74.69px;top:297.03px" class="cls_010"><span class="cls_010">dataTable = this.widgets.alfrescoDataTable.getDataTable(),</span></div>
<div style="position:absolute;left:74.69px;top:307.83px" class="cls_010"><span class="cls_010">original_onDataReturnSetRows = dataTable.onDataReturnSetRows;</span></div>
<div style="position:absolute;left:74.69px;top:329.43px" class="cls_010"><span class="cls_010">dataTable.onDataReturnSetRows = function</span></div>
<div style="position:absolute;left:74.69px;top:340.23px" class="cls_010"><span class="cls_010">Whitepaper_onDataReturnSetRows(sRequest, oResponse, oPayload) {</span></div>
<div style="position:absolute;left:85.49px;top:351.03px" class="cls_010"><span class="cls_010">if (oResponse.results&amp;&amp;oResponse.results.length&gt; 0) {</span></div>
<div style="position:absolute;left:96.29px;top:361.83px" class="cls_010"><span class="cls_010">for (var i = 0; i&lt;oResponse.results.length; i++) {</span></div>
<div style="position:absolute;left:74.69px;top:372.63px" class="cls_010"><span class="cls_010">oResponse.results[i].fileName = oResponse.results[i].name;</span></div>
<div style="position:absolute;left:74.69px;top:383.43px" class="cls_010"><span class="cls_010">oResponse.results[i].location = {</span></div>
<div style="position:absolute;left:117.89px;top:394.23px" class="cls_010"><span class="cls_010">site: oResponse.results[i].site.shortName,</span></div>
<div style="position:absolute;left:74.69px;top:405.03px" class="cls_010"><span class="cls_010">siteTitle: oResponse.results[i].site.title</span></div>
<div style="position:absolute;left:107.09px;top:415.83px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:74.69px;top:426.63px" class="cls_010"><span class="cls_010">oResponse.results[i].permissions = {</span></div>
<div style="position:absolute;left:74.69px;top:437.43px" class="cls_010"><span class="cls_010">userAccess: {</span></div>
<div style="position:absolute;left:128.69px;top:448.23px" class="cls_010"><span class="cls_010">create: false</span></div>
<div style="position:absolute;left:117.89px;top:459.03px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:107.09px;top:469.83px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:96.29px;top:480.63px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:85.49px;top:491.43px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:85.49px;top:502.23px" class="cls_010"><span class="cls_010">return original_onDataReturnSetRows.apply(this, arguments);</span></div>
<div style="position:absolute;left:74.69px;top:513.03px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:86.07px;top:533.64px" class="cls_004"><span class="cls_004">18. Deploy, package and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 216 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:156156px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background232.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Login to Alfresco Share and check your dashboard, the new dashlet should be used</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">automatically. In the list of filters, you should be able to select </span><span class="cls_007">Active</span><span class="cls_004"> or </span><span class="cls_007">Inactive</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:95.74px" class="cls_004"><span class="cls_004">Automatically, the list of documents should be refreshed.</span></div>
<div style="position:absolute;left:56.69px;top:198.51px" class="cls_004"><span class="cls_004">You can notice that we display more information now. We display the modified date, and</span></div>
<div style="position:absolute;left:56.69px;top:211.11px" class="cls_004"><span class="cls_004">we can see in which site the document is stored.</span></div>
<div style="position:absolute;left:56.69px;top:388.13px" class="cls_004"><span class="cls_004">Finally, if you select the filter </span><span class="cls_007">Inactive</span><span class="cls_004"> and then change pages, reload the page, or close your</span></div>
<div style="position:absolute;left:56.69px;top:400.77px" class="cls_004"><span class="cls_004">browser, the next time that the dashboard will be displayed, the last filter value should be</span></div>
<div style="position:absolute;left:56.69px;top:413.37px" class="cls_004"><span class="cls_004">used.</span></div>
<div style="position:absolute;left:56.69px;top:434.97px" class="cls_004"><span class="cls_004">When you start to implement a dashlet, always check if one of the Alfresco out-of-the-box</span></div>
<div style="position:absolute;left:56.69px;top:447.57px" class="cls_004"><span class="cls_004">ones can't be used to meet your requirements. If it's not the case, you can take a look at</span></div>
<div style="position:absolute;left:56.69px;top:460.17px" class="cls_010"><span class="cls_010"> </span><a href="https://addons.alfresco.com/">https://addons.alfresco.com/</a> <span class="cls_004"> that contains a lot of open-source extensions.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 217 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:156832px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background233.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Create custom pages</span></div>
<div style="position:absolute;left:56.69px;top:97.39px" class="cls_004"><span class="cls_004">You discovered in the</span><span class="cls_010">Chapter 2</span><span class="cls_004">, </span><span class="cls_012">Getting Started with Alfresco</span><span class="cls_004">, that Alfresco Share is based</span></div>
<div style="position:absolute;left:56.69px;top:110.37px" class="cls_004"><span class="cls_004">on the concept of pages. In each site, you can add or remove pages depending of the use of</span></div>
<div style="position:absolute;left:56.69px;top:122.97px" class="cls_004"><span class="cls_004">this site. Alfresco Share already provides out-of-the-box pages like </span><span class="cls_007">Document Library</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:135.60px" class="cls_007"><span class="cls_007">Calendar</span><span class="cls_004">, </span><span class="cls_007">Wiki</span><span class="cls_004">, </span><span class="cls_007">Discussions</span><span class="cls_004">, </span><span class="cls_007">Blog</span><span class="cls_004">, </span><span class="cls_007">Links</span><span class="cls_004"> or </span><span class="cls_007">Data Lists</span><span class="cls_004">. In the previous section, we</span></div>
<div style="position:absolute;left:56.69px;top:148.24px" class="cls_004"><span class="cls_004">discovered how to create new dashlets to your different dashboards to be able to display</span></div>
<div style="position:absolute;left:56.69px;top:160.84px" class="cls_004"><span class="cls_004">custom content. Sometimes, the use of dahslets is not sufficient, and you want to display</span></div>
<div style="position:absolute;left:56.69px;top:173.44px" class="cls_004"><span class="cls_004">more information and more features. In this case, you need to create a new Surf page.</span></div>
<div style="position:absolute;left:56.69px;top:195.04px" class="cls_004"><span class="cls_004">In this section, we'll:</span></div>
<div style="position:absolute;left:104.69px;top:216.77px" class="cls_004"><span class="cls_004">Create a new page that you'll be able to add to any Share site;</span></div>
<div style="position:absolute;left:104.69px;top:231.53px" class="cls_004"><span class="cls_004">Use the CMIS 1.1 API directly from Alfresco Share;</span></div>
<div style="position:absolute;left:104.69px;top:246.30px" class="cls_004"><span class="cls_004">Create a simple Angular page to display all </span><span class="cls_012">webable</span><span class="cls_004"> documents in a site.</span></div>
<div style="position:absolute;left:56.69px;top:285.29px" class="cls_014"><span class="cls_014">Step-by-step - create a new page to list all</span></div>
<div style="position:absolute;left:56.69px;top:306.89px" class="cls_014"><span class="cls_014">Webable documents</span></div>
<div style="position:absolute;left:56.69px;top:332.11px" class="cls_004"><span class="cls_004">In this section, we'll create a new Surf page addable to any Share site where the users will</span></div>
<div style="position:absolute;left:56.69px;top:344.71px" class="cls_004"><span class="cls_004">be able to list all webable documents in this site, and to filter quickly these documents. We'll</span></div>
<div style="position:absolute;left:56.69px;top:357.31px" class="cls_004"><span class="cls_004">introduce the use of the </span><span class="cls_007">Angular </span><span class="cls_004">Javascript framework. We won't go into details on how or</span></div>
<div style="position:absolute;left:56.69px;top:369.94px" class="cls_004"><span class="cls_004">why we use </span><span class="cls_007">Angular</span><span class="cls_004">. You'll get more information on this framework in the next chapter.</span></div>
<div style="position:absolute;left:91.32px;top:391.71px" class="cls_004"><span class="cls_004">1. Let's start by the Surf page definition XML file. In the share project, locate the</span></div>
<div style="position:absolute;left:104.69px;top:404.31px" class="cls_004"><span class="cls_004">directory </span><span class="cls_013">src|main|amp|config|alfresco|web-extensions|site-data</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:417.59px" class="cls_004"><span class="cls_004">Create the sub-directory pages. In this directory, create the file </span><span class="cls_013">someco-</span></div>
<div style="position:absolute;left:104.69px;top:430.09px" class="cls_013"><span class="cls_013">webable.xml.</span></div>
<div style="position:absolute;left:74.69px;top:453.48px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:96.29px;top:464.28px" class="cls_010"><span class="cls_010">&lt;page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:475.08px" class="cls_010"><span class="cls_010">&lt;title&gt;SomecoWebable Documents&lt;/title&gt;</span></div>
<div style="position:absolute;left:117.89px;top:485.88px" class="cls_010"><span class="cls_010">&lt;title-id&gt;page.someco.webable.title&lt;/title-id&gt;</span></div>
<div style="position:absolute;left:117.89px;top:496.68px" class="cls_010"><span class="cls_010">&lt;description&gt;List all documents with the Webable</span></div>
<div style="position:absolute;left:74.69px;top:507.48px" class="cls_010"><span class="cls_010">aspect&lt;/description&gt;</span></div>
<div style="position:absolute;left:117.89px;top:518.28px" class="cls_010"><span class="cls_010">&lt;description-id&gt;page.someco.webable.description&lt;/description-id&gt;</span></div>
<div style="position:absolute;left:117.89px;top:529.08px" class="cls_010"><span class="cls_010">&lt;template-instance&gt;someco-webable&lt;/template-instance&gt;</span></div>
<div style="position:absolute;left:96.29px;top:539.88px" class="cls_010"><span class="cls_010">&lt;/page&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 218 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:157508px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background234.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. The template instance defined in this code has to match the filename listed in the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">next step.</span></div>
<div style="position:absolute;left:91.32px;top:97.86px" class="cls_004"><span class="cls_004">3. Then, in the same site-data directory. Create the sub-directory template-instances.</span></div>
<div style="position:absolute;left:104.69px;top:110.46px" class="cls_004"><span class="cls_004">Create the template instance XML file someco-webable.xml that will define the</span></div>
<div style="position:absolute;left:104.69px;top:123.06px" class="cls_004"><span class="cls_004">path of the Freemarker template file.</span></div>
<div style="position:absolute;left:74.69px;top:146.27px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:74.69px;top:157.07px" class="cls_010"><span class="cls_010">&lt;template-instance&gt;</span></div>
<div style="position:absolute;left:96.29px;top:167.87px" class="cls_010"><span class="cls_010">&lt;template-type&gt;com/someco/pages/webable&lt;/template-type&gt;</span></div>
<div style="position:absolute;left:74.69px;top:178.67px" class="cls_010"><span class="cls_010">&lt;/template-instance&gt;</span></div>
<div style="position:absolute;left:91.32px;top:199.28px" class="cls_004"><span class="cls_004">4. The template type in this case is the path where to find the Freemarker template</span></div>
<div style="position:absolute;left:104.69px;top:211.88px" class="cls_004"><span class="cls_004">that will be used for rendering.</span></div>
<div style="position:absolute;left:91.32px;top:226.64px" class="cls_004"><span class="cls_004">5. Locate the directory </span><span class="cls_013">src|main|amp|config|alfresco|web-</span></div>
<div style="position:absolute;left:104.69px;top:239.92px" class="cls_013"><span class="cls_013">extensions|site-webscripts</span><span class="cls_004">. Create the sub-directory </span><span class="cls_013">com|someco|pages</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:253.20px" class="cls_004"><span class="cls_004">Then, create the Freemarker file webable.ftl that will generate the page. Add the</span></div>
<div style="position:absolute;left:104.69px;top:265.80px" class="cls_004"><span class="cls_004">following line that is the entry point to create a new Alfresco Share page:</span></div>
<div style="position:absolute;left:74.69px;top:289.01px" class="cls_010"><span class="cls_010">&lt;#include "/org/alfresco/include/alfresco-template.ftl" /&gt;</span></div>
<div style="position:absolute;left:91.32px;top:309.62px" class="cls_004"><span class="cls_004">6. This Freemarker file (that you can find in the Share web application) will define</span></div>
<div style="position:absolute;left:104.69px;top:322.22px" class="cls_004"><span class="cls_004">the global structure of the HTML page. In the steps 4, 5 and 6, we'll just add the</span></div>
<div style="position:absolute;left:104.69px;top:334.82px" class="cls_004"><span class="cls_004">code that we want to add in the header, the body and the footer by using the</span></div>
<div style="position:absolute;left:104.69px;top:347.42px" class="cls_004"><span class="cls_004">Freemarker macros </span><span class="cls_013">templateHeader,templateBody andtemplateFooter.</span></div>
<div style="position:absolute;left:91.32px;top:362.86px" class="cls_004"><span class="cls_004">7. Use the </span><span class="cls_013">template-header macro</span><span class="cls_004"> provided by Alfresco and include three new</span></div>
<div style="position:absolute;left:104.69px;top:376.14px" class="cls_004"><span class="cls_004">dependencies. The first one is the </span><span class="cls_007">Angular</span><span class="cls_004">Javascript framework; the second one</span></div>
<div style="position:absolute;left:104.69px;top:388.78px" class="cls_004"><span class="cls_004">is the Javascript file in charge of initializing the page and the third one is the CSS</span></div>
<div style="position:absolute;left:104.69px;top:401.38px" class="cls_004"><span class="cls_004">file that will use to make our page pretty.</span></div>
<div style="position:absolute;left:74.69px;top:424.59px" class="cls_010"><span class="cls_010">&lt;@templateHeader&gt;</span></div>
<div style="position:absolute;left:90.89px;top:435.39px" class="cls_010"><span class="cls_010">&lt;script</span></div>
<div style="position:absolute;left:74.69px;top:446.19px" class="cls_010"><span class="cls_010">src="//ajax.googleapis.com/ajax/libs/angularjs/1.5.6/angular.min.js"&gt;&lt;/scri</span></div>
<div style="position:absolute;left:74.69px;top:456.99px" class="cls_010"><span class="cls_010">pt&gt;</span></div>
<div style="position:absolute;left:90.89px;top:467.79px" class="cls_010"><span class="cls_010">&lt;script type="text/javascript" src="${url.context}/res/js/someco/page-</span></div>
<div style="position:absolute;left:74.69px;top:478.59px" class="cls_010"><span class="cls_010">someco-webable.lib.js"&gt;&lt;/script&gt;</span></div>
<div style="position:absolute;left:90.89px;top:489.39px" class="cls_010"><span class="cls_010">&lt;@link rel="stylesheet" type="text/css"</span></div>
<div style="position:absolute;left:74.69px;top:500.19px" class="cls_010"><span class="cls_010">href="${url.context}/res/components/someco-webable/someco-webable.css"/&gt;</span></div>
<div style="position:absolute;left:74.69px;top:510.99px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 219 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:158184px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background235.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">8. Then, let's use another macro provided by Alfresco too to generate the body of</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">the page.</span></div>
<div style="position:absolute;left:74.69px;top:106.31px" class="cls_010"><span class="cls_010">&lt;@templateBody&gt;</span></div>
<div style="position:absolute;left:85.49px;top:117.11px" class="cls_010"><span class="cls_010">&lt;@markup id="alf-hd"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:127.91px" class="cls_010"><span class="cls_010">&lt;div id="alf-hd"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:138.71px" class="cls_010"><span class="cls_010">&lt;@region scope="global" id="share-header" chromeless="true"/&gt;</span></div>
<div style="position:absolute;left:96.29px;top:149.51px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:85.49px;top:160.31px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:85.49px;top:171.11px" class="cls_010"><span class="cls_010">&lt;@markup id="bd"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:181.91px" class="cls_010"><span class="cls_010">&lt;div id="bd"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:192.71px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:85.49px;top:203.51px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:74.69px;top:214.31px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:122.09px;top:234.79px" class="cls_004"><span class="cls_004">If you want to know more about templates and regions, you can look at</span></div>
<div style="position:absolute;left:122.09px;top:247.39px" class="cls_004"><span class="cls_004">this documentation: </span><a href="http://docs.alfresco.com/5.1/concepts/surf-templates-regions.html">http://docs.alfresco.com/5.1/concepts/surf-te</a> </div>
<div style="position:absolute;left:122.09px;top:260.37px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/surf-templates-regions.html">mplates-regions.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:294.32px" class="cls_004"><span class="cls_004">9. Finally, add the final macro that will generate the footer of the page.</span></div>
<div style="position:absolute;left:74.69px;top:317.53px" class="cls_010"><span class="cls_010">&lt;@templateFooter&gt;</span></div>
<div style="position:absolute;left:96.29px;top:328.33px" class="cls_010"><span class="cls_010">&lt;@markup id="alf-ft"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:339.13px" class="cls_010"><span class="cls_010">&lt;div id="alf-ft"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:349.93px" class="cls_010"><span class="cls_010">&lt;@region id="footer" scope="global" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:360.73px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:96.29px;top:371.53px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:74.69px;top:382.33px" class="cls_010"><span class="cls_010">&lt;/@&gt;</span></div>
<div style="position:absolute;left:86.07px;top:402.94px" class="cls_004"><span class="cls_004">10. If you check carefully your code, you should find a DIV element with the id</span></div>
<div style="position:absolute;left:104.69px;top:415.54px" class="cls_004"><span class="cls_004">attribute equals to bd. This element will contain the HTML code of your page.</span></div>
<div style="position:absolute;left:104.69px;top:428.14px" class="cls_004"><span class="cls_004">First, we need to add a new DIV element that will be managed by our Angular</span></div>
<div style="position:absolute;left:104.69px;top:440.74px" class="cls_004"><span class="cls_004">application inside the DIV element with the id equals to bd.</span></div>
<div style="position:absolute;left:74.69px;top:463.95px" class="cls_010"><span class="cls_010">&lt;div ng-app="someco-webable" ng-init="init()" ng-</span></div>
<div style="position:absolute;left:74.69px;top:474.75px" class="cls_010"><span class="cls_010">controller="SomecoWebableCtrl"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:496.35px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 220 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:158860px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background236.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. In this newly DIV element, we want to display a filter button to be able to select</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">active, inactive or any webable documents.</span></div>
<div style="position:absolute;left:74.69px;top:106.31px" class="cls_010"><span class="cls_010">&lt;br /&gt;</span></div>
<div style="position:absolute;left:74.69px;top:117.11px" class="cls_010"><span class="cls_010">&lt;div class="set"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:127.91px" class="cls_010"><span class="cls_010">&lt;div class="set-bordered-panel"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:138.71px" class="cls_010"><span class="cls_010">&lt;div class="set-bordered-panel-heading"&gt;Filter(s)&lt;/div&gt;</span></div>
<div style="position:absolute;left:139.49px;top:149.51px" class="cls_010"><span class="cls_010">&lt;div class="set-bordered-panel-body"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:160.31px" class="cls_010"><span class="cls_010">&lt;div id="filter-menu"&gt;&lt;/div&gt;</span></div>
<div style="position:absolute;left:161.09px;top:171.11px" class="cls_010"><span class="cls_010">&lt;br /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:181.91px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:139.49px;top:192.71px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:117.89px;top:203.51px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:86.07px;top:224.12px" class="cls_004"><span class="cls_004">12. Below the list of filters, we just want to display the list of documents in a TABLE</span></div>
<div style="position:absolute;left:104.69px;top:236.72px" class="cls_004"><span class="cls_004">element containing one row per document. To accomplish that, we'll use the</span></div>
<div style="position:absolute;left:104.69px;top:249.32px" class="cls_004"><span class="cls_004">Angular variable documents that we will populate later, and we'll use as well the</span></div>
<div style="position:absolute;left:104.69px;top:261.92px" class="cls_013"><span class="cls_013">filter</span><span class="cls_004"> directive to be able to display only relevant documents.</span></div>
<div style="position:absolute;left:74.69px;top:285.81px" class="cls_010"><span class="cls_010">&lt;table&gt;</span></div>
<div style="position:absolute;left:96.29px;top:296.61px" class="cls_010"><span class="cls_010">&lt;tr ng-repeat="doc in documents | filter:filter" class="document"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:307.41px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:96.29px;top:318.21px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:74.69px;top:329.01px" class="cls_010"><span class="cls_010">&lt;/table&gt;</span></div>
<div style="position:absolute;left:86.07px;top:349.62px" class="cls_004"><span class="cls_004">13. For each document, the first cell will be the thumbnail the document, and we'll</span></div>
<div style="position:absolute;left:104.69px;top:362.22px" class="cls_004"><span class="cls_004">reuse the same webscript used by Alfresco Share in the document library. We</span></div>
<div style="position:absolute;left:104.69px;top:374.82px" class="cls_004"><span class="cls_004">want as well to make the image clickable that will redirect the user to the</span></div>
<div style="position:absolute;left:104.69px;top:387.42px" class="cls_004"><span class="cls_004">document. Place the following code in the tr tag that we defined above.</span></div>
<div style="position:absolute;left:74.69px;top:410.63px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:85.49px;top:421.43px" class="cls_010"><span class="cls_010">&lt;span class="thumbnail"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:432.23px" class="cls_010"><span class="cls_010">&lt;a ng-</span></div>
<div style="position:absolute;left:74.69px;top:443.03px" class="cls_010"><span class="cls_010">href="${url.context}/page/site/${(page.url.templateArgs.site!"")?url?js_str</span></div>
<div style="position:absolute;left:74.69px;top:453.83px" class="cls_010"><span class="cls_010">ing}/document-details?nodeRef=workspace://SpacesStore/{{</span></div>
<div style="position:absolute;left:74.69px;top:464.63px" class="cls_010"><span class="cls_010">doc.properties['d.cmis:objectId'].value.split(';')[0] }}"&gt;</span></div>
<div style="position:absolute;left:107.09px;top:475.43px" class="cls_010"><span class="cls_010">&lt;img id="workspace://SpacesStore/{{</span></div>
<div style="position:absolute;left:74.69px;top:486.23px" class="cls_010"><span class="cls_010">doc.properties['d.cmis:objectId'].value.split(';')[0] }}" ng-</span></div>
<div style="position:absolute;left:74.69px;top:497.03px" class="cls_010"><span class="cls_010">src="${url.context}/proxy/alfresco/api/node/workspace/SpacesStore/{{</span></div>
<div style="position:absolute;left:74.69px;top:507.83px" class="cls_010"><span class="cls_010">doc.properties['d.cmis:objectId'].value.split(';')[0]</span></div>
<div style="position:absolute;left:74.69px;top:518.63px" class="cls_010"><span class="cls_010">}}/content/thumbnails/doclib?c=queue&amp;ph=true" &gt;</span></div>
<div style="position:absolute;left:96.29px;top:529.43px" class="cls_010"><span class="cls_010">&lt;/a&gt;</span></div>
<div style="position:absolute;left:85.49px;top:540.23px" class="cls_010"><span class="cls_010">&lt;/span&gt;</span></div>
<div style="position:absolute;left:74.69px;top:551.03px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 221 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:159536px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background237.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">14. The next and last cell will contain basic information like file name, version label,</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">last modifier and last modification date. If we display an active document, we</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">want to display the publication date, otherwise, we want display a message</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">informing that the document is not published.</span></div>
<div style="position:absolute;left:74.69px;top:131.51px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:85.49px;top:142.31px" class="cls_010"><span class="cls_010">&lt;h3 class="filename"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:153.11px" class="cls_010"><span class="cls_010">&lt;a ng-</span></div>
<div style="position:absolute;left:74.69px;top:163.91px" class="cls_010"><span class="cls_010">href="${url.context}/page/site/${(page.url.templateArgs.site!"")?url?js_str</span></div>
<div style="position:absolute;left:74.69px;top:174.71px" class="cls_010"><span class="cls_010">ing}/document-details?nodeRef=workspace://SpacesStore/{{</span></div>
<div style="position:absolute;left:74.69px;top:185.51px" class="cls_010"><span class="cls_010">doc.properties['d.cmis:objectId'].value.split(';')[0] }}"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:196.31px" class="cls_010"><span class="cls_010">{{ doc.properties['d.cmis:name'].value }}</span></div>
<div style="position:absolute;left:96.29px;top:207.11px" class="cls_010"><span class="cls_010">&lt;/a&gt;</span></div>
<div style="position:absolute;left:96.29px;top:217.91px" class="cls_010"><span class="cls_010">&lt;span class="document-version"&gt;{{</span></div>
<div style="position:absolute;left:74.69px;top:228.71px" class="cls_010"><span class="cls_010">doc.properties['d.cmis:versionLabel'].value }}&lt;/span&gt;</span></div>
<div style="position:absolute;left:85.49px;top:239.51px" class="cls_010"><span class="cls_010">&lt;/h3&gt;</span></div>
<div style="position:absolute;left:74.69px;top:250.31px" class="cls_010"><span class="cls_010">&lt;div class="detail"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:261.11px" class="cls_010"><span class="cls_010">Last Modified on {{ doc.properties['d.cmis:lastModificationDate'].value</span></div>
<div style="position:absolute;left:74.69px;top:271.91px" class="cls_010"><span class="cls_010">| date:'medium' }} By {{ doc.properties['d.cmis:lastModifiedBy'].value }}</span></div>
<div style="position:absolute;left:74.69px;top:282.71px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:74.69px;top:293.51px" class="cls_010"><span class="cls_010">&lt;div class="detail"&gt;</span></div>
<div style="position:absolute;left:85.49px;top:304.31px" class="cls_010"><span class="cls_010">&lt;span ng-if="doc.properties['w.sc:published'].value"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:315.11px" class="cls_010"><span class="cls_010">Published on {{ doc.properties['w.sc:published'].value | date:'medium'</span></div>
<div style="position:absolute;left:74.69px;top:325.91px" class="cls_010"><span class="cls_010">}}</span></div>
<div style="position:absolute;left:85.49px;top:336.71px" class="cls_010"><span class="cls_010">&lt;/span&gt;</span></div>
<div style="position:absolute;left:85.49px;top:347.51px" class="cls_010"><span class="cls_010">&lt;span ng-if="!doc.properties['w.sc:published'].value"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:358.31px" class="cls_010"><span class="cls_010">Not Published</span></div>
<div style="position:absolute;left:85.49px;top:369.11px" class="cls_010"><span class="cls_010">&lt;/span&gt;</span></div>
<div style="position:absolute;left:74.69px;top:379.91px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:74.69px;top:390.71px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:86.07px;top:411.32px" class="cls_004"><span class="cls_004">15. Let's populate the I18N message property file </span><span class="cls_013">share.properties</span><span class="cls_004"> located in</span></div>
<div style="position:absolute;left:104.69px;top:424.60px" class="cls_013"><span class="cls_013">src|main|amp|config|alfresco|web-extensions|messages</span><span class="cls_004"> with the page</span></div>
<div style="position:absolute;left:104.69px;top:437.88px" class="cls_004"><span class="cls_004">title and description.</span></div>
<div style="position:absolute;left:74.69px;top:461.09px" class="cls_010"><span class="cls_010">page.someco.webable.title=SomecoWebable Documents</span></div>
<div style="position:absolute;left:74.69px;top:471.89px" class="cls_010"><span class="cls_010">page.someco.webable.description=List all documents with the Webable aspect</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 222 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:160212px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background238.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">16. We need to make our new page available in the list of available pages for each</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">site. Open the file </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> page located in</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_013"><span class="cls_013">src|main|resources|META-INF</span><span class="cls_004">. Add a new config element using the</span></div>
<div style="position:absolute;left:104.69px;top:109.66px" class="cls_004"><span class="cls_004">evaluator string-compare and condition </span><span class="cls_013">SitePages</span><span class="cls_004">. We just copy the existing</span></div>
<div style="position:absolute;left:104.69px;top:122.94px" class="cls_013"><span class="cls_013">config</span><span class="cls_004"> element from the file share-config.xml in the </span><span class="cls_013">webappshare.war</span><span class="cls_004"> and we</span></div>
<div style="position:absolute;left:104.69px;top:136.22px" class="cls_004"><span class="cls_004">add our new page.</span></div>
<div style="position:absolute;left:74.69px;top:159.43px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare" condition="SitePages" replace="true"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:170.23px" class="cls_010"><span class="cls_010">&lt;pages&gt;</span></div>
<div style="position:absolute;left:117.89px;top:181.03px" class="cls_010"><span class="cls_010">&lt;page id="calendar"&gt;calendar&lt;/page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:191.83px" class="cls_010"><span class="cls_010">&lt;page id="wiki-page"&gt;wiki-page?title=Main_Page&lt;/page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:202.63px" class="cls_010"><span class="cls_010">&lt;page id="documentlibrary"&gt;documentlibrary&lt;/page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:213.43px" class="cls_010"><span class="cls_010">&lt;page id="discussions-topiclist"&gt;discussions-topiclist&lt;/page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:224.23px" class="cls_010"><span class="cls_010">&lt;page id="blog-postlist"&gt;blog-postlist&lt;/page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:235.03px" class="cls_010"><span class="cls_010">&lt;page id="links"&gt;links&lt;/page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:245.83px" class="cls_010"><span class="cls_010">&lt;page id="data-lists"&gt;data-lists&lt;/page&gt;</span></div>
<div style="position:absolute;left:117.89px;top:256.63px" class="cls_010"><span class="cls_010">&lt;page id="someco-webable"&gt;someco-webable&lt;/page&gt;</span></div>
<div style="position:absolute;left:90.89px;top:267.43px" class="cls_010"><span class="cls_010">&lt;/pages&gt;</span></div>
<div style="position:absolute;left:74.69px;top:278.23px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:86.07px;top:298.84px" class="cls_004"><span class="cls_004">17. Then, be sure to have a file named page-someco-webable-64.png in the folder</span></div>
<div style="position:absolute;left:104.69px;top:311.44px" class="cls_007"><span class="cls_007">src|main|amp|web|components|images</span><span class="cls_004"> that will be used to represent our new</span></div>
<div style="position:absolute;left:104.69px;top:324.08px" class="cls_004"><span class="cls_004">page. We are placing our image in the same folder used by Alfresco Share to store</span></div>
<div style="position:absolute;left:104.69px;top:336.68px" class="cls_004"><span class="cls_004">images for pages.</span></div>
<div style="position:absolute;left:86.07px;top:351.44px" class="cls_004"><span class="cls_004">18. Let's add some CSS rules in the file someco-webable.css that you'll need to create</span></div>
<div style="position:absolute;left:104.69px;top:364.04px" class="cls_004"><span class="cls_004">in the directory src|main|amp|web|components|someco-webable.</span></div>
<div style="position:absolute;left:74.69px;top:387.25px" class="cls_010"><span class="cls_010">.thumbnail {</span></div>
<div style="position:absolute;left:85.49px;top:398.05px" class="cls_010"><span class="cls_010">cursor: pointer;</span></div>
<div style="position:absolute;left:85.49px;top:408.85px" class="cls_010"><span class="cls_010">display: block;</span></div>
<div style="position:absolute;left:85.49px;top:419.65px" class="cls_010"><span class="cls_010">height: 100px;</span></div>
<div style="position:absolute;left:85.49px;top:430.45px" class="cls_010"><span class="cls_010">overflow: hidden;</span></div>
<div style="position:absolute;left:85.49px;top:441.25px" class="cls_010"><span class="cls_010">position: relative;</span></div>
<div style="position:absolute;left:85.49px;top:452.05px" class="cls_010"><span class="cls_010">width: 100px;</span></div>
<div style="position:absolute;left:74.69px;top:462.85px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:473.65px" class="cls_010"><span class="cls_010">.document {</span></div>
<div style="position:absolute;left:85.49px;top:484.45px" class="cls_010"><span class="cls_010">padding: 15px;</span></div>
<div style="position:absolute;left:74.69px;top:495.25px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:506.05px" class="cls_010"><span class="cls_010">.detail {</span></div>
<div style="position:absolute;left:85.49px;top:516.85px" class="cls_010"><span class="cls_010">clear: left;</span></div>
<div style="position:absolute;left:85.49px;top:527.65px" class="cls_010"><span class="cls_010">line-height: 1.5em;</span></div>
<div style="position:absolute;left:85.49px;top:538.45px" class="cls_010"><span class="cls_010">min-height: 1.5em;</span></div>
<div style="position:absolute;left:85.49px;top:549.25px" class="cls_010"><span class="cls_010">padding-bottom: 0.2em;</span></div>
<div style="position:absolute;left:85.49px;top:560.05px" class="cls_010"><span class="cls_010">padding-left: 20px;</span></div>
<div style="position:absolute;left:74.69px;top:570.85px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 223 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:160888px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background239.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:74.69px;top:69.82px" class="cls_010"><span class="cls_010">.filename {</span></div>
<div style="position:absolute;left:85.49px;top:80.62px" class="cls_010"><span class="cls_010">font-size: 131%;</span></div>
<div style="position:absolute;left:85.49px;top:91.42px" class="cls_010"><span class="cls_010">font-weight: normal;</span></div>
<div style="position:absolute;left:85.49px;top:102.22px" class="cls_010"><span class="cls_010">padding-bottom: 0.2em;</span></div>
<div style="position:absolute;left:85.49px;top:113.02px" class="cls_010"><span class="cls_010">padding-left: 20px;</span></div>
<div style="position:absolute;left:85.49px;top:123.82px" class="cls_010"><span class="cls_010">word-wrap: break-word;</span></div>
<div style="position:absolute;left:74.69px;top:134.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:155.23px" class="cls_004"><span class="cls_004">19. The last missing piece is the Javascript file. In the directory</span></div>
<div style="position:absolute;left:104.69px;top:167.83px" class="cls_013"><span class="cls_013">src|main|amp|web|js|someco</span><span class="cls_004">. Create the file page-someco-webable.lib.js.</span></div>
<div style="position:absolute;left:104.69px;top:181.11px" class="cls_004"><span class="cls_004">You could ask why we use the extension lib.js. The Alfresco Maven archetypes</span></div>
<div style="position:absolute;left:104.69px;top:193.71px" class="cls_004"><span class="cls_004">are pre-configured to minify Javascript files. During this process, some variable</span></div>
<div style="position:absolute;left:104.69px;top:206.31px" class="cls_004"><span class="cls_004">can be renamed to use shorter names. The problem is those changes are not</span></div>
<div style="position:absolute;left:104.69px;top:218.91px" class="cls_004"><span class="cls_004">compatible with Angular. To avoid any issue, we just use the extension lib.js</span></div>
<div style="position:absolute;left:104.69px;top:231.51px" class="cls_004"><span class="cls_004">because these files are not minified by Maven.First, let's create the Angular app.</span></div>
<div style="position:absolute;left:74.69px;top:254.72px" class="cls_010"><span class="cls_010">var app = angular.module("someco-webable", []);</span></div>
<div style="position:absolute;left:74.69px;top:265.52px" class="cls_010"><span class="cls_010">app.controller('SomecoWebableCtrl', SomecoWebableCtrl);</span></div>
<div style="position:absolute;left:74.69px;top:287.12px" class="cls_010"><span class="cls_010">function SomecoWebableCtrl($scope) {</span></div>
<div style="position:absolute;left:85.49px;top:308.72px" class="cls_010"><span class="cls_010">$scope.documents = [];</span></div>
<div style="position:absolute;left:85.49px;top:319.52px" class="cls_010"><span class="cls_010">$scope.filter = {};</span></div>
<div style="position:absolute;left:74.69px;top:341.12px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:86.07px;top:361.73px" class="cls_004"><span class="cls_004">20. In the function </span><span class="cls_013">SomecoWebableCtrl</span><span class="cls_004">, create the init method and defined the url</span></div>
<div style="position:absolute;left:104.69px;top:375.01px" class="cls_004"><span class="cls_004">variable. You can notice that we'll use CMIS 1.1 to query the repository.</span></div>
<div style="position:absolute;left:74.69px;top:398.22px" class="cls_010"><span class="cls_010">$scope.init = function() {</span></div>
<div style="position:absolute;left:74.69px;top:419.82px" class="cls_010"><span class="cls_010">var url = Alfresco.constants.URL_CONTEXT + "proxy/alfresco-api/-default-</span></div>
<div style="position:absolute;left:74.69px;top:430.62px" class="cls_010"><span class="cls_010">/public/cmis/versions/1.1/browser";</span></div>
<div style="position:absolute;left:74.69px;top:441.42px" class="cls_010"><span class="cls_010">url += "?cmisaction=query";</span></div>
<div style="position:absolute;left:74.69px;top:452.22px" class="cls_010"><span class="cls_010">url += "&amp;statement=" + encodeURIComponent("SELECT d.*, w.* FROM</span></div>
<div style="position:absolute;left:74.69px;top:463.02px" class="cls_010"><span class="cls_010">cmis:document AS d JOIN sc:webable AS w ON d.cmis:objectId =</span></div>
<div style="position:absolute;left:74.69px;top:473.82px" class="cls_010"><span class="cls_010">w.cmis:objectId WHERE CONTAINS(d, 'PATH:"/app:company_home/st:sites/cm:" +</span></div>
<div style="position:absolute;left:74.69px;top:484.62px" class="cls_010"><span class="cls_010">Alfresco.constants.SITE + "//*"')");</span></div>
<div style="position:absolute;left:74.69px;top:506.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:526.83px" class="cls_004"><span class="cls_004">21. After that the url variable is initialized, we need to query Alfresco and we'll save</span></div>
<div style="position:absolute;left:104.69px;top:539.43px" class="cls_004"><span class="cls_004">the results in the the variable documents that is used in the Freemarker template.</span></div>
<div style="position:absolute;left:74.69px;top:562.64px" class="cls_010"><span class="cls_010">Alfresco.util.Ajax.request({</span></div>
<div style="position:absolute;left:74.69px;top:573.44px" class="cls_010"><span class="cls_010">method :Alfresco.util.Ajax.POST,</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 224 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:161564px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background240.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:74.69px;top:69.82px" class="cls_010"><span class="cls_010">url :url,</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">successCallback : {</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">fn : function(response) {</span></div>
<div style="position:absolute;left:107.09px;top:102.22px" class="cls_010"><span class="cls_010">$scope.documents = response.json.results;</span></div>
<div style="position:absolute;left:107.09px;top:113.02px" class="cls_010"><span class="cls_010">$scope.$apply();</span></div>
<div style="position:absolute;left:96.29px;top:123.82px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:74.69px;top:134.62px" class="cls_010"><span class="cls_010">scope : this</span></div>
<div style="position:absolute;left:85.49px;top:145.42px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:74.69px;top:156.22px" class="cls_010"><span class="cls_010">failureMessage : "Error retrieving documents."</span></div>
<div style="position:absolute;left:74.69px;top:167.02px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:86.07px;top:187.63px" class="cls_004"><span class="cls_004">22. Finally, we need to add the following code in the init method to build the filters</span></div>
<div style="position:absolute;left:104.69px;top:200.23px" class="cls_004"><span class="cls_004">button.</span></div>
<div style="position:absolute;left:74.69px;top:223.44px" class="cls_010"><span class="cls_010">var filterMenu = [ {</span></div>
<div style="position:absolute;left:74.69px;top:234.24px" class="cls_010"><span class="cls_010">text : "Active and Inactive",</span></div>
<div style="position:absolute;left:74.69px;top:245.04px" class="cls_010"><span class="cls_010">value : "all",</span></div>
<div style="position:absolute;left:74.69px;top:255.84px" class="cls_010"><span class="cls_010">onclick : {</span></div>
<div style="position:absolute;left:74.69px;top:266.64px" class="cls_010"><span class="cls_010">fn :updateFilter</span></div>
<div style="position:absolute;left:85.49px;top:277.44px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:288.24px" class="cls_010"><span class="cls_010">}, {</span></div>
<div style="position:absolute;left:74.69px;top:299.04px" class="cls_010"><span class="cls_010">text : "Active",</span></div>
<div style="position:absolute;left:74.69px;top:309.84px" class="cls_010"><span class="cls_010">value : "active",</span></div>
<div style="position:absolute;left:74.69px;top:320.64px" class="cls_010"><span class="cls_010">onclick : {</span></div>
<div style="position:absolute;left:74.69px;top:331.44px" class="cls_010"><span class="cls_010">fn :updateFilter</span></div>
<div style="position:absolute;left:85.49px;top:342.24px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:353.04px" class="cls_010"><span class="cls_010">}, {</span></div>
<div style="position:absolute;left:74.69px;top:363.84px" class="cls_010"><span class="cls_010">text : "Inactive",</span></div>
<div style="position:absolute;left:74.69px;top:374.64px" class="cls_010"><span class="cls_010">value : "inactive",</span></div>
<div style="position:absolute;left:74.69px;top:385.44px" class="cls_010"><span class="cls_010">onclick : {</span></div>
<div style="position:absolute;left:74.69px;top:396.24px" class="cls_010"><span class="cls_010">fn :updateFilter</span></div>
<div style="position:absolute;left:85.49px;top:407.04px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:417.84px" class="cls_010"><span class="cls_010">} ];</span></div>
<div style="position:absolute;left:74.69px;top:439.44px" class="cls_010"><span class="cls_010">$scope.statusFilter = new YAHOO.widget.Button({</span></div>
<div style="position:absolute;left:74.69px;top:450.24px" class="cls_010"><span class="cls_010">type : "menu",</span></div>
<div style="position:absolute;left:74.69px;top:461.04px" class="cls_010"><span class="cls_010">label : "Active and Inactive",</span></div>
<div style="position:absolute;left:74.69px;top:471.84px" class="cls_010"><span class="cls_010">name : "publishStatusSelect",</span></div>
<div style="position:absolute;left:74.69px;top:482.64px" class="cls_010"><span class="cls_010">menu :filterMenu,</span></div>
<div style="position:absolute;left:74.69px;top:493.44px" class="cls_010"><span class="cls_010">container : "filter-menu"</span></div>
<div style="position:absolute;left:74.69px;top:504.24px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 225 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:162240px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background241.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">23. As you can see, I'm using a Yahoo UI button in this page. I'm doing that to be</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">sure that I use the same UI framework in the entire Share web application. Like</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">that, we are sure that the rendering of buttons is exactly the same in the entire</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">application.</span></div>
<div style="position:absolute;left:86.07px;top:123.06px" class="cls_004"><span class="cls_004">24. As you can see above, each time that we click on a filter, we'll call the function</span></div>
<div style="position:absolute;left:104.69px;top:135.66px" class="cls_004"><span class="cls_004">updateFilter. This filter will just populate the variable filter that is used in the</span></div>
<div style="position:absolute;left:104.69px;top:148.26px" class="cls_004"><span class="cls_004">directive that lists documents. Place the following function after </span><span class="cls_013">$scope.init</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:74.69px;top:172.15px" class="cls_010"><span class="cls_010">function updateFilter(p_sType, p_aArgs, p_oItem) {</span></div>
<div style="position:absolute;left:74.69px;top:193.75px" class="cls_010"><span class="cls_010">var sText = p_oItem.cfg.getProperty("text");</span></div>
<div style="position:absolute;left:85.49px;top:204.55px" class="cls_010"><span class="cls_010">$scope.statusFilter.set("label", sText);</span></div>
<div style="position:absolute;left:85.49px;top:226.15px" class="cls_010"><span class="cls_010">if (p_oItem.value == "all")</span></div>
<div style="position:absolute;left:96.29px;top:236.95px" class="cls_010"><span class="cls_010">$scope.filter = {};</span></div>
<div style="position:absolute;left:85.49px;top:247.75px" class="cls_010"><span class="cls_010">else if (p_oItem.value == "active")</span></div>
<div style="position:absolute;left:96.29px;top:258.55px" class="cls_010"><span class="cls_010">$scope.filter = {</span></div>
<div style="position:absolute;left:74.69px;top:269.35px" class="cls_010"><span class="cls_010">properties : {</span></div>
<div style="position:absolute;left:117.89px;top:280.15px" class="cls_010"><span class="cls_010">"w.sc:isActive" : {</span></div>
<div style="position:absolute;left:74.69px;top:290.95px" class="cls_010"><span class="cls_010">value : true</span></div>
<div style="position:absolute;left:117.89px;top:301.75px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:107.09px;top:312.55px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:96.29px;top:323.35px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:85.49px;top:334.15px" class="cls_010"><span class="cls_010">else if (p_oItem.value == "inactive")</span></div>
<div style="position:absolute;left:96.29px;top:344.95px" class="cls_010"><span class="cls_010">$scope.filter = {</span></div>
<div style="position:absolute;left:74.69px;top:355.75px" class="cls_010"><span class="cls_010">properties : {</span></div>
<div style="position:absolute;left:117.89px;top:366.55px" class="cls_010"><span class="cls_010">"w.sc:isActive" : {</span></div>
<div style="position:absolute;left:117.89px;top:377.35px" class="cls_010"><span class="cls_010">value : false</span></div>
<div style="position:absolute;left:117.89px;top:388.15px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:107.09px;top:398.95px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:96.29px;top:409.75px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:85.49px;top:431.35px" class="cls_010"><span class="cls_010">$scope.$apply();</span></div>
<div style="position:absolute;left:74.69px;top:442.15px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:462.76px" class="cls_004"><span class="cls_004">25. Deploy, package and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 226 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:162916px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background242.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To be able to test your new page, you need login and open a site where you are a Site</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">Manager.</span></div>
<div style="position:absolute;left:91.32px;top:104.83px" class="cls_004"><span class="cls_004">1. Click on the steering wheel in top right corner, and click on </span><span class="cls_007">Customize Site</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:217.30px" class="cls_004"><span class="cls_004">2. Then, you new page should be displayed in the list of </span><span class="cls_007">Available Site Pages</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:346.27px" class="cls_004"><span class="cls_004">3. Drag and drop the page to the list of </span><span class="cls_007">Current Site Pages</span><span class="cls_004">. Feel free to click on</span></div>
<div style="position:absolute;left:104.69px;top:358.90px" class="cls_007"><span class="cls_007">Rename</span><span class="cls_004">, and give it the name that you prefer.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 227 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:163592px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background243.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Click on </span><span class="cls_007">OK</span><span class="cls_004">, click on the name of the page in the top banner. You should be able</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">to see the filter and all documents with the aspect sc:webable.</span></div>
<div style="position:absolute;left:91.32px;top:386.86px" class="cls_004"><span class="cls_004">5. If you click on the filter and select </span><span class="cls_007">Active</span><span class="cls_004"> or </span><span class="cls_007">Inactive</span><span class="cls_004">, the lists of documents</span></div>
<div style="position:absolute;left:104.69px;top:399.49px" class="cls_004"><span class="cls_004">should be refreshed to display only the relevant documents. You can re-apply the</span></div>
<div style="position:absolute;left:104.69px;top:412.09px" class="cls_004"><span class="cls_004">same steps in another site, and the list of documents will contain only items</span></div>
<div style="position:absolute;left:104.69px;top:424.69px" class="cls_004"><span class="cls_004">stored in the same Alfresco Share site.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 228 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:164268px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background244.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Customizing Alfresco Share</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">In this chapter, you learned that the Alfresco Share is an all-purpose user interface for</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">general document management. It can be easily extended using approaches that range from</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">making XML configuration file changes to writing new Surf dashlets or pages.</span></div>
<div style="position:absolute;left:56.69px;top:144.18px" class="cls_004"><span class="cls_004">Specifically, you learned how to:</span></div>
<div style="position:absolute;left:104.69px;top:165.91px" class="cls_004"><span class="cls_004">Add new menu items to the top bar menu</span></div>
<div style="position:absolute;left:104.69px;top:180.67px" class="cls_004"><span class="cls_004">Create new actions items using dialogs or not</span></div>
<div style="position:absolute;left:104.69px;top:195.43px" class="cls_004"><span class="cls_004">Show/hide action items based on things such as permissions or arbitrary logic</span></div>
<div style="position:absolute;left:104.69px;top:210.19px" class="cls_004"><span class="cls_004">Create custom metadata template to change how Share shows repository data</span></div>
<div style="position:absolute;left:104.69px;top:224.95px" class="cls_004"><span class="cls_004">Implement indicators in Share to reflect a status or an information on documents</span></div>
<div style="position:absolute;left:104.69px;top:239.71px" class="cls_004"><span class="cls_004">Create a new form control to interact differently with metadata</span></div>
<div style="position:absolute;left:104.69px;top:254.47px" class="cls_004"><span class="cls_004">Assess whether the solution you are building should be based on a custom</span></div>
<div style="position:absolute;left:104.69px;top:267.07px" class="cls_004"><span class="cls_004">version of Alfresco Share, or would be more appropriate as a custom application</span></div>
<div style="position:absolute;left:56.69px;top:290.96px" class="cls_004"><span class="cls_004">We discovered in this chapter how you can configure and customize Alfresco Share for</span></div>
<div style="position:absolute;left:56.69px;top:303.56px" class="cls_004"><span class="cls_004">your use case. In the next chapter, we'll discover more about the new Alfresco Development</span></div>
<div style="position:absolute;left:56.69px;top:316.16px" class="cls_004"><span class="cls_004">Framework (ADF) to generate a full customized UI using Angular.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 229 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:164944px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background245.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">6</span></div>
<div style="position:absolute;left:62.86px;top:167.48px" class="cls_011"><span class="cls_011">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">Depending on your use case, you may think that creating your own UI from scratch is what</span></div>
<div style="position:absolute;left:56.69px;top:239.07px" class="cls_004"><span class="cls_004">you need. And you may be right! Thanks to Alfresco APIs, you have a lot of options. In this</span></div>
<div style="position:absolute;left:56.69px;top:251.67px" class="cls_004"><span class="cls_004">chapter, we'll talk about the new </span><span class="cls_007">Alfresco Development Framework</span><span class="cls_004"> (</span><span class="cls_007">ADF</span><span class="cls_004">) and how we</span></div>
<div style="position:absolute;left:56.69px;top:264.30px" class="cls_004"><span class="cls_004">can create a new Angular application.</span></div>
<div style="position:absolute;left:56.69px;top:285.90px" class="cls_004"><span class="cls_004">By the end of this chapter, you will know how to do the following:</span></div>
<div style="position:absolute;left:104.69px;top:307.64px" class="cls_004"><span class="cls_004">Use the new Alfresco JavaScript library</span></div>
<div style="position:absolute;left:104.69px;top:322.39px" class="cls_004"><span class="cls_004">Create a new Angular application using Yeoman</span></div>
<div style="position:absolute;left:104.69px;top:337.15px" class="cls_004"><span class="cls_004">Discover all the out-of-the-box components provided by this framework</span></div>
<div style="position:absolute;left:56.69px;top:361.05px" class="cls_004"><span class="cls_004">It is important to note that this chapter is based on the latest published version (at the time</span></div>
<div style="position:absolute;left:56.69px;top:373.64px" class="cls_004"><span class="cls_004">of writing) of the Alfresco Developer Framework, that is, 1.0.1. This version is not suitable</span></div>
<div style="position:absolute;left:56.69px;top:386.24px" class="cls_004"><span class="cls_004">for a production use. You may ask why it has been integrated into this book if we can't use</span></div>
<div style="position:absolute;left:56.69px;top:398.85px" class="cls_004"><span class="cls_004">it. Well, this is because I'm deeply convinced that this framework is going to be used by a</span></div>
<div style="position:absolute;left:56.69px;top:411.45px" class="cls_004"><span class="cls_004">very wide community. For this reason, I really believe that this book should give you the</span></div>
<div style="position:absolute;left:56.69px;top:424.05px" class="cls_004"><span class="cls_004">basics on how to use it, and how it works. Also, I just want to emphasize that this</span></div>
<div style="position:absolute;left:56.69px;top:436.64px" class="cls_004"><span class="cls_004">framework is only available on Alfresco Community, and from version 201606. The rest of</span></div>
<div style="position:absolute;left:56.69px;top:449.24px" class="cls_004"><span class="cls_004">the book is based on Alfresco Enterprise 5.1.x, so we'll provide you with a virtual machine</span></div>
<div style="position:absolute;left:56.69px;top:461.85px" class="cls_004"><span class="cls_004">and an installation script.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:165620px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background246.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Understanding the framework</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">You may say </span><span class="cls_022">“</span><span class="cls_004">Oh, another way to create a UI integrated with Alfresco</span><span class="cls_022">”</span><span class="cls_004"> and you are not</span></div>
<div style="position:absolute;left:56.69px;top:110.81px" class="cls_004"><span class="cls_004">completely wrong. However, this new framework will simplify the decoupling between</span></div>
<div style="position:absolute;left:56.69px;top:123.41px" class="cls_004"><span class="cls_004">Alfresco and the custom interface that you want to develop. Finding people with the</span></div>
<div style="position:absolute;left:56.69px;top:136.01px" class="cls_004"><span class="cls_004">required skills to do Share application development may not be easy. This new framework</span></div>
<div style="position:absolute;left:56.69px;top:148.61px" class="cls_004"><span class="cls_004">will help large companies to build better solutions by asking Alfresco experts to develop the</span></div>
<div style="position:absolute;left:56.69px;top:161.21px" class="cls_004"><span class="cls_004">core of your ECM, and UI experts with Angular experience to focus only on the building of</span></div>
<div style="position:absolute;left:56.69px;top:173.81px" class="cls_004"><span class="cls_004">application.</span></div>
<div style="position:absolute;left:56.69px;top:210.51px" class="cls_014"><span class="cls_014">Components</span></div>
<div style="position:absolute;left:56.69px;top:235.73px" class="cls_004"><span class="cls_004">This new framework is composed of four major components:</span></div>
<div style="position:absolute;left:104.69px;top:257.46px" class="cls_004"><span class="cls_004">The first component is the Alfresco JavaScript API. We know that developers</span></div>
<div style="position:absolute;left:104.69px;top:270.06px" class="cls_004"><span class="cls_004">spend a lot of time doing boilerplate code. The first main and basic example is to</span></div>
<div style="position:absolute;left:104.69px;top:282.66px" class="cls_004"><span class="cls_004">deal with authentication. To increase the efficiency of developers, Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:295.26px" class="cls_004"><span class="cls_004">created a new JavaScript API not tied to any specific framework. You can use this</span></div>
<div style="position:absolute;left:104.69px;top:307.86px" class="cls_004"><span class="cls_004">API in any JavaScript-based application.</span></div>
<div style="position:absolute;left:104.69px;top:322.62px" class="cls_004"><span class="cls_004">The next component is a set of Angular components. They are based on the</span></div>
<div style="position:absolute;left:104.69px;top:335.22px" class="cls_004"><span class="cls_004">previous Alfresco JavaScript API, and they are completely reusable NG2</span></div>
<div style="position:absolute;left:104.69px;top:347.82px" class="cls_004"><span class="cls_004">components. NG2 refers to Angular version 2.</span></div>
<div style="position:absolute;left:104.69px;top:362.58px" class="cls_004"><span class="cls_004">Another important component is an application generator that will help you</span></div>
<div style="position:absolute;left:104.69px;top:375.18px" class="cls_004"><span class="cls_004">create a new application in seconds.</span></div>
<div style="position:absolute;left:104.69px;top:389.94px" class="cls_004"><span class="cls_004">The final component is another generator to create custom component to</span></div>
<div style="position:absolute;left:104.69px;top:402.54px" class="cls_004"><span class="cls_004">integrate in your application.</span></div>
<div style="position:absolute;left:56.69px;top:426.43px" class="cls_004"><span class="cls_004">Don't worry if it's still confusing for the moment, we'll go through all these components in</span></div>
<div style="position:absolute;left:56.69px;top:439.03px" class="cls_004"><span class="cls_004">the following section.</span></div>
<div style="position:absolute;left:56.69px;top:460.63px" class="cls_004"><span class="cls_004">In summary, Alfresco provides four main ways to develop your own UI:</span></div>
<div style="position:absolute;left:104.69px;top:482.36px" class="cls_004"><span class="cls_004">Share customizations</span></div>
<div style="position:absolute;left:104.69px;top:497.12px" class="cls_004"><span class="cls_004">Angular applications (using the out-of-the-box NG2 components)</span></div>
<div style="position:absolute;left:104.69px;top:511.88px" class="cls_004"><span class="cls_004">Any JavaScript framework (using the Alfresco JavaScript API)</span></div>
<div style="position:absolute;left:104.69px;top:526.64px" class="cls_004"><span class="cls_004">Any application capable of using the CMIS protocol</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 231 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:166296px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background247.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:246.06px" class="cls_014"><span class="cls_014">Prepare your environments</span></div>
<div style="position:absolute;left:56.69px;top:271.28px" class="cls_004"><span class="cls_004">As explained earlier, the current version of the ADF is only available on Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:283.88px" class="cls_004"><span class="cls_004">Community 201609 Early Access or newer (More details on this page</span></div>
<div style="position:absolute;left:56.69px;top:295.80px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/Alfresco/alfresco-ng2-components/blob/master/PREREQUISITES.md">https://github.com/Alfresco/alfresco-ng2-components/blob/master/PREREQUISITES.m</a> </div>
<div style="position:absolute;left:56.69px;top:307.28px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/Alfresco/alfresco-ng2-components/blob/master/PREREQUISITES.md">d</a> <span class="cls_004">). We don't want you to spend too much time re-installing everything. To simplify this</span></div>
<div style="position:absolute;left:56.69px;top:320.26px" class="cls_004"><span class="cls_004">chapter, we'll provide you with the following:</span></div>
<div style="position:absolute;left:104.69px;top:341.99px" class="cls_004"><span class="cls_004">A </span><span class="cls_013">Vagrant</span><span class="cls_004"> file to create a dedicated virtual machine</span></div>
<div style="position:absolute;left:104.69px;top:357.43px" class="cls_004"><span class="cls_004">A </span><span class="cls_013">bash</span><span class="cls_004"> script that will install and configure everything to be able to use the ADF</span></div>
<div style="position:absolute;left:56.69px;top:382.00px" class="cls_004"><span class="cls_004">The code that we'll develop in the later sections will be loaded from a different web server</span></div>
<div style="position:absolute;left:56.69px;top:394.60px" class="cls_004"><span class="cls_004">than the one Alfresco is running on. So we need to configure Alfresco to accept any request</span></div>
<div style="position:absolute;left:56.69px;top:407.20px" class="cls_004"><span class="cls_004">that comes in. So, we'll need to enable CORS.</span></div>
<div style="position:absolute;left:56.69px;top:428.80px" class="cls_004"><span class="cls_004">Then, we'll deploy a REST API explorer developed by Alfresco. It's not a required</span></div>
<div style="position:absolute;left:56.69px;top:441.40px" class="cls_004"><span class="cls_004">component, but it will be very useful for your UI developers.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 232 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:166972px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background248.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Before creating the virtual machine, we want to discuss and analyze the three files that you</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">are going to use and we provide you:</span></div>
<div style="position:absolute;left:104.69px;top:104.83px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">Vagrant</span><span class="cls_004"> file, located in </span><span class="cls_013">vms|vagrant-ch6</span><span class="cls_004">, is very similar to the other one</span></div>
<div style="position:absolute;left:104.69px;top:118.11px" class="cls_004"><span class="cls_004">that you used to install Alfresco Enterprise. You can see few differences:</span></div>
<div style="position:absolute;left:170.69px;top:130.71px" class="cls_004"><span class="cls_004">We are going to redirect port </span><span class="cls_013">8080</span><span class="cls_004"> corresponding to the default</span></div>
<div style="position:absolute;left:170.69px;top:144.00px" class="cls_012"><span class="cls_012">Tomcat</span><span class="cls_004"> port, and port </span><span class="cls_013">9000</span><span class="cls_004">, which will be used by the Node.JS</span></div>
<div style="position:absolute;left:170.69px;top:157.28px" class="cls_004"><span class="cls_004">server that will be deployed in the same virtual machine:</span></div>
<div style="position:absolute;left:139.49px;top:182.65px" class="cls_010"><span class="cls_010"># Redirect Tomcat Port</span></div>
<div style="position:absolute;left:139.49px;top:193.45px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 8080, host: 8080</span></div>
<div style="position:absolute;left:104.69px;top:214.06px" class="cls_004"><span class="cls_004">And you'll also notice an additional line at the end of the </span><span class="cls_013">Vagrant</span><span class="cls_004"> file. This line</span></div>
<div style="position:absolute;left:104.69px;top:227.34px" class="cls_004"><span class="cls_004">asks </span><span class="cls_013">Vagrant</span><span class="cls_004"> to execute the installation shell script that we are providing:</span></div>
<div style="position:absolute;left:139.49px;top:251.23px" class="cls_010"><span class="cls_010">config.vm.provision "shell", path: "install-alfresco.sh"</span></div>
<div style="position:absolute;left:104.69px;top:271.84px" class="cls_004"><span class="cls_004">The file called </span><span class="cls_013">install-options.txt</span><span class="cls_004"> contains additional options that will be</span></div>
<div style="position:absolute;left:104.69px;top:285.12px" class="cls_004"><span class="cls_004">used with the Alfresco installer. It allows us to run the installer without manual</span></div>
<div style="position:absolute;left:104.69px;top:297.72px" class="cls_004"><span class="cls_004">interaction. In this file, we just specify that we want to run the installer in</span></div>
<div style="position:absolute;left:104.69px;top:310.32px" class="cls_007"><span class="cls_007">unattended</span><span class="cls_004"> mode, and the admin user should be </span><span class="cls_007">admin</span><span class="cls_004">. You can find more</span></div>
<div style="position:absolute;left:104.69px;top:322.95px" class="cls_004"><span class="cls_004">details about silent install on</span></div>
<div style="position:absolute;left:104.69px;top:335.55px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/silent-alf-install.html">http://docs.alfresco.com/5.1/concepts/silent-alf-install.html</a> <span class="cls_004">:</span></div>
<div style="position:absolute;left:139.49px;top:359.14px" class="cls_010"><span class="cls_010">mode=unattended</span></div>
<div style="position:absolute;left:139.49px;top:369.94px" class="cls_010"><span class="cls_010">alfresco_admin_password=admin</span></div>
<div style="position:absolute;left:104.69px;top:390.55px" class="cls_004"><span class="cls_004">The last file is the shell installations script called </span><span class="cls_013">install-alfresco.sh</span><span class="cls_004">. We are</span></div>
<div style="position:absolute;left:104.69px;top:403.83px" class="cls_004"><span class="cls_004">not going to review it in detail, but we are going to analyze this file step-by-step:</span></div>
<div style="position:absolute;left:91.32px;top:427.72px" class="cls_004"><span class="cls_004">1. First, we need to login as </span><span class="cls_013">root</span><span class="cls_004"> and go to the </span><span class="cls_013">/vagrant </span><span class="cls_004">folder, which is the</span></div>
<div style="position:absolute;left:104.69px;top:441.00px" class="cls_004"><span class="cls_004">default shared folder between the virtual machine and the host if you use</span></div>
<div style="position:absolute;left:104.69px;top:453.60px" class="cls_004"><span class="cls_004">Vagrant:</span></div>
<div style="position:absolute;left:139.49px;top:476.81px" class="cls_010"><span class="cls_010">sudo su -</span></div>
<div style="position:absolute;left:139.49px;top:487.61px" class="cls_010"><span class="cls_010">cd /vagrant</span></div>
<div style="position:absolute;left:91.32px;top:508.22px" class="cls_004"><span class="cls_004">2. We are now installing some Alfresco prerequisites and useful tools:</span></div>
<div style="position:absolute;left:139.49px;top:531.43px" class="cls_010"><span class="cls_010">echo "Installing pre-requisites..."</span></div>
<div style="position:absolute;left:139.49px;top:542.23px" class="cls_010"><span class="cls_010">yum -y install fontconfig libSM libICE libXrender libXext</span></div>
<div style="position:absolute;left:161.09px;top:553.03px" class="cls_010"><span class="cls_010">cups-libs libGLU zip nano</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 233 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:167648px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background249.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Then, we are downloading Alfresco. Because we download the file from the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">/vagrant</span><span class="cls_004"> folder, the file will be stored on your computer and not inside the</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">virtual machine. If you delete your virtual machine and recreate it, it won't</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">redownload the file:</span></div>
<div style="position:absolute;left:139.49px;top:132.19px" class="cls_010"><span class="cls_010">if [ ! -f alfresco-community-installer-201612-linux-x64.bin ];</span></div>
<div style="position:absolute;left:139.49px;top:142.99px" class="cls_010"><span class="cls_010">then</span></div>
<div style="position:absolute;left:150.29px;top:153.79px" class="cls_010"><span class="cls_010">echo "  Downloading... (801M)"</span></div>
<div style="position:absolute;left:150.29px;top:164.59px" class="cls_010"><span class="cls_010">wget</span></div>
<div style="position:absolute;left:74.69px;top:175.39px" class="cls_010"><span class="cls_010"> </span><a href="http://dl.alfresco.com/release/community/201612-build-00014/">http://dl.alfresco.com/release/community/201612-build-00014</a> </div>
<div style="position:absolute;left:161.09px;top:186.19px" class="cls_010"><span class="cls_010">/alfresco-community-installer-201612-linux-x64.bin</span></div>
<div style="position:absolute;left:144.89px;top:196.99px" class="cls_010"><span class="cls_010">chmod +x alfresco-community-installer-201612-linux-x64.bin</span></div>
<div style="position:absolute;left:139.49px;top:207.79px" class="cls_010"><span class="cls_010">else</span></div>
<div style="position:absolute;left:150.29px;top:218.59px" class="cls_010"><span class="cls_010">echo "  Installer already downloaded"</span></div>
<div style="position:absolute;left:139.49px;top:229.39px" class="cls_010"><span class="cls_010">fi</span></div>
<div style="position:absolute;left:91.32px;top:250.00px" class="cls_004"><span class="cls_004">4. The next step is to run the installer using the options file that we explained</span></div>
<div style="position:absolute;left:104.69px;top:262.60px" class="cls_004"><span class="cls_004">previously (we are installing Alfresco using the root user in this case, it's not</span></div>
<div style="position:absolute;left:104.69px;top:275.20px" class="cls_004"><span class="cls_004">something that you should do in production but it's acceptable in our case for a</span></div>
<div style="position:absolute;left:104.69px;top:287.80px" class="cls_004"><span class="cls_004">development environment):</span></div>
<div style="position:absolute;left:139.49px;top:311.01px" class="cls_010"><span class="cls_010">echo "  Installing Alfresco..."</span></div>
<div style="position:absolute;left:139.49px;top:321.81px" class="cls_010"><span class="cls_010">./alfresco-community-installer-201612-linux-x64.bin</span></div>
<div style="position:absolute;left:166.49px;top:332.61px" class="cls_010"><span class="cls_010">--optionfile install-options.txt</span></div>
<div style="position:absolute;left:91.32px;top:353.22px" class="cls_004"><span class="cls_004">5. When the installation is completed, we'll enable CORS. We are just going to</span></div>
<div style="position:absolute;left:104.69px;top:365.82px" class="cls_004"><span class="cls_004">deploy a JAR file that will configure Alfresco to accept AJAX queries from other</span></div>
<div style="position:absolute;left:104.69px;top:378.42px" class="cls_004"><span class="cls_004">domains:</span></div>
<div style="position:absolute;left:139.49px;top:401.63px" class="cls_010"><span class="cls_010">echo "  Enabling CORS..."</span></div>
<div style="position:absolute;left:139.49px;top:412.43px" class="cls_010"><span class="cls_010">cd /opt/alfresco-community/modules/platform/</span></div>
<div style="position:absolute;left:139.49px;top:423.23px" class="cls_010"><span class="cls_010">if [ ! -f enablecors-1.0.jar ];</span></div>
<div style="position:absolute;left:139.49px;top:434.03px" class="cls_010"><span class="cls_010">then</span></div>
<div style="position:absolute;left:150.29px;top:444.83px" class="cls_010"><span class="cls_010">wget </span><a href="http://artifacts.alfresco.com/nexus/service/local/">http://artifacts.alfresco.com/nexus/service/local</a> </div>
<div style="position:absolute;left:161.09px;top:455.63px" class="cls_010"><span class="cls_010">/repositories/releases/content/org/alfresco</span></div>
<div style="position:absolute;left:161.09px;top:466.43px" class="cls_010"><span class="cls_010">/enablecors/1.0/enablecors-1.0.jar</span></div>
<div style="position:absolute;left:139.49px;top:477.23px" class="cls_010"><span class="cls_010">else</span></div>
<div style="position:absolute;left:150.29px;top:488.03px" class="cls_010"><span class="cls_010">echo "  The CORS module is already installed."</span></div>
<div style="position:absolute;left:139.49px;top:498.83px" class="cls_010"><span class="cls_010">fi</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 234 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:168324px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background250.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. We are almost done. The last piece is the installation of the API explorer. We are</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">just downloading version 1.1 from the Alfresco server and saving it in the</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_013"><span class="cls_013">webapps</span><span class="cls_004"> folder:</span></div>
<div style="position:absolute;left:139.49px;top:119.59px" class="cls_010"><span class="cls_010">echo "  Installing API Explorer..."</span></div>
<div style="position:absolute;left:139.49px;top:130.39px" class="cls_010"><span class="cls_010">cd /opt/alfresco-community/tomcat/webapps/</span></div>
<div style="position:absolute;left:139.49px;top:141.19px" class="cls_010"><span class="cls_010">if [ ! -f api-explorer.war ];</span></div>
<div style="position:absolute;left:139.49px;top:151.99px" class="cls_010"><span class="cls_010">then</span></div>
<div style="position:absolute;left:150.29px;top:162.79px" class="cls_010"><span class="cls_010">echo "  Downloading..."</span></div>
<div style="position:absolute;left:150.29px;top:173.59px" class="cls_010"><span class="cls_010">curl </span><a href="https://artifacts.alfresco.com/nexus/service/local/">https://artifacts.alfresco.com/nexus/service/local</a> </div>
<div style="position:absolute;left:161.09px;top:184.39px" class="cls_010"><span class="cls_010">/repositories/releases/content/org/alfresco</span></div>
<div style="position:absolute;left:161.09px;top:195.19px" class="cls_010"><span class="cls_010">/api-explorer/1.4/api-explorer-1.4.war &gt; api-explorer.war</span></div>
<div style="position:absolute;left:139.49px;top:205.99px" class="cls_010"><span class="cls_010">else</span></div>
<div style="position:absolute;left:150.29px;top:216.79px" class="cls_010"><span class="cls_010">echo "  Webapp already installed"</span></div>
<div style="position:absolute;left:139.49px;top:227.59px" class="cls_010"><span class="cls_010">fi</span></div>
<div style="position:absolute;left:91.32px;top:248.20px" class="cls_004"><span class="cls_004">7. Finally, the last step is to start Alfresco:</span></div>
<div style="position:absolute;left:139.49px;top:271.41px" class="cls_010"><span class="cls_010">echo "  Starting Alfresco..."</span></div>
<div style="position:absolute;left:139.49px;top:282.21px" class="cls_010"><span class="cls_010">service alfresco start</span></div>
<div style="position:absolute;left:56.69px;top:302.69px" class="cls_004"><span class="cls_004">Be aware that this process can be quite long, depending on your Internet performance. On</span></div>
<div style="position:absolute;left:56.69px;top:315.29px" class="cls_004"><span class="cls_004">my machine, it took up to twenty minutes the first time, including downloading the</span></div>
<div style="position:absolute;left:56.69px;top:327.89px" class="cls_004"><span class="cls_004">Alfresco Community installer. You'll just need to be a bit patient.</span></div>
<div style="position:absolute;left:56.69px;top:364.59px" class="cls_014"><span class="cls_014">Step-by-step - creating the new virtual machine</span></div>
<div style="position:absolute;left:56.69px;top:389.81px" class="cls_004"><span class="cls_004">Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:411.54px" class="cls_004"><span class="cls_004">1. Download the ZIP file containing the code for this chapter, and unzip it.</span></div>
<div style="position:absolute;left:91.32px;top:426.30px" class="cls_004"><span class="cls_004">2. Open a command-line console and go to the folder where you extracted the ZIP</span></div>
<div style="position:absolute;left:104.69px;top:438.90px" class="cls_004"><span class="cls_004">file.</span></div>
<div style="position:absolute;left:91.32px;top:453.66px" class="cls_004"><span class="cls_004">3. Go to the subfolder called </span><span class="cls_013">vm|vagrant-ch6</span><span class="cls_004"> that contains the </span><span class="cls_013">Vagrant</span><span class="cls_004"> file that</span></div>
<div style="position:absolute;left:104.69px;top:466.94px" class="cls_004"><span class="cls_004">we described above.</span></div>
<div style="position:absolute;left:91.32px;top:481.70px" class="cls_004"><span class="cls_004">4. Be sure that your other virtual machine is suspended or shutdown.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 235 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:169000px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background251.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Type the following command, which will create the virtual machine and install</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">Alfresco Community. Remind you that it can take a bit of time to complete the</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">process:</span></div>
<div style="position:absolute;left:139.49px;top:118.91px" class="cls_010"><span class="cls_010">vagrant up</span></div>
<div style="position:absolute;left:91.32px;top:139.52px" class="cls_004"><span class="cls_004">6. When it's completed, just wait few more minutes to let Alfresco start for the first</span></div>
<div style="position:absolute;left:104.69px;top:152.12px" class="cls_004"><span class="cls_004">time, and then </span><span class="cls_013">open http://127.0.0.1:8080/share/</span><span class="cls_004">. You should see the</span></div>
<div style="position:absolute;left:104.69px;top:165.40px" class="cls_004"><span class="cls_004">Alfresco Community login page:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 236 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:169676px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background252.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. You can also open the following URL and test the API explorer</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">http://127.0.0.1:8080/api-explorer/</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:56.69px;top:407.71px" class="cls_004"><span class="cls_004">You can see in the top-right corner that you can enter the username and the password that</span></div>
<div style="position:absolute;left:56.69px;top:420.31px" class="cls_004"><span class="cls_004">you want to use for the authentication. Also, you have a drop-down list that allows you to</span></div>
<div style="position:absolute;left:56.69px;top:432.91px" class="cls_004"><span class="cls_004">select one of these APIs:</span></div>
<div style="position:absolute;left:104.69px;top:454.64px" class="cls_007"><span class="cls_007">Core API</span></div>
<div style="position:absolute;left:104.69px;top:469.44px" class="cls_007"><span class="cls_007">Search API</span></div>
<div style="position:absolute;left:104.69px;top:484.24px" class="cls_007"><span class="cls_007">Authentication API</span></div>
<div style="position:absolute;left:104.69px;top:499.03px" class="cls_007"><span class="cls_007">Discovery API</span></div>
<div style="position:absolute;left:104.69px;top:513.83px" class="cls_007"><span class="cls_007">Workflow API</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 237 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:170352px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background253.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Now that we have our new virtual machine installed, you can do the following things:</span></div>
<div style="position:absolute;left:104.69px;top:92.23px" class="cls_004"><span class="cls_004">Stop Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:106.99px" class="cls_004"><span class="cls_004">Transfer the two modules that we developed (the Alfresco AMP file and the</span></div>
<div style="position:absolute;left:104.69px;top:119.59px" class="cls_004"><span class="cls_004">Share AMP file) into the virtual machine using FileZilla, SCP or your favorite tool</span></div>
<div style="position:absolute;left:104.69px;top:134.35px" class="cls_004"><span class="cls_004">Install your custom AMP files in Alfresco using the same instructions as before</span></div>
<div style="position:absolute;left:104.69px;top:149.11px" class="cls_004"><span class="cls_004">Restart Alfresco (you'll notice that your two modules are compatible with</span></div>
<div style="position:absolute;left:104.69px;top:161.71px" class="cls_004"><span class="cls_004">Alfresco Enterprise and Community)</span></div>
<div style="position:absolute;left:56.69px;top:185.60px" class="cls_004"><span class="cls_004">When Alfresco is restarted and contains your new module, you need to create some</span></div>
<div style="position:absolute;left:56.69px;top:198.20px" class="cls_004"><span class="cls_004">documents to be able to test the Alfresco Development Framework:</span></div>
<div style="position:absolute;left:91.32px;top:219.93px" class="cls_004"><span class="cls_004">1. Create a </span><span class="cls_007">Marketing</span><span class="cls_004"> site.</span></div>
<div style="position:absolute;left:91.32px;top:234.73px" class="cls_004"><span class="cls_004">2. Upload some documents that you'll transform to </span><span class="cls_007">whitepapers</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:249.53px" class="cls_004"><span class="cls_004">3. Apply the </span><span class="cls_007">Someco Webable</span><span class="cls_004">aspect to those documents.</span></div>
<div style="position:absolute;left:91.32px;top:264.32px" class="cls_004"><span class="cls_004">4. Create the group </span><span class="cls_013">SomecoPublisher</span><span class="cls_004"> and add the user that you use to test as</span></div>
<div style="position:absolute;left:104.69px;top:277.60px" class="cls_004"><span class="cls_004">member.</span></div>
<div style="position:absolute;left:91.32px;top:292.36px" class="cls_004"><span class="cls_004">5. Publish some documents using the </span><span class="cls_007">SC Enable Web Flag</span><span class="cls_004"> action.</span></div>
<div style="position:absolute;left:56.69px;top:316.29px" class="cls_004"><span class="cls_004">Now everything is ready to create our own custom JavaScript application.</span></div>
<div style="position:absolute;left:56.69px;top:355.04px" class="cls_008"><span class="cls_008">Creating your first JavaScript application</span></div>
<div style="position:absolute;left:56.69px;top:382.77px" class="cls_004"><span class="cls_004">In this section, we'll cover how to create a very basic screen using the new JavaScript API.</span></div>
<div style="position:absolute;left:56.69px;top:395.37px" class="cls_004"><span class="cls_004">The marketing chief wants us to develop a simple HTML page that displays all webable</span></div>
<div style="position:absolute;left:56.69px;top:407.97px" class="cls_004"><span class="cls_004">documents available in the Alfresco repository. For each of them, we need to display the</span></div>
<div style="position:absolute;left:56.69px;top:420.57px" class="cls_004"><span class="cls_004">name of the document, and the link to the </span><span class="cls_007">Document Details</span><span class="cls_004"> page.</span></div>
<div style="position:absolute;left:56.69px;top:442.21px" class="cls_004"><span class="cls_004">The Alfresco JavaScript API allows you to connect to the Alfresco API, and the Activiti</span></div>
<div style="position:absolute;left:56.69px;top:454.81px" class="cls_004"><span class="cls_004">REST API. In this chapter, we'll use only the Alfresco API. It's the only required to display</span></div>
<div style="position:absolute;left:56.69px;top:467.41px" class="cls_004"><span class="cls_004">webable documents. Let's quickly discover the available methods in this Alfresco JavaScript</span></div>
<div style="position:absolute;left:56.69px;top:480.01px" class="cls_004"><span class="cls_004">API:</span></div>
<div style="position:absolute;left:104.69px;top:501.74px" class="cls_004"><span class="cls_004">Authentication:</span></div>
<div style="position:absolute;left:170.69px;top:514.34px" class="cls_004"><span class="cls_004">Login:</span></div>
<div style="position:absolute;left:169.19px;top:540.39px" class="cls_004"><span class="cls_004">Can be done against Alfresco (referenced as </span><span class="cls_007">ECM</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:169.19px;top:553.02px" class="cls_004"><span class="cls_004">documentation) and/or Activiti (referenced as </span><span class="cls_007">BPM</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:169.19px;top:565.66px" class="cls_004"><span class="cls_004">documentation).</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 238 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:171028px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background254.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:169.19px;top:70.50px" class="cls_004"><span class="cls_004">Can use a username and a password, or an already existing ticket.</span></div>
<div style="position:absolute;left:169.19px;top:92.10px" class="cls_004"><span class="cls_004">This method is monitored by three different events corresponding</span></div>
<div style="position:absolute;left:169.19px;top:104.70px" class="cls_004"><span class="cls_004">to success authentication, failed authentication, and logout:</span></div>
<div style="position:absolute;left:152.69px;top:126.43px" class="cls_004"><span class="cls_004">Logout</span></div>
<div style="position:absolute;left:170.69px;top:141.19px" class="cls_004"><span class="cls_004">isLoggedIn</span></div>
<div style="position:absolute;left:170.69px;top:155.95px" class="cls_004"><span class="cls_004">Get tickets: To retrieve the Alfresco and/or Activiti tickets after</span></div>
<div style="position:absolute;left:170.69px;top:168.55px" class="cls_004"><span class="cls_004">authentication</span></div>
<div style="position:absolute;left:104.69px;top:194.60px" class="cls_004"><span class="cls_004">Alfresco-related API (or ECM-related API):</span></div>
<div style="position:absolute;left:170.69px;top:207.20px" class="cls_007"><span class="cls_007">Get Node Information</span><span class="cls_004"> using a node identifier</span></div>
<div style="position:absolute;left:170.69px;top:222.00px" class="cls_007"><span class="cls_007">Get Folder Children</span><span class="cls_004"> using a node identifier</span></div>
<div style="position:absolute;left:170.69px;top:236.80px" class="cls_007"><span class="cls_007">Create Folder</span></div>
<div style="position:absolute;left:170.69px;top:251.59px" class="cls_007"><span class="cls_007">Upload File</span><span class="cls_004"> (this method is monitored by five events: in progress,</span></div>
<div style="position:absolute;left:170.69px;top:264.23px" class="cls_004"><span class="cls_004">successful upload, aborted upload, error during the upload, and</span></div>
<div style="position:absolute;left:170.69px;top:276.83px" class="cls_004"><span class="cls_004">unauthorized upload)</span></div>
<div style="position:absolute;left:170.69px;top:291.59px" class="cls_007"><span class="cls_007">Delete Node</span><span class="cls_004"> using a node identifier</span></div>
<div style="position:absolute;left:170.69px;top:306.39px" class="cls_007"><span class="cls_007">Delete Node</span><span class="cls_004"> permanently using a node identifier</span></div>
<div style="position:absolute;left:170.69px;top:321.18px" class="cls_007"><span class="cls_007">Get Thumbnail URL</span><span class="cls_004"> using a node identifier</span></div>
<div style="position:absolute;left:170.69px;top:335.98px" class="cls_007"><span class="cls_007">Get Preview URL</span><span class="cls_004"> using a node identifier</span></div>
<div style="position:absolute;left:170.69px;top:350.78px" class="cls_007"><span class="cls_007">Get Content URL</span><span class="cls_004"> using a node identifier</span></div>
<div style="position:absolute;left:170.69px;top:365.58px" class="cls_007"><span class="cls_007">Custom Webscript Call</span><span class="cls_004"> to send a query to any API available in</span></div>
<div style="position:absolute;left:170.69px;top:378.21px" class="cls_004"><span class="cls_004">Alfresco (out-of-the-box or custom)</span></div>
<div style="position:absolute;left:56.69px;top:404.26px" class="cls_004"><span class="cls_004">We are not covering the Activiti-related API, but you can find all the details in the</span></div>
<div style="position:absolute;left:56.69px;top:416.86px" class="cls_004"><span class="cls_004">documentation (</span><a href="https://github.com/Alfresco/alfresco-js-api">https://github.com/Alfresco/alfresco-js-api</a> <span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:438.84px" class="cls_004"><span class="cls_004">You can see that most of the APIs require a node identifier, but we don't have this</span></div>
<div style="position:absolute;left:56.69px;top:451.44px" class="cls_004"><span class="cls_004">information in our case (It's possible to use as well some special node identifier that are not</span></div>
<div style="position:absolute;left:56.69px;top:464.04px" class="cls_004"><span class="cls_004">relevant in our case like </span><span class="cls_013">-root-</span><span class="cls_004">, </span><span class="cls_013">-my-</span><span class="cls_004"> or </span><span class="cls_013">-shared-</span><span class="cls_004">). Because we want to do a search and</span></div>
<div style="position:absolute;left:56.69px;top:477.32px" class="cls_004"><span class="cls_004">the JavaScript API don' provide a function to do that, we'll send a query to a webscript</span></div>
<div style="position:absolute;left:56.69px;top:489.92px" class="cls_004"><span class="cls_004">provided by the Alfresco Repository. This webscript is the same as the one used by Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:502.52px" class="cls_004"><span class="cls_004">Share in the Advanced Search forms. To accomplish it, we'll use the custom webscript call</span></div>
<div style="position:absolute;left:56.69px;top:515.12px" class="cls_004"><span class="cls_004">listed in the latest bullet of the preceding list.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 239 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:171704px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background255.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - develop your first custom UI using</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">the JavaScript API</span></div>
<div style="position:absolute;left:91.32px;top:122.83px" class="cls_004"><span class="cls_004">1. Open STS and create a new Dynamic Web Project. Click on </span><span class="cls_007">Next</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 240 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:172380px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background256.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Name your project </span><span class="cls_013">webable-docs</span><span class="cls_004"> and click on </span><span class="cls_007">Finish</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:91.32px;top:524.84px" class="cls_004"><span class="cls_004">3. We need to download the JavaScript library and save it in our project. Open the</span></div>
<div style="position:absolute;left:104.69px;top:537.44px" class="cls_004"><span class="cls_004">GitHub project (</span><a href="https://github.com/Alfresco/alfresco-js-api">https://github.com/Alfresco/alfresco-js-api</a> <span class="cls_004">) and open the</span></div>
<div style="position:absolute;left:104.69px;top:550.42px" class="cls_004"><span class="cls_004">folder called </span><span class="cls_013">dist</span><span class="cls_004">. You should find a file called </span><span class="cls_013">alfresco-js-api.js</span><span class="cls_004"> (you can</span></div>
<div style="position:absolute;left:104.69px;top:563.70px" class="cls_004"><span class="cls_004">also find the minified version in the same folder). Click on this file, then on the</span></div>
<div style="position:absolute;left:104.69px;top:576.30px" class="cls_007"><span class="cls_007">Download</span><span class="cls_004"> button.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 241 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:173056px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background257.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Create the </span><span class="cls_013">lib</span><span class="cls_004"> folder in the </span><span class="cls_013">WebContent</span><span class="cls_004"> subfolder of your newly created project</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">and move the downloaded file in this folder.</span></div>
<div style="position:absolute;left:91.32px;top:98.54px" class="cls_004"><span class="cls_004">5. Create a new file in the </span><span class="cls_013">WebContent</span><span class="cls_004"> folder called </span><span class="cls_013">index.html</span><span class="cls_004"> and add the basic</span></div>
<div style="position:absolute;left:104.69px;top:111.82px" class="cls_004"><span class="cls_004">following HTML code for your page:</span></div>
<div style="position:absolute;left:139.49px;top:135.03px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE html&gt;</span></div>
<div style="position:absolute;left:139.49px;top:145.83px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:166.49px;top:156.63px" class="cls_010"><span class="cls_010">&lt;head&gt;</span></div>
<div style="position:absolute;left:188.09px;top:167.43px" class="cls_010"><span class="cls_010">&lt;title&gt;Published documents&lt;/title&gt;</span></div>
<div style="position:absolute;left:166.49px;top:178.23px" class="cls_010"><span class="cls_010">&lt;/head&gt;</span></div>
<div style="position:absolute;left:166.49px;top:189.03px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:166.49px;top:199.83px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:139.49px;top:210.63px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:231.24px" class="cls_004"><span class="cls_004">6. Let's add a new reference in the </span><span class="cls_013">head</span><span class="cls_004"> element for the Alfresco JavaScript API:</span></div>
<div style="position:absolute;left:139.49px;top:255.13px" class="cls_010"><span class="cls_010">&lt;script type="text/javascript" src="./lib/alfresco-js-api.js"</span></div>
<div style="position:absolute;left:161.09px;top:265.93px" class="cls_010"><span class="cls_010">charset="utf-8"&gt;&lt;/script&gt;</span></div>
<div style="position:absolute;left:91.32px;top:286.54px" class="cls_004"><span class="cls_004">7. And, finally let's add another reference to another JavaScript file that will send</span></div>
<div style="position:absolute;left:104.69px;top:299.14px" class="cls_004"><span class="cls_004">the query to Alfresco:</span></div>
<div style="position:absolute;left:139.49px;top:322.35px" class="cls_010"><span class="cls_010">&lt;script type="text/javascript" src="./index.js"</span></div>
<div style="position:absolute;left:161.09px;top:333.15px" class="cls_010"><span class="cls_010">charset="utf-8"&gt;&lt;/script&gt;</span></div>
<div style="position:absolute;left:91.32px;top:353.76px" class="cls_004"><span class="cls_004">8. And now, we need to create the JavaScript </span><span class="cls_013">index.js </span><span class="cls_004">file in the </span><span class="cls_013">WebContent</span></div>
<div style="position:absolute;left:104.69px;top:367.04px" class="cls_004"><span class="cls_004">folder. Let's create the main structure first, that is, the authentication process.</span></div>
<div style="position:absolute;left:104.69px;top:379.64px" class="cls_004"><span class="cls_004">We'll use the username </span><span class="cls_013">admin</span><span class="cls_004">, with its default password </span><span class="cls_013">admin</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:139.49px;top:403.53px" class="cls_010"><span class="cls_010">this.alfrescoJsApi = new AlfrescoApi();</span></div>
<div style="position:absolute;left:139.49px;top:414.33px" class="cls_010"><span class="cls_010">this.alfrescoJsApi.login('admin', 'admin').then(function(data)</span></div>
<div style="position:absolute;left:74.69px;top:425.13px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:435.93px" class="cls_010"><span class="cls_010">console.log('API called successfully Login ticket:' + data);</span></div>
<div style="position:absolute;left:139.49px;top:446.73px" class="cls_010"><span class="cls_010">}, function(error) {</span></div>
<div style="position:absolute;left:150.29px;top:457.53px" class="cls_010"><span class="cls_010">console.error(error);</span></div>
<div style="position:absolute;left:139.49px;top:468.33px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:91.32px;top:488.94px" class="cls_004"><span class="cls_004">9. In the </span><span class="cls_013">then</span><span class="cls_004"> function, we are going to create the query object that will use with the</span></div>
<div style="position:absolute;left:104.69px;top:502.22px" class="cls_004"><span class="cls_004">Search API to locate active whitepapers:</span></div>
<div style="position:absolute;left:139.49px;top:525.43px" class="cls_010"><span class="cls_010">var q = {</span></div>
<div style="position:absolute;left:150.29px;top:536.23px" class="cls_010"><span class="cls_010">"prop_sc_isActive" : "true",</span></div>
<div style="position:absolute;left:150.29px;top:547.03px" class="cls_010"><span class="cls_010">"datatype" : "sc:whitepaper"</span></div>
<div style="position:absolute;left:139.49px;top:557.83px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 242 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:173732px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background258.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10. Then, we are going to use the JavaScript method that allows us to call any</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">webscript provided by Alfresco:</span></div>
<div style="position:absolute;left:139.49px;top:106.31px" class="cls_010"><span class="cls_010">this.alfrescoJsApi.webScript.executeWebScript('GET',</span></div>
<div style="position:absolute;left:161.09px;top:117.11px" class="cls_010"><span class="cls_010">'slingshot/search?query='</span></div>
<div style="position:absolute;left:161.09px;top:127.91px" class="cls_010"><span class="cls_010">+ JSON.stringify(q) ).then(function(data) {</span></div>
<div style="position:absolute;left:161.09px;top:138.71px" class="cls_010"><span class="cls_010">console.log('# of items received:' + data.numberFound);</span></div>
<div style="position:absolute;left:193.49px;top:149.51px" class="cls_010"><span class="cls_010">var items = data.items;</span></div>
<div style="position:absolute;left:155.69px;top:160.31px" class="cls_010"><span class="cls_010">}, function(error) {</span></div>
<div style="position:absolute;left:193.49px;top:171.11px" class="cls_010"><span class="cls_010">console.error(error);</span></div>
<div style="position:absolute;left:139.49px;top:181.91px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:86.07px;top:202.52px" class="cls_004"><span class="cls_004">11. And finally, we are going to create a table, with one row per document. On each</span></div>
<div style="position:absolute;left:104.69px;top:215.12px" class="cls_004"><span class="cls_004">row, we'll display the thumbnail, the document name with a link on the details</span></div>
<div style="position:absolute;left:104.69px;top:227.72px" class="cls_004"><span class="cls_004">page, and a download link. Add the following code below the definition of the</span></div>
<div style="position:absolute;left:104.69px;top:240.32px" class="cls_004"><span class="cls_004">variable </span><span class="cls_013">items</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:139.49px;top:264.21px" class="cls_010"><span class="cls_010">var html = "&lt;table&gt;";</span></div>
<div style="position:absolute;left:139.49px;top:275.01px" class="cls_010"><span class="cls_010">for (var i = 0; i &lt; items.length; i++) {</span></div>
<div style="position:absolute;left:150.29px;top:285.81px" class="cls_010"><span class="cls_010">var item = items[i];</span></div>
<div style="position:absolute;left:150.29px;top:307.41px" class="cls_010"><span class="cls_010">var nodeId =</span></div>
<div style="position:absolute;left:161.09px;top:318.21px" class="cls_010"><span class="cls_010">item.nodeRef.substring(item.nodeRef.lastIndexOf('/') + 1);</span></div>
<div style="position:absolute;left:150.29px;top:339.81px" class="cls_010"><span class="cls_010">html += "&lt;tr&gt;";</span></div>
<div style="position:absolute;left:150.29px;top:361.41px" class="cls_010"><span class="cls_010">html += "&lt;td&gt;&lt;img src='"</span></div>
<div style="position:absolute;left:161.09px;top:372.21px" class="cls_010"><span class="cls_010">+</span></div>
<div style="position:absolute;left:74.69px;top:383.01px" class="cls_010"><span class="cls_010">this.alfrescoJsApi.content.getDocumentThumbnailUrl(nodeId)</span></div>
<div style="position:absolute;left:161.09px;top:393.81px" class="cls_010"><span class="cls_010">+ "' &gt;&lt;/td&gt;";</span></div>
<div style="position:absolute;left:150.29px;top:415.41px" class="cls_010"><span class="cls_010">html += "&lt;td&gt;";</span></div>
<div style="position:absolute;left:150.29px;top:437.01px" class="cls_010"><span class="cls_010">html += "&lt;a target='_blank'</span></div>
<div style="position:absolute;left:166.49px;top:447.81px" class="cls_010"><span class="cls_010">href='/share/page/document-details?nodeRef="</span></div>
<div style="position:absolute;left:166.49px;top:458.61px" class="cls_010"><span class="cls_010">+ item.nodeRef + "'&gt;" + item.displayName + "&lt;/a&gt;&lt;br/&gt;"</span></div>
<div style="position:absolute;left:150.29px;top:480.21px" class="cls_010"><span class="cls_010">html += "&lt;a target='_blank' href='"</span></div>
<div style="position:absolute;left:161.09px;top:491.01px" class="cls_010"><span class="cls_010">+ this.alfrescoJsApi.content.getContentUrl(nodeId)</span></div>
<div style="position:absolute;left:161.09px;top:501.81px" class="cls_010"><span class="cls_010">+ "'&gt;Download&lt;/a&gt;"</span></div>
<div style="position:absolute;left:150.29px;top:523.41px" class="cls_010"><span class="cls_010">html += "&lt;/td&gt;";</span></div>
<div style="position:absolute;left:150.29px;top:534.21px" class="cls_010"><span class="cls_010">html += "&lt;/tr&gt;";</span></div>
<div style="position:absolute;left:139.49px;top:545.01px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:555.81px" class="cls_010"><span class="cls_010">html += "&lt;/table&gt;";</span></div>
<div style="position:absolute;left:139.49px;top:566.61px" class="cls_010"><span class="cls_010">document.body.innerHTML += html;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 243 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:174408px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background259.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">12. Everything is ready. We can now package our mini project. To keep it simple, we</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">are just going to create a new Tomcat web application and deploy it in the same</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">Tomcat as Alfresco. Right-click on the </span><span class="cls_013">webable-docs</span><span class="cls_004"> project and click on </span><span class="cls_007">Export</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">| </span><span class="cls_007">Export </span><span class="cls_028">…</span><span class="cls_004">. Select </span><span class="cls_013">WAR file</span><span class="cls_004"> in the </span><span class="cls_013">Web</span><span class="cls_004"> category:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 244 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:175084px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background260.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">13. Click on </span><span class="cls_007">Browse</span><span class="cls_004"> to select the export destination, and click on </span><span class="cls_007">Finish</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:86.07px;top:409.47px" class="cls_004"><span class="cls_004">14. You are now ready to deploy your new web application into your virtual</span></div>
<div style="position:absolute;left:104.69px;top:422.07px" class="cls_004"><span class="cls_004">machine using FileZilla or SCP. You don't need to shutdown your Tomcat</span></div>
<div style="position:absolute;left:104.69px;top:434.67px" class="cls_004"><span class="cls_004">instance because it's configured in auto-deploy mode. Just drop your WAR file in</span></div>
<div style="position:absolute;left:104.69px;top:447.27px" class="cls_004"><span class="cls_004">the </span><span class="cls_013">/opt/alfresco-community/tomcat/webapps/</span><span class="cls_004">folder.</span></div>
<div style="position:absolute;left:86.07px;top:462.71px" class="cls_004"><span class="cls_004">15. If you track the Alfresco log file, you should see those lines that means that</span></div>
<div style="position:absolute;left:104.69px;top:475.31px" class="cls_004"><span class="cls_004">Tomcat auto-deployed your WAR file:</span></div>
<div style="position:absolute;left:139.49px;top:498.52px" class="cls_010"><span class="cls_010">Oct 09, 2016 7:01:46 PM org.apache.catalina.startup</span></div>
<div style="position:absolute;left:139.49px;top:509.32px" class="cls_010"><span class="cls_010">.HostConfig deployWAR</span></div>
<div style="position:absolute;left:139.49px;top:530.92px" class="cls_010"><span class="cls_010">INFO: Deploying web application</span></div>
<div style="position:absolute;left:161.09px;top:541.72px" class="cls_010"><span class="cls_010">archive /opt/alfresco-community/tomcat/webapps</span></div>
<div style="position:absolute;left:161.09px;top:552.52px" class="cls_010"><span class="cls_010">/webable-docs.war</span></div>
<div style="position:absolute;left:139.49px;top:574.12px" class="cls_010"><span class="cls_010">Oct 09, 2016 7:01:46 PM org.apache.catalina.startup</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 245 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:175760px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background261.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">.HostConfig deployWAR</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">INFO: Deployment of web application archive</span></div>
<div style="position:absolute;left:155.69px;top:102.22px" class="cls_010"><span class="cls_010">/opt/alfresco-community/tomcat/webapps/webable-docs.war</span></div>
<div style="position:absolute;left:155.69px;top:113.02px" class="cls_010"><span class="cls_010">has finished in 113 ms</span></div>
<div style="position:absolute;left:86.07px;top:133.63px" class="cls_004"><span class="cls_004">16. Then, you can open your browser on</span></div>
<div style="position:absolute;left:104.69px;top:146.23px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/webable-docs/">http://localhost:8080/webable-docs/</a> <span class="cls_004"> and see a list of documents. For</span></div>
<div style="position:absolute;left:104.69px;top:159.51px" class="cls_004"><span class="cls_004">each document, you should see the thumbnail, the document name with a link to</span></div>
<div style="position:absolute;left:104.69px;top:172.11px" class="cls_004"><span class="cls_004">the details page, and a </span><span class="cls_007">Download</span><span class="cls_004"> link:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 246 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:176436px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background262.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">17. Feel free to create new whitepapers and enable them. The list should be</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">automatically updated. However, be aware that Alfresco, and more especially</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">Solr, needs few seconds to index your documents. Your newly uploaded</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">documents may appear only five or ten seconds after the upload.</span></div>
<div style="position:absolute;left:56.69px;top:132.19px" class="cls_004"><span class="cls_004">You just created your first JavaScript application using the Alfresco JavaScript API. You</span></div>
<div style="position:absolute;left:56.69px;top:144.79px" class="cls_004"><span class="cls_004">could have done the same using plain JavaScript or any other JavaScript framework</span></div>
<div style="position:absolute;left:56.69px;top:157.39px" class="cls_004"><span class="cls_004">providing methods to send AJAX queries. The Alfresco JavaScript API is just helping you</span></div>
<div style="position:absolute;left:56.69px;top:169.99px" class="cls_004"><span class="cls_004">by providing the basic mechanism required to build your own JavaScript application. It's</span></div>
<div style="position:absolute;left:56.69px;top:182.59px" class="cls_004"><span class="cls_004">time to switch to Angular.</span></div>
<div style="position:absolute;left:56.69px;top:221.34px" class="cls_008"><span class="cls_008">Creating your first Angular web application</span></div>
<div style="position:absolute;left:56.69px;top:249.07px" class="cls_004"><span class="cls_004">Let's start by a quick overview of an Angular application. We won't go into the details of</span></div>
<div style="position:absolute;left:56.69px;top:261.67px" class="cls_004"><span class="cls_004">the framework because it's not the purpose of this book. Angular is a framework for</span></div>
<div style="position:absolute;left:56.69px;top:274.27px" class="cls_004"><span class="cls_004">building web applications in HTML and JavaScript. It consists of multiple libraries, some of</span></div>
<div style="position:absolute;left:56.69px;top:286.88px" class="cls_004"><span class="cls_004">them core and other optional. You create an Angular application by writing HTML </span><span class="cls_012">templates</span></div>
<div style="position:absolute;left:56.69px;top:299.48px" class="cls_004"><span class="cls_004">with Angularized markup, writing </span><span class="cls_012">component</span><span class="cls_004"> classes to manage those templates, adding</span></div>
<div style="position:absolute;left:56.69px;top:312.09px" class="cls_004"><span class="cls_004">application logic in </span><span class="cls_012">services</span><span class="cls_004">, and boxing components and services in </span><span class="cls_012">modules</span><span class="cls_004">. Of course,</span></div>
<div style="position:absolute;left:56.69px;top:324.69px" class="cls_004"><span class="cls_004">there is more to it than this, and you can read more on the Angular website,</span></div>
<div style="position:absolute;left:56.69px;top:337.29px" class="cls_010"><span class="cls_010"> </span><a href="https://angular.io/docs/">https://angular.io/docs/</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:359.27px" class="cls_004"><span class="cls_004">Why Angular is so popular? From my point of view, the most relevant reasons are as</span></div>
<div style="position:absolute;left:56.69px;top:371.87px" class="cls_004"><span class="cls_004">follows:</span></div>
<div style="position:absolute;left:104.69px;top:393.60px" class="cls_004"><span class="cls_004">It's very easy to structure your code using the </span><span class="cls_007">MVC</span><span class="cls_004"> (</span><span class="cls_007">Model-View-Controller</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:104.69px;top:406.24px" class="cls_004"><span class="cls_004">pattern</span></div>
<div style="position:absolute;left:104.69px;top:421.00px" class="cls_004"><span class="cls_004">The two-way binding allows you to significantly reduce the amount of code to</span></div>
<div style="position:absolute;left:104.69px;top:433.60px" class="cls_004"><span class="cls_004">keep the model and the view synchronized</span></div>
<div style="position:absolute;left:104.69px;top:448.36px" class="cls_004"><span class="cls_004">The HTML and the JS code is very well decoupled, that allows to have designers</span></div>
<div style="position:absolute;left:104.69px;top:460.96px" class="cls_004"><span class="cls_004">and developers to work in parallel on the same screens</span></div>
<div style="position:absolute;left:104.69px;top:475.72px" class="cls_004"><span class="cls_004">Angular comes with all required libraries to build a complete data-based web</span></div>
<div style="position:absolute;left:104.69px;top:488.32px" class="cls_004"><span class="cls_004">application; there's no need to manually install any other framework</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 247 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:177112px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background263.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">On top of Angular and the Alfresco JavaScript API, Alfresco has created seven components</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">so far. This list is not closed; Alfresco will enrich it throughout the different versions. The</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">list of components is as follows:</span></div>
<div style="position:absolute;left:104.69px;top:117.43px" class="cls_013"><span class="cls_013">ng2-alfresco-core</span><span class="cls_004">: Core library used by the other components</span></div>
<div style="position:absolute;left:104.69px;top:132.87px" class="cls_013"><span class="cls_013">ng2-alfresco-datatable</span><span class="cls_004">: Simple Document List component</span></div>
<div style="position:absolute;left:104.69px;top:148.31px" class="cls_013"><span class="cls_013">ng2-alfresco-documentlist</span><span class="cls_004">: Advanced Document List component</span></div>
<div style="position:absolute;left:104.69px;top:163.75px" class="cls_013"><span class="cls_013">ng2-alfresco-login</span><span class="cls_004">: Login component</span></div>
<div style="position:absolute;left:104.69px;top:179.19px" class="cls_013"><span class="cls_013">ng2-alfresco-search</span><span class="cls_004">: Basic Search component</span></div>
<div style="position:absolute;left:104.69px;top:194.63px" class="cls_013"><span class="cls_013">ng2-alfresco-upload</span><span class="cls_004">: Upload component</span></div>
<div style="position:absolute;left:104.69px;top:210.07px" class="cls_013"><span class="cls_013">ng2-alfresco-viewer</span><span class="cls_004">: PDF previewer component using the library </span><span class="cls_013">PDF.js</span></div>
<div style="position:absolute;left:56.69px;top:234.64px" class="cls_004"><span class="cls_004">When we create our first application, you'll notice that all components are styled using a</span></div>
<div style="position:absolute;left:56.69px;top:247.24px" class="cls_004"><span class="cls_004">design guideline based on Google Material Design (</span><a href="https://material.io/guidelines/">https://material.io/guidelines/</a> <span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:269.23px" class="cls_004"><span class="cls_004">To help you to start quickly, Alfresco has created an app generator based on </span><span class="cls_012">Yeoman</span><span class="cls_004">. It is a</span></div>
<div style="position:absolute;left:56.69px;top:281.83px" class="cls_004"><span class="cls_004">generic scaffolding system allowing the creation of any kind of app. This generator will</span></div>
<div style="position:absolute;left:56.69px;top:294.42px" class="cls_004"><span class="cls_004">create all the boilerplate code required for an Angular web application.</span></div>
<div style="position:absolute;left:56.69px;top:331.12px" class="cls_014"><span class="cls_014">Step-by-step - installing all prerequisites</span></div>
<div style="position:absolute;left:56.69px;top:356.35px" class="cls_004"><span class="cls_004">An Angular web application can be packaged and deployed in any container. Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:368.95px" class="cls_004"><span class="cls_004">decided to generate Node.JS application. To show that we can deploy in different servers</span></div>
<div style="position:absolute;left:56.69px;top:381.55px" class="cls_004"><span class="cls_004">the Angular web application and Alfresco, we'll install the Angular application directly in</span></div>
<div style="position:absolute;left:56.69px;top:394.14px" class="cls_004"><span class="cls_004">our computer. The following instructions should work on Mac OSX and UNIX systems. For</span></div>
<div style="position:absolute;left:56.69px;top:406.74px" class="cls_004"><span class="cls_004">each step, we'll point you to the relevant documentation to get details about your specific</span></div>
<div style="position:absolute;left:56.69px;top:419.35px" class="cls_004"><span class="cls_004">environment:</span></div>
<div style="position:absolute;left:91.32px;top:441.08px" class="cls_004"><span class="cls_004">1. First, authenticate as root or Administrator</span></div>
<div style="position:absolute;left:91.32px;top:455.83px" class="cls_004"><span class="cls_004">2. We need to install the latest Node.JS version in our system. (More details here:</span></div>
<div style="position:absolute;left:104.69px;top:468.43px" class="cls_013"><span class="cls_013"> </span><a href="https://nodejs.org/en/download/package-manager/">https://nodejs.org/en/download/package-manager/</a> <span class="cls_004">). The valid</span></div>
<div style="position:absolute;left:104.69px;top:481.71px" class="cls_004"><span class="cls_004">command for OSX is as follows:</span></div>
<div style="position:absolute;left:139.49px;top:504.92px" class="cls_010"><span class="cls_010">curl "</span><a href="https://nodejs.org/dist/latest/node-/">https://nodejs.org/dist/latest/node-</a> </div>
<div style="position:absolute;left:161.09px;top:515.72px" class="cls_010"><span class="cls_010">${VERSION:-$(wget -qO- </span><a href="https://nodejs.org/dist/latest/">https://nodejs.org/dist/latest/</a> </div>
<div style="position:absolute;left:161.09px;top:526.53px" class="cls_010"><span class="cls_010">| sed -nE 's|.*&gt;node-(.*)\.pkg&lt;/a&gt;.*|\1|p')}.pkg" &gt;</span></div>
<div style="position:absolute;left:166.49px;top:537.33px" class="cls_010"><span class="cls_010">"$HOME/Downloads/node-latest.pkg" &amp;&amp; sudo installer</span></div>
<div style="position:absolute;left:161.09px;top:548.13px" class="cls_010"><span class="cls_010">-store -pkg "$HOME/Downloads/node-latest.pkg" -target "/"</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 248 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:177788px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background264.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Be sure that you use a Node.JS version higher than 5:</span></div>
<div style="position:absolute;left:139.49px;top:93.71px" class="cls_010"><span class="cls_010">$&gt; node -v</span></div>
<div style="position:absolute;left:139.49px;top:104.51px" class="cls_010"><span class="cls_010">v6.7.0</span></div>
<div style="position:absolute;left:91.32px;top:125.12px" class="cls_004"><span class="cls_004">4. Let's also check the </span><span class="cls_013">npm</span><span class="cls_004"> version, which needs to be higher than 3:</span></div>
<div style="position:absolute;left:139.49px;top:149.01px" class="cls_010"><span class="cls_010">$&gt; npm -v</span></div>
<div style="position:absolute;left:139.49px;top:159.81px" class="cls_010"><span class="cls_010">3.10.3</span></div>
<div style="position:absolute;left:91.32px;top:180.42px" class="cls_004"><span class="cls_004">5. Then, we can install Yeoman:</span></div>
<div style="position:absolute;left:139.49px;top:203.63px" class="cls_010"><span class="cls_010">npm install -g yo</span></div>
<div style="position:absolute;left:91.32px;top:224.24px" class="cls_004"><span class="cls_004">6. And finally, install the Yeoman generator developed by Alfresco:</span></div>
<div style="position:absolute;left:139.49px;top:247.45px" class="cls_010"><span class="cls_010">npm install -g generator-ng2-alfresco-app</span></div>
<div style="position:absolute;left:56.69px;top:267.93px" class="cls_004"><span class="cls_004">Everything is now ready to create our first Angular application.</span></div>
<div style="position:absolute;left:56.69px;top:304.63px" class="cls_014"><span class="cls_014">Step-by-step - creating your first Angular</span></div>
<div style="position:absolute;left:56.69px;top:326.23px" class="cls_014"><span class="cls_014">application</span></div>
<div style="position:absolute;left:56.69px;top:351.45px" class="cls_004"><span class="cls_004">The following section will describe how you can create your first application using the</span></div>
<div style="position:absolute;left:56.69px;top:364.05px" class="cls_004"><span class="cls_004">application generator provided by Alfresco:</span></div>
<div style="position:absolute;left:91.32px;top:385.78px" class="cls_004"><span class="cls_004">1. In STS, create a new </span><span class="cls_007">General</span><span class="cls_004"> | </span><span class="cls_007">Project</span><span class="cls_004"> called </span><span class="cls_013">someco-app</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:401.22px" class="cls_004"><span class="cls_004">2. Open a command-line tool and go to the project folder that you just created in</span></div>
<div style="position:absolute;left:104.69px;top:413.82px" class="cls_004"><span class="cls_004">STS.</span></div>
<div style="position:absolute;left:91.32px;top:428.58px" class="cls_004"><span class="cls_004">3. Create the Angular application:</span></div>
<div style="position:absolute;left:139.49px;top:451.79px" class="cls_010"><span class="cls_010">yo ng2-alfresco-app</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 249 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:178464px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background265.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. You will have to reply if you want to help Yeoman by providing them with</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">information. Feel free to reply how you want:</span></div>
<div style="position:absolute;left:91.32px;top:320.03px" class="cls_004"><span class="cls_004">5. Then, reply to each question:</span></div>
<div style="position:absolute;left:152.69px;top:343.92px" class="cls_004"><span class="cls_004">What's the name of your App? </span><span class="cls_013">someco-app</span></div>
<div style="position:absolute;left:152.69px;top:359.36px" class="cls_004"><span class="cls_004">How would you describe the app? </span><span class="cls_013">Someco Angular 2 Application</span></div>
<div style="position:absolute;left:152.69px;top:374.81px" class="cls_004"><span class="cls_004">Author's Name: </span><span class="cls_012">Anything that you want</span></div>
<div style="position:absolute;left:152.69px;top:389.57px" class="cls_004"><span class="cls_004">Author's Email: </span><span class="cls_012">Anything that you want</span></div>
<div style="position:absolute;left:152.69px;top:404.34px" class="cls_004"><span class="cls_004">Author's Homepage: </span><span class="cls_012">Anything that you want</span></div>
<div style="position:absolute;left:152.69px;top:419.10px" class="cls_004"><span class="cls_004">Package keywords (comma to split): </span><span class="cls_013">test,alfresco,someco</span></div>
<div style="position:absolute;left:152.69px;top:434.54px" class="cls_004"><span class="cls_004">What is your Alfresco platform server URL?</span></div>
<div style="position:absolute;left:152.69px;top:446.36px" class="cls_013"><span class="cls_013"> </span><a href="http://127.0.0.1:8080/">http://127.0.0.1:8080</a> </div>
<div style="position:absolute;left:152.69px;top:461.30px" class="cls_004"><span class="cls_004">What is your Activiti platform server URL? </span><a href="http://127.0.0.1:9999/">http://127.0.0.1:9999</a> </div>
<div style="position:absolute;left:152.69px;top:476.74px" class="cls_004"><span class="cls_004">GitHub username or organization: </span><span class="cls_012">Anything that you want</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 250 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:179140px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background266.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:152.69px;top:70.50px" class="cls_004"><span class="cls_004">Do you want include the User info component? </span><span class="cls_013">Yes</span></div>
<div style="position:absolute;left:152.69px;top:85.94px" class="cls_004"><span class="cls_004">Do you want include a drawer bar? </span><span class="cls_013">Yes</span></div>
<div style="position:absolute;left:152.69px;top:101.38px" class="cls_004"><span class="cls_004">Do you want include a search bar? </span><span class="cls_013">Yes</span></div>
<div style="position:absolute;left:152.69px;top:116.82px" class="cls_004"><span class="cls_004">Do you want include a Document List? </span><span class="cls_013">Yes</span></div>
<div style="position:absolute;left:152.69px;top:132.26px" class="cls_004"><span class="cls_004">Do you want include Activiti BPM components? </span><span class="cls_013">Yes</span></div>
<div style="position:absolute;left:152.69px;top:147.70px" class="cls_004"><span class="cls_004">Which license do you want to use? </span><span class="cls_013">Apache 2.0</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 251 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:179816px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background267.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. Then, it will generate all required files for our application. If files are not</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">generated, try to run the generator in DEBUG mode: </span><span class="cls_013">DEBUG=yeoman:generator</span></div>
<div style="position:absolute;left:104.69px;top:95.60px" class="cls_013"><span class="cls_013">yo ng2-alfresco-app</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 252 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:180492px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background268.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. If you go back to STS, and refresh the project, you should see the entire folder</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">structure:</span></div>
<div style="position:absolute;left:91.32px;top:431.78px" class="cls_004"><span class="cls_004">8. Now, let's install all dependencies (in the </span><span class="cls_013">node_modules </span><span class="cls_004">sub-folder) required by</span></div>
<div style="position:absolute;left:104.69px;top:445.06px" class="cls_004"><span class="cls_004">our application:</span></div>
<div style="position:absolute;left:139.49px;top:468.27px" class="cls_010"><span class="cls_010">npm install</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 253 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:181168px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background269.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. We can start the application now:</span></div>
<div style="position:absolute;left:139.49px;top:93.71px" class="cls_010"><span class="cls_010">npm start</span></div>
<div style="position:absolute;left:86.07px;top:114.32px" class="cls_004"><span class="cls_004">10. A browser should automatically open at </span><span class="cls_013">http://localhost:3000/</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 254 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:181844px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background270.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. Authenticate as </span><span class="cls_013">admin</span><span class="cls_004">/</span><span class="cls_013">admin</span><span class="cls_004">. The application will open the dashboard.</span></div>
<div style="position:absolute;left:86.07px;top:376.76px" class="cls_004"><span class="cls_004">12. If you click on the </span><span class="cls_007">DocumentList</span><span class="cls_004"> link in the top banner, it will show the folders</span></div>
<div style="position:absolute;left:104.69px;top:389.40px" class="cls_004"><span class="cls_004">and documents stored in the site </span><span class="cls_007">Sample: Web Site Design Project</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 255 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:182520px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background271.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:86.07px;top:348.36px" class="cls_004"><span class="cls_004">13. Click on the different </span><span class="cls_007">Go to</span><span class="cls_004"> buttons and the list of documents will be directly</span></div>
<div style="position:absolute;left:104.69px;top:361.00px" class="cls_004"><span class="cls_004">refreshed. You can notice that we can implement some custom UI actions. Feel</span></div>
<div style="position:absolute;left:104.69px;top:373.60px" class="cls_004"><span class="cls_004">free as well to upload documents directly from this UI. You'll notice that you can</span></div>
<div style="position:absolute;left:104.69px;top:386.20px" class="cls_004"><span class="cls_004">just drag and drop documents into the page to upload documents.</span></div>
<div style="position:absolute;left:86.07px;top:400.96px" class="cls_004"><span class="cls_004">14. If you click on </span><span class="cls_007">Activiti</span><span class="cls_004">, you'll be redirected to the login page because we don't</span></div>
<div style="position:absolute;left:104.69px;top:413.59px" class="cls_004"><span class="cls_004">have an Activiti server.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 256 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:183196px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background272.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">15. Finally, you can as well do some search in Alfresco. In the top banner, just type</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">ppt</span><span class="cls_004"> and type on </span><span class="cls_007">Enter</span><span class="cls_004">. You should find these documents:</span></div>
<div style="position:absolute;left:56.69px;top:379.96px" class="cls_004"><span class="cls_004">You'll notice that this application is functional but very basic for the moment. You have to</span></div>
<div style="position:absolute;left:56.69px;top:392.56px" class="cls_004"><span class="cls_004">keep in mind that the published version at the time of writing is only a way for Alfresco to</span></div>
<div style="position:absolute;left:56.69px;top:405.16px" class="cls_004"><span class="cls_004">demonstrate what they will provide in the future release with this Application</span></div>
<div style="position:absolute;left:56.69px;top:417.76px" class="cls_004"><span class="cls_004">Development Framework. I'm sure that you want to see a bit more. For that, you can re-use</span></div>
<div style="position:absolute;left:56.69px;top:430.36px" class="cls_004"><span class="cls_004">a demo shell available in GitHub.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 257 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:183872px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background273.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - running the Alfresco demo shell</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">We are going to download the demonstration project from GitHub, run it and explore the</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">additional components.</span></div>
<div style="position:absolute;left:91.32px;top:129.31px" class="cls_004"><span class="cls_004">1. First, we assume that you have </span><span class="cls_013">git</span><span class="cls_004"> installed on your computer.</span></div>
<div style="position:absolute;left:91.32px;top:144.75px" class="cls_004"><span class="cls_004">2. Clone the GitHub repository of Alfresco Angular2 components:</span></div>
<div style="position:absolute;left:139.49px;top:167.96px" class="cls_010"><span class="cls_010">git clone</span></div>
<div style="position:absolute;left:74.69px;top:178.76px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/alfresco/alfresco-ng2-components.git/">https://github.com/Alfresco/alfresco-ng2-components.git</a> </div>
<div style="position:absolute;left:91.32px;top:199.37px" class="cls_004"><span class="cls_004">3. Go to the folder that just been created by the </span><span class="cls_013">git</span><span class="cls_004"> command, and you should find</span></div>
<div style="position:absolute;left:104.69px;top:212.65px" class="cls_004"><span class="cls_004">a sub-folder called </span><span class="cls_013">demo-shell-ng2</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:139.49px;top:236.54px" class="cls_010"><span class="cls_010">$&gt; cd alfresco-ng2-components/</span></div>
<div style="position:absolute;left:139.49px;top:247.34px" class="cls_010"><span class="cls_010">$&gt; ll</span></div>
<div style="position:absolute;left:139.49px;top:258.14px" class="cls_010"><span class="cls_010">total 80</span></div>
<div style="position:absolute;left:139.49px;top:268.94px" class="cls_010"><span class="cls_010">-rw-r--r--</span></div>
<div style="position:absolute;left:209.69px;top:268.94px" class="cls_010"><span class="cls_010">1 ben</span></div>
<div style="position:absolute;left:247.49px;top:268.94px" class="cls_010"><span class="cls_010">2380 Oct 10 17:49 INTRODUCTION.md</span></div>
<div style="position:absolute;left:139.49px;top:279.74px" class="cls_010"><span class="cls_010">-rw-r--r--</span></div>
<div style="position:absolute;left:209.69px;top:279.74px" class="cls_010"><span class="cls_010">1 ben</span></div>
<div style="position:absolute;left:247.49px;top:279.74px" class="cls_010"><span class="cls_010">9724 Oct 10 17:49 LICENSE</span></div>
<div style="position:absolute;left:139.49px;top:290.54px" class="cls_010"><span class="cls_010">-rw-r--r--</span></div>
<div style="position:absolute;left:209.69px;top:290.54px" class="cls_010"><span class="cls_010">1 ben</span></div>
<div style="position:absolute;left:247.49px;top:290.54px" class="cls_010"><span class="cls_010">4409 Oct 10 17:49 PREREQUISITES.md</span></div>
<div style="position:absolute;left:139.49px;top:301.34px" class="cls_010"><span class="cls_010">-rw-r--r--</span></div>
<div style="position:absolute;left:209.69px;top:301.34px" class="cls_010"><span class="cls_010">1 ben</span></div>
<div style="position:absolute;left:247.49px;top:301.34px" class="cls_010"><span class="cls_010">4481 Oct 10 17:49 README.md</span></div>
<div style="position:absolute;left:139.49px;top:312.14px" class="cls_010"><span class="cls_010">-rw-r--r--</span></div>
<div style="position:absolute;left:209.69px;top:312.14px" class="cls_010"><span class="cls_010">1 ben</span></div>
<div style="position:absolute;left:247.49px;top:312.14px" class="cls_010"><span class="cls_010">2852 Oct 10 17:49 appveyor.yml</span></div>
<div style="position:absolute;left:139.49px;top:322.94px" class="cls_010"><span class="cls_010">drwxr-xr-x</span></div>
<div style="position:absolute;left:209.69px;top:322.94px" class="cls_010"><span class="cls_010">6 ben</span></div>
<div style="position:absolute;left:252.89px;top:322.94px" class="cls_010"><span class="cls_010">204 Oct 10 17:49 assets/</span></div>
<div style="position:absolute;left:139.49px;top:333.74px" class="cls_010"><span class="cls_010">drwxr-xr-x</span></div>
<div style="position:absolute;left:204.29px;top:333.74px" class="cls_010"><span class="cls_010">21 ben</span></div>
<div style="position:absolute;left:252.89px;top:333.74px" class="cls_010"><span class="cls_010">714 Oct 10 17:49 demo-shell-ng2/</span></div>
<div style="position:absolute;left:139.49px;top:344.54px" class="cls_010"><span class="cls_010">drwxr-xr-x</span></div>
<div style="position:absolute;left:204.29px;top:344.54px" class="cls_010"><span class="cls_010">15 ben</span></div>
<div style="position:absolute;left:252.89px;top:344.54px" class="cls_010"><span class="cls_010">510 Oct 10 17:49 ng2-components/</span></div>
<div style="position:absolute;left:139.49px;top:355.34px" class="cls_010"><span class="cls_010">drwxr-xr-x</span></div>
<div style="position:absolute;left:204.29px;top:355.34px" class="cls_010"><span class="cls_010">11 ben</span></div>
<div style="position:absolute;left:252.89px;top:355.34px" class="cls_010"><span class="cls_010">374 Oct 10 17:49 scripts/</span></div>
<div style="position:absolute;left:139.49px;top:366.14px" class="cls_010"><span class="cls_010">-rw-r--r--</span></div>
<div style="position:absolute;left:209.69px;top:366.14px" class="cls_010"><span class="cls_010">1 ben</span></div>
<div style="position:absolute;left:247.49px;top:366.14px" class="cls_010"><span class="cls_010">2554 Oct 10 17:49 tslint.json</span></div>
<div style="position:absolute;left:91.32px;top:386.75px" class="cls_004"><span class="cls_004">4. Go to the </span><span class="cls_013">demo-shell-ng2</span><span class="cls_004"> folder and install all dependencies:</span></div>
<div style="position:absolute;left:139.49px;top:410.64px" class="cls_010"><span class="cls_010">cd demo-shell-ng2/</span></div>
<div style="position:absolute;left:139.49px;top:421.44px" class="cls_010"><span class="cls_010">npm install</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 258 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:184548px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background274.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Start the demo shell:</span></div>
<div style="position:absolute;left:139.49px;top:93.71px" class="cls_020"><span class="cls_020">npm start</span></div>
<div style="position:absolute;left:91.32px;top:114.32px" class="cls_004"><span class="cls_004">6. A browser should automatically open at </span><span class="cls_013">http://0.0.0.0:3000/</span><span class="cls_004">. It's very</span></div>
<div style="position:absolute;left:104.69px;top:127.60px" class="cls_004"><span class="cls_004">similar to your application (except that it contains more components):</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 259 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:185224px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background275.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Login as admin, click on the list icon in the header next to the </span><span class="cls_007">Settings</span><span class="cls_004"> link, click</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">on </span><span class="cls_007">DataTable</span><span class="cls_004">. It's a UI component that you can use to display items with</span></div>
<div style="position:absolute;left:104.69px;top:95.78px" class="cls_004"><span class="cls_004">advanced features, such as multiselect:</span></div>
<div style="position:absolute;left:91.32px;top:379.21px" class="cls_004"><span class="cls_004">8. In the same list, click on the </span><span class="cls_007">Webscript</span><span class="cls_004"> link. This page is developed to</span></div>
<div style="position:absolute;left:104.69px;top:391.84px" class="cls_004"><span class="cls_004">demonstrate that we can call any webscript provided by Alfresco, and we can</span></div>
<div style="position:absolute;left:104.69px;top:404.44px" class="cls_004"><span class="cls_004">display the results without reloading the page. Update the first field with this</span></div>
<div style="position:absolute;left:104.69px;top:417.04px" class="cls_004"><span class="cls_004">value:</span></div>
<div style="position:absolute;left:139.49px;top:440.26px" class="cls_020"><span class="cls_020">sample/folder/Company%20Home/Sites/marketing/documentLibrary</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 260 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:185900px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background276.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. It lists automatically the </span><span class="cls_013">Whitepapers </span><span class="cls_004">folder that you created using Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">Share:</span></div>
<div style="position:absolute;left:56.69px;top:389.36px" class="cls_004"><span class="cls_004">It's important to know that you can create your own custom components. Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:401.96px" class="cls_004"><span class="cls_004">implemented another generator that you can find out on this page</span></div>
<div style="position:absolute;left:56.69px;top:414.56px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/Alfresco/generator-ng2-alfresco-component">https://github.com/Alfresco/generator-ng2-alfresco-component</a> <span class="cls_004">. This page will</span></div>
<div style="position:absolute;left:56.69px;top:427.54px" class="cls_004"><span class="cls_004">explain you on how to install the generator and how to use it. If you want to re-use one of</span></div>
<div style="position:absolute;left:56.69px;top:440.14px" class="cls_004"><span class="cls_004">the components already developed by Alfresco, you can take a look at the following page</span></div>
<div style="position:absolute;left:56.69px;top:452.74px" class="cls_013"><span class="cls_013">http://devproducts.alfresco.com/</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 261 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:186576px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background277.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Creating an Angular Application</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">In this chapter, you learned about the new Alfresco Development Framework that Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">is working on, including the new Angular2 components. By choice, we didn't cover the</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">topic of creating a new component, or customizing an existing component. As already</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">explained, this framework is not ready for a production use and is going to evolve very</span></div>
<div style="position:absolute;left:56.69px;top:147.78px" class="cls_004"><span class="cls_004">quickly in the next few months. I didn't want to provide information that maybe very</span></div>
<div style="position:absolute;left:56.69px;top:160.38px" class="cls_004"><span class="cls_004">quickly outdated.</span></div>
<div style="position:absolute;left:56.69px;top:181.98px" class="cls_004"><span class="cls_004">Specifically, you learned how to do the following:</span></div>
<div style="position:absolute;left:104.69px;top:203.71px" class="cls_004"><span class="cls_004">Create a dedicated virtual machine for this chapter</span></div>
<div style="position:absolute;left:104.69px;top:218.47px" class="cls_004"><span class="cls_004">Create a new web project and deploy it in Tomcat using the Alfresco JavaScript</span></div>
<div style="position:absolute;left:104.69px;top:231.07px" class="cls_004"><span class="cls_004">API</span></div>
<div style="position:absolute;left:104.69px;top:245.83px" class="cls_004"><span class="cls_004">Configure your environment to create a new Alfresco Angular application</span></div>
<div style="position:absolute;left:104.69px;top:260.59px" class="cls_004"><span class="cls_004">Install the demonstration Angular application developed by Alfresco</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 262 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:187252px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background278.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">7</span></div>
<div style="position:absolute;left:112.84px;top:167.48px" class="cls_011"><span class="cls_011">Exposing Content through a</span></div>
<div style="position:absolute;left:84.61px;top:203.48px" class="cls_011"><span class="cls_011">RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:262.47px" class="cls_004"><span class="cls_004">There are many ways to interact with the repository programmatically, one of which is via</span></div>
<div style="position:absolute;left:56.69px;top:275.07px" class="cls_004"><span class="cls_004">web scripts. Then why devote an entire chapter to the Web Script Framework? Web scripts</span></div>
<div style="position:absolute;left:56.69px;top:287.67px" class="cls_004"><span class="cls_004">allow you to define a REST API for the content in the Alfresco repository. REST stands for</span></div>
<div style="position:absolute;left:56.69px;top:300.27px" class="cls_004"><span class="cls_004">Representational State Transfer. In a nutshell, REST describes an architectural style of</span></div>
<div style="position:absolute;left:56.69px;top:312.87px" class="cls_004"><span class="cls_004">interaction based on simple URL-based requests and responses occurring over HTTP.</span></div>
<div style="position:absolute;left:56.69px;top:325.47px" class="cls_004"><span class="cls_004">Rolling your own RESTful API offers a huge advantage in terms of flexibility and</span></div>
<div style="position:absolute;left:56.69px;top:338.07px" class="cls_004"><span class="cls_004">implementation speed over other forms of web service, such as SOAP. Web scripts have</span></div>
<div style="position:absolute;left:56.69px;top:350.67px" class="cls_004"><span class="cls_004">quickly become the preferred integration method between the frontend and an Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:363.27px" class="cls_004"><span class="cls_004">backend, particularly for portals and dynamic websites.</span></div>
<div style="position:absolute;left:56.69px;top:384.87px" class="cls_004"><span class="cls_004">Specifically, in this chapter you will learn how to do the following:</span></div>
<div style="position:absolute;left:104.69px;top:406.60px" class="cls_004"><span class="cls_004">Write web scripts that create, read, and delete data in the backend repository and</span></div>
<div style="position:absolute;left:104.69px;top:419.20px" class="cls_004"><span class="cls_004">return responses in HTML, XML, and JSON</span></div>
<div style="position:absolute;left:104.69px;top:433.96px" class="cls_004"><span class="cls_004">Use both JavaScript and Java to write controller logic</span></div>
<div style="position:absolute;left:104.69px;top:448.72px" class="cls_004"><span class="cls_004">Make </span><span class="cls_007">Asynchronous JavaScript</span><span class="cls_004"> (</span><span class="cls_007">AJAX</span><span class="cls_004">) calls to web scripts</span></div>
<div style="position:absolute;left:104.69px;top:463.52px" class="cls_004"><span class="cls_004">Create a rating service that centralizes all logic related to creating rating nodes</span></div>
<div style="position:absolute;left:56.69px;top:504.55px" class="cls_008"><span class="cls_008">Introducing the Web Script Framework</span></div>
<div style="position:absolute;left:56.69px;top:532.28px" class="cls_004"><span class="cls_004">Content-centric applications are becoming more and more componentized. This trend is</span></div>
<div style="position:absolute;left:56.69px;top:544.89px" class="cls_004"><span class="cls_004">turning traditional content management approaches inside out. Rather than having a single,</span></div>
<div style="position:absolute;left:56.69px;top:557.48px" class="cls_004"><span class="cls_004">monolithic system responsible for all aspects of a content-centric web application, loosely</span></div>
<div style="position:absolute;left:56.69px;top:570.09px" class="cls_004"><span class="cls_004">coupled subsystems are being integrated to create more agile solutions.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:187928px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background279.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">This approach requires that your </span><span class="cls_007">Content Management System</span><span class="cls_004"> (</span><span class="cls_007">CMS</span><span class="cls_004">) has a flexible and</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">lightweight interface. You don't want to be locked in to a presentation approach based on</span></div>
<div style="position:absolute;left:56.69px;top:95.74px" class="cls_004"><span class="cls_004">the content repository you are working with. In fact, in some cases, you might have very</span></div>
<div style="position:absolute;left:56.69px;top:108.34px" class="cls_004"><span class="cls_004">little control over the tools that will be used to talk to your CMS.</span></div>
<div style="position:absolute;left:56.69px;top:129.94px" class="cls_004"><span class="cls_004">Consider the growing adoption of wikis and blogs within an Enterprise and the increasing</span></div>
<div style="position:absolute;left:56.69px;top:142.54px" class="cls_004"><span class="cls_004">popularity of mash-ups both inside and outside the Enterprise. These trends are driving</span></div>
<div style="position:absolute;left:56.69px;top:155.14px" class="cls_004"><span class="cls_004">implementations where the CMS is seen as a black-box component with the frontend (or</span></div>
<div style="position:absolute;left:56.69px;top:167.74px" class="cls_004"><span class="cls_004">perhaps many different frontends) interacting with the CMS and other components via</span></div>
<div style="position:absolute;left:56.69px;top:180.34px" class="cls_004"><span class="cls_004">REST. The shorthand way to refer to this is </span><span class="cls_007">content-as-a-service</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:201.98px" class="cls_004"><span class="cls_004">Among open source ECMs, Alfresco is at the forefront of this trend, and the Web Script</span></div>
<div style="position:absolute;left:56.69px;top:214.58px" class="cls_004"><span class="cls_004">Framework is a key enabler of the product in the content-as-a-service world. Historically,</span></div>
<div style="position:absolute;left:56.69px;top:227.18px" class="cls_004"><span class="cls_004">there have been two approaches to interacting with Alfresco through services: SOAP-based</span></div>
<div style="position:absolute;left:56.69px;top:239.78px" class="cls_004"><span class="cls_004">web services and do-it-yourself REST. The SOAP approach is almost dead, but the</span></div>
<div style="position:absolute;left:56.69px;top:252.38px" class="cls_004"><span class="cls_004">implementation of your own RESTful API using Web Script is one of the preferred way to</span></div>
<div style="position:absolute;left:56.69px;top:264.98px" class="cls_004"><span class="cls_004">implement a content-as-a-service approach with Alfresco. The other approach is to use the</span></div>
<div style="position:absolute;left:56.69px;top:277.58px" class="cls_004"><span class="cls_004">CMIS API.</span></div>
<div style="position:absolute;left:56.69px;top:299.18px" class="cls_004"><span class="cls_004">The Web Script Framework introduced in the 2.1 version essentially improves on the basic</span></div>
<div style="position:absolute;left:56.69px;top:311.78px" class="cls_004"><span class="cls_004">idea that started with URL addressability. Think of a web script as a chunk of code that is</span></div>
<div style="position:absolute;left:56.69px;top:324.38px" class="cls_004"><span class="cls_004">mapped to a human-readable URL. So, for example, a URL that returns expense reports that</span></div>
<div style="position:absolute;left:56.69px;top:336.98px" class="cls_004"><span class="cls_004">are pending approval might look like this:</span></div>
<div style="position:absolute;left:74.69px;top:357.90px" class="cls_010"><span class="cls_010">/alfresco/service/expenses/pending</span></div>
<div style="position:absolute;left:56.69px;top:378.38px" class="cls_004"><span class="cls_004">While a URL that returns expenses that are pending approval for a specific user might look</span></div>
<div style="position:absolute;left:56.69px;top:390.98px" class="cls_004"><span class="cls_004">like this:</span></div>
<div style="position:absolute;left:74.69px;top:411.90px" class="cls_010"><span class="cls_010">/alfresco/service/expenses/pending/ben</span></div>
<div style="position:absolute;left:56.69px;top:432.38px" class="cls_004"><span class="cls_004">In this URL, you could read the </span><span class="cls_013">ben</span><span class="cls_004"> component of the URL as an implied argument. A</span></div>
<div style="position:absolute;left:56.69px;top:445.66px" class="cls_004"><span class="cls_004">more explicit way to provide an argument would be like this:</span></div>
<div style="position:absolute;left:74.69px;top:466.58px" class="cls_010"><span class="cls_010">/alfresco/service/expenses/pending?user=ben</span></div>
<div style="position:absolute;left:56.69px;top:487.06px" class="cls_004"><span class="cls_004">You might choose to treat the </span><span class="cls_013">pending</span><span class="cls_004"> component of the URL as an argument as well,</span></div>
<div style="position:absolute;left:56.69px;top:500.34px" class="cls_004"><span class="cls_004">which tells the web script what status of expense reports to return. The point is that the</span></div>
<div style="position:absolute;left:56.69px;top:512.94px" class="cls_004"><span class="cls_004">Web Script Framework leaves the structure of the URL and how (and if) your URL includes</span></div>
<div style="position:absolute;left:56.69px;top:525.54px" class="cls_004"><span class="cls_004">arguments completely up to you.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 264 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:188604px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background280.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - Hello World web script</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Despite the fact that your </span><span class="cls_013">repo</span><span class="cls_004"> module already contains a basic web script, we are going to</span></div>
<div style="position:absolute;left:56.69px;top:108.26px" class="cls_004"><span class="cls_004">create a new one from scratch. Let's implement the most basic web script possible: a</span></div>
<div style="position:absolute;left:56.69px;top:120.86px" class="cls_013"><span class="cls_013">HelloWorld</span><span class="cls_004"> script that echoes back an argument. You'll need one descriptor and one</span></div>
<div style="position:absolute;left:56.69px;top:134.14px" class="cls_004"><span class="cls_004">FreeMarker template. Do the following:</span></div>
<div style="position:absolute;left:91.32px;top:155.87px" class="cls_004"><span class="cls_004">1. Log in to Alfresco Share.</span></div>
<div style="position:absolute;left:91.32px;top:170.63px" class="cls_004"><span class="cls_004">2. Click on </span><span class="cls_007">Repository</span><span class="cls_004"> in the top menu.</span></div>
<div style="position:absolute;left:91.32px;top:185.43px" class="cls_004"><span class="cls_004">3. Navigate to </span><span class="cls_007">Repository</span><span class="cls_004"> | </span><span class="cls_007">Data Dictionary</span><span class="cls_004"> | </span><span class="cls_007">Web Scripts</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:200.23px" class="cls_004"><span class="cls_004">4. Create an XML file called </span><span class="cls_013">helloworld.get.desc.xml</span><span class="cls_004"> in the </span><span class="cls_013">Web Scripts</span></div>
<div style="position:absolute;left:104.69px;top:213.51px" class="cls_013"><span class="cls_013">Extensions</span><span class="cls_004"> folder with the following content:</span></div>
<div style="position:absolute;left:117.89px;top:237.40px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:161.09px;top:248.20px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Hello World&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:161.09px;top:259.00px" class="cls_010"><span class="cls_010">&lt;description&gt;Hello world web script&lt;/description&gt;</span></div>
<div style="position:absolute;left:161.09px;top:269.80px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/helloworld?name={nameArgument}&lt;/url&gt;</span></div>
<div style="position:absolute;left:117.89px;top:280.60px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:91.32px;top:301.20px" class="cls_004"><span class="cls_004">5. Create a plain text file called </span><span class="cls_013">helloworld.get.html.ftl</span><span class="cls_004"> with the following</span></div>
<div style="position:absolute;left:104.69px;top:314.48px" class="cls_004"><span class="cls_004">content:</span></div>
<div style="position:absolute;left:117.89px;top:337.70px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:139.49px;top:348.49px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:161.09px;top:359.30px" class="cls_010"><span class="cls_010">&lt;p&gt;Hello, ${args.name}!&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:370.10px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:380.89px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:401.51px" class="cls_004"><span class="cls_004">6. Go to </span><a href="http://localhost:8080/alfresco/service/index/">http://localhost:8080/alfresco/service/index</a> <span class="cls_004"> and press the</span></div>
<div style="position:absolute;left:104.69px;top:414.78px" class="cls_007"><span class="cls_007">Refresh Web Scripts</span><span class="cls_004"> button. You may be prompted to login. Click the </span><span class="cls_007">List Web</span></div>
<div style="position:absolute;left:104.69px;top:427.42px" class="cls_007"><span class="cls_007">Scripts</span><span class="cls_004"> link-you should be able to find the web script you just defined.</span></div>
<div style="position:absolute;left:91.32px;top:442.22px" class="cls_004"><span class="cls_004">7. Now point your browser to</span></div>
<div style="position:absolute;left:104.69px;top:454.04px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/helloworld?name=b/">http://localhost:8080/alfresco/service/someco/helloworld?name=B</a> </div>
<div style="position:absolute;left:104.69px;top:466.82px" class="cls_013"><span class="cls_013">en</span><span class="cls_004">. You should see this:</span></div>
<div style="position:absolute;left:139.49px;top:490.71px" class="cls_010"><span class="cls_010">Hello, Ben!</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 265 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:189280px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background281.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:122.09px;top:70.50px" class="cls_004"><span class="cls_004">You can notice that you have as well a folder called </span><span class="cls_013">Web Scripts</span></div>
<div style="position:absolute;left:122.09px;top:83.78px" class="cls_013"><span class="cls_013">Extensions</span><span class="cls_004"> in the </span><span class="cls_013">Data Dictionary</span><span class="cls_004"> folder. The Web Scripts folder is</span></div>
<div style="position:absolute;left:122.09px;top:97.06px" class="cls_004"><span class="cls_004">considered to store brand new web scripts, especially if you want to give a</span></div>
<div style="position:absolute;left:122.09px;top:109.66px" class="cls_004"><span class="cls_004">chance to extend it in the future. While the </span><span class="cls_013">Web Scripts Extensions</span></div>
<div style="position:absolute;left:122.09px;top:122.94px" class="cls_004"><span class="cls_004">folder is used when you want to override a web script provided by</span></div>
<div style="position:absolute;left:122.09px;top:135.54px" class="cls_004"><span class="cls_004">Alfresco or another add-on. But nothing forbids you to store your brand</span></div>
<div style="position:absolute;left:122.09px;top:148.14px" class="cls_004"><span class="cls_004">new web scripts in the folder Web Scripts Extensions. What you need to</span></div>
<div style="position:absolute;left:122.09px;top:160.74px" class="cls_004"><span class="cls_004">understand is the priority order used by Alfresco. The Web Scripts</span></div>
<div style="position:absolute;left:122.09px;top:173.34px" class="cls_004"><span class="cls_004">Extensions folder will override the files in the Web Scripts folder, that will</span></div>
<div style="position:absolute;left:122.09px;top:185.94px" class="cls_004"><span class="cls_004">override the file in the extension folder in the classpath, that will override</span></div>
<div style="position:absolute;left:122.09px;top:198.54px" class="cls_004"><span class="cls_004">the file in the main Alfresco classpath. You can have more information on</span></div>
<div style="position:absolute;left:122.09px;top:211.14px" class="cls_004"><span class="cls_004">this page</span></div>
<div style="position:absolute;left:122.09px;top:223.74px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/ws-component-place.html">http://docs.alfresco.com/5.1/concepts/ws-component-place.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:260.82px" class="cls_014"><span class="cls_014">What just happened?</span></div>
<div style="position:absolute;left:56.69px;top:286.04px" class="cls_004"><span class="cls_004">You invoked a URL in your web browser (specifically, you made a GET request over</span></div>
<div style="position:absolute;left:56.69px;top:298.64px" class="cls_004"><span class="cls_004">HTTP). The Alfresco web application is configured to map all requests matching the pattern</span></div>
<div style="position:absolute;left:56.69px;top:311.24px" class="cls_013"><span class="cls_013">/alfresco/service/*</span><span class="cls_004"> to the web script request dispatcher servlet. The servlet handed off</span></div>
<div style="position:absolute;left:56.69px;top:324.52px" class="cls_004"><span class="cls_004">the request to the Web Script Runtime to process the web script. The Web Script Runtime</span></div>
<div style="position:absolute;left:56.69px;top:337.12px" class="cls_004"><span class="cls_004">figured out which web script to execute by matching the remainder of the URL</span></div>
<div style="position:absolute;left:56.69px;top:349.72px" class="cls_004"><span class="cls_004">(</span><span class="cls_013">someco/helloworld?name=Ben</span><span class="cls_004">) to the URL pattern you declared in the web script's</span></div>
<div style="position:absolute;left:56.69px;top:363.00px" class="cls_004"><span class="cls_004">descriptor file, </span><span class="cls_013">helloworld.get.desc.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:385.28px" class="cls_004"><span class="cls_004">You didn't specify what kind of response you wanted from the web script, and the web</span></div>
<div style="position:absolute;left:56.69px;top:397.88px" class="cls_004"><span class="cls_004">script descriptor didn't declare a default, so the framework assumed HTML would be</span></div>
<div style="position:absolute;left:56.69px;top:410.48px" class="cls_004"><span class="cls_004">acceptable. It then used file naming convention to find a FreeMarker template to generate</span></div>
<div style="position:absolute;left:56.69px;top:423.08px" class="cls_004"><span class="cls_004">an HTML response for this web script. The FreeMarker template formatted a response to</span></div>
<div style="position:absolute;left:56.69px;top:435.68px" class="cls_004"><span class="cls_004">send back to the browser that included some HTML and the value of the name argument.</span></div>
<div style="position:absolute;left:56.69px;top:472.38px" class="cls_014"><span class="cls_014">Following the Model-View-Controller pattern</span></div>
<div style="position:absolute;left:56.69px;top:497.60px" class="cls_004"><span class="cls_004">The Web Script Framework makes it easy to follow the </span><span class="cls_007">Model</span><span class="cls_022">-</span><span class="cls_007">View</span><span class="cls_022">-</span><span class="cls_007">Controller</span><span class="cls_004"> (</span><span class="cls_007">MVC</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:511.03px" class="cls_004"><span class="cls_004">pattern. You don't have to be a hardcore disciple of the Gang of Four to appreciate the value</span></div>
<div style="position:absolute;left:56.69px;top:523.63px" class="cls_004"><span class="cls_004">of the MVC pattern. In MVC, all business logic resides in the controller. It is completely</span></div>
<div style="position:absolute;left:56.69px;top:536.23px" class="cls_004"><span class="cls_004">separated from the presentation or view. This makes it possible to have as many views as</span></div>
<div style="position:absolute;left:56.69px;top:548.83px" class="cls_004"><span class="cls_004">you need without a big maintenance headache because the business logic isn't bundled</span></div>
<div style="position:absolute;left:56.69px;top:561.43px" class="cls_004"><span class="cls_004">together with the view. It is centralized in the controller. There is a clear separation of</span></div>
<div style="position:absolute;left:56.69px;top:574.03px" class="cls_004"><span class="cls_004">concerns.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 266 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:189956px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background282.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">In Alfresco's Web Script Framework, the controller is server-side JavaScript, a Java Bean, or</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">both. The controller handles the request, performs any business logic that is needed,</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">populates the model with data, and then forwards the request to the view. The view is one</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">or more FreeMarker templates responsible for constructing a response in the appropriate</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">format. The model is essentially a data structure passed between the controller and the</span></div>
<div style="position:absolute;left:56.69px;top:133.50px" class="cls_004"><span class="cls_004">view.</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">The mapping of URL to controller is done through an XML descriptor that is responsible for</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">declaring the URL pattern, whether the script requires a transaction or not, and the</span></div>
<div style="position:absolute;left:56.69px;top:180.30px" class="cls_004"><span class="cls_004">authentication requirements for the script. The descriptor optionally describes arguments</span></div>
<div style="position:absolute;left:56.69px;top:192.90px" class="cls_004"><span class="cls_004">that can be passed to the script, as well as the response formats that are available.</span></div>
<div style="position:absolute;left:56.69px;top:229.60px" class="cls_014"><span class="cls_014">Adding controller logic</span></div>
<div style="position:absolute;left:56.69px;top:254.82px" class="cls_004"><span class="cls_004">The Hello World example consisted of one FreeMarker template and one descriptor XML</span></div>
<div style="position:absolute;left:56.69px;top:267.42px" class="cls_004"><span class="cls_004">file. The FreeMarker API is quite extensive, and many out-of-the-box examples rely solely</span></div>
<div style="position:absolute;left:56.69px;top:280.02px" class="cls_004"><span class="cls_004">on FreeMarker for light logic processing as well as rendering a response. Ideally, however,</span></div>
<div style="position:absolute;left:56.69px;top:292.62px" class="cls_004"><span class="cls_004">FreeMarker templates should be strictly focused on presentation. Logic, such as querying</span></div>
<div style="position:absolute;left:56.69px;top:305.22px" class="cls_004"><span class="cls_004">the repository, creating or updating content, executing actions, and so on, should be</span></div>
<div style="position:absolute;left:56.69px;top:317.82px" class="cls_004"><span class="cls_004">handled in the JavaScript or Java-based controller.</span></div>
<div style="position:absolute;left:56.69px;top:339.42px" class="cls_004"><span class="cls_004">Try adding a simple controller to the Hello World example:</span></div>
<div style="position:absolute;left:91.32px;top:361.15px" class="cls_004"><span class="cls_004">1. You should still be logged in to Alfresco Share.</span></div>
<div style="position:absolute;left:91.32px;top:375.91px" class="cls_004"><span class="cls_004">2. Create a plain text file in </span><span class="cls_007">Repository</span><span class="cls_004"> | </span><span class="cls_007">DataDictionary</span><span class="cls_004"> | </span><span class="cls_007">Web Scripts</span><span class="cls_004"> called</span></div>
<div style="position:absolute;left:104.69px;top:388.55px" class="cls_013"><span class="cls_013">helloworld.get.js</span><span class="cls_004"> with the following content:</span></div>
<div style="position:absolute;left:117.89px;top:412.44px" class="cls_010"><span class="cls_010">model.now = new Date();</span></div>
<div style="position:absolute;left:91.32px;top:433.05px" class="cls_004"><span class="cls_004">3. Update your </span><span class="cls_013">helloworld.get.html.ftl</span><span class="cls_004"> file with the following content:</span></div>
<div style="position:absolute;left:117.89px;top:456.94px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:139.49px;top:467.74px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:161.09px;top:478.54px" class="cls_010"><span class="cls_010">&lt;p&gt;Hello, ${args.name}!&lt;/p&gt;</span></div>
<div style="position:absolute;left:161.09px;top:489.34px" class="cls_010"><span class="cls_010">&lt;p&gt;&lt;i&gt;${now?datetime?string}&lt;/i&gt;&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:500.14px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:510.94px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:531.55px" class="cls_004"><span class="cls_004">4. Go to </span><a href="http://localhost:8080/alfresco/service/index/">http://localhost:8080/alfresco/service/index</a> <span class="cls_004"> and press the</span></div>
<div style="position:absolute;left:104.69px;top:544.83px" class="cls_007"><span class="cls_007">Refresh Web Scripts</span><span class="cls_004"> button. This is required because you added a controller that</span></div>
<div style="position:absolute;left:104.69px;top:557.47px" class="cls_004"><span class="cls_004">the web script runtime didn't know about.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 267 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:190632px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background283.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Now go to your web browser and enter the same URL from the first example,</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">which was</span></div>
<div style="position:absolute;left:104.69px;top:94.92px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/helloworld?name=b/">http://localhost:8080/alfresco/service/someco/helloworld?name=B</a> </div>
<div style="position:absolute;left:104.69px;top:107.70px" class="cls_013"><span class="cls_013">en</span><span class="cls_004">. You should see this:</span></div>
<div style="position:absolute;left:96.29px;top:131.59px" class="cls_010"><span class="cls_010">Hello, Ben!</span></div>
<div style="position:absolute;left:96.29px;top:142.39px" class="cls_010"><span class="cls_010">Jan 15, 2017 4:06:05 PM</span></div>
<div style="position:absolute;left:56.69px;top:162.87px" class="cls_004"><span class="cls_004">What's going on here is that the web script framework is executing the controller prior to</span></div>
<div style="position:absolute;left:56.69px;top:175.47px" class="cls_004"><span class="cls_004">rendering a response with the FreeMarker template. In the controller, you can do anything</span></div>
<div style="position:absolute;left:56.69px;top:188.07px" class="cls_004"><span class="cls_004">the Alfresco JavaScript API can do. In this case, you didn't leverage the JavaScript API at all.</span></div>
<div style="position:absolute;left:56.69px;top:200.67px" class="cls_004"><span class="cls_004">You just put some data into the model object. The model variable is a root variable Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:213.27px" class="cls_004"><span class="cls_004">makes available to you to enable data sharing between the controller (JavaScript) and the</span></div>
<div style="position:absolute;left:56.69px;top:225.87px" class="cls_004"><span class="cls_004">view (FreeMarker).</span></div>
<div style="position:absolute;left:56.69px;top:247.47px" class="cls_004"><span class="cls_004">In subsequent examples, the controller will have more work to do, and in one case, you'll</span></div>
<div style="position:absolute;left:56.69px;top:260.07px" class="cls_004"><span class="cls_004">use Java instead of JavaScript for the controller.</span></div>
<div style="position:absolute;left:56.69px;top:296.77px" class="cls_014"><span class="cls_014">Configuring the Web Script Framework</span></div>
<div style="position:absolute;left:56.69px;top:321.99px" class="cls_004"><span class="cls_004">The three most important settings for any web script are as follows:</span></div>
<div style="position:absolute;left:104.69px;top:343.72px" class="cls_004"><span class="cls_004">The HTTP method used to make the request to the web script</span></div>
<div style="position:absolute;left:104.69px;top:358.48px" class="cls_004"><span class="cls_004">The URL and any arguments the web script expects</span></div>
<div style="position:absolute;left:104.69px;top:373.24px" class="cls_004"><span class="cls_004">The response formats the web script supports</span></div>
<div style="position:absolute;left:56.69px;top:397.13px" class="cls_004"><span class="cls_004">The web script framework defines conventions that make it easy to configure these settings.</span></div>
<div style="position:absolute;left:56.69px;top:431.78px" class="cls_023"><span class="cls_023">Specifying the HTTP method</span></div>
<div style="position:absolute;left:56.69px;top:454.49px" class="cls_004"><span class="cls_004">In the </span><span class="cls_013">Hello World</span><span class="cls_004"> example, notice that the file names for the descriptor and the</span></div>
<div style="position:absolute;left:56.69px;top:467.77px" class="cls_004"><span class="cls_004">FreeMarker template include </span><span class="cls_013">get</span><span class="cls_004">. It tells the framework that when someone invokes the</span></div>
<div style="position:absolute;left:56.69px;top:481.05px" class="cls_004"><span class="cls_004">web script with a </span><span class="cls_013">GET</span><span class="cls_004">, those descriptors and FreeMarker files are applied. By differentiating</span></div>
<div style="position:absolute;left:56.69px;top:494.33px" class="cls_004"><span class="cls_004">the HTTP method (such as </span><span class="cls_013">GET</span><span class="cls_004">, </span><span class="cls_013">POST</span><span class="cls_004">, </span><span class="cls_013">DELETE</span><span class="cls_004">, and </span><span class="cls_013">PUT</span><span class="cls_004">), you can define multiple web</span></div>
<div style="position:absolute;left:56.69px;top:507.61px" class="cls_004"><span class="cls_004">scripts that get invoked depending on the method used to make the request.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 268 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:191308px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background284.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Use the following to determine which HTTP method is appropriate for your web script:</span></div>
<div style="position:absolute;left:104.69px;top:92.23px" class="cls_013"><span class="cls_013">GET</span><span class="cls_004">: Retrieves the representation of a resource or a list of resources. The URI</span></div>
<div style="position:absolute;left:104.69px;top:105.51px" class="cls_004"><span class="cls_004">should return the same resource no matter how many times it is called. Calling</span></div>
<div style="position:absolute;left:104.69px;top:118.11px" class="cls_004"><span class="cls_004">this URI should have no effect on the repository. A </span><span class="cls_013">GET</span><span class="cls_004"> usually doesn't require a</span></div>
<div style="position:absolute;left:104.69px;top:131.39px" class="cls_004"><span class="cls_004">transaction.</span></div>
<div style="position:absolute;left:104.69px;top:146.15px" class="cls_013"><span class="cls_013">POST</span><span class="cls_004">: Creates a new resource. The server decides on that resource's URI.</span></div>
<div style="position:absolute;left:104.69px;top:161.59px" class="cls_013"><span class="cls_013">PUT</span><span class="cls_004">: Creates a new resource. But the client decides on the URI or updates an</span></div>
<div style="position:absolute;left:104.69px;top:174.87px" class="cls_004"><span class="cls_004">existing resource. Like a </span><span class="cls_013">GET</span><span class="cls_004">, the URI should update the same resource no matter</span></div>
<div style="position:absolute;left:104.69px;top:188.15px" class="cls_004"><span class="cls_004">how many times it is called.</span></div>
<div style="position:absolute;left:104.69px;top:202.91px" class="cls_013"><span class="cls_013">DELETE</span><span class="cls_004">: Deletes a resource, or stops a resource from being accessible.</span></div>
<div style="position:absolute;left:56.69px;top:240.52px" class="cls_023"><span class="cls_023">Specifying arguments</span></div>
<div style="position:absolute;left:56.69px;top:263.24px" class="cls_004"><span class="cls_004">Arguments are declared as part of the </span><span class="cls_013">url</span><span class="cls_004"> element in the web script's descriptor XML.</span></div>
<div style="position:absolute;left:56.69px;top:276.52px" class="cls_004"><span class="cls_004">There are two styles of arguments supported. The Hello World example used explicit</span></div>
<div style="position:absolute;left:56.69px;top:289.12px" class="cls_004"><span class="cls_004">arguments-argument names and placeholders appear in the URL as part of the query string:</span></div>
<div style="position:absolute;left:74.69px;top:310.04px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/helloworld?name={nameArgument}&lt;/url&gt;</span></div>
<div style="position:absolute;left:56.69px;top:330.52px" class="cls_004"><span class="cls_004">The other style is to use implicit arguments in which the arguments are incorporated into</span></div>
<div style="position:absolute;left:56.69px;top:343.12px" class="cls_004"><span class="cls_004">components of the path:</span></div>
<div style="position:absolute;left:74.69px;top:364.04px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/helloworld/{nameArgument}&lt;/url&gt;</span></div>
<div style="position:absolute;left:56.69px;top:384.52px" class="cls_004"><span class="cls_004">The Hello World example only had one argument, but you could add as many as you need.</span></div>
<div style="position:absolute;left:56.69px;top:397.12px" class="cls_004"><span class="cls_004">Using the explicit style, each argument is separated with an ampersand. Make sure you</span></div>
<div style="position:absolute;left:56.69px;top:409.72px" class="cls_004"><span class="cls_004">escape ampersands in a URL. Web script descriptors must always be valid XML:</span></div>
<div style="position:absolute;left:74.69px;top:430.64px" class="cls_010"><span class="cls_010">&lt;url&gt;/helloworld?name={nameArgument}&amp;secondArg={anotherArg}&lt;/url&gt;</span></div>
<div style="position:absolute;left:56.69px;top:451.12px" class="cls_004"><span class="cls_004">How you choose to structure your URLs is a matter of preference, consistency, and,</span></div>
<div style="position:absolute;left:56.69px;top:463.72px" class="cls_004"><span class="cls_004">potentially, search engine friendliness (some search engines may have trouble indexing</span></div>
<div style="position:absolute;left:56.69px;top:476.32px" class="cls_004"><span class="cls_004">URLs that include a query string).</span></div>
<div style="position:absolute;left:56.69px;top:510.97px" class="cls_023"><span class="cls_023">Specifying the response format</span></div>
<div style="position:absolute;left:56.69px;top:533.68px" class="cls_004"><span class="cls_004">The response formats are mapped to FreeMarker templates through naming conventions. In</span></div>
<div style="position:absolute;left:56.69px;top:546.28px" class="cls_004"><span class="cls_004">the Hello World example, the FreeMarker template was named</span></div>
<div style="position:absolute;left:56.69px;top:558.88px" class="cls_013"><span class="cls_013">helloworld.get.html.ftl</span><span class="cls_004">. So, Alfresco interprets that to mean </span><span class="cls_022">“</span><span class="cls_004">This is the template to</span></div>
<div style="position:absolute;left:56.69px;top:572.31px" class="cls_004"><span class="cls_004">use when someone asks for an HTML response for this web script.</span><span class="cls_022">”</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 269 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:191984px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background285.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">One of the benefits of the MVC pattern is that you can have one set of controller logic with</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">as many different views as you need because the controller logic and view logic are cleanly</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">separated. For example, you could create a second FreeMarker template for the Hello World</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">example named </span><span class="cls_013">helloworld.get.xml.ftl</span><span class="cls_004"> that looks like this:</span></div>
<div style="position:absolute;left:74.69px;top:129.90px" class="cls_010"><span class="cls_010">&lt;helloworld&gt;</span></div>
<div style="position:absolute;left:96.29px;top:140.70px" class="cls_010"><span class="cls_010">&lt;message&gt;Hello, ${args.name}!&lt;/message&gt;</span></div>
<div style="position:absolute;left:96.29px;top:151.50px" class="cls_010"><span class="cls_010">&lt;foo&gt;${foo}&lt;/foo&gt;</span></div>
<div style="position:absolute;left:74.69px;top:162.30px" class="cls_010"><span class="cls_010">&lt;/helloworld&gt;</span></div>
<div style="position:absolute;left:56.69px;top:182.78px" class="cls_004"><span class="cls_004">The response format can be specified via URL as an extension on the script ID, like this:</span></div>
<div style="position:absolute;left:56.69px;top:203.60px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/helloworld.xml?name=ben/">http://localhost:8080/alfresco/service/someco/helloworld.xml?name=Ben</a> </div>
<div style="position:absolute;left:56.69px;top:225.38px" class="cls_004"><span class="cls_004">It could also be specified with an explicit </span><span class="cls_013">format</span><span class="cls_004"> argument:</span></div>
<div style="position:absolute;left:56.69px;top:246.88px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/helloworld?name=ben&amp;forma/">http://localhost:8080/alfresco/service/someco/helloworld?name=Ben&amp;forma</a> </div>
<div style="position:absolute;left:56.69px;top:258.88px" class="cls_013"><span class="cls_013">t=xml</span></div>
<div style="position:absolute;left:56.69px;top:280.66px" class="cls_004"><span class="cls_004">If a format is not specified, the default format will be returned. The default response format</span></div>
<div style="position:absolute;left:56.69px;top:293.26px" class="cls_004"><span class="cls_004">can be specified as part of the descriptor:</span></div>
<div style="position:absolute;left:74.69px;top:314.18px" class="cls_010"><span class="cls_010">&lt;format default="xml"&gt;any&lt;/format&gt;</span></div>
<div style="position:absolute;left:56.69px;top:334.66px" class="cls_004"><span class="cls_004">The content of the </span><span class="cls_013">format</span><span class="cls_004"> element specifies the style in which the script expects the format</span></div>
<div style="position:absolute;left:56.69px;top:347.94px" class="cls_004"><span class="cls_004">to be provided. In the example, </span><span class="cls_013">any</span><span class="cls_004"> specifies that either option is accepted. So it can be sent</span></div>
<div style="position:absolute;left:56.69px;top:361.22px" class="cls_004"><span class="cls_004">as extension (as used in the first example when you typed </span><span class="cls_013">helloworld.xml</span><span class="cls_004">) or as an</span></div>
<div style="position:absolute;left:56.69px;top:374.50px" class="cls_004"><span class="cls_004">argument (as used in the second example when you typed </span><span class="cls_013">?format=xml</span><span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:396.78px" class="cls_004"><span class="cls_004">If no default format is specified in the descriptor, Alfresco assumes a default of HTML.</span></div>
<div style="position:absolute;left:56.69px;top:433.48px" class="cls_014"><span class="cls_014">Deploying web scripts</span></div>
<div style="position:absolute;left:56.69px;top:458.70px" class="cls_004"><span class="cls_004">The descriptor, the JavaScript file, and the FreeMarker templates together make up the web</span></div>
<div style="position:absolute;left:56.69px;top:471.30px" class="cls_004"><span class="cls_004">script. These files can reside either in the repository or on the classpath. If a web script uses</span></div>
<div style="position:absolute;left:56.69px;top:483.90px" class="cls_004"><span class="cls_004">a Java Bean, the class must reside somewhere on the classpath. You can find in the</span></div>
<div style="position:absolute;left:56.69px;top:496.50px" class="cls_004"><span class="cls_004">following page all locations where a web script can be stored:</span></div>
<div style="position:absolute;left:56.69px;top:517.42px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/ws-component-place.html">http://docs.alfresco.com/5.1/concepts/ws-component-place.html</a> </div>
<div style="position:absolute;left:56.69px;top:537.90px" class="cls_004"><span class="cls_004">Regardless of where they are deployed, updates can be picked up without an application</span></div>
<div style="position:absolute;left:56.69px;top:550.50px" class="cls_004"><span class="cls_004">server restart. After deploying a new or updated script, go to</span></div>
<div style="position:absolute;left:56.69px;top:563.10px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/index/">http://localhost:8080/alfresco/service/index</a> <span class="cls_004"> and click on the </span><span class="cls_007">Refresh</span></div>
<div style="position:absolute;left:56.69px;top:576.38px" class="cls_007"><span class="cls_007">WebScripts</span><span class="cls_004"> button.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 270 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:192660px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background286.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Building solutions with the Web Script</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">Framework</span></div>
<div style="position:absolute;left:56.69px;top:116.58px" class="cls_004"><span class="cls_004">Now that you understand the basics, you may already be thinking of different ways you</span></div>
<div style="position:absolute;left:56.69px;top:129.18px" class="cls_004"><span class="cls_004">could leverage web scripts to build your own solutions. For example, you can use web</span></div>
<div style="position:absolute;left:56.69px;top:141.78px" class="cls_004"><span class="cls_004">scripts to achieve the following:</span></div>
<div style="position:absolute;left:104.69px;top:163.51px" class="cls_004"><span class="cls_004">Enable a frontend web application written in any language that understands</span></div>
<div style="position:absolute;left:104.69px;top:176.11px" class="cls_004"><span class="cls_004">HTTP to retrieve repository data in XML, JSON, or any other format</span></div>
<div style="position:absolute;left:104.69px;top:190.87px" class="cls_004"><span class="cls_004">Capture and persist user-contributed content/data</span></div>
<div style="position:absolute;left:104.69px;top:205.63px" class="cls_004"><span class="cls_004">Interact with a business process (for example, an Activiti workflow) through non-</span></div>
<div style="position:absolute;left:104.69px;top:218.23px" class="cls_004"><span class="cls_004">web client interfaces such as e-mail</span></div>
<div style="position:absolute;left:104.69px;top:232.99px" class="cls_004"><span class="cls_004">Create ATOM or RSS feeds for repository content or business process data</span></div>
<div style="position:absolute;left:56.69px;top:256.88px" class="cls_004"><span class="cls_004">Alfresco Share is integrated to the Alfresco Repository via web scripts. If you look at the list</span></div>
<div style="position:absolute;left:56.69px;top:269.48px" class="cls_004"><span class="cls_004">of modules installed in your Alfresco repository using the Administration console</span></div>
<div style="position:absolute;left:56.69px;top:282.08px" class="cls_004"><span class="cls_004">(</span><a href="http://localhost:8080/alfresco/s/enterprise/admin/admin-systemsummary/">http://localhost:8080/alfresco/s/enterprise/admin/admin-systemsummary</a> <span class="cls_004">),</span></div>
<div style="position:absolute;left:56.69px;top:295.36px" class="cls_004"><span class="cls_004">you can easily see the </span><span class="cls_013">alfresco-share-services</span><span class="cls_004"> module, which contains the web scripts</span></div>
<div style="position:absolute;left:56.69px;top:308.64px" class="cls_004"><span class="cls_004">required by Alfresco Share to run properly (Be aware that this module has been integrated</span></div>
<div style="position:absolute;left:56.69px;top:321.24px" class="cls_004"><span class="cls_004">recently. Before the Alfresco Repository was including all web scripts even if you didn't</span></div>
<div style="position:absolute;left:56.69px;top:333.84px" class="cls_004"><span class="cls_004">want to use Share following a more monolithic approach):</span></div>
<div style="position:absolute;left:56.69px;top:443.36px" class="cls_004"><span class="cls_004">You may recall from prior chapters that SomeCo would like to publish whitepapers on its</span></div>
<div style="position:absolute;left:56.69px;top:455.96px" class="cls_004"><span class="cls_004">website. In addition to making the whitepapers available on the Web, SomeCo wants to</span></div>
<div style="position:absolute;left:56.69px;top:468.56px" class="cls_004"><span class="cls_004">provide a way for website users to rate the whitepapers and display the aggregated ratings</span></div>
<div style="position:absolute;left:56.69px;top:481.16px" class="cls_004"><span class="cls_004">with each whitepaper. Earlier, you created a behavior that calculates the ratings summary.</span></div>
<div style="position:absolute;left:56.69px;top:493.76px" class="cls_004"><span class="cls_004">Now you are going to make whitepapers and ratings available via REST.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 271 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:193336px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background287.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Planning the SomeCo whitepapers and</span></div>
<div style="position:absolute;left:56.69px;top:93.65px" class="cls_008"><span class="cls_008">ratings API</span></div>
<div style="position:absolute;left:56.69px;top:121.38px" class="cls_004"><span class="cls_004">Before diving into the examples, let's plan the new API at a high level. The following table</span></div>
<div style="position:absolute;left:56.69px;top:133.98px" class="cls_004"><span class="cls_004">outlines the URLs, the HTTP methods, and the response formats for each:</span></div>
<div style="position:absolute;left:60.02px;top:158.91px" class="cls_034"><span class="cls_034">URL</span></div>
<div style="position:absolute;left:341.24px;top:158.91px" class="cls_034"><span class="cls_034">Method</span></div>
<div style="position:absolute;left:382.36px;top:158.91px" class="cls_034"><span class="cls_034">Description</span></div>
<div style="position:absolute;left:441.13px;top:158.91px" class="cls_034"><span class="cls_034">Response</span></div>
<div style="position:absolute;left:441.13px;top:169.92px" class="cls_034"><span class="cls_034">formats</span></div>
<div style="position:absolute;left:60.02px;top:186.21px" class="cls_035"><span class="cls_035">/someco/whitepapers</span></div>
<div style="position:absolute;left:341.24px;top:186.93px" class="cls_036"><span class="cls_036">GET</span></div>
<div style="position:absolute;left:382.36px;top:186.93px" class="cls_036"><span class="cls_036">Returns a</span></div>
<div style="position:absolute;left:441.13px;top:186.93px" class="cls_036"><span class="cls_036">HTML,</span></div>
<div style="position:absolute;left:382.36px;top:197.94px" class="cls_036"><span class="cls_036">list of</span></div>
<div style="position:absolute;left:441.13px;top:197.94px" class="cls_036"><span class="cls_036">JSON</span></div>
<div style="position:absolute;left:382.36px;top:208.95px" class="cls_036"><span class="cls_036">whitepapers</span></div>
<div style="position:absolute;left:60.02px;top:225.21px" class="cls_035"><span class="cls_035">/someco/rating?id={id}</span></div>
<div style="position:absolute;left:341.24px;top:225.94px" class="cls_036"><span class="cls_036">GET</span></div>
<div style="position:absolute;left:382.36px;top:225.94px" class="cls_036"><span class="cls_036">Gets the</span></div>
<div style="position:absolute;left:441.13px;top:225.94px" class="cls_036"><span class="cls_036">HTML,</span></div>
<div style="position:absolute;left:382.36px;top:236.95px" class="cls_036"><span class="cls_036">average</span></div>
<div style="position:absolute;left:441.13px;top:236.95px" class="cls_036"><span class="cls_036">JSON</span></div>
<div style="position:absolute;left:382.36px;top:247.96px" class="cls_036"><span class="cls_036">rating for a</span></div>
<div style="position:absolute;left:382.36px;top:258.97px" class="cls_036"><span class="cls_036">given</span></div>
<div style="position:absolute;left:382.36px;top:269.98px" class="cls_036"><span class="cls_036">whitepaper</span></div>
<div style="position:absolute;left:382.36px;top:280.99px" class="cls_036"><span class="cls_036">by passing</span></div>
<div style="position:absolute;left:382.36px;top:292.00px" class="cls_036"><span class="cls_036">in the</span></div>
<div style="position:absolute;left:382.36px;top:303.01px" class="cls_036"><span class="cls_036">whitepaper's</span></div>
<div style="position:absolute;left:382.36px;top:314.02px" class="cls_036"><span class="cls_036">nodeId</span></div>
<div style="position:absolute;left:60.02px;top:330.27px" class="cls_035"><span class="cls_035">/someco/rating?id={id}&amp;rating={rating}&amp;user={user}</span></div>
<div style="position:absolute;left:341.24px;top:331.00px" class="cls_036"><span class="cls_036">POST</span></div>
<div style="position:absolute;left:382.36px;top:331.00px" class="cls_036"><span class="cls_036">Creates a</span></div>
<div style="position:absolute;left:441.13px;top:331.00px" class="cls_036"><span class="cls_036">HTML,</span></div>
<div style="position:absolute;left:382.36px;top:342.01px" class="cls_036"><span class="cls_036">new rating</span></div>
<div style="position:absolute;left:441.13px;top:342.01px" class="cls_036"><span class="cls_036">JSON</span></div>
<div style="position:absolute;left:382.36px;top:353.02px" class="cls_036"><span class="cls_036">for the</span></div>
<div style="position:absolute;left:382.36px;top:364.03px" class="cls_036"><span class="cls_036">specified</span></div>
<div style="position:absolute;left:382.36px;top:375.04px" class="cls_036"><span class="cls_036">whitepaper</span></div>
<div style="position:absolute;left:382.36px;top:386.05px" class="cls_036"><span class="cls_036">by passing</span></div>
<div style="position:absolute;left:382.36px;top:397.06px" class="cls_036"><span class="cls_036">in a rating</span></div>
<div style="position:absolute;left:382.36px;top:408.07px" class="cls_036"><span class="cls_036">value and</span></div>
<div style="position:absolute;left:382.36px;top:419.08px" class="cls_036"><span class="cls_036">the user who</span></div>
<div style="position:absolute;left:382.36px;top:430.09px" class="cls_036"><span class="cls_036">posted the</span></div>
<div style="position:absolute;left:382.36px;top:441.10px" class="cls_036"><span class="cls_036">rating</span></div>
<div style="position:absolute;left:60.02px;top:457.35px" class="cls_035"><span class="cls_035">/someco/rating?id={id}</span></div>
<div style="position:absolute;left:341.24px;top:458.08px" class="cls_036"><span class="cls_036">DELETE</span></div>
<div style="position:absolute;left:382.36px;top:458.08px" class="cls_036"><span class="cls_036">Deletes all</span></div>
<div style="position:absolute;left:441.13px;top:458.08px" class="cls_036"><span class="cls_036">HTML</span></div>
<div style="position:absolute;left:382.36px;top:469.09px" class="cls_036"><span class="cls_036">ratings for a</span></div>
<div style="position:absolute;left:382.36px;top:480.10px" class="cls_036"><span class="cls_036">specified</span></div>
<div style="position:absolute;left:382.36px;top:491.11px" class="cls_036"><span class="cls_036">whitepaper</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 272 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:194012px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background288.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:122.09px;top:70.50px" class="cls_004"><span class="cls_004">The API to create new ratings provides the option of passing the username</span></div>
<div style="position:absolute;left:122.09px;top:83.10px" class="cls_004"><span class="cls_004">as argument. From a security point of view, this is not ideal because you</span></div>
<div style="position:absolute;left:122.09px;top:95.70px" class="cls_004"><span class="cls_004">could provide any values. The ideal solution would be to retrieve the</span></div>
<div style="position:absolute;left:122.09px;top:108.30px" class="cls_004"><span class="cls_004">username from the authentication used when the web script is called. To</span></div>
<div style="position:absolute;left:122.09px;top:120.90px" class="cls_004"><span class="cls_004">simplify this chapter, we'll make unauthenticated queries to Alfresco. And</span></div>
<div style="position:absolute;left:122.09px;top:133.50px" class="cls_004"><span class="cls_004">we'll discover more about authentication and SSO in the final chapter.</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">When this API is in place, frontend developers can incorporate whitepapers and user-</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">contributed ratings into the SomeCo website. The following screenshots show pages that</span></div>
<div style="position:absolute;left:56.69px;top:180.30px" class="cls_004"><span class="cls_004">use the API you're going to build to query for whitepaper and ratings data. Don't be too</span></div>
<div style="position:absolute;left:56.69px;top:192.90px" class="cls_004"><span class="cls_004">critical of my UI's capabilities:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 273 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:194688px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background289.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You can't tell from the screenshots, but the ratings widget (the row of five stars beneath</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">each whitepaper title) is read-only in this case. When the whitepaper title link is clicked, the</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">whitepaper detail is displayed as follows:</span></div>
<div style="position:absolute;left:56.69px;top:337.97px" class="cls_004"><span class="cls_004">The </span><span class="cls_007">Download</span><span class="cls_004"> link uses the standard Download URL to give the user direct access to the</span></div>
<div style="position:absolute;left:56.69px;top:350.61px" class="cls_004"><span class="cls_004">content.</span></div>
<div style="position:absolute;left:56.69px;top:372.21px" class="cls_004"><span class="cls_004">By the end of the chapter, you will be able to deploy this web page and have it interact with</span></div>
<div style="position:absolute;left:56.69px;top:384.81px" class="cls_004"><span class="cls_004">your web scripts.</span></div>
<div style="position:absolute;left:56.69px;top:423.56px" class="cls_008"><span class="cls_008">Retrieving data with web scripts</span></div>
<div style="position:absolute;left:56.69px;top:451.29px" class="cls_004"><span class="cls_004">The first service that needs to be implemented retrieves the list of whitepapers enabled for</span></div>
<div style="position:absolute;left:56.69px;top:463.89px" class="cls_004"><span class="cls_004">publication. The web script needs to return the list of whitepapers in two formats: HTML</span></div>
<div style="position:absolute;left:56.69px;top:476.49px" class="cls_004"><span class="cls_004">and JSON. HTML will allow you to easily test the service and JSON will make it easy for</span></div>
<div style="position:absolute;left:56.69px;top:489.09px" class="cls_004"><span class="cls_004">code on the frontend to process the list. This will require four files: one descriptor, one</span></div>
<div style="position:absolute;left:56.69px;top:501.69px" class="cls_004"><span class="cls_004">JavaScript controller, and two FreeMarker templates-one for each format.</span></div>
<div style="position:absolute;left:122.09px;top:523.29px" class="cls_004"><span class="cls_004">New to JSON? It stands for JavaScript Object Notation. It is a way to</span></div>
<div style="position:absolute;left:122.09px;top:535.89px" class="cls_004"><span class="cls_004">describe JavaScript objects in plain text. The beauty of it is that it is</span></div>
<div style="position:absolute;left:122.09px;top:548.49px" class="cls_004"><span class="cls_004">extremely easy to create and consume, and it isn't as verbose as XML. For</span></div>
<div style="position:absolute;left:122.09px;top:561.09px" class="cls_004"><span class="cls_004">more information on JSON, see </span><a href="http://www.json.org/">http://www.json.org</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 274 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:195364px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background290.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - writing a web script to list</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">whitepapers</span></div>
<div style="position:absolute;left:56.69px;top:116.58px" class="cls_004"><span class="cls_004">We are going to create all our web scripts in the classpath. By choosing this option, we just</span></div>
<div style="position:absolute;left:56.69px;top:129.18px" class="cls_004"><span class="cls_004">package all our extensions in the same module that represent our solution. By just</span></div>
<div style="position:absolute;left:56.69px;top:141.78px" class="cls_004"><span class="cls_004">deploying our AMP file, everything will be installed and you won't have to deploy files</span></div>
<div style="position:absolute;left:56.69px;top:154.38px" class="cls_004"><span class="cls_004">manually in the repository. To create a web script that retrieves the list of whitepapers, do</span></div>
<div style="position:absolute;left:56.69px;top:166.98px" class="cls_004"><span class="cls_004">the following:</span></div>
<div style="position:absolute;left:91.32px;top:188.71px" class="cls_004"><span class="cls_004">1. First, in your Eclipse project, create the descriptor file in </span><span class="cls_007">repo</span><span class="cls_004"> | </span><span class="cls_007">src</span><span class="cls_004"> | </span><span class="cls_007">main</span><span class="cls_004"> | </span><span class="cls_007">amp</span></div>
<div style="position:absolute;left:104.69px;top:201.35px" class="cls_004"><span class="cls_004">| </span><span class="cls_007">config</span><span class="cls_004"> | </span><span class="cls_007">alfresco</span><span class="cls_004"> | </span><span class="cls_007">extension</span><span class="cls_004"> | </span><span class="cls_007">templates</span><span class="cls_004"> | </span><span class="cls_007">webscripts</span><span class="cls_004"> | </span><span class="cls_007">com</span><span class="cls_004"> | </span><span class="cls_007">someco</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:213.99px" class="cls_007"><span class="cls_007">whitepapers</span><span class="cls_004">. Name it </span><span class="cls_013">whitepapers.get.desc.xml</span><span class="cls_004"> and give it the following</span></div>
<div style="position:absolute;left:104.69px;top:227.27px" class="cls_004"><span class="cls_004">content:</span></div>
<div style="position:absolute;left:117.89px;top:250.48px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:139.49px;top:261.28px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Get all whitepapers&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:139.49px;top:272.08px" class="cls_010"><span class="cls_010">&lt;description&gt;Returns a list of active whitepapers&lt;/description&gt;</span></div>
<div style="position:absolute;left:139.49px;top:282.88px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/whitepapers&lt;/url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:293.68px" class="cls_010"><span class="cls_010">&lt;!-- The 2 following lines are optional --&gt;</span></div>
<div style="position:absolute;left:139.49px;top:304.48px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/whitepapers.json&lt;/url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:315.28px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/whitepapers.html&lt;/url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:326.08px" class="cls_010"><span class="cls_010">&lt;format default="json"&gt;extension&lt;/format&gt;</span></div>
<div style="position:absolute;left:139.49px;top:336.88px" class="cls_010"><span class="cls_010">&lt;authentication runas="admin"&gt;guest&lt;/authentication&gt;</span></div>
<div style="position:absolute;left:139.49px;top:347.68px" class="cls_010"><span class="cls_010">&lt;transaction&gt;none&lt;/transaction&gt;</span></div>
<div style="position:absolute;left:117.89px;top:358.48px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:124.19px;top:378.96px" class="cls_004"><span class="cls_004">Be aware that we don't follow the best practices in the definition of the</span></div>
<div style="position:absolute;left:124.19px;top:391.56px" class="cls_004"><span class="cls_004">authentication mechanism. In this case, we define that you can call this web</span></div>
<div style="position:absolute;left:124.19px;top:404.16px" class="cls_004"><span class="cls_004">script being authenticated as a guest, but all actions will be executed under</span></div>
<div style="position:absolute;left:124.19px;top:416.76px" class="cls_004"><span class="cls_004">the username </span><span class="cls_013">admin</span><span class="cls_004">. The first issue is that you have to be sure that this</span></div>
<div style="position:absolute;left:124.19px;top:430.04px" class="cls_004"><span class="cls_004">username exists in Alfresco and includes all expected permissions.</span></div>
<div style="position:absolute;left:91.32px;top:451.77px" class="cls_004"><span class="cls_004">2. Next, you need a controller to execute the query to find the whitepapers. Create a</span></div>
<div style="position:absolute;left:104.69px;top:464.37px" class="cls_004"><span class="cls_004">file in the same directory that you created the descriptor called</span></div>
<div style="position:absolute;left:104.69px;top:476.97px" class="cls_013"><span class="cls_013">whitepapers.get.js</span><span class="cls_004">. The first thing you're going to do is import the</span></div>
<div style="position:absolute;left:104.69px;top:490.25px" class="cls_013"><span class="cls_013">rating.js</span><span class="cls_004"> JavaScript file. You're going to add a new function to that file in a</span></div>
<div style="position:absolute;left:104.69px;top:503.53px" class="cls_004"><span class="cls_004">moment:</span></div>
<div style="position:absolute;left:117.89px;top:526.74px" class="cls_010"><span class="cls_010">&lt;import resource="classpath:alfresco/extension/scripts/rating.js"&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 275 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:196040px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background291.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Now add code to execute a search for whitepapers. You can use a Lucene search</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">string that grabs every whitepaper object and has the </span><span class="cls_013">isActive</span><span class="cls_004"> flag set to </span><span class="cls_013">true</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">var whitepapers = search.luceneSearch("+TYPE:"sc:whitepaper"</span></div>
<div style="position:absolute;left:74.69px;top:117.79px" class="cls_010"><span class="cls_010">+@sc\\:isActive:true");</span></div>
<div style="position:absolute;left:91.32px;top:138.40px" class="cls_004"><span class="cls_004">4. If no whitepapers are found, an error message needs to be returned. Otherwise,</span></div>
<div style="position:absolute;left:104.69px;top:151.00px" class="cls_004"><span class="cls_004">build an array of whitepapers and store that array in the model:</span></div>
<div style="position:absolute;left:134.09px;top:174.21px" class="cls_010"><span class="cls_010">if (whitepapers == null || whitepapers.length == 0) {</span></div>
<div style="position:absolute;left:150.29px;top:185.01px" class="cls_010"><span class="cls_010">logger.log("No whitepapers found");</span></div>
<div style="position:absolute;left:150.29px;top:195.81px" class="cls_010"><span class="cls_010">status.code = 404;</span></div>
<div style="position:absolute;left:150.29px;top:206.61px" class="cls_010"><span class="cls_010">status.message = "No whitepapers found";</span></div>
<div style="position:absolute;left:144.89px;top:217.41px" class="cls_010"><span class="cls_010">status.redirect = true;</span></div>
<div style="position:absolute;left:134.09px;top:228.21px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:117.89px;top:239.01px" class="cls_010"><span class="cls_010">var whitepaperInfo = new Array();</span></div>
<div style="position:absolute;left:150.29px;top:249.81px" class="cls_010"><span class="cls_010">for (i = 0; i&lt;whitepapers.length; i++) {</span></div>
<div style="position:absolute;left:166.49px;top:260.61px" class="cls_010"><span class="cls_010">var whitepaper = new whitepaperEntry(whitepapers[i],</span></div>
<div style="position:absolute;left:166.49px;top:271.41px" class="cls_010"><span class="cls_010">getRating(whitepapers[i]));</span></div>
<div style="position:absolute;left:166.49px;top:282.21px" class="cls_010"><span class="cls_010">whitepaperInfo[i] = whitepaper;</span></div>
<div style="position:absolute;left:150.29px;top:293.01px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:150.29px;top:303.81px" class="cls_010"><span class="cls_010">model.whitepapers = whitepaperInfo;</span></div>
<div style="position:absolute;left:134.09px;top:314.61px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:134.09px;top:336.21px" class="cls_010"><span class="cls_010">function whitepaperEntry(whitepaper, rating) {</span></div>
<div style="position:absolute;left:161.09px;top:347.01px" class="cls_010"><span class="cls_010">this.whitepaper = whitepaper;</span></div>
<div style="position:absolute;left:161.09px;top:357.81px" class="cls_010"><span class="cls_010">this.rating = rating;</span></div>
<div style="position:absolute;left:134.09px;top:368.61px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:389.22px" class="cls_004"><span class="cls_004">5. Save the JavaScript file.</span></div>
<div style="position:absolute;left:91.32px;top:403.98px" class="cls_004"><span class="cls_004">6. The controller you just wrote imports a script called </span><span class="cls_013">rating.js</span><span class="cls_004">. Create this file,</span></div>
<div style="position:absolute;left:104.69px;top:417.26px" class="cls_013"><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">extension</span><span class="cls_004"> | </span><span class="cls_013">scripts</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:104.69px;top:430.54px" class="cls_004"><span class="cls_004">including the function called </span><span class="cls_013">getRating</span><span class="cls_004">, as shown here. The function is</span></div>
<div style="position:absolute;left:104.69px;top:443.82px" class="cls_004"><span class="cls_004">responsible for retrieving the rating summary statistics for a given node:</span></div>
<div style="position:absolute;left:134.09px;top:467.03px" class="cls_010"><span class="cls_010">function getRating(curNode, curUser) {</span></div>
<div style="position:absolute;left:161.09px;top:477.83px" class="cls_010"><span class="cls_010">var rating = {};</span></div>
<div style="position:absolute;left:161.09px;top:488.63px" class="cls_010"><span class="cls_010">rating.average = curNode.properties["sc:averageRating"];</span></div>
<div style="position:absolute;left:161.09px;top:499.43px" class="cls_010"><span class="cls_010">rating.count = curNode.properties["sc:ratingCount"];</span></div>
<div style="position:absolute;left:161.09px;top:510.23px" class="cls_010"><span class="cls_010">rating.user = getUserRating(curNode, curUser);</span></div>
<div style="position:absolute;left:161.09px;top:521.03px" class="cls_010"><span class="cls_010">return rating;</span></div>
<div style="position:absolute;left:134.09px;top:531.83px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 276 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:196716px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background292.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. The </span><span class="cls_013">getRating</span><span class="cls_004"> function calls </span><span class="cls_013">getUserRating</span><span class="cls_004"> to see if a specified user has</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">already rated this whitepaper, and if so, retrieves the rating. Add the</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_013"><span class="cls_013">getUserRating</span><span class="cls_004"> function to the same JavaScript file as follows:</span></div>
<div style="position:absolute;left:134.09px;top:120.27px" class="cls_010"><span class="cls_010">function getUserRating(curNode, curUser) {</span></div>
<div style="position:absolute;left:150.29px;top:131.07px" class="cls_010"><span class="cls_010">if (curUser == undefined || curUser== "") {</span></div>
<div style="position:absolute;left:166.49px;top:141.87px" class="cls_010"><span class="cls_010">logger.log("User name was not passed in");</span></div>
<div style="position:absolute;left:166.49px;top:152.67px" class="cls_010"><span class="cls_010">return 0;</span></div>
<div style="position:absolute;left:150.29px;top:163.47px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:144.89px;top:185.07px" class="cls_010"><span class="cls_010">var results = curNode.childrenByXPath("*//.[@sc:rater='"</span></div>
<div style="position:absolute;left:166.49px;top:195.87px" class="cls_010"><span class="cls_010">+  curUser + "']");</span></div>
<div style="position:absolute;left:144.89px;top:206.67px" class="cls_010"><span class="cls_010">if (results == undefined || results.length== 0) {</span></div>
<div style="position:absolute;left:166.49px;top:217.47px" class="cls_010"><span class="cls_010">logger.log("No ratings found for this node for user: "</span></div>
<div style="position:absolute;left:166.49px;top:228.27px" class="cls_010"><span class="cls_010">+  curUser);</span></div>
<div style="position:absolute;left:166.49px;top:239.07px" class="cls_010"><span class="cls_010">return 0;</span></div>
<div style="position:absolute;left:150.29px;top:249.87px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:171.89px;top:260.67px" class="cls_010"><span class="cls_010">var rating = results[results.length-1]</span></div>
<div style="position:absolute;left:182.69px;top:271.47px" class="cls_010"><span class="cls_010">.properties["{</span><a href="http://www.someco.com/model/">http://www.someco.com/model</a> </div>
<div style="position:absolute;left:182.69px;top:282.27px" class="cls_010"><span class="cls_010">/content/1.0}rating"];</span></div>
<div style="position:absolute;left:171.89px;top:293.07px" class="cls_010"><span class="cls_010">if (rating == undefined) {</span></div>
<div style="position:absolute;left:182.69px;top:303.87px" class="cls_010"><span class="cls_010">return 0;</span></div>
<div style="position:absolute;left:171.89px;top:314.67px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:182.69px;top:325.47px" class="cls_010"><span class="cls_010">return rating;</span></div>
<div style="position:absolute;left:171.89px;top:336.27px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:150.29px;top:347.07px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:134.09px;top:357.87px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:378.48px" class="cls_004"><span class="cls_004">8. Save the JavaScript file.</span></div>
<div style="position:absolute;left:91.32px;top:393.24px" class="cls_004"><span class="cls_004">9. As you saw in the </span><span class="cls_013">Hello World</span><span class="cls_004"> example, one FreeMarker template is needed for</span></div>
<div style="position:absolute;left:104.69px;top:406.52px" class="cls_004"><span class="cls_004">each response format. Let's create the HTML response template first. Create a</span></div>
<div style="position:absolute;left:104.69px;top:419.12px" class="cls_004"><span class="cls_004">new file in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">extension</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:432.40px" class="cls_013"><span class="cls_013">templates</span><span class="cls_004"> | </span><span class="cls_013">webscripts</span><span class="cls_004"> | </span><span class="cls_013">com</span><span class="cls_004"> | </span><span class="cls_013">someco</span><span class="cls_004"> | </span><span class="cls_013">whitepapers</span><span class="cls_004"> called</span></div>
<div style="position:absolute;left:104.69px;top:445.68px" class="cls_013"><span class="cls_013">whitepapers.get.html.ftl</span><span class="cls_004">. The HTML response is for debugging purposes,</span></div>
<div style="position:absolute;left:104.69px;top:458.96px" class="cls_004"><span class="cls_004">so nothing fancy is needed. An HTML table showing the list of whitepapers will</span></div>
<div style="position:absolute;left:104.69px;top:471.56px" class="cls_004"><span class="cls_004">do fine. First, set up a date format variable and then start the table:</span></div>
<div style="position:absolute;left:117.89px;top:494.77px" class="cls_010"><span class="cls_010">&lt;#assign datetimeformat="EEE, dd MMM yyyyHH:mm:sszzz"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:505.57px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:139.49px;top:516.37px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:161.09px;top:527.17px" class="cls_010"><span class="cls_010">&lt;h3&gt;Whitepapers&lt;/h3&gt;</span></div>
<div style="position:absolute;left:161.09px;top:537.97px" class="cls_010"><span class="cls_010">&lt;table&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 277 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:197392px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background293.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10.</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Now iterate over the array of </span><span class="cls_013">whitepaperEntry</span><span class="cls_004"> objects to build the table:</span></div>
<div style="position:absolute;left:117.89px;top:94.39px" class="cls_010"><span class="cls_010">&lt;#list whitepapers as child&gt;</span></div>
<div style="position:absolute;left:139.49px;top:105.19px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:115.99px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Name&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:161.09px;top:126.79px" class="cls_010"><span class="cls_010">&lt;td&gt;${child.whitepaper.properties.name}&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:137.59px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:148.39px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:159.19px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Title&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:161.09px;top:169.99px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:182.69px;top:180.79px" class="cls_010"><span class="cls_010">&lt;#if child.whitepaper.properties["cm:title"]?exists&gt;</span></div>
<div style="position:absolute;left:204.29px;top:191.59px" class="cls_010"><span class="cls_010">${child.whitepaper.properties["cm:title"]}</span></div>
<div style="position:absolute;left:182.69px;top:202.39px" class="cls_010"><span class="cls_010">&lt;/#if&gt;</span></div>
<div style="position:absolute;left:161.09px;top:213.19px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:223.99px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:234.79px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:245.59px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Link&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:161.09px;top:256.39px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:182.69px;top:267.19px" class="cls_010"><span class="cls_010">&lt;a href="${url.context}</span></div>
<div style="position:absolute;left:193.49px;top:277.99px" class="cls_010"><span class="cls_010">${child.whitepaper.url}?guest=true"&gt;</span></div>
<div style="position:absolute;left:215.09px;top:288.79px" class="cls_010"><span class="cls_010">${url.context}${child.whitepaper.url}</span></div>
<div style="position:absolute;left:182.69px;top:299.59px" class="cls_010"><span class="cls_010">&lt;/a&gt;</span></div>
<div style="position:absolute;left:161.09px;top:310.39px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:321.19px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:331.99px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:342.79px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Type&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:161.09px;top:353.59px" class="cls_010"><span class="cls_010">&lt;td&gt;${child.whitepaper. mimetype}&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:364.39px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:375.19px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:385.99px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Size&lt;/b&gt;&lt;/td&gt;&lt;td&gt;${child.whitepaper.size} &lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:396.79px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:407.59px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:418.39px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Id&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:161.09px;top:429.19px" class="cls_010"><span class="cls_010">&lt;td&gt;${child.whitepaper.id}&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:439.99px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:450.79px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:461.59px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Description&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:161.09px;top:472.39px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:171.89px;top:483.19px" class="cls_010"><span class="cls_010">&lt;p&gt;&lt;#if child.whitepaper</span></div>
<div style="position:absolute;left:215.09px;top:493.99px" class="cls_010"><span class="cls_010">.properties["cm:description"]?exists</span></div>
<div style="position:absolute;left:204.29px;top:504.79px" class="cls_010"><span class="cls_010">&amp;&amp;child.whitepaper</span></div>
<div style="position:absolute;left:215.09px;top:515.59px" class="cls_010"><span class="cls_010">.properties["cm:description"] != ""&gt;</span></div>
<div style="position:absolute;left:182.69px;top:526.39px" class="cls_010"><span class="cls_010">${child. whitepaper.properties["cm:description"]}</span></div>
<div style="position:absolute;left:171.89px;top:537.19px" class="cls_010"><span class="cls_010">&lt;/#if&gt;&lt;/p&gt;</span></div>
<div style="position:absolute;left:161.09px;top:547.99px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:558.79px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:569.59px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:580.39px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Pub Date&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 278 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:198068px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background294.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:182.69px;top:80.62px" class="cls_010"><span class="cls_010">${child.whitepaper.properties["cm:modified"]</span></div>
<div style="position:absolute;left:182.69px;top:91.42px" class="cls_010"><span class="cls_010">?string(datetimeformat)}</span></div>
<div style="position:absolute;left:161.09px;top:102.22px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:113.02px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:123.82px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:161.09px;top:134.62px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:182.69px;top:145.42px" class="cls_010"><span class="cls_010">&lt;b&gt;&lt;a href="${url.serviceContext}/someco/ rating.html</span></div>
<div style="position:absolute;left:204.29px;top:156.22px" class="cls_010"><span class="cls_010">?id=${child.whitepaper.id}</span></div>
<div style="position:absolute;left:204.29px;top:167.02px" class="cls_010"><span class="cls_010">&amp;guest=true"&gt; Rating&lt;/a&gt;&lt;/b&gt;</span></div>
<div style="position:absolute;left:161.09px;top:177.82px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:161.09px;top:188.62px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:182.69px;top:199.42px" class="cls_010"><span class="cls_010">&lt;table&gt;</span></div>
<div style="position:absolute;left:204.29px;top:210.22px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:225.89px;top:221.02px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Average&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:225.89px;top:231.82px" class="cls_010"><span class="cls_010">&lt;td&gt;${child. rating.average!0}&lt;/td&gt;</span></div>
<div style="position:absolute;left:204.29px;top:242.62px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:204.29px;top:253.42px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:225.89px;top:264.22px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;Count&lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:225.89px;top:275.02px" class="cls_010"><span class="cls_010">&lt;td&gt;${child. rating.count!0}&lt;/td&gt;</span></div>
<div style="position:absolute;left:204.29px;top:285.82px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:204.29px;top:296.62px" class="cls_010"><span class="cls_010">&lt;#if (child.rating.user&gt; 0)&gt;</span></div>
<div style="position:absolute;left:225.89px;top:307.42px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:247.49px;top:318.22px" class="cls_010"><span class="cls_010">&lt;td&gt;&lt;b&gt;User &lt;/b&gt;&lt;/td&gt;</span></div>
<div style="position:absolute;left:247.49px;top:329.02px" class="cls_010"><span class="cls_010">&lt;td&gt;${child.rating.user}&lt;/td&gt;</span></div>
<div style="position:absolute;left:225.89px;top:339.82px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:204.29px;top:350.62px" class="cls_010"><span class="cls_010">&lt;/#if&gt;</span></div>
<div style="position:absolute;left:182.69px;top:361.42px" class="cls_010"><span class="cls_010">&lt;/table&gt;</span></div>
<div style="position:absolute;left:161.09px;top:372.22px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:383.02px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:393.82px" class="cls_010"><span class="cls_010">&lt;#if !(child.whitepaper == whitepapers?last.whitepaper)&gt;</span></div>
<div style="position:absolute;left:139.49px;top:404.62px" class="cls_010"><span class="cls_010">&lt;tr&gt;&lt;td colspan="2" bgcolor="999999"&gt;&nbsp;&lt;/td&gt;&lt;/tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:415.42px" class="cls_010"><span class="cls_010">&lt;/#if&gt;</span></div>
<div style="position:absolute;left:117.89px;top:426.22px" class="cls_010"><span class="cls_010">&lt;/#list&gt;</span></div>
<div style="position:absolute;left:117.89px;top:437.02px" class="cls_010"><span class="cls_010">&lt;/table&gt;</span></div>
<div style="position:absolute;left:117.89px;top:447.82px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:458.62px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:86.07px;top:479.23px" class="cls_004"><span class="cls_004">11.</span></div>
<div style="position:absolute;left:104.69px;top:479.23px" class="cls_004"><span class="cls_004">Save the HTML response template.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 279 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:198744px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background295.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">12.</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Now create the JSON response template. Create a file called</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">whitepapers.get.json.ftl</span><span class="cls_004"> in the directory in which you created the HTML</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">template. The overall logic is exactly the same, but the output format is in JSON</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">instead of HTML:</span></div>
<div style="position:absolute;left:117.89px;top:132.19px" class="cls_010"><span class="cls_010">&lt;#assign datetimeformat="EEE, dd MMM yyyyHH:mm:sszzz"&gt;</span></div>
<div style="position:absolute;left:134.09px;top:153.79px" class="cls_010"><span class="cls_010">{"whitepapers" : [</span></div>
<div style="position:absolute;left:139.49px;top:164.59px" class="cls_010"><span class="cls_010">&lt;#list whitepapers as child&gt;</span></div>
<div style="position:absolute;left:150.29px;top:175.39px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:171.89px;top:186.19px" class="cls_010"><span class="cls_010">"name" : "${child.whitepaper.properties.name}",</span></div>
<div style="position:absolute;left:171.89px;top:196.99px" class="cls_010"><span class="cls_010">"title" : "&lt;#if child.whitepaper.properties</span></div>
<div style="position:absolute;left:204.29px;top:207.79px" class="cls_010"><span class="cls_010">["cm:title"]?exists&gt;${child.whitepaper.properties</span></div>
<div style="position:absolute;left:204.29px;top:218.59px" class="cls_010"><span class="cls_010">["cm:title"]?js_string}&lt;/#if&gt;",</span></div>
<div style="position:absolute;left:171.89px;top:229.39px" class="cls_010"><span class="cls_010">"link" : "${url.context}${child.whitepaper.url}",</span></div>
<div style="position:absolute;left:171.89px;top:240.19px" class="cls_010"><span class="cls_010">"type" : "${child.whitepaper.mimetype}",</span></div>
<div style="position:absolute;left:171.89px;top:250.99px" class="cls_010"><span class="cls_010">"size" : "${child.whitepaper.size}",</span></div>
<div style="position:absolute;left:171.89px;top:261.79px" class="cls_010"><span class="cls_010">"id" : "${child.whitepaper.id}",</span></div>
<div style="position:absolute;left:171.89px;top:272.59px" class="cls_010"><span class="cls_010">"description" : "&lt;#if child.whitepaper.properties</span></div>
<div style="position:absolute;left:182.69px;top:283.39px" class="cls_010"><span class="cls_010">["cm:description"]?exists &amp;&amp;child.whitepaper.properties</span></div>
<div style="position:absolute;left:182.69px;top:294.19px" class="cls_010"><span class="cls_010">["cm:description"] != ""&gt;${child.whitepaper.properties</span></div>
<div style="position:absolute;left:182.69px;top:304.99px" class="cls_010"><span class="cls_010">["cm:description"]?j_string}&lt;/#if&gt;",</span></div>
<div style="position:absolute;left:193.49px;top:315.79px" class="cls_010"><span class="cls_010">"pubDate" : "${child.whitepaper.properties</span></div>
<div style="position:absolute;left:182.69px;top:326.59px" class="cls_010"><span class="cls_010">["cm:modified"]?string(datetimeformat)}",</span></div>
<div style="position:absolute;left:193.49px;top:337.39px" class="cls_010"><span class="cls_010">"rating" : {</span></div>
<div style="position:absolute;left:209.69px;top:348.19px" class="cls_010"><span class="cls_010">"average" : "${child.rating.average!0}",</span></div>
<div style="position:absolute;left:209.69px;top:358.99px" class="cls_010"><span class="cls_010">"count" : "${child.rating.count!0}",</span></div>
<div style="position:absolute;left:209.69px;top:369.79px" class="cls_010"><span class="cls_010">"user" : "${child.rating.user!""}"</span></div>
<div style="position:absolute;left:198.89px;top:380.59px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:150.29px;top:391.39px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:161.09px;top:402.19px" class="cls_010"><span class="cls_010">&lt;#if !(child.whitepaper == whitepapers?last.whitepaper)&gt;,</span></div>
<div style="position:absolute;left:161.09px;top:412.99px" class="cls_010"><span class="cls_010">&lt;/#if&gt;</span></div>
<div style="position:absolute;left:139.49px;top:423.79px" class="cls_010"><span class="cls_010">&lt;/#list&gt;</span></div>
<div style="position:absolute;left:134.09px;top:434.59px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:123.29px;top:445.39px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:466.00px" class="cls_004"><span class="cls_004">13.</span></div>
<div style="position:absolute;left:104.69px;top:466.00px" class="cls_004"><span class="cls_004">Save the JSON response template.</span></div>
<div style="position:absolute;left:86.07px;top:480.76px" class="cls_004"><span class="cls_004">14.</span></div>
<div style="position:absolute;left:104.69px;top:480.76px" class="cls_004"><span class="cls_004">Package, deploy, and restart Alfresco.</span></div>
<div style="position:absolute;left:86.07px;top:495.52px" class="cls_004"><span class="cls_004">15.</span></div>
<div style="position:absolute;left:104.69px;top:495.52px" class="cls_004"><span class="cls_004">Open the following link to see all your available web scripts:</span></div>
<div style="position:absolute;left:104.69px;top:507.34px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/index/package/com/someco/">http://localhost:8080/alfresco/service/index/package/com/someco</a> </div>
<div style="position:absolute;left:104.69px;top:520.12px" class="cls_013"><span class="cls_013">/whitepapers</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 280 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:199420px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background296.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Now, let's test our first web script Open the following URL and let's see the result</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">(</span><a href="http://localhost:8080/alfresco/service/someco/whitepapers/">http://localhost:8080/alfresco/service/someco/whitepapers</a> <span class="cls_004">). In my case, I</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">get a JSON file letting me know that I don't have any whitepapers:</span></div>
<div style="position:absolute;left:56.69px;top:362.69px" class="cls_004"><span class="cls_004">It's correct, I destroyed my virtual machine before starting this chapter. So, my Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:375.29px" class="cls_004"><span class="cls_004">repository is completely clean. Let's open </span><span class="cls_007">Alfresco Share</span><span class="cls_004">, create a new </span><span class="cls_007">Marketing</span><span class="cls_004"> site, open</span></div>
<div style="position:absolute;left:56.69px;top:387.93px" class="cls_004"><span class="cls_004">the </span><span class="cls_007">Document Library</span><span class="cls_004">, create a new folder called whitepapers, and create a rule that will</span></div>
<div style="position:absolute;left:56.69px;top:400.56px" class="cls_004"><span class="cls_004">do the following:</span></div>
<div style="position:absolute;left:104.69px;top:422.29px" class="cls_004"><span class="cls_004">Specialize any incoming document to Someco whitepaper</span></div>
<div style="position:absolute;left:104.69px;top:437.05px" class="cls_004"><span class="cls_004">Add the SomecoWebable aspect</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 281 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:200096px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background297.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Add the SomecoRateable aspect</span></div>
<div style="position:absolute;left:104.69px;top:85.26px" class="cls_004"><span class="cls_004">Execute the </span><span class="cls_013">addTestRating.js</span><span class="cls_004"> script:</span></div>
<div style="position:absolute;left:56.69px;top:474.37px" class="cls_004"><span class="cls_004">It means that you'll need the </span><span class="cls_013">addTestRating.js</span><span class="cls_004"> script already available in your</span></div>
<div style="position:absolute;left:56.69px;top:487.65px" class="cls_004"><span class="cls_004">repository. If it's not the case, you can find it in </span><span class="cls_007">repo|src|scripts</span><span class="cls_004"> and upload it to the</span></div>
<div style="position:absolute;left:56.69px;top:500.29px" class="cls_007"><span class="cls_007">Repository</span><span class="cls_004"> | </span><span class="cls_007">DataDictionary</span><span class="cls_004"> | </span><span class="cls_007">Scripts</span><span class="cls_004"> folder. Let's upload some documents in the</span></div>
<div style="position:absolute;left:56.69px;top:512.93px" class="cls_004"><span class="cls_004">whitepaper folder, and retry. Unfortunately, we have the same error, </span><span class="cls_013">No whitepapers</span></div>
<div style="position:absolute;left:56.69px;top:526.21px" class="cls_013"><span class="cls_013">found</span><span class="cls_004">. If you remember, we are looking for </span><span class="cls_012">Active</span><span class="cls_004"> whitepapers. Just click on the </span><span class="cls_007">SC Web</span></div>
<div style="position:absolute;left:56.69px;top:539.49px" class="cls_007"><span class="cls_007">Enable</span><span class="cls_004"> action to set the </span><span class="cls_013">isActive</span><span class="cls_004"> flag to </span><span class="cls_013">true</span><span class="cls_004">. (Don't forget that your user needs to be</span></div>
<div style="position:absolute;left:56.69px;top:552.77px" class="cls_004"><span class="cls_004">member of the </span><span class="cls_013">SomecoPublisher </span><span class="cls_004">group to have access to this action).</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 282 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:200772px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background298.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Let's retry and I finally can see my whitepapers. But we are not done yet. Because the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">descriptor specifies that this script requires Guest access or higher, you'll need to either log</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">in to Alfresco Share before running the script, authenticate with a valid user and password</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">when the basic authentication dialog is presented, or append </span><span class="cls_013">?guest=true</span><span class="cls_004"> to the URL. For</span></div>
<div style="position:absolute;left:56.69px;top:121.58px" class="cls_004"><span class="cls_004">now, use the guest approach, which means the URL should look like this:</span></div>
<div style="position:absolute;left:56.69px;top:133.40px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/whitepapers.html?guest=tr/">http://localhost:8080/alfresco/service/someco/whitepapers.html?guest=tr</a> </div>
<div style="position:absolute;left:56.69px;top:145.40px" class="cls_013"><span class="cls_013">ue</span></div>
<div style="position:absolute;left:56.69px;top:167.18px" class="cls_004"><span class="cls_004">If you forget the </span><span class="cls_013">html</span><span class="cls_004">, you'll get a JSON response because you set that as the default format</span></div>
<div style="position:absolute;left:56.69px;top:180.46px" class="cls_004"><span class="cls_004">in the descriptor. If you use this URL, you'll notice that it finds the same list of whitepapers,</span></div>
<div style="position:absolute;left:56.69px;top:193.06px" class="cls_004"><span class="cls_004">even if you are not authenticated. The reason is because we use the </span><span class="cls_013">runAs</span><span class="cls_004"> parameter.</span></div>
<div style="position:absolute;left:56.69px;top:206.34px" class="cls_004"><span class="cls_004">Basically, the code is executed as a particular Alfresco content repository user, regardless of</span></div>
<div style="position:absolute;left:56.69px;top:218.94px" class="cls_004"><span class="cls_004">who initiated the web script.</span></div>
<div style="position:absolute;left:56.69px;top:240.54px" class="cls_004"><span class="cls_004">If all goes well, you should see something similar to the following screenshot:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 283 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:201448px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background299.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Debugging</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Did your web script work? If not, it's time to debug. If you remember, you already enabled</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">changed the logger level to DEBUG for the following logger:</span></div>
<div style="position:absolute;left:56.69px;top:119.40px" class="cls_013"><span class="cls_013">log4j.logger.org.alfresco.repo.jscript</span></div>
<div style="position:absolute;left:56.69px;top:141.18px" class="cls_004"><span class="cls_004">This means that you can see all the messages in the </span><span class="cls_013">catalina.out</span><span class="cls_004"> file:</span></div>
<div style="position:absolute;left:74.69px;top:162.78px" class="cls_010"><span class="cls_010">DEBUG [jscript.RhinoScriptProcessor.calls] [http-apr-8080-exec-9]</span></div>
<div style="position:absolute;left:74.69px;top:173.58px" class="cls_010"><span class="cls_010">whitepapers.get.js Start</span></div>
<div style="position:absolute;left:74.69px;top:184.38px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.Search] [http-apr-8080-exec-9]</span></div>
<div style="position:absolute;left:74.69px;top:195.18px" class="cls_010"><span class="cls_010">query=+TYPE:"sc:whitepaper" +@sc\:isActive:true limit=none</span></div>
<div style="position:absolute;left:74.69px;top:205.98px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.Search] [http-apr-8080-exec-9] query time: 23ms</span></div>
<div style="position:absolute;left:74.69px;top:216.78px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.ScriptLogger] [http-apr-8080-exec-9] User name was not</span></div>
<div style="position:absolute;left:74.69px;top:227.58px" class="cls_010"><span class="cls_010">passed in</span></div>
<div style="position:absolute;left:74.69px;top:238.38px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.ScriptLogger] [http-apr-8080-exec-9] User name was not</span></div>
<div style="position:absolute;left:74.69px;top:249.18px" class="cls_010"><span class="cls_010">passed in</span></div>
<div style="position:absolute;left:74.69px;top:259.98px" class="cls_010"><span class="cls_010">DEBUG [jscript.RhinoScriptProcessor.calls] [http-apr-8080-exec-9]</span></div>
<div style="position:absolute;left:74.69px;top:270.78px" class="cls_010"><span class="cls_010">whitepapers.get.js End 37 ms</span></div>
<div style="position:absolute;left:56.69px;top:291.26px" class="cls_004"><span class="cls_004">Another tool you'll want to leverage is the web script list. You can use it to see whether</span></div>
<div style="position:absolute;left:56.69px;top:303.86px" class="cls_004"><span class="cls_004">Alfresco knows about your script and the version of the scripts the runtime knows about.</span></div>
<div style="position:absolute;left:56.69px;top:316.46px" class="cls_004"><span class="cls_004">The starting URL for the web script list is</span></div>
<div style="position:absolute;left:56.69px;top:329.06px" class="cls_013"><span class="cls_013">http://localhost:8080/alfresco/service/index/</span><span class="cls_004">. From there, you can see a list of</span></div>
<div style="position:absolute;left:56.69px;top:342.34px" class="cls_004"><span class="cls_004">web scripts by package and by URL. You can also browse the configuration for a specific</span></div>
<div style="position:absolute;left:56.69px;top:354.94px" class="cls_004"><span class="cls_004">web script. For example, you can go to</span></div>
<div style="position:absolute;left:56.69px;top:366.76px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/script/com/someco/whitepapers/wh/">http://localhost:8080/alfresco/service/script/com/someco/whitepapers/wh</a> </div>
<div style="position:absolute;left:56.69px;top:379.54px" class="cls_013"><span class="cls_013">itepapers.get</span><span class="cls_004"> and Alfresco will dump the descriptor and all of the response templates.</span></div>
<div style="position:absolute;left:56.69px;top:401.82px" class="cls_004"><span class="cls_004">The Node Browser can be helpful to debug problems as well. In this case, for example,</span></div>
<div style="position:absolute;left:56.69px;top:414.42px" class="cls_004"><span class="cls_004">you're running a Lucene query in the JavaScript controller to find whitepapers. If the</span></div>
<div style="position:absolute;left:56.69px;top:427.02px" class="cls_004"><span class="cls_004">controller doesn't find any whitepapers, even though you've created test data, try executing</span></div>
<div style="position:absolute;left:56.69px;top:439.62px" class="cls_004"><span class="cls_004">the query in the Node browser. If it doesn't return results, there could be something wrong</span></div>
<div style="position:absolute;left:56.69px;top:452.22px" class="cls_004"><span class="cls_004">with either your test data or the query syntax.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 284 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:202124px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background300.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Fast facts</span></div>
<div style="position:absolute;left:104.69px;top:101.23px" class="cls_004"><span class="cls_004">The descriptor you created has multiple URL elements. There is one URL for each</span></div>
<div style="position:absolute;left:104.69px;top:113.83px" class="cls_004"><span class="cls_004">format plus a URL without a format. Because the URLs differ only in format, it</span></div>
<div style="position:absolute;left:104.69px;top:126.43px" class="cls_004"><span class="cls_004">isn't strictly required that they be listed in the descriptor. But it is a good practice</span></div>
<div style="position:absolute;left:104.69px;top:139.03px" class="cls_004"><span class="cls_004">to list all formats that your module supports. A better reason for using multiple</span></div>
<div style="position:absolute;left:104.69px;top:151.63px" class="cls_004"><span class="cls_004">URL elements would be if you wanted to use completely different URL formats</span></div>
<div style="position:absolute;left:104.69px;top:164.23px" class="cls_004"><span class="cls_004">for the same web script.</span></div>
<div style="position:absolute;left:104.69px;top:178.99px" class="cls_004"><span class="cls_004">The authentication element declares the lowest level of authentication required</span></div>
<div style="position:absolute;left:104.69px;top:191.59px" class="cls_004"><span class="cls_004">for this script. If your script touches the repository, you will want this to be Guest</span></div>
<div style="position:absolute;left:104.69px;top:204.19px" class="cls_004"><span class="cls_004">or higher. Other options are </span><span class="cls_013">none</span><span class="cls_004">, </span><span class="cls_013">user</span><span class="cls_004">, and </span><span class="cls_013">admin</span><span class="cls_004">. Authentication will be</span></div>
<div style="position:absolute;left:104.69px;top:217.47px" class="cls_004"><span class="cls_004">discussed shortly.</span></div>
<div style="position:absolute;left:104.69px;top:232.06px" class="cls_004"><span class="cls_004">The transaction element specifies the level of transaction required by the script.</span></div>
<div style="position:absolute;left:104.69px;top:244.90px" class="cls_004"><span class="cls_004">Listing whitepapers doesn't need a transaction so you specified </span><span class="cls_007">none</span><span class="cls_004">. Other</span></div>
<div style="position:absolute;left:104.69px;top:257.99px" class="cls_004"><span class="cls_004">possible values are </span><span class="cls_013">required</span><span class="cls_004"> and </span><span class="cls_013">requires new</span></div>
<div style="position:absolute;left:104.69px;top:270.58px" class="cls_004"><span class="cls_004">(</span><a href="http://docs.alfresco.com/5.1/references/api-wsdl-transaction.html">http://docs.alfresco.com/5.1/references/api-wsdl-transaction.html</a> <span class="cls_004">).</span></div>
<div style="position:absolute;left:104.69px;top:285.89px" class="cls_004"><span class="cls_004">The ability to import a script from another script was added with release 2.1. The</span></div>
<div style="position:absolute;left:104.69px;top:298.49px" class="cls_004"><span class="cls_004">import tag also supports including scripts that reside in the repository. Note that</span></div>
<div style="position:absolute;left:104.69px;top:311.09px" class="cls_004"><span class="cls_004">the import tag is not native to the Rhino JavaScript implementation. Beware,</span></div>
<div style="position:absolute;left:104.69px;top:323.69px" class="cls_004"><span class="cls_004">though. Alfresco compiles all imported JavaScript files into a single file and gives</span></div>
<div style="position:absolute;left:104.69px;top:336.29px" class="cls_004"><span class="cls_004">that to Rhino. So, when there is an error, the line number Rhino reports is from</span></div>
<div style="position:absolute;left:104.69px;top:348.89px" class="cls_004"><span class="cls_004">the compiled set of JavaScript files, which could be hard to map back to the line</span></div>
<div style="position:absolute;left:104.69px;top:361.49px" class="cls_004"><span class="cls_004">number in the original JavaScript source.</span></div>
<div style="position:absolute;left:104.69px;top:376.25px" class="cls_004"><span class="cls_004">The controller builds a new array for the whitepaper search results. You could</span></div>
<div style="position:absolute;left:104.69px;top:388.85px" class="cls_004"><span class="cls_004">have just set </span><span class="cls_013">model.whitepapers</span><span class="cls_004">to the whitepapers variable that contains the</span></div>
<div style="position:absolute;left:104.69px;top:402.13px" class="cls_004"><span class="cls_004">query results, but in this case, you built a new array and set that to the model.</span></div>
<div style="position:absolute;left:104.69px;top:414.73px" class="cls_004"><span class="cls_004">You did that because you needed to incorporate a specific user's rating, if one</span></div>
<div style="position:absolute;left:104.69px;top:427.33px" class="cls_004"><span class="cls_004">exists, that isn't part of the whitepaper nodes in the query result set.</span></div>
<div style="position:absolute;left:104.69px;top:442.09px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">getUserRating</span><span class="cls_004"> function in </span><span class="cls_013">rating.js</span><span class="cls_004"> looks for ratings specific to a</span></div>
<div style="position:absolute;left:104.69px;top:455.37px" class="cls_004"><span class="cls_004">particular user by querying the children using an XPath expression (shown as</span></div>
<div style="position:absolute;left:104.69px;top:467.97px" class="cls_004"><span class="cls_004">follows). XPath can be used to navigate through elements in a XML document.</span></div>
<div style="position:absolute;left:104.69px;top:480.57px" class="cls_004"><span class="cls_004">For more information on XPath, see </span><a href="https://www.w3.org/TR/xpath/">https://www.w3.org/TR/xpath/</a> <span class="cls_004">. The</span></div>
<div style="position:absolute;left:104.69px;top:493.55px" class="cls_004"><span class="cls_004">expression asks for any child of the current node with the </span><span class="cls_013">sc:rater</span><span class="cls_004"> property set</span></div>
<div style="position:absolute;left:104.69px;top:506.83px" class="cls_004"><span class="cls_004">to the name of the user passed in to the function:</span></div>
<div style="position:absolute;left:117.89px;top:530.04px" class="cls_010"><span class="cls_010">var results = curNode.childrenByXPath("*//.[@sc:rater='"</span></div>
<div style="position:absolute;left:128.69px;top:540.84px" class="cls_010"><span class="cls_010">+ curUser + "']");</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 285 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:202800px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background301.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">The FreeMarker template that renders the JSON response includes output that</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">needs to be escaped. Both the title and the description could potentially contain</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">characters that would make the JSON invalid (such as a quote). To address that,</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">the code uses the FreeMarker built-in </span><span class="cls_013">js_string </span><span class="cls_004">to escape the string, as follows:</span></div>
<div style="position:absolute;left:117.89px;top:132.19px" class="cls_010"><span class="cls_010">"title" : "${child.whitepaper.properties["cm:title"]?js_string}"</span></div>
<div style="position:absolute;left:104.69px;top:152.80px" class="cls_004"><span class="cls_004">The FreeMarker templates that renders both the JSON and HTML may generate</span></div>
<div style="position:absolute;left:104.69px;top:165.40px" class="cls_004"><span class="cls_004">errors if you don't have the rating aspect applied to them. It's why we added</span></div>
<div style="position:absolute;left:104.69px;top:178.00px" class="cls_004"><span class="cls_004">some default values if the property doesn't exist as follows:</span></div>
<div style="position:absolute;left:123.29px;top:201.21px" class="cls_010"><span class="cls_010">${child.rating.average!0}</span></div>
<div style="position:absolute;left:56.69px;top:236.79px" class="cls_014"><span class="cls_014">Organizing web scripts</span></div>
<div style="position:absolute;left:56.69px;top:262.01px" class="cls_004"><span class="cls_004">The Web Script Framework allows you to organize script assets into a hierarchical folder or</span></div>
<div style="position:absolute;left:56.69px;top:274.61px" class="cls_004"><span class="cls_004">package structure. Just as it is with Java, it is a good idea to do this for all web scripts. That's</span></div>
<div style="position:absolute;left:56.69px;top:287.21px" class="cls_004"><span class="cls_004">because the number of web scripts your installation leverages is going to grow over time as</span></div>
<div style="position:absolute;left:56.69px;top:299.81px" class="cls_004"><span class="cls_004">you, Alfresco, and third parties add more functionality. Following a reverse domain name</span></div>
<div style="position:absolute;left:56.69px;top:312.41px" class="cls_004"><span class="cls_004">pattern is a good convention and is consistent with how Alfresco organizes its scripts. It's</span></div>
<div style="position:absolute;left:56.69px;top:325.01px" class="cls_004"><span class="cls_004">why we organized our web script in the folder </span><span class="cls_013">com</span><span class="cls_004"> | </span><span class="cls_013">someco</span><span class="cls_004"> | </span><span class="cls_013">whitepapers</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:347.29px" class="cls_004"><span class="cls_004">Alfresco reserves certain package names for its own use. These may change over time, so</span></div>
<div style="position:absolute;left:56.69px;top:359.89px" class="cls_004"><span class="cls_004">consult the documentation website for the specific list. But if you steer clear of using</span></div>
<div style="position:absolute;left:56.69px;top:372.49px" class="cls_013"><span class="cls_013">org/alfresco</span><span class="cls_004">, you'll probably be fine.</span></div>
<div style="position:absolute;left:56.69px;top:409.87px" class="cls_014"><span class="cls_014">Overriding web scripts</span></div>
<div style="position:absolute;left:56.69px;top:435.09px" class="cls_004"><span class="cls_004">Alfresco searches for web scripts in the following order:</span></div>
<div style="position:absolute;left:91.32px;top:456.82px" class="cls_004"><span class="cls_004">1. In the repository under </span><span class="cls_007">Company Home</span><span class="cls_004"> | </span><span class="cls_007">Data Dictionary</span><span class="cls_004"> | </span><span class="cls_007">Web Scripts</span></div>
<div style="position:absolute;left:104.69px;top:469.46px" class="cls_007"><span class="cls_007">Extensions</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:484.26px" class="cls_004"><span class="cls_004">2. In the repository under </span><span class="cls_007">Company Home</span><span class="cls_004"> | </span><span class="cls_007">DataDictionary</span><span class="cls_004"> | </span><span class="cls_007">Web Scripts</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:499.05px" class="cls_004"><span class="cls_004">3. In the classpath under </span><span class="cls_007">alfresco</span><span class="cls_004"> | </span><span class="cls_007">extension</span><span class="cls_004"> | </span><span class="cls_007">templates</span><span class="cls_004"> | </span><span class="cls_007">webscripts</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:513.85px" class="cls_004"><span class="cls_004">4. In the classpath under </span><span class="cls_007">alfresco</span><span class="cls_004"> | </span><span class="cls_007">templates</span><span class="cls_004"> | </span><span class="cls_007">webscripts</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 286 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:203476px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background302.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you want to override an existing web script, just make sure your web script is found first.</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">In addition to overriding an entire web script, you can override components of a web script.</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">For example, suppose a web script in the </span><span class="cls_013">WebScripts</span><span class="cls_004"> folder has something in its JavaScript</span></div>
<div style="position:absolute;left:56.69px;top:108.98px" class="cls_004"><span class="cls_004">controller you want to override. You can add the controller to the </span><span class="cls_013">WebScriptsExtensions</span></div>
<div style="position:absolute;left:56.69px;top:122.26px" class="cls_004"><span class="cls_004">folder in the same package folder structure to override the lower-level controller.</span></div>
<div style="position:absolute;left:56.69px;top:158.96px" class="cls_014"><span class="cls_014">Choosing a URL</span></div>
<div style="position:absolute;left:56.69px;top:184.18px" class="cls_004"><span class="cls_004">URLs can follow any pattern you want. Because the URL pattern must be unique to a given</span></div>
<div style="position:absolute;left:56.69px;top:196.78px" class="cls_004"><span class="cls_004">web application, it makes sense to use the package name partially or completely. For</span></div>
<div style="position:absolute;left:56.69px;top:209.38px" class="cls_004"><span class="cls_004">SomeCo, the convention will be to use </span><span class="cls_013">someco</span><span class="cls_004"> in all URLs, assuming the default Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:222.66px" class="cls_004"><span class="cls_004">web application name hasn't been changed. This means that when using HTTP, SomeCo's</span></div>
<div style="position:absolute;left:56.69px;top:235.26px" class="cls_004"><span class="cls_004">web script URLs will look like this:</span></div>
<div style="position:absolute;left:74.69px;top:256.18px" class="cls_010"><span class="cls_010">/alfresco/service/someco/[web script name].[format]?[arguments]</span></div>
<div style="position:absolute;left:56.69px;top:276.66px" class="cls_004"><span class="cls_004">They could also look like this (</span><span class="cls_013">s</span><span class="cls_004"> is just a shortcut for </span><span class="cls_013">service</span><span class="cls_004">):</span></div>
<div style="position:absolute;left:74.69px;top:298.26px" class="cls_010"><span class="cls_010">/alfresco/s/someco/[web script name].[format]?[arguments]</span></div>
<div style="position:absolute;left:56.69px;top:318.74px" class="cls_004"><span class="cls_004">Within a web script, you can use </span><span class="cls_013">${url.serviceContext}</span><span class="cls_004"> to refer to the </span><span class="cls_013">service</span></div>
<div style="position:absolute;left:56.69px;top:332.02px" class="cls_013"><span class="cls_013">context</span><span class="cls_004"> component of the URL to avoid hardcoding within references to other web scripts.</span></div>
<div style="position:absolute;left:56.69px;top:345.30px" class="cls_004"><span class="cls_004">Be aware that you have other prefixes as </span><span class="cls_013">wcs</span><span class="cls_004"> and </span><span class="cls_013">wcservice</span><span class="cls_004"> that are used mainly by if you</span></div>
<div style="position:absolute;left:56.69px;top:358.58px" class="cls_004"><span class="cls_004">use SSO.</span></div>
<div style="position:absolute;left:56.69px;top:380.18px" class="cls_004"><span class="cls_004">Just like packages, Alfresco already has several URLs mapped to web scripts.</span></div>
<div style="position:absolute;left:56.69px;top:392.78px" class="cls_004"><span class="cls_004">Unfortunately, they don't follow a strict pattern. If your URLs don't incorporate a unique</span></div>
<div style="position:absolute;left:56.69px;top:405.38px" class="cls_004"><span class="cls_004">string, you may want to do a recursive search through the descriptor XML files in the</span></div>
<div style="position:absolute;left:56.69px;top:417.98px" class="cls_004"><span class="cls_004">source or browse the web script directory by URL</span></div>
<div style="position:absolute;left:56.69px;top:430.58px" class="cls_004"><span class="cls_004">(</span><a href="http://localhost:8080/alfresco/service/index/uri/">http://localhost:8080/alfresco/service/index/uri/</a> <span class="cls_004">) to make sure your URLs</span></div>
<div style="position:absolute;left:56.69px;top:443.86px" class="cls_004"><span class="cls_004">are easily distinguishable from Alfresco's.</span></div>
<div style="position:absolute;left:56.69px;top:480.56px" class="cls_014"><span class="cls_014">Choosing between the repository and the</span></div>
<div style="position:absolute;left:56.69px;top:502.16px" class="cls_014"><span class="cls_014">classpath</span></div>
<div style="position:absolute;left:56.69px;top:527.38px" class="cls_004"><span class="cls_004">You ran the Hello World web script out of the repository. The whitepaper listing ran out of</span></div>
<div style="position:absolute;left:56.69px;top:539.98px" class="cls_004"><span class="cls_004">the classpath. There are trade-offs to consider with each approach.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 287 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:204152px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background303.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The advantage of using the classpath is that the web scripts that make up your solution can</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">be deployed alongside your other extensions. This can be done using the same deployment</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">tools without requiring the extra step of uploading them to the repository.</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">The trade-off is that it is a little more work to edit the web scripts when they need to be</span></div>
<div style="position:absolute;left:56.69px;top:129.90px" class="cls_004"><span class="cls_004">changed. If they are stored in the repository, they can be easily edited just like any other</span></div>
<div style="position:absolute;left:56.69px;top:142.50px" class="cls_004"><span class="cls_004">piece of content. If they are stored in your source code control system and deployed with</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">the rest of your customizations, it's a little more work to make a change. Whether or not you</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">consider this an advantage or a disadvantage depends on the team supporting the solution</span></div>
<div style="position:absolute;left:56.69px;top:180.30px" class="cls_004"><span class="cls_004">and the development processes you like to use.</span></div>
<div style="position:absolute;left:56.69px;top:201.90px" class="cls_004"><span class="cls_004">If scripts are defined in the repository as well as the classpath, the files in the repository take</span></div>
<div style="position:absolute;left:56.69px;top:214.51px" class="cls_004"><span class="cls_004">precedence over the files on the classpath, as mentioned in </span><span class="cls_012">Overriding Web Scripts</span><span class="cls_004"> section.</span></div>
<div style="position:absolute;left:56.69px;top:251.21px" class="cls_014"><span class="cls_014">Step-by-step - retrieving the rating for a</span></div>
<div style="position:absolute;left:56.69px;top:272.81px" class="cls_014"><span class="cls_014">whitepaper</span></div>
<div style="position:absolute;left:56.69px;top:298.03px" class="cls_004"><span class="cls_004">Getting a specific rating is roughly the same as getting a whitepaper. A controller searches</span></div>
<div style="position:absolute;left:56.69px;top:310.63px" class="cls_004"><span class="cls_004">for ratings and stores them in the model, then two response templates (one for HTML and</span></div>
<div style="position:absolute;left:56.69px;top:323.23px" class="cls_004"><span class="cls_004">one for JSON) are used to return the data in the appropriate format.</span></div>
<div style="position:absolute;left:56.69px;top:344.83px" class="cls_004"><span class="cls_004">To create a web script that retrieves a rating for a specific whitepaper, do the following:</span></div>
<div style="position:absolute;left:91.32px;top:366.56px" class="cls_004"><span class="cls_004">1. The descriptor and response templates are very similar to the whitepaper</span></div>
<div style="position:absolute;left:104.69px;top:379.16px" class="cls_004"><span class="cls_004">example. Create a new descriptor called </span><span class="cls_013">rating.get.desc.xml</span><span class="cls_004"> in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:392.44px" class="cls_013"><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">extension</span><span class="cls_004"> | </span><span class="cls_013">templates</span><span class="cls_004"> | </span><span class="cls_013">webscripts</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:405.72px" class="cls_013"><span class="cls_013">com</span><span class="cls_004"> | </span><span class="cls_013">someco</span><span class="cls_004"> | </span><span class="cls_013">ratings</span><span class="cls_004"> as follows:</span></div>
<div style="position:absolute;left:107.09px;top:429.61px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:123.29px;top:440.41px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Get Content Rating&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:123.29px;top:451.21px" class="cls_010"><span class="cls_010">&lt;description&gt;Returns rating data for the specified</span></div>
<div style="position:absolute;left:139.49px;top:462.01px" class="cls_010"><span class="cls_010">node&lt;/description&gt;</span></div>
<div style="position:absolute;left:123.29px;top:472.81px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/rating?id={id}&amp;user={user?}&lt;/url&gt;</span></div>
<div style="position:absolute;left:123.29px;top:483.61px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/rating.json?id={id}&amp;user={user?}&lt;/url&gt;</span></div>
<div style="position:absolute;left:123.29px;top:494.41px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/rating.html?id={id}&amp;user={user?}&lt;/url&gt;</span></div>
<div style="position:absolute;left:123.29px;top:505.21px" class="cls_010"><span class="cls_010">&lt;format default="json"&gt;extension&lt;/format&gt;</span></div>
<div style="position:absolute;left:123.29px;top:516.01px" class="cls_010"><span class="cls_010">&lt;authenticationrunas="admin"&gt;guest&lt;/authentication&gt;</span></div>
<div style="position:absolute;left:123.29px;top:526.81px" class="cls_010"><span class="cls_010">&lt;transaction&gt;none&lt;/transaction&gt;</span></div>
<div style="position:absolute;left:107.09px;top:537.61px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 288 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:204828px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background304.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Retrieving the rating for a whitepaper is a bit easier because of the existing</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">getRating</span><span class="cls_004"> function in </span><span class="cls_013">rating.js</span><span class="cls_004">. All the controller has to do is grab the node</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">ID of the whitepaper in question, locate the node, and then call the </span><span class="cls_013">getRating</span></div>
<div style="position:absolute;left:104.69px;top:109.66px" class="cls_004"><span class="cls_004">function. Create a new controller in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:122.94px" class="cls_013"><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">extension</span><span class="cls_004"> | </span><span class="cls_013">templates</span><span class="cls_004"> | </span><span class="cls_013">webscripts</span><span class="cls_004"> | </span><span class="cls_013">com</span><span class="cls_004"> | </span><span class="cls_013">someco</span><span class="cls_004"> | </span><span class="cls_013">ratings</span></div>
<div style="position:absolute;left:104.69px;top:136.22px" class="cls_004"><span class="cls_004">called </span><span class="cls_013">rating.get.js</span><span class="cls_004">, as shown here:</span></div>
<div style="position:absolute;left:107.09px;top:160.11px" class="cls_010"><span class="cls_010">&lt;import resource="classpath:alfresco/extension/scripts/rating.js"&gt;</span></div>
<div style="position:absolute;left:123.29px;top:181.71px" class="cls_010"><span class="cls_010">if (args.id == null || args.id.length == 0) {</span></div>
<div style="position:absolute;left:139.49px;top:192.51px" class="cls_010"><span class="cls_010">logger.log("ID arg not set");</span></div>
<div style="position:absolute;left:139.49px;top:203.31px" class="cls_010"><span class="cls_010">status.code = 400;</span></div>
<div style="position:absolute;left:139.49px;top:214.11px" class="cls_010"><span class="cls_010">status.message = "Node ID has not been provided";</span></div>
<div style="position:absolute;left:139.49px;top:224.91px" class="cls_010"><span class="cls_010">status.redirect = true;</span></div>
<div style="position:absolute;left:123.29px;top:235.71px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:139.49px;top:257.31px" class="cls_010"><span class="cls_010">varcurNode =</span></div>
<div style="position:absolute;left:150.29px;top:268.11px" class="cls_010"><span class="cls_010">search.findNode("workspace://SpacesStore/"+ args.id);</span></div>
<div style="position:absolute;left:139.49px;top:278.91px" class="cls_010"><span class="cls_010">if (curNode == null) {</span></div>
<div style="position:absolute;left:155.69px;top:289.71px" class="cls_010"><span class="cls_010">logger.log("Node not found");</span></div>
<div style="position:absolute;left:155.69px;top:300.51px" class="cls_010"><span class="cls_010">status.code = 404;</span></div>
<div style="position:absolute;left:155.69px;top:311.31px" class="cls_010"><span class="cls_010">status.message = "No node found for id:" + args.id;</span></div>
<div style="position:absolute;left:155.69px;top:322.11px" class="cls_010"><span class="cls_010">status.redirect = true;</span></div>
<div style="position:absolute;left:139.49px;top:332.91px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:155.69px;top:343.71px" class="cls_010"><span class="cls_010">model.rating = getRating(curNode, args.user);</span></div>
<div style="position:absolute;left:139.49px;top:354.51px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:123.29px;top:365.31px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:385.92px" class="cls_004"><span class="cls_004">3. Create a response template called </span><span class="cls_013">rating.get.json.ftl</span><span class="cls_004"> that retrieves rating</span></div>
<div style="position:absolute;left:104.69px;top:399.20px" class="cls_004"><span class="cls_004">data from the model and outputs a JSON </span><span class="cls_013">rating</span><span class="cls_004"> object:</span></div>
<div style="position:absolute;left:107.09px;top:423.09px" class="cls_010"><span class="cls_010">{"rating" :</span></div>
<div style="position:absolute;left:150.29px;top:433.89px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:155.69px;top:444.69px" class="cls_010"><span class="cls_010">"average" : "${rating.average}",</span></div>
<div style="position:absolute;left:155.69px;top:455.49px" class="cls_010"><span class="cls_010">"count" : "${rating.count}",</span></div>
<div style="position:absolute;left:155.69px;top:466.29px" class="cls_010"><span class="cls_010">"user" : "${rating.user}"</span></div>
<div style="position:absolute;left:150.29px;top:477.09px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:107.09px;top:487.89px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 289 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:205504px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background305.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Create a response template called </span><span class="cls_013">rating.get.html.ftl</span><span class="cls_004">. In a later example,</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">you're going to incorporate a graphical ratings widget into this page. You'll use</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">the HTML page this response template creates to test the widget. For now, just</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">output the ratings data and provide a link to get back to the whitepaper list:</span></div>
<div style="position:absolute;left:107.09px;top:132.19px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:123.29px;top:142.99px" class="cls_010"><span class="cls_010">&lt;head&gt;</span></div>
<div style="position:absolute;left:123.29px;top:153.79px" class="cls_010"><span class="cls_010">&lt;/head&gt;</span></div>
<div style="position:absolute;left:123.29px;top:164.59px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:139.49px;top:175.39px" class="cls_010"><span class="cls_010">&lt;script type="text/javascript"&gt;</span></div>
<div style="position:absolute;left:166.49px;top:186.19px" class="cls_010"><span class="cls_010">function deleteRatings(id) {</span></div>
<div style="position:absolute;left:177.29px;top:196.99px" class="cls_010"><span class="cls_010">alert("Not yet implemented");</span></div>
<div style="position:absolute;left:166.49px;top:207.79px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:218.59px" class="cls_010"><span class="cls_010">&lt;/script&gt;</span></div>
<div style="position:absolute;left:139.49px;top:240.19px" class="cls_010"><span class="cls_010">&lt;p&gt;</span></div>
<div style="position:absolute;left:150.29px;top:250.99px" class="cls_010"><span class="cls_010">&lt;a href="${url.serviceContext}/someco</span></div>
<div style="position:absolute;left:155.69px;top:261.79px" class="cls_010"><span class="cls_010">/whitepapers.html?guest=true"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:272.59px" class="cls_010"><span class="cls_010">Back to the list&lt;/a&gt; of whitepapers&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:283.39px" class="cls_010"><span class="cls_010">&lt;p&gt;Node: ${args.id}&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:294.19px" class="cls_010"><span class="cls_010">&lt;p&gt;Average: ${rating.average}&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:304.99px" class="cls_010"><span class="cls_010">&lt;p&gt;# of Ratings: ${rating.count}&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:315.79px" class="cls_010"><span class="cls_010">&lt;#if (rating.user&gt; 0)&gt;</span></div>
<div style="position:absolute;left:155.69px;top:326.59px" class="cls_010"><span class="cls_010">&lt;p&gt;User rating: ${rating.user}&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:337.39px" class="cls_010"><span class="cls_010">&lt;/#if&gt;</span></div>
<div style="position:absolute;left:139.49px;top:348.19px" class="cls_010"><span class="cls_010">&lt;p&gt;</span></div>
<div style="position:absolute;left:155.69px;top:358.99px" class="cls_010"><span class="cls_010">&lt;a href="#" onclick=deleteRatings</span></div>
<div style="position:absolute;left:161.09px;top:369.79px" class="cls_010"><span class="cls_010">("${args.id}")&gt;Delete ratings&lt;/a&gt;</span></div>
<div style="position:absolute;left:161.09px;top:380.59px" class="cls_010"><span class="cls_010">for this node</span></div>
<div style="position:absolute;left:139.49px;top:391.39px" class="cls_010"><span class="cls_010">&lt;/p&gt;</span></div>
<div style="position:absolute;left:123.29px;top:402.19px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:107.09px;top:412.99px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:433.60px" class="cls_004"><span class="cls_004">5. Package, deploy, and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 290 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:206180px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background306.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Point your browser at the whitepapers web script. Click the </span><span class="cls_007">Rating</span><span class="cls_004"> link. The </span><span class="cls_007">Rating</span><span class="cls_004"> link</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">invokes the web script you just created. You should see this:</span></div>
<div style="position:absolute;left:56.69px;top:255.66px" class="cls_004"><span class="cls_004">Test out the JSON response by replacing the </span><span class="cls_013">html</span><span class="cls_004"> string in the URL with </span><span class="cls_013">json</span><span class="cls_004">. The rating</span></div>
<div style="position:absolute;left:56.69px;top:268.94px" class="cls_004"><span class="cls_004">service should return something similar to this:</span></div>
<div style="position:absolute;left:56.69px;top:444.56px" class="cls_014"><span class="cls_014">Specifying optional arguments</span></div>
<div style="position:absolute;left:56.69px;top:469.78px" class="cls_004"><span class="cls_004">Did you catch the new twist in the URL declaration for this web script? Here it is again:</span></div>
<div style="position:absolute;left:74.69px;top:490.70px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/rating?id={id}&amp;user={user?}&lt;/url&gt;</span></div>
<div style="position:absolute;left:56.69px;top:511.18px" class="cls_004"><span class="cls_004">The question mark in the </span><span class="cls_013">user</span><span class="cls_004"> value placeholder declares the argument as optional. Using</span></div>
<div style="position:absolute;left:56.69px;top:524.46px" class="cls_004"><span class="cls_004">the optional indicator is, well, optional. Alfresco does not enforce mandatory parameters,</span></div>
<div style="position:absolute;left:56.69px;top:537.06px" class="cls_004"><span class="cls_004">and it doesn't care if you provide an argument that isn't declared. You may have noticed</span></div>
<div style="position:absolute;left:56.69px;top:549.66px" class="cls_004"><span class="cls_004">that the whitepaper script will show the user's last rating if you pass the </span><span class="cls_013">user</span><span class="cls_004"> argument in,</span></div>
<div style="position:absolute;left:56.69px;top:562.94px" class="cls_004"><span class="cls_004">even though you may not have included it in the URL declaration.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 291 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:206856px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background307.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">At some point, Alfresco may start enforcing that web script calls should match the declared</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">URL. Or it might start generating documentation based on the descriptor. So, you might as</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">well get in the habit of declaring all of your arguments now. Plus, in the absence of</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">automatically generated documentation, the descriptor is what people will use to figure out</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">how to call your web script (no matter how much time you spend crafting documentation</span></div>
<div style="position:absolute;left:56.69px;top:133.50px" class="cls_004"><span class="cls_004">elsewhere).</span></div>
<div style="position:absolute;left:56.69px;top:170.20px" class="cls_014"><span class="cls_014">Handling errors</span></div>
<div style="position:absolute;left:56.69px;top:195.42px" class="cls_004"><span class="cls_004">In both the whitepapers example and the ratings example, you probably noticed some error</span></div>
<div style="position:absolute;left:56.69px;top:208.02px" class="cls_004"><span class="cls_004">handling code. For example, in the </span><span class="cls_013">rating.get.js</span><span class="cls_004"> file, if the whitepaper node cannot be</span></div>
<div style="position:absolute;left:56.69px;top:221.30px" class="cls_004"><span class="cls_004">located, the following code is executed:</span></div>
<div style="position:absolute;left:74.69px;top:242.22px" class="cls_010"><span class="cls_010">status.code = 404;</span></div>
<div style="position:absolute;left:74.69px;top:253.02px" class="cls_010"><span class="cls_010">status.message = "No node found for id:" + args.id;</span></div>
<div style="position:absolute;left:74.69px;top:263.82px" class="cls_010"><span class="cls_010">status.redirect = true;</span></div>
<div style="position:absolute;left:56.69px;top:284.30px" class="cls_004"><span class="cls_004">The response </span><span class="cls_013">code</span><span class="cls_004"> gets set to </span><span class="cls_013">404</span><span class="cls_004">, which is the standard HTTP response code for </span><span class="cls_013">Not</span></div>
<div style="position:absolute;left:56.69px;top:297.58px" class="cls_013"><span class="cls_013">Found</span><span class="cls_004">. An error message is set and the </span><span class="cls_013">redirect</span><span class="cls_004"> property is set to </span><span class="cls_013">true</span><span class="cls_004">, which tells the</span></div>
<div style="position:absolute;left:56.69px;top:310.86px" class="cls_004"><span class="cls_004">web script framework to </span><span class="cls_013">redirect</span><span class="cls_004"> the response to the error handling templates.</span></div>
<div style="position:absolute;left:56.69px;top:333.14px" class="cls_004"><span class="cls_004">For example, if you pass a bad node ID to the </span><span class="cls_013">rating.html</span><span class="cls_004"> web script, you'll get a</span></div>
<div style="position:absolute;left:56.69px;top:346.42px" class="cls_004"><span class="cls_004">response that looks like this:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 292 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:207532px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background308.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Similarly, if you pass a bad node ID to the </span><span class="cls_013">rating.json</span><span class="cls_004"> web script (the same script with a</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">different response format), the JSON that comes back will be as follows:</span></div>
<div style="position:absolute;left:56.69px;top:311.05px" class="cls_004"><span class="cls_004">Getting an error back in the request response format is nice. The calling code can handle</span></div>
<div style="position:absolute;left:56.69px;top:323.65px" class="cls_004"><span class="cls_004">errors more gracefully when it knows the format that will come back, even when exceptions</span></div>
<div style="position:absolute;left:56.69px;top:336.25px" class="cls_004"><span class="cls_004">are thrown.</span></div>
<div style="position:absolute;left:56.69px;top:357.85px" class="cls_004"><span class="cls_004">The examples show the standard response template for error codes. Depending on the</span></div>
<div style="position:absolute;left:56.69px;top:370.45px" class="cls_004"><span class="cls_004">solution you are building it might make more sense to customize these, whether simply for</span></div>
<div style="position:absolute;left:56.69px;top:383.05px" class="cls_004"><span class="cls_004">look-and-feel or because you want to structure the response differently. You can override</span></div>
<div style="position:absolute;left:56.69px;top:395.65px" class="cls_004"><span class="cls_004">the standard error templates with your own by creating FreeMarker files that follow a</span></div>
<div style="position:absolute;left:56.69px;top:408.25px" class="cls_004"><span class="cls_004">specific naming convention. When an error occurs, the framework attempts to find a</span></div>
<div style="position:absolute;left:56.69px;top:420.85px" class="cls_004"><span class="cls_004">template specific to the HTTP method, response format, and error code. If one does not</span></div>
<div style="position:absolute;left:56.69px;top:433.45px" class="cls_004"><span class="cls_004">exist, it looks for a more general fit until it ultimately reaches the default </span><span class="cls_013">status.ftl</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 293 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:208208px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background309.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The following table shows the naming convention and location for error templates</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">beginning with the most specific case and ending with the most general:</span></div>
<div style="position:absolute;left:58.99px;top:107.07px" class="cls_037"><span class="cls_037">Naming convention</span></div>
<div style="position:absolute;left:211.54px;top:107.07px" class="cls_037"><span class="cls_037">Location</span></div>
<div style="position:absolute;left:319.74px;top:107.07px" class="cls_037"><span class="cls_037">Example</span></div>
<div style="position:absolute;left:441.84px;top:107.07px" class="cls_037"><span class="cls_037">What it does</span></div>
<div style="position:absolute;left:58.99px;top:118.33px" class="cls_038"><span class="cls_038">&lt;scriptid&gt;.&lt;method&gt;.&lt;format&gt;.&lt;code&gt;.ftl</span></div>
<div style="position:absolute;left:211.54px;top:118.83px" class="cls_039"><span class="cls_039">Same as descriptor</span></div>
<div style="position:absolute;left:319.74px;top:118.33px" class="cls_038"><span class="cls_038">whitepapers.get.html.404.ftl</span></div>
<div style="position:absolute;left:441.84px;top:118.83px" class="cls_039"><span class="cls_039">Displays</span></div>
<div style="position:absolute;left:441.84px;top:126.44px" class="cls_039"><span class="cls_039">when a GET</span></div>
<div style="position:absolute;left:441.84px;top:134.06px" class="cls_039"><span class="cls_039">request for an</span></div>
<div style="position:absolute;left:441.84px;top:141.67px" class="cls_039"><span class="cls_039">HTML</span></div>
<div style="position:absolute;left:441.84px;top:149.28px" class="cls_039"><span class="cls_039">response of</span></div>
<div style="position:absolute;left:441.84px;top:156.89px" class="cls_039"><span class="cls_039">the</span></div>
<div style="position:absolute;left:441.84px;top:164.50px" class="cls_039"><span class="cls_039">whitepapers</span></div>
<div style="position:absolute;left:441.84px;top:172.11px" class="cls_039"><span class="cls_039">script returns</span></div>
<div style="position:absolute;left:441.84px;top:179.72px" class="cls_039"><span class="cls_039">a 404 error.</span></div>
<div style="position:absolute;left:58.99px;top:190.96px" class="cls_038"><span class="cls_038">&lt;scriptid&gt;.&lt;method&gt;.&lt;format&gt;.status.ftl</span></div>
<div style="position:absolute;left:211.54px;top:191.46px" class="cls_039"><span class="cls_039">Same as descriptor</span></div>
<div style="position:absolute;left:319.74px;top:190.96px" class="cls_038"><span class="cls_038">whitepapers.get.html.status.ftl</span></div>
<div style="position:absolute;left:441.84px;top:191.46px" class="cls_039"><span class="cls_039">Displays</span></div>
<div style="position:absolute;left:441.84px;top:199.07px" class="cls_039"><span class="cls_039">when a GET</span></div>
<div style="position:absolute;left:441.84px;top:206.68px" class="cls_039"><span class="cls_039">request for an</span></div>
<div style="position:absolute;left:441.84px;top:214.30px" class="cls_039"><span class="cls_039">HTML</span></div>
<div style="position:absolute;left:441.84px;top:221.91px" class="cls_039"><span class="cls_039">response of</span></div>
<div style="position:absolute;left:441.84px;top:229.52px" class="cls_039"><span class="cls_039">the</span></div>
<div style="position:absolute;left:441.84px;top:237.13px" class="cls_039"><span class="cls_039">whitepapers</span></div>
<div style="position:absolute;left:441.84px;top:244.74px" class="cls_039"><span class="cls_039">script returns</span></div>
<div style="position:absolute;left:441.84px;top:252.35px" class="cls_039"><span class="cls_039">an error.</span></div>
<div style="position:absolute;left:58.99px;top:263.59px" class="cls_038"><span class="cls_038">&lt;format&gt;.&lt;code&gt;.ftl</span></div>
<div style="position:absolute;left:211.54px;top:264.09px" class="cls_039"><span class="cls_039">Package hierarchy</span></div>
<div style="position:absolute;left:319.74px;top:263.59px" class="cls_038"><span class="cls_038">html.404.ftl</span></div>
<div style="position:absolute;left:441.84px;top:264.09px" class="cls_039"><span class="cls_039">Displays for</span></div>
<div style="position:absolute;left:441.84px;top:271.70px" class="cls_039"><span class="cls_039">all HTML</span></div>
<div style="position:absolute;left:441.84px;top:279.32px" class="cls_039"><span class="cls_039">responses that</span></div>
<div style="position:absolute;left:441.84px;top:286.93px" class="cls_039"><span class="cls_039">return a 404.</span></div>
<div style="position:absolute;left:58.99px;top:298.17px" class="cls_038"><span class="cls_038">&lt;format&gt;.status.ftl</span></div>
<div style="position:absolute;left:211.54px;top:298.67px" class="cls_039"><span class="cls_039">Package hierarchy</span></div>
<div style="position:absolute;left:319.74px;top:298.17px" class="cls_038"><span class="cls_038">html.status.ftl</span></div>
<div style="position:absolute;left:441.84px;top:298.67px" class="cls_039"><span class="cls_039">Displays for</span></div>
<div style="position:absolute;left:441.84px;top:306.28px" class="cls_039"><span class="cls_039">all HTML</span></div>
<div style="position:absolute;left:441.84px;top:313.89px" class="cls_039"><span class="cls_039">responses that</span></div>
<div style="position:absolute;left:441.84px;top:321.50px" class="cls_039"><span class="cls_039">return any</span></div>
<div style="position:absolute;left:441.84px;top:329.11px" class="cls_039"><span class="cls_039">error.</span></div>
<div style="position:absolute;left:58.99px;top:340.35px" class="cls_038"><span class="cls_038">&lt;code&gt;.ftl</span></div>
<div style="position:absolute;left:211.54px;top:340.85px" class="cls_039"><span class="cls_039">WEB-INF/classes/alfresco/webscripts</span></div>
<div style="position:absolute;left:319.74px;top:340.35px" class="cls_038"><span class="cls_038">404.ftl</span></div>
<div style="position:absolute;left:441.84px;top:340.85px" class="cls_039"><span class="cls_039">Default error</span></div>
<div style="position:absolute;left:441.84px;top:348.46px" class="cls_039"><span class="cls_039">template for</span></div>
<div style="position:absolute;left:441.84px;top:356.07px" class="cls_039"><span class="cls_039">all 404 errors</span></div>
<div style="position:absolute;left:441.84px;top:363.69px" class="cls_039"><span class="cls_039">across all</span></div>
<div style="position:absolute;left:441.84px;top:371.30px" class="cls_039"><span class="cls_039">packages,</span></div>
<div style="position:absolute;left:441.84px;top:378.91px" class="cls_039"><span class="cls_039">scripts, and</span></div>
<div style="position:absolute;left:441.84px;top:386.52px" class="cls_039"><span class="cls_039">response</span></div>
<div style="position:absolute;left:441.84px;top:394.13px" class="cls_039"><span class="cls_039">formats.</span></div>
<div style="position:absolute;left:58.99px;top:405.37px" class="cls_038"><span class="cls_038">status.ftl</span></div>
<div style="position:absolute;left:211.54px;top:405.87px" class="cls_039"><span class="cls_039">WEB-INF/classes/alfresco/webscripts</span></div>
<div style="position:absolute;left:319.74px;top:405.37px" class="cls_038"><span class="cls_038">status.ftl</span></div>
<div style="position:absolute;left:441.84px;top:405.87px" class="cls_039"><span class="cls_039">Default, out-</span></div>
<div style="position:absolute;left:441.84px;top:413.48px" class="cls_039"><span class="cls_039">of-the-box</span></div>
<div style="position:absolute;left:441.84px;top:421.09px" class="cls_039"><span class="cls_039">error template</span></div>
<div style="position:absolute;left:441.84px;top:428.70px" class="cls_039"><span class="cls_039">for all errors.</span></div>
<div style="position:absolute;left:56.69px;top:461.96px" class="cls_004"><span class="cls_004">Error templates have access to the web script model and the FreeMarker API, like any other</span></div>
<div style="position:absolute;left:56.69px;top:474.56px" class="cls_004"><span class="cls_004">response template. Error templates in the package hierarchy have access to the </span><span class="cls_013">status</span><span class="cls_004"> root</span></div>
<div style="position:absolute;left:56.69px;top:487.84px" class="cls_004"><span class="cls_004">variable.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 294 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:208884px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background310.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Writing Java-backed web scripts</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">You now have a web script that returns all whitepapers, and a web script that returns the</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">rating summary for a specific whitepaper. The next step is to implement a web script that</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">supports the POST method so that people can submit new ratings.</span></div>
<div style="position:absolute;left:56.69px;top:144.18px" class="cls_004"><span class="cls_004">Like all web scripts, the web script that creates ratings will run as the user executing the</span></div>
<div style="position:absolute;left:56.69px;top:156.78px" class="cls_004"><span class="cls_004">script. In this case, you are appending </span><span class="cls_013">guest=true</span><span class="cls_004"> to the URL, but we will use the </span><span class="cls_013">runAs</span></div>
<div style="position:absolute;left:56.69px;top:170.06px" class="cls_004"><span class="cls_004">property in the web script descriptor to run the code using the username </span><span class="cls_013">admin</span><span class="cls_004">. Another</span></div>
<div style="position:absolute;left:56.69px;top:183.34px" class="cls_004"><span class="cls_004">way to handle this would be to set the web script's minimum authentication level to </span><span class="cls_013">User</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:196.62px" class="cls_004"><span class="cls_004">give named users (or one or more groups) write access to the whitepapers folder, and make</span></div>
<div style="position:absolute;left:56.69px;top:209.22px" class="cls_004"><span class="cls_004">website users authenticated. But SomeCo doesn't want to set up user accounts for every</span></div>
<div style="position:absolute;left:56.69px;top:221.82px" class="cls_004"><span class="cls_004">user who might rate content. Any user ought to be able to rate content whether or not he or</span></div>
<div style="position:absolute;left:56.69px;top:234.42px" class="cls_004"><span class="cls_004">she can authenticate with Alfresco as a named user. So, we'll use the </span><span class="cls_013">runAs</span><span class="cls_004"> option. In this</span></div>
<div style="position:absolute;left:56.69px;top:247.70px" class="cls_004"><span class="cls_004">example, you'll use </span><span class="cls_013">admin</span><span class="cls_004"> as that user. In production, using a user account dedicated to the</span></div>
<div style="position:absolute;left:56.69px;top:260.98px" class="cls_004"><span class="cls_004">purpose of creating ratings is a better idea.</span></div>
<div style="position:absolute;left:122.09px;top:282.58px" class="cls_004"><span class="cls_004">JavaScript or Java controllers? All of the HTTP methods are supported</span></div>
<div style="position:absolute;left:122.09px;top:295.18px" class="cls_004"><span class="cls_004">using either API. The JavaScript API is getting more powerful with each</span></div>
<div style="position:absolute;left:122.09px;top:307.78px" class="cls_004"><span class="cls_004">release. But in this case, the JavaScript API just doesn't support what's</span></div>
<div style="position:absolute;left:122.09px;top:320.38px" class="cls_004"><span class="cls_004">required. Obviously, you can choose what's right for your organization</span></div>
<div style="position:absolute;left:122.09px;top:332.98px" class="cls_004"><span class="cls_004">and the task at hand. Some companies choose to standardize on Java</span></div>
<div style="position:absolute;left:122.09px;top:345.58px" class="cls_004"><span class="cls_004">controllers across the board. Others prefer the speed of development</span></div>
<div style="position:absolute;left:122.09px;top:358.18px" class="cls_004"><span class="cls_004">afforded by JavaScript, using Java only when JavaScript doesn't suffice.</span></div>
<div style="position:absolute;left:56.69px;top:394.88px" class="cls_014"><span class="cls_014">Step-by-step - writing a Java-backed web script</span></div>
<div style="position:absolute;left:56.69px;top:416.48px" class="cls_014"><span class="cls_014">to handle ratings posts</span></div>
<div style="position:absolute;left:56.69px;top:441.70px" class="cls_004"><span class="cls_004">Let's write a new web script for ratings that handles the </span><span class="cls_013">POST</span><span class="cls_004"> method to create new rating</span></div>
<div style="position:absolute;left:56.69px;top:454.98px" class="cls_004"><span class="cls_004">objects for a specific whitepaper. Like the web scripts you've seen so far, this is going to</span></div>
<div style="position:absolute;left:56.69px;top:467.58px" class="cls_004"><span class="cls_004">involve a FreeMarker template and a descriptor, but instead of using JavaScript for a</span></div>
<div style="position:absolute;left:56.69px;top:480.18px" class="cls_004"><span class="cls_004">controller you are going to write a Java class. To let the Web Script Framework know about</span></div>
<div style="position:absolute;left:56.69px;top:492.78px" class="cls_004"><span class="cls_004">the Java class, you'll use a new Spring bean configuration file to declare which web script</span></div>
<div style="position:absolute;left:56.69px;top:505.38px" class="cls_004"><span class="cls_004">the controller class belongs to.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 295 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:209560px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background311.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:92.23px" class="cls_004"><span class="cls_004">1. First, create the descriptor in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:105.51px" class="cls_013"><span class="cls_013">extension</span><span class="cls_004"> | </span><span class="cls_013">templates</span><span class="cls_004"> | </span><span class="cls_013">webscripts</span><span class="cls_004"> | </span><span class="cls_013">com</span><span class="cls_004"> | </span><span class="cls_013">someco</span><span class="cls_004"> | </span><span class="cls_013">ratings</span><span class="cls_004">. This script</span></div>
<div style="position:absolute;left:104.69px;top:118.79px" class="cls_004"><span class="cls_004">handles the </span><span class="cls_013">POST</span><span class="cls_004"> method, so name the descriptor </span><span class="cls_013">rating.post.desc.xml</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:104.69px;top:132.07px" class="cls_004"><span class="cls_004">populate it as follows:</span></div>
<div style="position:absolute;left:117.89px;top:155.28px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:139.49px;top:166.08px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Post Content Rating&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:139.49px;top:176.88px" class="cls_010"><span class="cls_010">&lt;description&gt;Sets rating data for the specified</span></div>
<div style="position:absolute;left:150.29px;top:187.68px" class="cls_010"><span class="cls_010">node&lt;/description&gt;</span></div>
<div style="position:absolute;left:139.49px;top:198.48px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/rating&lt;/url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:209.28px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/rating.json&lt;/url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:220.08px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/rating.html&lt;/url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:230.88px" class="cls_010"><span class="cls_010">&lt;format default="json"&gt;extension&lt;/format&gt;</span></div>
<div style="position:absolute;left:139.49px;top:241.68px" class="cls_010"><span class="cls_010">&lt;authenticationrunas="admin"&gt;guest&lt;/authentication&gt;</span></div>
<div style="position:absolute;left:139.49px;top:252.48px" class="cls_010"><span class="cls_010">&lt;transaction&gt;requiresnew&lt;/transaction&gt;</span></div>
<div style="position:absolute;left:117.89px;top:263.28px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:91.32px;top:283.89px" class="cls_004"><span class="cls_004">2. The response templates simply echo back the node, rating, and user argument</span></div>
<div style="position:absolute;left:104.69px;top:296.49px" class="cls_004"><span class="cls_004">values that were used to create the new rating. Create the HTML response</span></div>
<div style="position:absolute;left:104.69px;top:309.09px" class="cls_004"><span class="cls_004">template called </span><span class="cls_013">rating.post.html.ftl</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:332.98px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:128.69px;top:343.78px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:161.09px;top:354.58px" class="cls_010"><span class="cls_010">&lt;p&gt;Successfully added rating:&lt;/p&gt;</span></div>
<div style="position:absolute;left:161.09px;top:365.38px" class="cls_010"><span class="cls_010">&lt;p&gt;Node:${node}&lt;/p&gt;</span></div>
<div style="position:absolute;left:161.09px;top:376.18px" class="cls_010"><span class="cls_010">&lt;p&gt;Rating:${rating}&lt;/p&gt;</span></div>
<div style="position:absolute;left:161.09px;top:386.98px" class="cls_010"><span class="cls_010">&lt;p&gt;User:${user}&lt;/p&gt;</span></div>
<div style="position:absolute;left:161.09px;top:397.78px" class="cls_010"><span class="cls_010">&lt;p&gt;&lt;a href="${url.service}?id=${node}"&gt;Show rating&lt;/a&gt;&lt;/p&gt;</span></div>
<div style="position:absolute;left:128.69px;top:408.58px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:419.38px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:439.99px" class="cls_004"><span class="cls_004">3. Then, create the JSON response template called </span><span class="cls_013">rating.post.json.ftl</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:463.88px" class="cls_010"><span class="cls_010">{"rating" :</span></div>
<div style="position:absolute;left:161.09px;top:474.68px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:166.49px;top:485.48px" class="cls_010"><span class="cls_010">"node" : "${node}",</span></div>
<div style="position:absolute;left:166.49px;top:496.28px" class="cls_010"><span class="cls_010">"rating" : "${rating}",</span></div>
<div style="position:absolute;left:166.49px;top:507.08px" class="cls_010"><span class="cls_010">"user" : "${user}"</span></div>
<div style="position:absolute;left:161.09px;top:517.88px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:528.68px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 296 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:210236px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background312.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Let's start by creating a new </span><span class="cls_013">RatingService</span><span class="cls_004">. Create the following interface</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_013"><span class="cls_013">com.someco.repo.service.RatingService</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:107.67px" class="cls_010"><span class="cls_010">package com.someco.repo.service;</span></div>
<div style="position:absolute;left:117.89px;top:118.47px" class="cls_010"><span class="cls_010">public interface RatingService {</span></div>
<div style="position:absolute;left:117.89px;top:140.07px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:124.19px;top:160.55px" class="cls_004"><span class="cls_004">Be aware that Alfresco out-of-the-box proposes as well a rating service. Be</span></div>
<div style="position:absolute;left:124.19px;top:173.15px" class="cls_004"><span class="cls_004">careful when you'll create the implementation by referencing the right class</span></div>
<div style="position:absolute;left:124.19px;top:185.75px" class="cls_004"><span class="cls_004">in the right package. If you wanted to be extremely careful, you could have</span></div>
<div style="position:absolute;left:124.19px;top:198.35px" class="cls_004"><span class="cls_004">renamed your service </span><span class="cls_013">SomecoRatingService</span><span class="cls_004"> instead of </span><span class="cls_013">RatingService</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:220.76px" class="cls_004"><span class="cls_004">5. Then, add the </span><span class="cls_013">create</span><span class="cls_004"> method:</span></div>
<div style="position:absolute;left:117.89px;top:244.65px" class="cls_010"><span class="cls_010">NodeRef create(NodeRef document, int rating, String user);</span></div>
<div style="position:absolute;left:91.32px;top:265.26px" class="cls_004"><span class="cls_004">6. Next, add the following import:</span></div>
<div style="position:absolute;left:117.89px;top:288.47px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.repository.NodeRef;</span></div>
<div style="position:absolute;left:91.32px;top:309.08px" class="cls_004"><span class="cls_004">7. Let's create the implementation in the</span></div>
<div style="position:absolute;left:104.69px;top:321.68px" class="cls_013"><span class="cls_013">com.someco.repo.service.impl.RatingServiceImpl </span><span class="cls_004">class that</span></div>
<div style="position:absolute;left:104.69px;top:334.96px" class="cls_004"><span class="cls_004">implements the interface that we just created:</span></div>
<div style="position:absolute;left:117.89px;top:358.17px" class="cls_010"><span class="cls_010">package com.someco.repo.service.impl;</span></div>
<div style="position:absolute;left:117.89px;top:368.97px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.repository.NodeRef;</span></div>
<div style="position:absolute;left:117.89px;top:379.77px" class="cls_010"><span class="cls_010">import com.someco.repo.service.RatingService;</span></div>
<div style="position:absolute;left:117.89px;top:390.57px" class="cls_010"><span class="cls_010">public class RatingServiceImpl implements RatingService {</span></div>
<div style="position:absolute;left:128.69px;top:412.17px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:128.69px;top:422.97px" class="cls_010"><span class="cls_010">public NodeRef create(NodeRef document, int rating, String user)</span></div>
<div style="position:absolute;left:74.69px;top:433.77px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:444.57px" class="cls_010"><span class="cls_010">return null;</span></div>
<div style="position:absolute;left:128.69px;top:455.37px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:476.97px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:497.58px" class="cls_004"><span class="cls_004">8. The Node Service will be injected as a dependency by Spring:</span></div>
<div style="position:absolute;left:134.09px;top:520.79px" class="cls_010"><span class="cls_010">private NodeServicenodeService;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 297 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:210912px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background313.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. The </span><span class="cls_013">create </span><span class="cls_004">method should first ask the </span><span class="cls_013">nodeService</span><span class="cls_004"> if the whitepaper already</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">has the rateable aspect. If it does, no action is necessary, otherwise, add the</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">aspect:</span></div>
<div style="position:absolute;left:117.89px;top:119.59px" class="cls_010"><span class="cls_010">// add the aspect to this document if it needs it</span></div>
<div style="position:absolute;left:139.49px;top:130.39px" class="cls_010"><span class="cls_010">if (!nodeService.hasAspect(document,</span></div>
<div style="position:absolute;left:150.29px;top:141.19px" class="cls_010"><span class="cls_010">SomeCoModel.ASPECT_RATEABLE)) {</span></div>
<div style="position:absolute;left:161.09px;top:151.99px" class="cls_010"><span class="cls_010">nodeService.addAspect(document,</span></div>
<div style="position:absolute;left:171.89px;top:162.79px" class="cls_010"><span class="cls_010">SomeCoModel.ASPECT_RATEABLE, null);</span></div>
<div style="position:absolute;left:139.49px;top:173.59px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:194.20px" class="cls_004"><span class="cls_004">10. Below the </span><span class="cls_013">if</span><span class="cls_004"> statement, create a new properties map to store the rating and rater</span></div>
<div style="position:absolute;left:104.69px;top:207.48px" class="cls_004"><span class="cls_004">properties:</span></div>
<div style="position:absolute;left:117.89px;top:230.69px" class="cls_010"><span class="cls_010">Map&lt;QName, Serializable&gt; props</span></div>
<div style="position:absolute;left:139.49px;top:241.49px" class="cls_010"><span class="cls_010">= new HashMap&lt;QName, Serializable&gt;();</span></div>
<div style="position:absolute;left:117.89px;top:252.29px" class="cls_010"><span class="cls_010">props.put(SomeCoModel.PROP_RATING, rating);</span></div>
<div style="position:absolute;left:117.89px;top:263.09px" class="cls_010"><span class="cls_010">props.put(SomeCoModel.PROP_RATER, user);</span></div>
<div style="position:absolute;left:86.07px;top:283.70px" class="cls_004"><span class="cls_004">11. Use the node service to create a new ratings node as a child to the whitepaper,</span></div>
<div style="position:absolute;left:104.69px;top:296.30px" class="cls_004"><span class="cls_004">then close out the method:</span></div>
<div style="position:absolute;left:117.89px;top:319.51px" class="cls_010"><span class="cls_010">ChildAssociationRefratingAssoc =</span></div>
<div style="position:absolute;left:139.49px;top:330.31px" class="cls_010"><span class="cls_010">nodeService.createNode(document, SomeCoModel.ASSOC_RATINGS,</span></div>
<div style="position:absolute;left:139.49px;top:341.11px" class="cls_010"><span class="cls_010">QName.createQName(SomeCoModel.SOMECO_MODEL_URI,</span></div>
<div style="position:absolute;left:139.49px;top:351.91px" class="cls_010"><span class="cls_010">SomeCoModel.PROP_RATING.getLocalName()</span></div>
<div style="position:absolute;left:139.49px;top:362.71px" class="cls_010"><span class="cls_010">+ new Date().getTime()), SomeCoModel.TYPE_RATING, props);</span></div>
<div style="position:absolute;left:86.07px;top:383.32px" class="cls_004"><span class="cls_004">12. Then, change the </span><span class="cls_013">return</span><span class="cls_004"> statement:</span></div>
<div style="position:absolute;left:128.69px;top:407.21px" class="cls_010"><span class="cls_010">return ratingAssoc.getChildRef();</span></div>
<div style="position:absolute;left:86.07px;top:427.82px" class="cls_004"><span class="cls_004">13. Complete the class by adding a setter for the </span><span class="cls_013">nodeService</span><span class="cls_004"> and save the class:</span></div>
<div style="position:absolute;left:117.89px;top:451.71px" class="cls_010"><span class="cls_010">public void setNodeService(NodeServicenodeService) {</span></div>
<div style="position:absolute;left:139.49px;top:462.51px" class="cls_010"><span class="cls_010">this.nodeService = nodeService;</span></div>
<div style="position:absolute;left:134.09px;top:473.31px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:493.92px" class="cls_004"><span class="cls_004">14. In the </span><span class="cls_013">com.someco.repo.common.SomeCoModel</span><span class="cls_004">class, just add the following</span></div>
<div style="position:absolute;left:104.69px;top:507.20px" class="cls_013"><span class="cls_013">QName</span><span class="cls_004"> for the </span><span class="cls_013">Rater</span><span class="cls_004"> property, if it's missing:</span></div>
<div style="position:absolute;left:128.69px;top:531.09px" class="cls_010"><span class="cls_010">public final static QName PROP_RATER</span></div>
<div style="position:absolute;left:139.49px;top:541.89px" class="cls_010"><span class="cls_010">= QName.createQName(SOMECO_MODEL_URI, "rater");</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 298 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:211588px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background314.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">15. Now, we need to define our service in a Spring context file. Open the </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">context</span><span class="cls_004"> | </span><span class="cls_013">service-</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_013"><span class="cls_013">context.xml</span><span class="cls_004"> file and add the following bean:</span></div>
<div style="position:absolute;left:117.89px;top:120.95px" class="cls_010"><span class="cls_010">&lt;bean id="someco.ratingService"</span></div>
<div style="position:absolute;left:139.49px;top:131.75px" class="cls_010"><span class="cls_010">class="com.someco.repo.service.impl.RatingServiceImpl"</span></div>
<div style="position:absolute;left:441.89px;top:131.75px" class="cls_010"><span class="cls_010">&gt;</span></div>
<div style="position:absolute;left:128.69px;top:142.55px" class="cls_010"><span class="cls_010">&lt;property name="nodeService" ref="NodeService" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:153.35px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:173.96px" class="cls_004"><span class="cls_004">16. Next, implement the web script's controller logic. All you have to do is write a</span></div>
<div style="position:absolute;left:104.69px;top:186.56px" class="cls_004"><span class="cls_004">Java class that grabs the ID, rating, and rater arguments and then creates the new</span></div>
<div style="position:absolute;left:104.69px;top:199.16px" class="cls_004"><span class="cls_004">rating node using the service that we just implemented. To do that, create a new</span></div>
<div style="position:absolute;left:104.69px;top:211.76px" class="cls_004"><span class="cls_004">class in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">java</span><span class="cls_004">called</span></div>
<div style="position:absolute;left:104.69px;top:225.04px" class="cls_013"><span class="cls_013">com.someco.repo.scripts.PostRating</span><span class="cls_004">. The class name isn't significant, but</span></div>
<div style="position:absolute;left:104.69px;top:238.32px" class="cls_004"><span class="cls_004">following a descriptive naming convention is helpful, particularly if there will be</span></div>
<div style="position:absolute;left:104.69px;top:250.92px" class="cls_004"><span class="cls_004">a large number of Java-backed web scripts. The class must extend</span></div>
<div style="position:absolute;left:104.69px;top:263.52px" class="cls_013"><span class="cls_013">org.springframework.extensions.webscripts.DeclarativeWebScript</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:276.80px" class="cls_004"><span class="cls_004">More details on this page: </span><a href="http://docs.alfresco.com/5.1/concepts/ws-and-/">http://docs.alfresco.com/5.1/concepts/ws-and-</a> </div>
<div style="position:absolute;left:104.69px;top:289.40px" class="cls_004"><span class="cls_004">Java.html.</span></div>
<div style="position:absolute;left:117.89px;top:312.61px" class="cls_010"><span class="cls_010">public class PostRating extends DeclarativeWebScript{</span></div>
<div style="position:absolute;left:86.07px;top:333.22px" class="cls_004"><span class="cls_004">17. The rating service and the node service will be injected as a dependency by</span></div>
<div style="position:absolute;left:104.69px;top:345.82px" class="cls_004"><span class="cls_004">Spring:</span></div>
<div style="position:absolute;left:117.89px;top:369.03px" class="cls_010"><span class="cls_010">private NodeServicenodeService;</span></div>
<div style="position:absolute;left:117.89px;top:379.83px" class="cls_010"><span class="cls_010">private RatingServiceratingService;</span></div>
<div style="position:absolute;left:86.07px;top:400.44px" class="cls_004"><span class="cls_004">18. The controller logic goes in the </span><span class="cls_013">executeImpl()</span><span class="cls_004"> method. The first thing you need</span></div>
<div style="position:absolute;left:104.69px;top:413.72px" class="cls_004"><span class="cls_004">to do after declaring the method is initialize the </span><span class="cls_013">ratingValue</span><span class="cls_004"> variable and grab</span></div>
<div style="position:absolute;left:104.69px;top:427.00px" class="cls_004"><span class="cls_004">the ID, rating, and user arguments:</span></div>
<div style="position:absolute;left:117.89px;top:450.21px" class="cls_010"><span class="cls_010">@Override</span></div>
<div style="position:absolute;left:117.89px;top:461.01px" class="cls_010"><span class="cls_010">protected Map&lt;String,</span></div>
<div style="position:absolute;left:123.29px;top:471.81px" class="cls_010"><span class="cls_010">Object&gt;executeImpl(WebScriptRequest req,  Status status) {</span></div>
<div style="position:absolute;left:139.49px;top:493.41px" class="cls_010"><span class="cls_010">intratingValue = -1;</span></div>
<div style="position:absolute;left:139.49px;top:504.21px" class="cls_010"><span class="cls_010">String id =  req.getParameter("id");</span></div>
<div style="position:absolute;left:139.49px;top:515.01px" class="cls_010"><span class="cls_010">String rating = req.getParameter("rating");</span></div>
<div style="position:absolute;left:139.49px;top:525.81px" class="cls_010"><span class="cls_010">String user = req.getParameter("user");</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 299 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:212264px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background315.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">19. Next, attempt to parse the rating value. If an exception is thrown, move forward</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">with the initialized value, which will get caught during the range check:</span></div>
<div style="position:absolute;left:128.69px;top:106.31px" class="cls_010"><span class="cls_010">try {</span></div>
<div style="position:absolute;left:161.09px;top:117.11px" class="cls_010"><span class="cls_010">ratingValue = Integer.parseInt(rating);</span></div>
<div style="position:absolute;left:150.29px;top:127.91px" class="cls_010"><span class="cls_010">} catch (NumberFormatExceptionnfe) {</span></div>
<div style="position:absolute;left:150.29px;top:138.71px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:159.32px" class="cls_004"><span class="cls_004">20.</span></div>
<div style="position:absolute;left:104.69px;top:159.32px" class="cls_004"><span class="cls_004">The parameters are all required. Web scripts do not yet enforce mandatory</span></div>
<div style="position:absolute;left:104.69px;top:171.92px" class="cls_004"><span class="cls_004">arguments, so the controller does the checking and sets an error code if there is a</span></div>
<div style="position:absolute;left:104.69px;top:184.52px" class="cls_004"><span class="cls_004">problem. If all the arguments have been provided and the rating is in the range,</span></div>
<div style="position:absolute;left:104.69px;top:197.12px" class="cls_004"><span class="cls_004">we are just calling the service that we created before:</span></div>
<div style="position:absolute;left:128.69px;top:220.33px" class="cls_010"><span class="cls_010">if (id == null || rating == null || rating.equals("0")</span></div>
<div style="position:absolute;left:139.49px;top:231.13px" class="cls_010"><span class="cls_010">|| user == null) {</span></div>
<div style="position:absolute;left:161.09px;top:241.93px" class="cls_010"><span class="cls_010">logger.debug("ID, rating, or user not set");</span></div>
<div style="position:absolute;left:161.09px;top:252.73px" class="cls_010"><span class="cls_010">status.setCode(400);</span></div>
<div style="position:absolute;left:161.09px;top:263.53px" class="cls_010"><span class="cls_010">status.setMessage("Required data has not been provided");</span></div>
<div style="position:absolute;left:161.09px;top:274.33px" class="cls_010"><span class="cls_010">status.setRedirect(true);</span></div>
<div style="position:absolute;left:128.69px;top:285.13px" class="cls_010"><span class="cls_010">} else if ((ratingValue&lt; 1) || (ratingValue&gt; 5)) {</span></div>
<div style="position:absolute;left:161.09px;top:295.93px" class="cls_010"><span class="cls_010">logger.debug("Rating out of range");</span></div>
<div style="position:absolute;left:161.09px;top:306.73px" class="cls_010"><span class="cls_010">status.setCode(400);</span></div>
<div style="position:absolute;left:161.09px;top:317.53px" class="cls_010"><span class="cls_010">status.setMessage("Rating value must be</span></div>
<div style="position:absolute;left:171.89px;top:328.33px" class="cls_010"><span class="cls_010">between 1 and 5 inclusive");</span></div>
<div style="position:absolute;left:161.09px;top:339.13px" class="cls_010"><span class="cls_010">status.setRedirect(true);</span></div>
<div style="position:absolute;left:128.69px;top:349.93px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:161.09px;top:360.73px" class="cls_010"><span class="cls_010">NodeRefcurNode = new NodeRef("workspace://SpacesStore/"</span></div>
<div style="position:absolute;left:161.09px;top:371.53px" class="cls_010"><span class="cls_010">+ id);</span></div>
<div style="position:absolute;left:161.09px;top:382.33px" class="cls_010"><span class="cls_010">if (!nodeService.exists(curNode)) {</span></div>
<div style="position:absolute;left:182.69px;top:393.13px" class="cls_010"><span class="cls_010">logger.debug("Node not found");</span></div>
<div style="position:absolute;left:182.69px;top:403.93px" class="cls_010"><span class="cls_010">status.setCode(404);</span></div>
<div style="position:absolute;left:182.69px;top:414.73px" class="cls_010"><span class="cls_010">status.setMessage("No node found for id:" + id);</span></div>
<div style="position:absolute;left:182.69px;top:425.53px" class="cls_010"><span class="cls_010">status.setRedirect(true);</span></div>
<div style="position:absolute;left:150.29px;top:436.33px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:182.69px;top:447.13px" class="cls_010"><span class="cls_010">ratingService.create(curNode, Integer.parseInt(rating),</span></div>
<div style="position:absolute;left:188.09px;top:457.93px" class="cls_010"><span class="cls_010">user);</span></div>
<div style="position:absolute;left:150.29px;top:468.73px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:107.09px;top:490.33px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 300 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:212940px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background316.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">21. The rating data that was passed in needs to set on the model so that it can be</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">echoed back by the response templates:</span></div>
<div style="position:absolute;left:128.69px;top:106.31px" class="cls_010"><span class="cls_010">Map&lt;String, Object&gt; model = new HashMap&lt;String, Object&gt;();</span></div>
<div style="position:absolute;left:139.49px;top:117.11px" class="cls_010"><span class="cls_010">model.put("node", id);</span></div>
<div style="position:absolute;left:139.49px;top:127.91px" class="cls_010"><span class="cls_010">model.put("rating", rating);</span></div>
<div style="position:absolute;left:139.49px;top:138.71px" class="cls_010"><span class="cls_010">model.put("user", user);</span></div>
<div style="position:absolute;left:139.49px;top:160.31px" class="cls_010"><span class="cls_010">return model;</span></div>
<div style="position:absolute;left:123.29px;top:171.11px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:191.72px" class="cls_004"><span class="cls_004">22. Then, add the logger definition at the top of the class:</span></div>
<div style="position:absolute;left:117.89px;top:214.93px" class="cls_010"><span class="cls_010">private Logger logger = Logger.getLogger(PostRating.class);</span></div>
<div style="position:absolute;left:117.89px;top:225.73px" class="cls_010"><span class="cls_010">Be sure to use the following import for the logger:</span></div>
<div style="position:absolute;left:117.89px;top:236.53px" class="cls_010"><span class="cls_010">import org.apache.log4j.Logger;</span></div>
<div style="position:absolute;left:86.07px;top:257.14px" class="cls_004"><span class="cls_004">23. Complete the class by adding a setter for the two services that we defined</span></div>
<div style="position:absolute;left:104.69px;top:269.74px" class="cls_004"><span class="cls_004">previously, add all the required imports, and save the class:</span></div>
<div style="position:absolute;left:117.89px;top:292.95px" class="cls_010"><span class="cls_010">public void setNodeService(NodeServicenodeService) {</span></div>
<div style="position:absolute;left:128.69px;top:303.75px" class="cls_010"><span class="cls_010">this.nodeService = nodeService;</span></div>
<div style="position:absolute;left:117.89px;top:314.55px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:325.35px" class="cls_010"><span class="cls_010">public void setRatingService(RatingServiceratingService) {</span></div>
<div style="position:absolute;left:128.69px;top:336.15px" class="cls_010"><span class="cls_010">this.ratingService = ratingService;</span></div>
<div style="position:absolute;left:117.89px;top:346.95px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:367.56px" class="cls_004"><span class="cls_004">24. Save the class.</span></div>
<div style="position:absolute;left:86.07px;top:382.32px" class="cls_004"><span class="cls_004">25. Now you need to let the web script framework know that this new class is the</span></div>
<div style="position:absolute;left:104.69px;top:394.92px" class="cls_004"><span class="cls_004">controller for the rating web script. Open the Spring bean configuration file in</span></div>
<div style="position:absolute;left:104.69px;top:407.52px" class="cls_013"><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">context</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:420.80px" class="cls_013"><span class="cls_013">webscript-context.xml</span><span class="cls_004"> and add the following bean:</span></div>
<div style="position:absolute;left:117.89px;top:444.69px" class="cls_010"><span class="cls_010">&lt;bean id="webscript.com.someco.ratings.rating.post"</span></div>
<div style="position:absolute;left:139.49px;top:455.49px" class="cls_010"><span class="cls_010">class="com.someco.repo.scripts.PostRating" parent="webscript"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:466.29px" class="cls_010"><span class="cls_010">&lt;property name="nodeService" ref="NodeService" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:477.09px" class="cls_010"><span class="cls_010">&lt;property name="ratingService" ref="someco.ratingService" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:487.89px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:508.50px" class="cls_004"><span class="cls_004">26. Package, deploy, and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 301 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:213616px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background317.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Once you get the UI widget wired in, it will be easier to test. For now, verify that your new</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">web script shows up. To navigate to the index for the new web script directly, go to this</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">URL:</span></div>
<div style="position:absolute;left:56.69px;top:116.52px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/s/index/package/com/someco/ratings/">http://localhost:8080/alfresco/s/index/package/com/someco/ratings</a> </div>
<div style="position:absolute;left:56.69px;top:138.30px" class="cls_004"><span class="cls_004">You should see this:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 302 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:214292px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background318.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">However, if you are too impatient, you can use a tool such as Postman to simulate your call,</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">as shown in the following screenshot:</span></div>
<div style="position:absolute;left:56.69px;top:476.22px" class="cls_014"><span class="cls_014">Using the correct ID for Web Script Beans</span></div>
<div style="position:absolute;left:56.69px;top:501.44px" class="cls_004"><span class="cls_004">The web script framework uses the bean's ID to find Java-based web script controllers. The</span></div>
<div style="position:absolute;left:56.69px;top:514.04px" class="cls_004"><span class="cls_004">ID follows a naming convention. The convention is as follows:</span></div>
<div style="position:absolute;left:74.69px;top:534.96px" class="cls_010"><span class="cls_010">webscript.package.service-id.method</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 303 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:214968px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background319.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">In this example, the package is </span><span class="cls_013">com.someco.ratings</span><span class="cls_004">, the service ID is </span><span class="cls_013">rating</span><span class="cls_004">, and the</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">HTTP method is </span><span class="cls_013">post</span><span class="cls_004">. If you don't follow this convention, the bean won't be registered as a</span></div>
<div style="position:absolute;left:56.69px;top:97.06px" class="cls_004"><span class="cls_004">controller for the web script. You won't see an error. The code simply fails to get called.</span></div>
<div style="position:absolute;left:56.69px;top:118.66px" class="cls_004"><span class="cls_004">Another potential gotcha is the parent attribute of the bean element. The parent bean is the</span></div>
<div style="position:absolute;left:56.69px;top:131.26px" class="cls_004"><span class="cls_004">singular web script here versus the plural web scripts, which is how Data Dictionary web</span></div>
<div style="position:absolute;left:56.69px;top:143.86px" class="cls_004"><span class="cls_004">script folders are named. That's an easy one to miss and kind of hard to debug.</span></div>
<div style="position:absolute;left:56.69px;top:180.56px" class="cls_014"><span class="cls_014">Using both Java and JavaScript for controller</span></div>
<div style="position:absolute;left:56.69px;top:202.16px" class="cls_014"><span class="cls_014">logic</span></div>
<div style="position:absolute;left:56.69px;top:227.38px" class="cls_004"><span class="cls_004">Using a Java-backed web script doesn't exclude the use of JavaScript for a particular web</span></div>
<div style="position:absolute;left:56.69px;top:239.98px" class="cls_004"><span class="cls_004">script. If you have both a Java class and a JavaScript file, the Java class gets executed first</span></div>
<div style="position:absolute;left:56.69px;top:252.58px" class="cls_004"><span class="cls_004">followed by the JavaScript. The script has access to everything the Java class put in the</span></div>
<div style="position:absolute;left:56.69px;top:265.18px" class="cls_004"><span class="cls_004">model, and can update the model before passing it along to the response template.</span></div>
<div style="position:absolute;left:56.69px;top:286.78px" class="cls_004"><span class="cls_004">This is potentially confusing because people who try to support your web script may see</span></div>
<div style="position:absolute;left:56.69px;top:299.38px" class="cls_004"><span class="cls_004">the JavaScript controller and initially assume it is solely responsible for the controller logic.</span></div>
<div style="position:absolute;left:56.69px;top:311.98px" class="cls_004"><span class="cls_004">Compounding the problem is the fact that Java beans are wired in via Spring, and the</span></div>
<div style="position:absolute;left:56.69px;top:324.58px" class="cls_004"><span class="cls_004">context files are not located near the web scripts. To lessen the potential maintenance</span></div>
<div style="position:absolute;left:56.69px;top:337.18px" class="cls_004"><span class="cls_004">headaches, put all of your logic for a given web script either in JavaScript or Java, but not</span></div>
<div style="position:absolute;left:56.69px;top:349.78px" class="cls_004"><span class="cls_004">both.</span></div>
<div style="position:absolute;left:56.69px;top:388.53px" class="cls_008"><span class="cls_008">Wiring a web script to UI widgets</span></div>
<div style="position:absolute;left:56.69px;top:416.26px" class="cls_004"><span class="cls_004">SomeCo wants to show a graphical ratings widget on its web page. When the user clicks a</span></div>
<div style="position:absolute;left:56.69px;top:428.86px" class="cls_004"><span class="cls_004">star, it should post the corresponding rating to Alfresco. In a subsequent example, you'll see</span></div>
<div style="position:absolute;left:56.69px;top:441.46px" class="cls_004"><span class="cls_004">how to leverage the widget on SomeCo's website. For this example, you are going to add</span></div>
<div style="position:absolute;left:56.69px;top:454.06px" class="cls_004"><span class="cls_004">the ratings widget to the HTML response for the rating web script. That will let you test</span></div>
<div style="position:absolute;left:56.69px;top:466.66px" class="cls_004"><span class="cls_004">both the widget and the rating POST.</span></div>
<div style="position:absolute;left:122.09px;top:488.26px" class="cls_004"><span class="cls_004">We'll use jQuery in our HTML page. For the ratings widget, it is based on</span></div>
<div style="position:absolute;left:122.09px;top:500.86px" class="cls_004"><span class="cls_004">code from the library at </span><a href="http://rateyo.fundoocode.ninja/">http://rateyo.fundoocode.ninja/</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 304 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:215644px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background320.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You may recall that in the earlier rating example, the HTML response simply showed the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">rating summary data for a given whitepaper. The goal now is to enhance that response with</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">the rating widget so that the POST can be tested. The following figure shows what the</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">response will look like when you are done. This example whitepaper node has 2 ratings and</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">an average rating of 3:</span></div>
<div style="position:absolute;left:56.69px;top:327.92px" class="cls_004"><span class="cls_004">The purpose of the rating widget is two-fold. First, it graphically displays the average rating</span></div>
<div style="position:absolute;left:56.69px;top:340.52px" class="cls_004"><span class="cls_004">for a whitepaper. Second, each star in the widget is hot. When you click one of the rating</span></div>
<div style="position:absolute;left:56.69px;top:353.12px" class="cls_004"><span class="cls_004">stars, an asynchronous post is made to </span><span class="cls_013">someco</span><span class="cls_004"> | </span><span class="cls_013">rating</span><span class="cls_004">, which causes a new rating object</span></div>
<div style="position:absolute;left:56.69px;top:366.40px" class="cls_004"><span class="cls_004">to get created. The value of the rating posted depends on the star clicked. The person</span></div>
<div style="position:absolute;left:56.69px;top:379.00px" class="cls_004"><span class="cls_004">submitting the rating would normally be passed in based on some sort of credential, maybe</span></div>
<div style="position:absolute;left:56.69px;top:391.60px" class="cls_004"><span class="cls_004">from a portal session or a cookie. In this example, you are going to add a field to the page so</span></div>
<div style="position:absolute;left:56.69px;top:404.20px" class="cls_004"><span class="cls_004">that you can specify any value you want for the rater.</span></div>
<div style="position:absolute;left:56.69px;top:440.90px" class="cls_014"><span class="cls_014">Step-by-step - using a widget to post ratings</span></div>
<div style="position:absolute;left:56.69px;top:466.12px" class="cls_004"><span class="cls_004">Adding the ratings widget to the rating web script HTML is going to involve referencing an</span></div>
<div style="position:absolute;left:56.69px;top:478.72px" class="cls_004"><span class="cls_004">external JavaScript library and updating our HTML and JavaScript code by modifying the</span></div>
<div style="position:absolute;left:56.69px;top:491.32px" class="cls_004"><span class="cls_004">existing FreeMarker template.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 305 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:216320px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background321.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Here are the steps:</span></div>
<div style="position:absolute;left:91.32px;top:92.23px" class="cls_004"><span class="cls_004">1. First, edit the </span><span class="cls_013">rating.get.html.ftl</span><span class="cls_004"> file to add new HTML related to the rater</span></div>
<div style="position:absolute;left:104.69px;top:105.51px" class="cls_004"><span class="cls_004">field and the rating widget. Just paste the following code below the </span><span class="cls_013"># of</span></div>
<div style="position:absolute;left:104.69px;top:118.79px" class="cls_013"><span class="cls_013">Ratings</span><span class="cls_004"> paragraph:</span></div>
<div style="position:absolute;left:117.89px;top:142.68px" class="cls_010"><span class="cls_010">&lt;form name="login"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:153.48px" class="cls_010"><span class="cls_010">Rater: &lt;input name="userId"&gt;&lt;/input&gt;</span></div>
<div style="position:absolute;left:117.89px;top:164.28px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:117.89px;top:175.08px" class="cls_010"><span class="cls_010">&lt;#if (rating.user&gt; 0)&gt;</span></div>
<div style="position:absolute;left:139.49px;top:185.88px" class="cls_010"><span class="cls_010">&lt;p&gt;User rating: ${rating.user}&lt;/p&gt;</span></div>
<div style="position:absolute;left:117.89px;top:196.68px" class="cls_010"><span class="cls_010">&lt;/#if&gt;</span></div>
<div style="position:absolute;left:117.89px;top:207.48px" class="cls_010"><span class="cls_010">&lt;p&gt;Rating:&lt;/p&gt;</span></div>
<div style="position:absolute;left:117.89px;top:218.28px" class="cls_010"><span class="cls_010">&lt;div id="rating"&gt;&lt;/div&gt;</span></div>
<div style="position:absolute;left:91.32px;top:238.89px" class="cls_004"><span class="cls_004">2. Now work on the JavaScript. The rating widget has an associated JavaScript file</span></div>
<div style="position:absolute;left:104.69px;top:251.49px" class="cls_004"><span class="cls_004">that needs to be referenced in the head element. There is also a dependency on</span></div>
<div style="position:absolute;left:104.69px;top:264.09px" class="cls_004"><span class="cls_004">the jQuery JavaScript library. Modify the contents as follows:</span></div>
<div style="position:absolute;left:117.89px;top:287.30px" class="cls_010"><span class="cls_010">&lt;head&gt;</span></div>
<div style="position:absolute;left:139.49px;top:298.10px" class="cls_010"><span class="cls_010">&lt;link rel="stylesheet"</span></div>
<div style="position:absolute;left:150.29px;top:308.90px" class="cls_010"><span class="cls_010">href="//cdnjs.cloudflare.com/ajax/libs</span></div>
<div style="position:absolute;left:150.29px;top:319.70px" class="cls_010"><span class="cls_010">/rateYo/2.2.0/jquery.rateyo.min.css"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:330.50px" class="cls_010"><span class="cls_010">&lt;script src="//code.jquery.com/jquery-1.12.4.min.js"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:341.30px" class="cls_010"><span class="cls_010">&lt;/script&gt;</span></div>
<div style="position:absolute;left:139.49px;top:352.10px" class="cls_010"><span class="cls_010">&lt;script</span></div>
<div style="position:absolute;left:150.29px;top:362.90px" class="cls_010"><span class="cls_010">src="//cdnjs.cloudflare.com/ajax/libs</span></div>
<div style="position:absolute;left:161.09px;top:373.70px" class="cls_010"><span class="cls_010">/rateYo/2.2.0/jquery.rateyo.min.js"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:384.50px" class="cls_010"><span class="cls_010">&lt;/script&gt;</span></div>
<div style="position:absolute;left:117.89px;top:395.30px" class="cls_010"><span class="cls_010">&lt;/head&gt;</span></div>
<div style="position:absolute;left:91.32px;top:415.91px" class="cls_004"><span class="cls_004">3. Now add the following JavaScript code to the existing script section. This code is</span></div>
<div style="position:absolute;left:104.69px;top:428.52px" class="cls_004"><span class="cls_004">initializing the star widget, and then bind a function to the </span><span class="cls_012">set </span><span class="cls_004">event triggered</span></div>
<div style="position:absolute;left:104.69px;top:441.12px" class="cls_004"><span class="cls_004">when the user clicks on a star. The method called in the </span><span class="cls_012">set</span><span class="cls_004"> event will send a </span><span class="cls_013">POST</span></div>
<div style="position:absolute;left:104.69px;top:454.40px" class="cls_004"><span class="cls_004">query to Alfresco to save the rating. If the query is a success, it will just refresh</span></div>
<div style="position:absolute;left:104.69px;top:467.00px" class="cls_004"><span class="cls_004">the page:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 306 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:216996px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background322.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">$(function () {</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">$("#rating").rateYo({</span></div>
<div style="position:absolute;left:150.29px;top:91.42px" class="cls_010"><span class="cls_010">rating: ${rating.average},</span></div>
<div style="position:absolute;left:150.29px;top:102.22px" class="cls_010"><span class="cls_010">fullStar: true</span></div>
<div style="position:absolute;left:128.69px;top:113.02px" class="cls_010"><span class="cls_010">}).on("rateyo.set", function (e, data) {</span></div>
<div style="position:absolute;left:150.29px;top:123.82px" class="cls_010"><span class="cls_010">var rating = data.rating;</span></div>
<div style="position:absolute;left:150.29px;top:134.62px" class="cls_010"><span class="cls_010">var user = $("input[name='userId]").val();</span></div>
<div style="position:absolute;left:128.69px;top:145.42px" class="cls_010"><span class="cls_010">if (user == null || user.length() == 0)</span></div>
<div style="position:absolute;left:139.49px;top:156.22px" class="cls_010"><span class="cls_010">user = "ben";</span></div>
<div style="position:absolute;left:128.69px;top:167.02px" class="cls_010"><span class="cls_010">var id = "${args.id}";</span></div>
<div style="position:absolute;left:128.69px;top:177.82px" class="cls_010"><span class="cls_010">$.post({</span></div>
<div style="position:absolute;left:161.09px;top:188.62px" class="cls_010"><span class="cls_010">url: "${url.serviceContext}/someco/rating",</span></div>
<div style="position:absolute;left:161.09px;top:199.42px" class="cls_010"><span class="cls_010">data: {</span></div>
<div style="position:absolute;left:171.89px;top:210.22px" class="cls_010"><span class="cls_010">rating: rating,</span></div>
<div style="position:absolute;left:171.89px;top:221.02px" class="cls_010"><span class="cls_010">user: user,</span></div>
<div style="position:absolute;left:171.89px;top:231.82px" class="cls_010"><span class="cls_010">id: id</span></div>
<div style="position:absolute;left:161.09px;top:242.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:150.29px;top:253.42px" class="cls_010"><span class="cls_010">}).success(function() {</span></div>
<div style="position:absolute;left:161.09px;top:264.22px" class="cls_010"><span class="cls_010">location.reload();</span></div>
<div style="position:absolute;left:150.29px;top:275.02px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:128.69px;top:285.82px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:117.89px;top:296.62px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:91.32px;top:317.23px" class="cls_004"><span class="cls_004">4. Package, deploy, restart, and test.</span></div>
<div style="position:absolute;left:56.69px;top:341.12px" class="cls_004"><span class="cls_004">You should now be able to invoke the web script to list the whitepapers. From there, you</span></div>
<div style="position:absolute;left:56.69px;top:353.72px" class="cls_004"><span class="cls_004">can follow the </span><span class="cls_013">rating</span><span class="cls_004"> link to see the rating data for a specific whitepaper, which includes</span></div>
<div style="position:absolute;left:56.69px;top:367.00px" class="cls_004"><span class="cls_004">the rating widget. The ratings widget should be displaying the number of stars based on the</span></div>
<div style="position:absolute;left:56.69px;top:379.60px" class="cls_004"><span class="cls_004">current average rating for the whitepaper. If you click on a star, it should post the</span></div>
<div style="position:absolute;left:56.69px;top:392.20px" class="cls_004"><span class="cls_004">appropriate rating to Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:413.80px" class="cls_004"><span class="cls_004">You will notice that our Freemarker files is using external references to JavaScript libraries</span></div>
<div style="position:absolute;left:56.69px;top:426.40px" class="cls_004"><span class="cls_004">and CSS file. It means that you'll need access to the Internet to be sure that it works as</span></div>
<div style="position:absolute;left:56.69px;top:439.00px" class="cls_004"><span class="cls_004">expected.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 307 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:217672px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background323.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you use a specific name in the </span><span class="cls_007">Rater</span><span class="cls_004"> field to post a </span><span class="cls_007">Rating</span><span class="cls_004">, you can see the value of that</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">user's rating by appending the user argument to the URL for either the whitepaper or rating</span></div>
<div style="position:absolute;left:56.69px;top:95.74px" class="cls_004"><span class="cls_004">web scripts:</span></div>
<div style="position:absolute;left:56.69px;top:332.86px" class="cls_014"><span class="cls_014">Implementing the delete ratings link</span></div>
<div style="position:absolute;left:56.69px;top:358.08px" class="cls_004"><span class="cls_004">You now know more than enough to implement the </span><span class="cls_007">Delete ratings</span><span class="cls_004"> link on the rating web</span></div>
<div style="position:absolute;left:56.69px;top:370.72px" class="cls_004"><span class="cls_004">script HTML response page (</span><span class="cls_013">rating.get.html.ftl</span><span class="cls_004">) on your own. Here are some hints if</span></div>
<div style="position:absolute;left:56.69px;top:384.00px" class="cls_004"><span class="cls_004">you need them:</span></div>
<div style="position:absolute;left:104.69px;top:405.73px" class="cls_004"><span class="cls_004">In the </span><span class="cls_013">rating.get.html.ftl</span><span class="cls_004"> file, add the AJAX call to the </span><span class="cls_013">deleteRatings()</span></div>
<div style="position:absolute;left:104.69px;top:419.01px" class="cls_004"><span class="cls_004">function. The call will be to a new web script you need to write.</span></div>
<div style="position:absolute;left:104.69px;top:433.77px" class="cls_004"><span class="cls_004">The jQuery library provides the option of sending DELETE queries. The only</span></div>
<div style="position:absolute;left:104.69px;top:446.37px" class="cls_004"><span class="cls_004">argument the script needs is the node ID of the whitepaper that needs to have its</span></div>
<div style="position:absolute;left:104.69px;top:458.97px" class="cls_004"><span class="cls_004">ratings cleared.</span></div>
<div style="position:absolute;left:104.69px;top:473.73px" class="cls_004"><span class="cls_004">Set the required authentication level for the new web script to </span><span class="cls_007">admin </span><span class="cls_004">to keep</span></div>
<div style="position:absolute;left:104.69px;top:486.36px" class="cls_004"><span class="cls_004">guests from deleting ratings.</span></div>
<div style="position:absolute;left:104.69px;top:501.12px" class="cls_004"><span class="cls_004">Decide whether you want to use JavaScript or Java for the controller. If you go</span></div>
<div style="position:absolute;left:104.69px;top:513.72px" class="cls_004"><span class="cls_004">the JavaScript route, add a </span><span class="cls_013">deleteRatings()</span><span class="cls_004"> function to the </span><span class="cls_013">rating.js</span><span class="cls_004"> file</span></div>
<div style="position:absolute;left:104.69px;top:527.00px" class="cls_004"><span class="cls_004">and call that from your controller. If you go with Java, remember that you'll need</span></div>
<div style="position:absolute;left:104.69px;top:539.60px" class="cls_004"><span class="cls_004">to configure the controller as a bean in </span><span class="cls_013">someco-scripts-context.xml</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:104.69px;top:552.88px" class="cls_004"><span class="cls_004">update the interface and the service related to the </span><span class="cls_013">RatingService</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:568.32px" class="cls_004"><span class="cls_004">If you get stuck, look at the source code that accompanies the chapter (be careful,</span></div>
<div style="position:absolute;left:104.69px;top:580.92px" class="cls_004"><span class="cls_004">the code provided is covering only the Java option).</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 308 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:218348px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background324.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">When you are done, you'll be able to create, read, update, and delete ratings entirely</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">through web scripts.</span></div>
<div style="position:absolute;left:56.69px;top:119.80px" class="cls_014"><span class="cls_014">Adding the web script calls to SomeCo's</span></div>
<div style="position:absolute;left:56.69px;top:141.40px" class="cls_014"><span class="cls_014">whitepaper web page</span></div>
<div style="position:absolute;left:56.69px;top:166.62px" class="cls_004"><span class="cls_004">You now have a RESTful API in place for working with whitepapers and ratings. Now</span></div>
<div style="position:absolute;left:56.69px;top:179.22px" class="cls_004"><span class="cls_004">SomeCo's web team can integrate the frontend website with the Alfresco backend by</span></div>
<div style="position:absolute;left:56.69px;top:191.82px" class="cls_004"><span class="cls_004">making calls to the web scripts you created. This book isn't about frontend web</span></div>
<div style="position:absolute;left:56.69px;top:204.42px" class="cls_004"><span class="cls_004">development. So, rather than having you recreate this code step-by-step, here's a rough</span></div>
<div style="position:absolute;left:56.69px;top:217.02px" class="cls_004"><span class="cls_004">outline of the steps the web team went through. At the end of the summary, you can deploy</span></div>
<div style="position:absolute;left:56.69px;top:229.62px" class="cls_004"><span class="cls_004">the final product and test it out.</span></div>
<div style="position:absolute;left:56.69px;top:251.22px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">web</span><span class="cls_004"> | </span><span class="cls_013">html</span><span class="cls_004"> | </span><span class="cls_013">someco.html</span><span class="cls_004"> page is the only HTML page on</span></div>
<div style="position:absolute;left:56.69px;top:264.50px" class="cls_004"><span class="cls_004">SomeCo's website at the moment. In this example, we used Bootstrap framework for the</span></div>
<div style="position:absolute;left:56.69px;top:277.10px" class="cls_004"><span class="cls_004">user interface, and jQuery for the JavaScript framework.</span></div>
<div style="position:absolute;left:56.69px;top:298.70px" class="cls_004"><span class="cls_004">If you open the HTML file provided to you in the attached code with this chapter, you'll</span></div>
<div style="position:absolute;left:56.69px;top:311.30px" class="cls_004"><span class="cls_004">find a DIV element that will populate using JavaScript:</span></div>
<div style="position:absolute;left:74.69px;top:332.22px" class="cls_010"><span class="cls_010">&lt;div id="whitepapers"&gt;&lt;/div&gt;</span></div>
<div style="position:absolute;left:56.69px;top:352.70px" class="cls_004"><span class="cls_004">Then, look at the following embedded JavaScript code:</span></div>
<div style="position:absolute;left:74.69px;top:373.62px" class="cls_010"><span class="cls_010">var whitepapers = {};</span></div>
<div style="position:absolute;left:74.69px;top:384.42px" class="cls_010"><span class="cls_010">$.get({</span></div>
<div style="position:absolute;left:74.69px;top:395.22px" class="cls_010"><span class="cls_010">url : '</span><a href="http://localhost:8080/alfresco/s/someco/whitepapers.json?guest=true%27/">http://localhost:8080/alfresco/s/someco/whitepapers.json?guest=true'</a> </div>
<div style="position:absolute;left:74.69px;top:406.02px" class="cls_010"><span class="cls_010">}).success(function(data) {</span></div>
<div style="position:absolute;left:85.49px;top:416.82px" class="cls_010"><span class="cls_010">for (vari = 0; i&lt;data.whitepapers.length; i++) {</span></div>
<div style="position:absolute;left:117.89px;top:427.62px" class="cls_010"><span class="cls_010">var wp = data.whitepapers[i];</span></div>
<div style="position:absolute;left:117.89px;top:438.42px" class="cls_010"><span class="cls_010">var html = "&lt;div class='whitepaper' id='" + wp.id + "'&gt;</span></div>
<div style="position:absolute;left:139.49px;top:449.22px" class="cls_010"><span class="cls_010">&lt;h4 class='title'&gt;" + wp.title + "&lt;/h4&gt;&lt;/div&gt;</span></div>
<div style="position:absolute;left:139.49px;top:460.02px" class="cls_010"><span class="cls_010">&lt;div id='rating-" + wp.id + "'&gt;&lt;/div&gt;";</span></div>
<div style="position:absolute;left:117.89px;top:470.82px" class="cls_010"><span class="cls_010">$("#whitepapers").append(html);</span></div>
<div style="position:absolute;left:117.89px;top:481.62px" class="cls_010"><span class="cls_010">$("#rating-" + wp.id).rateYo({</span></div>
<div style="position:absolute;left:128.69px;top:492.42px" class="cls_010"><span class="cls_010">rating : wp.rating.average,</span></div>
<div style="position:absolute;left:128.69px;top:503.22px" class="cls_010"><span class="cls_010">readOnly : true</span></div>
<div style="position:absolute;left:117.89px;top:514.02px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:117.89px;top:524.82px" class="cls_010"><span class="cls_010">whitepapers[wp.id] = wp;</span></div>
<div style="position:absolute;left:117.89px;top:535.62px" class="cls_010"><span class="cls_010">$("#" + wp.id + " .title").click(function() {</span></div>
<div style="position:absolute;left:139.49px;top:546.42px" class="cls_010"><span class="cls_010">var id = $(this).parent(".whitepaper").attr("id");</span></div>
<div style="position:absolute;left:139.49px;top:557.22px" class="cls_010"><span class="cls_010">$("#wp-title").html(whitepapers[id].title);</span></div>
<div style="position:absolute;left:139.49px;top:568.02px" class="cls_010"><span class="cls_010">$("#wp-description").html(whitepapers[id].description);</span></div>
<div style="position:absolute;left:139.49px;top:578.82px" class="cls_010"><span class="cls_010">$("#wp-download").removeClass("hidden");</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 309 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:219024px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background325.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">$("#wp-download").attr("href", "</span><a href="http://localhost:8080/" "="">http://localhost:8080"</a> </div>
<div style="position:absolute;left:144.89px;top:80.62px" class="cls_010"><span class="cls_010">+ whitepapers[id].link);</span></div>
<div style="position:absolute;left:112.49px;top:91.42px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:90.89px;top:102.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:113.02px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:56.69px;top:133.50px" class="cls_004"><span class="cls_004">As you can see, we send a </span><span class="cls_013">GET</span><span class="cls_004"> request to retrieve the list of whitepapers in JSON format. If</span></div>
<div style="position:absolute;left:56.69px;top:146.78px" class="cls_004"><span class="cls_004">the query is successful, we browse the results:</span></div>
<div style="position:absolute;left:104.69px;top:168.51px" class="cls_004"><span class="cls_004">Create a </span><span class="cls_013">div</span><span class="cls_004"> element for each whitepaper</span></div>
<div style="position:absolute;left:104.69px;top:183.95px" class="cls_004"><span class="cls_004">Append the generated HTML code to the page</span></div>
<div style="position:absolute;left:104.69px;top:198.71px" class="cls_004"><span class="cls_004">Call the library to render the star widget. You'll notice that we are using the</span></div>
<div style="position:absolute;left:104.69px;top:211.31px" class="cls_013"><span class="cls_013">readOnly</span><span class="cls_004"> attribute, because we can't rate whitepapers from the website</span></div>
<div style="position:absolute;left:104.69px;top:226.75px" class="cls_004"><span class="cls_004">Finally, bind the </span><span class="cls_013">click</span><span class="cls_004"> event on the title of the whitepaper that displays the</span></div>
<div style="position:absolute;left:104.69px;top:240.03px" class="cls_004"><span class="cls_004">whitepaper details on the right side</span></div>
<div style="position:absolute;left:56.69px;top:263.92px" class="cls_004"><span class="cls_004">At the top of the page, you'll find all dependencies that we require, including jQuery,</span></div>
<div style="position:absolute;left:56.69px;top:276.52px" class="cls_004"><span class="cls_004">Bootstrap, and the jQuery </span><span class="cls_013">rateYo</span><span class="cls_004"> plugin:</span></div>
<div style="position:absolute;left:74.69px;top:298.12px" class="cls_010"><span class="cls_010">&lt;script src="</span><a href="https://code.jquery.com/jquery-2.2.4.min.js" "="">https://code.jquery.com/jquery-2.2.4.min.js"</a> </div>
<div style="position:absolute;left:85.49px;top:308.92px" class="cls_010"><span class="cls_010">integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="</span></div>
<div style="position:absolute;left:85.49px;top:319.72px" class="cls_010"><span class="cls_010">crossorigin="anonymous"&gt;&lt;/script&gt;</span></div>
<div style="position:absolute;left:74.69px;top:341.32px" class="cls_010"><span class="cls_010">&lt;link rel="stylesheet"</span></div>
<div style="position:absolute;left:74.69px;top:352.12px" class="cls_010"><span class="cls_010">href="</span><a href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css/">https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css</a> </div>
<div style="position:absolute;left:74.69px;top:362.92px" class="cls_010"><span class="cls_010">"</span></div>
<div style="position:absolute;left:85.49px;top:373.72px" class="cls_010"><span class="cls_010">integrity="sha384-</span></div>
<div style="position:absolute;left:74.69px;top:384.52px" class="cls_010"><span class="cls_010">BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"</span></div>
<div style="position:absolute;left:85.49px;top:395.32px" class="cls_010"><span class="cls_010">crossorigin="anonymous"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:416.92px" class="cls_010"><span class="cls_010">&lt;link rel="stylesheet"</span></div>
<div style="position:absolute;left:74.69px;top:427.72px" class="cls_010"><span class="cls_010">href="</span><a href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.m/">https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.m</a> </div>
<div style="position:absolute;left:74.69px;top:438.52px" class="cls_010"><span class="cls_010">in.css"</span></div>
<div style="position:absolute;left:85.49px;top:449.32px" class="cls_010"><span class="cls_010">integrity="sha384-</span></div>
<div style="position:absolute;left:74.69px;top:460.12px" class="cls_010"><span class="cls_010">rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp"</span></div>
<div style="position:absolute;left:85.49px;top:470.92px" class="cls_010"><span class="cls_010">crossorigin="anonymous"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:492.52px" class="cls_010"><span class="cls_010">&lt;script</span></div>
<div style="position:absolute;left:85.49px;top:503.32px" class="cls_010"><span class="cls_010">src="</span><a href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" "="">https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"</a> </div>
<div style="position:absolute;left:85.49px;top:514.12px" class="cls_010"><span class="cls_010">integrity="sha384-</span></div>
<div style="position:absolute;left:74.69px;top:524.92px" class="cls_010"><span class="cls_010">Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa"</span></div>
<div style="position:absolute;left:85.49px;top:535.72px" class="cls_010"><span class="cls_010">crossorigin="anonymous"&gt;&lt;/script&gt;</span></div>
<div style="position:absolute;left:74.69px;top:557.32px" class="cls_010"><span class="cls_010">&lt;link rel="stylesheet"</span></div>
<div style="position:absolute;left:74.69px;top:568.12px" class="cls_010"><span class="cls_010">href="//cdnjs.cloudflare.com/ajax/libs/rateYo/2.2.0/jquery.rateyo.min.css"&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 310 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:219700px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background326.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:74.69px;top:69.82px" class="cls_010"><span class="cls_010">&lt;scriptsrc="//cdnjs.cloudflare.com/ajax/libs/rateYo/2.2.0/jquery.rateyo.min</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">.js"&gt;&lt;/script&gt;</span></div>
<div style="position:absolute;left:56.69px;top:116.20px" class="cls_014"><span class="cls_014">Making other types of content rateable</span></div>
<div style="position:absolute;left:56.69px;top:141.42px" class="cls_004"><span class="cls_004">You've just created a RESTful API in the Alfresco Repository and you used it to let SomeCo</span></div>
<div style="position:absolute;left:56.69px;top:154.02px" class="cls_004"><span class="cls_004">website users rate whitepaper content. What's cool, though, is that none of the rating logic</span></div>
<div style="position:absolute;left:56.69px;top:166.62px" class="cls_004"><span class="cls_004">depends on the specific Whitepaper type. Remember that rateable was defined as an aspect.</span></div>
<div style="position:absolute;left:56.69px;top:179.22px" class="cls_004"><span class="cls_004">It can get added to any object in the repository. And because the rating web scripts deal</span></div>
<div style="position:absolute;left:56.69px;top:191.82px" class="cls_004"><span class="cls_004">with Node IDs, the ratings web scripts and widget will work on anything SomeCo decides</span></div>
<div style="position:absolute;left:56.69px;top:204.42px" class="cls_004"><span class="cls_004">to make rateable in the future.</span></div>
<div style="position:absolute;left:56.69px;top:241.12px" class="cls_014"><span class="cls_014">Dealing with the cross-domain scripting limitation</span></div>
<div style="position:absolute;left:56.69px;top:266.34px" class="cls_004"><span class="cls_004">You may have noticed that all the URL examples use localhost. In fact, for development,</span></div>
<div style="position:absolute;left:56.69px;top:278.94px" class="cls_004"><span class="cls_004">SomeCo's HTML pages (whitepaper index and whitepaper detail) that make AJAX calls are</span></div>
<div style="position:absolute;left:56.69px;top:291.54px" class="cls_004"><span class="cls_004">also on localhost. In real life, however, it is highly likely that the code making AJAX calls to</span></div>
<div style="position:absolute;left:56.69px;top:304.14px" class="cls_004"><span class="cls_004">your web scripts will reside on a different host than the one where Alfresco lives. This</span></div>
<div style="position:absolute;left:56.69px;top:316.74px" class="cls_004"><span class="cls_004">creates a problem called the cross-domain scripting limitation. The issue is that for security</span></div>
<div style="position:absolute;left:56.69px;top:329.34px" class="cls_004"><span class="cls_004">reasons, browsers don't let you open an </span><span class="cls_013">XMLHttpRequest</span><span class="cls_004"> to a different host than the one</span></div>
<div style="position:absolute;left:56.69px;top:342.62px" class="cls_004"><span class="cls_004">serving the page. There are two ways you can handle this depending on your situation:</span></div>
<div style="position:absolute;left:104.69px;top:364.35px" class="cls_004"><span class="cls_004">Use a proxy servlet. Servers aren't subject to the browser's security constraints.</span></div>
<div style="position:absolute;left:104.69px;top:376.95px" class="cls_004"><span class="cls_004">They can make calls to any host they want. You can easily write your own Java</span></div>
<div style="position:absolute;left:104.69px;top:389.55px" class="cls_004"><span class="cls_004">servlet that acts as a reverse proxy. AJAX calls go against the proxy servlet hosted</span></div>
<div style="position:absolute;left:104.69px;top:402.15px" class="cls_004"><span class="cls_004">on the same domain as the page making the call, and the proxy servlet then</span></div>
<div style="position:absolute;left:104.69px;top:414.75px" class="cls_004"><span class="cls_004">invokes the web script on the other domain, and returns the results to the calling</span></div>
<div style="position:absolute;left:104.69px;top:427.35px" class="cls_004"><span class="cls_004">client.</span></div>
<div style="position:absolute;left:104.69px;top:442.12px" class="cls_004"><span class="cls_004">Enable CORS in Alfresco as we already explained in </span><span class="cls_010">Chapter 6</span><span class="cls_004">, </span><span class="cls_012">Creating an</span></div>
<div style="position:absolute;left:104.69px;top:455.10px" class="cls_012"><span class="cls_012">Angular Application</span><span class="cls_004">, by deploying the </span><span class="cls_013">enable-cors-1.0.jar</span><span class="cls_004"> file in the Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:468.38px" class="cls_004"><span class="cls_004">Repository.</span></div>
<div style="position:absolute;left:56.69px;top:509.42px" class="cls_008"><span class="cls_008">Handling form data</span></div>
<div style="position:absolute;left:56.69px;top:537.15px" class="cls_004"><span class="cls_004">The rating example makes an AJAX call using the POST method. What if, instead of using</span></div>
<div style="position:absolute;left:56.69px;top:549.75px" class="cls_004"><span class="cls_004">AJAX, you were simply posting an HTML form? The web script framework is able to</span></div>
<div style="position:absolute;left:56.69px;top:562.35px" class="cls_004"><span class="cls_004">handle form posts, including multi-part forms.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 311 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:220376px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background327.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">For example, let's implement a new HelloWorld example as a form post instead of passing</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">the name argument in the query string. We can use a static </span><span class="cls_013">HTML</span><span class="cls_004"> page to render the form,</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">but for the cost of an extra descriptor let's use a web script for both the </span><span class="cls_013">GET</span><span class="cls_004"> (to render the</span></div>
<div style="position:absolute;left:56.69px;top:109.66px" class="cls_004"><span class="cls_004">form) and the </span><span class="cls_013">POST</span><span class="cls_004"> (to process the form data). To do this, you'll need two descriptors (one</span></div>
<div style="position:absolute;left:56.69px;top:122.94px" class="cls_004"><span class="cls_004">for </span><span class="cls_013">GET</span><span class="cls_004"> and one for </span><span class="cls_013">POST</span><span class="cls_004">), two FreeMarker templates, and a JavaScript controller.</span></div>
<div style="position:absolute;left:56.69px;top:160.32px" class="cls_014"><span class="cls_014">Step-by-step - implementing a form-based Hello</span></div>
<div style="position:absolute;left:56.69px;top:181.92px" class="cls_014"><span class="cls_014">World</span></div>
<div style="position:absolute;left:56.69px;top:207.14px" class="cls_004"><span class="cls_004">To create a new version of the Hello World web script using a form, do the following:</span></div>
<div style="position:absolute;left:91.32px;top:228.87px" class="cls_004"><span class="cls_004">1. Create a descriptor for the </span><span class="cls_013">GET</span><span class="cls_004"> called </span><span class="cls_013">helloworldform.get.desc.xml</span><span class="cls_004"> in </span><span class="cls_013">repo</span></div>
<div style="position:absolute;left:104.69px;top:242.15px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">extension</span><span class="cls_004"> | </span><span class="cls_013">templates</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:255.43px" class="cls_013"><span class="cls_013">webscripts</span><span class="cls_004"> | </span><span class="cls_013">com</span><span class="cls_004"> | </span><span class="cls_013">someco</span><span class="cls_004"> with the following content:</span></div>
<div style="position:absolute;left:117.89px;top:279.32px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:139.49px;top:290.12px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Hello World Form&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:139.49px;top:300.92px" class="cls_010"><span class="cls_010">&lt;description&gt;Hello world form web script&lt;/description&gt;</span></div>
<div style="position:absolute;left:139.49px;top:311.72px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/helloworldform&lt;/url&gt;</span></div>
<div style="position:absolute;left:117.89px;top:322.52px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:91.32px;top:343.13px" class="cls_004"><span class="cls_004">2. Create a FreeMarker template for the </span><span class="cls_013">GET</span><span class="cls_004"> called</span></div>
<div style="position:absolute;left:104.69px;top:356.41px" class="cls_013"><span class="cls_013">helloworldform.get.html.ftl</span><span class="cls_004"> to present a simple form to capture the name.</span></div>
<div style="position:absolute;left:104.69px;top:369.69px" class="cls_004"><span class="cls_004">Add the following content:</span></div>
<div style="position:absolute;left:117.89px;top:392.90px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:139.49px;top:403.70px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:161.09px;top:414.50px" class="cls_010"><span class="cls_010">&lt;form action="${url.service}" method="post"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:425.30px" class="cls_010"><span class="cls_010">Name:&lt;input name="name"&gt;&lt;br /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:436.10px" class="cls_010"><span class="cls_010">&lt;input type="submit" name="submit" value="Go!"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:446.90px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:457.70px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:468.50px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:489.11px" class="cls_004"><span class="cls_004">3. Now write the web script that handles the </span><span class="cls_013">POST</span><span class="cls_004">. Create a </span><span class="cls_013">POST</span><span class="cls_004"> descriptor called</span></div>
<div style="position:absolute;left:104.69px;top:502.39px" class="cls_013"><span class="cls_013">helloworldform.post.desc.xml</span><span class="cls_004"> by copying the </span><span class="cls_013">GET</span><span class="cls_004"> descriptor. The two</span></div>
<div style="position:absolute;left:104.69px;top:515.67px" class="cls_004"><span class="cls_004">differ only in name and description:</span></div>
<div style="position:absolute;left:117.89px;top:538.88px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:161.09px;top:549.68px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Hello World Form Post&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:161.09px;top:560.48px" class="cls_010"><span class="cls_010">&lt;description&gt;Hello world form post web script&lt;/description&gt;</span></div>
<div style="position:absolute;left:161.09px;top:571.28px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/helloworldform&lt;/url&gt;</span></div>
<div style="position:absolute;left:117.89px;top:582.08px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 312 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:221052px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background328.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Create a JavaScript controller </span><span class="cls_013">helloworldform.post.js</span><span class="cls_004"> to put the name in the</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">model. This isn't strictly necessary. You could just grab the argument from the</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">FreeMarket template, but you're going to add to this controller in the next</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">example:</span></div>
<div style="position:absolute;left:117.89px;top:132.19px" class="cls_010"><span class="cls_010">model.name = args.name;</span></div>
<div style="position:absolute;left:91.32px;top:152.80px" class="cls_004"><span class="cls_004">5. Last, add a FreeMarker template for the </span><span class="cls_013">POST</span><span class="cls_004"> that echoes back the field value:</span></div>
<div style="position:absolute;left:117.89px;top:176.69px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:139.49px;top:187.49px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:150.29px;top:198.29px" class="cls_010"><span class="cls_010">&lt;p&gt;Hello, ${name}!&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:209.09px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:219.89px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:240.50px" class="cls_004"><span class="cls_004">6. Package, deploy, and test.</span></div>
<div style="position:absolute;left:56.69px;top:264.39px" class="cls_004"><span class="cls_004">When you navigate your browser to</span></div>
<div style="position:absolute;left:56.69px;top:276.99px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/helloworldform/">http://localhost:8080/alfresco/service/someco/helloworldform</a> <span class="cls_004">, you should</span></div>
<div style="position:absolute;left:56.69px;top:290.27px" class="cls_004"><span class="cls_004">see the form returned by the </span><span class="cls_013">GET</span><span class="cls_004"> FreeMarker template:</span></div>
<div style="position:absolute;left:56.69px;top:455.22px" class="cls_004"><span class="cls_004">When you specify a value and click </span><span class="cls_007">Go!</span><span class="cls_004">, the controller for the </span><span class="cls_013">POST</span><span class="cls_004"> extracts the field value</span></div>
<div style="position:absolute;left:56.69px;top:468.50px" class="cls_004"><span class="cls_004">and adds it to the model, so the FreeMarker template for the </span><span class="cls_013">POST</span><span class="cls_004"> can display it.</span></div>
<div style="position:absolute;left:56.69px;top:505.88px" class="cls_014"><span class="cls_014">Step-by-step - using file upload in a multipart</span></div>
<div style="position:absolute;left:56.69px;top:527.48px" class="cls_014"><span class="cls_014">request</span></div>
<div style="position:absolute;left:56.69px;top:552.70px" class="cls_004"><span class="cls_004">Web scripts can handle multipart forms. That means you can add a file upload control to a</span></div>
<div style="position:absolute;left:56.69px;top:565.30px" class="cls_004"><span class="cls_004">form and then do something with that file, such as persist it to the repository.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 313 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:221728px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background329.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The previous example was not a multipart form-the fields were passed to the controller as</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">part of the </span><span class="cls_013">args</span><span class="cls_004"> array. When using a multipart form, form fields reside in the </span><span class="cls_013">formdata</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">variable. To handle a file upload, all you have to do is know where to get the fields and the</span></div>
<div style="position:absolute;left:56.69px;top:108.98px" class="cls_004"><span class="cls_004">file and then do something with it. Let's modify the example you just did to handle a file</span></div>
<div style="position:absolute;left:56.69px;top:121.58px" class="cls_004"><span class="cls_004">upload. Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:143.31px" class="cls_004"><span class="cls_004">1. Create the </span><span class="cls_013">helloworldform2.get.html.ftl</span><span class="cls_004"> file to change the form to a</span></div>
<div style="position:absolute;left:104.69px;top:156.59px" class="cls_004"><span class="cls_004">multipart form, and add a file upload control like this:</span></div>
<div style="position:absolute;left:117.89px;top:179.80px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:128.69px;top:190.60px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:139.49px;top:201.40px" class="cls_010"><span class="cls_010">&lt;form action="${url.service}" method="post"</span></div>
<div style="position:absolute;left:161.09px;top:212.20px" class="cls_010"><span class="cls_010">enctype="multipart/form-data" accept-charset="utf-8"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:223.00px" class="cls_010"><span class="cls_010">Name:&lt;input name="name"&gt;&lt;br /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:233.80px" class="cls_010"><span class="cls_010">File:&lt;input type="file" name="file"&gt;&lt;br /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:244.60px" class="cls_010"><span class="cls_010">&lt;input type="submit" name="submit" value="Go!"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:255.40px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:128.69px;top:266.20px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:277.00px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:297.61px" class="cls_004"><span class="cls_004">2. Create the </span><span class="cls_013">helloworldform2.get.desc.xml</span><span class="cls_004">file:</span></div>
<div style="position:absolute;left:117.89px;top:321.50px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:139.49px;top:332.30px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Hello World Form 2&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:139.49px;top:343.10px" class="cls_010"><span class="cls_010">&lt;description&gt;Hello world form web script&lt;/description&gt;</span></div>
<div style="position:absolute;left:139.49px;top:353.90px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/helloworldform2&lt;/url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:364.70px" class="cls_010"><span class="cls_010">&lt;transaction&gt;none&lt;/transaction&gt;</span></div>
<div style="position:absolute;left:117.89px;top:375.50px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:91.32px;top:396.11px" class="cls_004"><span class="cls_004">3. Create the </span><span class="cls_013">helloworldform2.post.desc.xml</span><span class="cls_004">file:</span></div>
<div style="position:absolute;left:117.89px;top:420.00px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:128.69px;top:430.80px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Hello World Form Post 2&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:128.69px;top:441.60px" class="cls_010"><span class="cls_010">&lt;description&gt;Hello world form post web script&lt;/description&gt;</span></div>
<div style="position:absolute;left:128.69px;top:452.40px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/helloworldform2&lt;/url&gt;</span></div>
<div style="position:absolute;left:128.69px;top:463.20px" class="cls_010"><span class="cls_010">&lt;authentication runas="admin"&gt;guest&lt;/authentication&gt;</span></div>
<div style="position:absolute;left:128.69px;top:474.00px" class="cls_010"><span class="cls_010">&lt;transaction&gt;required&lt;/transaction&gt;</span></div>
<div style="position:absolute;left:117.89px;top:484.80px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 314 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:222404px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background330.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Create the </span><span class="cls_013">helloworldform2.post.js</span><span class="cls_004"> controller. Because this is a multipart</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">form, the fields are in the </span><span class="cls_013">formdata</span><span class="cls_004"> variable. The field object named </span><span class="cls_013">file</span><span class="cls_004"> will</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_004"><span class="cls_004">have special properties for the filename, mime type, and the content. First, add</span></div>
<div style="position:absolute;left:104.69px;top:109.66px" class="cls_004"><span class="cls_004">the code to extract these values:</span></div>
<div style="position:absolute;left:117.89px;top:132.87px" class="cls_010"><span class="cls_010">for each (field in formdata.fields) {</span></div>
<div style="position:absolute;left:134.09px;top:143.67px" class="cls_010"><span class="cls_010">if (field.name == "name") {</span></div>
<div style="position:absolute;left:150.29px;top:154.47px" class="cls_010"><span class="cls_010">model.name = field.value;</span></div>
<div style="position:absolute;left:134.09px;top:165.27px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:134.09px;top:176.07px" class="cls_010"><span class="cls_010">if (field.name == "file" &amp;&amp;field.isFile) {</span></div>
<div style="position:absolute;left:150.29px;top:186.87px" class="cls_010"><span class="cls_010">filename = field.filename;</span></div>
<div style="position:absolute;left:150.29px;top:197.67px" class="cls_010"><span class="cls_010">content = field.content;</span></div>
<div style="position:absolute;left:150.29px;top:208.47px" class="cls_010"><span class="cls_010">mimetype = field.mimetype;</span></div>
<div style="position:absolute;left:134.09px;top:219.27px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:230.07px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:250.68px" class="cls_004"><span class="cls_004">5. Then, add code that grabs a folder to save the content to, creates the content, sets</span></div>
<div style="position:absolute;left:104.69px;top:263.28px" class="cls_004"><span class="cls_004">some properties, and saves the new node:</span></div>
<div style="position:absolute;left:117.89px;top:286.49px" class="cls_010"><span class="cls_010">var results = search.luceneSearch("+PATH:"app:company_home/*"</span></div>
<div style="position:absolute;left:139.49px;top:297.29px" class="cls_010"><span class="cls_010">+TYPE:"cm:folder" +@cm\\:name:"Someco"");</span></div>
<div style="position:absolute;left:117.89px;top:318.89px" class="cls_010"><span class="cls_010">vartargetFolder = results[0];</span></div>
<div style="position:absolute;left:117.89px;top:329.69px" class="cls_010"><span class="cls_010">varnewDoc = targetFolder.createFile(filename);</span></div>
<div style="position:absolute;left:117.89px;top:340.49px" class="cls_010"><span class="cls_010">newDoc.properties.content.write(content);</span></div>
<div style="position:absolute;left:117.89px;top:351.29px" class="cls_010"><span class="cls_010">newDoc.properties.content.mimetype = mimetype;</span></div>
<div style="position:absolute;left:117.89px;top:362.09px" class="cls_010"><span class="cls_010">newDoc.save();</span></div>
<div style="position:absolute;left:117.89px;top:372.89px" class="cls_010"><span class="cls_010">model.node = newDoc;</span></div>
<div style="position:absolute;left:91.32px;top:393.50px" class="cls_004"><span class="cls_004">6. Finally, create the Freemarker for the </span><span class="cls_013">POST</span><span class="cls_004"> request in the</span></div>
<div style="position:absolute;left:104.69px;top:406.78px" class="cls_013"><span class="cls_013">helloworldform2.post.html.ft</span><span class="cls_004">l file:</span></div>
<div style="position:absolute;left:117.89px;top:430.67px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:139.49px;top:441.47px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:150.29px;top:452.27px" class="cls_010"><span class="cls_010">&lt;p&gt;Document Successfully Uploaded: ${node.name}!&lt;/p&gt;</span></div>
<div style="position:absolute;left:139.49px;top:463.07px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:473.87px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:91.32px;top:494.48px" class="cls_004"><span class="cls_004">7. Package, deploy and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 315 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:223080px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background331.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Before testing, be sure to create a folder called </span><span class="cls_013">Someco</span><span class="cls_004"> in your Alfresco repository. Now</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">when you point your browser to</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/helloworldform2/">http://localhost:8080/alfresco/service/someco/helloworldform2</a> <span class="cls_004">, you will see</span></div>
<div style="position:absolute;left:56.69px;top:109.66px" class="cls_004"><span class="cls_004">the new file upload control:</span></div>
<div style="position:absolute;left:56.69px;top:286.68px" class="cls_004"><span class="cls_004">After setting the name, selecting a file, and clicking </span><span class="cls_007">Go!</span><span class="cls_004">, you'll see a successful message. If</span></div>
<div style="position:absolute;left:56.69px;top:299.32px" class="cls_004"><span class="cls_004">you log in to the Alfresco Share and go to the </span><span class="cls_013">Someco</span><span class="cls_004"> folder, you should see the newly</span></div>
<div style="position:absolute;left:56.69px;top:312.60px" class="cls_004"><span class="cls_004">persisted file:</span></div>
<div style="position:absolute;left:56.69px;top:488.77px" class="cls_008"><span class="cls_008">Advanced web scripts</span></div>
<div style="position:absolute;left:56.69px;top:516.50px" class="cls_004"><span class="cls_004">Now that you have the basics under your belt, let's look at a few advanced web script</span></div>
<div style="position:absolute;left:56.69px;top:529.10px" class="cls_004"><span class="cls_004">topics.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 316 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:223756px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background332.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Dealing with web script authentication</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">How web scripts authenticate depends on the runtime you are using. HTTP-based web</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">scripts, such as the ones you built to work with whitepapers and ratings, are configured out</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">of the box to use basic authentication. If you invoke a web script that requires a higher level</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">of authentication than what's already taken place, the browser will present a basic</span></div>
<div style="position:absolute;left:56.69px;top:145.38px" class="cls_004"><span class="cls_004">authentication login dialog.</span></div>
<div style="position:absolute;left:56.69px;top:166.98px" class="cls_004"><span class="cls_004">If you have Alfresco configured to leverage an SSO provider such as CAS, web scripts will</span></div>
<div style="position:absolute;left:56.69px;top:179.58px" class="cls_004"><span class="cls_004">leverage the session created when the user logs in to the centralized login page. The</span></div>
<div style="position:absolute;left:56.69px;top:192.19px" class="cls_010"><span class="cls_010">Chapter 10</span><span class="cls_004">, </span><span class="cls_012">Security</span><span class="cls_004">, contains instructions for installing CAS and integrating it with</span></div>
<div style="position:absolute;left:56.69px;top:205.17px" class="cls_004"><span class="cls_004">Alfresco and Alfresco Share.</span></div>
<div style="position:absolute;left:56.69px;top:226.77px" class="cls_004"><span class="cls_004">If you are writing your own web pages that need to invoke authenticated web scripts, one</span></div>
<div style="position:absolute;left:56.69px;top:239.37px" class="cls_004"><span class="cls_004">approach is to use a web service call to get a ticket. The ticket is then added to the request.</span></div>
<div style="position:absolute;left:56.69px;top:251.97px" class="cls_004"><span class="cls_004">There is a web script that can give you a ticket based on username and password:</span></div>
<div style="position:absolute;left:56.69px;top:263.79px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/api/login?u=admin&amp;pw=admin/">http://localhost:8080/alfresco/service/api/login?u=admin&amp;pw=admin</a> </div>
<div style="position:absolute;left:56.69px;top:285.57px" class="cls_004"><span class="cls_004">You should receive an XML object like this one:</span></div>
<div style="position:absolute;left:74.69px;top:306.49px" class="cls_010"><span class="cls_010">&lt;?xml version="1.0" encoding="URF-8"?&gt;</span></div>
<div style="position:absolute;left:74.69px;top:317.29px" class="cls_010"><span class="cls_010">&lt;ticket&gt;TICKET_0a748bc2543f2b271dc4cb9955c11a042cad72cd&lt;/ticket&gt;</span></div>
<div style="position:absolute;left:56.69px;top:337.77px" class="cls_004"><span class="cls_004">Be aware that you can ask for a JSON object as well by calling</span></div>
<div style="position:absolute;left:56.69px;top:349.59px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/api/login.json?u=admin&amp;pw=admin/">http://localhost:8080/alfresco/service/api/login.json?u=admin&amp;pw=admin</a> </div>
<div style="position:absolute;left:56.69px;top:362.37px" class="cls_004"><span class="cls_004">and you'll receive a JSON object like this one:</span></div>
<div style="position:absolute;left:74.69px;top:383.29px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:90.89px;top:394.09px" class="cls_010"><span class="cls_010">"data":</span></div>
<div style="position:absolute;left:90.89px;top:404.89px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:85.49px;top:415.69px" class="cls_010"><span class="cls_010">"ticket":"TICKET_9306571267d178b130a570be150736b52c0506a3"</span></div>
<div style="position:absolute;left:90.89px;top:426.49px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:74.69px;top:437.29px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:457.77px" class="cls_004"><span class="cls_004">Then, you can call any web script by adding the </span><span class="cls_013">alf_ticket</span><span class="cls_004"> parameter like that:</span></div>
<div style="position:absolute;left:74.69px;top:479.37px" class="cls_010"><span class="cls_010">?alf_ticket=TICKET_9306571267d178b130a570be150736b52c0506a3</span></div>
<div style="position:absolute;left:56.69px;top:499.85px" class="cls_004"><span class="cls_004">You can find more information on this page:</span></div>
<div style="position:absolute;left:56.69px;top:512.45px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/ws-specify-user-identity.html">http://docs.alfresco.com/5.1/tasks/ws-specify-user-identity.html</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 317 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:224432px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background333.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Controlling web script cache</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">The web script descriptor includes a </span><span class="cls_013">cache</span><span class="cls_004"> element that can be used to attempt to influence</span></div>
<div style="position:absolute;left:56.69px;top:108.26px" class="cls_004"><span class="cls_004">how the web script response is cached. The following snippet shows how the cache is</span></div>
<div style="position:absolute;left:56.69px;top:120.86px" class="cls_004"><span class="cls_004">configured by default:</span></div>
<div style="position:absolute;left:74.69px;top:141.78px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:96.29px;top:163.38px" class="cls_010"><span class="cls_010">&lt;cache&gt;</span></div>
<div style="position:absolute;left:117.89px;top:174.18px" class="cls_010"><span class="cls_010">&lt;never&gt;true&lt;/never&gt;</span></div>
<div style="position:absolute;left:117.89px;top:184.98px" class="cls_010"><span class="cls_010">&lt;public&gt;false&lt;/public&gt;</span></div>
<div style="position:absolute;left:117.89px;top:195.78px" class="cls_010"><span class="cls_010">&lt;mustrevalidate&gt;true&lt;/mustrevalidate&gt;</span></div>
<div style="position:absolute;left:96.29px;top:206.58px" class="cls_010"><span class="cls_010">&lt;/cache&gt;</span></div>
<div style="position:absolute;left:74.69px;top:217.38px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:56.69px;top:237.86px" class="cls_004"><span class="cls_004">The cache settings are used as follows:</span></div>
<div style="position:absolute;left:104.69px;top:259.59px" class="cls_004"><span class="cls_004">Setting the </span><span class="cls_013">never</span><span class="cls_004"> element to </span><span class="cls_013">true</span><span class="cls_004"> says that the response should never be cached</span></div>
<div style="position:absolute;left:104.69px;top:275.03px" class="cls_004"><span class="cls_004">Specifying </span><span class="cls_013">false</span><span class="cls_004"> for the </span><span class="cls_013">public</span><span class="cls_004"> element means that the response should not be</span></div>
<div style="position:absolute;left:104.69px;top:288.31px" class="cls_004"><span class="cls_004">stored in a public cache</span></div>
<div style="position:absolute;left:104.69px;top:303.07px" class="cls_004"><span class="cls_004">Setting the </span><span class="cls_013">mustrevalidate</span><span class="cls_004"> element to </span><span class="cls_013">true</span><span class="cls_004"> indicates that the response</span></div>
<div style="position:absolute;left:104.69px;top:316.35px" class="cls_004"><span class="cls_004">contains dynamic content, and that the cache should always check to ensure it</span></div>
<div style="position:absolute;left:104.69px;top:328.95px" class="cls_004"><span class="cls_004">has the most up-to-date response</span></div>
<div style="position:absolute;left:56.69px;top:352.84px" class="cls_004"><span class="cls_004">As you can see, by default, web scripts are not configured to be cache-friendly. It is</span></div>
<div style="position:absolute;left:56.69px;top:365.44px" class="cls_004"><span class="cls_004">important to remember, however, that the web script runtime may or may not support the</span></div>
<div style="position:absolute;left:56.69px;top:378.04px" class="cls_004"><span class="cls_004">cache settings, and that caching the response is not the responsibility of the web script run</span></div>
<div style="position:absolute;left:56.69px;top:390.64px" class="cls_004"><span class="cls_004">time. It is handled by the proxy sitting in front of the web script and the client making the</span></div>
<div style="position:absolute;left:56.69px;top:403.24px" class="cls_004"><span class="cls_004">request.</span></div>
<div style="position:absolute;left:56.69px;top:424.84px" class="cls_004"><span class="cls_004">In the case of HTTP web scripts, the default settings create the following cache-related</span></div>
<div style="position:absolute;left:56.69px;top:437.44px" class="cls_004"><span class="cls_004">HTTP response headers:</span></div>
<div style="position:absolute;left:74.69px;top:458.36px" class="cls_010"><span class="cls_010">Cache-Control: no-cache</span></div>
<div style="position:absolute;left:74.69px;top:479.96px" class="cls_010"><span class="cls_010">Pragma: no-cache</span></div>
<div style="position:absolute;left:56.69px;top:500.44px" class="cls_004"><span class="cls_004">The most cache-friendly configuration for a web script would look like this:</span></div>
<div style="position:absolute;left:74.69px;top:521.36px" class="cls_010"><span class="cls_010">&lt;cache&gt;</span></div>
<div style="position:absolute;left:96.29px;top:532.16px" class="cls_010"><span class="cls_010">&lt;never&gt;false&lt;/never&gt;</span></div>
<div style="position:absolute;left:96.29px;top:542.96px" class="cls_010"><span class="cls_010">&lt;public&gt;true&lt;/public&gt;</span></div>
<div style="position:absolute;left:96.29px;top:553.76px" class="cls_010"><span class="cls_010">&lt;mustrevalidate&gt;false&lt;/mustrevalidate&gt;</span></div>
<div style="position:absolute;left:74.69px;top:564.56px" class="cls_010"><span class="cls_010">&lt;/cache&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 318 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:225108px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background334.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Exposing Content through a RESTful API with Web Scripts</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">With this configuration in place, the cache-related response headers no longer contain the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_013"><span class="cls_013">pragma</span><span class="cls_004"> setting, and </span><span class="cls_013">Cache-Control</span><span class="cls_004"> is set to </span><span class="cls_013">public</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:105.38px" class="cls_004"><span class="cls_004">Cache settings made in the descriptor can be overridden at runtime by manipulating the</span></div>
<div style="position:absolute;left:56.69px;top:117.98px" class="cls_013"><span class="cls_013">cache</span><span class="cls_004"> root object from within the </span><span class="cls_013">controller</span><span class="cls_004">. See the Appendix for a complete list of</span></div>
<div style="position:absolute;left:56.69px;top:131.26px" class="cls_004"><span class="cls_004">JavaScript root objects, including the </span><span class="cls_013">cache</span><span class="cls_004"> variable.</span></div>
<div style="position:absolute;left:56.69px;top:170.69px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:198.42px" class="cls_004"><span class="cls_004">This chapter gave you an introduction to the Alfresco Web Script Framework. You began</span></div>
<div style="position:absolute;left:56.69px;top:211.02px" class="cls_004"><span class="cls_004">with a very simple Hello World script and then gradually moved to more complex</span></div>
<div style="position:absolute;left:56.69px;top:223.62px" class="cls_004"><span class="cls_004">examples culminating in a REST API for retrieving whitepapers, getting the average rating</span></div>
<div style="position:absolute;left:56.69px;top:236.22px" class="cls_004"><span class="cls_004">for a specific whitepaper, posting new ratings for a given whitepaper, and deleting all</span></div>
<div style="position:absolute;left:56.69px;top:248.82px" class="cls_004"><span class="cls_004">ratings for a specific whitepaper.</span></div>
<div style="position:absolute;left:56.69px;top:270.42px" class="cls_004"><span class="cls_004">The SomeCo website was able to leverage the web scripts to add a whitepaper list along</span></div>
<div style="position:absolute;left:56.69px;top:283.02px" class="cls_004"><span class="cls_004">with a graphical ratings widget. The widget, the web scripts, and the backend model are</span></div>
<div style="position:absolute;left:56.69px;top:295.62px" class="cls_004"><span class="cls_004">generic enough to be used for other types of content as well.</span></div>
<div style="position:absolute;left:56.69px;top:317.22px" class="cls_004"><span class="cls_004">Other takeaways from this chapter include the following:</span></div>
<div style="position:absolute;left:104.69px;top:338.95px" class="cls_004"><span class="cls_004">Web scripts are mainly composed of an XML descriptor, one or more FreeMarker</span></div>
<div style="position:absolute;left:104.69px;top:351.55px" class="cls_004"><span class="cls_004">templates (one for each response format), and, optionally, a controller.</span></div>
<div style="position:absolute;left:104.69px;top:366.31px" class="cls_004"><span class="cls_004">Controllers can be implemented as JavaScript or Java, and have full access to the</span></div>
<div style="position:absolute;left:104.69px;top:378.91px" class="cls_004"><span class="cls_004">Alfresco API. Controllers share data with the view via the model, which is</span></div>
<div style="position:absolute;left:104.69px;top:391.51px" class="cls_004"><span class="cls_004">essentially a HashMap.</span></div>
<div style="position:absolute;left:104.69px;top:406.27px" class="cls_004"><span class="cls_004">The URL structure and the arguments a web script accepts are completely up to</span></div>
<div style="position:absolute;left:104.69px;top:418.87px" class="cls_004"><span class="cls_004">you.</span></div>
<div style="position:absolute;left:104.69px;top:433.63px" class="cls_004"><span class="cls_004">The level of authentication (</span><span class="cls_013">none</span><span class="cls_004">, </span><span class="cls_013">guest</span><span class="cls_004">, </span><span class="cls_013">user</span><span class="cls_004">, </span><span class="cls_013">admin</span><span class="cls_004">) required for a web script</span></div>
<div style="position:absolute;left:104.69px;top:446.91px" class="cls_004"><span class="cls_004">is defined in the descriptor. How a web script authenticates depends on the</span></div>
<div style="position:absolute;left:104.69px;top:459.51px" class="cls_004"><span class="cls_004">runtime.</span></div>
<div style="position:absolute;left:104.69px;top:474.27px" class="cls_004"><span class="cls_004">Web scripts can be deployed to either the classpath or the repository. Regardless</span></div>
<div style="position:absolute;left:104.69px;top:486.87px" class="cls_004"><span class="cls_004">of where they are deployed, the web script directory can be used to browse and</span></div>
<div style="position:absolute;left:104.69px;top:499.47px" class="cls_004"><span class="cls_004">refresh the available web scripts.</span></div>
<div style="position:absolute;left:104.69px;top:514.23px" class="cls_004"><span class="cls_004">Centralizing business logic into a service is a good practice. In this chapter, you</span></div>
<div style="position:absolute;left:104.69px;top:526.83px" class="cls_004"><span class="cls_004">created a rating service that centralized all logic related to creating rating nodes.</span></div>
<div style="position:absolute;left:56.69px;top:550.72px" class="cls_004"><span class="cls_004">Alfresco's Web Script Framework provides an easy way to integrate with the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:563.32px" class="cls_004"><span class="cls_004">repository. It is especially attractive when you are writing frontend code that leverages</span></div>
<div style="position:absolute;left:56.69px;top:575.92px" class="cls_004"><span class="cls_004">JavaScript toolkits, because those toolkits heavily utilize REST and AJAX.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 319 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:225784px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background335.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">8</span></div>
<div style="position:absolute;left:219.64px;top:167.48px" class="cls_011"><span class="cls_011">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">Every organization has business processes that lend themselves to automation. Often, these</span></div>
<div style="position:absolute;left:56.69px;top:239.07px" class="cls_004"><span class="cls_004">business processes are content-centric. In </span><span class="cls_010">Chapter 1</span><span class="cls_004">, </span><span class="cls_012">The Alfresco Platform</span><span class="cls_004"> you learned that</span></div>
<div style="position:absolute;left:56.69px;top:252.05px" class="cls_004"><span class="cls_004">Alfresco provides an embedded workflow engine called Activiti. In this chapter, you'll</span></div>
<div style="position:absolute;left:56.69px;top:264.65px" class="cls_004"><span class="cls_004">explore Alfresco's advanced workflow capability provided by this embedded workflow</span></div>
<div style="position:absolute;left:56.69px;top:277.25px" class="cls_004"><span class="cls_004">engine. Alfresco provides as well a product called Alfresco Activiti Suite, but this product is</span></div>
<div style="position:absolute;left:56.69px;top:289.85px" class="cls_004"><span class="cls_004">out of the scope of this book.</span></div>
<div style="position:absolute;left:56.69px;top:311.45px" class="cls_004"><span class="cls_004">Specifically, in this chapter you will learn:</span></div>
<div style="position:absolute;left:104.69px;top:333.18px" class="cls_004"><span class="cls_004">What workflow is and why you need a workflow engine</span></div>
<div style="position:absolute;left:104.69px;top:347.94px" class="cls_004"><span class="cls_004">How to create business process definitions using both a text editor and the Activti</span></div>
<div style="position:absolute;left:104.69px;top:360.54px" class="cls_004"><span class="cls_004">Graphical Process Designer</span></div>
<div style="position:absolute;left:104.69px;top:375.30px" class="cls_004"><span class="cls_004">The steps required to expose a custom business process to Alfresco Share</span></div>
<div style="position:absolute;left:104.69px;top:390.06px" class="cls_004"><span class="cls_004">How to add logic to workflows using expressions, JavaScript, and Java</span></div>
<div style="position:absolute;left:104.69px;top:404.82px" class="cls_004"><span class="cls_004">How to create an asynchronous process involving the Activiti Runtime Service,</span></div>
<div style="position:absolute;left:104.69px;top:417.42px" class="cls_004"><span class="cls_004">Alfresco Web Scripts, and actions</span></div>
<div style="position:absolute;left:104.69px;top:432.18px" class="cls_004"><span class="cls_004">How to debug workflows using Alfresco's workflow console and Activiti</span></div>
<div style="position:absolute;left:104.69px;top:444.78px" class="cls_004"><span class="cls_004">Explorer</span></div>
<div style="position:absolute;left:104.69px;top:459.54px" class="cls_004"><span class="cls_004">How to compare Alfresco's two options for workflow (advanced workflows and</span></div>
<div style="position:absolute;left:104.69px;top:472.14px" class="cls_004"><span class="cls_004">simple workflows)</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:226460px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background336.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">What is a workflow?</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">When Alfresco released version 1.4, it made a huge leap forward in enterprise readiness.</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">That was the release when Alfresco embedded the JBoss jBPM engine into the product,</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">which meant that enterprises could route Alfresco repository content through complex</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">business processes. In 2010, Alfresco launched Activiti to replace JBoss JBPM. Activiti can</span></div>
<div style="position:absolute;left:56.69px;top:147.78px" class="cls_004"><span class="cls_004">be used embedded in Alfresco, but also as a standalone. For a while, Alfresco supported</span></div>
<div style="position:absolute;left:56.69px;top:160.38px" class="cls_004"><span class="cls_004">both jBPM and Activiti as an embedded workflow engine. However, from the latest 5.x</span></div>
<div style="position:absolute;left:56.69px;top:172.98px" class="cls_004"><span class="cls_004">version, jBoss is considered as deprecated and shouldn't be used.</span></div>
<div style="position:absolute;left:56.69px;top:194.58px" class="cls_004"><span class="cls_004">Most content has some sort of process around it. That's why content repositories almost</span></div>
<div style="position:absolute;left:56.69px;top:207.18px" class="cls_004"><span class="cls_004">always have a mechanism to streamline, facilitate, and report against the business processes</span></div>
<div style="position:absolute;left:56.69px;top:219.78px" class="cls_004"><span class="cls_004">that produce, consume, or transform the content within them.</span></div>
<div style="position:absolute;left:122.09px;top:241.38px" class="cls_004"><span class="cls_004">The terms </span><span class="cls_013">workflow</span><span class="cls_004"> and </span><span class="cls_013">business process</span><span class="cls_004"> will be used</span></div>
<div style="position:absolute;left:122.09px;top:254.66px" class="cls_004"><span class="cls_004">interchangeably throughout this book.</span></div>
<div style="position:absolute;left:56.69px;top:300.78px" class="cls_004"><span class="cls_004">But before geeking out on the wonders of graph-based execution languages, let's agree on</span></div>
<div style="position:absolute;left:56.69px;top:313.39px" class="cls_004"><span class="cls_004">what the term </span><span class="cls_007">workflow</span><span class="cls_004"> means. Generically, </span><span class="cls_012">workflow may be considered a view or</span></div>
<div style="position:absolute;left:56.69px;top:326.03px" class="cls_012"><span class="cls_012">representation of real work. The flow being described may refer to a document, service or product that</span></div>
<div style="position:absolute;left:56.69px;top:338.63px" class="cls_012"><span class="cls_012">is being transferred from one step to another</span><span class="cls_004">. The term has been around since people started</span></div>
<div style="position:absolute;left:56.69px;top:351.23px" class="cls_004"><span class="cls_004">studying the nature of work in the early twentieth century in an effort to streamline</span></div>
<div style="position:absolute;left:56.69px;top:363.83px" class="cls_004"><span class="cls_004">manufacturing processes.</span></div>
<div style="position:absolute;left:56.69px;top:385.43px" class="cls_004"><span class="cls_004">In fact, in the world of ECM, it is sometimes helpful to think of an assembly line or</span></div>
<div style="position:absolute;left:56.69px;top:398.03px" class="cls_004"><span class="cls_004">manufacturing process when thinking about how content flows through an organization.</span></div>
<div style="position:absolute;left:56.69px;top:410.63px" class="cls_004"><span class="cls_004">Content is born of raw material (data), shaped and molded by one or more people</span></div>
<div style="position:absolute;left:56.69px;top:423.23px" class="cls_004"><span class="cls_004">(collaboration) or machines (systems), reviewed for quality, and delivered to consumers.</span></div>
<div style="position:absolute;left:56.69px;top:435.83px" class="cls_004"><span class="cls_004">Content may go through a single process or many sub processes. Content may take</span></div>
<div style="position:absolute;left:56.69px;top:448.43px" class="cls_004"><span class="cls_004">different routes through a process based on certain aspects of that content. The output of an</span></div>
<div style="position:absolute;left:56.69px;top:461.03px" class="cls_004"><span class="cls_004">organization or department of knowledge is essentially the content that comes rolling off</span></div>
<div style="position:absolute;left:56.69px;top:473.63px" class="cls_004"><span class="cls_004">the assembly line (the collection of workflows that define that organization's business</span></div>
<div style="position:absolute;left:56.69px;top:486.23px" class="cls_004"><span class="cls_004">processes).</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 321 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:227136px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background337.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Although not always formalized or automated, almost everyone in modern society has been</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">involved in a workflow in some way:</span></div>
<div style="position:absolute;left:104.69px;top:104.83px" class="cls_004"><span class="cls_004">When you submit an insurance claim, you are initiating a workflow.</span></div>
<div style="position:absolute;left:104.69px;top:119.59px" class="cls_004"><span class="cls_004">If you witness drunk and disorderly conduct on an airline flight and are asked to</span></div>
<div style="position:absolute;left:104.69px;top:132.19px" class="cls_004"><span class="cls_004">provide a statement to the airline, you are participating in a workflow. (Seriously,</span></div>
<div style="position:absolute;left:104.69px;top:144.79px" class="cls_004"><span class="cls_004">it happens more often than you'd think.)</span></div>
<div style="position:absolute;left:104.69px;top:159.55px" class="cls_004"><span class="cls_004">When you check on the status of your loan application, you are asking for</span></div>
<div style="position:absolute;left:104.69px;top:172.15px" class="cls_004"><span class="cls_004">metadata about a running workflow.</span></div>
<div style="position:absolute;left:104.69px;top:186.91px" class="cls_004"><span class="cls_004">When someone brings you a capital request that requires your approval because</span></div>
<div style="position:absolute;left:104.69px;top:199.51px" class="cls_004"><span class="cls_004">it is over a certain dollar amount, a characteristic of that request (the dollar</span></div>
<div style="position:absolute;left:104.69px;top:212.11px" class="cls_004"><span class="cls_004">amount) has triggered a decision within the workflow that routes the capital</span></div>
<div style="position:absolute;left:104.69px;top:224.71px" class="cls_004"><span class="cls_004">request to you.</span></div>
<div style="position:absolute;left:104.69px;top:239.47px" class="cls_004"><span class="cls_004">When you give the final approval for a piece of web content to be published, it is</span></div>
<div style="position:absolute;left:104.69px;top:252.07px" class="cls_004"><span class="cls_004">likely that you are completing a workflow.</span></div>
<div style="position:absolute;left:56.69px;top:275.96px" class="cls_004"><span class="cls_004">As varied as these examples are, all of them have a couple of things in common that make</span></div>
<div style="position:absolute;left:56.69px;top:288.56px" class="cls_004"><span class="cls_004">them relevant to ECM:</span></div>
<div style="position:absolute;left:104.69px;top:310.29px" class="cls_004"><span class="cls_004">they are examples of human-to-human and, in some cases, human-to-machine</span></div>
<div style="position:absolute;left:104.69px;top:322.89px" class="cls_004"><span class="cls_004">interaction</span></div>
<div style="position:absolute;left:104.69px;top:337.65px" class="cls_004"><span class="cls_004">they are content- or document-centric</span></div>
<div style="position:absolute;left:56.69px;top:361.54px" class="cls_004"><span class="cls_004">These are two very important characteristics that help clarify the kind of workflow most</span></div>
<div style="position:absolute;left:56.69px;top:374.14px" class="cls_004"><span class="cls_004">relevant to the ECM space. There are standalone workflow engines (Activiti is one of them)</span></div>
<div style="position:absolute;left:56.69px;top:386.74px" class="cls_004"><span class="cls_004">that can be used to model and execute all sorts of </span><span class="cls_022">“</span><span class="cls_004">repeatable patterns of activity</span><span class="cls_022">”</span><span class="cls_004"> with or</span></div>
<div style="position:absolute;left:56.69px;top:400.17px" class="cls_004"><span class="cls_004">without content. But in the world of ECM, patterns involving humans working with content</span></div>
<div style="position:absolute;left:56.69px;top:412.77px" class="cls_004"><span class="cls_004">are the focus. Of course, document-centric workflows may include fully automated steps</span></div>
<div style="position:absolute;left:56.69px;top:425.37px" class="cls_004"><span class="cls_004">and machine-to-machine interactions. The point is that document-centric workflows in</span></div>
<div style="position:absolute;left:56.69px;top:437.97px" class="cls_004"><span class="cls_004">which humans review, approve, or collaborate in some way are in the scope of the</span></div>
<div style="position:absolute;left:56.69px;top:450.57px" class="cls_004"><span class="cls_004">discussion, while processes that run lights-out system-to-system orchestration or</span></div>
<div style="position:absolute;left:56.69px;top:463.17px" class="cls_004"><span class="cls_004">integration are not.</span></div>
<div style="position:absolute;left:56.69px;top:499.87px" class="cls_014"><span class="cls_014">Workflow options</span></div>
<div style="position:absolute;left:56.69px;top:525.09px" class="cls_004"><span class="cls_004">Some of you are saying, </span><span class="cls_022">“</span><span class="cls_004">You're right. Workflows are everywhere. I could really streamline</span></div>
<div style="position:absolute;left:56.69px;top:538.52px" class="cls_004"><span class="cls_004">my organization by moving processes currently implemented with e-mail, phone calls, and</span></div>
<div style="position:absolute;left:56.69px;top:551.12px" class="cls_004"><span class="cls_004">cubical drive-bys into a more formalized workflow. What are my options?</span><span class="cls_022">”</span><span class="cls_004"> Let's talk about</span></div>
<div style="position:absolute;left:56.69px;top:564.55px" class="cls_004"><span class="cls_004">three: roll your own, standalone workflow engines, and embedded workflow engines.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 322 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:227812px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background338.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Roll your own</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">People are often tempted to meet their workflow requirements with custom code. Very</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">basic systems might be able to get by with a single flag on a record or an object that declares</span></div>
<div style="position:absolute;left:56.69px;top:117.78px" class="cls_004"><span class="cls_004">the status of the content such as </span><span class="cls_022">“</span><span class="cls_004">Draft</span><span class="cls_022">”</span><span class="cls_004">, or </span><span class="cls_022">“</span><span class="cls_004">In Review</span><span class="cls_022">”</span><span class="cls_004">, or </span><span class="cls_022">“</span><span class="cls_004">Approved</span><span class="cls_022">”</span><span class="cls_004">. But flags only</span></div>
<div style="position:absolute;left:56.69px;top:131.21px" class="cls_004"><span class="cls_004">capture the </span><span class="cls_022">“</span><span class="cls_004">state</span><span class="cls_022">”</span><span class="cls_004"> of a piece of content. If you want to automate how content moves from</span></div>
<div style="position:absolute;left:56.69px;top:144.64px" class="cls_004"><span class="cls_004">state to state, the coding and maintenance becomes more complex. Sure, you can write code</span></div>
<div style="position:absolute;left:56.69px;top:157.24px" class="cls_004"><span class="cls_004">as part of your application that knows that once draft documents are submitted for review,</span></div>
<div style="position:absolute;left:56.69px;top:169.84px" class="cls_004"><span class="cls_004">they need to go to Purchasing first, and then to Finance, if and only if the requested cash</span></div>
<div style="position:absolute;left:56.69px;top:182.44px" class="cls_004"><span class="cls_004">outlay is more than $10m. But do you really want to write it?</span></div>
<div style="position:absolute;left:56.69px;top:204.04px" class="cls_004"><span class="cls_004">People intent on rolling their own workflow often realize the maintenance problem this</span></div>
<div style="position:absolute;left:56.69px;top:216.64px" class="cls_004"><span class="cls_004">creates. So they create an abstraction used to describe the flow from state to state that keeps</span></div>
<div style="position:absolute;left:56.69px;top:229.24px" class="cls_004"><span class="cls_004">them from embedding that logic in compiled code. Once they've done that, they've</span></div>
<div style="position:absolute;left:56.69px;top:241.84px" class="cls_004"><span class="cls_004">essentially created their own proprietary workflow engine that no one else in the world</span></div>
<div style="position:absolute;left:56.69px;top:254.44px" class="cls_004"><span class="cls_004">knows how to run or maintain. And with all of the open source workflow engines available,</span></div>
<div style="position:absolute;left:56.69px;top:267.04px" class="cls_004"><span class="cls_004">this seems like a particularly flagrant waste of resources.</span></div>
<div style="position:absolute;left:56.69px;top:288.64px" class="cls_004"><span class="cls_004">For these reasons, the </span><span class="cls_022">“</span><span class="cls_004">roll your own</span><span class="cls_022">”</span><span class="cls_004"> option is really not recommended for any but the</span></div>
<div style="position:absolute;left:56.69px;top:302.07px" class="cls_004"><span class="cls_004">most basic workflow requirements.</span></div>
<div style="position:absolute;left:56.69px;top:336.72px" class="cls_023"><span class="cls_023">Standalone engines</span></div>
<div style="position:absolute;left:56.69px;top:359.43px" class="cls_004"><span class="cls_004">There are a number of standalone workflow engines, both open source and proprietary.</span></div>
<div style="position:absolute;left:56.69px;top:372.03px" class="cls_004"><span class="cls_004">They are sometimes more broadly referred to as </span><span class="cls_007">BPM</span><span class="cls_004"> (</span><span class="cls_007">Business Process Management</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:384.67px" class="cls_004"><span class="cls_004">systems. These are often extremely robust and scalable solutions that can be used to model,</span></div>
<div style="position:absolute;left:56.69px;top:397.27px" class="cls_004"><span class="cls_004">simulate, and execute any process you can think of, from high-volume loan processing to</span></div>
<div style="position:absolute;left:56.69px;top:409.87px" class="cls_004"><span class="cls_004">call center queue management. Often, these workflow engines are implemented in</span></div>
<div style="position:absolute;left:56.69px;top:422.47px" class="cls_004"><span class="cls_004">conjunction with a rules engine that lets business users have control over complicated if-</span></div>
<div style="position:absolute;left:56.69px;top:435.07px" class="cls_004"><span class="cls_004">then-else decision trees.</span></div>
<div style="position:absolute;left:56.69px;top:456.67px" class="cls_004"><span class="cls_004">Standalone engines are most appropriate for extremely high volume or exceedingly</span></div>
<div style="position:absolute;left:56.69px;top:469.27px" class="cls_004"><span class="cls_004">complex solutions involving multiple systems. Another good use for standalone engines is</span></div>
<div style="position:absolute;left:56.69px;top:481.87px" class="cls_004"><span class="cls_004">when you are developing a custom application that has workflow requirements. Standalone</span></div>
<div style="position:absolute;left:56.69px;top:494.47px" class="cls_004"><span class="cls_004">engines can usually talk to any database or content management repository you might have</span></div>
<div style="position:absolute;left:56.69px;top:507.07px" class="cls_004"><span class="cls_004">implemented. But they won't be as tightly integrated into the content management system's</span></div>
<div style="position:absolute;left:56.69px;top:519.67px" class="cls_004"><span class="cls_004">user interface as the workflow engine built into a CMS. For this reason, for content-centric</span></div>
<div style="position:absolute;left:56.69px;top:532.27px" class="cls_004"><span class="cls_004">solutions that operate mostly within the scope of a CMS, it is usually less complicated (and</span></div>
<div style="position:absolute;left:56.69px;top:544.87px" class="cls_004"><span class="cls_004">less expensive) to use the workflow engine embedded within the CMS, provided it has</span></div>
<div style="position:absolute;left:56.69px;top:557.47px" class="cls_004"><span class="cls_004">enough functionality to meet the workflow requirements of the business.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 323 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:228488px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background339.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Embedded workflow engines</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">Almost every CMS available today, whether open source or proprietary, has a workflow</span></div>
<div style="position:absolute;left:56.69px;top:105.18px" class="cls_004"><span class="cls_004">engine of some sort embedded within it. However, the capability of each of these varies</span></div>
<div style="position:absolute;left:56.69px;top:117.78px" class="cls_004"><span class="cls_004">widely.</span></div>
<div style="position:absolute;left:56.69px;top:139.38px" class="cls_004"><span class="cls_004">The major benefit of leveraging an embedded workflow engine is the tight level of</span></div>
<div style="position:absolute;left:56.69px;top:151.98px" class="cls_004"><span class="cls_004">integration for users as well as developers. Users can initiate and interact with workflows</span></div>
<div style="position:absolute;left:56.69px;top:164.58px" class="cls_004"><span class="cls_004">without leaving the CMS client. Typically, developers customizing or extending the CMS</span></div>
<div style="position:absolute;left:56.69px;top:177.18px" class="cls_004"><span class="cls_004">can work with workflows using the core CMS API.</span></div>
<div style="position:absolute;left:56.69px;top:198.78px" class="cls_004"><span class="cls_004">Alfresco is an </span><span class="cls_022">“</span><span class="cls_004">embedded workflow engine</span><span class="cls_022">”</span><span class="cls_004"> example. It embeds Activiti, which is an</span></div>
<div style="position:absolute;left:56.69px;top:212.21px" class="cls_004"><span class="cls_004">example of a standalone engine.</span></div>
<div style="position:absolute;left:56.69px;top:250.96px" class="cls_008"><span class="cls_008">Creating process definitions</span></div>
<div style="position:absolute;left:56.69px;top:278.69px" class="cls_004"><span class="cls_004">Activiti is an open source, standalone workflow engine. OK, it is more than</span></div>
<div style="position:absolute;left:56.69px;top:291.29px" class="cls_004"><span class="cls_004">just a standalone workflow engine. Activiti calls itself a </span><span class="cls_022">“</span><span class="cls_004">a light-weight workflow and</span></div>
<div style="position:absolute;left:56.69px;top:304.72px" class="cls_004"><span class="cls_004">Business Process Management (BPM) Platform targeted at business people, developers and</span></div>
<div style="position:absolute;left:56.69px;top:317.32px" class="cls_004"><span class="cls_004">system admins</span><span class="cls_022">”</span><span class="cls_004">. Workflow is one of several different domains that can be addressed with a</span></div>
<div style="position:absolute;left:56.69px;top:330.75px" class="cls_004"><span class="cls_004">graph-based execution language, but it is the only one this book concerns itself with.</span></div>
<div style="position:absolute;left:56.69px;top:352.35px" class="cls_004"><span class="cls_004">The Activiti engine is responsible for managing deployed processes, instantiating and</span></div>
<div style="position:absolute;left:56.69px;top:364.95px" class="cls_004"><span class="cls_004">executing processes, persisting process state and metadata to a relational database and</span></div>
<div style="position:absolute;left:56.69px;top:377.55px" class="cls_004"><span class="cls_004">tracking task assignment and task lists.</span></div>
<div style="position:absolute;left:56.69px;top:399.15px" class="cls_004"><span class="cls_004">Activiti is built on the idea that any process can be described as a graph or a set of</span></div>
<div style="position:absolute;left:56.69px;top:411.75px" class="cls_004"><span class="cls_004">connected nodes. Workflows are described with </span><span class="cls_022">“</span><span class="cls_004">process definitions</span><span class="cls_022">”</span><span class="cls_004"> using an XML-based</span></div>
<div style="position:absolute;left:56.69px;top:425.18px" class="cls_004"><span class="cls_004">language called </span><span class="cls_007">Business Process Model and Notation</span><span class="cls_004"> (</span><span class="cls_007">BPMN</span><span class="cls_004">). BPMN is a standard for</span></div>
<div style="position:absolute;left:56.69px;top:437.82px" class="cls_004"><span class="cls_004">modeling business processes. It's one example of a graph-based execution language. Activiti</span></div>
<div style="position:absolute;left:56.69px;top:450.42px" class="cls_004"><span class="cls_004">especially works on BPMN 2.0.</span></div>
<div style="position:absolute;left:56.69px;top:472.02px" class="cls_004"><span class="cls_004">In Activiti, each node represents a step in a workflow. Connections between nodes signify</span></div>
<div style="position:absolute;left:56.69px;top:484.62px" class="cls_004"><span class="cls_004">the transition from one step to another. Creating a process definition is a matter of creating</span></div>
<div style="position:absolute;left:56.69px;top:497.22px" class="cls_004"><span class="cls_004">nodes to represent steps in the process and connecting them</span></div>
<div style="position:absolute;left:56.69px;top:509.82px" class="cls_004"><span class="cls_004">with transitions.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 324 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:229164px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background340.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - creating a Hello World process</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">definition</span></div>
<div style="position:absolute;left:56.69px;top:116.58px" class="cls_004"><span class="cls_004">Let's get your feet wet by writing a simple process. Conceptually, the process looks like this:</span></div>
<div style="position:absolute;left:56.69px;top:183.35px" class="cls_004"><span class="cls_004">The process has three nodes. Node A and Node C are the Start and Stop nodes. Node B will</span></div>
<div style="position:absolute;left:56.69px;top:195.95px" class="cls_004"><span class="cls_004">write a message to the log. For now, you'll implement this process using raw XML and</span></div>
<div style="position:absolute;left:56.69px;top:208.55px" class="cls_004"><span class="cls_004">deploy and run it using Alfresco's workflow console. In later examples, you'll use the</span></div>
<div style="position:absolute;left:56.69px;top:221.15px" class="cls_004"><span class="cls_004">Activiti Graphical Process Designer to design and deploy the process, and Alfresco Share to</span></div>
<div style="position:absolute;left:56.69px;top:233.75px" class="cls_004"><span class="cls_004">instantiate and run the workflow.</span></div>
<div style="position:absolute;left:56.69px;top:255.35px" class="cls_004"><span class="cls_004">To create a simple Hello World process, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:277.08px" class="cls_004"><span class="cls_004">1. In your Eclipse project, create a new folder structure called | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:290.36px" class="cls_013"><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">workflows</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:305.80px" class="cls_004"><span class="cls_004">2. Within the new </span><span class="cls_013">worfklows</span><span class="cls_004"> folder, create a new XML file called</span></div>
<div style="position:absolute;left:104.69px;top:319.08px" class="cls_013"><span class="cls_013">HelloWorldProcess.bpmn20.xml</span><span class="cls_004">  with the following content:</span></div>
<div style="position:absolute;left:117.89px;top:342.97px" class="cls_010"><span class="cls_010">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:353.77px" class="cls_010"><span class="cls_010">&lt;definitions id="definitions"</span></div>
<div style="position:absolute;left:134.09px;top:364.57px" class="cls_010"><span class="cls_010">targetNamespace="</span><a href="http://activiti.org/bpmn20" "="">http://activiti.org/bpmn20"</a> </div>
<div style="position:absolute;left:134.09px;top:375.37px" class="cls_010"><span class="cls_010">xmlns:activiti="</span><a href="http://activiti.org/bpmn" "="">http://activiti.org/bpmn"</a> </div>
<div style="position:absolute;left:134.09px;top:386.17px" class="cls_010"><span class="cls_010">xmlns="</span><a href="http://www.omg.org/spec/bpmn/20100524/model" "="">http://www.omg.org/spec/BPMN/20100524/MODEL"</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:396.97px" class="cls_010"><span class="cls_010">&lt;process id="helloWorld" name="Hello World Process"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:407.77px" class="cls_010"><span class="cls_010">&lt;startEvent id="theStart" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:418.57px" class="cls_010"><span class="cls_010">&lt;sequenceFlow id='flow1' sourceRef='theStart'</span></div>
<div style="position:absolute;left:161.09px;top:429.37px" class="cls_010"><span class="cls_010">targetRef='hello' /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:440.17px" class="cls_010"><span class="cls_010">&lt;serviceTask id="hello" name="Hello Task"</span></div>
<div style="position:absolute;left:161.09px;top:450.97px" class="cls_010"><span class="cls_010">activiti:class="org.alfresco.repo.workflow</span></div>
<div style="position:absolute;left:161.09px;top:461.77px" class="cls_010"><span class="cls_010">.activiti.script.AlfrescoScriptDelegate"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:483.37px" class="cls_010"><span class="cls_010">&lt;extensionElements&gt;</span></div>
<div style="position:absolute;left:161.09px;top:494.17px" class="cls_010"><span class="cls_010">&lt;activiti:field name="script"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:504.97px" class="cls_010"><span class="cls_010">&lt;activiti:string&gt;&lt;![CDATA[logger</span></div>
<div style="position:absolute;left:193.49px;top:515.77px" class="cls_010"><span class="cls_010">.log("Hello World!");]]&gt;</span></div>
<div style="position:absolute;left:182.69px;top:526.57px" class="cls_010"><span class="cls_010">&lt;/activiti:string&gt;</span></div>
<div style="position:absolute;left:161.09px;top:537.37px" class="cls_010"><span class="cls_010">&lt;/activiti:field&gt;</span></div>
<div style="position:absolute;left:139.49px;top:548.17px" class="cls_010"><span class="cls_010">&lt;/extensionElements&gt;</span></div>
<div style="position:absolute;left:139.49px;top:558.97px" class="cls_010"><span class="cls_010">&lt;/serviceTask&gt;</span></div>
<div style="position:absolute;left:139.49px;top:569.77px" class="cls_010"><span class="cls_010">&lt;sequenceFlow id='flow2' sourceRef='hello'</span></div>
<div style="position:absolute;left:161.09px;top:580.57px" class="cls_010"><span class="cls_010">targetRef='theEnd' /&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 325 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:229840px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background341.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">&lt;endEvent id="theEnd" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/process&gt;</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">&lt;/definitions&gt;</span></div>
<div style="position:absolute;left:91.32px;top:122.83px" class="cls_004"><span class="cls_004">3. Save the file.</span></div>
<div style="position:absolute;left:91.32px;top:137.59px" class="cls_004"><span class="cls_004">4. Double-check that in</span></div>
<div style="position:absolute;left:104.69px;top:149.41px" class="cls_013"><span class="cls_013">repo|src|main|amp|config|alfresco|module|repo|log4j.properties</span></div>
<div style="position:absolute;left:104.69px;top:162.19px" class="cls_004"><span class="cls_004">you've got </span><span class="cls_013">log4j.logger.org.alfresco.repo.jscript</span><span class="cls_004"> set to debug.</span></div>
<div style="position:absolute;left:91.32px;top:177.63px" class="cls_004"><span class="cls_004">5. Package, deploy and restart Tomcat.</span></div>
<div style="position:absolute;left:91.32px;top:192.39px" class="cls_004"><span class="cls_004">6. Log in to the Alfresco Admin Console client as admin</span></div>
<div style="position:absolute;left:104.69px;top:204.99px" class="cls_004"><span class="cls_004">(</span><a href="http://localhost:8080/alfresco/s/enterprise/admin/admin-system/">http://localhost:8080/alfresco/s/enterprise/admin/admin-system</a> </div>
<div style="position:absolute;left:104.69px;top:218.27px" class="cls_013"><span class="cls_013">summary</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:91.32px;top:233.71px" class="cls_004"><span class="cls_004">7. Click on the </span><span class="cls_040">Workflow Console</span><span class="cls_004"> menu item in the left.</span></div>
<div style="position:absolute;left:91.32px;top:249.15px" class="cls_004"><span class="cls_004">8. Use the console to deploy the workflow. Type the following command and click</span></div>
<div style="position:absolute;left:104.69px;top:261.75px" class="cls_004"><span class="cls_004">Execute:</span></div>
<div style="position:absolute;left:117.89px;top:284.96px" class="cls_010"><span class="cls_010">deploy activiti alfresco/module/repo</span></div>
<div style="position:absolute;left:139.49px;top:295.76px" class="cls_010"><span class="cls_010">/workflows/HelloWorldProcess.bpmn20.xml</span></div>
<div style="position:absolute;left:124.19px;top:316.24px" class="cls_004"><span class="cls_004">The console should respond with something similar to:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 326 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:230516px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background342.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. Now start a workflow using this process definition. The console already has the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">newly deployed workflow in context, so type </span><span class="cls_007">start</span><span class="cls_004"> and click </span><span class="cls_007">Execute</span><span class="cls_004">. The console</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">should respond with something similar to:</span></div>
<div style="position:absolute;left:86.07px;top:291.42px" class="cls_004"><span class="cls_004">10. As you can see by the console output, you have an exception Worfklow path does</span></div>
<div style="position:absolute;left:104.69px;top:304.02px" class="cls_004"><span class="cls_004">not exist, generated by the Java method called getTasksForWorkflowPath. You</span></div>
<div style="position:absolute;left:104.69px;top:316.62px" class="cls_004"><span class="cls_004">may think that it failed, so let's check the log file. You should be able to see a trace</span></div>
<div style="position:absolute;left:104.69px;top:329.22px" class="cls_004"><span class="cls_004">similar to this one:</span></div>
<div style="position:absolute;left:117.89px;top:352.43px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.ScriptLogger] [http-apr-8080-exec-8]</span></div>
<div style="position:absolute;left:128.69px;top:363.23px" class="cls_010"><span class="cls_010">Hello World!</span></div>
<div style="position:absolute;left:56.69px;top:383.71px" class="cls_004"><span class="cls_004">So, it means that our workflow has been properly executed. Let's explain why we have an</span></div>
<div style="position:absolute;left:56.69px;top:396.31px" class="cls_004"><span class="cls_004">error message. Our workflow definition contains one start event, one service task, and one</span></div>
<div style="position:absolute;left:56.69px;top:408.91px" class="cls_004"><span class="cls_004">end event. It doesn't include any user task. When the workflow is started, it transitions</span></div>
<div style="position:absolute;left:56.69px;top:421.51px" class="cls_004"><span class="cls_004">automatically to the service task and then completes. It's why we have an error message; the</span></div>
<div style="position:absolute;left:56.69px;top:434.11px" class="cls_004"><span class="cls_004">console wants to display the current tasks for this workflow instance, but the instance is</span></div>
<div style="position:absolute;left:56.69px;top:446.71px" class="cls_004"><span class="cls_004">already completed so the workflow path doesn't exist anymore.</span></div>
<div style="position:absolute;left:56.69px;top:468.31px" class="cls_004"><span class="cls_004">This was almost the simplest process you could possibly define, but you learned that:</span></div>
<div style="position:absolute;left:104.69px;top:490.04px" class="cls_004"><span class="cls_004">Processes can be defined with plain XML.</span></div>
<div style="position:absolute;left:104.69px;top:504.80px" class="cls_004"><span class="cls_004">Processes can reside in the Alfresco classpath. In this case, you used the</span></div>
<div style="position:absolute;left:104.69px;top:517.40px" class="cls_004"><span class="cls_004">workflows directory located in your module.</span></div>
<div style="position:absolute;left:104.69px;top:532.16px" class="cls_004"><span class="cls_004">Processes can be deployed and started using the Alfresco workflow console.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 327 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:231192px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background343.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.51px" class="cls_004"><span class="cls_004">Be aware that Alfresco Enterprise also provides another user interface called </span><span class="cls_012">Activiti</span></div>
<div style="position:absolute;left:56.69px;top:83.11px" class="cls_012"><span class="cls_012">Explorer</span><span class="cls_004"> or </span><span class="cls_012">Activiti Workflow Console</span><span class="cls_004">. To open it, click on the menu item </span><span class="cls_007">Process Engines</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:95.75px" class="cls_004"><span class="cls_004">then click on </span><span class="cls_007">Activiti Workflow Console</span><span class="cls_004">. If you click on the item </span><span class="cls_007">Deployed process</span></div>
<div style="position:absolute;left:56.69px;top:108.39px" class="cls_007"><span class="cls_007">definitions</span><span class="cls_004">, you should be able to see the </span><span class="cls_012">Hello World</span><span class="cls_004"> process that we deployed:</span></div>
<div style="position:absolute;left:56.69px;top:389.91px" class="cls_004"><span class="cls_004">You could have deployed your process definition by clicking on </span><span class="cls_007">Deployments, Upload</span></div>
<div style="position:absolute;left:56.69px;top:402.55px" class="cls_007"><span class="cls_007">New</span><span class="cls_004"> in the top menu.</span></div>
<div style="position:absolute;left:56.69px;top:441.34px" class="cls_008"><span class="cls_008">Using the Activiti graphical process</span></div>
<div style="position:absolute;left:56.69px;top:465.34px" class="cls_008"><span class="cls_008">designer</span></div>
<div style="position:absolute;left:56.69px;top:493.07px" class="cls_004"><span class="cls_004">One of the nice things about Activiti is that a graphical tool is available as an Eclipse plugin</span></div>
<div style="position:absolute;left:56.69px;top:505.67px" class="cls_004"><span class="cls_004">for creating and deploying process definitions, called the </span><span class="cls_007">ActivitiDesigner</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:527.30px" class="cls_004"><span class="cls_004">There are people in the business of marketing workflow tools who love to say things such</span></div>
<div style="position:absolute;left:56.69px;top:539.90px" class="cls_004"><span class="cls_004">as </span><span class="cls_022">“</span><span class="cls_004">Using the graphical process designer, business analysts can create advanced workflows</span></div>
<div style="position:absolute;left:56.69px;top:553.33px" class="cls_004"><span class="cls_004">without writing any code!</span><span class="cls_022">”</span><span class="cls_004"> Graphical process designers are definitely useful, but be</span></div>
<div style="position:absolute;left:56.69px;top:566.76px" class="cls_004"><span class="cls_004">realistic. Code has to be written.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 328 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:231868px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background344.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The designer is most useful for quickly designing the process, setting node properties, and</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">connecting nodes. Once that's done, you may have to switch over to the XML to finish out</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">the definition.</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">The Activiti Designer is freely available from </span><a href="http://www.activiti.org/userguide/#activitiDesigner">http://www.activiti.org/userguide/#acti</a> </div>
<div style="position:absolute;left:56.69px;top:130.28px" class="cls_010"><span class="cls_010"> </span><a href="http://www.activiti.org/userguide/#activitiDesigner">vitiDesigner</a> <span class="cls_004">. It installs as an Eclipse plugin. To install the plugin, click on </span><span class="cls_007">Help|Install</span></div>
<div style="position:absolute;left:56.69px;top:143.26px" class="cls_007"><span class="cls_007">New Software</span><span class="cls_004">, then use the update site </span><a href="http://activiti.org/designer/update/">http://activiti.org/designer/update/</a> <span class="cls_004"> and</span></div>
<div style="position:absolute;left:56.69px;top:156.24px" class="cls_004"><span class="cls_004">select the </span><span class="cls_007">Activiti Eclipse BPMN 2.0 Designer</span><span class="cls_004">. Click on </span><span class="cls_007">Next</span><span class="cls_004">, and then </span><span class="cls_007">Finish</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 329 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:232544px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background345.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">When Eclipse is restarted, if you do </span><span class="cls_007">File</span><span class="cls_004"> |</span><span class="cls_007"> New</span><span class="cls_004"> |</span><span class="cls_007"> Other</span><span class="cls_004"> and see </span><span class="cls_007">Activiti Diagram</span><span class="cls_004"> as shown</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">in the following screenshot, you've successfully installed the plugin:</span></div>
<div style="position:absolute;left:56.69px;top:403.51px" class="cls_014"><span class="cls_014">Step-by-Step - using Activiti process designer to</span></div>
<div style="position:absolute;left:56.69px;top:425.11px" class="cls_014"><span class="cls_014">create processes</span></div>
<div style="position:absolute;left:56.69px;top:450.33px" class="cls_004"><span class="cls_004">Let's jazz up the process a bit and this time, instead of raw XML, let's use the designer to</span></div>
<div style="position:absolute;left:56.69px;top:462.93px" class="cls_004"><span class="cls_004">create and deploy the process definition file.</span></div>
<div style="position:absolute;left:56.69px;top:484.53px" class="cls_004"><span class="cls_004">The HelloWorld process definition had a single path. Execution progressed from node A to</span></div>
<div style="position:absolute;left:56.69px;top:497.13px" class="cls_004"><span class="cls_004">node B to node C. In practice, however, most workflows have multiple execution paths.</span></div>
<div style="position:absolute;left:56.69px;top:509.73px" class="cls_004"><span class="cls_004">Consider the following figure:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 330 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:233220px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background346.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">By looking at the transitions, you can see that the path of execution will always be from</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">node A to node B. Node B has two outgoing paths. One path is to node C and the other to</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">node D. The paths converge on node E. Then, it goes to the node F. Note that from the</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">diagram it is impossible to tell which path will be taken. It's also possible that both could be</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">followed simultaneously.</span></div>
<div style="position:absolute;left:56.69px;top:142.50px" class="cls_004"><span class="cls_004">Let's implement the process described by the diagram using the designer. The result of that</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">will be a </span><span class="cls_013">HelloWorld2Process.bpmn20.xml</span><span class="cls_004"> file just like before. But the designer will</span></div>
<div style="position:absolute;left:56.69px;top:168.38px" class="cls_004"><span class="cls_004">enable you to create it more quickly than you would be able to by writing the XML from</span></div>
<div style="position:absolute;left:56.69px;top:180.98px" class="cls_004"><span class="cls_004">scratch. To do this, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:202.71px" class="cls_004"><span class="cls_004">1.</span></div>
<div style="position:absolute;left:104.69px;top:202.71px" class="cls_004"><span class="cls_004">In the repo Eclipse project, navigate to the </span><span class="cls_013">workflows</span><span class="cls_004"> directory you created for</span></div>
<div style="position:absolute;left:104.69px;top:215.99px" class="cls_004"><span class="cls_004">the Hello World example.</span></div>
<div style="position:absolute;left:91.32px;top:230.75px" class="cls_004"><span class="cls_004">2.</span></div>
<div style="position:absolute;left:104.69px;top:230.75px" class="cls_004"><span class="cls_004">Select </span><span class="cls_007">File| New| Other| Activiti | Activiti Diagram</span><span class="cls_004">. Specify</span></div>
<div style="position:absolute;left:104.69px;top:243.39px" class="cls_013"><span class="cls_013">HelloWorld2Process</span><span class="cls_004"> as the process name and click </span><span class="cls_007">Finish</span><span class="cls_004">. You'll notice that</span></div>
<div style="position:absolute;left:104.69px;top:256.67px" class="cls_004"><span class="cls_004">the file is called </span><span class="cls_013">HelloWorld2Process.bpmn</span><span class="cls_004">.You could keep it like that but to</span></div>
<div style="position:absolute;left:104.69px;top:269.95px" class="cls_004"><span class="cls_004">keep the same convention name, rename it </span><span class="cls_013">HelloWorld2Process.bpmn20.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:283.23px" class="cls_004"><span class="cls_004">If you want to rename it, be sure to close it first and then rename it. Otherwise,</span></div>
<div style="position:absolute;left:104.69px;top:295.83px" class="cls_004"><span class="cls_004">the Activiti designer may be confused. As well, because the extension will be</span></div>
<div style="position:absolute;left:104.69px;top:308.43px" class="cls_004"><span class="cls_004">XML. STS will open the standard XML Editor. You'll need to do a right click on</span></div>
<div style="position:absolute;left:104.69px;top:321.03px" class="cls_004"><span class="cls_004">the file, and click on </span><span class="cls_007">Open with|Other</span><span class="cls_028">…</span><span class="cls_007">.</span><span class="cls_004"> Then, select the </span><span class="cls_007">Activiti Diagram</span></div>
<div style="position:absolute;left:104.69px;top:334.46px" class="cls_007"><span class="cls_007">Editor</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:349.25px" class="cls_004"><span class="cls_004">3.</span></div>
<div style="position:absolute;left:104.69px;top:349.25px" class="cls_004"><span class="cls_004">The </span><span class="cls_007">main</span><span class="cls_004"> tab is used to lay out the process by selecting node types from the</span></div>
<div style="position:absolute;left:104.69px;top:361.89px" class="cls_004"><span class="cls_004">palette (such as </span><span class="cls_007">StartEvent</span><span class="cls_004">, </span><span class="cls_007">EndEvent</span><span class="cls_004">, </span><span class="cls_007">ParallelGateway</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:104.69px;top:374.53px" class="cls_007"><span class="cls_007">ExclusiveGateway</span><span class="cls_004">,</span><span class="cls_007">UserTask,</span><span class="cls_004"> and </span><span class="cls_007">ServiceTask</span><span class="cls_004">) and clicking on the canvas. Add</span></div>
<div style="position:absolute;left:104.69px;top:387.17px" class="cls_004"><span class="cls_004">a </span><span class="cls_007">StartEvent</span><span class="cls_004">, an </span><span class="cls_007">EndEvent</span><span class="cls_004">, two </span><span class="cls_007">ParallelGateway, </span><span class="cls_004">and two </span><span class="cls_007">AlfrescoScriptTask </span><span class="cls_004">to</span></div>
<div style="position:absolute;left:104.69px;top:399.80px" class="cls_004"><span class="cls_004">the canvas.</span></div>
<div style="position:absolute;left:91.32px;top:414.56px" class="cls_004"><span class="cls_004">4.</span></div>
<div style="position:absolute;left:104.69px;top:414.56px" class="cls_004"><span class="cls_004">Organize the nodes to appear roughly as they do in the node diagram shown</span></div>
<div style="position:absolute;left:104.69px;top:427.16px" class="cls_004"><span class="cls_004">earlier in this section.</span></div>
<div style="position:absolute;left:91.32px;top:441.92px" class="cls_004"><span class="cls_004">5.</span></div>
<div style="position:absolute;left:104.69px;top:441.92px" class="cls_004"><span class="cls_004">Node properties can be edited using the </span><span class="cls_007">Properties </span><span class="cls_004">view below the diagram</span></div>
<div style="position:absolute;left:104.69px;top:454.56px" class="cls_004"><span class="cls_004">view. Set the names of the two nodes to </span><span class="cls_007">Node C</span><span class="cls_004"> and </span><span class="cls_007">Node D</span><span class="cls_004"> respectively, and</span></div>
<div style="position:absolute;left:104.69px;top:467.20px" class="cls_004"><span class="cls_004">set the IDs of the same two nodes to </span><span class="cls_007">nodeC</span><span class="cls_004"> and </span><span class="cls_007">nodeD</span><span class="cls_004"> respectively. If you</span></div>
<div style="position:absolute;left:104.69px;top:479.83px" class="cls_004"><span class="cls_004">struggle to find the </span><span class="cls_007">Properties </span><span class="cls_004">view, you have two options. The first one is to add</span></div>
<div style="position:absolute;left:104.69px;top:492.47px" class="cls_004"><span class="cls_004">this view by clicking in the top menu in </span><span class="cls_007">Window|Show View|Properties</span><span class="cls_004">. Or</span></div>
<div style="position:absolute;left:104.69px;top:505.10px" class="cls_004"><span class="cls_004">you can open the Activiti perspective by clicking on </span><span class="cls_007">Window|Perspective|Open</span></div>
<div style="position:absolute;left:104.69px;top:517.74px" class="cls_007"><span class="cls_007">Perspective|Other</span><span class="cls_028">…</span><span class="cls_004"> and select </span><span class="cls_007">Activiti</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 331 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:233896px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background347.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. The </span><span class="cls_007">SequenceFlow </span><span class="cls_004">item is used to connect the nodes. Connect the nodes to</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">match the node diagram. You have two main options to create a transition. The</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">quickest one is to put your cursor on the task that will be the source of the</span></div>
<div style="position:absolute;left:104.69px;top:108.34px" class="cls_004"><span class="cls_004">transition. A menu should appear around the task and you'll be able to click on</span></div>
<div style="position:absolute;left:104.69px;top:120.94px" class="cls_004"><span class="cls_004">an arrow icon. The second option is to browse the palette on the right side of the</span></div>
<div style="position:absolute;left:104.69px;top:133.54px" class="cls_004"><span class="cls_004">editor and to click on </span><span class="cls_007">Connection|SequenceFlow</span><span class="cls_004">. When you are done, the</span></div>
<div style="position:absolute;left:104.69px;top:146.18px" class="cls_004"><span class="cls_004">process should look like this:</span></div>
<div style="position:absolute;left:91.32px;top:355.76px" class="cls_004"><span class="cls_004">7. Click on the white area, and open the </span><span class="cls_007">Properties</span><span class="cls_004"> view. Update the following</span></div>
<div style="position:absolute;left:104.69px;top:368.40px" class="cls_004"><span class="cls_004">attributes:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 332 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:234572px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background348.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">8. Click on each node C and D, open the </span><span class="cls_007">Properties</span><span class="cls_004"> view, select the tab Main config</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">and add the logger statement (be sure to display a different message in node D).</span></div>
<div style="position:absolute;left:91.32px;top:228.57px" class="cls_004"><span class="cls_004">9. Save the file.</span></div>
<div style="position:absolute;left:86.07px;top:243.33px" class="cls_004"><span class="cls_004">10. You could take the process and deploy it right now by re-packaging, and then</span></div>
<div style="position:absolute;left:104.69px;top:255.93px" class="cls_004"><span class="cls_004">deploying from the classpath using the workflow console as you did in the</span></div>
<div style="position:absolute;left:104.69px;top:268.53px" class="cls_004"><span class="cls_004">HelloWorld example. In this case, we'll use the Activiti Explorer as previously</span></div>
<div style="position:absolute;left:104.69px;top:281.13px" class="cls_004"><span class="cls_004">described by clicking on </span><span class="cls_007">Deployments|Upload new</span><span class="cls_004"> in the Activiti Explorer.</span></div>
<div style="position:absolute;left:104.69px;top:293.77px" class="cls_004"><span class="cls_004">When it's done, you should see your file listed in the list of deployments:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 333 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:235248px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background349.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. If you click on the tab </span><span class="cls_007">Deployed process definitions</span><span class="cls_004">, you should see as well your</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">new definition with the right diagram:</span></div>
<div style="position:absolute;left:86.07px;top:409.70px" class="cls_004"><span class="cls_004">12. Now test out the new process with the workflow console. Log in to the Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:422.30px" class="cls_004"><span class="cls_004">Administration Console as admin, and click on the menu item called Workflow</span></div>
<div style="position:absolute;left:104.69px;top:434.90px" class="cls_004"><span class="cls_004">Console.</span></div>
<div style="position:absolute;left:86.07px;top:449.66px" class="cls_004"><span class="cls_004">13. Type </span><span class="cls_007">show definitions all</span><span class="cls_004"> and click </span><span class="cls_007">Execute</span><span class="cls_004">. You should see an entry with the</span></div>
<div style="position:absolute;left:104.69px;top:462.29px" class="cls_004"><span class="cls_004">name equals to </span><span class="cls_007">activiti$helloWorld2</span><span class="cls_004">. Make a note of its ID, which will look</span></div>
<div style="position:absolute;left:104.69px;top:474.93px" class="cls_004"><span class="cls_004">something like </span><span class="cls_007">activiti$helloWorld2:1:315</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:489.73px" class="cls_004"><span class="cls_004">14. Tell the console you want to work in the context of the </span><span class="cls_007">helloWorld2 </span><span class="cls_004">definition.</span></div>
<div style="position:absolute;left:104.69px;top:502.36px" class="cls_004"><span class="cls_004">Type </span><span class="cls_007">use definition activiti$helloWorld2:1:315</span><span class="cls_004">, replacing</span></div>
<div style="position:absolute;left:104.69px;top:515.00px" class="cls_007"><span class="cls_007">activiti$helloWorld2:1:315</span><span class="cls_004"> with your specific ID, and then click </span><span class="cls_007">Execute.</span></div>
<div style="position:absolute;left:86.07px;top:529.80px" class="cls_004"><span class="cls_004">15. Start a new workflow. Type </span><span class="cls_007">start</span><span class="cls_004"> and click </span><span class="cls_007">Execute</span><span class="cls_004">. The console should respond</span></div>
<div style="position:absolute;left:104.69px;top:542.43px" class="cls_004"><span class="cls_004">with something similar to the previous example with the error message.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 334 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:235924px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background350.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">16. Check your log file and you should see the two following messages:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.ScriptLogger] [http-apr-8080-exec-3]</span></div>
<div style="position:absolute;left:117.89px;top:104.51px" class="cls_010"><span class="cls_010">Hello World! From Node C!</span></div>
<div style="position:absolute;left:117.89px;top:126.11px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.ScriptLogger] [http-apr-8080-exec-3]</span></div>
<div style="position:absolute;left:117.89px;top:136.91px" class="cls_010"><span class="cls_010">Hello World! From Node D!</span></div>
<div style="position:absolute;left:56.69px;top:170.44px" class="cls_023"><span class="cls_023">Tokens</span></div>
<div style="position:absolute;left:56.69px;top:193.15px" class="cls_004"><span class="cls_004">A token is like the </span><span class="cls_013">You Are Here</span><span class="cls_004"> flag for a process-it points to the execution state. The</span></div>
<div style="position:absolute;left:56.69px;top:206.43px" class="cls_004"><span class="cls_004">token moves from node-to-node as the process is executed. But it doesn't move on its own.</span></div>
<div style="position:absolute;left:56.69px;top:219.03px" class="cls_004"><span class="cls_004">Tokens only move when they are signaled. Let's look at an example. In the figure, when you</span></div>
<div style="position:absolute;left:56.69px;top:231.63px" class="cls_004"><span class="cls_004">initially execute the process, the token is at node </span><span class="cls_007">A</span><span class="cls_004">. Then the token will take the only path</span></div>
<div style="position:absolute;left:56.69px;top:244.27px" class="cls_004"><span class="cls_004">available to it, which is to move to node </span><span class="cls_007">B</span><span class="cls_004">. From node </span><span class="cls_007">B</span><span class="cls_004"> there are multiple paths available.</span></div>
<div style="position:absolute;left:56.69px;top:256.91px" class="cls_004"><span class="cls_004">In our example, we used a parallel gateway. The token spawned two child tokens, one for</span></div>
<div style="position:absolute;left:56.69px;top:269.51px" class="cls_004"><span class="cls_004">the path from node </span><span class="cls_007">B</span><span class="cls_004"> to node </span><span class="cls_007">C</span><span class="cls_004">, and one from node </span><span class="cls_007">B</span><span class="cls_004"> to node </span><span class="cls_007">D</span><span class="cls_004">. When the paths converge,</span></div>
<div style="position:absolute;left:56.69px;top:282.14px" class="cls_004"><span class="cls_004">the child tokens go away and the parent token resumes.</span></div>
<div style="position:absolute;left:56.69px;top:316.79px" class="cls_023"><span class="cls_023">Node types</span></div>
<div style="position:absolute;left:56.69px;top:339.50px" class="cls_004"><span class="cls_004">Nodes are typed (in a Java sense, not in a content sense). A node's type determines how it</span></div>
<div style="position:absolute;left:56.69px;top:352.10px" class="cls_004"><span class="cls_004">behaves. You saw in the previous example that both branches in the execution path were</span></div>
<div style="position:absolute;left:56.69px;top:364.70px" class="cls_004"><span class="cls_004">executed because both Hello World messages showed up in the log. Why didn't the</span></div>
<div style="position:absolute;left:56.69px;top:377.30px" class="cls_004"><span class="cls_004">execution proceed down only in a single path? It was because you used a parallel gateway,</span></div>
<div style="position:absolute;left:56.69px;top:389.90px" class="cls_004"><span class="cls_004">which is a special type of node that spawns concurrent paths of execution. The following</span></div>
<div style="position:absolute;left:56.69px;top:402.50px" class="cls_004"><span class="cls_004">table summarizes the node types available in Activiti out of the box:</span></div>
<div style="position:absolute;left:60.32px;top:427.71px" class="cls_024"><span class="cls_024">Node Type</span></div>
<div style="position:absolute;left:151.15px;top:427.71px" class="cls_024"><span class="cls_024">Description</span></div>
<div style="position:absolute;left:60.32px;top:446.25px" class="cls_025"><span class="cls_025">Start Event</span></div>
<div style="position:absolute;left:151.15px;top:446.25px" class="cls_025"><span class="cls_025">Only one allowed per process definition. Only outgoing transitions are</span></div>
<div style="position:absolute;left:151.15px;top:458.25px" class="cls_025"><span class="cls_025">allowed.</span></div>
<div style="position:absolute;left:60.32px;top:476.76px" class="cls_025"><span class="cls_025">Parallel Gateway</span></div>
<div style="position:absolute;left:151.15px;top:476.76px" class="cls_025"><span class="cls_025">Spawns multiple concurrent paths of execution. This node type is used to</span></div>
<div style="position:absolute;left:151.15px;top:488.76px" class="cls_025"><span class="cls_025">fork and to join the execution path.</span></div>
<div style="position:absolute;left:60.32px;top:507.27px" class="cls_025"><span class="cls_025">Exclusive Gateway</span></div>
<div style="position:absolute;left:151.15px;top:507.27px" class="cls_025"><span class="cls_025">Choice between multiple paths of execution. You'll see examples of how</span></div>
<div style="position:absolute;left:151.15px;top:519.27px" class="cls_025"><span class="cls_025">to implement the logic for a decision later in the chapter.</span></div>
<div style="position:absolute;left:60.32px;top:537.78px" class="cls_025"><span class="cls_025">User Task</span></div>
<div style="position:absolute;left:151.15px;top:537.78px" class="cls_025"><span class="cls_025">Used to model work that needs to be done by a human actor</span></div>
<div style="position:absolute;left:60.32px;top:556.29px" class="cls_025"><span class="cls_025">Script Task</span></div>
<div style="position:absolute;left:151.15px;top:556.29px" class="cls_025"><span class="cls_025">Represents an automatic activity.</span></div>
<div style="position:absolute;left:60.32px;top:574.80px" class="cls_025"><span class="cls_025">Java Service Task</span></div>
<div style="position:absolute;left:151.15px;top:574.80px" class="cls_025"><span class="cls_025">Used to invoke an external Java class.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 335 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:236600px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background351.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:60.32px;top:74.14px" class="cls_025"><span class="cls_025">Sub Process</span></div>
<div style="position:absolute;left:151.15px;top:74.14px" class="cls_025"><span class="cls_025">Represents a node that contains other nodes which on itself form a process</span></div>
<div style="position:absolute;left:151.15px;top:86.14px" class="cls_025"><span class="cls_025">that is part of the bigger process.</span></div>
<div style="position:absolute;left:60.32px;top:104.65px" class="cls_025"><span class="cls_025">Call Activity</span></div>
<div style="position:absolute;left:151.15px;top:104.65px" class="cls_025"><span class="cls_025">Calls an external subprocess (it's different to the previous node that</span></div>
<div style="position:absolute;left:151.15px;top:116.65px" class="cls_025"><span class="cls_025">executes an embedded subprocess)</span></div>
<div style="position:absolute;left:60.32px;top:135.16px" class="cls_025"><span class="cls_025">End Event</span></div>
<div style="position:absolute;left:151.15px;top:135.16px" class="cls_025"><span class="cls_025">Marks the end of a process. Only incoming transitions are allowed.</span></div>
<div style="position:absolute;left:56.69px;top:175.26px" class="cls_004"><span class="cls_004">The preceding table contains only the most useful node types. Feel free to check the Activiti</span></div>
<div style="position:absolute;left:56.69px;top:187.86px" class="cls_004"><span class="cls_004">documentation that describe all possible node types (</span><a href="http://www.activiti.org/userguide/">http://www.activiti.org/userguid</a> </div>
<div style="position:absolute;left:56.69px;top:200.84px" class="cls_010"><span class="cls_010"> </span><a href="http://www.activiti.org/userguide/">e/</a> <span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:235.87px" class="cls_023"><span class="cls_023">Versioning process definitions</span></div>
<div style="position:absolute;left:56.69px;top:258.58px" class="cls_004"><span class="cls_004">When you check in an updated process definition to the Activiti engine, it automatically</span></div>
<div style="position:absolute;left:56.69px;top:271.18px" class="cls_004"><span class="cls_004">versions the process. On the workflow console, when you run show definitions all, the</span></div>
<div style="position:absolute;left:56.69px;top:283.78px" class="cls_004"><span class="cls_004">response includes every version of every process definition currently deployed.</span></div>
<div style="position:absolute;left:56.69px;top:305.38px" class="cls_004"><span class="cls_004">You may be wondering what happens to running workflow instances when a new version</span></div>
<div style="position:absolute;left:56.69px;top:317.98px" class="cls_004"><span class="cls_004">of the process definition is checked in. The answer is that Activiti handles that gracefully. It</span></div>
<div style="position:absolute;left:56.69px;top:330.58px" class="cls_004"><span class="cls_004">makes sure that running workflows continue to run with their original process definition.</span></div>
<div style="position:absolute;left:56.69px;top:343.18px" class="cls_004"><span class="cls_004">All new workflows will use the most current process definition.</span></div>
<div style="position:absolute;left:56.69px;top:377.83px" class="cls_023"><span class="cls_023">Using alternative deployment methods</span></div>
<div style="position:absolute;left:56.69px;top:400.54px" class="cls_004"><span class="cls_004">So far you've seen how to deploy process definitions to Alfresco through the workflow</span></div>
<div style="position:absolute;left:56.69px;top:413.14px" class="cls_004"><span class="cls_004">console and the Activiti Explorer. Processes can also be deployed through Spring.</span></div>
<div style="position:absolute;left:56.69px;top:434.74px" class="cls_004"><span class="cls_004">Of these, the most common in the Alfresco world is through Spring. The following snippet</span></div>
<div style="position:absolute;left:56.69px;top:447.34px" class="cls_004"><span class="cls_004">shows how to point to a single process definition. If you have multiple workflows to deploy</span></div>
<div style="position:absolute;left:56.69px;top:459.94px" class="cls_004"><span class="cls_004">using this approach, use multiple props elements:</span></div>
<div style="position:absolute;left:74.69px;top:480.86px" class="cls_010"><span class="cls_010">&lt;bean id="someco.workflowBootstrap" parent="workflowDeployer"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:491.66px" class="cls_010"><span class="cls_010">&lt;property name="workflowDefinitions"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:502.46px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:513.26px" class="cls_010"><span class="cls_010">&lt;props&gt;</span></div>
<div style="position:absolute;left:161.09px;top:524.06px" class="cls_010"><span class="cls_010">&lt;prop key="engineId"&gt;activiti&lt;/prop&gt;</span></div>
<div style="position:absolute;left:161.09px;top:534.86px" class="cls_010"><span class="cls_010">&lt;prop key="location"&gt;alfresco/module/repo</span></div>
<div style="position:absolute;left:161.09px;top:545.66px" class="cls_010"><span class="cls_010">/workflows/HelloWorldProcess.bpmn20.xml&lt;/prop&gt;</span></div>
<div style="position:absolute;left:161.09px;top:556.46px" class="cls_010"><span class="cls_010">&lt;prop key="mimetype"&gt;text/xml&lt;/prop&gt;</span></div>
<div style="position:absolute;left:161.09px;top:567.26px" class="cls_010"><span class="cls_010">&lt;prop key="redeploy"&gt;true&lt;/prop&gt;</span></div>
<div style="position:absolute;left:139.49px;top:578.06px" class="cls_010"><span class="cls_010">&lt;/props&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 336 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:237276px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background352.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:96.29px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:56.69px;top:111.90px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">engineId</span><span class="cls_004"> must be set to </span><span class="cls_013">activiti</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:134.18px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">location</span><span class="cls_004"> is any location on the classpath. But to be consistent with how</span></div>
<div style="position:absolute;left:56.69px;top:147.46px" class="cls_004"><span class="cls_004">customizations are deployed, I recommend standardizing on the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:160.06px" class="cls_004"><span class="cls_004">extension directory or more specifically in a directory called workflows within your</span></div>
<div style="position:absolute;left:56.69px;top:172.66px" class="cls_004"><span class="cls_004">module.</span></div>
<div style="position:absolute;left:56.69px;top:194.26px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">mimetype</span><span class="cls_004"> setting is </span><span class="cls_007">text/xml</span><span class="cls_004"> when deploying the </span><span class="cls_013">HelloWorldProcess.bpmn20.xml</span></div>
<div style="position:absolute;left:56.69px;top:207.54px" class="cls_004"><span class="cls_004">file.</span></div>
<div style="position:absolute;left:56.69px;top:229.14px" class="cls_004"><span class="cls_004">The redeploy flag tells Alfresco whether or not it should automatically redeploy the process</span></div>
<div style="position:absolute;left:56.69px;top:241.74px" class="cls_004"><span class="cls_004">on startup. During development if you are deploying your processes via Spring, you</span></div>
<div style="position:absolute;left:56.69px;top:254.34px" class="cls_004"><span class="cls_004">probably want this to be set to true. Once you get to production, set it to false to avoid</span></div>
<div style="position:absolute;left:56.69px;top:266.94px" class="cls_004"><span class="cls_004">needlessly creating new versions of the process definition every time the server is restarted.</span></div>
<div style="position:absolute;left:56.69px;top:305.69px" class="cls_008"><span class="cls_008">Wiring a process to the Alfresco UI</span></div>
<div style="position:absolute;left:56.69px;top:333.42px" class="cls_004"><span class="cls_004">So far you've learned the definition of workflow, specifics around the Activiti engine, and</span></div>
<div style="position:absolute;left:56.69px;top:346.02px" class="cls_004"><span class="cls_004">how to deploy processes. But the discussion up to this point hasn't been specific to Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:358.62px" class="cls_004"><span class="cls_004">In Alfresco, users need to:</span></div>
<div style="position:absolute;left:104.69px;top:380.35px" class="cls_004"><span class="cls_004">Start workflows</span></div>
<div style="position:absolute;left:104.69px;top:395.11px" class="cls_004"><span class="cls_004">Add one or more pieces of content to a workflow (</span><span class="cls_022">“</span><span class="cls_004">Approve an application</span></div>
<div style="position:absolute;left:104.69px;top:408.54px" class="cls_004"><span class="cls_004">form</span><span class="cls_022">”</span><span class="cls_004">, for example)</span></div>
<div style="position:absolute;left:104.69px;top:424.13px" class="cls_004"><span class="cls_004">Assign tasks to users and/or groups, and work with the tasks assigned to them</span></div>
<div style="position:absolute;left:104.69px;top:438.89px" class="cls_004"><span class="cls_004">Provide process-specific metadata for a specific workflow such as due dates,</span></div>
<div style="position:absolute;left:104.69px;top:451.49px" class="cls_004"><span class="cls_004">priority, special processing instructions, or any other custom metadata you can</span></div>
<div style="position:absolute;left:104.69px;top:464.09px" class="cls_004"><span class="cls_004">think of</span></div>
<div style="position:absolute;left:56.69px;top:487.98px" class="cls_004"><span class="cls_004">Activiti is just an engine-it is up to the application embedding the engine to expose the</span></div>
<div style="position:absolute;left:56.69px;top:500.58px" class="cls_004"><span class="cls_004">capabilities of the engine to the user interface. Alfresco's already done that work for you.</span></div>
<div style="position:absolute;left:56.69px;top:513.18px" class="cls_004"><span class="cls_004">Figuring out how to wire your custom workflows into Alfresco Share is just a matter of</span></div>
<div style="position:absolute;left:56.69px;top:525.78px" class="cls_004"><span class="cls_004">following Alfresco's framework.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 337 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:237952px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background353.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Alfresco uses the same mechanism to model workflow process data and the corresponding</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">Alfresco Share interface as it does to define custom content models. You learned how to</span></div>
<div style="position:absolute;left:56.69px;top:95.71px" class="cls_004"><span class="cls_004">extend Alfresco's content model in </span><span class="cls_010">Chapter 3</span><span class="cls_004">, </span><span class="cls_012">Working with Content Models</span><span class="cls_004">. The steps for</span></div>
<div style="position:absolute;left:56.69px;top:108.69px" class="cls_004"><span class="cls_004">integrating a custom workflow with Alfresco Share are identical. At a high level it involves:</span></div>
<div style="position:absolute;left:104.69px;top:130.42px" class="cls_004"><span class="cls_004">Defining a content model for your workflow in which workflow tasks map to</span></div>
<div style="position:absolute;left:104.69px;top:143.02px" class="cls_004"><span class="cls_004">content types (Alfresco-provided types, custom types, or both)</span></div>
<div style="position:absolute;left:104.69px;top:157.78px" class="cls_004"><span class="cls_004">Updating </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> to tell Alfresco how to expose the process</span></div>
<div style="position:absolute;left:104.69px;top:171.06px" class="cls_004"><span class="cls_004">metadata to Alfresco Share</span></div>
<div style="position:absolute;left:104.69px;top:185.82px" class="cls_004"><span class="cls_004">Externalizing the strings</span></div>
<div style="position:absolute;left:56.69px;top:209.71px" class="cls_004"><span class="cls_004">Let's see how this works by wiring the Hello World process you created earlier to Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:222.31px" class="cls_004"><span class="cls_004">Share. After that, you'll work through a more complex example for SomeCo.</span></div>
<div style="position:absolute;left:56.69px;top:259.01px" class="cls_014"><span class="cls_014">Step-by-step - grabbing the Hello World</span></div>
<div style="position:absolute;left:56.69px;top:280.61px" class="cls_014"><span class="cls_014">argument from the user</span></div>
<div style="position:absolute;left:56.69px;top:305.83px" class="cls_004"><span class="cls_004">The Hello World process you created at the start of the chapter didn't require any user</span></div>
<div style="position:absolute;left:56.69px;top:318.43px" class="cls_004"><span class="cls_004">involvement other than signaling the start node. Once you did that, it ran to completion.</span></div>
<div style="position:absolute;left:56.69px;top:331.03px" class="cls_004"><span class="cls_004">Certainly, you'll have workflows like this. Workflows can be useful for chaining together</span></div>
<div style="position:absolute;left:56.69px;top:343.63px" class="cls_004"><span class="cls_004">several automated operations that don't need human involvement. In this example, though,</span></div>
<div style="position:absolute;left:56.69px;top:356.23px" class="cls_004"><span class="cls_004">you need to learn how to integrate a custom workflow with the Alfresco Share user</span></div>
<div style="position:absolute;left:56.69px;top:368.83px" class="cls_004"><span class="cls_004">interface. So let's modify the Hello World example to say hello to a name specified when the</span></div>
<div style="position:absolute;left:56.69px;top:381.43px" class="cls_004"><span class="cls_004">workflow is launched. This will involve creating a custom workflow content model,</span></div>
<div style="position:absolute;left:56.69px;top:394.03px" class="cls_004"><span class="cls_004">configuring the Alfresco Share user interface, and modifying the process definition to</span></div>
<div style="position:absolute;left:56.69px;top:406.63px" class="cls_004"><span class="cls_004">retrieve the string from the model.</span></div>
<div style="position:absolute;left:56.69px;top:428.23px" class="cls_004"><span class="cls_004">Let's get started. Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:449.96px" class="cls_004"><span class="cls_004">1. First, in the workflows folder in your Eclipse project make a copy of the</span></div>
<div style="position:absolute;left:104.69px;top:462.56px" class="cls_013"><span class="cls_013">HelloWorldProcess.bpmn20.xml</span><span class="cls_004"> process definition. Call the new file</span></div>
<div style="position:absolute;left:104.69px;top:475.84px" class="cls_013"><span class="cls_013">HelloWorldUIProcess.bpmn20.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:491.28px" class="cls_004"><span class="cls_004">2. Now edit the process definition. There are three areas that need to be addressed.</span></div>
<div style="position:absolute;left:104.69px;top:503.88px" class="cls_004"><span class="cls_004">First, the process id and name need to change:</span></div>
<div style="position:absolute;left:117.89px;top:527.09px" class="cls_010"><span class="cls_010">&lt;process id="helloWorldUI" name="Hello World UI Process"&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 338 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:238628px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background354.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Next, the goal is to have the person starting the workflow specify a string when</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">the workflow is launched. To do this, let's update the start event by specifying the</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">content model type that will be used on the start task:</span></div>
<div style="position:absolute;left:117.89px;top:118.91px" class="cls_010"><span class="cls_010">&lt;startEvent id="theStart" activiti:formKey</span></div>
<div style="position:absolute;left:139.49px;top:129.71px" class="cls_010"><span class="cls_010">="scwf:submitHelloWorldTask" /&gt;</span></div>
<div style="position:absolute;left:91.32px;top:150.32px" class="cls_004"><span class="cls_004">4. The final change to the process is to read the string that was set by the workflow</span></div>
<div style="position:absolute;left:104.69px;top:162.92px" class="cls_004"><span class="cls_004">initiator. The string will be stored in a property as defined in the yet-to-be-created</span></div>
<div style="position:absolute;left:104.69px;top:175.52px" class="cls_004"><span class="cls_004">custom workflow content model. All you have to do is declare a variable that</span></div>
<div style="position:absolute;left:104.69px;top:188.12px" class="cls_004"><span class="cls_004">matches the property name, and then reference it in the log statement. Note the</span></div>
<div style="position:absolute;left:104.69px;top:200.72px" class="cls_004"><span class="cls_004">use of an underscore (</span><span class="cls_022">“</span><span class="cls_004">_</span><span class="cls_022">”</span><span class="cls_004">) instead of a colon (</span><span class="cls_022">“</span><span class="cls_004">:</span><span class="cls_022">”</span><span class="cls_004">) to separate the namespace from</span></div>
<div style="position:absolute;left:104.69px;top:214.15px" class="cls_004"><span class="cls_004">the property name. Modify the </span><span class="cls_013">hello</span><span class="cls_004"> service task as follows:</span></div>
<div style="position:absolute;left:117.89px;top:238.04px" class="cls_010"><span class="cls_010">&lt;serviceTask id="hello" name="Hello Task"</span></div>
<div style="position:absolute;left:117.89px;top:248.84px" class="cls_010"><span class="cls_010">activiti:class="org.alfresco.repo.workflow</span></div>
<div style="position:absolute;left:117.89px;top:259.64px" class="cls_010"><span class="cls_010">.activiti.script.AlfrescoScriptDelegate"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:270.44px" class="cls_010"><span class="cls_010">&lt;extensionElements&gt;</span></div>
<div style="position:absolute;left:155.69px;top:281.24px" class="cls_010"><span class="cls_010">&lt;activiti:field name="script"&gt;</span></div>
<div style="position:absolute;left:166.49px;top:292.04px" class="cls_010"><span class="cls_010">&lt;activiti:string&gt;&lt;![CDATA[logger.log("Hello, "</span></div>
<div style="position:absolute;left:171.89px;top:302.84px" class="cls_010"><span class="cls_010">+ scwf_helloName + "!");]]&gt;</span></div>
<div style="position:absolute;left:166.49px;top:324.44px" class="cls_010"><span class="cls_010">&lt;/activiti:string&gt;</span></div>
<div style="position:absolute;left:155.69px;top:335.24px" class="cls_010"><span class="cls_010">&lt;/activiti:field&gt;</span></div>
<div style="position:absolute;left:139.49px;top:346.04px" class="cls_010"><span class="cls_010">&lt;/extensionElements&gt;</span></div>
<div style="position:absolute;left:117.89px;top:356.84px" class="cls_010"><span class="cls_010">&lt;/serviceTask&gt;</span></div>
<div style="position:absolute;left:91.32px;top:377.45px" class="cls_004"><span class="cls_004">5. Save the file.</span></div>
<div style="position:absolute;left:91.32px;top:392.21px" class="cls_004"><span class="cls_004">6. When the workflow is launched, the initiator specifies a name string. Alfresco has</span></div>
<div style="position:absolute;left:104.69px;top:404.81px" class="cls_004"><span class="cls_004">to know how to handle that data. Alfresco uses a content model to do that. Create</span></div>
<div style="position:absolute;left:104.69px;top:417.41px" class="cls_004"><span class="cls_004">a new content model XML file in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span></div>
<div style="position:absolute;left:104.69px;top:430.69px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">model</span><span class="cls_004"> called </span><span class="cls_013">scWorkflowModel.xml</span><span class="cls_004"> with the following</span></div>
<div style="position:absolute;left:104.69px;top:443.97px" class="cls_004"><span class="cls_004">content:</span></div>
<div style="position:absolute;left:117.89px;top:467.18px" class="cls_010"><span class="cls_010">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:477.98px" class="cls_010"><span class="cls_010">&lt;!-- Definition of new Model --&gt;</span></div>
<div style="position:absolute;left:117.89px;top:488.78px" class="cls_010"><span class="cls_010">&lt;model name="scwf:workflowmodel"</span></div>
<div style="position:absolute;left:139.49px;top:499.58px" class="cls_010"><span class="cls_010">xmlns="</span><a href="http://www.alfresco.org/model/dictionary/1.0" "="">http://www.alfresco.org/model/dictionary/1.0"</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:521.18px" class="cls_010"><span class="cls_010">&lt;!-- Optional meta-data about the model --&gt;</span></div>
<div style="position:absolute;left:117.89px;top:531.98px" class="cls_010"><span class="cls_010">&lt;description&gt;Someco Workflow Model&lt;/description&gt;</span></div>
<div style="position:absolute;left:117.89px;top:542.78px" class="cls_010"><span class="cls_010">&lt;author&gt;BenChevallereau&lt;/author&gt;</span></div>
<div style="position:absolute;left:117.89px;top:553.58px" class="cls_010"><span class="cls_010">&lt;version&gt;1.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:117.89px;top:575.18px" class="cls_010"><span class="cls_010">&lt;!-- Imports are required to allow references to</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 339 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:239304px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background355.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">definitions in other models --&gt;</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">&lt;imports&gt;</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">&lt;import uri=</span></div>
<div style="position:absolute;left:134.09px;top:113.02px" class="cls_010"><span class="cls_010">"</span><a href="http://www.alfresco.org/model/dictionary/1.0" "="">http://www.alfresco.org/model/dictionary/1.0"</a> prefix="d" /&gt;</div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">&lt;import uri="</span><a href="http://www.alfresco.org/model/bpm/1.0" "="">http://www.alfresco.org/model/bpm/1.0"</a> </div>
<div style="position:absolute;left:139.49px;top:134.62px" class="cls_010"><span class="cls_010">prefix="bpm" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">&lt;/imports&gt;</span></div>
<div style="position:absolute;left:117.89px;top:167.02px" class="cls_010"><span class="cls_010">&lt;!-- Introduction of new namespaces defined by this model --&gt;</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">&lt;namespaces&gt;</span></div>
<div style="position:absolute;left:117.89px;top:188.62px" class="cls_010"><span class="cls_010">&lt;namespace uri="</span><a href="http://www.someco.com/model/workflow/1.0" "="">http://www.someco.com/model/workflow/1.0"</a> </div>
<div style="position:absolute;left:128.69px;top:199.42px" class="cls_010"><span class="cls_010">prefix="scwf" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:210.22px" class="cls_010"><span class="cls_010">&lt;/namespaces&gt;</span></div>
<div style="position:absolute;left:124.19px;top:230.70px" class="cls_004"><span class="cls_004">Two important things to notice in the previous XML code. First, you'll notice</span></div>
<div style="position:absolute;left:124.19px;top:243.30px" class="cls_004"><span class="cls_004">that we import an Alfresco model defined by the prefix bpm. This model will</span></div>
<div style="position:absolute;left:124.19px;top:255.90px" class="cls_004"><span class="cls_004">provide use the basic model elements to configure our workflow like the start</span></div>
<div style="position:absolute;left:124.19px;top:268.50px" class="cls_004"><span class="cls_004">task content type that we use below. The second important thing is the</span></div>
<div style="position:absolute;left:124.19px;top:281.10px" class="cls_004"><span class="cls_004">creation of a dedicated content model. We could have re-used the same</span></div>
<div style="position:absolute;left:124.19px;top:293.70px" class="cls_004"><span class="cls_004">content model to define the document types, and the workflow types. It's</span></div>
<div style="position:absolute;left:124.19px;top:306.30px" class="cls_004"><span class="cls_004">more a good practice to organize your types and aspects related to</span></div>
<div style="position:absolute;left:124.19px;top:318.90px" class="cls_004"><span class="cls_004">documents in one content model, and to isolate your workflow types and</span></div>
<div style="position:absolute;left:124.19px;top:331.50px" class="cls_004"><span class="cls_004">aspects in another content model.</span></div>
<div style="position:absolute;left:91.32px;top:353.23px" class="cls_004"><span class="cls_004">7. Add to it a type that corresponds to the task you created in the start-element,</span></div>
<div style="position:absolute;left:104.69px;top:365.83px" class="cls_004"><span class="cls_004">which was called </span><span class="cls_013">scwf:submitHelloWorldTask</span><span class="cls_004">. The type only needs one</span></div>
<div style="position:absolute;left:104.69px;top:379.11px" class="cls_004"><span class="cls_004">property, which is the </span><span class="cls_013">name</span><span class="cls_004"> string:</span></div>
<div style="position:absolute;left:117.89px;top:403.00px" class="cls_010"><span class="cls_010">&lt;types&gt;</span></div>
<div style="position:absolute;left:139.49px;top:413.80px" class="cls_010"><span class="cls_010">&lt;type name="scwf:submitHelloWorldTask"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:424.60px" class="cls_010"><span class="cls_010">&lt;parent&gt;bpm:startTask&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:435.40px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:161.09px;top:446.20px" class="cls_010"><span class="cls_010">&lt;property name="scwf:helloName"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:457.00px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:182.69px;top:467.80px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;true&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:182.69px;top:478.60px" class="cls_010"><span class="cls_010">&lt;multiple&gt;false&lt;/multiple&gt;</span></div>
<div style="position:absolute;left:161.09px;top:489.40px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:500.20px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:139.49px;top:511.00px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:117.89px;top:521.80px" class="cls_010"><span class="cls_010">&lt;/types&gt;</span></div>
<div style="position:absolute;left:117.89px;top:532.60px" class="cls_010"><span class="cls_010">&lt;/model&gt;</span></div>
<div style="position:absolute;left:124.19px;top:553.08px" class="cls_004"><span class="cls_004">Notice the inheritance with the type </span><span class="cls_013">bpm:startTask</span><span class="cls_004"> provided by the out-of-</span></div>
<div style="position:absolute;left:124.19px;top:566.36px" class="cls_004"><span class="cls_004">the-box Alfresco model.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 340 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:239980px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background356.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">8. Save the model XML file.</span></div>
<div style="position:absolute;left:91.32px;top:85.26px" class="cls_004"><span class="cls_004">9. Create a new properties file in </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:98.54px" class="cls_013"><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">messages</span><span class="cls_004"> called </span><span class="cls_013">scWorkflow.properties</span><span class="cls_004">. The properties file</span></div>
<div style="position:absolute;left:104.69px;top:111.82px" class="cls_004"><span class="cls_004">for workflows follows a specific syntax. First, add properties related to the</span></div>
<div style="position:absolute;left:104.69px;top:124.42px" class="cls_004"><span class="cls_004">custom workflow model. These properties describe the type and the property</span></div>
<div style="position:absolute;left:104.69px;top:137.02px" class="cls_004"><span class="cls_004">you added to the model:</span></div>
<div style="position:absolute;left:117.89px;top:160.23px" class="cls_010"><span class="cls_010">#</span></div>
<div style="position:absolute;left:117.89px;top:171.03px" class="cls_010"><span class="cls_010"># Hello World UI Workflow</span></div>
<div style="position:absolute;left:117.89px;top:181.83px" class="cls_010"><span class="cls_010">#</span></div>
<div style="position:absolute;left:117.89px;top:203.43px" class="cls_010"><span class="cls_010"># scWorkflowModel related strings</span></div>
<div style="position:absolute;left:117.89px;top:214.23px" class="cls_010"><span class="cls_010">scwf_workflowmodel.type.scwf_submitHelloWorldTask.title</span></div>
<div style="position:absolute;left:139.49px;top:225.03px" class="cls_010"><span class="cls_010">=Start Hello World UI Workflow</span></div>
<div style="position:absolute;left:117.89px;top:235.83px" class="cls_010"><span class="cls_010">scwf_workflowmodel.type.scwf_submitHelloWorldTask.description</span></div>
<div style="position:absolute;left:139.49px;top:246.63px" class="cls_010"><span class="cls_010">=Submit a workflow that says hello in the log</span></div>
<div style="position:absolute;left:117.89px;top:257.43px" class="cls_010"><span class="cls_010">scwf_workflowmodel.property.scwf_helloName.title</span></div>
<div style="position:absolute;left:139.49px;top:268.23px" class="cls_010"><span class="cls_010">=Name</span></div>
<div style="position:absolute;left:117.89px;top:279.03px" class="cls_010"><span class="cls_010">scwf_workflowmodel.property.scwf_helloName.description</span></div>
<div style="position:absolute;left:139.49px;top:289.83px" class="cls_010"><span class="cls_010">=Say hello to this person</span></div>
<div style="position:absolute;left:86.07px;top:310.44px" class="cls_004"><span class="cls_004">10. Then, add properties that relate to the process. In this example, the only process-</span></div>
<div style="position:absolute;left:104.69px;top:323.04px" class="cls_004"><span class="cls_004">related properties are used to give the workflow a title and a description. Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:335.64px" class="cls_004"><span class="cls_004">will display the title and description in the Start Advanced Workflow wizard:</span></div>
<div style="position:absolute;left:117.89px;top:358.85px" class="cls_010"><span class="cls_010"># Workflow related strings</span></div>
<div style="position:absolute;left:117.89px;top:369.65px" class="cls_010"><span class="cls_010">helloWorldUI.workflow.title=Hello World UI</span></div>
<div style="position:absolute;left:117.89px;top:380.45px" class="cls_010"><span class="cls_010">helloWorldUI.workflow.description</span></div>
<div style="position:absolute;left:139.49px;top:391.25px" class="cls_010"><span class="cls_010">=A simple hello world process using Activiti</span></div>
<div style="position:absolute;left:86.07px;top:411.86px" class="cls_004"><span class="cls_004">11. Save the properties file.</span></div>
<div style="position:absolute;left:86.07px;top:426.62px" class="cls_004"><span class="cls_004">12. This time, we'll deploy our process using a Spring bean. In the folder </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span></div>
<div style="position:absolute;left:104.69px;top:439.90px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">context</span><span class="cls_004">, create a new file</span></div>
<div style="position:absolute;left:104.69px;top:453.18px" class="cls_004"><span class="cls_004">called </span><span class="cls_013">workflow-context.xml</span><span class="cls_004"> and add the following content:</span></div>
<div style="position:absolute;left:117.89px;top:477.07px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:487.87px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN'</span></div>
<div style="position:absolute;left:139.49px;top:498.67px" class="cls_010"><span class="cls_010">'</span><a href="http://www.springframework.org/dtd/spring-beans.dtd&#39;/">http://www.springframework.org/dtd/spring-beans.dtd'</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:509.47px" class="cls_010"><span class="cls_010">&lt;beans&gt;</span></div>
<div style="position:absolute;left:139.49px;top:520.27px" class="cls_010"><span class="cls_010">&lt;bean id="someco.workflowBootstrap" parent="workflowDeployer"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:531.07px" class="cls_010"><span class="cls_010">&lt;property name="workflowDefinitions"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:541.87px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:161.09px;top:552.67px" class="cls_010"><span class="cls_010">&lt;props&gt;</span></div>
<div style="position:absolute;left:177.29px;top:563.47px" class="cls_010"><span class="cls_010">&lt;prop key="engineId"&gt;activiti&lt;/prop&gt;</span></div>
<div style="position:absolute;left:182.69px;top:574.27px" class="cls_010"><span class="cls_010">&lt;prop key="location"&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 341 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:240656px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background357.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:204.29px;top:69.82px" class="cls_010"><span class="cls_010">alfresco/module/${project.artifactId}</span></div>
<div style="position:absolute;left:204.29px;top:80.62px" class="cls_010"><span class="cls_010">/workflows/HelloWorldUIProcess.bpmn20.xml</span></div>
<div style="position:absolute;left:182.69px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/prop&gt;</span></div>
<div style="position:absolute;left:182.69px;top:102.22px" class="cls_010"><span class="cls_010">&lt;prop key="mimetype"&gt;text/xml&lt;/prop&gt;</span></div>
<div style="position:absolute;left:182.69px;top:113.02px" class="cls_010"><span class="cls_010">&lt;prop key="redeploy"&gt;true&lt;/prop&gt;</span></div>
<div style="position:absolute;left:161.09px;top:123.82px" class="cls_010"><span class="cls_010">&lt;/props&gt;</span></div>
<div style="position:absolute;left:150.29px;top:134.62px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:145.42px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:156.22px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:167.02px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:86.07px;top:187.63px" class="cls_004"><span class="cls_004">13. You have to tell Alfresco about the new model. Recall that models are configured</span></div>
<div style="position:absolute;left:104.69px;top:200.23px" class="cls_004"><span class="cls_004">in a Spring context bean. Edit the previous context file called </span><span class="cls_013">workflow-</span></div>
<div style="position:absolute;left:104.69px;top:213.51px" class="cls_013"><span class="cls_013">context.xml</span><span class="cls_004"> to add a new property with the name equal to models.</span></div>
<div style="position:absolute;left:117.89px;top:237.40px" class="cls_010"><span class="cls_010">&lt;property name="models"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:248.20px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:259.00px" class="cls_010"><span class="cls_010">&lt;value&gt;</span></div>
<div style="position:absolute;left:74.69px;top:280.60px" class="cls_010"><span class="cls_010">alfresco/module/${project.artifactId}/model/scWorkflowModel.xml</span></div>
<div style="position:absolute;left:139.49px;top:291.40px" class="cls_010"><span class="cls_010">&lt;/value&gt;</span></div>
<div style="position:absolute;left:128.69px;top:302.20px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:117.89px;top:313.00px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:86.07px;top:333.61px" class="cls_004"><span class="cls_004">14. Alfresco also needs to know about the </span><span class="cls_013">scWorkflow.properties</span><span class="cls_004"> file. It makes</span></div>
<div style="position:absolute;left:104.69px;top:346.89px" class="cls_004"><span class="cls_004">sense to add it to the same context file. Add a new property with the name equal</span></div>
<div style="position:absolute;left:104.69px;top:359.49px" class="cls_004"><span class="cls_004">to </span><span class="cls_013">labels:</span></div>
<div style="position:absolute;left:117.89px;top:383.38px" class="cls_010"><span class="cls_010">&lt;property name="labels"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:394.18px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:161.09px;top:404.98px" class="cls_010"><span class="cls_010">&lt;value&gt;</span></div>
<div style="position:absolute;left:171.89px;top:415.78px" class="cls_010"><span class="cls_010">alfresco/module/${project.artifactId}/messages/scWorkflow</span></div>
<div style="position:absolute;left:161.09px;top:426.58px" class="cls_010"><span class="cls_010">&lt;/value&gt;</span></div>
<div style="position:absolute;left:139.49px;top:437.38px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:117.89px;top:448.18px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:86.07px;top:468.79px" class="cls_004"><span class="cls_004">15. Save the context file.</span></div>
<div style="position:absolute;left:86.07px;top:483.55px" class="cls_004"><span class="cls_004">16. Then, edit your </span><span class="cls_013">module-context.xml</span><span class="cls_004"> file and add an </span><span class="cls_013">import</span><span class="cls_004"> reference:</span></div>
<div style="position:absolute;left:117.89px;top:507.44px" class="cls_010"><span class="cls_010">&lt;import resource="classpath:alfresco/module/</span></div>
<div style="position:absolute;left:117.89px;top:518.24px" class="cls_010"><span class="cls_010">${project.artifactId}/context/workflow-context.xml" /&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 342 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:241332px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background358.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">17.</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Now, we need to configure Alfresco Share. Open the file </span><span class="cls_013">share</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_013"><span class="cls_013">resources</span><span class="cls_004"> | </span><span class="cls_013">META-INF</span><span class="cls_004"> | </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> and add the following</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_013"><span class="cls_013">config</span><span class="cls_004"> element:</span></div>
<div style="position:absolute;left:117.89px;top:120.95px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:134.09px;top:131.75px" class="cls_010"><span class="cls_010">condition="activiti$helloWorldUI"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:142.55px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:139.49px;top:153.35px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:150.29px;top:164.15px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:174.95px" class="cls_010"><span class="cls_010">&lt;show id="bpm:workflowDescription" /&gt;</span></div>
<div style="position:absolute;left:171.89px;top:185.75px" class="cls_010"><span class="cls_010">&lt;show id="packageItems" /&gt;</span></div>
<div style="position:absolute;left:171.89px;top:196.55px" class="cls_010"><span class="cls_010">&lt;show id="scwf:helloName" /&gt;</span></div>
<div style="position:absolute;left:171.89px;top:207.35px" class="cls_010"><span class="cls_010">&lt;show id="transitions" /&gt;</span></div>
<div style="position:absolute;left:171.89px;top:218.15px" class="cls_010"><span class="cls_010">&lt;show id="bpm:status" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:228.95px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:239.75px" class="cls_010"><span class="cls_010">&lt;appearance&gt;</span></div>
<div style="position:absolute;left:161.09px;top:250.55px" class="cls_010"><span class="cls_010">&lt;set id="" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:261.35px" class="cls_010"><span class="cls_010">label-id="workflow.set.general" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:272.15px" class="cls_010"><span class="cls_010">&lt;set id="items" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:282.95px" class="cls_010"><span class="cls_010">label-id="workflow.set.items" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:293.75px" class="cls_010"><span class="cls_010">&lt;set id="progress" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:304.55px" class="cls_010"><span class="cls_010">label-id="workflow.set.task.progress" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:326.15px" class="cls_010"><span class="cls_010">&lt;set id="other" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:336.95px" class="cls_010"><span class="cls_010">label-id="workflow.set.other" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:347.75px" class="cls_010"><span class="cls_010">&lt;field id="bpm:workflowDescription"</span></div>
<div style="position:absolute;left:171.89px;top:358.55px" class="cls_010"><span class="cls_010">label-id="workflow.field.message"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:369.35px" class="cls_010"><span class="cls_010">&lt;control template="/org/alfresco/components</span></div>
<div style="position:absolute;left:171.89px;top:380.15px" class="cls_010"><span class="cls_010">/form/controls/textarea.ftl"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:390.95px" class="cls_010"><span class="cls_010">&lt;control-param name="style"&gt;width: 95%&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:171.89px;top:401.75px" class="cls_010"><span class="cls_010">&lt;/control&gt;</span></div>
<div style="position:absolute;left:161.09px;top:412.55px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:161.09px;top:423.35px" class="cls_010"><span class="cls_010">&lt;field id="packageItems" set="items" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:434.15px" class="cls_010"><span class="cls_010">&lt;field id="scwf:helloName" set="other" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:444.95px" class="cls_010"><span class="cls_010">&lt;field id="bpm:status" set="progress" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:455.75px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:144.89px;top:466.55px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:128.69px;top:477.35px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:488.15px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 343 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:242008px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background359.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">Let's explain this XML code. First, we can see that we match this form</span></div>
<div style="position:absolute;left:124.19px;top:83.10px" class="cls_004"><span class="cls_004">configuration by defining the </span><span class="cls_013">condition</span><span class="cls_004"> field with the Activiti workflow</span></div>
<div style="position:absolute;left:124.19px;top:96.38px" class="cls_004"><span class="cls_004">identifier. Then, we configured in the workflow which content type to use for</span></div>
<div style="position:absolute;left:124.19px;top:108.98px" class="cls_004"><span class="cls_004">the start task. This is how Alfresco maps this configuration to the content</span></div>
<div style="position:absolute;left:124.19px;top:121.58px" class="cls_004"><span class="cls_004">type that we defined for the start task.</span></div>
<div style="position:absolute;left:124.19px;top:143.18px" class="cls_004"><span class="cls_004">Instead of starting from scratch, we just re-used an existing configuration in</span></div>
<div style="position:absolute;left:124.19px;top:155.78px" class="cls_004"><span class="cls_004">Alfresco Share. If you open the file </span><span class="cls_013">WEB-INF</span><span class="cls_004"> | </span><span class="cls_013">classes</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:124.19px;top:169.06px" class="cls_013"><span class="cls_013">share-workflow-form-config.xml</span><span class="cls_004"> in the Share web application in</span></div>
<div style="position:absolute;left:124.19px;top:182.34px" class="cls_004"><span class="cls_004">Tomcat, you should find a form configuration for the workflow</span></div>
<div style="position:absolute;left:124.19px;top:194.94px" class="cls_013"><span class="cls_013">activiti$activitiAdhoc</span><span class="cls_004">. We just removed some out-of-the-box fields</span></div>
<div style="position:absolute;left:124.19px;top:208.22px" class="cls_004"><span class="cls_004">and added our custom field.</span></div>
<div style="position:absolute;left:86.07px;top:229.95px" class="cls_004"><span class="cls_004">18. Package, deploy, and test.</span></div>
<div style="position:absolute;left:56.69px;top:253.84px" class="cls_004"><span class="cls_004">To start an advanced workflow in Alfresco Share, you can use the </span><span class="cls_007">My Tasks </span><span class="cls_004">dashlet. If you</span></div>
<div style="position:absolute;left:56.69px;top:266.48px" class="cls_004"><span class="cls_004">don't already have it on your dashboard, you can add it by yourself by clicking on the</span></div>
<div style="position:absolute;left:56.69px;top:279.08px" class="cls_004"><span class="cls_004">wheel icon. Just click on the </span><span class="cls_013">Start Workflow</span><span class="cls_004"> action:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 344 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:242684px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background360.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You should see your workflow listed as well as the other Hello World workflow examples</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">and the out-of-the-box workflows:</span></div>
<div style="position:absolute;left:56.69px;top:377.87px" class="cls_004"><span class="cls_004">If you select the Hello Word UI, you should see the form that we created, as well as the</span></div>
<div style="position:absolute;left:56.69px;top:390.47px" class="cls_004"><span class="cls_004">externalized string for the label:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 345 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:243360px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background361.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:390.08px" class="cls_004"><span class="cls_004">Just populate the </span><span class="cls_007">Name</span><span class="cls_004"> field with your name, and click on </span><span class="cls_007">Start Workflow</span><span class="cls_004">. Unfortunately,</span></div>
<div style="position:absolute;left:56.69px;top:402.72px" class="cls_004"><span class="cls_004">you'll get the same error message when you were using the Workflow Console. And it's for</span></div>
<div style="position:absolute;left:56.69px;top:415.32px" class="cls_004"><span class="cls_004">the same reason; we don't have any user task in our process. Don't worry, we are getting to</span></div>
<div style="position:absolute;left:56.69px;top:427.92px" class="cls_004"><span class="cls_004">it!</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 346 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:244036px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background362.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you check the log file, you should see our new message with the value that you entered:</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">DEBUG [repo.jscript.ScriptLogger] [http-apr-8080-exec-8] Hello, Ben!</span></div>
<div style="position:absolute;left:56.69px;top:124.95px" class="cls_023"><span class="cls_023">Understanding workflow-specific content models</span></div>
<div style="position:absolute;left:56.69px;top:147.66px" class="cls_004"><span class="cls_004">The workflow-specific content model defines the data structure for the process. Workflow</span></div>
<div style="position:absolute;left:56.69px;top:160.26px" class="cls_004"><span class="cls_004">models use the same fundamental building blocks-types, properties, aspects, and</span></div>
<div style="position:absolute;left:56.69px;top:172.86px" class="cls_004"><span class="cls_004">associations-as </span><span class="cls_022">“</span><span class="cls_004">normal</span><span class="cls_022">”</span><span class="cls_004"> Alfresco content model definitions. In fact, if you already have a</span></div>
<div style="position:absolute;left:56.69px;top:186.29px" class="cls_004"><span class="cls_004">custom model, you can define your workflow-specific model in the same content model</span></div>
<div style="position:absolute;left:56.69px;top:198.89px" class="cls_004"><span class="cls_004">XML file. But to reduce confusion, I recommend you do what you did here and keep your</span></div>
<div style="position:absolute;left:56.69px;top:211.49px" class="cls_004"><span class="cls_004">content types separate from your workflow types using at least two different model files.</span></div>
<div style="position:absolute;left:56.69px;top:233.09px" class="cls_004"><span class="cls_004">What is the purpose of the workflow-specific model? Think of it like any other content</span></div>
<div style="position:absolute;left:56.69px;top:245.69px" class="cls_004"><span class="cls_004">model. Custom content models are used to define the metadata you want to capture about a</span></div>
<div style="position:absolute;left:56.69px;top:258.29px" class="cls_004"><span class="cls_004">piece of content. The metadata (properties) is grouped into types and aspects. By virtue of</span></div>
<div style="position:absolute;left:56.69px;top:270.89px" class="cls_004"><span class="cls_004">defining these properties as part of the content model, Alfresco takes care of persisting the</span></div>
<div style="position:absolute;left:56.69px;top:283.49px" class="cls_004"><span class="cls_004">data to the underlying database.</span></div>
<div style="position:absolute;left:56.69px;top:305.09px" class="cls_004"><span class="cls_004">Workflow models function in the same way. Suppose you have a process in which three</span></div>
<div style="position:absolute;left:56.69px;top:317.69px" class="cls_004"><span class="cls_004">different departments are involved in an approval process. Maybe you'd like the workflow</span></div>
<div style="position:absolute;left:56.69px;top:330.29px" class="cls_004"><span class="cls_004">initiator to be able to define which of those departments are required approvers and which</span></div>
<div style="position:absolute;left:56.69px;top:342.89px" class="cls_004"><span class="cls_004">are optional or </span><span class="cls_022">“</span><span class="cls_004">FYI</span><span class="cls_022">”</span><span class="cls_004"> reviewers. The workflow model defines how that information is going</span></div>
<div style="position:absolute;left:56.69px;top:356.32px" class="cls_004"><span class="cls_004">to be stored.</span></div>
<div style="position:absolute;left:56.69px;top:377.92px" class="cls_004"><span class="cls_004">As in other content models, you don't have to start from scratch. Alfresco ships out of the</span></div>
<div style="position:absolute;left:56.69px;top:390.52px" class="cls_004"><span class="cls_004">box with some workflow-specific types already defined. There are two model definition</span></div>
<div style="position:absolute;left:56.69px;top:403.12px" class="cls_004"><span class="cls_004">files related to this. One is called </span><span class="cls_013">bpmModel.xml</span><span class="cls_004">. It resides in the folder </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">model</span></div>
<div style="position:absolute;left:56.69px;top:416.40px" class="cls_004"><span class="cls_004">packaged in the JAR file </span><span class="cls_013">alfresco-repository-5.*.zip</span><span class="cls_004"> deployed in the Alfresco web</span></div>
<div style="position:absolute;left:56.69px;top:429.68px" class="cls_004"><span class="cls_004">application root under </span><span class="cls_013">WEB-INF</span><span class="cls_004"> | </span><span class="cls_013">lib</span><span class="cls_004">. The other is called </span><span class="cls_013">workflowModel.xml</span><span class="cls_004"> and it</span></div>
<div style="position:absolute;left:56.69px;top:442.96px" class="cls_004"><span class="cls_004">resides in the same JAR file but in the folder </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">workflow</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 347 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:244712px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background363.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The BPM model file contains the lowest-level workflow classes such as the base definition</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">for all tasks and the default start task. It also contains important aspects such as a set of</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_022"><span class="cls_022">“</span><span class="cls_004">assignee</span><span class="cls_022">”</span><span class="cls_004"> aspects that define associations between tasks and users</span></div>
<div style="position:absolute;left:56.69px;top:109.13px" class="cls_004"><span class="cls_004">or groups.</span></div>
<div style="position:absolute;left:56.69px;top:130.73px" class="cls_004"><span class="cls_004">The workflow model file contains the content model for the out-of-the box process</span></div>
<div style="position:absolute;left:56.69px;top:143.33px" class="cls_004"><span class="cls_004">definitions. This model file offers a lot of potential for reuse in your custom processes. For</span></div>
<div style="position:absolute;left:56.69px;top:155.93px" class="cls_004"><span class="cls_004">example, if your process starts by allowing the submitter to specify a list of several people</span></div>
<div style="position:absolute;left:56.69px;top:168.53px" class="cls_004"><span class="cls_004">to receive a task, you could use the </span><span class="cls_013">submitParallelReviewTask</span><span class="cls_004">. If you want to base an</span></div>
<div style="position:absolute;left:56.69px;top:181.81px" class="cls_004"><span class="cls_004">approval on the percentage of individuals who approve a task, you can use the</span></div>
<div style="position:absolute;left:56.69px;top:194.41px" class="cls_013"><span class="cls_013">submitConcurrentReviewTask</span><span class="cls_004">. Of course, just like any model, you are free to use these</span></div>
<div style="position:absolute;left:56.69px;top:207.69px" class="cls_004"><span class="cls_004">as is, extend them, or not use them at all.</span></div>
<div style="position:absolute;left:56.69px;top:229.29px" class="cls_004"><span class="cls_004">When users interact with the workflow via Share, Alfresco will use the workflow content</span></div>
<div style="position:absolute;left:56.69px;top:241.89px" class="cls_004"><span class="cls_004">model and the </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> file to figure out what metadata to expose to</span></div>
<div style="position:absolute;left:56.69px;top:255.17px" class="cls_004"><span class="cls_004">the UI, and how to present it just as it does when viewing content properties. Alfresco uses</span></div>
<div style="position:absolute;left:56.69px;top:267.77px" class="cls_004"><span class="cls_004">the value of the field </span><span class="cls_013">formKey</span><span class="cls_004"> configured on each task to figure out the appropriate</span></div>
<div style="position:absolute;left:56.69px;top:281.05px" class="cls_004"><span class="cls_004">workflow content type. So, all tasks in which there are Alfresco Share user interactions must</span></div>
<div style="position:absolute;left:56.69px;top:293.65px" class="cls_004"><span class="cls_004">be given a value that corresponds to the name of a workflow content type.</span></div>
<div style="position:absolute;left:56.69px;top:315.25px" class="cls_004"><span class="cls_004">You may have noticed that the custom type you created (</span><span class="cls_013">scwf:startHelloWorldTask</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:328.53px" class="cls_004"><span class="cls_004">was a subtype of </span><span class="cls_013">bpm:startTask</span><span class="cls_004">, that inherits from </span><span class="cls_013">bpm:workflowTask</span><span class="cls_004">. Doing that</span></div>
<div style="position:absolute;left:56.69px;top:341.81px" class="cls_004"><span class="cls_004">added key properties and aspects to your workflow, including the ability to associate</span></div>
<div style="position:absolute;left:56.69px;top:354.41px" class="cls_004"><span class="cls_004">content with the workflow. If you look at the </span><span class="cls_013">bpmModel.xml</span><span class="cls_004"> file, you'll see that the</span></div>
<div style="position:absolute;left:56.69px;top:367.69px" class="cls_013"><span class="cls_013">bpm:workflowTask</span><span class="cls_004"> includes an association called </span><span class="cls_013">bpm:package</span><span class="cls_004">. That's what is used to</span></div>
<div style="position:absolute;left:56.69px;top:380.97px" class="cls_004"><span class="cls_004">relate workflow instances with the content being routed by the workflow.</span></div>
<div style="position:absolute;left:56.69px;top:419.72px" class="cls_008"><span class="cls_008">Assigning tasks to users and groups</span></div>
<div style="position:absolute;left:56.69px;top:447.45px" class="cls_004"><span class="cls_004">A task is a step in a workflow that requires human interaction. Activiti maintains a list of</span></div>
<div style="position:absolute;left:56.69px;top:460.05px" class="cls_004"><span class="cls_004">tasks assigned to each participant. How users interact with the task list is up to the</span></div>
<div style="position:absolute;left:56.69px;top:472.65px" class="cls_004"><span class="cls_004">application embedding the Activiti engine. In Alfresco Share out-of-the-box, you have two</span></div>
<div style="position:absolute;left:56.69px;top:485.25px" class="cls_004"><span class="cls_004">options.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 348 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:245388px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background364.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The first one is to use the </span><span class="cls_007">My Tasks</span><span class="cls_004"> that we used previously. The second one is to use the</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">page using the same name </span><span class="cls_007">My Tasks</span><span class="cls_004">. To open it, click on the top banner to Tasks|My</span></div>
<div style="position:absolute;left:56.69px;top:95.78px" class="cls_004"><span class="cls_004">Tasks. It will show a to-do list for the currently logged in user. As users complete their</span></div>
<div style="position:absolute;left:56.69px;top:108.38px" class="cls_004"><span class="cls_004">tasks, the tasks are removed from the to-do list. An empty to do list is shown here:</span></div>
<div style="position:absolute;left:56.69px;top:383.63px" class="cls_004"><span class="cls_004">If tasks are steps a human performs, how do tasks get associated with the people who need</span></div>
<div style="position:absolute;left:56.69px;top:396.23px" class="cls_004"><span class="cls_004">to perform them? When defining a business process, it is important to understand how the</span></div>
<div style="position:absolute;left:56.69px;top:408.83px" class="cls_004"><span class="cls_004">participants in the process will do the work. One specific area that needs to be considered is</span></div>
<div style="position:absolute;left:56.69px;top:421.43px" class="cls_004"><span class="cls_004">whether to use </span><span class="cls_012">candidates</span><span class="cls_004"> for a given task, or assign a task directly to a user. Suppose you</span></div>
<div style="position:absolute;left:56.69px;top:434.03px" class="cls_004"><span class="cls_004">assigned a task to a group of 10 people. You could iterate through the group and assign a</span></div>
<div style="position:absolute;left:56.69px;top:446.63px" class="cls_004"><span class="cls_004">task to each and every member of the group, and then not consider the task complete until</span></div>
<div style="position:absolute;left:56.69px;top:459.23px" class="cls_004"><span class="cls_004">all actors have taken action. An alternative is to use candidates. All members of a group are</span></div>
<div style="position:absolute;left:56.69px;top:471.83px" class="cls_004"><span class="cls_004">notified of the task. But as soon as one actor takes </span><span class="cls_022">“</span><span class="cls_004">ownership</span><span class="cls_022">”</span><span class="cls_004"> of the task, it is removed</span></div>
<div style="position:absolute;left:56.69px;top:485.26px" class="cls_004"><span class="cls_004">from everyone else's to-do list. The owner can then either complete the task or return it to</span></div>
<div style="position:absolute;left:56.69px;top:497.86px" class="cls_004"><span class="cls_004">the pool. If it is returned to the pool, all members of the group see the task in their to-do list</span></div>
<div style="position:absolute;left:56.69px;top:510.46px" class="cls_004"><span class="cls_004">until another person takes ownership or completes the task. To implement this concept,</span></div>
<div style="position:absolute;left:56.69px;top:523.06px" class="cls_004"><span class="cls_004">Activiti is using mainly two attributes:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 349 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:246064px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background365.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_013"><span class="cls_013">activiti:candidateUsers</span><span class="cls_004">: This is used to make a user (or a list of users) a</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">potential candidate for a task</span></div>
<div style="position:absolute;left:104.69px;top:98.54px" class="cls_013"><span class="cls_013">activiti:candidateGroups</span><span class="cls_004">: This is used to make a group (or a list of groups)</span></div>
<div style="position:absolute;left:104.69px;top:111.82px" class="cls_004"><span class="cls_004">a potential candidate for a task</span></div>
<div style="position:absolute;left:56.69px;top:135.71px" class="cls_004"><span class="cls_004">Be aware that those two properties can be used at the same time. And finally, you can use</span></div>
<div style="position:absolute;left:56.69px;top:148.31px" class="cls_004"><span class="cls_004">an expression like </span><span class="cls_013">${initiator.properties.userName}</span><span class="cls_004">. The variable initiator is used to</span></div>
<div style="position:absolute;left:56.69px;top:161.59px" class="cls_004"><span class="cls_004">represent the person who started the workflow. Let's say that you want to implement a</span></div>
<div style="position:absolute;left:56.69px;top:174.19px" class="cls_004"><span class="cls_004">review process; you want to inform the initiator that the review has been completed. In this</span></div>
<div style="position:absolute;left:56.69px;top:186.79px" class="cls_004"><span class="cls_004">case, you'll create a task using this expression as the assignment.</span></div>
<div style="position:absolute;left:56.69px;top:208.39px" class="cls_004"><span class="cls_004">And finally, you have another option to assign a task. You may decide to assign a task</span></div>
<div style="position:absolute;left:56.69px;top:220.99px" class="cls_004"><span class="cls_004">directly to a user, and not anymore to candidate users or groups. To achieve that, Activiti is</span></div>
<div style="position:absolute;left:56.69px;top:233.59px" class="cls_004"><span class="cls_004">using the property, </span><span class="cls_013">activiti:assignee</span><span class="cls_004">. It's quite rare that you want to use this property</span></div>
<div style="position:absolute;left:56.69px;top:246.87px" class="cls_004"><span class="cls_004">with a real username; you usually want to use it with an expression like the one just</span></div>
<div style="position:absolute;left:56.69px;top:259.47px" class="cls_004"><span class="cls_004">described.</span></div>
<div style="position:absolute;left:56.69px;top:296.17px" class="cls_014"><span class="cls_014">Step-by-step - creating the initial Whitepaper</span></div>
<div style="position:absolute;left:56.69px;top:317.77px" class="cls_014"><span class="cls_014">submission workflow</span></div>
<div style="position:absolute;left:56.69px;top:342.99px" class="cls_004"><span class="cls_004">In earlier chapters, you created an action item linked to a repository action that enables and</span></div>
<div style="position:absolute;left:56.69px;top:355.59px" class="cls_004"><span class="cls_004">disables Whitepapers for publication to the Web. You used an evaluator to show or hide the</span></div>
<div style="position:absolute;left:56.69px;top:368.19px" class="cls_004"><span class="cls_004">action item based on whether or not the user was a member of the Publisher group. That</span></div>
<div style="position:absolute;left:56.69px;top:380.79px" class="cls_004"><span class="cls_004">approach works fine in cases where the action doesn't require review or approval. But</span></div>
<div style="position:absolute;left:56.69px;top:393.39px" class="cls_004"><span class="cls_004">SomeCo wants anyone in the company to be able to submit a Whitepaper for publication to</span></div>
<div style="position:absolute;left:56.69px;top:405.99px" class="cls_004"><span class="cls_004">the website, as long as the right people review the document before it is published. This</span></div>
<div style="position:absolute;left:56.69px;top:418.59px" class="cls_004"><span class="cls_004">process is well-suited to an advanced workflow.</span></div>
<div style="position:absolute;left:56.69px;top:440.19px" class="cls_004"><span class="cls_004">The Whitepaper needs to be reviewed by the Operations team as well as the Marketing</span></div>
<div style="position:absolute;left:56.69px;top:452.79px" class="cls_004"><span class="cls_004">team. It doesn't matter who on the team does the review. SomeCo wants to notify each team</span></div>
<div style="position:absolute;left:56.69px;top:465.39px" class="cls_004"><span class="cls_004">and then let one representative from each team </span><span class="cls_022">“</span><span class="cls_004">own</span><span class="cls_022">”</span><span class="cls_004"> the review task.</span></div>
<div style="position:absolute;left:56.69px;top:487.82px" class="cls_004"><span class="cls_004">Either team can reject the Whitepaper. If it is rejected, the person who submitted the</span></div>
<div style="position:absolute;left:56.69px;top:500.42px" class="cls_004"><span class="cls_004">Whitepaper can make revisions and resubmit. If both teams approve, the Whitepaper</span></div>
<div style="position:absolute;left:56.69px;top:513.02px" class="cls_004"><span class="cls_004">moves on to the next step.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 350 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:246740px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background366.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Here are the high-level steps involved in implementing this process:</span></div>
<div style="position:absolute;left:91.32px;top:92.23px" class="cls_004"><span class="cls_004">1. Lay out the process using the Activiti Process Designer.</span></div>
<div style="position:absolute;left:91.32px;top:106.99px" class="cls_004"><span class="cls_004">2. Add user tasks with appropriate assignments.</span></div>
<div style="position:absolute;left:91.32px;top:121.75px" class="cls_004"><span class="cls_004">3. Add two parallel gateways and an exclusive gateway to take a decision.</span></div>
<div style="position:absolute;left:91.32px;top:136.51px" class="cls_004"><span class="cls_004">4. Wire the process to Alfresco Share by updating the SomeCoWorkflow Content</span></div>
<div style="position:absolute;left:104.69px;top:149.11px" class="cls_004"><span class="cls_004">Model and modifying the Share configuration.</span></div>
<div style="position:absolute;left:56.69px;top:173.00px" class="cls_004"><span class="cls_004">To get this done, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:194.73px" class="cls_004"><span class="cls_004">1. Create a new process in </span><span class="cls_013">repo | src | main | amp | config | alfresco</span></div>
<div style="position:absolute;left:104.69px;top:208.01px" class="cls_013"><span class="cls_013">| module | repo | workflows</span><span class="cls_004"> called </span><span class="cls_013">publishWhitepaper.bpmn20.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:223.45px" class="cls_004"><span class="cls_004">2. Using the Activiti Designer, lay out the process as shown in the diagram that</span></div>
<div style="position:absolute;left:104.69px;top:236.05px" class="cls_004"><span class="cls_004">follows:</span></div>
<div style="position:absolute;left:91.32px;top:424.98px" class="cls_004"><span class="cls_004">3. Click on the white area and change the process ID and name as displayed in the</span></div>
<div style="position:absolute;left:104.69px;top:437.58px" class="cls_004"><span class="cls_004">following screenshot:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 351 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:247416px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background367.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Now, let's configure the assignment of the Marketing Review task. Click on the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">task </span><span class="cls_007">Marketing Review</span><span class="cls_004"> and open the tab </span><span class="cls_007">Main config</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:152.69px;top:95.74px" class="cls_004"><span class="cls_004">Type </span><span class="cls_013">GROUP_Marketing</span><span class="cls_004"> in the </span><span class="cls_007">Candidate groups </span><span class="cls_004">field;</span></div>
<div style="position:absolute;left:152.69px;top:111.18px" class="cls_004"><span class="cls_004">Type </span><span class="cls_013">scwf:reviewTask</span><span class="cls_004"> in the </span><span class="cls_007">Form key</span><span class="cls_004"> field.</span></div>
<div style="position:absolute;left:124.19px;top:137.91px" class="cls_004"><span class="cls_004">It should look like this:</span></div>
<div style="position:absolute;left:91.32px;top:271.43px" class="cls_004"><span class="cls_004">5. Click on the </span><span class="cls_007">Revise </span><span class="cls_004">task and open the tab </span><span class="cls_007">Main config</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:91.32px;top:286.23px" class="cls_004"><span class="cls_004">6. Do the same with the Operation Review, but assign it to the group,</span></div>
<div style="position:absolute;left:104.69px;top:298.83px" class="cls_004"><span class="cls_004">GROUP_Operation.</span></div>
<div style="position:absolute;left:152.69px;top:311.43px" class="cls_004"><span class="cls_004">Type </span><span class="cls_013">${initiator.properties.userName}</span><span class="cls_004"> in the </span><span class="cls_007">Assignee </span><span class="cls_004">field;</span></div>
<div style="position:absolute;left:152.69px;top:326.87px" class="cls_004"><span class="cls_004">Type </span><span class="cls_013">wf:adhocTask</span><span class="cls_004"> in the </span><span class="cls_012">Form key</span><span class="cls_004"> field (which is one of the default</span></div>
<div style="position:absolute;left:152.69px;top:340.15px" class="cls_004"><span class="cls_004">forms provided by Alfresco).</span></div>
<div style="position:absolute;left:124.19px;top:366.20px" class="cls_004"><span class="cls_004">It should look like this:</span></div>
<div style="position:absolute;left:91.32px;top:495.22px" class="cls_004"><span class="cls_004">7. Do exactly the same for the </span><span class="cls_007">Approved</span><span class="cls_004"> task.</span></div>
<div style="position:absolute;left:91.32px;top:510.02px" class="cls_004"><span class="cls_004">8. Click on the </span><span class="cls_007">Start Event</span><span class="cls_004"> and populate the </span><span class="cls_007">Form key</span><span class="cls_004"> field with another type</span></div>
<div style="position:absolute;left:104.69px;top:522.65px" class="cls_004"><span class="cls_004">provided by Alfresco, bpm:startTask.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 352 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:248092px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background368.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. Finally, click on the </span><span class="cls_007">Submit </span><span class="cls_004">service task (for the moment, this task is useless, but</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">be patient and you'll see why we created it):</span></div>
<div style="position:absolute;left:117.89px;top:106.35px" class="cls_010"><span class="cls_010">logger.log("Submit whitepaper!");</span></div>
<div style="position:absolute;left:86.07px;top:126.96px" class="cls_004"><span class="cls_004">10. The shell of the process is now complete. It doesn't do anything special yet, but</span></div>
<div style="position:absolute;left:104.69px;top:139.56px" class="cls_004"><span class="cls_004">once you wire in the UI, you'll be able to test that the assignment works as you</span></div>
<div style="position:absolute;left:104.69px;top:152.16px" class="cls_004"><span class="cls_004">expect. Now let's integrate the process with Alfresco by defining the content</span></div>
<div style="position:absolute;left:104.69px;top:164.76px" class="cls_004"><span class="cls_004">model and updating the Share configuration. Update </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:178.04px" class="cls_013"><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfresco</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">model</span><span class="cls_004"> | </span><span class="cls_013">scWorkflowModel.xml</span><span class="cls_004"> by</span></div>
<div style="position:absolute;left:104.69px;top:191.32px" class="cls_004"><span class="cls_004">adding the following types:</span></div>
<div style="position:absolute;left:117.89px;top:214.53px" class="cls_010"><span class="cls_010">&lt;type name="scwf:reviewTask"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:225.33px" class="cls_010"><span class="cls_010">&lt;parent&gt;wf:activitiReviewTask&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:236.13px" class="cls_010"><span class="cls_010">&lt;overrides&gt;</span></div>
<div style="position:absolute;left:161.09px;top:246.93px" class="cls_010"><span class="cls_010">&lt;property name="bpm:packageItemActionGroup"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:257.73px" class="cls_010"><span class="cls_010">&lt;default&gt;read_package_item_actions&lt;/default&gt;</span></div>
<div style="position:absolute;left:161.09px;top:268.53px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:279.33px" class="cls_010"><span class="cls_010">&lt;/overrides&gt;</span></div>
<div style="position:absolute;left:117.89px;top:290.13px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:124.19px;top:310.61px" class="cls_004"><span class="cls_004">Don't worry too much about the </span><span class="cls_013">bpm:packageItemActionGroup</span><span class="cls_004">, it's</span></div>
<div style="position:absolute;left:124.19px;top:323.89px" class="cls_004"><span class="cls_004">explained in the following page. But if you are too curious, you can jump to</span></div>
<div style="position:absolute;left:124.19px;top:336.49px" class="cls_004"><span class="cls_004">the </span><span class="cls_012">Controlling What Actions Can Be Taken from the Task Management Dialog</span></div>
<div style="position:absolute;left:124.19px;top:349.09px" class="cls_004"><span class="cls_004">section.</span></div>
<div style="position:absolute;left:86.07px;top:370.82px" class="cls_004"><span class="cls_004">11. Finally, add the following import tag in the imports tag already existing:</span></div>
<div style="position:absolute;left:117.89px;top:394.04px" class="cls_010"><span class="cls_010">&lt;import uri="</span><a href="http://www.alfresco.org/model/">http://www.alfresco.org/model</a> </div>
<div style="position:absolute;left:139.49px;top:404.83px" class="cls_010"><span class="cls_010">/workflow/1.0" prefix="wf" /&gt;</span></div>
<div style="position:absolute;left:86.07px;top:425.44px" class="cls_004"><span class="cls_004">12. Now the </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> file. Add the Share configuration for the</span></div>
<div style="position:absolute;left:104.69px;top:438.72px" class="cls_004"><span class="cls_004">new workflow types and properties. You can see that although the BPM model</span></div>
<div style="position:absolute;left:104.69px;top:451.32px" class="cls_004"><span class="cls_004">defines several properties, you're only exposing the workflow description and</span></div>
<div style="position:absolute;left:104.69px;top:463.92px" class="cls_004"><span class="cls_004">comment properties for this particular process:</span></div>
<div style="position:absolute;left:117.89px;top:487.13px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:128.69px;top:497.93px" class="cls_010"><span class="cls_010">condition="activiti$publishWhitepaper"&gt;</span></div>
<div style="position:absolute;left:123.29px;top:508.73px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:134.09px;top:519.53px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:144.89px;top:530.33px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:541.13px" class="cls_010"><span class="cls_010">&lt;show id="bpm:workflowDescription" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:551.93px" class="cls_010"><span class="cls_010">&lt;show id="packageItems" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:562.73px" class="cls_010"><span class="cls_010">&lt;show id="transitions" /&gt;</span></div>
<div style="position:absolute;left:144.89px;top:573.53px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 353 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:248768px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background369.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:144.89px;top:69.82px" class="cls_010"><span class="cls_010">&lt;appearance&gt; &lt;set id="" appearance="title"</span></div>
<div style="position:absolute;left:155.69px;top:80.62px" class="cls_010"><span class="cls_010">label-id="workflow.set.general" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:102.22px" class="cls_010"><span class="cls_010">&lt;set id="items" appearance="title"</span></div>
<div style="position:absolute;left:171.89px;top:113.02px" class="cls_010"><span class="cls_010">label-id="workflow.set.items" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:134.62px" class="cls_010"><span class="cls_010">&lt;set id="progress" appearance="title"</span></div>
<div style="position:absolute;left:171.89px;top:145.42px" class="cls_010"><span class="cls_010">label-id="workflow.set.task.progress" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:167.02px" class="cls_010"><span class="cls_010">&lt;field id="bpm:workflowDescription"</span></div>
<div style="position:absolute;left:171.89px;top:177.82px" class="cls_010"><span class="cls_010">label-id="workflow.field.message"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:199.42px" class="cls_010"><span class="cls_010">&lt;control template="/org/alfresco/components</span></div>
<div style="position:absolute;left:177.29px;top:210.22px" class="cls_010"><span class="cls_010">/form/controls/textarea.ftl"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:231.82px" class="cls_010"><span class="cls_010">&lt;control-param name="style"&gt;</span></div>
<div style="position:absolute;left:193.49px;top:242.62px" class="cls_010"><span class="cls_010">width: 95%</span></div>
<div style="position:absolute;left:182.69px;top:253.42px" class="cls_010"><span class="cls_010">&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:171.89px;top:275.02px" class="cls_010"><span class="cls_010">&lt;/control&gt;</span></div>
<div style="position:absolute;left:161.09px;top:285.82px" class="cls_010"><span class="cls_010">&lt;/field&gt; &lt;field id="packageItems" set="items" /&gt;</span></div>
<div style="position:absolute;left:144.89px;top:296.62px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:134.09px;top:307.42px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:128.69px;top:318.22px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:329.02px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:117.89px;top:350.62px" class="cls_010"><span class="cls_010">&lt;config evaluator="task-type" condition="scwf:reviewTask"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:361.42px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:139.49px;top:372.22px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:150.29px;top:383.02px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:161.09px;top:393.82px" class="cls_010"><span class="cls_010">&lt;show id="message" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:404.62px" class="cls_010"><span class="cls_010">&lt;show id="packageItems" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:415.42px" class="cls_010"><span class="cls_010">&lt;show id="bpm:comment" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:426.22px" class="cls_010"><span class="cls_010">&lt;show id="wf:reviewOutcome" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:437.02px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:447.82px" class="cls_010"><span class="cls_010">&lt;appearance&gt;</span></div>
<div style="position:absolute;left:161.09px;top:458.62px" class="cls_010"><span class="cls_010">&lt;set id="" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:469.42px" class="cls_010"><span class="cls_010">label-id="workflow.set.task.info" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:480.22px" class="cls_010"><span class="cls_010">&lt;set id="info" appearance="" template="/org/alfresco</span></div>
<div style="position:absolute;left:161.09px;top:491.02px" class="cls_010"><span class="cls_010">/components/form/3-column-set.ftl" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:501.82px" class="cls_010"><span class="cls_010">&lt;set id="progress" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:512.62px" class="cls_010"><span class="cls_010">label-id="workflow.set.task.progress" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:523.42px" class="cls_010"><span class="cls_010">&lt;set id="items" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:534.22px" class="cls_010"><span class="cls_010">label-id="workflow.set.items" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:545.02px" class="cls_010"><span class="cls_010">&lt;set id="response" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:555.82px" class="cls_010"><span class="cls_010">label-id="workflow.set.response" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:566.62px" class="cls_010"><span class="cls_010">&lt;field id="message"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:577.42px" class="cls_010"><span class="cls_010">&lt;control template="/org/alfresco/components</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 354 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:249444px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background370.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:182.69px;top:69.82px" class="cls_010"><span class="cls_010">/form/controls/info.ftl" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:161.09px;top:91.42px" class="cls_010"><span class="cls_010">&lt;field id="packageItems" set="items" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:102.22px" class="cls_010"><span class="cls_010">&lt;field id="bpm:comment"</span></div>
<div style="position:absolute;left:161.09px;top:113.02px" class="cls_010"><span class="cls_010">label-id="workflow.field.comment" set="response"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:123.82px" class="cls_010"><span class="cls_010">&lt;control template="/org/alfresco</span></div>
<div style="position:absolute;left:161.09px;top:134.62px" class="cls_010"><span class="cls_010">/components/form/controls/textarea.ftl"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:145.42px" class="cls_010"><span class="cls_010">&lt;control-param name="saveLineBreaks"&gt;true&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:161.09px;top:156.22px" class="cls_010"><span class="cls_010">&lt;/control&gt;</span></div>
<div style="position:absolute;left:150.29px;top:167.02px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:150.29px;top:177.82px" class="cls_010"><span class="cls_010">&lt;field id="wf:reviewOutcome"</span></div>
<div style="position:absolute;left:150.29px;top:188.62px" class="cls_010"><span class="cls_010">label-id="workflow.field.outcome" set="response"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:199.42px" class="cls_010"><span class="cls_010">&lt;control template="/org/alfresco/components</span></div>
<div style="position:absolute;left:182.69px;top:210.22px" class="cls_010"><span class="cls_010">/form/controls/workflow/activiti-transitions.ftl" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:221.02px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:139.49px;top:231.82px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:128.69px;top:242.62px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:117.89px;top:253.42px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:264.22px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:124.19px;top:284.70px" class="cls_004"><span class="cls_004">In the previous XML code, we can see that we define a config element based</span></div>
<div style="position:absolute;left:124.19px;top:297.30px" class="cls_004"><span class="cls_004">on the Activiti workflow identifier that will configure the form that you see</span></div>
<div style="position:absolute;left:124.19px;top:309.90px" class="cls_004"><span class="cls_004">when you start a new workflow; and another config element based on the</span></div>
<div style="position:absolute;left:124.19px;top:322.50px" class="cls_004"><span class="cls_004">type scwf:reviewTask. To summarize, when you want to configure a</span></div>
<div style="position:absolute;left:124.19px;top:335.10px" class="cls_004"><span class="cls_004">workflow form, you should use the Activiti workflow identifier for the start</span></div>
<div style="position:absolute;left:124.19px;top:347.70px" class="cls_004"><span class="cls_004">task, and the content type that you defined in the </span><span class="cls_007">Form Key</span><span class="cls_004"> attribute for all</span></div>
<div style="position:absolute;left:124.19px;top:360.34px" class="cls_004"><span class="cls_004">other user tasks.</span></div>
<div style="position:absolute;left:86.07px;top:382.07px" class="cls_004"><span class="cls_004">13. Then, we need to update the </span><span class="cls_013">workflow-context.xml</span><span class="cls_004"> file and add the definition</span></div>
<div style="position:absolute;left:104.69px;top:395.35px" class="cls_004"><span class="cls_004">of our workflow in the list by adding this element to the list tag:</span></div>
<div style="position:absolute;left:117.89px;top:418.56px" class="cls_010"><span class="cls_010">&lt;props&gt;</span></div>
<div style="position:absolute;left:128.69px;top:429.36px" class="cls_010"><span class="cls_010">&lt;prop key="engineId"&gt;activiti&lt;/prop&gt;</span></div>
<div style="position:absolute;left:128.69px;top:440.16px" class="cls_010"><span class="cls_010">&lt;prop key="location"&gt;alfresco/module</span></div>
<div style="position:absolute;left:139.49px;top:450.96px" class="cls_010"><span class="cls_010">/${project.artifactId}/workflows</span></div>
<div style="position:absolute;left:139.49px;top:461.76px" class="cls_010"><span class="cls_010">/publishWhitepaper.bpmn20.xml&lt;/prop&gt;</span></div>
<div style="position:absolute;left:128.69px;top:472.56px" class="cls_010"><span class="cls_010">&lt;prop key="mimetype"&gt;text/xml&lt;/prop&gt;</span></div>
<div style="position:absolute;left:128.69px;top:483.36px" class="cls_010"><span class="cls_010">&lt;prop key="redeploy"&gt;true&lt;/prop&gt;</span></div>
<div style="position:absolute;left:117.89px;top:494.16px" class="cls_010"><span class="cls_010">&lt;/props&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 355 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:250120px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background371.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">14. The last step is to externalize the strings. Update </span><span class="cls_013">repo</span></div>
<div style="position:absolute;left:362.02px;top:71.00px" class="cls_013"><span class="cls_013">| src | main | amp |</span></div>
<div style="position:absolute;left:104.69px;top:83.00px" class="cls_013"><span class="cls_013">config | alfresco | module | repo | messages |</span></div>
<div style="position:absolute;left:104.69px;top:95.78px" class="cls_013"><span class="cls_013">scWorkflow.properties</span><span class="cls_004"> with the model-related strings:</span></div>
<div style="position:absolute;left:117.89px;top:119.67px" class="cls_010"><span class="cls_010">scwf_workflowmodel.type.scwf_reviewTask.title</span></div>
<div style="position:absolute;left:123.29px;top:130.47px" class="cls_010"><span class="cls_010">=Whitepaper Review Task</span></div>
<div style="position:absolute;left:117.89px;top:141.27px" class="cls_010"><span class="cls_010">scwf_workflowmodel.type.scwf_reviewTask.description</span></div>
<div style="position:absolute;left:123.29px;top:152.07px" class="cls_010"><span class="cls_010">=Review documents</span></div>
<div style="position:absolute;left:117.89px;top:162.87px" class="cls_010"><span class="cls_010">publishWhitepaper.workflow.title</span></div>
<div style="position:absolute;left:123.29px;top:173.67px" class="cls_010"><span class="cls_010">=Publish Whitepaper to SC Web</span></div>
<div style="position:absolute;left:117.89px;top:184.47px" class="cls_010"><span class="cls_010">publishWhitepaper.workflow.description</span></div>
<div style="position:absolute;left:123.29px;top:195.27px" class="cls_010"><span class="cls_010">=Review and approve SC Whitepaper content</span></div>
<div style="position:absolute;left:86.07px;top:215.88px" class="cls_004"><span class="cls_004">15. Save the properties file.</span></div>
<div style="position:absolute;left:86.07px;top:230.64px" class="cls_004"><span class="cls_004">16. Package and deploy the changes and then restart Alfresco. Don't forget to restart</span></div>
<div style="position:absolute;left:104.69px;top:243.24px" class="cls_004"><span class="cls_004">Share too if you are using the SDK.</span></div>
<div style="position:absolute;left:86.07px;top:258.00px" class="cls_004"><span class="cls_004">17. Test the process.</span></div>
<div style="position:absolute;left:56.69px;top:281.89px" class="cls_004"><span class="cls_004">To test the process, do the following:</span></div>
<div style="position:absolute;left:91.32px;top:303.62px" class="cls_004"><span class="cls_004">1. If you haven't done so already, create a group called </span><span class="cls_013">Operations</span><span class="cls_004"> and one called</span></div>
<div style="position:absolute;left:104.69px;top:316.90px" class="cls_013"><span class="cls_013">Marketing</span><span class="cls_004">. Create a couple of test users for each group.</span></div>
<div style="position:absolute;left:91.32px;top:332.34px" class="cls_004"><span class="cls_004">2. In the repository, create a test Whitepaper in the </span><span class="cls_007">Marketing </span><span class="cls_004">site</span><span class="cls_007">,</span><span class="cls_004"> if you don't have</span></div>
<div style="position:absolute;left:104.69px;top:344.98px" class="cls_004"><span class="cls_004">any already.</span></div>
<div style="position:absolute;left:91.32px;top:359.74px" class="cls_004"><span class="cls_004">3. Configure the permissions on the Marketing site such that the marketing and</span></div>
<div style="position:absolute;left:104.69px;top:372.34px" class="cls_004"><span class="cls_004">operation groups have Collaborator access or higher.</span></div>
<div style="position:absolute;left:91.32px;top:387.10px" class="cls_004"><span class="cls_004">4. Start a workflow by clicking on the action </span><span class="cls_007">More</span><span class="cls_028">…</span><span class="cls_007">|Start Workflow</span><span class="cls_004">on your test</span></div>
<div style="position:absolute;left:104.69px;top:400.53px" class="cls_004"><span class="cls_004">Whitepaper.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 356 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:250796px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background372.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5.  You should see the newly-deployed workflow in the list of available workflows:</span></div>
<div style="position:absolute;left:91.32px;top:312.68px" class="cls_004"><span class="cls_004">6. Add a message and click on </span><span class="cls_007">Start Workflow</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 357 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:251472px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background373.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Log in as one of your test users. On the user dashboard, you should have the </span><span class="cls_007">My</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_007"><span class="cls_007">Tasks </span><span class="cls_004">dashlet (if not, add it by configuring your dashboard):</span></div>
<div style="position:absolute;left:91.32px;top:277.36px" class="cls_004"><span class="cls_004">8. You will notice that we see the value that you entered in the </span><span class="cls_007">Message </span><span class="cls_004">field as a</span></div>
<div style="position:absolute;left:104.69px;top:289.99px" class="cls_004"><span class="cls_004">task description. If you didn't populate it, you would have seen the name of the</span></div>
<div style="position:absolute;left:104.69px;top:302.59px" class="cls_004"><span class="cls_004">task:</span></div>
<div style="position:absolute;left:91.32px;top:505.02px" class="cls_004"><span class="cls_004">9. You can notice the UNASSIGNED label. It's because this process is designed with</span></div>
<div style="position:absolute;left:104.69px;top:517.62px" class="cls_004"><span class="cls_004">candidate users, so any users in the </span><span class="cls_007">Marketing </span><span class="cls_004">group can complete this task. If</span></div>
<div style="position:absolute;left:104.69px;top:530.26px" class="cls_004"><span class="cls_004">you click on the task, either take ownership of the task by clicking on the </span><span class="cls_007">Claim</span></div>
<div style="position:absolute;left:104.69px;top:542.90px" class="cls_004"><span class="cls_004">button (the task will disappear off the list of tasks for all other marketing users)</span></div>
<div style="position:absolute;left:104.69px;top:555.50px" class="cls_004"><span class="cls_004">or simply </span><span class="cls_007">Approve </span><span class="cls_004">or </span><span class="cls_007">Reject </span><span class="cls_004">the task.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 358 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:252148px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background374.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10. After you have completed the </span><span class="cls_007">Marketing Review</span><span class="cls_004"> and the </span><span class="cls_007">Operation Review</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">open the </span><span class="cls_007">Activiti Workflow Console</span><span class="cls_004">. Open the tab </span><span class="cls_007">Process Instances</span><span class="cls_004"> and locate</span></div>
<div style="position:absolute;left:104.69px;top:95.78px" class="cls_004"><span class="cls_004">your workflow instance. You'll see that an </span><span class="cls_007">Approved</span><span class="cls_004"> task is assigned to the user</span></div>
<div style="position:absolute;left:104.69px;top:108.41px" class="cls_004"><span class="cls_004">that you used to start the workflow, and is waiting to be completed. You can see</span></div>
<div style="position:absolute;left:104.69px;top:121.01px" class="cls_004"><span class="cls_004">as well who completed the </span><span class="cls_007">Marketing</span><span class="cls_004"> and </span><span class="cls_007">Operation</span><span class="cls_004"> Review:</span></div>
<div style="position:absolute;left:86.07px;top:466.12px" class="cls_004"><span class="cls_004">11. Login as the initiator of the workflow, complete the task, and go back to the</span></div>
<div style="position:absolute;left:104.69px;top:478.72px" class="cls_004"><span class="cls_004">workflow console. Your process instance should disappear, because it's complete.</span></div>
<div style="position:absolute;left:56.69px;top:506.44px" class="cls_004"><span class="cls_004">In the real world, you'd run several tests as you have to make sure you test every possible</span></div>
<div style="position:absolute;left:56.69px;top:519.04px" class="cls_004"><span class="cls_004">path through the workflow. This can be tedious. So if you are doing several complex</span></div>
<div style="position:absolute;left:56.69px;top:531.64px" class="cls_004"><span class="cls_004">workflows as part of your project, make sure you allocate enough time to test them</span></div>
<div style="position:absolute;left:56.69px;top:544.24px" class="cls_004"><span class="cls_004">adequately. Bumpy workflows are a surefire way to erode user adoption.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 359 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:252824px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background375.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you test this workflow, you'll notice that the workflow always goes to the </span><span class="cls_007">Approved</span><span class="cls_004"> task,</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">even if you click on the </span><span class="cls_007">Reject</span><span class="cls_004"> button on the review tasks. It's because we haven't</span></div>
<div style="position:absolute;left:56.69px;top:95.78px" class="cls_004"><span class="cls_004">configured the decision process yet.</span></div>
<div style="position:absolute;left:56.69px;top:133.55px" class="cls_014"><span class="cls_014">Controlling what actions can be taken from the</span></div>
<div style="position:absolute;left:56.69px;top:155.15px" class="cls_014"><span class="cls_014">Task Management dialog</span></div>
<div style="position:absolute;left:56.69px;top:190.46px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">bpm:packageItemActionGroup</span><span class="cls_004"> defines what actions are available for working with</span></div>
<div style="position:absolute;left:56.69px;top:203.74px" class="cls_004"><span class="cls_004">the content in the workflow at that particular step in the process. The reviewers should not</span></div>
<div style="position:absolute;left:56.69px;top:216.34px" class="cls_004"><span class="cls_004">be able to add or remove anything to or from the workflow. The property is set to have</span></div>
<div style="position:absolute;left:56.69px;top:228.94px" class="cls_004"><span class="cls_004">read_package_item_actions as the default:</span></div>
<div style="position:absolute;left:74.69px;top:253.82px" class="cls_010"><span class="cls_010">&lt;overrides&gt; &lt;property name="bpm:packageItemActionGroup"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:264.62px" class="cls_010"><span class="cls_010">&lt;default&gt;read_package_item_actions&lt;/default&gt; &lt;/property&gt; &lt;/overrides&gt;</span></div>
<div style="position:absolute;left:56.69px;top:289.06px" class="cls_004"><span class="cls_004">If you login as reviewer and open a task, you should only be able to read the list of</span></div>
<div style="position:absolute;left:56.69px;top:301.66px" class="cls_004"><span class="cls_004">documents:</span></div>
<div style="position:absolute;left:56.69px;top:417.18px" class="cls_004"><span class="cls_004">Then, if you login as the initiator of the workflow and open the </span><span class="cls_007">Accepted</span><span class="cls_004">task, you should</span></div>
<div style="position:absolute;left:56.69px;top:429.81px" class="cls_004"><span class="cls_004">be able to add new documents to your process. It's because the default action group is</span></div>
<div style="position:absolute;left:56.69px;top:442.41px" class="cls_004"><span class="cls_004">add_package_item_actions:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 360 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:253500px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background376.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Other out-of-the box package item action groups include:</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">edit_and_remove_package_item_actions, remove_package_item_actions, and</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">add_package_item_actions.</span></div>
<div style="position:absolute;left:56.69px;top:133.48px" class="cls_014"><span class="cls_014">Enabling the Workflow Initiator to Select Users</span></div>
<div style="position:absolute;left:56.69px;top:155.08px" class="cls_014"><span class="cls_014">and Groups</span></div>
<div style="position:absolute;left:56.69px;top:190.38px" class="cls_004"><span class="cls_004">If you have run any of the out-of-the box advanced workflows, you've seen that it is</span></div>
<div style="position:absolute;left:56.69px;top:202.98px" class="cls_004"><span class="cls_004">possible to let the workflow initiator select users and/or groups, which are then used to</span></div>
<div style="position:absolute;left:56.69px;top:215.58px" class="cls_004"><span class="cls_004">assign tasks. In SomeCo's example, you hardcoded the groups on each task, but doing</span></div>
<div style="position:absolute;left:56.69px;top:228.18px" class="cls_004"><span class="cls_004">something user-configurable is easy.</span></div>
<div style="position:absolute;left:56.69px;top:253.74px" class="cls_004"><span class="cls_004">Alfresco's out-of-the box process definitions reside in the JAR file alfresco-repository-5.*.jar</span></div>
<div style="position:absolute;left:56.69px;top:266.34px" class="cls_004"><span class="cls_004">located in the web application in the WEB-INF|lib. All process definitions are in the</span></div>
<div style="position:absolute;left:56.69px;top:278.94px" class="cls_004"><span class="cls_004">subfolder alfresco|workflow. You'll notice there are a number of processes that don't get</span></div>
<div style="position:absolute;left:56.69px;top:291.54px" class="cls_004"><span class="cls_004">deployed out-of-the box although they are defined and ready to use. You can also use the</span></div>
<div style="position:absolute;left:56.69px;top:304.14px" class="cls_007"><span class="cls_007">Activiti Explorer</span><span class="cls_004"> to get all deployed workflow definitions. Let's look at adhoc.bpmn20.xml</span></div>
<div style="position:absolute;left:56.69px;top:316.78px" class="cls_004"><span class="cls_004">to see an example of how initiator-specified user and group assignment works.</span></div>
<div style="position:absolute;left:56.69px;top:342.34px" class="cls_004"><span class="cls_004">There are two things of interest in this file related to how the task assignment works. First,</span></div>
<div style="position:absolute;left:56.69px;top:354.94px" class="cls_004"><span class="cls_004">note that the start event is using the form </span><span class="cls_013">wf:submitAdhocTask</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:380.50px" class="cls_010"><span class="cls_010">&lt;startEvent id="start" activiti:formKey="wf:submitAdhocTask" /&gt;</span></div>
<div style="position:absolute;left:56.69px;top:404.94px" class="cls_004"><span class="cls_004">You know from the previous examples that there must be a corresponding type in</span></div>
<div style="position:absolute;left:56.69px;top:417.54px" class="cls_004"><span class="cls_004">Alfresco's model of the same name. You'll see that soon.</span></div>
<div style="position:absolute;left:56.69px;top:443.10px" class="cls_004"><span class="cls_004">Next, notice that the adhoc </span><span class="cls_007">Task </span><span class="cls_004">is using an expression. However, instead of using the</span></div>
<div style="position:absolute;left:56.69px;top:455.74px" class="cls_007"><span class="cls_007">Assignee</span><span class="cls_004"> attribute (as we did before), it's using the </span><span class="cls_013">humanPerformer</span><span class="cls_004"> attribute that is</span></div>
<div style="position:absolute;left:56.69px;top:469.02px" class="cls_004"><span class="cls_004">exactly the same thing. The expression will resolve to an association called assignee in the</span></div>
<div style="position:absolute;left:56.69px;top:481.62px" class="cls_004"><span class="cls_004">bpm namespace that points to the </span><span class="cls_022">“</span><span class="cls_004">person</span><span class="cls_022">”</span><span class="cls_004"> object being assigned:</span></div>
<div style="position:absolute;left:74.69px;top:507.33px" class="cls_010"><span class="cls_010">&lt;userTask id="adhocTask" name="Adhoc Task" activiti:formKey="wf:adhocTask"&gt;</span></div>
<div style="position:absolute;left:74.69px;top:518.13px" class="cls_010"><span class="cls_010">&lt;extensionElements&gt; [...] &lt;/extensionElements&gt; &lt;humanPerformer&gt;</span></div>
<div style="position:absolute;left:74.69px;top:528.93px" class="cls_010"><span class="cls_010">&lt;resourceAssignmentExpression&gt;</span></div>
<div style="position:absolute;left:74.69px;top:539.73px" class="cls_010"><span class="cls_010">&lt;formalExpression&gt;${bpm_assignee.properties.userName}&lt;/formalExpression&gt;</span></div>
<div style="position:absolute;left:74.69px;top:550.53px" class="cls_010"><span class="cls_010">&lt;/resourceAssignmentExpression&gt; &lt;/humanPerformer&gt; &lt;/userTask&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 361 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:254176px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background377.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Alfresco's workflow model,workflowModel.xml, includes the wf:submitAdhocTask type</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">which includes the aspect bpm:assignee as required aspect. (The association to a user, also</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">called bpm:assignee, lives in the BPM model.)</span></div>
<div style="position:absolute;left:74.69px;top:120.58px" class="cls_010"><span class="cls_010">&lt;type name="wf:submitAdhocTask"&gt; &lt;parent&gt;bpm:startTask&lt;/parent&gt; ...</span></div>
<div style="position:absolute;left:74.69px;top:131.38px" class="cls_010"><span class="cls_010">&lt;mandatory-aspects&gt; &lt;aspect&gt;bpm:assignee&lt;/aspect&gt; &lt;/mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:74.69px;top:142.18px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:56.69px;top:174.88px" class="cls_014"><span class="cls_014">Step-by-step - use dynamic user assignment</span></div>
<div style="position:absolute;left:56.69px;top:210.18px" class="cls_004"><span class="cls_004">We are going to update our process by allowing the initiator to select a user that will be</span></div>
<div style="position:absolute;left:56.69px;top:222.78px" class="cls_004"><span class="cls_004">assigned when the workflow is initiated. Then, the </span><span class="cls_007">Approved</span><span class="cls_004"> task will be assigned to this</span></div>
<div style="position:absolute;left:56.69px;top:235.42px" class="cls_004"><span class="cls_004">user.</span></div>
<div style="position:absolute;left:91.32px;top:260.98px" class="cls_004"><span class="cls_004">1. Open the workflow definition with the Activiti Designer.</span></div>
<div style="position:absolute;left:91.32px;top:275.74px" class="cls_004"><span class="cls_004">2. Click on the </span><span class="cls_007">Start Event</span><span class="cls_004">, open the </span><span class="cls_007">Properties</span><span class="cls_004"> view, open the </span><span class="cls_007">Main config</span><span class="cls_004"> tab and</span></div>
<div style="position:absolute;left:104.69px;top:288.38px" class="cls_004"><span class="cls_004">change the value of the </span><span class="cls_007">Form key</span><span class="cls_004"> field with </span><span class="cls_013">wf:submitReviewTask</span><span class="cls_004"> that</span></div>
<div style="position:absolute;left:104.69px;top:301.66px" class="cls_004"><span class="cls_004">contains as well the </span><span class="cls_007">bpm:assignee</span><span class="cls_004"> aspect.</span></div>
<div style="position:absolute;left:91.32px;top:316.45px" class="cls_004"><span class="cls_004">3. Then, click on the </span><span class="cls_007">Approved</span><span class="cls_004"> task, open the </span><span class="cls_007">Properties</span><span class="cls_004"> view, open the </span><span class="cls_007">Main</span></div>
<div style="position:absolute;left:104.69px;top:329.09px" class="cls_007"><span class="cls_007">config</span><span class="cls_004"> tab, and change the value of the </span><span class="cls_007">Assignee</span><span class="cls_004"> field with</span></div>
<div style="position:absolute;left:104.69px;top:341.73px" class="cls_013"><span class="cls_013">${bpm_assignee.properties.userName}</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:124.19px;top:370.13px" class="cls_004"><span class="cls_004">Save the workflow definition.</span></div>
<div style="position:absolute;left:124.19px;top:395.69px" class="cls_004"><span class="cls_004">Edit </span><span class="cls_013">the share-config-custom.xml</span><span class="cls_004"> file, and replace the </span><span class="cls_007">config</span><span class="cls_004"> element</span></div>
<div style="position:absolute;left:124.19px;top:408.97px" class="cls_004"><span class="cls_004">with the property </span><span class="cls_007">condition</span><span class="cls_004"> equal to </span><span class="cls_013">activiti$publishWhitepaper</span><span class="cls_004"> with</span></div>
<div style="position:absolute;left:124.19px;top:422.25px" class="cls_004"><span class="cls_004">the following element. The difference between the previous configuration</span></div>
<div style="position:absolute;left:124.19px;top:434.85px" class="cls_004"><span class="cls_004">and this one is the displaying of the association </span><span class="cls_013">bpm:assignee</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:117.89px;top:460.41px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:139.49px;top:471.21px" class="cls_010"><span class="cls_010">condition="activiti$publishWhitepaper"&gt;</span></div>
<div style="position:absolute;left:123.29px;top:482.01px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:128.69px;top:492.81px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:503.61px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:514.41px" class="cls_010"><span class="cls_010">&lt;show id="bpm:workflowDescription" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:525.21px" class="cls_010"><span class="cls_010">&lt;show id="bpm:assignee" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:536.01px" class="cls_010"><span class="cls_010">&lt;show id="packageItems" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:546.81px" class="cls_010"><span class="cls_010">&lt;show id="transitions" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:557.61px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:139.49px;top:568.41px" class="cls_010"><span class="cls_010">&lt;appearance&gt;</span></div>
<div style="position:absolute;left:150.29px;top:579.21px" class="cls_010"><span class="cls_010">&lt;set id="" appearance="title"</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 362 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:254852px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background378.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">label-id="workflow.set.general" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:91.42px" class="cls_010"><span class="cls_010">&lt;set id="items" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:102.22px" class="cls_010"><span class="cls_010">label-id="workflow.set.items" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:123.82px" class="cls_010"><span class="cls_010">&lt;set id="assignee" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:134.62px" class="cls_010"><span class="cls_010">label-id="workflow.set.assignee" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:156.22px" class="cls_010"><span class="cls_010">&lt;set id="progress" appearance="title"</span></div>
<div style="position:absolute;left:161.09px;top:167.02px" class="cls_010"><span class="cls_010">label-id="workflow.set.task.progress" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:188.62px" class="cls_010"><span class="cls_010">&lt;field id="bpm:workflowDescription"</span></div>
<div style="position:absolute;left:166.49px;top:199.42px" class="cls_010"><span class="cls_010">label-id="workflow.field.message"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:221.02px" class="cls_010"><span class="cls_010">&lt;control template="/org/alfresco/components</span></div>
<div style="position:absolute;left:171.89px;top:231.82px" class="cls_010"><span class="cls_010">/form/controls/textarea.ftl"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:253.42px" class="cls_010"><span class="cls_010">&lt;control-param name="style"&gt;width: 95%&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:161.09px;top:264.22px" class="cls_010"><span class="cls_010">&lt;/control&gt;</span></div>
<div style="position:absolute;left:150.29px;top:275.02px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:150.29px;top:285.82px" class="cls_010"><span class="cls_010">&lt;field id="bpm:assignee"</span></div>
<div style="position:absolute;left:161.09px;top:296.62px" class="cls_010"><span class="cls_010">label-id="workflow.field.assign_to" set="assignee" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:307.42px" class="cls_010"><span class="cls_010">&lt;field id="packageItems" set="items" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:318.22px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:139.49px;top:329.02px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:128.69px;top:339.82px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:350.62px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:371.23px" class="cls_004"><span class="cls_004">4. Package, deploy, and restart Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:398.95px" class="cls_004"><span class="cls_004">To test the process, do the following:</span></div>
<div style="position:absolute;left:91.32px;top:424.51px" class="cls_004"><span class="cls_004">1. Login and starts a new workflow on one test Whitepaper.</span></div>
<div style="position:absolute;left:124.19px;top:452.23px" class="cls_004"><span class="cls_004">You should be able to see a new field called </span><span class="cls_007">Assignee </span><span class="cls_004">at the bottom of the</span></div>
<div style="position:absolute;left:124.19px;top:464.87px" class="cls_004"><span class="cls_004">screen. Click on </span><span class="cls_007">Select</span><span class="cls_004"> and search for one user, and select it:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 363 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:255528px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background379.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:250.46px" class="cls_004"><span class="cls_004">2. Click on </span><span class="cls_007">Start Workflow</span><span class="cls_004">, and then complete the two review tasks. Then, if you</span></div>
<div style="position:absolute;left:104.69px;top:263.10px" class="cls_004"><span class="cls_004">open the </span><span class="cls_007">Activiti Explorer</span><span class="cls_004">, you'll notice that the </span><span class="cls_007">Approved</span><span class="cls_004"> task is now assigned</span></div>
<div style="position:absolute;left:104.69px;top:275.74px" class="cls_004"><span class="cls_004">to the username, </span><span class="cls_007">albus </span><span class="cls_004">in our case:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 364 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:256204px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background380.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You can set up user and group selection in your own process definitions by following the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">same pattern.</span></div>
<div style="position:absolute;left:56.69px;top:120.77px" class="cls_008"><span class="cls_008">Adding Logic to Workflows with Listeners</span></div>
<div style="position:absolute;left:56.69px;top:144.77px" class="cls_008"><span class="cls_008">and Process Variables</span></div>
<div style="position:absolute;left:56.69px;top:182.58px" class="cls_004"><span class="cls_004">So far you've seen that a process can be modeled as a collection of nodes connected via</span></div>
<div style="position:absolute;left:56.69px;top:195.18px" class="cls_004"><span class="cls_004">paths or transitions. A common requirement is to be able to execute some code or business</span></div>
<div style="position:absolute;left:56.69px;top:207.78px" class="cls_004"><span class="cls_004">logic at certain points within the process. For example, maybe you want to send an e-mail</span></div>
<div style="position:absolute;left:56.69px;top:220.38px" class="cls_004"><span class="cls_004">or want to increment a counter that keeps track of how many times a node has been</span></div>
<div style="position:absolute;left:56.69px;top:232.98px" class="cls_004"><span class="cls_004">executed. We already used the concept of service tasks to execute some codes, but now we</span></div>
<div style="position:absolute;left:56.69px;top:245.58px" class="cls_004"><span class="cls_004">are going to use event listeners.</span></div>
<div style="position:absolute;left:56.69px;top:271.14px" class="cls_004"><span class="cls_004">An event mechanism has been introduced in Activiti to get notified when various events</span></div>
<div style="position:absolute;left:56.69px;top:283.74px" class="cls_004"><span class="cls_004">occur within the engine. In our use case, we are going to focus on the </span><span class="cls_007">Task Listener</span><span class="cls_004">. A task</span></div>
<div style="position:absolute;left:56.69px;top:296.39px" class="cls_012"><span class="cls_012">listener</span><span class="cls_004"> is used to execute custom Java logic or an expression upon the occurrence of a</span></div>
<div style="position:absolute;left:56.69px;top:308.99px" class="cls_004"><span class="cls_004">certain task-related event. Using the Activiti Designer, you can create listeners on user tasks</span></div>
<div style="position:absolute;left:56.69px;top:321.59px" class="cls_004"><span class="cls_004">where you'll be able to configure:</span></div>
<div style="position:absolute;left:104.69px;top:347.15px" class="cls_004"><span class="cls_004">The event nature: create, assignment, complete, or all.</span></div>
<div style="position:absolute;left:104.69px;top:361.91px" class="cls_004"><span class="cls_004">The event type: Java class, expression, delegate expression, Alfresco execution</span></div>
<div style="position:absolute;left:104.69px;top:374.51px" class="cls_004"><span class="cls_004">script, or Alfresco task script.</span></div>
<div style="position:absolute;left:56.69px;top:402.23px" class="cls_004"><span class="cls_004">We are going to discover some of them in the next section.</span></div>
<div style="position:absolute;left:56.69px;top:440.00px" class="cls_014"><span class="cls_014">Storing Data in Process Variables</span></div>
<div style="position:absolute;left:56.69px;top:475.31px" class="cls_004"><span class="cls_004">Often, there is metadata about a process that needs to be tracked. A due date or a priority</span></div>
<div style="position:absolute;left:56.69px;top:487.91px" class="cls_004"><span class="cls_004">flag are two examples. A due date isn't really a property of the content being routed</span></div>
<div style="position:absolute;left:56.69px;top:500.51px" class="cls_004"><span class="cls_004">through the workflow-it's a property of the process. Activiti gives us the ability to store this</span></div>
<div style="position:absolute;left:56.69px;top:513.11px" class="cls_004"><span class="cls_004">kind of data as part of the running process through process variables</span><span class="cls_012">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 365 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:256880px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background381.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Process variables are name-value pairs that get persisted with the rest of the process state.</span></div>
<div style="position:absolute;left:56.69px;top:83.11px" class="cls_004"><span class="cls_004">To keep it simple, a process instance can have variables (called </span><span class="cls_012">process variables</span><span class="cls_004">) and user</span></div>
<div style="position:absolute;left:56.69px;top:95.71px" class="cls_004"><span class="cls_004">tasks can have variables too. Then, there is a mapping between the properties defined in the</span></div>
<div style="position:absolute;left:56.69px;top:108.31px" class="cls_004"><span class="cls_004">content model and Activiti variables. If you look at the out-of-the-box workflow definition</span></div>
<div style="position:absolute;left:56.69px;top:120.91px" class="cls_004"><span class="cls_004">adhoc.bpmn20.xml, you'll notice the use of multiple variables related to the content model</span></div>
<div style="position:absolute;left:56.69px;top:133.51px" class="cls_004"><span class="cls_004">such as bpm_workflowDueDate, bpm_workflowPriority or wf_notifyMe. All these</span></div>
<div style="position:absolute;left:56.69px;top:146.11px" class="cls_004"><span class="cls_004">variables are created automatically by Alfresco and are matched to the values stored by the</span></div>
<div style="position:absolute;left:56.69px;top:158.71px" class="cls_004"><span class="cls_004">content model.</span></div>
<div style="position:absolute;left:56.69px;top:184.27px" class="cls_004"><span class="cls_004">Some other variables are provided by Alfresco that you can find on this page</span></div>
<div style="position:absolute;left:56.69px;top:196.87px" class="cls_004"><span class="cls_004"> </span><a href="http://docs.alfresco.com/5.1/concepts/wf-process-def-node-objects.html./">http://docs.alfresco.com/5.1/concepts/wf-process-def-node-objects.html.</a> One very important</div>
<div style="position:absolute;left:56.69px;top:209.47px" class="cls_004"><span class="cls_004">one is the variable called bpm_package. This variable contains associations to the</span></div>
<div style="position:absolute;left:56.69px;top:222.07px" class="cls_004"><span class="cls_004">document(s) attached to the current workflow instance. So, you can easily update some</span></div>
<div style="position:absolute;left:56.69px;top:234.67px" class="cls_004"><span class="cls_004">properties on attached document along the process.</span></div>
<div style="position:absolute;left:56.69px;top:260.23px" class="cls_004"><span class="cls_004">In the following example, the script element sets an execution variable called scwf_tempCnt</span></div>
<div style="position:absolute;left:56.69px;top:272.83px" class="cls_004"><span class="cls_004">equal to 0 when the token enters the node:</span></div>
<div style="position:absolute;left:74.69px;top:297.71px" class="cls_010"><span class="cls_010">&lt;extensionElements&gt;</span></div>
<div style="position:absolute;left:74.69px;top:308.51px" class="cls_010"><span class="cls_010">&lt;activiti:taskListener event="create"</span></div>
<div style="position:absolute;left:74.69px;top:319.31px" class="cls_010"><span class="cls_010">class="org.alfresco.repo.workflow.activiti.tasklistener.ScriptTaskListener"</span></div>
<div style="position:absolute;left:74.69px;top:330.11px" class="cls_010"><span class="cls_010">&gt;</span></div>
<div style="position:absolute;left:74.69px;top:340.91px" class="cls_010"><span class="cls_010">&lt;activiti:field name="script"&gt; &lt;activiti:string&gt;</span></div>
<div style="position:absolute;left:74.69px;top:351.71px" class="cls_010"><span class="cls_010">&lt;![CDATA[execution.setVariable('scwf_tempCnt', 0);]]&gt; &lt;/activiti:string&gt;</span></div>
<div style="position:absolute;left:74.69px;top:362.51px" class="cls_010"><span class="cls_010">&lt;/activiti:field&gt; &lt;/activiti:taskListener&gt; &lt;/extensionElements&gt; Elsewhere</span></div>
<div style="position:absolute;left:74.69px;top:373.31px" class="cls_010"><span class="cls_010">in the process, you can read the value of the variable with an expression</span></div>
<div style="position:absolute;left:74.69px;top:384.11px" class="cls_010"><span class="cls_010">like: ${scwf_tempCnt}</span></div>
<div style="position:absolute;left:56.69px;top:408.55px" class="cls_004"><span class="cls_004">You'll use this kind of syntax on condition in a workflow when you want to implement an</span></div>
<div style="position:absolute;left:56.69px;top:421.15px" class="cls_004"><span class="cls_004">exclusive gateway.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 366 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:257556px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background382.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - adding logic to the Whitepaper</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">submission workflow</span></div>
<div style="position:absolute;left:56.69px;top:126.66px" class="cls_004"><span class="cls_004">The process you've built so far assigns tasks to the appropriate groups. But you should have</span></div>
<div style="position:absolute;left:56.69px;top:139.26px" class="cls_004"><span class="cls_004">noticed during your test that whether the marketing or operations users approved or</span></div>
<div style="position:absolute;left:56.69px;top:151.86px" class="cls_004"><span class="cls_004">rejected the content, the workflow always routed to the Approved node. That's because you</span></div>
<div style="position:absolute;left:56.69px;top:164.46px" class="cls_004"><span class="cls_004">have yet to add any logic to the process definition. The workflow was simply taking the</span></div>
<div style="position:absolute;left:56.69px;top:177.06px" class="cls_004"><span class="cls_004">default transitions.</span></div>
<div style="position:absolute;left:56.69px;top:202.62px" class="cls_004"><span class="cls_004">We didn't configure conditions on any transitions going out from the exclusive gateway, so</span></div>
<div style="position:absolute;left:56.69px;top:215.22px" class="cls_004"><span class="cls_004">the first transition defined in the XML file is used. The logic that makes that decision will</span></div>
<div style="position:absolute;left:56.69px;top:227.82px" class="cls_004"><span class="cls_004">depend on a process variable. When someone approves the Whitepaper, a counter will get</span></div>
<div style="position:absolute;left:56.69px;top:240.42px" class="cls_004"><span class="cls_004">incremented. The condition will check the value. If the counter is equal to 2, both approvals</span></div>
<div style="position:absolute;left:56.69px;top:253.02px" class="cls_004"><span class="cls_004">have been received and the workflow can continue down the </span><span class="cls_022">“</span><span class="cls_004">happy path</span><span class="cls_022">”</span><span class="cls_004">. Otherwise, a</span></div>
<div style="position:absolute;left:56.69px;top:266.45px" class="cls_004"><span class="cls_004">revision is necessary and so the content should be routed back to the initiator.</span></div>
<div style="position:absolute;left:56.69px;top:292.01px" class="cls_004"><span class="cls_004">The other thing that still needs to be resolved is that once an approval is given, the</span></div>
<div style="position:absolute;left:56.69px;top:304.61px" class="cls_004"><span class="cls_004">document needs to be enabled for the Web. In an earlier chapter you wrote an action that</span></div>
<div style="position:absolute;left:56.69px;top:317.21px" class="cls_004"><span class="cls_004">sets the web flag and publication date. Now you can benefit from encapsulating that</span></div>
<div style="position:absolute;left:56.69px;top:329.81px" class="cls_004"><span class="cls_004">operation into an action by reusing it here. The approved node will use the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:342.41px" class="cls_004"><span class="cls_004">JavaScript API to execute the action.</span></div>
<div style="position:absolute;left:56.69px;top:367.97px" class="cls_004"><span class="cls_004">Implementing this logic involves adding expressions and Alfresco JavaScript to the</span></div>
<div style="position:absolute;left:56.69px;top:380.57px" class="cls_004"><span class="cls_004">appropriate events and transitions in the process, and then re-deploying the process</span></div>
<div style="position:absolute;left:56.69px;top:393.17px" class="cls_004"><span class="cls_004">definition for testing. To do this, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:418.73px" class="cls_004"><span class="cls_004">1. Edit the publishWhitepaper.bpmn20.xml file. You're going to use a counter to</span></div>
<div style="position:absolute;left:104.69px;top:431.33px" class="cls_004"><span class="cls_004">keep track of the number of approvals received. You need to be careful to</span></div>
<div style="position:absolute;left:104.69px;top:443.93px" class="cls_004"><span class="cls_004">initialize the counter to 0 because it's possible that a Whitepaper may go through</span></div>
<div style="position:absolute;left:104.69px;top:456.53px" class="cls_004"><span class="cls_004">several review cycles. The Submit node is a convenient place to do the</span></div>
<div style="position:absolute;left:104.69px;top:469.13px" class="cls_004"><span class="cls_004">initialization. Just edit the existing script:</span></div>
<div style="position:absolute;left:117.89px;top:492.34px" class="cls_010"><span class="cls_010">logger.log("Submit whitepaper!");</span></div>
<div style="position:absolute;left:117.89px;top:503.14px" class="cls_010"><span class="cls_010">execution.setVariable("scwf_approveCount", 0);</span></div>
<div style="position:absolute;left:124.19px;top:527.58px" class="cls_004"><span class="cls_004">In this case, we create a variable called scwf_approveCount, but we don't</span></div>
<div style="position:absolute;left:124.19px;top:540.18px" class="cls_004"><span class="cls_004">define it in our content model. It's not required to prefix it in this case, it's just</span></div>
<div style="position:absolute;left:124.19px;top:552.78px" class="cls_004"><span class="cls_004">best practice to prefix all your variables by your custom model prefix.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 367 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:258232px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background383.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Now you need to increment the counter when the user clicks on </span><span class="cls_007">Approve</span><span class="cls_004">. By</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">checking the worklowModel.xml file, if you look for the type</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_013"><span class="cls_013">wf:activitiReviewTask</span><span class="cls_004">, you'll notice the property,</span><span class="cls_013">wf:reviewOutcome</span><span class="cls_004">. This</span></div>
<div style="position:absolute;left:104.69px;top:109.02px" class="cls_004"><span class="cls_004">property contains a constraint that allows only the values, </span><span class="cls_007">Approve</span><span class="cls_004"> and </span><span class="cls_007">Reject</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:121.66px" class="cls_004"><span class="cls_004">It's what drives the displaying of the buttons in Share. We need to create a new</span></div>
<div style="position:absolute;left:104.69px;top:134.26px" class="cls_004"><span class="cls_004">listener on the </span><span class="cls_007">Marketing Review</span><span class="cls_004"> task on </span><span class="cls_007">complete</span><span class="cls_004">. Click on the task, open the</span></div>
<div style="position:absolute;left:104.69px;top:146.89px" class="cls_007"><span class="cls_007">Properties</span><span class="cls_004"> view, select the tab </span><span class="cls_007">Listeners</span><span class="cls_004"> and click on the button </span><span class="cls_007">New</span><span class="cls_004">. This script</span></div>
<div style="position:absolute;left:104.69px;top:159.53px" class="cls_004"><span class="cls_004">will increment the counter if the user clicked on the </span><span class="cls_007">Approve </span><span class="cls_004">button:</span></div>
<div style="position:absolute;left:117.89px;top:182.78px" class="cls_010"><span class="cls_010">if (task.getVariable('wf_reviewOutcome') == 'Approve')</span></div>
<div style="position:absolute;left:117.89px;top:193.58px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:204.38px" class="cls_010"><span class="cls_010">var newApproveCount= scwf_approveCount+ 1;</span></div>
<div style="position:absolute;left:128.69px;top:215.18px" class="cls_010"><span class="cls_010">execution.setVariable("scwf_approveCount", newApproveCount);</span></div>
<div style="position:absolute;left:117.89px;top:225.98px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:236.78px" class="cls_010"><span class="cls_010">if (newApproveCount&gt;= 2)</span></div>
<div style="position:absolute;left:117.89px;top:247.58px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:258.38px" class="cls_010"><span class="cls_010">execution.setVariable("validated", true);</span></div>
<div style="position:absolute;left:117.89px;top:269.18px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:279.98px" class="cls_010"><span class="cls_010">else</span></div>
<div style="position:absolute;left:117.89px;top:290.78px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:301.58px" class="cls_010"><span class="cls_010">execution.setVariable("validated", false);</span></div>
<div style="position:absolute;left:117.89px;top:312.38px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:124.19px;top:454.53px" class="cls_004"><span class="cls_004">In the previous code, we used the variable </span><span class="cls_013">validated</span><span class="cls_004"> without prefixing it</span></div>
<div style="position:absolute;left:124.19px;top:467.81px" class="cls_004"><span class="cls_004">with </span><span class="cls_013">scwf</span><span class="cls_004">. It's something arguable and we could have prefixed it to keep the</span></div>
<div style="position:absolute;left:124.19px;top:481.09px" class="cls_004"><span class="cls_004">same convention for all workflow variables that we define.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 368 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:258908px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background384.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Do the same for the </span><span class="cls_007">Operation Review</span><span class="cls_004"> node.</span></div>
<div style="position:absolute;left:91.32px;top:85.30px" class="cls_004"><span class="cls_004">4. With the counter logic in place, click on the transition between the exclusive</span></div>
<div style="position:absolute;left:104.69px;top:97.90px" class="cls_004"><span class="cls_004">gateway and the </span><span class="cls_007">Approved</span><span class="cls_004"> task. Then, open the </span><span class="cls_013">Properties</span><span class="cls_004"> view, open the</span></div>
<div style="position:absolute;left:104.69px;top:111.18px" class="cls_013"><span class="cls_013">Main config</span><span class="cls_004"> tab, and the following expression to the </span><span class="cls_013">Condition</span><span class="cls_004"> field:</span></div>
<div style="position:absolute;left:117.89px;top:135.07px" class="cls_010"><span class="cls_010">${validated}</span></div>
<div style="position:absolute;left:124.19px;top:159.51px" class="cls_004"><span class="cls_004">Populate the same field with the following value on the transition between</span></div>
<div style="position:absolute;left:124.19px;top:172.11px" class="cls_004"><span class="cls_004">the exclusive gateway and the </span><span class="cls_007">Revise </span><span class="cls_004">task:</span></div>
<div style="position:absolute;left:117.89px;top:197.03px" class="cls_010"><span class="cls_010">${!validated}</span></div>
<div style="position:absolute;left:91.32px;top:217.64px" class="cls_004"><span class="cls_004">5. When a Whitepaper is approved, it should have the sc:webable aspect added to it</span></div>
<div style="position:absolute;left:104.69px;top:230.24px" class="cls_004"><span class="cls_004">and the isActive and published properties set. The set-web-flag action you wrote</span></div>
<div style="position:absolute;left:104.69px;top:242.84px" class="cls_004"><span class="cls_004">in an earlier chapter does just that. So all you have to do is tell the process to</span></div>
<div style="position:absolute;left:104.69px;top:255.44px" class="cls_004"><span class="cls_004">execute it for each piece of content in the workflow package using Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:268.04px" class="cls_004"><span class="cls_004">JavaScript. We are going to create a new listener on the </span><span class="cls_007">Approved</span><span class="cls_004"> task that will</span></div>
<div style="position:absolute;left:104.69px;top:280.67px" class="cls_004"><span class="cls_004">update all attached document. To achieve that, we'll execute the following script</span></div>
<div style="position:absolute;left:104.69px;top:293.27px" class="cls_004"><span class="cls_004">on the complete event:</span></div>
<div style="position:absolute;left:117.89px;top:316.48px" class="cls_010"><span class="cls_010">var setWebFlagAction = actions.create("set-web-flag");</span></div>
<div style="position:absolute;left:117.89px;top:327.28px" class="cls_010"><span class="cls_010">setWebFlagAction.parameters["active"] = true;</span></div>
<div style="position:absolute;left:117.89px;top:338.08px" class="cls_010"><span class="cls_010">for (var i= 0; i&lt;bpm_package.children.length; i++)</span></div>
<div style="position:absolute;left:117.89px;top:348.88px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:359.68px" class="cls_010"><span class="cls_010">logger.log("Approving whitepaper:"</span></div>
<div style="position:absolute;left:139.49px;top:370.48px" class="cls_010"><span class="cls_010">+ bpm_package.children[i].nodeRef);</span></div>
<div style="position:absolute;left:139.49px;top:392.08px" class="cls_010"><span class="cls_010">setWebFlagAction.execute(bpm_package.children[i]);</span></div>
<div style="position:absolute;left:117.89px;top:402.88px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:423.49px" class="cls_004"><span class="cls_004">6. Save the </span><span class="cls_013">publishWhitepaper.bpmn20.xml</span><span class="cls_004"> file. Use the Activiti Explorer to</span></div>
<div style="position:absolute;left:104.69px;top:436.77px" class="cls_004"><span class="cls_004">deploy the updated process, and then test it out.</span></div>
<div style="position:absolute;left:56.69px;top:464.49px" class="cls_004"><span class="cls_004">To test out the updated process, start a workflow on a Whitepaper that does not have its</span></div>
<div style="position:absolute;left:56.69px;top:477.09px" class="cls_013"><span class="cls_013">isActive</span><span class="cls_004"> flag set to </span><span class="cls_013">true</span><span class="cls_004">. In your test, if both approvers approve the content, the</span></div>
<div style="position:absolute;left:56.69px;top:490.37px" class="cls_004"><span class="cls_004">workflow should complete successfully and the flag should be set to true. Otherwise, the</span></div>
<div style="position:absolute;left:56.69px;top:502.97px" class="cls_004"><span class="cls_004">initiator will get a chance to make revisions or abort the workflow.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 369 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:259584px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background385.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Getting access to the content in the workflow</span></div>
<div style="position:absolute;left:56.69px;top:105.06px" class="cls_004"><span class="cls_004">If you open the out-of-the-box </span><span class="cls_013">workflowModel.xml</span><span class="cls_004">, you should find the</span></div>
<div style="position:absolute;left:56.69px;top:118.34px" class="cls_013"><span class="cls_013">wf:submitReviewTask</span><span class="cls_004"> type has an ancestor type that adds an association called</span></div>
<div style="position:absolute;left:56.69px;top:131.62px" class="cls_013"><span class="cls_013">bpm:package</span><span class="cls_004">. That's what allows the JavaScript in the </span><span class="cls_013">Approved</span><span class="cls_004"> node to iterate over the</span></div>
<div style="position:absolute;left:56.69px;top:144.90px" class="cls_004"><span class="cls_004">content that is being routed through the workflow. Always remember that unless you've</span></div>
<div style="position:absolute;left:56.69px;top:157.50px" class="cls_004"><span class="cls_004">done something to prevent it, the workflow initiator can add multiple files to a workflow.</span></div>
<div style="position:absolute;left:56.69px;top:195.28px" class="cls_014"><span class="cls_014">Using multi-instances</span></div>
<div style="position:absolute;left:56.69px;top:230.58px" class="cls_004"><span class="cls_004">In the SomeCo example, you created two explicit review task nodes in your process: The</span></div>
<div style="position:absolute;left:56.69px;top:243.18px" class="cls_013"><span class="cls_013">MarketingReview</span><span class="cls_004"> node's task was assigned to the </span><span class="cls_013">Marketing</span><span class="cls_004"> group and the</span></div>
<div style="position:absolute;left:56.69px;top:256.46px" class="cls_013"><span class="cls_013">OperationsReview</span><span class="cls_004"> node's task was assigned to the </span><span class="cls_013">Operation</span><span class="cls_004"> group.</span></div>
<div style="position:absolute;left:56.69px;top:282.70px" class="cls_004"><span class="cls_004">But what if, instead, the workflow initiator was able to pick as many actors as thought</span></div>
<div style="position:absolute;left:56.69px;top:295.30px" class="cls_004"><span class="cls_004">necessary? There are two out-of-the box processes that show an example of this:</span></div>
<div style="position:absolute;left:56.69px;top:307.90px" class="cls_013"><span class="cls_013">parallel-review-group.bpmn20.xml</span><span class="cls_004"> and </span><span class="cls_013">parallel-review.bpmn20.xml</span><span class="cls_004">(the former</span></div>
<div style="position:absolute;left:56.69px;top:321.18px" class="cls_004"><span class="cls_004">is for groups, while the latter is for individual users).</span></div>
<div style="position:absolute;left:56.69px;top:346.75px" class="cls_004"><span class="cls_004">These processes use an Activiti concept called multi-instance. A multi-instance activ</span><span class="cls_012">ity</span><span class="cls_004"> is a</span></div>
<div style="position:absolute;left:56.69px;top:359.35px" class="cls_004"><span class="cls_004">way of defining repetition for a certain step in a business process. In programming</span></div>
<div style="position:absolute;left:56.69px;top:371.95px" class="cls_004"><span class="cls_004">concepts, a multi-instance matches the </span><span class="cls_007">for each</span><span class="cls_004"> construct. A counter is then used to track</span></div>
<div style="position:absolute;left:56.69px;top:384.58px" class="cls_004"><span class="cls_004">how many approvals are obtained, similar to the counter used in the SomeCo example.</span></div>
<div style="position:absolute;left:56.69px;top:410.14px" class="cls_004"><span class="cls_004">Looking at </span><span class="cls_013">parallel-review-group.bpmn20.xml</span><span class="cls_004">, you can see that the </span><span class="cls_013">foreach</span><span class="cls_004"> is</span></div>
<div style="position:absolute;left:56.69px;top:423.42px" class="cls_004"><span class="cls_004">iterating over each person in the selected group. The person will be in a process variable</span></div>
<div style="position:absolute;left:56.69px;top:436.02px" class="cls_004"><span class="cls_004">called </span><span class="cls_013">reviewAssignee</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:461.58px" class="cls_010"><span class="cls_010">&lt;multiInstanceLoopCharacteristicsisSequential="false"&gt;</span></div>
<div style="position:absolute;left:85.49px;top:472.38px" class="cls_010"><span class="cls_010">&lt;loopDataInputRef&gt;wf_groupMembers&lt;/loopDataInputRef&gt;</span></div>
<div style="position:absolute;left:85.49px;top:483.18px" class="cls_010"><span class="cls_010">&lt;inputDataItem name="reviewAssignee" /&gt;</span></div>
<div style="position:absolute;left:85.49px;top:504.78px" class="cls_010"><span class="cls_010">&lt;completionCondition&gt;</span></div>
<div style="position:absolute;left:96.29px;top:515.58px" class="cls_010"><span class="cls_010">${wf_actualPercent&gt;= wf_requiredApprovePercent</span></div>
<div style="position:absolute;left:117.89px;top:526.38px" class="cls_010"><span class="cls_010">|| wf_requiredApprovePercent&gt; (100 - wf_actualRejectPercent)}</span></div>
<div style="position:absolute;left:85.49px;top:537.18px" class="cls_010"><span class="cls_010">&lt;/completionCondition&gt;</span></div>
<div style="position:absolute;left:80.09px;top:547.98px" class="cls_010"><span class="cls_010">&lt;/multiInstanceLoopCharacteristics&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 370 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:260260px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background386.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">reviewTask</span><span class="cls_004"> user task makes an assignment using the value of the reviewer process</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">variable. When this process is actually running, there will be one task for each person in the</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">group.</span></div>
<div style="position:absolute;left:74.69px;top:121.26px" class="cls_010"><span class="cls_010">&lt;humanPerformer&gt;</span></div>
<div style="position:absolute;left:85.49px;top:132.06px" class="cls_010"><span class="cls_010">&lt;resourceAssignmentExpression&gt;</span></div>
<div style="position:absolute;left:96.29px;top:142.86px" class="cls_010"><span class="cls_010">&lt;formalExpression&gt;${reviewAssignee}&lt;/formalExpression&gt;</span></div>
<div style="position:absolute;left:85.49px;top:153.66px" class="cls_010"><span class="cls_010">&lt;/resourceAssignmentExpression&gt;</span></div>
<div style="position:absolute;left:74.69px;top:164.46px" class="cls_010"><span class="cls_010">&lt;/humanPerformer&gt;</span></div>
<div style="position:absolute;left:56.69px;top:188.90px" class="cls_004"><span class="cls_004">If the approve transition is taken, the counter will be incremented as well as the approval</span></div>
<div style="position:absolute;left:56.69px;top:201.50px" class="cls_004"><span class="cls_004">percentage:</span></div>
<div style="position:absolute;left:74.69px;top:226.38px" class="cls_010"><span class="cls_010">&lt;activiti:taskListener event="complete"</span></div>
<div style="position:absolute;left:74.69px;top:237.18px" class="cls_010"><span class="cls_010">class="org.alfresco.repo.workflow.activiti</span></div>
<div style="position:absolute;left:85.49px;top:247.98px" class="cls_010"><span class="cls_010">.tasklistener.ScriptTaskListener"&gt;</span></div>
<div style="position:absolute;left:85.49px;top:269.58px" class="cls_010"><span class="cls_010">&lt;activiti:field name="script"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:280.38px" class="cls_010"><span class="cls_010">&lt;activiti:string&gt;</span></div>
<div style="position:absolute;left:107.09px;top:291.18px" class="cls_010"><span class="cls_010">if(task.getVariableLocal('wf_reviewOutcome') == 'Approve')</span></div>
<div style="position:absolute;left:117.89px;top:301.98px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:312.78px" class="cls_010"><span class="cls_010">var newApprovedCount=wf_approveCount + 1;</span></div>
<div style="position:absolute;left:128.69px;top:323.58px" class="cls_010"><span class="cls_010">var newApprovedPercentage</span></div>
<div style="position:absolute;left:139.49px;top:334.38px" class="cls_010"><span class="cls_010">=(newApprovedCount/wf_reviewerCount)*100;</span></div>
<div style="position:absolute;left:128.69px;top:345.18px" class="cls_010"><span class="cls_010">execution.setVariable('wf_approveCount', newApprovedCount);</span></div>
<div style="position:absolute;left:128.69px;top:355.98px" class="cls_010"><span class="cls_010">execution.setVariable('wf_actualPercent', newApprovedPercentage);</span></div>
<div style="position:absolute;left:117.89px;top:366.78px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:107.09px;top:377.58px" class="cls_010"><span class="cls_010">else</span></div>
<div style="position:absolute;left:117.89px;top:388.38px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:399.18px" class="cls_010"><span class="cls_010">var newRejectCount=wf_rejectCount + 1;</span></div>
<div style="position:absolute;left:128.69px;top:409.98px" class="cls_010"><span class="cls_010">var newRejectPercentage=(newRejectCount / wf_reviewerCount) *</span></div>
<div style="position:absolute;left:74.69px;top:420.78px" class="cls_010"><span class="cls_010">100;</span></div>
<div style="position:absolute;left:128.69px;top:431.58px" class="cls_010"><span class="cls_010">execution.setVariable('wf_rejectCount', newRejectCount);</span></div>
<div style="position:absolute;left:128.69px;top:442.38px" class="cls_010"><span class="cls_010">execution.setVariable('wf_actualRejectPercent',</span></div>
<div style="position:absolute;left:139.49px;top:453.18px" class="cls_010"><span class="cls_010">newRejectPercentage);</span></div>
<div style="position:absolute;left:117.89px;top:463.98px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:107.09px;top:474.78px" class="cls_010"><span class="cls_010">&lt;/activiti:string&gt;</span></div>
<div style="position:absolute;left:96.29px;top:485.58px" class="cls_010"><span class="cls_010">&lt;/activiti:field&gt;</span></div>
<div style="position:absolute;left:85.49px;top:496.38px" class="cls_010"><span class="cls_010">&lt;/activiti:taskListener&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 371 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:260936px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background387.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Then, the transition between the exclusive gateway and the </span><span class="cls_007">Approved</span><span class="cls_004"> task will be taken</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_004"><span class="cls_004">only if the approval percentage is higher than the required approval percentage:</span></div>
<div style="position:absolute;left:74.69px;top:108.02px" class="cls_010"><span class="cls_010">&lt;sequenceFlow id='flow3' sourceRef='reviewDecision' targetRef='approved'&gt;</span></div>
<div style="position:absolute;left:90.89px;top:118.82px" class="cls_010"><span class="cls_010">&lt;conditionExpressionxsi:type="tFormalExpression"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:129.62px" class="cls_010"><span class="cls_010">${wf_actualPercent&gt;= wf_requiredApprovePercent}</span></div>
<div style="position:absolute;left:90.89px;top:140.42px" class="cls_010"><span class="cls_010">&lt;/conditionExpression&gt;</span></div>
<div style="position:absolute;left:74.69px;top:151.22px" class="cls_010"><span class="cls_010">&lt;/sequenceFlow&gt;</span></div>
<div style="position:absolute;left:56.69px;top:175.66px" class="cls_004"><span class="cls_004">The use of multi-instance activity is not limited to dealing with assignments. It is a generic</span></div>
<div style="position:absolute;left:56.69px;top:188.26px" class="cls_004"><span class="cls_004">construct that could be used any time you need to spawn parallel flows based on a list.</span></div>
<div style="position:absolute;left:56.69px;top:225.93px" class="cls_008"><span class="cls_008">Using the Activiti API</span></div>
<div style="position:absolute;left:56.69px;top:263.74px" class="cls_004"><span class="cls_004">In the previous example, the logic was easily handled by either expressions or JavaScript</span></div>
<div style="position:absolute;left:56.69px;top:276.34px" class="cls_004"><span class="cls_004">within the business process. However, there may be cases when Activiti actions are better</span></div>
<div style="position:absolute;left:56.69px;top:288.94px" class="cls_004"><span class="cls_004">implemented in Java. For example, there might be an API readily available in Java that isn't</span></div>
<div style="position:absolute;left:56.69px;top:301.54px" class="cls_004"><span class="cls_004">available in JavaScript. Or suppose you want to manipulate workflows from outside a</span></div>
<div style="position:absolute;left:56.69px;top:314.14px" class="cls_004"><span class="cls_004">business process. Maybe you want to complete tasks, add items to a workflow, or start a</span></div>
<div style="position:absolute;left:56.69px;top:326.74px" class="cls_004"><span class="cls_004">workflow from an action, a web script, or a custom dialog. You can use the Activiti Java</span></div>
<div style="position:absolute;left:56.69px;top:339.34px" class="cls_004"><span class="cls_004">services or the Alfresco Workflow Service. In our case, we'll use the first option.</span></div>
<div style="position:absolute;left:56.69px;top:364.90px" class="cls_004"><span class="cls_004">The next example gives you a chance to try out both of these scenarios. In one, you're going</span></div>
<div style="position:absolute;left:56.69px;top:377.50px" class="cls_004"><span class="cls_004">to write a custom Activti Task Listener. In the other, you are going to use the</span></div>
<div style="position:absolute;left:56.69px;top:390.10px" class="cls_004"><span class="cls_004">ActivitiRuntimeService to signal a process.</span></div>
<div style="position:absolute;left:56.69px;top:415.66px" class="cls_004"><span class="cls_004">SomeCo would like to update the Whitepaper submission workflow to optionally include</span></div>
<div style="position:absolute;left:56.69px;top:428.26px" class="cls_004"><span class="cls_004">review by an external third party. The third party might be a SomeCo partner, for example,</span></div>
<div style="position:absolute;left:56.69px;top:440.86px" class="cls_004"><span class="cls_004">that does not have login credentials for Alfresco, but still</span></div>
<div style="position:absolute;left:56.69px;top:453.46px" class="cls_004"><span class="cls_004">needs to be able to approve or reject content. You will give external third parties</span></div>
<div style="position:absolute;left:56.69px;top:466.06px" class="cls_004"><span class="cls_004">the ability to approve or reject a task via a URL by writing a web script that uses Alfresco's</span></div>
<div style="position:absolute;left:56.69px;top:478.66px" class="cls_004"><span class="cls_004">Workflow Service to signal the node to take the appropriate approve or reject transition.</span></div>
<div style="position:absolute;left:56.69px;top:504.22px" class="cls_004"><span class="cls_004">The third party needs to know they need to review content. Alfresco has a mail action</span></div>
<div style="position:absolute;left:56.69px;top:516.82px" class="cls_004"><span class="cls_004">available out-of-the box that could be called from JavaScript. But Java is better suited for</span></div>
<div style="position:absolute;left:56.69px;top:529.42px" class="cls_004"><span class="cls_004">grabbing everything needed for the body of the e-mail. So you'll write a custom</span></div>
<div style="position:absolute;left:56.69px;top:542.02px" class="cls_004"><span class="cls_004">ActivitiTaskListener class, and then invoke the out-of-the box mail action from there.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 372 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:261612px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background388.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - implementing third-party review</span></div>
<div style="position:absolute;left:56.69px;top:105.06px" class="cls_004"><span class="cls_004">Someday there will be an out-of-the box mechanism for exposing business processes to</span></div>
<div style="position:absolute;left:56.69px;top:117.66px" class="cls_004"><span class="cls_004">external parties. Until then, you can roll your own using the out-of-the box mail action and</span></div>
<div style="position:absolute;left:56.69px;top:130.26px" class="cls_004"><span class="cls_004">web scripts. There are two pieces required to make this work. First, you need a web script</span></div>
<div style="position:absolute;left:56.69px;top:142.86px" class="cls_004"><span class="cls_004">that signals the node to take either the approve or reject transition. Second, when the token</span></div>
<div style="position:absolute;left:56.69px;top:155.46px" class="cls_004"><span class="cls_004">arrives in the </span><span class="cls_007">ThirdPartyReview</span><span class="cls_004"> node, an e-mail should go to the third party with </span><span class="cls_007">approve</span></div>
<div style="position:absolute;left:56.69px;top:168.10px" class="cls_004"><span class="cls_004">and </span><span class="cls_007">reject</span><span class="cls_004"> links. The recipient will open the e-mail and click on either the </span><span class="cls_007">approve</span><span class="cls_004"> link or</span></div>
<div style="position:absolute;left:56.69px;top:180.74px" class="cls_004"><span class="cls_004">the </span><span class="cls_007">reject</span><span class="cls_004"> link. Both links are calls to the</span></div>
<div style="position:absolute;left:56.69px;top:193.37px" class="cls_004"><span class="cls_004">same web script-the path that needs to be taken is passed as an argument to the web script.</span></div>
<div style="position:absolute;left:56.69px;top:218.93px" class="cls_004"><span class="cls_004">Implementing this is going to involve:</span></div>
<div style="position:absolute;left:91.32px;top:244.49px" class="cls_004"><span class="cls_004">1. Updating the process definition to include two new exclusive gateways to define</span></div>
<div style="position:absolute;left:104.69px;top:257.09px" class="cls_004"><span class="cls_004">if we need a third-party review, and if this review is accepted or rejected. We'll</span></div>
<div style="position:absolute;left:104.69px;top:269.69px" class="cls_004"><span class="cls_004">need as well a new task for this external review that we'll design with a </span><span class="cls_007">Receive</span></div>
<div style="position:absolute;left:104.69px;top:282.33px" class="cls_007"><span class="cls_007">Task</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:297.13px" class="cls_004"><span class="cls_004">2. Updating the workflow model to include a new aspect representing </span><span class="cls_022">“</span><span class="cls_004">third-party</span></div>
<div style="position:absolute;left:104.69px;top:310.56px" class="cls_004"><span class="cls_004">reviewable</span><span class="cls_022">”</span><span class="cls_004"> metadata, and a new type for the start task. This also requires</span></div>
<div style="position:absolute;left:104.69px;top:323.99px" class="cls_004"><span class="cls_004">corresponding updates to the </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> file and the</span></div>
<div style="position:absolute;left:104.69px;top:337.27px" class="cls_013"><span class="cls_013">scWorkflow.properties</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:352.71px" class="cls_004"><span class="cls_004">3. Writing a web script that figures out the appropriate workflow and then uses the</span></div>
<div style="position:absolute;left:104.69px;top:365.31px" class="cls_004"><span class="cls_004">ActivitiRuntimeService from a Java-based controller to take the appropriate</span></div>
<div style="position:absolute;left:104.69px;top:377.91px" class="cls_004"><span class="cls_004">transition. This includes configuring the controller as a Spring bean.</span></div>
<div style="position:absolute;left:91.32px;top:392.67px" class="cls_004"><span class="cls_004">4. Writing an ActivitiJavaListener class to compose the email body, and then send it</span></div>
<div style="position:absolute;left:104.69px;top:405.27px" class="cls_004"><span class="cls_004">to the third-party recipient using the out-of-the box e-mail action via Alfresco's</span></div>
<div style="position:absolute;left:104.69px;top:417.87px" class="cls_004"><span class="cls_004">Action Service.</span></div>
<div style="position:absolute;left:56.69px;top:445.59px" class="cls_004"><span class="cls_004">At the end of this example, SomeCo will be able to involve third parties who know nothing</span></div>
<div style="position:absolute;left:56.69px;top:458.19px" class="cls_004"><span class="cls_004">about Alfresco in an Alfresco-managed business process using everyone's favorite</span></div>
<div style="position:absolute;left:56.69px;top:470.79px" class="cls_004"><span class="cls_004">knowledge management and collaboration application: e-mail.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 373 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:262288px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background389.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To put this in place, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:96.06px" class="cls_004"><span class="cls_004">1. First, update the </span><span class="cls_013">publishWhitepaper.bpmn20.xml</span><span class="cls_004"> process definition to</span></div>
<div style="position:absolute;left:104.69px;top:109.34px" class="cls_004"><span class="cls_004">include two new exclusive gateways and a new </span><span class="cls_013">ReceiveTasknode.</span><span class="cls_004"> A receive</span></div>
<div style="position:absolute;left:104.69px;top:122.62px" class="cls_004"><span class="cls_004">task is a simple task that waits for the arrival of a certain message. The third-</span></div>
<div style="position:absolute;left:104.69px;top:135.22px" class="cls_004"><span class="cls_004">party review is optional. The reason we design it like that is that you don't want</span></div>
<div style="position:absolute;left:104.69px;top:147.82px" class="cls_004"><span class="cls_004">to bother the third party with a review task if the internal reviewers aren't going</span></div>
<div style="position:absolute;left:104.69px;top:160.42px" class="cls_004"><span class="cls_004">to approve the content. Organize the two new gateways and the new receive task</span></div>
<div style="position:absolute;left:104.69px;top:173.02px" class="cls_004"><span class="cls_004">following this schema:</span></div>
<div style="position:absolute;left:91.32px;top:336.45px" class="cls_004"><span class="cls_004">2. Save the process definition for now. You'll return to add logic to the new node in</span></div>
<div style="position:absolute;left:104.69px;top:349.05px" class="cls_004"><span class="cls_004">a minute.</span></div>
<div style="position:absolute;left:91.32px;top:363.81px" class="cls_004"><span class="cls_004">3. Edit the</span></div>
<div style="position:absolute;left:104.69px;top:376.41px" class="cls_004"><span class="cls_004">src|</span><span class="cls_007">main|amp|</span><span class="cls_004">config|alfresco|module|repo|model|scWorkflowModel.xml file.</span></div>
<div style="position:absolute;left:104.69px;top:389.05px" class="cls_004"><span class="cls_004">Add the following aspect to track the e-mail address of the third party (be careful,</span></div>
<div style="position:absolute;left:104.69px;top:401.65px" class="cls_004"><span class="cls_004">the tag </span><span class="cls_013">aspects</span><span class="cls_004"> needs to be defined after the tag types in the content model,</span></div>
<div style="position:absolute;left:104.69px;top:414.93px" class="cls_004"><span class="cls_004">otherwise your model will be invalid):</span></div>
<div style="position:absolute;left:117.89px;top:438.14px" class="cls_010"><span class="cls_010">&lt;aspects&gt;</span></div>
<div style="position:absolute;left:128.69px;top:448.94px" class="cls_010"><span class="cls_010">&lt;aspect name="scwf:thirdPartyReviewable"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:459.74px" class="cls_010"><span class="cls_010">&lt;title&gt;Someco Third Party Reviewable&lt;/title&gt;</span></div>
<div style="position:absolute;left:139.49px;top:470.54px" class="cls_010"><span class="cls_010">&lt;properties&gt;</span></div>
<div style="position:absolute;left:150.29px;top:481.34px" class="cls_010"><span class="cls_010">&lt;property name="scwf:reviewerEmail"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:492.14px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:161.09px;top:502.94px" class="cls_010"><span class="cls_010">&lt;mandatory&gt;false&lt;/mandatory&gt;</span></div>
<div style="position:absolute;left:161.09px;top:513.74px" class="cls_010"><span class="cls_010">&lt;multiple&gt;false&lt;/multiple&gt;</span></div>
<div style="position:absolute;left:150.29px;top:524.54px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:139.49px;top:535.34px" class="cls_010"><span class="cls_010">&lt;/properties&gt;</span></div>
<div style="position:absolute;left:128.69px;top:546.14px" class="cls_010"><span class="cls_010">&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:117.89px;top:556.94px" class="cls_010"><span class="cls_010">&lt;/aspects&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 374 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:262964px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background390.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. In the same model, create a new type for the start event that will re-use the aspect</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">defined just previously:</span></div>
<div style="position:absolute;left:117.89px;top:106.31px" class="cls_010"><span class="cls_010">&lt;type name="scwf:submitReviewTask"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:117.11px" class="cls_010"><span class="cls_010">&lt;parent&gt;wf:submitReviewTask&lt;/parent&gt;</span></div>
<div style="position:absolute;left:139.49px;top:127.91px" class="cls_010"><span class="cls_010">&lt;mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:150.29px;top:138.71px" class="cls_010"><span class="cls_010">&lt;aspect&gt;scwf:thirdPartyReviewable&lt;/aspect&gt;</span></div>
<div style="position:absolute;left:139.49px;top:149.51px" class="cls_010"><span class="cls_010">&lt;/mandatory-aspects&gt;</span></div>
<div style="position:absolute;left:117.89px;top:160.31px" class="cls_010"><span class="cls_010">&lt;/type&gt;</span></div>
<div style="position:absolute;left:91.32px;top:180.92px" class="cls_004"><span class="cls_004">5. Now, you need to update your Activiti workflow to match the start event to this</span></div>
<div style="position:absolute;left:104.69px;top:193.52px" class="cls_004"><span class="cls_004">new type that we just created. Open the workflow file</span></div>
<div style="position:absolute;left:104.69px;top:206.12px" class="cls_013"><span class="cls_013">publishWhitepaper.bpmn20.xml</span><span class="cls_004">, click on the start event, open the </span><span class="cls_007">Properties</span></div>
<div style="position:absolute;left:104.69px;top:219.40px" class="cls_004"><span class="cls_004">view, open the </span><span class="cls_007">Main config</span><span class="cls_004"> tab and specify the type name for the form key:</span></div>
<div style="position:absolute;left:91.32px;top:340.12px" class="cls_004"><span class="cls_004">6. Save the </span><span class="cls_013">scWorkflowModel.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:355.56px" class="cls_004"><span class="cls_004">7. Edit the</span></div>
<div style="position:absolute;left:104.69px;top:367.38px" class="cls_013"><span class="cls_013">repo|src|main|config|alfresco|module|repo|messages|scWorkflow.p</span></div>
<div style="position:absolute;left:104.69px;top:380.16px" class="cls_013"><span class="cls_013">roperties</span><span class="cls_004"> file. Add the following model-related strings:</span></div>
<div style="position:absolute;left:117.89px;top:404.05px" class="cls_010"><span class="cls_010">scwf_workflowmodel.type.scwf_submitReviewTask.title</span></div>
<div style="position:absolute;left:117.89px;top:414.85px" class="cls_010"><span class="cls_010">=Submit Whitepaper Review Task</span></div>
<div style="position:absolute;left:117.89px;top:436.45px" class="cls_010"><span class="cls_010">scwf_workflowmodel.type.scwf_submitReviewTask.description</span></div>
<div style="position:absolute;left:117.89px;top:447.25px" class="cls_010"><span class="cls_010">=Submit Whitepaper Review Task</span></div>
<div style="position:absolute;left:117.89px;top:468.85px" class="cls_010"><span class="cls_010">scwf_workflowmodel.property.scwf_reviewerEmail.title</span></div>
<div style="position:absolute;left:117.89px;top:479.65px" class="cls_010"><span class="cls_010">=Reviewer email</span></div>
<div style="position:absolute;left:117.89px;top:501.25px" class="cls_010"><span class="cls_010">scwf_workflowmodel.property.scwf_reviewerEmail.description</span></div>
<div style="position:absolute;left:117.89px;top:512.05px" class="cls_010"><span class="cls_010">=Third-party reviewer email address</span></div>
<div style="position:absolute;left:91.32px;top:532.66px" class="cls_004"><span class="cls_004">8. Save the </span><span class="cls_013">scWorkflow.properties</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 375 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:263640px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background391.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9.</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Edit </span><span class="cls_013">share|src|main|resources|META-INF|share-config-custom.xml</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">and change the </span><span class="cls_013">config</span><span class="cls_004"> tag with the property </span><span class="cls_007">condition</span><span class="cls_004"> equals to</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_013"><span class="cls_013">activiti$publishWhitepaper.</span><span class="cls_004"> In this case, we just add the displaying of the</span></div>
<div style="position:absolute;left:104.69px;top:110.34px" class="cls_004"><span class="cls_004">field </span><span class="cls_013">scwf:reviewerEmail</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:134.23px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare"</span></div>
<div style="position:absolute;left:123.29px;top:145.03px" class="cls_010"><span class="cls_010">condition="activiti$publishWhitepaper"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:155.83px" class="cls_010"><span class="cls_010">&lt;forms&gt;</span></div>
<div style="position:absolute;left:128.69px;top:166.63px" class="cls_010"><span class="cls_010">&lt;form&gt;</span></div>
<div style="position:absolute;left:139.49px;top:177.43px" class="cls_010"><span class="cls_010">&lt;field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:188.23px" class="cls_010"><span class="cls_010">&lt;show id="bpm:workflowDescription" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:199.03px" class="cls_010"><span class="cls_010">&lt;show id="scwf:reviewerEmail" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:209.83px" class="cls_010"><span class="cls_010">&lt;show id="bpm:assignee" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:220.63px" class="cls_010"><span class="cls_010">&lt;show id="packageItems" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:231.43px" class="cls_010"><span class="cls_010">&lt;show id="transitions" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:242.23px" class="cls_010"><span class="cls_010">&lt;/field-visibility&gt;</span></div>
<div style="position:absolute;left:150.29px;top:253.03px" class="cls_010"><span class="cls_010">&lt;appearance&gt;</span></div>
<div style="position:absolute;left:161.09px;top:263.83px" class="cls_010"><span class="cls_010">&lt;set id="" appearance="title"</span></div>
<div style="position:absolute;left:171.89px;top:274.63px" class="cls_010"><span class="cls_010">label-id="workflow.set.general" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:285.43px" class="cls_010"><span class="cls_010">&lt;set id="items" appearance="title"</span></div>
<div style="position:absolute;left:171.89px;top:296.23px" class="cls_010"><span class="cls_010">label-id="workflow.set.items" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:307.03px" class="cls_010"><span class="cls_010">&lt;set id="assignee" appearance="title"</span></div>
<div style="position:absolute;left:171.89px;top:317.83px" class="cls_010"><span class="cls_010">label-id="workflow.set.assignee" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:328.63px" class="cls_010"><span class="cls_010">&lt;set id="progress" appearance="title"</span></div>
<div style="position:absolute;left:171.89px;top:339.43px" class="cls_010"><span class="cls_010">label-id="workflow.set.task.progress" /&gt;</span></div>
<div style="position:absolute;left:161.09px;top:361.03px" class="cls_010"><span class="cls_010">&lt;field id="bpm:workflowDescription"</span></div>
<div style="position:absolute;left:171.89px;top:371.83px" class="cls_010"><span class="cls_010">label-id="workflow.field.message"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:393.43px" class="cls_010"><span class="cls_010">&lt;control template="/org/alfresco/components</span></div>
<div style="position:absolute;left:171.89px;top:404.23px" class="cls_010"><span class="cls_010">/form/controls/textarea.ftl"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:425.83px" class="cls_010"><span class="cls_010">&lt;control-param name="style"&gt;width: 95%&lt;/control-param&gt;</span></div>
<div style="position:absolute;left:161.09px;top:436.63px" class="cls_010"><span class="cls_010">&lt;/control&gt;</span></div>
<div style="position:absolute;left:150.29px;top:447.43px" class="cls_010"><span class="cls_010">&lt;/field&gt;</span></div>
<div style="position:absolute;left:150.29px;top:458.23px" class="cls_010"><span class="cls_010">&lt;field id="bpm:assignee"</span></div>
<div style="position:absolute;left:161.09px;top:469.03px" class="cls_010"><span class="cls_010">label-id="workflow.field.assign_to" set="assignee" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:490.63px" class="cls_010"><span class="cls_010">&lt;field id="scwf:reviewerEmail" set="assignee" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:501.43px" class="cls_010"><span class="cls_010">&lt;field id="packageItems" set="items" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:512.23px" class="cls_010"><span class="cls_010">&lt;/appearance&gt;</span></div>
<div style="position:absolute;left:128.69px;top:523.03px" class="cls_010"><span class="cls_010">&lt;/form&gt;</span></div>
<div style="position:absolute;left:117.89px;top:533.83px" class="cls_010"><span class="cls_010">&lt;/forms&gt;</span></div>
<div style="position:absolute;left:117.89px;top:544.63px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:86.07px;top:565.24px" class="cls_004"><span class="cls_004">10.</span></div>
<div style="position:absolute;left:104.69px;top:565.24px" class="cls_004"><span class="cls_004">Save the </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 376 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:264316px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background392.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. Now implement the web script. Create a descriptor in</span></div>
<div style="position:absolute;left:104.69px;top:82.32px" class="cls_013"><span class="cls_013">repo|src|main|amp|config|alfresco|</span></div>
<div style="position:absolute;left:104.69px;top:95.10px" class="cls_013"><span class="cls_013">extension|templates|webscripts|com|someco|bpm</span><span class="cls_004"> called</span></div>
<div style="position:absolute;left:104.69px;top:108.38px" class="cls_013"><span class="cls_013">review.get.desc.xml</span><span class="cls_004"> with the following content:</span></div>
<div style="position:absolute;left:117.89px;top:132.27px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:123.29px;top:143.07px" class="cls_010"><span class="cls_010">&lt;shortname&gt;BPM Review&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:123.29px;top:153.87px" class="cls_010"><span class="cls_010">&lt;description&gt;Review and approve a BPM task&lt;/description&gt;</span></div>
<div style="position:absolute;left:123.29px;top:164.67px" class="cls_010"><span class="cls_010">&lt;url&gt;</span></div>
<div style="position:absolute;left:139.49px;top:175.47px" class="cls_010"><span class="cls_010">/someco/bpm/review?id={idArgument}&amp;action= {transArgument}</span></div>
<div style="position:absolute;left:123.29px;top:186.27px" class="cls_010"><span class="cls_010">&lt;/url&gt;</span></div>
<div style="position:absolute;left:123.29px;top:197.07px" class="cls_010"><span class="cls_010">&lt;format default="html"&gt;extension&lt;/format&gt;</span></div>
<div style="position:absolute;left:123.29px;top:207.87px" class="cls_010"><span class="cls_010">&lt;authentication&gt;guest&lt;/authentication&gt;</span></div>
<div style="position:absolute;left:123.29px;top:218.67px" class="cls_010"><span class="cls_010">&lt;transaction&gt;none&lt;/transaction&gt;</span></div>
<div style="position:absolute;left:117.89px;top:229.47px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:86.07px;top:250.08px" class="cls_004"><span class="cls_004">12. Create a FreeMarker template in the same directory named review.get.html.ftl</span></div>
<div style="position:absolute;left:104.69px;top:262.68px" class="cls_004"><span class="cls_004">with HTML that simply echoes back the arguments that were passed in</span></div>
<div style="position:absolute;left:104.69px;top:275.28px" class="cls_004"><span class="cls_004">(obviously, SomeCo is going to want to make this a bit friendlier at some point):</span></div>
<div style="position:absolute;left:117.89px;top:298.49px" class="cls_010"><span class="cls_010">&lt;html&gt;</span></div>
<div style="position:absolute;left:123.29px;top:309.29px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:139.49px;top:320.09px" class="cls_010"><span class="cls_010">&lt;p&gt;Signaled ${args.id} for transition ${args.action}&lt;/p&gt;</span></div>
<div style="position:absolute;left:123.29px;top:330.89px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:117.89px;top:341.69px" class="cls_010"><span class="cls_010">&lt;/html&gt;</span></div>
<div style="position:absolute;left:86.07px;top:362.30px" class="cls_004"><span class="cls_004">13. Now write the Java controller. Create a new class called</span></div>
<div style="position:absolute;left:104.69px;top:374.90px" class="cls_013"><span class="cls_013">com.someco.repo.scripts.GetReview</span><span class="cls_004">. The class extends</span></div>
<div style="position:absolute;left:104.69px;top:388.18px" class="cls_013"><span class="cls_013">DeclarativeWebScript</span><span class="cls_004"> and has a dependency that will be passed in via</span></div>
<div style="position:absolute;left:104.69px;top:401.46px" class="cls_004"><span class="cls_004">Spring, which is the </span><span class="cls_013">activitiProcessEngine</span><span class="cls_004"> bean:</span></div>
<div style="position:absolute;left:117.89px;top:425.35px" class="cls_010"><span class="cls_010">package com.someco.repo.scripts;</span></div>
<div style="position:absolute;left:117.89px;top:436.15px" class="cls_010"><span class="cls_010">import java.util.HashMap;</span></div>
<div style="position:absolute;left:117.89px;top:446.95px" class="cls_010"><span class="cls_010">import java.util.Map;</span></div>
<div style="position:absolute;left:117.89px;top:457.75px" class="cls_010"><span class="cls_010">import org.activiti.engine.ProcessEngine;</span></div>
<div style="position:absolute;left:117.89px;top:468.55px" class="cls_010"><span class="cls_010">import org.alfresco.repo.security.authentication</span></div>
<div style="position:absolute;left:128.69px;top:479.35px" class="cls_010"><span class="cls_010">.AuthenticationUtil;</span></div>
<div style="position:absolute;left:117.89px;top:490.15px" class="cls_010"><span class="cls_010">import org.alfresco.repo.security.authentication</span></div>
<div style="position:absolute;left:128.69px;top:500.95px" class="cls_010"><span class="cls_010">.AuthenticationUtil.RunAsWork;</span></div>
<div style="position:absolute;left:117.89px;top:511.75px" class="cls_010"><span class="cls_010">import org.apache.log4j.Logger;</span></div>
<div style="position:absolute;left:117.89px;top:522.55px" class="cls_010"><span class="cls_010">import org.springframework.extensions.webscripts</span></div>
<div style="position:absolute;left:128.69px;top:533.35px" class="cls_010"><span class="cls_010">.DeclarativeWebScript;</span></div>
<div style="position:absolute;left:117.89px;top:544.15px" class="cls_010"><span class="cls_010">import org.springframework.extensions.webscripts.Status;</span></div>
<div style="position:absolute;left:117.89px;top:554.95px" class="cls_010"><span class="cls_010">import org.springframework.extensions.webscripts.WebScriptRequest;</span></div>
<div style="position:absolute;left:117.89px;top:565.75px" class="cls_010"><span class="cls_010">public class GetReview extends DeclarativeWebScript</span></div>
<div style="position:absolute;left:117.89px;top:576.55px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 377 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:264992px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background393.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">private ProcessEngine activitiProcessEngine;</span></div>
<div style="position:absolute;left:139.49px;top:80.62px" class="cls_010"><span class="cls_010">private Logger logger = Logger.getLogger(GetReview.class);</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">protected Map&lt;String, Object&gt;</span></div>
<div style="position:absolute;left:150.29px;top:102.22px" class="cls_010"><span class="cls_010">executeImpl(WebScriptRequest req, Status status) { }</span></div>
<div style="position:absolute;left:139.49px;top:113.02px" class="cls_010"><span class="cls_010">public void setActivitiProcessEngine(ProcessEngine</span></div>
<div style="position:absolute;left:150.29px;top:123.82px" class="cls_010"><span class="cls_010">activitiProcessEngine)</span></div>
<div style="position:absolute;left:139.49px;top:134.62px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:188.09px;top:145.42px" class="cls_010"><span class="cls_010">this.activitiProcessEngine = activitiProcessEngine;</span></div>
<div style="position:absolute;left:139.49px;top:156.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:167.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:187.63px" class="cls_004"><span class="cls_004">14. The </span><span class="cls_013">executeImpl()</span><span class="cls_004"> method reads the arguments, then uses the</span></div>
<div style="position:absolute;left:104.69px;top:200.91px" class="cls_004"><span class="cls_004">ActivitiRuntimeService to update the value of the execution variable called</span></div>
<div style="position:absolute;left:104.69px;top:213.51px" class="cls_013"><span class="cls_013">scwf_3rdPartyOutcome</span><span class="cls_004">, and then signals the workflow. So, for example, if</span></div>
<div style="position:absolute;left:104.69px;top:226.79px" class="cls_004"><span class="cls_004">someone were to invoke</span></div>
<div style="position:absolute;left:104.69px;top:238.61px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/service/someco/bpm/review?id=123/">http://localhost:8080/alfresco/service/someco/bpm/review?id=123</a> </div>
<div style="position:absolute;left:104.69px;top:251.39px" class="cls_013"><span class="cls_013">4&amp;action=Approve&amp;guest=true</span><span class="cls_004">, the controller would locate the Activiti</span></div>
<div style="position:absolute;left:104.69px;top:264.67px" class="cls_004"><span class="cls_004">workflow instance with the ID1234, and then update the variable with the value</span></div>
<div style="position:absolute;left:104.69px;top:277.27px" class="cls_004"><span class="cls_004">specified in the </span><span class="cls_007">action</span><span class="cls_004"> parameter, and finally signal the process instance to be</span></div>
<div style="position:absolute;left:104.69px;top:289.91px" class="cls_004"><span class="cls_004">able to continue. You'll notice that the </span><span class="cls_013">AuthenticationUtil.runAs</span><span class="cls_004"> method is</span></div>
<div style="position:absolute;left:104.69px;top:303.19px" class="cls_004"><span class="cls_004">being used to allow guests to successfully execute the action. Populate the</span></div>
<div style="position:absolute;left:104.69px;top:315.79px" class="cls_013"><span class="cls_013">executeImpl</span><span class="cls_004"> method with the following code:</span></div>
<div style="position:absolute;left:117.89px;top:339.68px" class="cls_010"><span class="cls_010">final String id = req.getParameter("id");</span></div>
<div style="position:absolute;left:117.89px;top:350.48px" class="cls_010"><span class="cls_010">final String action = req.getParameter("action");</span></div>
<div style="position:absolute;left:117.89px;top:361.28px" class="cls_010"><span class="cls_010">if (id == null || action == null)</span></div>
<div style="position:absolute;left:117.89px;top:372.08px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:382.88px" class="cls_010"><span class="cls_010">status.setCode(400);</span></div>
<div style="position:absolute;left:139.49px;top:393.68px" class="cls_010"><span class="cls_010">status.setMessage("Required data has not been provided");</span></div>
<div style="position:absolute;left:139.49px;top:404.48px" class="cls_010"><span class="cls_010">status.setRedirect(true);</span></div>
<div style="position:absolute;left:117.89px;top:415.28px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:426.08px" class="cls_010"><span class="cls_010">Map&lt;String, Object&gt; model = new HashMap&lt;String, Object&gt;();</span></div>
<div style="position:absolute;left:117.89px;top:436.88px" class="cls_010"><span class="cls_010">model.put("response",</span></div>
<div style="position:absolute;left:139.49px;top:447.68px" class="cls_010"><span class="cls_010">AuthenticationUtil.runAs(new RunAsWork&lt;String&gt;()</span></div>
<div style="position:absolute;left:117.89px;top:458.48px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:469.28px" class="cls_010"><span class="cls_010">public String doWork() throws Exception</span></div>
<div style="position:absolute;left:139.49px;top:480.08px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:161.09px;top:490.88px" class="cls_010"><span class="cls_010">logger.debug("About to update execution id:"</span></div>
<div style="position:absolute;left:171.89px;top:501.68px" class="cls_010"><span class="cls_010">+ id + " with transition:" + action);</span></div>
<div style="position:absolute;left:161.09px;top:523.28px" class="cls_010"><span class="cls_010">// Update the variable</span></div>
<div style="position:absolute;left:161.09px;top:534.08px" class="cls_010"><span class="cls_010">activitiProcessEngine.getRuntimeService()</span></div>
<div style="position:absolute;left:166.49px;top:544.88px" class="cls_010"><span class="cls_010">.setVariable(id, "scwf_3rdPartyOutcome", action);</span></div>
<div style="position:absolute;left:161.09px;top:566.48px" class="cls_010"><span class="cls_010">// Signal the execution</span></div>
<div style="position:absolute;left:161.09px;top:577.28px" class="cls_010"><span class="cls_010">activitiProcessEngine.getRuntimeService().signal(id);</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 378 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:265668px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background394.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">logger.debug("Signal sent."); return "Success";</span></div>
<div style="position:absolute;left:139.49px;top:80.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">}, "admin"));</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">return model;</span></div>
<div style="position:absolute;left:86.07px;top:122.83px" class="cls_004"><span class="cls_004">15. Save the controller.</span></div>
<div style="position:absolute;left:86.07px;top:137.59px" class="cls_004"><span class="cls_004">16. Java controllers need to be configured as Spring beans. Use the existing</span></div>
<div style="position:absolute;left:104.69px;top:149.41px" class="cls_013"><span class="cls_013">repo|src|main|amp|config|alfresco|module|repo|context|webscript</span></div>
<div style="position:absolute;left:104.69px;top:162.19px" class="cls_013"><span class="cls_013">s-context.xml</span><span class="cls_004"> file to add the bean:</span></div>
<div style="position:absolute;left:117.89px;top:186.08px" class="cls_010"><span class="cls_010">&lt;bean id="webscript.com.someco.bpm.review.get"</span></div>
<div style="position:absolute;left:128.69px;top:196.88px" class="cls_010"><span class="cls_010">class="com.someco.repo.scripts.GetReview" parent="webscript"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:218.48px" class="cls_010"><span class="cls_010">&lt;property name="activitiProcessEngine"</span></div>
<div style="position:absolute;left:139.49px;top:229.28px" class="cls_010"><span class="cls_010">ref="activitiProcessEngine" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:240.08px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:260.69px" class="cls_004"><span class="cls_004">17. Let's implement the task listener that we'll use on the third-party review task to</span></div>
<div style="position:absolute;left:104.69px;top:273.29px" class="cls_004"><span class="cls_004">send the e-mail. Create a new class called</span></div>
<div style="position:absolute;left:104.69px;top:285.89px" class="cls_013"><span class="cls_013">com.someco.repo.bpm.ExternalReviewNotification</span><span class="cls_004"> that implements</span></div>
<div style="position:absolute;left:104.69px;top:299.17px" class="cls_013"><span class="cls_013">ExecutionListener</span><span class="cls_004">. Begin the class as:</span></div>
<div style="position:absolute;left:117.89px;top:323.06px" class="cls_010"><span class="cls_010">package com.someco.repo.bpm;</span></div>
<div style="position:absolute;left:117.89px;top:333.86px" class="cls_010"><span class="cls_010">import java.io.Serializable;</span></div>
<div style="position:absolute;left:117.89px;top:344.66px" class="cls_010"><span class="cls_010">import java.util.HashMap;</span></div>
<div style="position:absolute;left:117.89px;top:355.46px" class="cls_010"><span class="cls_010">import java.util.Map;</span></div>
<div style="position:absolute;left:117.89px;top:366.26px" class="cls_010"><span class="cls_010">import org.activiti.engine.delegate.DelegateExecution;</span></div>
<div style="position:absolute;left:117.89px;top:377.06px" class="cls_010"><span class="cls_010">import org.activiti.engine.delegate.ExecutionListener;</span></div>
<div style="position:absolute;left:117.89px;top:387.86px" class="cls_010"><span class="cls_010">import org.activiti.engine.impl.cfg.*;</span></div>
<div style="position:absolute;left:117.89px;top:398.66px" class="cls_010"><span class="cls_010">import org.activiti.engine.impl.context.Context;</span></div>
<div style="position:absolute;left:117.89px;top:409.46px" class="cls_010"><span class="cls_010">import org.alfresco.repo.action.executer.MailActionExecuter;</span></div>
<div style="position:absolute;left:117.89px;top:420.26px" class="cls_010"><span class="cls_010">import org.alfresco.repo.workflow.activiti.ActivitiConstants;</span></div>
<div style="position:absolute;left:117.89px;top:431.06px" class="cls_010"><span class="cls_010">import org.alfresco.service.ServiceRegistry;</span></div>
<div style="position:absolute;left:117.89px;top:441.86px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.Action;</span></div>
<div style="position:absolute;left:117.89px;top:452.66px" class="cls_010"><span class="cls_010">import org.alfresco.service.cmr.action.ActionService;</span></div>
<div style="position:absolute;left:117.89px;top:463.46px" class="cls_010"><span class="cls_010">import org.alfresco.util.UrlUtil;</span></div>
<div style="position:absolute;left:117.89px;top:485.06px" class="cls_010"><span class="cls_010">public class ExternalReviewNotification</span></div>
<div style="position:absolute;left:128.69px;top:495.86px" class="cls_010"><span class="cls_010">implements ExecutionListener</span></div>
<div style="position:absolute;left:117.89px;top:506.66px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:134.09px;top:517.46px" class="cls_010"><span class="cls_010">private static final String FROM_ADDRESS = "alfresco@localhost";</span></div>
<div style="position:absolute;left:134.09px;top:528.26px" class="cls_010"><span class="cls_010">private static final String SUBJECT = "Workflow task requires</span></div>
<div style="position:absolute;left:74.69px;top:539.06px" class="cls_010"><span class="cls_010">action";</span></div>
<div style="position:absolute;left:134.09px;top:549.86px" class="cls_010"><span class="cls_010">private static final String RECIP_PROCESS_VARIABLE =</span></div>
<div style="position:absolute;left:74.69px;top:560.66px" class="cls_010"><span class="cls_010">"scwf_reviewerEmail";</span></div>
<div style="position:absolute;left:134.09px;top:571.46px" class="cls_010"><span class="cls_010">@Override public void notify(DelegateExecution execution) throws</span></div>
<div style="position:absolute;left:74.69px;top:582.26px" class="cls_010"><span class="cls_010">Exception</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 379 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:266344px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background395.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:80.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:112.03px" class="cls_004"><span class="cls_004">18. The first method that we are going to implement is to get the Alfresco service</span></div>
<div style="position:absolute;left:104.69px;top:124.63px" class="cls_004"><span class="cls_004">registry. Basically, it's the entry point to be able to use all Java services provided</span></div>
<div style="position:absolute;left:104.69px;top:137.23px" class="cls_004"><span class="cls_004">by Alfresco out-of-the-box. To summarize, you are going to load the process</span></div>
<div style="position:absolute;left:104.69px;top:149.83px" class="cls_004"><span class="cls_004">engine configuration (defined in the bean identified by the id</span></div>
<div style="position:absolute;left:104.69px;top:162.43px" class="cls_013"><span class="cls_013">activitiProcessEngineConfiguration</span><span class="cls_004"> in the file </span><span class="cls_013">alfresco|activiti-</span></div>
<div style="position:absolute;left:104.69px;top:175.71px" class="cls_013"><span class="cls_013">context.xml</span><span class="cls_004"> bundled in the </span><span class="cls_013">alfresco-repository-5.x.jar</span><span class="cls_004">), then we are</span></div>
<div style="position:absolute;left:104.69px;top:188.99px" class="cls_004"><span class="cls_004">retrieving a map of services identified in the property beans.</span></div>
<div style="position:absolute;left:117.89px;top:212.20px" class="cls_010"><span class="cls_010">protected ServiceRegistry getServiceRegistry()</span></div>
<div style="position:absolute;left:117.89px;top:223.00px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:233.80px" class="cls_010"><span class="cls_010">ProcessEngineConfigurationImpl config</span></div>
<div style="position:absolute;left:150.29px;top:244.60px" class="cls_010"><span class="cls_010">= Context.getProcessEngineConfiguration();</span></div>
<div style="position:absolute;left:139.49px;top:255.40px" class="cls_010"><span class="cls_010">if (config != null)</span></div>
<div style="position:absolute;left:139.49px;top:266.20px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:166.49px;top:277.00px" class="cls_010"><span class="cls_010">ServiceRegistry registry =</span></div>
<div style="position:absolute;left:171.89px;top:287.80px" class="cls_010"><span class="cls_010">(ServiceRegistry) config.getBeans()</span></div>
<div style="position:absolute;left:171.89px;top:298.60px" class="cls_010"><span class="cls_010">.get(ActivitiConstants.SERVICE_REGISTRY_BEAN_KEY);</span></div>
<div style="position:absolute;left:161.09px;top:320.20px" class="cls_010"><span class="cls_010">if (registry == null)</span></div>
<div style="position:absolute;left:161.09px;top:331.00px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:182.69px;top:341.80px" class="cls_010"><span class="cls_010">throw new RuntimeException("Service-registry not</span></div>
<div style="position:absolute;left:74.69px;top:352.60px" class="cls_010"><span class="cls_010">present "</span></div>
<div style="position:absolute;left:182.69px;top:363.40px" class="cls_010"><span class="cls_010">+ "in ProcessEngineConfiguration beans, "</span></div>
<div style="position:absolute;left:182.69px;top:374.20px" class="cls_010"><span class="cls_010">+ "expected ServiceRegistry with key"</span></div>
<div style="position:absolute;left:182.69px;top:385.00px" class="cls_010"><span class="cls_010">+ ActivitiConstants.SERVICE_REGISTRY_BEAN_KEY);</span></div>
<div style="position:absolute;left:161.09px;top:395.80px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:161.09px;top:406.60px" class="cls_010"><span class="cls_010">return registry;</span></div>
<div style="position:absolute;left:139.49px;top:417.40px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:428.20px" class="cls_010"><span class="cls_010">throw new IllegalStateException("No ProcessEngineConfiguration</span></div>
<div style="position:absolute;left:74.69px;top:439.00px" class="cls_010"><span class="cls_010">"</span></div>
<div style="position:absolute;left:144.89px;top:449.80px" class="cls_010"><span class="cls_010">+ "found in active context"); }</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 380 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:267020px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background396.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">19. Let's populate the </span><span class="cls_013">notify</span><span class="cls_004"> method. The first thing that you need to do is to</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">retrieve the e-mail address:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">String recipient = (String)</span></div>
<div style="position:absolute;left:74.69px;top:117.79px" class="cls_010"><span class="cls_010">execution.getVariable(ExternalReviewNotification</span></div>
<div style="position:absolute;left:117.89px;top:128.59px" class="cls_010"><span class="cls_010">.RECIP_PROCESS_VARIABLE);</span></div>
<div style="position:absolute;left:86.07px;top:149.20px" class="cls_004"><span class="cls_004">20. Then, we need to create the mail action provided by Alfresco:</span></div>
<div style="position:absolute;left:117.89px;top:172.41px" class="cls_010"><span class="cls_010">ActionService actionService =</span></div>
<div style="position:absolute;left:128.69px;top:183.21px" class="cls_010"><span class="cls_010">getServiceRegistry().getActionService();</span></div>
<div style="position:absolute;left:117.89px;top:204.81px" class="cls_010"><span class="cls_010">Action mailAction = actionService</span></div>
<div style="position:absolute;left:128.69px;top:215.61px" class="cls_010"><span class="cls_010">.createAction(MailActionExecuter.NAME);</span></div>
<div style="position:absolute;left:86.07px;top:236.22px" class="cls_004"><span class="cls_004">21. We'll use Freemarker to generate the e-mail body. To accomplish that, we need to</span></div>
<div style="position:absolute;left:104.69px;top:248.82px" class="cls_004"><span class="cls_004">create a model object that will be passed to the Freemarker template file:</span></div>
<div style="position:absolute;left:117.89px;top:272.03px" class="cls_010"><span class="cls_010">Map&lt;String, String&gt; model = new HashMap&lt;String, String&gt;();</span></div>
<div style="position:absolute;left:117.89px;top:282.83px" class="cls_010"><span class="cls_010">model.put("taskName", execution.getCurrentActivityName());</span></div>
<div style="position:absolute;left:117.89px;top:293.63px" class="cls_010"><span class="cls_010">model.put("executionId", execution.getId());</span></div>
<div style="position:absolute;left:117.89px;top:304.43px" class="cls_010"><span class="cls_010">model.put("shareUrl",UrlUtil.getShareUrl(</span></div>
<div style="position:absolute;left:128.69px;top:315.23px" class="cls_010"><span class="cls_010">getServiceRegistry().getSysAdminParams()));</span></div>
<div style="position:absolute;left:117.89px;top:326.03px" class="cls_010"><span class="cls_010">model.put("alfrescoUrl", UrlUtil.getAlfrescoUrl(</span></div>
<div style="position:absolute;left:128.69px;top:336.83px" class="cls_010"><span class="cls_010">getServiceRegistry().getSysAdminParams()));</span></div>
<div style="position:absolute;left:124.19px;top:361.27px" class="cls_004"><span class="cls_004">You can notice that the method </span><span class="cls_040">getSysAdminParams()</span><span class="cls_004"> is deprecated. We</span></div>
<div style="position:absolute;left:124.19px;top:374.55px" class="cls_004"><span class="cls_004">decided to keep it like that. But if you wanted to make it perfectly clean.</span></div>
<div style="position:absolute;left:124.19px;top:387.15px" class="cls_004"><span class="cls_004">You'll have extended the </span><span class="cls_013">util:map</span><span class="cls_004"> defined with the id</span></div>
<div style="position:absolute;left:124.19px;top:400.43px" class="cls_013"><span class="cls_013">activitiBeanRegistry</span><span class="cls_004"> defined in the </span><span class="cls_013">activiti-context.xml</span><span class="cls_004"> and add a</span></div>
<div style="position:absolute;left:124.19px;top:413.71px" class="cls_004"><span class="cls_004">new entry to get the service sysAdminParams defined in the file</span></div>
<div style="position:absolute;left:124.19px;top:425.53px" class="cls_013"><span class="cls_013">alfresco|subsystems|sysAdmin|default|sysadmin-parameter-</span></div>
<div style="position:absolute;left:124.19px;top:438.31px" class="cls_013"><span class="cls_013">context.xml</span><span class="cls_004"> in the </span><span class="cls_013">alfresco-repository-5.x.jar</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:464.55px" class="cls_004"><span class="cls_004">22. Finally, we have all the required information to send the e-mail:</span></div>
<div style="position:absolute;left:117.89px;top:487.76px" class="cls_010"><span class="cls_010">mailAction.setParameterValue(MailActionExecuter.PARAM_SUBJECT,</span></div>
<div style="position:absolute;left:117.89px;top:498.56px" class="cls_010"><span class="cls_010">ExternalReviewNotification.SUBJECT);</span></div>
<div style="position:absolute;left:117.89px;top:520.16px" class="cls_010"><span class="cls_010">mailAction.setParameterValue(MailActionExecuter</span></div>
<div style="position:absolute;left:117.89px;top:530.96px" class="cls_010"><span class="cls_010">.PARAM_TO, recipient);</span></div>
<div style="position:absolute;left:117.89px;top:552.56px" class="cls_010"><span class="cls_010">mailAction.setParameterValue(MailActionExecuter.PARAM_FROM,</span></div>
<div style="position:absolute;left:123.29px;top:563.36px" class="cls_010"><span class="cls_010">ExternalReviewNotification.FROM_ADDRESS);</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 381 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:267696px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background397.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">mailAction.setParameterValue(MailActionExecuter.PARAM_TEMPLATE,</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">"alfresco/module/repo/resources</span></div>
<div style="position:absolute;left:128.69px;top:91.42px" class="cls_010"><span class="cls_010">/thirdpartyreview-notification.html.ftl");</span></div>
<div style="position:absolute;left:117.89px;top:113.02px" class="cls_010"><span class="cls_010">mailAction.setParameterValue( MailActionExecuter</span></div>
<div style="position:absolute;left:128.69px;top:123.82px" class="cls_010"><span class="cls_010">.PARAM_TEMPLATE_MODEL, (Serializable) model);</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">actionService.executeAction(mailAction, null);</span></div>
<div style="position:absolute;left:86.07px;top:166.03px" class="cls_004"><span class="cls_004">23. Let's create the Freemarker template. We are not going to be very orginal and re-</span></div>
<div style="position:absolute;left:104.69px;top:178.63px" class="cls_004"><span class="cls_004">use one of Alfresco e-mail notification that you can find in theData</span></div>
<div style="position:absolute;left:104.69px;top:191.23px" class="cls_004"><span class="cls_004">Dictionary|Email Templates folder. We are not going to display the entire HTML</span></div>
<div style="position:absolute;left:104.69px;top:203.83px" class="cls_004"><span class="cls_004">code in the book, but you can find the entire code in the code associated with this</span></div>
<div style="position:absolute;left:104.69px;top:216.43px" class="cls_004"><span class="cls_004">chapter. Create a new file called </span><span class="cls_013">thirdpartyreview-notification.html.ftl</span></div>
<div style="position:absolute;left:104.69px;top:229.71px" class="cls_004"><span class="cls_004">in the folder </span><span class="cls_013">repo | src | main | amp | config | alfresco | module</span></div>
<div style="position:absolute;left:104.69px;top:242.99px" class="cls_013"><span class="cls_013">| repo | resources</span><span class="cls_004">. The core HTML code looks like the following code. You</span></div>
<div style="position:absolute;left:104.69px;top:256.27px" class="cls_004"><span class="cls_004">will notice the re-use of the variables that we defined in the model created in the</span></div>
<div style="position:absolute;left:104.69px;top:268.87px" class="cls_004"><span class="cls_004">Java controller:</span></div>
<div style="position:absolute;left:117.89px;top:292.08px" class="cls_010"><span class="cls_010">&lt;table cellpadding="0" cellspacing="0" border="0"&gt;</span></div>
<div style="position:absolute;left:134.09px;top:302.88px" class="cls_010"><span class="cls_010">&lt;tr&gt;</span></div>
<div style="position:absolute;left:139.49px;top:313.68px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:150.29px;top:324.48px" class="cls_010"><span class="cls_010">&lt;imgsrc="${shareUrl}/res/components/images/task-64.png"</span></div>
<div style="position:absolute;left:161.09px;top:335.28px" class="cls_010"><span class="cls_010">alt="" width="64" height="64" border="0"</span></div>
<div style="position:absolute;left:161.09px;top:346.08px" class="cls_010"><span class="cls_010">style="padding-right: 20px;" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:356.88px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:139.49px;top:367.68px" class="cls_010"><span class="cls_010">&lt;td&gt;</span></div>
<div style="position:absolute;left:150.29px;top:378.48px" class="cls_010"><span class="cls_010">&lt;div style="font-size: 22px; padding-bottom: 4px;"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:389.28px" class="cls_010"><span class="cls_010">You have been assigned a task</span></div>
<div style="position:absolute;left:150.29px;top:400.08px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:139.49px;top:410.88px" class="cls_010"><span class="cls_010">&lt;/td&gt;</span></div>
<div style="position:absolute;left:134.09px;top:421.68px" class="cls_010"><span class="cls_010">&lt;/tr&gt;</span></div>
<div style="position:absolute;left:117.89px;top:432.48px" class="cls_010"><span class="cls_010">&lt;/table&gt;</span></div>
<div style="position:absolute;left:117.89px;top:443.28px" class="cls_010"><span class="cls_010">&lt;div style="font-size: 14px; margin: 12px 0px 24px 0px;</span></div>
<div style="position:absolute;left:128.69px;top:454.08px" class="cls_010"><span class="cls_010">padding-top: 10px; border-top: 1px solid #aaaaaa;"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:464.88px" class="cls_010"><span class="cls_010">&lt;p&gt;Hi,&lt;/p&gt;</span></div>
<div style="position:absolute;left:117.89px;top:475.68px" class="cls_010"><span class="cls_010">&lt;p&gt;You have been assigned the following task:&lt;/p&gt;</span></div>
<div style="position:absolute;left:117.89px;top:486.48px" class="cls_010"><span class="cls_010">&lt;p&gt;&lt;b&gt;"${taskName}"&lt;/b&gt;&lt;/p&gt;</span></div>
<div style="position:absolute;left:117.89px;top:497.28px" class="cls_010"><span class="cls_010">&lt;p&gt;Take the appropriate action by clicking one of the</span></div>
<div style="position:absolute;left:144.89px;top:508.08px" class="cls_010"><span class="cls_010">links below:&lt;p&gt;</span></div>
<div style="position:absolute;left:117.89px;top:518.88px" class="cls_010"><span class="cls_010">&lt;ul&gt;</span></div>
<div style="position:absolute;left:128.69px;top:529.68px" class="cls_010"><span class="cls_010">&lt;li&gt;</span></div>
<div style="position:absolute;left:150.29px;top:540.48px" class="cls_010"><span class="cls_010">&lt;a href="${alfrescoUrl}/service/someco/bpm</span></div>
<div style="position:absolute;left:161.09px;top:551.28px" class="cls_010"><span class="cls_010">/review?id=${executionId}&amp;action=Approve&amp;guest=true"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:562.08px" class="cls_010"><span class="cls_010">Approve</span></div>
<div style="position:absolute;left:150.29px;top:572.88px" class="cls_010"><span class="cls_010">&lt;/a&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 382 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:268372px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background398.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:128.69px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/li&gt;</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;li&gt;</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">&lt;a href="${alfrescoUrl}/service/someco/bpm</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">/review?id=${executionId}&amp;action=Reject&amp;guest=true"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:123.82px" class="cls_010"><span class="cls_010">Reject</span></div>
<div style="position:absolute;left:139.49px;top:134.62px" class="cls_010"><span class="cls_010">&lt;/a&gt;</span></div>
<div style="position:absolute;left:128.69px;top:145.42px" class="cls_010"><span class="cls_010">&lt;/li&gt;</span></div>
<div style="position:absolute;left:117.89px;top:156.22px" class="cls_010"><span class="cls_010">&lt;/ul&gt;</span></div>
<div style="position:absolute;left:117.89px;top:167.02px" class="cls_010"><span class="cls_010">&lt;p&gt;Sincerely,&lt;br /&gt; Alfresco&lt;/p&gt;</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:86.07px;top:198.43px" class="cls_004"><span class="cls_004">24. The last step is to make final updates to the process definition. The first required</span></div>
<div style="position:absolute;left:104.69px;top:211.04px" class="cls_004"><span class="cls_004">change is to create a </span><span class="cls_012">start </span><span class="cls_004">listener on the </span><span class="cls_007">Third Party Review</span><span class="cls_004"> task by referencing</span></div>
<div style="position:absolute;left:104.69px;top:223.68px" class="cls_004"><span class="cls_004">the ExternalReviewNotification Java class that we implemented as shown in the</span></div>
<div style="position:absolute;left:104.69px;top:236.28px" class="cls_004"><span class="cls_004">following screenshot:</span></div>
<div style="position:absolute;left:86.07px;top:389.21px" class="cls_004"><span class="cls_004">25. Then, we need to add a condition between the exclusive gateway at the exit of the</span></div>
<div style="position:absolute;left:104.69px;top:401.81px" class="cls_007"><span class="cls_007">Third Party Review</span><span class="cls_004"> task, and the Approved task by using the following</span></div>
<div style="position:absolute;left:104.69px;top:414.44px" class="cls_004"><span class="cls_004">condition:</span></div>
<div style="position:absolute;left:117.89px;top:437.65px" class="cls_010"><span class="cls_010">${scwf_3rdPartyOutcome == 'Approve'}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 383 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:269048px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background399.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">26. Add another condition to the transition that goes from the same exclusive</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">gateway to the Revise task:</span></div>
<div style="position:absolute;left:117.89px;top:106.31px" class="cls_010"><span class="cls_010">${scwf_3rdPartyOutcome == 'Reject'}</span></div>
<div style="position:absolute;left:86.07px;top:126.92px" class="cls_004"><span class="cls_004">27. Finally, we need to add more conditions to execute or not the </span><span class="cls_007">Third Party</span></div>
<div style="position:absolute;left:104.69px;top:139.56px" class="cls_007"><span class="cls_007">Review</span><span class="cls_004"> task. Click on the transition between the exclusive gateway that goes into</span></div>
<div style="position:absolute;left:104.69px;top:152.20px" class="cls_004"><span class="cls_004">the </span><span class="cls_007">Third Party Review</span><span class="cls_004"> task and configure the following condition:</span></div>
<div style="position:absolute;left:117.89px;top:175.45px" class="cls_010"><span class="cls_010">${scwf_reviewerEmail!=""}</span></div>
<div style="position:absolute;left:86.07px;top:196.05px" class="cls_004"><span class="cls_004">28. Add another condition from the same exclusive gateway to the Approved task:</span></div>
<div style="position:absolute;left:117.89px;top:219.26px" class="cls_010"><span class="cls_010">${scwf_reviewerEmail==""}</span></div>
<div style="position:absolute;left:86.07px;top:239.87px" class="cls_004"><span class="cls_004">29. Save the process definition.</span></div>
<div style="position:absolute;left:86.07px;top:254.63px" class="cls_004"><span class="cls_004">30. To be able to test, you need first to configure an SMTP server. You can override</span></div>
<div style="position:absolute;left:104.69px;top:267.23px" class="cls_004"><span class="cls_004">default properties in your </span><span class="cls_013">alfresco-global.properties</span><span class="cls_004"> file. You can find out</span></div>
<div style="position:absolute;left:104.69px;top:280.51px" class="cls_004"><span class="cls_004">all the available properties at </span><a href="http://docs.alfresco.com/5.1/concepts/email-outboundsmtp-props.html">http://docs.alfresco.com/5.1/concepts/email</a> </div>
<div style="position:absolute;left:104.69px;top:293.49px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/email-outboundsmtp-props.html">-outboundsmtp-props.html</a> <span class="cls_004">. However, if you use Alfresco Enterprise, you can</span></div>
<div style="position:absolute;left:104.69px;top:306.47px" class="cls_004"><span class="cls_004">use the Administration Console</span></div>
<div style="position:absolute;left:104.69px;top:318.29px" class="cls_013"><span class="cls_013"> </span><a href="http://localhost:8080/alfresco/s/enterprise/admin/admin-outboun/">http://localhost:8080/alfresco/s/enterprise/admin/admin-outboun</a> </div>
<div style="position:absolute;left:104.69px;top:331.07px" class="cls_013"><span class="cls_013">demail</span><span class="cls_004"> and update the properties dynamically and test it. Be aware that if you</span></div>
<div style="position:absolute;left:104.69px;top:344.35px" class="cls_004"><span class="cls_004">use this tool, the values will be persisted and will take precedence over any</span></div>
<div style="position:absolute;left:104.69px;top:356.95px" class="cls_004"><span class="cls_004">values specified in alfresco-global.properties. It can be quite challenging</span></div>
<div style="position:absolute;left:104.69px;top:369.55px" class="cls_004"><span class="cls_004">sometimes to keep consistent the Administration console and the property file. If</span></div>
<div style="position:absolute;left:104.69px;top:382.15px" class="cls_004"><span class="cls_004">you are a bit confused about which values you should use, you can find the right</span></div>
<div style="position:absolute;left:104.69px;top:394.75px" class="cls_004"><span class="cls_004">configuration for GMail, Yahoo, or Zimbra at </span><a href="https://community.alfresco.com/docs/DOC-4799-outbound-e-mail-configuration">https://community.alfresco.com</a> </div>
<div style="position:absolute;left:104.69px;top:407.73px" class="cls_010"><span class="cls_010"> </span><a href="https://community.alfresco.com/docs/DOC-4799-outbound-e-mail-configuration">/docs/DOC-4799-outbound-e-mail-configuration</a> <span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:422.87px" class="cls_004"><span class="cls_004">31. Package, deploy, and test.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 384 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:269724px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background400.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">To test this out, launch the workflow on a test Whitepaper. You should be able to configure</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">an e-mail address (if you don't provide any, it will behave as before):</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 385 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:270400px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background401.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Then, mark both Marketing and Operation reviews as approved. If all goes well, you</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">should get an e-mail that looks like this:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 386 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:271076px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background402.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you open the Activiti Explorer on the relevant workflow instance, you can see that the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">workflow instance is waiting on the </span><span class="cls_007">Third Party Review</span><span class="cls_004"> task:</span></div>
<div style="position:absolute;left:56.69px;top:381.34px" class="cls_004"><span class="cls_004">If you click on a link, it should signal the workflow and it should continue on the</span></div>
<div style="position:absolute;left:56.69px;top:393.94px" class="cls_004"><span class="cls_004">appropriate path.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 387 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:271752px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background403.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Making the third-party review more robust</span></div>
<div style="position:absolute;left:56.69px;top:105.06px" class="cls_004"><span class="cls_004">The third-party review is a good example of wait-state behavior in a process, and shows</span></div>
<div style="position:absolute;left:56.69px;top:117.66px" class="cls_004"><span class="cls_004">how web scripts can interact with workflows via the ActivitiJava Service. But there are a</span></div>
<div style="position:absolute;left:56.69px;top:130.26px" class="cls_004"><span class="cls_004">few open items that would need to be addressed before you use it in production. Some of</span></div>
<div style="position:absolute;left:56.69px;top:142.86px" class="cls_004"><span class="cls_004">these issues include:</span></div>
<div style="position:absolute;left:104.69px;top:168.42px" class="cls_004"><span class="cls_004">The e-mail recipient doesn't get a copy of the documents being reviewed. One</span></div>
<div style="position:absolute;left:104.69px;top:181.02px" class="cls_004"><span class="cls_004">way to address this would be to have the notification action create a ZIP of the</span></div>
<div style="position:absolute;left:104.69px;top:193.62px" class="cls_004"><span class="cls_004">documents in the workflow package and then attach that ZIP to the e-mail that</span></div>
<div style="position:absolute;left:104.69px;top:206.22px" class="cls_004"><span class="cls_004">gets sent. If you are not a big fan of email attachment, Alfresco can provide a</span></div>
<div style="position:absolute;left:104.69px;top:218.82px" class="cls_004"><span class="cls_004">unique URL that anyone can use (no need to authenticate) to access to a</span></div>
<div style="position:absolute;left:104.69px;top:231.42px" class="cls_004"><span class="cls_004">document. This URL could be sent in the email body. Another option would be to</span></div>
<div style="position:absolute;left:104.69px;top:244.02px" class="cls_004"><span class="cls_004">write additional web scripts to implement a mini-workflow task management</span></div>
<div style="position:absolute;left:104.69px;top:256.62px" class="cls_004"><span class="cls_004">user interface that third-party recipients could use to review content and</span></div>
<div style="position:absolute;left:104.69px;top:269.22px" class="cls_004"><span class="cls_004">assigned tasks. But then you've moved beyond the simple e-mail interaction into</span></div>
<div style="position:absolute;left:104.69px;top:281.82px" class="cls_004"><span class="cls_004">custom client land.</span></div>
<div style="position:absolute;left:104.69px;top:296.58px" class="cls_004"><span class="cls_004">It'd be really easy for an unauthorized person to signal any node in the system</span></div>
<div style="position:absolute;left:104.69px;top:309.18px" class="cls_004"><span class="cls_004">because the controller class doesn't do any validation whatsoever.</span></div>
<div style="position:absolute;left:56.69px;top:333.07px" class="cls_004"><span class="cls_004">In production, you'd want to check that:</span></div>
<div style="position:absolute;left:104.69px;top:354.80px" class="cls_004"><span class="cls_004">The person making the request is the person assigned to the task</span></div>
<div style="position:absolute;left:104.69px;top:369.56px" class="cls_004"><span class="cls_004">That the task is still active</span></div>
<div style="position:absolute;left:104.69px;top:384.32px" class="cls_004"><span class="cls_004">A shared secret of some kind was generated, stored as process metadata, and</span></div>
<div style="position:absolute;left:104.69px;top:396.92px" class="cls_004"><span class="cls_004">passed back in as an argument in the URL for validation</span></div>
<div style="position:absolute;left:104.69px;top:411.68px" class="cls_004"><span class="cls_004">The web script response should be a lot friendlier.</span></div>
<div style="position:absolute;left:56.69px;top:439.40px" class="cls_004"><span class="cls_004">Most of these shortcomings have very little to do with advanced workflows specifically, so</span></div>
<div style="position:absolute;left:56.69px;top:452.00px" class="cls_004"><span class="cls_004">they are left up to you to address on your own.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 388 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:272428px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background404.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Using timers</span></div>
<div style="position:absolute;left:56.69px;top:107.46px" class="cls_004"><span class="cls_004">Timers are a common requirement for business processes. The most common functionality</span></div>
<div style="position:absolute;left:56.69px;top:120.06px" class="cls_004"><span class="cls_004">is around doing something if someone doesn't respond to a task fast enough. That</span></div>
<div style="position:absolute;left:56.69px;top:132.66px" class="cls_004"><span class="cls_004">something might be reassigning the task or sending a nasty e-mail to the assignee's boss.</span></div>
<div style="position:absolute;left:56.69px;top:145.26px" class="cls_004"><span class="cls_004">Another use might be to purposefully postpone all or part of a process until a specific day</span></div>
<div style="position:absolute;left:56.69px;top:157.86px" class="cls_004"><span class="cls_004">and time occurs.</span></div>
<div style="position:absolute;left:56.69px;top:183.42px" class="cls_004"><span class="cls_004">Timer events are events which are triggered by a defined timer. They can be used as a start</span></div>
<div style="position:absolute;left:56.69px;top:196.02px" class="cls_004"><span class="cls_004">event, intermediate event, or boundary event. A timer start event is used to create a process</span></div>
<div style="position:absolute;left:56.69px;top:208.62px" class="cls_004"><span class="cls_004">instance at given time. A timer boundary event acts as a stopwatch and alarm clock. A timer</span></div>
<div style="position:absolute;left:56.69px;top:221.22px" class="cls_004"><span class="cls_004">intermediate event acts as a stopwatch.</span></div>
<div style="position:absolute;left:56.69px;top:259.00px" class="cls_014"><span class="cls_014">Step-by-step - adding a timer to the third-party</span></div>
<div style="position:absolute;left:56.69px;top:280.60px" class="cls_014"><span class="cls_014">review</span></div>
<div style="position:absolute;left:56.69px;top:315.90px" class="cls_004"><span class="cls_004">In the previous example, you added the ability for the website submission workflow to</span></div>
<div style="position:absolute;left:56.69px;top:328.50px" class="cls_004"><span class="cls_004">incorporate an external third party in the process. SomeCo is glad that its partners will be</span></div>
<div style="position:absolute;left:56.69px;top:341.10px" class="cls_004"><span class="cls_004">involved in the process, but it doesn't want them to become an unnecessary bottleneck. To</span></div>
<div style="position:absolute;left:56.69px;top:353.70px" class="cls_004"><span class="cls_004">address this, you are going to add a timer to the </span><span class="cls_007">Third Party Review</span><span class="cls_004"> node so that if there is</span></div>
<div style="position:absolute;left:56.69px;top:366.34px" class="cls_004"><span class="cls_004">no response after a certain period of time has elapsed, an assumed approval will take place.</span></div>
<div style="position:absolute;left:56.69px;top:391.90px" class="cls_004"><span class="cls_004">Adding a timer is really simple. It involves updating the process definition with the timer</span></div>
<div style="position:absolute;left:56.69px;top:404.50px" class="cls_004"><span class="cls_004">tag and redeploying the process. Follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:430.06px" class="cls_004"><span class="cls_004">1. Edit the </span><span class="cls_013">publishWhitepaper.bpmn20.xml</span><span class="cls_004"> file. After 10 minutes (man, SomeCo</span></div>
<div style="position:absolute;left:104.69px;top:443.34px" class="cls_004"><span class="cls_004">has its partners on a short leash!), all attached documents will be automatically</span></div>
<div style="position:absolute;left:104.69px;top:455.94px" class="cls_004"><span class="cls_004">considered as approved. Drag and drop </span><span class="cls_013">TimerBoundaryEvent</span><span class="cls_004"> to the </span><span class="cls_007">Third</span></div>
<div style="position:absolute;left:104.69px;top:469.22px" class="cls_007"><span class="cls_007">Party Review</span><span class="cls_004"> task as shown in the following figure:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 389 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:273104px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background405.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:91.32px;top:224.96px" class="cls_004"><span class="cls_004">2. Then, create a transition between the timer and the </span><span class="cls_007">Approved</span><span class="cls_004"> task:</span></div>
<div style="position:absolute;left:91.32px;top:420.80px" class="cls_004"><span class="cls_004">3. Finally, click on the timer and configure the </span><span class="cls_007">Time duration</span><span class="cls_004"> to PT10M. This is a</span></div>
<div style="position:absolute;left:104.69px;top:433.44px" class="cls_004"><span class="cls_004">duration syntax using the ISO8601 standard.</span></div>
<div style="position:absolute;left:91.32px;top:448.20px" class="cls_004"><span class="cls_004">4. Save the process, redeploy it using the Activiti Explorer, and then test.</span></div>
<div style="position:absolute;left:56.69px;top:475.92px" class="cls_004"><span class="cls_004">To test the updated process, start a workflow making sure to specify the third-party</span></div>
<div style="position:absolute;left:56.69px;top:488.52px" class="cls_004"><span class="cls_004">reviewer e-mail address to trigger the third-party review. After 10 minutes, the approve</span></div>
<div style="position:absolute;left:56.69px;top:501.12px" class="cls_004"><span class="cls_004">transition should be taken automatically.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 390 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:273780px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background406.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">If you prefer not to wait for the countdown to verify that your timer was set correctly, log in</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">to the Alfresco Administration Console, go to the Workflow Console, then type show timers</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">all,and click </span><span class="cls_007">Execute</span><span class="cls_004">. You should see a response like:</span></div>
<div style="position:absolute;left:74.69px;top:120.62px" class="cls_010"><span class="cls_010">id: activiti$7340 , name: 7340 , due date: Sun Oct 30 19:19:37 UTC 2016 ,</span></div>
<div style="position:absolute;left:74.69px;top:131.42px" class="cls_010"><span class="cls_010">path: activiti$7339 , node: thirdParty</span><span class="cls_020"> Review , process: activiti$7199</span></div>
<div style="position:absolute;left:56.69px;top:155.86px" class="cls_004"><span class="cls_004">If you don't want to use the </span><span class="cls_007">Workflow Console</span><span class="cls_004">, you can use the Activiti Explorer too by</span></div>
<div style="position:absolute;left:56.69px;top:168.50px" class="cls_004"><span class="cls_004">clicking on the </span><span class="cls_007">Jobs</span><span class="cls_004"> tab. You should notice the same timer job:</span></div>
<div style="position:absolute;left:56.69px;top:416.80px" class="cls_004"><span class="cls_004">If you select the job and click on the </span><span class="cls_007">Execute</span><span class="cls_004"> button in the top banner, the timer will be</span></div>
<div style="position:absolute;left:56.69px;top:429.44px" class="cls_004"><span class="cls_004">considered as expired and the transition to the </span><span class="cls_007">Approved</span><span class="cls_004"> task will be taken.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 391 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:274456px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background407.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Debugging workflows</span></div>
<div style="position:absolute;left:56.69px;top:107.46px" class="cls_004"><span class="cls_004">If something goes wrong or you just want to get up close and personal with the execution of</span></div>
<div style="position:absolute;left:56.69px;top:120.06px" class="cls_004"><span class="cls_004">a process, you can use the workflow console. The following table shows some common</span></div>
<div style="position:absolute;left:56.69px;top:132.66px" class="cls_004"><span class="cls_004">commands and what they do:</span></div>
<div style="position:absolute;left:60.32px;top:161.83px" class="cls_024"><span class="cls_024">Command</span></div>
<div style="position:absolute;left:258.09px;top:161.83px" class="cls_024"><span class="cls_024">What it does</span></div>
<div style="position:absolute;left:60.32px;top:180.37px" class="cls_025"><span class="cls_025">showworkflowsall</span></div>
<div style="position:absolute;left:258.09px;top:180.37px" class="cls_025"><span class="cls_025">Shows all running workflows.</span></div>
<div style="position:absolute;left:60.32px;top:198.87px" class="cls_004"><span class="cls_004">use workflow &lt;workflow id&gt;</span></div>
<div style="position:absolute;left:258.09px;top:198.88px" class="cls_025"><span class="cls_025">Makes all subsequent commands happen in the</span></div>
<div style="position:absolute;left:60.32px;top:211.47px" class="cls_004"><span class="cls_004">where &lt;workflow id&gt; is something like</span></div>
<div style="position:absolute;left:258.09px;top:210.88px" class="cls_025"><span class="cls_025">context of the specified workflow.</span></div>
<div style="position:absolute;left:60.32px;top:224.07px" class="cls_004"><span class="cls_004">activiti$7199</span></div>
<div style="position:absolute;left:60.32px;top:243.19px" class="cls_025"><span class="cls_025">show transitions</span></div>
<div style="position:absolute;left:258.09px;top:243.19px" class="cls_025"><span class="cls_025">Shows all leaving transitions for the current</span></div>
<div style="position:absolute;left:258.09px;top:255.19px" class="cls_025"><span class="cls_025">workflow.</span></div>
<div style="position:absolute;left:60.32px;top:273.69px" class="cls_004"><span class="cls_004">signal &lt;path id&gt;&lt;transition&gt;</span></div>
<div style="position:absolute;left:258.09px;top:273.70px" class="cls_025"><span class="cls_025">Signals the token. Good when your workflow is</span></div>
<div style="position:absolute;left:60.32px;top:286.29px" class="cls_004"><span class="cls_004">where&lt;path id&gt; is something like</span></div>
<div style="position:absolute;left:258.09px;top:285.70px" class="cls_025"><span class="cls_025">stuck on a node or when you want to take a</span></div>
<div style="position:absolute;left:60.32px;top:298.89px" class="cls_004"><span class="cls_004">activiti$71 and &lt;transition&gt; is the name</span></div>
<div style="position:absolute;left:258.09px;top:297.70px" class="cls_025"><span class="cls_025">transition without going through the task</span></div>
<div style="position:absolute;left:60.32px;top:311.49px" class="cls_004"><span class="cls_004">of the leaving transition you want to</span></div>
<div style="position:absolute;left:258.09px;top:309.70px" class="cls_025"><span class="cls_025">management UI.</span></div>
<div style="position:absolute;left:60.32px;top:324.09px" class="cls_004"><span class="cls_004">take. Leave off the transition to take the</span></div>
<div style="position:absolute;left:60.32px;top:336.69px" class="cls_004"><span class="cls_004">default.</span></div>
<div style="position:absolute;left:60.32px;top:355.80px" class="cls_004"><span class="cls_004">desc path &lt;path id&gt;</span></div>
<div style="position:absolute;left:258.09px;top:355.81px" class="cls_025"><span class="cls_025">Dumps the current context. Great for debugging</span></div>
<div style="position:absolute;left:60.32px;top:368.40px" class="cls_004"><span class="cls_004">where &lt;path id&gt; is something like</span></div>
<div style="position:absolute;left:258.09px;top:367.81px" class="cls_025"><span class="cls_025">process variables.</span></div>
<div style="position:absolute;left:60.32px;top:381.00px" class="cls_004"><span class="cls_004">activiti$71</span></div>
<div style="position:absolute;left:60.32px;top:400.12px" class="cls_025"><span class="cls_025">end workflow &lt;workflow id&gt;</span></div>
<div style="position:absolute;left:258.09px;top:400.12px" class="cls_025"><span class="cls_025">Cancels the specified workflow.</span></div>
<div style="position:absolute;left:60.32px;top:418.63px" class="cls_025"><span class="cls_025">show definitions all</span></div>
<div style="position:absolute;left:258.09px;top:418.63px" class="cls_025"><span class="cls_025">Shows the current deployed workflow definitions.</span></div>
<div style="position:absolute;left:60.32px;top:437.13px" class="cls_004"><span class="cls_004">undeploy definition &lt;workflow id&gt; or</span></div>
<div style="position:absolute;left:258.09px;top:437.14px" class="cls_025"><span class="cls_025">Undeploys the specified workflow and stops any</span></div>
<div style="position:absolute;left:60.32px;top:449.73px" class="cls_004"><span class="cls_004">undeploy definition name &lt;workflow</span></div>
<div style="position:absolute;left:258.09px;top:449.14px" class="cls_025"><span class="cls_025">workflows running with that definition. The</span></div>
<div style="position:absolute;left:60.32px;top:462.33px" class="cls_004"><span class="cls_004">name&gt;</span></div>
<div style="position:absolute;left:258.09px;top:461.14px" class="cls_025"><span class="cls_025">&lt;workflow id&gt; variant undeploys a specific</span></div>
<div style="position:absolute;left:258.09px;top:473.14px" class="cls_025"><span class="cls_025">version of</span></div>
<div style="position:absolute;left:258.09px;top:485.14px" class="cls_025"><span class="cls_025">a workflow.</span></div>
<div style="position:absolute;left:56.69px;top:513.72px" class="cls_004"><span class="cls_004">These are a subset of the commands available. Type </span><span class="cls_007">help</span><span class="cls_004"> and click </span><span class="cls_007">Submit</span><span class="cls_004"> to see the full</span></div>
<div style="position:absolute;left:56.69px;top:526.36px" class="cls_004"><span class="cls_004">list of commands.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 392 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:275132px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background408.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Other debug aids include using </span><span class="cls_013">logger.log</span><span class="cls_004"> statements in Alfresco JavaScript actions (with</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_013"><span class="cls_013">log4j.logger.org.alfresco.repo.jscript</span><span class="cls_004"> set to </span><span class="cls_013">DEBUG</span><span class="cls_004">). You can as well just use</span></div>
<div style="position:absolute;left:56.69px;top:97.06px" class="cls_004"><span class="cls_004">logger.warm and you won't have to change the log level.</span></div>
<div style="position:absolute;left:56.69px;top:122.63px" class="cls_004"><span class="cls_004">As mentioned in </span><span class="cls_010">Chapter 2</span><span class="cls_004">,</span><span class="cls_012"> Getting Started with Alfresco</span><span class="cls_004">, the Eclipse remote debugger is</span></div>
<div style="position:absolute;left:56.69px;top:135.61px" class="cls_004"><span class="cls_004">very helpful when trying to troubleshoot Java-based nodes and Java-based listeners.</span></div>
<div style="position:absolute;left:56.69px;top:173.28px" class="cls_008"><span class="cls_008">Comparing Alfresco workflow options</span></div>
<div style="position:absolute;left:56.69px;top:211.09px" class="cls_004"><span class="cls_004">You have now seen how Alfresco leverages the embedded Activiti engine to provide</span></div>
<div style="position:absolute;left:56.69px;top:223.69px" class="cls_004"><span class="cls_004">advanced workflow capability. Let's take a look at how advanced workflows compare to</span></div>
<div style="position:absolute;left:56.69px;top:236.29px" class="cls_004"><span class="cls_004">simple workflows, so you can make good decisions about which one is more appropriate in</span></div>
<div style="position:absolute;left:56.69px;top:248.89px" class="cls_004"><span class="cls_004">a given situation.</span></div>
<div style="position:absolute;left:56.69px;top:274.45px" class="cls_004"><span class="cls_004">Simple workflows are nice end-user tools. Simple workflows use folders and a </span><span class="cls_022">“</span><span class="cls_004">forward</span></div>
<div style="position:absolute;left:56.69px;top:287.88px" class="cls_004"><span class="cls_004">step/backward step</span><span class="cls_022">”</span><span class="cls_004"> model to implement serial processes. When a piece of content is</span></div>
<div style="position:absolute;left:56.69px;top:301.31px" class="cls_004"><span class="cls_004">dropped in a folder, a rule is triggered that associates a forward step and a backward step</span></div>
<div style="position:absolute;left:56.69px;top:313.91px" class="cls_004"><span class="cls_004">(one or the other or both) with the content. These steps are tied to Alfresco actions such as</span></div>
<div style="position:absolute;left:56.69px;top:326.51px" class="cls_007"><span class="cls_007">Set a property</span><span class="cls_004"> or </span><span class="cls_007">Move the content to a specified folder</span><span class="cls_004">. End users can then click on the</span></div>
<div style="position:absolute;left:56.69px;top:339.14px" class="cls_004"><span class="cls_004">appropriate step for a given piece of content.</span></div>
<div style="position:absolute;left:56.69px;top:364.70px" class="cls_004"><span class="cls_004">For example, suppose there are requirements for a simple submit-review-approve process</span></div>
<div style="position:absolute;left:56.69px;top:377.30px" class="cls_004"><span class="cls_004">in which content is submitted, then reviewed, and then approved or rejected. One way to</span></div>
<div style="position:absolute;left:56.69px;top:389.90px" class="cls_004"><span class="cls_004">implement this with simple workflows is to use three folders. Let's say they are called</span></div>
<div style="position:absolute;left:56.69px;top:402.50px" class="cls_007"><span class="cls_007">Draft</span><span class="cls_004">, </span><span class="cls_007">In Review</span><span class="cls_004">, and </span><span class="cls_007">Approved</span><span class="cls_004">, each of which has a rule set that applies a simple</span></div>
<div style="position:absolute;left:56.69px;top:415.14px" class="cls_004"><span class="cls_004">workflow. The workflow for content in the </span><span class="cls_007">Draft</span><span class="cls_004"> folder would have a single forward step</span></div>
<div style="position:absolute;left:56.69px;top:427.78px" class="cls_004"><span class="cls_004">labeled </span><span class="cls_007">Submit</span><span class="cls_004">, and its action would move content to the </span><span class="cls_007">In Review</span><span class="cls_004"> folder and send an e-</span></div>
<div style="position:absolute;left:56.69px;top:440.41px" class="cls_004"><span class="cls_004">mail to the approver group. The </span><span class="cls_007">In Review</span><span class="cls_004"> folder would have a workflow in which the</span></div>
<div style="position:absolute;left:56.69px;top:453.05px" class="cls_004"><span class="cls_004">forward step would be labeled </span><span class="cls_007">Approve</span><span class="cls_004">, and it would copy the content to an </span><span class="cls_007">Approved</span></div>
<div style="position:absolute;left:56.69px;top:465.69px" class="cls_004"><span class="cls_004">folder. The backward step would be labeled </span><span class="cls_007">Reject</span><span class="cls_004">, and its action would move the content</span></div>
<div style="position:absolute;left:56.69px;top:478.32px" class="cls_004"><span class="cls_004">back to the </span><span class="cls_007">Drafts</span><span class="cls_004"> folder.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 393 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:275808px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background409.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">You can see that simple workflows are useful, but limited with regard to the complexity of</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">the business processes they can handle. A summary of the differences between simple</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">workflows and advanced workflows appears in the following table:</span></div>
<div style="position:absolute;left:60.32px;top:124.87px" class="cls_024"><span class="cls_024">Alfresco simple workflows:</span></div>
<div style="position:absolute;left:260.27px;top:124.87px" class="cls_024"><span class="cls_024">Alfresco advanced workflows:</span></div>
<div style="position:absolute;left:60.32px;top:142.52px" class="cls_017"><span class="cls_017">• Are configurable by non-technical end</span></div>
<div style="position:absolute;left:260.27px;top:142.52px" class="cls_017"><span class="cls_017">• Are defined by business analysts and developers</span></div>
<div style="position:absolute;left:60.32px;top:155.72px" class="cls_017"><span class="cls_017">users via Alfresco Share</span></div>
<div style="position:absolute;left:260.27px;top:155.72px" class="cls_017"><span class="cls_017">via a graphical Eclipse plugin or by writing XML</span></div>
<div style="position:absolute;left:60.32px;top:168.92px" class="cls_017"><span class="cls_017">• Leverage rules, folders, and actions</span></div>
<div style="position:absolute;left:260.27px;top:168.92px" class="cls_017"><span class="cls_017">• Leverage the power of the embedded Activiti</span></div>
<div style="position:absolute;left:60.32px;top:182.12px" class="cls_017"><span class="cls_017">• Can only handle processes with single-step</span></div>
<div style="position:absolute;left:260.27px;top:182.12px" class="cls_017"><span class="cls_017">workflow engine</span></div>
<div style="position:absolute;left:60.32px;top:195.32px" class="cls_017"><span class="cls_017">forward and/or backward, or serial flows</span></div>
<div style="position:absolute;left:260.27px;top:195.32px" class="cls_017"><span class="cls_017">• Can model any business process including</span></div>
<div style="position:absolute;left:60.32px;top:208.52px" class="cls_017"><span class="cls_017">• Do not support decisions, splits, joins, or</span></div>
<div style="position:absolute;left:260.27px;top:208.52px" class="cls_017"><span class="cls_017">decisions, splits, joins, parallel flows,</span></div>
<div style="position:absolute;left:60.32px;top:221.72px" class="cls_017"><span class="cls_017">parallel flows</span></div>
<div style="position:absolute;left:260.27px;top:221.72px" class="cls_017"><span class="cls_017">subprocesses, wait states, and timers</span></div>
<div style="position:absolute;left:60.32px;top:234.92px" class="cls_017"><span class="cls_017">• Do not maintain state or metadata about</span></div>
<div style="position:absolute;left:260.27px;top:234.92px" class="cls_017"><span class="cls_017">• Can include business logic written either in</span></div>
<div style="position:absolute;left:60.32px;top:248.12px" class="cls_017"><span class="cls_017">the process (you could achieve that using</span></div>
<div style="position:absolute;left:260.27px;top:248.12px" class="cls_017"><span class="cls_017">JavaScript or Java, either of which can access the</span></div>
<div style="position:absolute;left:60.32px;top:261.32px" class="cls_017"><span class="cls_017">rules and properties, but you'll split the</span></div>
<div style="position:absolute;left:260.27px;top:261.32px" class="cls_017"><span class="cls_017">Alfresco API (you could simulate that in simple</span></div>
<div style="position:absolute;left:60.32px;top:274.52px" class="cls_017"><span class="cls_017">logic in different places)</span></div>
<div style="position:absolute;left:260.27px;top:274.52px" class="cls_017"><span class="cls_017">workflows by adding rules on folders)</span></div>
<div style="position:absolute;left:260.27px;top:287.72px" class="cls_017"><span class="cls_017">• Maintain state and process variables (metadata)</span></div>
<div style="position:absolute;left:260.27px;top:300.92px" class="cls_017"><span class="cls_017">about the process</span></div>
<div style="position:absolute;left:56.69px;top:331.59px" class="cls_004"><span class="cls_004">At the end of the day, simple workflow can be used when you only need to run one</span></div>
<div style="position:absolute;left:56.69px;top:344.19px" class="cls_004"><span class="cls_004">workflow on a node at a time and the flow has very little complexity. As the complexity of</span></div>
<div style="position:absolute;left:56.69px;top:356.79px" class="cls_004"><span class="cls_004">the process increases the pressure to move to the more full featured BPMN Activiti Engine.</span></div>
<div style="position:absolute;left:56.69px;top:394.46px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:432.27px" class="cls_004"><span class="cls_004">In this chapter, you learned the following:</span></div>
<div style="position:absolute;left:104.69px;top:457.83px" class="cls_004"><span class="cls_004">A workflow is a business process and Alfresco embeds the Activiti workflow</span></div>
<div style="position:absolute;left:104.69px;top:470.43px" class="cls_004"><span class="cls_004">engine to execute advanced workflows.</span></div>
<div style="position:absolute;left:104.69px;top:485.19px" class="cls_004"><span class="cls_004">Business process definitions can be created using a text editor or the Activiti</span></div>
<div style="position:absolute;left:104.69px;top:497.79px" class="cls_004"><span class="cls_004">Designer.</span></div>
<div style="position:absolute;left:104.69px;top:512.55px" class="cls_004"><span class="cls_004">Logic can be added to workflows using expressions, JavaScript, and Java.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 394 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:276484px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background410.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Advanced Workflow</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Workflows are well suited to long-running processes and can include</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">asynchronous steps triggered by external programs. In the example, you used the</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">ActivitiRuntimeService, Alfresco web scripts, and actions to implement a process</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">involving non-Alfresco users via e-mail.</span></div>
<div style="position:absolute;left:104.69px;top:123.06px" class="cls_004"><span class="cls_004">Timers can be added to a process using relative or absolute dates. Alfresco's</span></div>
<div style="position:absolute;left:104.69px;top:135.66px" class="cls_004"><span class="cls_004">workflow console and Activiti Explorer are handy debugging tools.</span></div>
<div style="position:absolute;left:104.69px;top:150.42px" class="cls_004"><span class="cls_004">Alfresco's simple workflows are configurable by end users but aren't as powerful</span></div>
<div style="position:absolute;left:104.69px;top:163.02px" class="cls_004"><span class="cls_004">or flexible as advanced workflows.</span></div>
<div style="position:absolute;left:56.69px;top:190.74px" class="cls_004"><span class="cls_004">When setting up an advanced workflow for the first time, there are a lot of steps involved</span></div>
<div style="position:absolute;left:56.69px;top:203.34px" class="cls_004"><span class="cls_004">because you have to do all the work from mapping the process to custom workflow types.</span></div>
<div style="position:absolute;left:56.69px;top:215.94px" class="cls_004"><span class="cls_004">Once the model and Share configuration are in place, additional development iterations on</span></div>
<div style="position:absolute;left:56.69px;top:228.54px" class="cls_004"><span class="cls_004">the process tend to move quickly.</span></div>
<div style="position:absolute;left:56.69px;top:254.10px" class="cls_004"><span class="cls_004">The following summarizes the advanced workflow implementation steps:</span></div>
<div style="position:absolute;left:91.32px;top:279.66px" class="cls_004"><span class="cls_004">1. Model the process using the Activiti Designer. Just get the process right-don't</span></div>
<div style="position:absolute;left:104.69px;top:292.26px" class="cls_004"><span class="cls_004">worry about node names, listeners, or actions just yet.</span></div>
<div style="position:absolute;left:91.32px;top:307.02px" class="cls_004"><span class="cls_004">2. Add tasks, conditions, and any other necessary assignment logic.</span></div>
<div style="position:absolute;left:91.32px;top:321.78px" class="cls_004"><span class="cls_004">3. Define a workflow content model. If you use a new content model file, remember</span></div>
<div style="position:absolute;left:104.69px;top:334.38px" class="cls_004"><span class="cls_004">to update the custom </span><span class="cls_013">model-context.xml</span><span class="cls_004"> file to point to the new content model</span></div>
<div style="position:absolute;left:104.69px;top:347.66px" class="cls_004"><span class="cls_004">definition XML file.</span></div>
<div style="position:absolute;left:91.32px;top:362.42px" class="cls_004"><span class="cls_004">4. Update </span><span class="cls_013">share-config-custom.xml</span><span class="cls_004"> to expose workflow tasks to Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:375.70px" class="cls_004"><span class="cls_004">Share.</span></div>
<div style="position:absolute;left:91.32px;top:390.46px" class="cls_004"><span class="cls_004">5. Create or update a workflow-specific properties file to externalize the strings in</span></div>
<div style="position:absolute;left:104.69px;top:403.06px" class="cls_004"><span class="cls_004">both the workflow model and the process definition.</span></div>
<div style="position:absolute;left:91.32px;top:417.82px" class="cls_004"><span class="cls_004">6. Add logic to gateways, listeners, and transitions using expressions, Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:430.42px" class="cls_004"><span class="cls_004">JavaScript, or Java classes.</span></div>
<div style="position:absolute;left:91.32px;top:445.18px" class="cls_004"><span class="cls_004">7. Deploy the process definition using either the Activiti Explorer or by copying the</span></div>
<div style="position:absolute;left:104.69px;top:457.78px" class="cls_004"><span class="cls_004">process definition to your module and deploying with a Spring bean</span></div>
<div style="position:absolute;left:104.69px;top:470.38px" class="cls_004"><span class="cls_004">configuration file.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 395 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:277160px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background411.jpg" width="541" height="666"></div>
<div style="position:absolute;left:434.72px;top:61.31px" class="cls_021"><span class="cls_021">9</span></div>
<div style="position:absolute;left:212.95px;top:167.48px" class="cls_011"><span class="cls_011">Amazing Extensions</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">In this chapter, we are going to cover some extensions, as well as configuration that will</span></div>
<div style="position:absolute;left:56.69px;top:239.07px" class="cls_004"><span class="cls_004">show you some amazing capabilities of the Alfresco platform. Be aware that some of them</span></div>
<div style="position:absolute;left:56.69px;top:251.67px" class="cls_004"><span class="cls_004">are only available in Alfresco Enterprise. We won't go very deeply into each item, because</span></div>
<div style="position:absolute;left:56.69px;top:264.27px" class="cls_004"><span class="cls_004">we just want to open your eyes to Alfresco and let you imagine what you can achieve using</span></div>
<div style="position:absolute;left:56.69px;top:276.87px" class="cls_004"><span class="cls_004">it.</span></div>
<div style="position:absolute;left:56.69px;top:298.47px" class="cls_004"><span class="cls_004">Specifically, in this chapter you will learn:</span></div>
<div style="position:absolute;left:104.69px;top:320.20px" class="cls_004"><span class="cls_004">What the Search Manager is and how you can configure the search result screen</span></div>
<div style="position:absolute;left:104.69px;top:332.80px" class="cls_004"><span class="cls_004">by adding your own metadata</span></div>
<div style="position:absolute;left:104.69px;top:347.56px" class="cls_004"><span class="cls_004">How to use and to configure Smart Folders</span></div>
<div style="position:absolute;left:104.69px;top:362.32px" class="cls_004"><span class="cls_004">Discover the different methods provided by Alfresco to create your own mobile</span></div>
<div style="position:absolute;left:104.69px;top:374.92px" class="cls_004"><span class="cls_004">application</span></div>
<div style="position:absolute;left:104.69px;top:389.68px" class="cls_004"><span class="cls_004">Create your first application with Appcelerator</span></div>
<div style="position:absolute;left:56.69px;top:430.72px" class="cls_008"><span class="cls_008">Configure and use the search manager</span></div>
<div style="position:absolute;left:56.69px;top:458.45px" class="cls_004"><span class="cls_004">If you do a search in Alfresco Share, using the top right search bar or using the advanced</span></div>
<div style="position:absolute;left:56.69px;top:471.05px" class="cls_004"><span class="cls_004">search page, you'll land into the same result page. If you take a look, the search result page</span></div>
<div style="position:absolute;left:56.69px;top:483.65px" class="cls_004"><span class="cls_004">displays a left panel with facets. If you click on a value, the list of results will be filtered. By</span></div>
<div style="position:absolute;left:56.69px;top:496.25px" class="cls_004"><span class="cls_004">default, this page allows you to filter on:</span></div>
<div style="position:absolute;left:104.69px;top:517.98px" class="cls_004"><span class="cls_004">Creator</span></div>
<div style="position:absolute;left:104.69px;top:532.74px" class="cls_004"><span class="cls_004">File Type</span></div>
<div style="position:absolute;left:104.69px;top:547.50px" class="cls_004"><span class="cls_004">Creation Date</span></div>
<div style="position:absolute;left:104.69px;top:562.26px" class="cls_004"><span class="cls_004">File Size</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:277836px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background412.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Modifier</span></div>
<div style="position:absolute;left:104.69px;top:85.26px" class="cls_004"><span class="cls_004">Modification Date</span></div>
<div style="position:absolute;left:122.09px;top:109.15px" class="cls_004"><span class="cls_004">What's faceted search? Faceted search, also called faceted navigation or</span></div>
<div style="position:absolute;left:122.09px;top:121.75px" class="cls_004"><span class="cls_004">faceted browsing, is a technique for accessing information organized</span></div>
<div style="position:absolute;left:122.09px;top:134.35px" class="cls_004"><span class="cls_004">according to a faceted classification system, allowing users to explore a</span></div>
<div style="position:absolute;left:122.09px;top:146.95px" class="cls_004"><span class="cls_004">collection of information by applying multiple filters. A faceted</span></div>
<div style="position:absolute;left:122.09px;top:159.55px" class="cls_004"><span class="cls_004">classification system classifies each information element along multiple</span></div>
<div style="position:absolute;left:122.09px;top:172.15px" class="cls_004"><span class="cls_004">explicit dimensions, called facets, enabling the classifications to be</span></div>
<div style="position:absolute;left:122.09px;top:184.75px" class="cls_004"><span class="cls_004">accessed and ordered in multiple ways rather than in a single, pre-</span></div>
<div style="position:absolute;left:122.09px;top:197.35px" class="cls_004"><span class="cls_004">determined, taxonomic order. (Source:</span></div>
<div style="position:absolute;left:122.09px;top:209.95px" class="cls_010"><span class="cls_010"> </span><a href="https://en.wikipedia.org/wiki/Faceted_search">https://en.wikipedia.org/wiki/Faceted_search</a> <span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:231.93px" class="cls_004"><span class="cls_004">Be aware that you can add facets based on your custom content model. If you look at your</span></div>
<div style="position:absolute;left:56.69px;top:244.53px" class="cls_004"><span class="cls_004">SomeCo content model, in the </span><span class="cls_013">sc:marketingDoc</span><span class="cls_004"> type, we defined a property called</span></div>
<div style="position:absolute;left:56.69px;top:257.81px" class="cls_013"><span class="cls_013">sc:campaign</span><span class="cls_004">, limited by the value constraint </span><span class="cls_013">sc:campaignList</span><span class="cls_004">. As we may have already</span></div>
<div style="position:absolute;left:56.69px;top:271.09px" class="cls_004"><span class="cls_004">discussed, using a constraint to define the campaign list is maybe not the best idea. If you</span></div>
<div style="position:absolute;left:56.69px;top:283.69px" class="cls_004"><span class="cls_004">need to add a new campaign, you'll need to change your content model, repackage your</span></div>
<div style="position:absolute;left:56.69px;top:296.29px" class="cls_004"><span class="cls_004">module, and redeploy. But it will be enough for our use case.</span></div>
<div style="position:absolute;left:91.32px;top:318.02px" class="cls_004"><span class="cls_004">1. First, we need to change our SomeCo content model to change the indexing of</span></div>
<div style="position:absolute;left:104.69px;top:330.62px" class="cls_004"><span class="cls_004">this property. By default, string values are tokenized and then indexed. We won't</span></div>
<div style="position:absolute;left:104.69px;top:343.22px" class="cls_004"><span class="cls_004">go into too much detail. For our use case, we want to have a filter listing the</span></div>
<div style="position:absolute;left:104.69px;top:355.82px" class="cls_004"><span class="cls_004">complete values, and not partial words. Open your custom content model,</span></div>
<div style="position:absolute;left:104.69px;top:368.42px" class="cls_013"><span class="cls_013">scModel.xml</span><span class="cls_004"> and locate the </span><span class="cls_013">sc:campaignproperty</span><span class="cls_004">. Replace the definition</span></div>
<div style="position:absolute;left:104.69px;top:381.70px" class="cls_004"><span class="cls_004">with this one (where we specify that we don't want to tokenize the value):</span></div>
<div style="position:absolute;left:117.89px;top:404.91px" class="cls_010"><span class="cls_010">&lt;property name="sc:campaign"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:415.71px" class="cls_010"><span class="cls_010">&lt;type&gt;d:text&lt;/type&gt;</span></div>
<div style="position:absolute;left:128.69px;top:426.51px" class="cls_010"><span class="cls_010">&lt;multiple&gt;true&lt;/multiple&gt;</span></div>
<div style="position:absolute;left:128.69px;top:437.31px" class="cls_010"><span class="cls_010">&lt;index enabled="true"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:448.11px" class="cls_010"><span class="cls_010">&lt;atomic&gt;true&lt;/atomic&gt;</span></div>
<div style="position:absolute;left:150.29px;top:458.91px" class="cls_010"><span class="cls_010">&lt;stored&gt;false&lt;/stored&gt;</span></div>
<div style="position:absolute;left:150.29px;top:469.71px" class="cls_010"><span class="cls_010">&lt;tokenised&gt;false&lt;/tokenised&gt;</span></div>
<div style="position:absolute;left:150.29px;top:480.51px" class="cls_010"><span class="cls_010">&lt;facetable&gt;true&lt;/facetable&gt;</span></div>
<div style="position:absolute;left:128.69px;top:491.31px" class="cls_010"><span class="cls_010">&lt;/index&gt;</span></div>
<div style="position:absolute;left:128.69px;top:502.11px" class="cls_010"><span class="cls_010">&lt;constraints&gt;</span></div>
<div style="position:absolute;left:150.29px;top:512.91px" class="cls_010"><span class="cls_010">&lt;constraint ref="sc:campaignList" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:523.71px" class="cls_010"><span class="cls_010">&lt;/constraints&gt;</span></div>
<div style="position:absolute;left:117.89px;top:534.51px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 397 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:278512px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background413.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">This kind of change has to be done very carefully. We are changing the way</span></div>
<div style="position:absolute;left:124.19px;top:83.10px" class="cls_004"><span class="cls_004">how this property is going to be indexed. If you already have your project in</span></div>
<div style="position:absolute;left:124.19px;top:95.70px" class="cls_004"><span class="cls_004">production, you need to clearly understand the impact of this change. In our</span></div>
<div style="position:absolute;left:124.19px;top:108.30px" class="cls_004"><span class="cls_004">case, we don't really care because we are still in the development phase.</span></div>
<div style="position:absolute;left:91.32px;top:130.03px" class="cls_004"><span class="cls_004">2. Stop Alfresco, package, and redeploy, but don't restart yet.</span></div>
<div style="position:absolute;left:91.32px;top:144.79px" class="cls_004"><span class="cls_004">3. We just changed the indexing configuration. So, we need to re-index the</span></div>
<div style="position:absolute;left:104.69px;top:157.39px" class="cls_004"><span class="cls_004">document already indexed. First, we are going to delete the indexes. Login to</span></div>
<div style="position:absolute;left:104.69px;top:169.99px" class="cls_004"><span class="cls_004">your console and execute the following command:</span></div>
<div style="position:absolute;left:117.89px;top:193.20px" class="cls_010"><span class="cls_010">rm -rf /opt/alfresco-one/alf_data/solr4/index</span></div>
<div style="position:absolute;left:91.32px;top:213.81px" class="cls_004"><span class="cls_004">4. Then, we are going to delete the copy of the model that Solr is storing. It will</span></div>
<div style="position:absolute;left:104.69px;top:226.41px" class="cls_004"><span class="cls_004">force Solr to refresh its list of models:</span></div>
<div style="position:absolute;left:117.89px;top:249.62px" class="cls_010"><span class="cls_010">rm -rf /opt/alfresco-one/alf_data/solr4/model/*.xml</span></div>
<div style="position:absolute;left:91.32px;top:270.23px" class="cls_004"><span class="cls_004">5. Restart Alfresco.</span></div>
<div style="position:absolute;left:91.32px;top:284.99px" class="cls_004"><span class="cls_004">6. Login to Alfresco Share as </span><span class="cls_007">Search Manager</span><span class="cls_004">. By default, the user </span><span class="cls_013">admin</span><span class="cls_004"> is a search</span></div>
<div style="position:absolute;left:104.69px;top:298.27px" class="cls_004"><span class="cls_004">manager. If you want to give this role to other users, add them to the</span></div>
<div style="position:absolute;left:104.69px;top:310.87px" class="cls_013"><span class="cls_013">ALFRESCO_SEARCH_ADMINISTRATORS</span><span class="cls_004"> populate the form with the group.</span></div>
<div style="position:absolute;left:91.32px;top:326.31px" class="cls_004"><span class="cls_004">7. Type the </span><span class="cls_013">*</span><span class="cls_004"> character in the search field in the top banner, and then </span><span class="cls_007">Enter</span><span class="cls_004">. You</span></div>
<div style="position:absolute;left:104.69px;top:339.59px" class="cls_004"><span class="cls_004">will be redirected to the search result page.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 398 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:279188px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background414.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">8. Click on </span><span class="cls_007">Search Manager</span><span class="cls_004">. You should have access to the following page:</span></div>
<div style="position:absolute;left:91.32px;top:414.72px" class="cls_004"><span class="cls_004">9. Click on </span><span class="cls_007">Create New Filter</span><span class="cls_004"> and populate the form with the following values:</span></div>
<div style="position:absolute;left:104.69px;top:438.65px" class="cls_007"><span class="cls_007">Filter ID</span><span class="cls_004">: </span><span class="cls_013">filter_campaign</span></div>
<div style="position:absolute;left:104.69px;top:454.09px" class="cls_007"><span class="cls_007">Filter Name</span><span class="cls_004">: </span><span class="cls_013">Campaign</span></div>
<div style="position:absolute;left:104.69px;top:469.53px" class="cls_007"><span class="cls_007">Filter Property</span><span class="cls_004">: </span><span class="cls_013">sc:campaign</span></div>
<div style="position:absolute;left:104.69px;top:484.97px" class="cls_007"><span class="cls_007">Filter Availability</span><span class="cls_004">: </span><span class="cls_013">Marketing site</span></div>
<div style="position:absolute;left:122.09px;top:509.53px" class="cls_007"><span class="cls_007">Filter Availability</span><span class="cls_004">: </span><span class="cls_013">Marketing site</span><span class="cls_004"> is optional. We assume that all our</span></div>
<div style="position:absolute;left:122.09px;top:522.82px" class="cls_004"><span class="cls_004">Marketing documents are in the Marketing site, so we don't want to</span></div>
<div style="position:absolute;left:122.09px;top:535.41px" class="cls_004"><span class="cls_004">display this filter to the Operation team.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 399 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:279864px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background415.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10. Then, click on the upward triangle to the left of our new facet repeatedly until it</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">is the top item.</span></div>
<div style="position:absolute;left:86.07px;top:97.86px" class="cls_004"><span class="cls_004">11. To be able to test, open the Marketing site, type something in the search field, and</span></div>
<div style="position:absolute;left:104.69px;top:110.46px" class="cls_004"><span class="cls_004">type on </span><span class="cls_007">Enter</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:125.26px" class="cls_004"><span class="cls_004">12. When the search results page appears, you should see the </span><span class="cls_007">Campaign</span><span class="cls_004"> filter at the</span></div>
<div style="position:absolute;left:104.69px;top:137.90px" class="cls_004"><span class="cls_004">top of the list as shown below:</span></div>
<div style="position:absolute;left:56.69px;top:476.83px" class="cls_004"><span class="cls_004">Facet searches are very appreciated by users. It really helps to find the relevant documents</span></div>
<div style="position:absolute;left:56.69px;top:489.43px" class="cls_004"><span class="cls_004">using a combination of full text search (or advanced search) and multiple filters. As you can</span></div>
<div style="position:absolute;left:56.69px;top:502.03px" class="cls_004"><span class="cls_004">see, this configuration is extremely easy to apply.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 400 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:280540px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background416.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Configure and use the Smart Folders</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">Alfresco provides a way to do smart virtual classification. </span><span class="cls_007">Smart Folders</span><span class="cls_004"> organize all your</span></div>
<div style="position:absolute;left:56.69px;top:110.02px" class="cls_004"><span class="cls_004">documents and folders to be able to view them based on types, properties, or document</span></div>
<div style="position:absolute;left:56.69px;top:122.62px" class="cls_004"><span class="cls_004">type. Smart Folders are bundled as a core element of Alfresco, so there is no need to install</span></div>
<div style="position:absolute;left:56.69px;top:135.22px" class="cls_004"><span class="cls_004">any separate AMP in your instance. Using Smart Folders in this way helps you to manage</span></div>
<div style="position:absolute;left:56.69px;top:147.82px" class="cls_004"><span class="cls_004">your information; for example, where you have a number of sources of information in a</span></div>
<div style="position:absolute;left:56.69px;top:160.42px" class="cls_004"><span class="cls_004">variety of folders. Content that might be related to, but not directly involved in your work is</span></div>
<div style="position:absolute;left:56.69px;top:173.02px" class="cls_004"><span class="cls_004">also retrieved, depending on the search criteria. Let's discover some terms that you need for</span></div>
<div style="position:absolute;left:56.69px;top:185.62px" class="cls_004"><span class="cls_004">fully understanding how it works:</span></div>
<div style="position:absolute;left:104.69px;top:207.35px" class="cls_007"><span class="cls_007">Filing rule</span><span class="cls_004">: Defined in a Smart Folder template and defines in which physical</span></div>
<div style="position:absolute;left:104.69px;top:219.99px" class="cls_004"><span class="cls_004">folder a document will be moved when a user attempts to upload a document to</span></div>
<div style="position:absolute;left:104.69px;top:232.59px" class="cls_004"><span class="cls_004">a Smart Folder. The rule specifies the type and aspects to apply with all relevant</span></div>
<div style="position:absolute;left:104.69px;top:245.19px" class="cls_004"><span class="cls_004">property values as well.</span></div>
<div style="position:absolute;left:104.69px;top:259.95px" class="cls_007"><span class="cls_007">Smart Folder</span><span class="cls_004">: Displays the result of a search query using the same view as the</span></div>
<div style="position:absolute;left:104.69px;top:272.58px" class="cls_004"><span class="cls_004">traditional browse capabilities. A smart folder can contain child smart folders.</span></div>
<div style="position:absolute;left:104.69px;top:287.34px" class="cls_007"><span class="cls_007">Smart Folder Template</span><span class="cls_004">: A JSON file stored in the Alfresco repository in the</span></div>
<div style="position:absolute;left:104.69px;top:299.98px" class="cls_013"><span class="cls_013">Repository</span><span class="cls_004"> | </span><span class="cls_013">DataDictionary</span><span class="cls_004"> | </span><span class="cls_013">Smart Folder Templates</span><span class="cls_004"> folder.</span></div>
<div style="position:absolute;left:56.69px;top:324.55px" class="cls_004"><span class="cls_004">Let's jump to the configuration and see what we can do.</span></div>
<div style="position:absolute;left:91.32px;top:346.28px" class="cls_004"><span class="cls_004">1. Even if this mechanism is included in Alfresco out-of-the-box, it's disabled by</span></div>
<div style="position:absolute;left:104.69px;top:358.88px" class="cls_004"><span class="cls_004">default. Stop Alfresco, and edit your </span><span class="cls_013">alfresco-global.properties</span><span class="cls_004"> file</span></div>
<div style="position:absolute;left:104.69px;top:372.16px" class="cls_004"><span class="cls_004">located in the </span><span class="cls_013">opt</span><span class="cls_004"> | </span><span class="cls_013">alfresco-one</span><span class="cls_004"> | </span><span class="cls_013">tomcat</span><span class="cls_004"> | </span><span class="cls_013">shared</span><span class="cls_004"> | </span><span class="cls_013">classes </span><span class="cls_004">folder and</span></div>
<div style="position:absolute;left:104.69px;top:385.44px" class="cls_004"><span class="cls_004">change the property called </span><span class="cls_013">smart.folders.enabled</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:409.33px" class="cls_010"><span class="cls_010">smart.folders.enabled=true</span></div>
<div style="position:absolute;left:91.32px;top:429.94px" class="cls_004"><span class="cls_004">2. Restart Alfresco, login to </span><span class="cls_007">Alfresco Share</span><span class="cls_004"> and upload some documents using</span></div>
<div style="position:absolute;left:104.69px;top:442.58px" class="cls_004"><span class="cls_004">different file types.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 401 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:281216px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background417.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Let's add some categories to some documents. To do that for a few documents,</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">click on the </span><span class="cls_007">Manage Aspects </span><span class="cls_004">action and add the </span><span class="cls_007">Classifiable</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_007"><span class="cls_007">(cm:generalclassifiable)</span><span class="cls_004"> aspect. When it's done, click on </span><span class="cls_007">Edit Properties</span><span class="cls_004">. You</span></div>
<div style="position:absolute;left:104.69px;top:108.38px" class="cls_004"><span class="cls_004">should now be able to link your document with the out-of-the-box categories</span></div>
<div style="position:absolute;left:104.69px;top:120.98px" class="cls_004"><span class="cls_004">bundled in Alfresco:</span></div>
<div style="position:absolute;left:91.32px;top:336.16px" class="cls_004"><span class="cls_004">4. Finally, add the tag </span><span class="cls_007">Confidential</span><span class="cls_004"> to some documents as well. Then, your</span></div>
<div style="position:absolute;left:104.69px;top:348.79px" class="cls_004"><span class="cls_004">documents should look like this one after having attached categories and tags:</span></div>
<div style="position:absolute;left:91.32px;top:461.97px" class="cls_004"><span class="cls_004">5. Click on </span><span class="cls_007">My Files</span><span class="cls_004"> in the top banner, create a folder called </span><span class="cls_007">Documents</span><span class="cls_004">, click on</span></div>
<div style="position:absolute;left:104.69px;top:474.61px" class="cls_007"><span class="cls_007">Manage Aspects</span><span class="cls_004"> and add the </span><span class="cls_007">System Smart Folder</span></div>
<div style="position:absolute;left:104.69px;top:487.25px" class="cls_007"><span class="cls_007">(smf:systemConfigSmartFolder) </span><span class="cls_004">aspect.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 402 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:281892px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background418.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. Now, you need to attach this folder to a </span><span class="cls_007">Smart Folder Template</span><span class="cls_004">. For the moment,</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">we are going to use the only default one provided by Alfresco. On the newly</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">created folder, click on </span><span class="cls_007">Edit Properties</span><span class="cls_004">, click on </span><span class="cls_007">All Properties</span><span class="cls_028">…</span><span class="cls_007"> </span><span class="cls_004">Be sure that you</span></div>
<div style="position:absolute;left:104.69px;top:109.17px" class="cls_004"><span class="cls_004">select the </span><span class="cls_013">smartFoldersExample.json </span><span class="cls_004">file in the </span><span class="cls_007">Smart Folder Template </span><span class="cls_004">field:</span></div>
<div style="position:absolute;left:91.32px;top:381.28px" class="cls_004"><span class="cls_004">7. Open the </span><span class="cls_007">Documents </span><span class="cls_004">folder, you should see a sub-folder called </span><span class="cls_007">My Content</span><span class="cls_004">. This</span></div>
<div style="position:absolute;left:104.69px;top:393.92px" class="cls_004"><span class="cls_004">is a </span><span class="cls_007">Smart Folder</span><span class="cls_004"> and you can confirm it because the icon contains a magnifying</span></div>
<div style="position:absolute;left:104.69px;top:406.55px" class="cls_004"><span class="cls_004">glass. If you expand this folder, you'll see the full hierarchy:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 403 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:282568px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background419.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:368.21px" class="cls_004"><span class="cls_004">8. I'm not going to explain the goal of each folder because the folder names are quite</span></div>
<div style="position:absolute;left:104.69px;top:380.81px" class="cls_004"><span class="cls_004">self-explanatory. So, let's open the </span><span class="cls_013">smartFoldersExample.json</span><span class="cls_004"> file stored in</span></div>
<div style="position:absolute;left:104.69px;top:394.09px" class="cls_004"><span class="cls_004">the </span><span class="cls_013">Data Dictionary</span><span class="cls_004"> | </span><span class="cls_013">Smart Folder Templates</span><span class="cls_004"> repository folder. The first</span></div>
<div style="position:absolute;left:104.69px;top:407.37px" class="cls_004"><span class="cls_004">thing that you notice is that you can define a strong hierarchy not based on any</span></div>
<div style="position:absolute;left:104.69px;top:419.97px" class="cls_004"><span class="cls_004">query:</span></div>
<div style="position:absolute;left:117.89px;top:443.18px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:453.98px" class="cls_010"><span class="cls_010">"name": "Virtual Folders Example",</span></div>
<div style="position:absolute;left:128.69px;top:464.78px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:139.49px;top:475.58px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:486.38px" class="cls_010"><span class="cls_010">"id": "1",</span></div>
<div style="position:absolute;left:150.29px;top:497.18px" class="cls_010"><span class="cls_010">"name": "My content",</span></div>
<div style="position:absolute;left:150.29px;top:507.98px" class="cls_010"><span class="cls_010">"description": "My files in this repository",</span></div>
<div style="position:absolute;left:150.29px;top:518.78px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:161.09px;top:529.58px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:171.89px;top:540.38px" class="cls_010"><span class="cls_010">"id": "11",</span></div>
<div style="position:absolute;left:171.89px;top:551.18px" class="cls_010"><span class="cls_010">"name": "All site content",</span></div>
<div style="position:absolute;left:171.89px;top:561.98px" class="cls_010"><span class="cls_010">"description":</span></div>
<div style="position:absolute;left:182.69px;top:572.78px" class="cls_010"><span class="cls_010">"My files in all sites by file &amp; media-type</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 404 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:283244px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background420.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:193.49px;top:69.82px" class="cls_010"><span class="cls_010">- no upload",</span></div>
<div style="position:absolute;left:171.89px;top:80.62px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:182.69px;top:91.42px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:193.49px;top:102.22px" class="cls_010"><span class="cls_010">"id": "111",</span></div>
<div style="position:absolute;left:193.49px;top:113.02px" class="cls_010"><span class="cls_010">"name": "Documents",</span></div>
<div style="position:absolute;left:193.49px;top:123.82px" class="cls_010"><span class="cls_010">"description": "My documents by mimetype",</span></div>
<div style="position:absolute;left:193.49px;top:134.62px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:193.49px;top:156.22px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:182.69px;top:167.02px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:182.69px;top:177.82px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:193.49px;top:188.62px" class="cls_010"><span class="cls_010">"id": "112",</span></div>
<div style="position:absolute;left:193.49px;top:199.42px" class="cls_010"><span class="cls_010">"name": "Multimedia Files",</span></div>
<div style="position:absolute;left:193.49px;top:210.22px" class="cls_010"><span class="cls_010">"description": "My media files by mediatype",</span></div>
<div style="position:absolute;left:193.49px;top:221.02px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:193.49px;top:242.62px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:182.69px;top:253.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:171.89px;top:264.22px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:161.09px;top:275.02px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:161.09px;top:285.82px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:171.89px;top:296.62px" class="cls_010"><span class="cls_010">"id": "12",</span></div>
<div style="position:absolute;left:171.89px;top:307.42px" class="cls_010"><span class="cls_010">"name": "This folder's content",</span></div>
<div style="position:absolute;left:171.89px;top:318.22px" class="cls_010"><span class="cls_010">"description":</span></div>
<div style="position:absolute;left:182.69px;top:329.02px" class="cls_010"><span class="cls_010">"My files in this site or folder tree by file</span></div>
<div style="position:absolute;left:182.69px;top:339.82px" class="cls_010"><span class="cls_010">&amp; media-type - no upload",</span></div>
<div style="position:absolute;left:171.89px;top:350.62px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:182.69px;top:361.42px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:193.49px;top:372.22px" class="cls_010"><span class="cls_010">"id": "121",</span></div>
<div style="position:absolute;left:193.49px;top:383.02px" class="cls_010"><span class="cls_010">"name": "Documents",</span></div>
<div style="position:absolute;left:193.49px;top:393.82px" class="cls_010"><span class="cls_010">"description": "My documents by mimetype",</span></div>
<div style="position:absolute;left:193.49px;top:404.62px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:193.49px;top:426.22px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:182.69px;top:437.02px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:182.69px;top:447.82px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:193.49px;top:458.62px" class="cls_010"><span class="cls_010">"id": "122",</span></div>
<div style="position:absolute;left:193.49px;top:469.42px" class="cls_010"><span class="cls_010">"name": "Multimedia Files",</span></div>
<div style="position:absolute;left:193.49px;top:480.22px" class="cls_010"><span class="cls_010">"description": "My media files by mediatype",</span></div>
<div style="position:absolute;left:193.49px;top:491.02px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:193.49px;top:512.62px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:182.69px;top:523.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:171.89px;top:534.22px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:161.09px;top:545.02px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:161.09px;top:555.82px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:171.89px;top:566.62px" class="cls_010"><span class="cls_010">"id": "17",</span></div>
<div style="position:absolute;left:171.89px;top:577.42px" class="cls_010"><span class="cls_010">"name": "My Categorized Files",</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 405 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:283920px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background421.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:171.89px;top:69.82px" class="cls_010"><span class="cls_010">"description":</span></div>
<div style="position:absolute;left:182.69px;top:80.62px" class="cls_010"><span class="cls_010">"My files in category or a sub category - no upload",</span></div>
<div style="position:absolute;left:171.89px;top:91.42px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:171.89px;top:113.02px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:161.09px;top:123.82px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:161.09px;top:134.62px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:171.89px;top:145.42px" class="cls_010"><span class="cls_010">"id": "18",</span></div>
<div style="position:absolute;left:171.89px;top:156.22px" class="cls_010"><span class="cls_010">"name": "Recent updates",</span></div>
<div style="position:absolute;left:171.89px;top:167.02px" class="cls_010"><span class="cls_010">"description": "Files added or updated in the</span></div>
<div style="position:absolute;left:182.69px;top:177.82px" class="cls_010"><span class="cls_010">past 7 days",</span></div>
<div style="position:absolute;left:171.89px;top:188.62px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:171.89px;top:210.22px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:161.09px;top:221.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:150.29px;top:231.82px" class="cls_010"><span class="cls_010">],</span></div>
<div style="position:absolute;left:139.49px;top:253.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:264.22px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:117.89px;top:275.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:295.63px" class="cls_004"><span class="cls_004">9. Then, let's look at a node where a query is executed. Here is the node that</span></div>
<div style="position:absolute;left:104.69px;top:308.23px" class="cls_004"><span class="cls_004">displays all Office Documents stored in sites with the current user as modifier or</span></div>
<div style="position:absolute;left:104.69px;top:320.83px" class="cls_004"><span class="cls_004">creator. You can see the use of the </span><span class="cls_013">%CURRENT_USER% </span><span class="cls_004">variable that makes the</span></div>
<div style="position:absolute;left:104.69px;top:334.11px" class="cls_004"><span class="cls_004">query dynamic for each user:</span></div>
<div style="position:absolute;left:117.89px;top:357.32px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:368.12px" class="cls_010"><span class="cls_010">"id": "1111",</span></div>
<div style="position:absolute;left:128.69px;top:378.92px" class="cls_010"><span class="cls_010">"name": "Office Documents",</span></div>
<div style="position:absolute;left:128.69px;top:389.72px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:139.49px;top:400.52px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:139.49px;top:411.32px" class="cls_010"><span class="cls_010">"query": "(PATH:'/app:company_home/st:sites//*')</span></div>
<div style="position:absolute;left:150.29px;top:422.12px" class="cls_010"><span class="cls_010">AND (=cm:content.mimetype:application/ms* OR</span></div>
<div style="position:absolute;left:171.89px;top:432.92px" class="cls_010"><span class="cls_010">=cm:content.mimetype:application/vnd.ms* OR</span></div>
<div style="position:absolute;left:171.89px;top:443.72px" class="cls_010"><span class="cls_010">=cm:content.mimetype:application/vnd.openxmlformats*)</span></div>
<div style="position:absolute;left:150.29px;top:454.52px" class="cls_010"><span class="cls_010">AND (=cm:modifier:%CURRENT_USER% OR</span></div>
<div style="position:absolute;left:166.49px;top:465.32px" class="cls_010"><span class="cls_010">=cm:creator:%CURRENT_USER%)"</span></div>
<div style="position:absolute;left:128.69px;top:476.12px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:486.92px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 406 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:284596px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background422.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10. If you tested by yourself, you can see that you have another folder called </span><span class="cls_013">Office</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_013"><span class="cls_013">Documents</span><span class="cls_004"> as a subfolder of </span><span class="cls_013">This folder's content</span><span class="cls_004">. This folder categorizes</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_004"><span class="cls_004">only documents stored in the </span><span class="cls_013">Documents</span><span class="cls_004"> folder that you created manually. Let's</span></div>
<div style="position:absolute;left:104.69px;top:110.34px" class="cls_004"><span class="cls_004">check its definition. You can seethe use of the </span><span class="cls_013">%ACTUAL_PATH%</span><span class="cls_004"> variable that</span></div>
<div style="position:absolute;left:104.69px;top:123.62px" class="cls_004"><span class="cls_004">makes the query dynamic for each folder:</span></div>
<div style="position:absolute;left:117.89px;top:146.83px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:157.63px" class="cls_010"><span class="cls_010">"id": "1211",</span></div>
<div style="position:absolute;left:128.69px;top:168.43px" class="cls_010"><span class="cls_010">"name": "Office Documents",</span></div>
<div style="position:absolute;left:128.69px;top:179.23px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:139.49px;top:190.03px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:139.49px;top:200.83px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:150.29px;top:211.63px" class="cls_010"><span class="cls_010">AND (=cm:content.mimetype:application/ms* OR</span></div>
<div style="position:absolute;left:161.09px;top:222.43px" class="cls_010"><span class="cls_010">=cm:content.mimetype:application/vnd.ms* OR</span></div>
<div style="position:absolute;left:161.09px;top:233.23px" class="cls_010"><span class="cls_010">=cm:content.mimetype:application/vnd.openxmlformats*)</span></div>
<div style="position:absolute;left:150.29px;top:244.03px" class="cls_010"><span class="cls_010">AND (=cm:modifier:%CURRENT_USER% OR</span></div>
<div style="position:absolute;left:161.09px;top:254.83px" class="cls_010"><span class="cls_010">=cm:creator:%CURRENT_USER%)"</span></div>
<div style="position:absolute;left:128.69px;top:265.63px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:276.43px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:297.04px" class="cls_004"><span class="cls_004">11. I'll let you check node with the </span><span class="cls_013">id</span><span class="cls_004"> attribute equals to </span><span class="cls_013">16</span><span class="cls_004"> by yourself to see how</span></div>
<div style="position:absolute;left:104.69px;top:310.32px" class="cls_004"><span class="cls_004">we use tags, and the nodes </span><span class="cls_013">171</span><span class="cls_004">, </span><span class="cls_013">172</span><span class="cls_004">, and </span><span class="cls_013">173</span><span class="cls_004"> to check how we use categories in</span></div>
<div style="position:absolute;left:104.69px;top:323.60px" class="cls_004"><span class="cls_004">the queries. Let's focus on node </span><span class="cls_013">181</span><span class="cls_004"> that shows the </span><span class="cls_013">Recently Created</span></div>
<div style="position:absolute;left:104.69px;top:336.88px" class="cls_004"><span class="cls_004">documents for the current user. You can see that you can do some date/time</span></div>
<div style="position:absolute;left:104.69px;top:349.48px" class="cls_004"><span class="cls_004">manipulation to make your queries dynamic:</span></div>
<div style="position:absolute;left:117.89px;top:372.69px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:383.49px" class="cls_010"><span class="cls_010">"id": "181",</span></div>
<div style="position:absolute;left:128.69px;top:394.29px" class="cls_010"><span class="cls_010">"name": "Recently created",</span></div>
<div style="position:absolute;left:128.69px;top:405.09px" class="cls_010"><span class="cls_010">"description": "Files I recently created",</span></div>
<div style="position:absolute;left:128.69px;top:415.89px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:426.69px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:437.49px" class="cls_010"><span class="cls_010">"query": "+TYPE:'cm:content'</span></div>
<div style="position:absolute;left:161.09px;top:448.29px" class="cls_010"><span class="cls_010">AND =cm:creator:%CURRENT_USER%</span></div>
<div style="position:absolute;left:161.09px;top:459.09px" class="cls_010"><span class="cls_010">AND +cm:created:[NOW/DAY-7DAYS TO NOW/DAY+1DAY]"</span></div>
<div style="position:absolute;left:128.69px;top:469.89px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:480.69px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 407 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:285272px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background423.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">12.</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Before creating our own template, let's talk about one last element. You may have</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">noticed that the upload capabilities (the upload button and the drag and drop)</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">are disabled on all smart folders in this example, except one which is </span><span class="cls_013">Documents</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">MyContent</span><span class="cls_004"> | </span><span class="cls_013">Contributions</span><span class="cls_004">. The corresponding rule is the same as the node</span></div>
<div style="position:absolute;left:104.69px;top:122.26px" class="cls_004"><span class="cls_004">executing the query but a filling rule is defined in the </span><span class="cls_013">filling</span><span class="cls_004"> object. The filling</span></div>
<div style="position:absolute;left:104.69px;top:135.54px" class="cls_004"><span class="cls_004">rule specifies where the document should be physically stored. In this case, it's</span></div>
<div style="position:absolute;left:104.69px;top:148.14px" class="cls_004"><span class="cls_004">using the </span><span class="cls_013">%ACTUAL_PATH%</span><span class="cls_004"> variable. It means that the uploaded documents will</span></div>
<div style="position:absolute;left:104.69px;top:161.42px" class="cls_004"><span class="cls_004">be stored in the </span><span class="cls_013">Documents</span><span class="cls_004"> folder. Then, we have a </span><span class="cls_013">classification</span><span class="cls_004"> object</span></div>
<div style="position:absolute;left:104.69px;top:174.70px" class="cls_004"><span class="cls_004">describing which content type and aspects should be applied to the new</span></div>
<div style="position:absolute;left:104.69px;top:187.30px" class="cls_004"><span class="cls_004">document. And finally, we have a </span><span class="cls_013">properties</span><span class="cls_004"> object listing all metadata that</span></div>
<div style="position:absolute;left:104.69px;top:200.58px" class="cls_004"><span class="cls_004">should be assigned to the new document:</span></div>
<div style="position:absolute;left:117.89px;top:223.79px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:234.59px" class="cls_010"><span class="cls_010">"id": "13",</span></div>
<div style="position:absolute;left:128.69px;top:245.39px" class="cls_010"><span class="cls_010">"name": "Contributions",</span></div>
<div style="position:absolute;left:128.69px;top:256.19px" class="cls_010"><span class="cls_010">"description": "My 'dublin core' contributions</span></div>
<div style="position:absolute;left:144.89px;top:266.99px" class="cls_010"><span class="cls_010">- add new files here to contribute",</span></div>
<div style="position:absolute;left:128.69px;top:277.79px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:139.49px;top:288.59px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:139.49px;top:299.39px" class="cls_010"><span class="cls_010">"query": "+ASPECT:'cm:dublincore'</span></div>
<div style="position:absolute;left:161.09px;top:310.19px" class="cls_010"><span class="cls_010">AND (=cm:creator:%CURRENT_USER% OR</span></div>
<div style="position:absolute;left:161.09px;top:320.99px" class="cls_010"><span class="cls_010">=cm:modifier:%CURRENT_USER%)"</span></div>
<div style="position:absolute;left:128.69px;top:331.79px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:128.69px;top:342.59px" class="cls_010"><span class="cls_010">"filing": {</span></div>
<div style="position:absolute;left:139.49px;top:353.39px" class="cls_010"><span class="cls_010">"path": "%ACTUAL_PATH%",</span></div>
<div style="position:absolute;left:139.49px;top:364.19px" class="cls_010"><span class="cls_010">"classification": {</span></div>
<div style="position:absolute;left:171.89px;top:374.99px" class="cls_010"><span class="cls_010">"type": "cm:content",</span></div>
<div style="position:absolute;left:171.89px;top:385.79px" class="cls_010"><span class="cls_010">"aspects": [</span></div>
<div style="position:absolute;left:182.69px;top:396.59px" class="cls_010"><span class="cls_010">"cm:dublincore"</span></div>
<div style="position:absolute;left:171.89px;top:407.39px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:161.09px;top:418.19px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:428.99px" class="cls_010"><span class="cls_010">"properties": {</span></div>
<div style="position:absolute;left:171.89px;top:439.79px" class="cls_010"><span class="cls_010">"cm:contributor": "%CURRENT_USER%",</span></div>
<div style="position:absolute;left:171.89px;top:450.59px" class="cls_010"><span class="cls_010">"cm:rights": "Alfresco",</span></div>
<div style="position:absolute;left:171.89px;top:461.39px" class="cls_010"><span class="cls_010">"cm:publisher": "Alfresco"</span></div>
<div style="position:absolute;left:139.49px;top:472.19px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:482.99px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:493.79px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 408 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:285948px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background424.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">If you upload a document and you check the properties, you'll see the</span></div>
<div style="position:absolute;left:124.19px;top:83.10px" class="cls_004"><span class="cls_004">properties dynamically assigned:</span></div>
<div style="position:absolute;left:56.69px;top:336.72px" class="cls_014"><span class="cls_014">Step-by-step - create your own Smart Folder</span></div>
<div style="position:absolute;left:56.69px;top:358.32px" class="cls_014"><span class="cls_014">template</span></div>
<div style="position:absolute;left:56.69px;top:383.54px" class="cls_004"><span class="cls_004">If you remember, all SomeCo Marketing documents can be attached to one or more</span></div>
<div style="position:absolute;left:56.69px;top:396.14px" class="cls_004"><span class="cls_004">campaign, and the SomeCo whitepaper type inherits from this content type. Then, we</span></div>
<div style="position:absolute;left:56.69px;top:408.74px" class="cls_004"><span class="cls_004">worked on making whitepaper active or not, with a publication date. Finally, we worked on</span></div>
<div style="position:absolute;left:56.69px;top:421.34px" class="cls_004"><span class="cls_004">whitepaper ratings. We are going to use all those elements to create a custom Smart Folder</span></div>
<div style="position:absolute;left:56.69px;top:433.94px" class="cls_004"><span class="cls_004">Template.</span></div>
<div style="position:absolute;left:91.32px;top:455.67px" class="cls_004"><span class="cls_004">1. Create a file called </span><span class="cls_013">SomeCoWhitepapers.json</span><span class="cls_004">. You can create it anywhere,</span></div>
<div style="position:absolute;left:104.69px;top:468.95px" class="cls_004"><span class="cls_004">because we'll upload it later in the repository. We created a copy of it in the </span><span class="cls_013">repo</span></div>
<div style="position:absolute;left:104.69px;top:482.23px" class="cls_004"><span class="cls_004">| </span><span class="cls_013">src</span><span class="cls_004"> | </span><span class="cls_013">main</span><span class="cls_004"> | </span><span class="cls_013">amp</span><span class="cls_004"> | </span><span class="cls_013">config</span><span class="cls_004"> | </span><span class="cls_013">alfrescp</span><span class="cls_004"> | </span><span class="cls_013">module</span><span class="cls_004"> | </span><span class="cls_013">repo</span><span class="cls_004"> | </span><span class="cls_013">resources</span><span class="cls_004"> folder.</span></div>
<div style="position:absolute;left:104.69px;top:495.51px" class="cls_004"><span class="cls_004">Let's start with the main structure:</span></div>
<div style="position:absolute;left:117.89px;top:518.72px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:139.49px;top:529.52px" class="cls_010"><span class="cls_010">"name": "SomeCo Marketing Virtual Folders",</span></div>
<div style="position:absolute;left:139.49px;top:540.32px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:139.49px;top:551.12px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:117.89px;top:561.92px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 409 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:286624px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background425.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. For the next steps, we'll add all virtual folders to the </span><span class="cls_013">nodes</span><span class="cls_004"> array. The first one</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">will just list all whitepapers in the containing folder:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:117.79px" class="cls_010"><span class="cls_010">"id": "1",</span></div>
<div style="position:absolute;left:128.69px;top:128.59px" class="cls_010"><span class="cls_010">"name": "All Whitepapers",</span></div>
<div style="position:absolute;left:128.69px;top:139.39px" class="cls_010"><span class="cls_010">"description": "List all whitepapers in this folder",</span></div>
<div style="position:absolute;left:128.69px;top:150.19px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:139.49px;top:160.99px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:139.49px;top:171.79px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*') AND TYPE:'sc:whitepaper'"</span></div>
<div style="position:absolute;left:128.69px;top:182.59px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:193.39px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:91.32px;top:214.00px" class="cls_004"><span class="cls_004">3.</span></div>
<div style="position:absolute;left:104.69px;top:214.00px" class="cls_004"><span class="cls_004">Then, we'll create a folder called </span><span class="cls_013">By Campaign</span><span class="cls_004"> and create a subnode for each</span></div>
<div style="position:absolute;left:104.69px;top:227.28px" class="cls_004"><span class="cls_004">campaign listed in the content model:</span></div>
<div style="position:absolute;left:117.89px;top:250.49px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:261.29px" class="cls_010"><span class="cls_010">"id": "2",</span></div>
<div style="position:absolute;left:128.69px;top:272.09px" class="cls_010"><span class="cls_010">"name": "By Campaign",</span></div>
<div style="position:absolute;left:128.69px;top:282.89px" class="cls_010"><span class="cls_010">"description": "Whitepapers by campaign",</span></div>
<div style="position:absolute;left:128.69px;top:293.69px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:139.49px;top:304.49px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:315.29px" class="cls_010"><span class="cls_010">"id": "21",</span></div>
<div style="position:absolute;left:150.29px;top:326.09px" class="cls_010"><span class="cls_010">"name": "Application Syndication",</span></div>
<div style="position:absolute;left:150.29px;top:336.89px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:347.69px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:358.49px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:369.29px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:380.09px" class="cls_010"><span class="cls_010">AND sc:campaign:'Application Syndication'"</span></div>
<div style="position:absolute;left:150.29px;top:390.89px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:401.69px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:412.49px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:423.29px" class="cls_010"><span class="cls_010">"id": "22",</span></div>
<div style="position:absolute;left:150.29px;top:434.09px" class="cls_010"><span class="cls_010">"name": "Private Event Retailing",</span></div>
<div style="position:absolute;left:150.29px;top:444.89px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:455.69px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:466.49px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:477.29px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:488.09px" class="cls_010"><span class="cls_010">AND sc:campaign:'Private Event Retailing'"</span></div>
<div style="position:absolute;left:150.29px;top:498.89px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:509.69px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:520.49px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:531.29px" class="cls_010"><span class="cls_010">"id": "23",</span></div>
<div style="position:absolute;left:150.29px;top:542.09px" class="cls_010"><span class="cls_010">"name": "Social Shopping",</span></div>
<div style="position:absolute;left:150.29px;top:552.89px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:563.69px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:574.49px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 410 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:287300px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background426.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:80.62px" class="cls_010"><span class="cls_010">AND sc:campaign:'Social Shopping'"</span></div>
<div style="position:absolute;left:150.29px;top:91.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:113.02px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:91.32px;top:144.43px" class="cls_004"><span class="cls_004">4. The following folder is to find whitepapers by status:</span></div>
<div style="position:absolute;left:117.89px;top:167.64px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:178.44px" class="cls_010"><span class="cls_010">"id": "3",</span></div>
<div style="position:absolute;left:128.69px;top:189.24px" class="cls_010"><span class="cls_010">"name": "By Status",</span></div>
<div style="position:absolute;left:128.69px;top:200.04px" class="cls_010"><span class="cls_010">"description": "Whitepapers by status",</span></div>
<div style="position:absolute;left:128.69px;top:210.84px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:139.49px;top:221.64px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:232.44px" class="cls_010"><span class="cls_010">"id": "31",</span></div>
<div style="position:absolute;left:150.29px;top:243.24px" class="cls_010"><span class="cls_010">"name": "Published",</span></div>
<div style="position:absolute;left:150.29px;top:254.04px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:264.84px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:275.64px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:286.44px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper' AND sc:isActive:true"</span></div>
<div style="position:absolute;left:150.29px;top:297.24px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:308.04px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:318.84px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:329.64px" class="cls_010"><span class="cls_010">"id": "32",</span></div>
<div style="position:absolute;left:150.29px;top:340.44px" class="cls_010"><span class="cls_010">"name": "Not Published",</span></div>
<div style="position:absolute;left:150.29px;top:351.24px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:362.04px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:372.84px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:182.69px;top:383.64px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:182.69px;top:394.44px" class="cls_010"><span class="cls_010">AND ( sc:isActive:false OR ISNULL:'sc:isActive' )"</span></div>
<div style="position:absolute;left:150.29px;top:405.24px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:416.04px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:426.84px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:117.89px;top:437.64px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:91.32px;top:458.25px" class="cls_004"><span class="cls_004">5. As we discovered in the default example in Alfresco, we can use filters on dates.</span></div>
<div style="position:absolute;left:104.69px;top:470.85px" class="cls_004"><span class="cls_004">We'll use that to create filters on the publication date:</span></div>
<div style="position:absolute;left:117.89px;top:494.06px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:504.86px" class="cls_010"><span class="cls_010">"id": "4",</span></div>
<div style="position:absolute;left:128.69px;top:515.66px" class="cls_010"><span class="cls_010">"name": "By Publication Date",</span></div>
<div style="position:absolute;left:128.69px;top:526.46px" class="cls_010"><span class="cls_010">"description": "Whitepapers by publication date",</span></div>
<div style="position:absolute;left:128.69px;top:537.26px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:139.49px;top:548.06px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:558.86px" class="cls_010"><span class="cls_010">"id": "41",</span></div>
<div style="position:absolute;left:150.29px;top:569.66px" class="cls_010"><span class="cls_010">"name": "Yesterday",</span></div>
<div style="position:absolute;left:150.29px;top:580.46px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 411 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:287976px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background427.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:80.62px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:91.42px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:102.22px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:161.09px;top:113.02px" class="cls_010"><span class="cls_010">AND sc:published:[NOW/DAY-1DAY TO NOW/DAY+1DAY]"</span></div>
<div style="position:absolute;left:150.29px;top:123.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:134.62px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:145.42px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:156.22px" class="cls_010"><span class="cls_010">"id": "42",</span></div>
<div style="position:absolute;left:150.29px;top:167.02px" class="cls_010"><span class="cls_010">"name": "Last Week",</span></div>
<div style="position:absolute;left:150.29px;top:177.82px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:188.62px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:199.42px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:210.22px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:221.02px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:161.09px;top:231.82px" class="cls_010"><span class="cls_010">AND sc:published:[NOW/DAY-7DAYS TO NOW/DAY+1DAY]"</span></div>
<div style="position:absolute;left:150.29px;top:242.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:253.42px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:264.22px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:275.02px" class="cls_010"><span class="cls_010">"id": "43",</span></div>
<div style="position:absolute;left:150.29px;top:285.82px" class="cls_010"><span class="cls_010">"name": "Last 2 Weeks",</span></div>
<div style="position:absolute;left:150.29px;top:296.62px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:307.42px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:318.22px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:329.02px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:339.82px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:161.09px;top:350.62px" class="cls_010"><span class="cls_010">AND sc:published:[NOW/DAY-14DAYS TO NOW/DAY+1DAY]"</span></div>
<div style="position:absolute;left:150.29px;top:361.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:372.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:383.02px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:117.89px;top:393.82px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:91.32px;top:414.43px" class="cls_004"><span class="cls_004">6.</span></div>
<div style="position:absolute;left:104.69px;top:414.43px" class="cls_004"><span class="cls_004">And finally, the last one is about user ratings:</span></div>
<div style="position:absolute;left:117.89px;top:437.64px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:128.69px;top:448.44px" class="cls_010"><span class="cls_010">"id": "5",</span></div>
<div style="position:absolute;left:128.69px;top:459.24px" class="cls_010"><span class="cls_010">"name": "By Rate",</span></div>
<div style="position:absolute;left:128.69px;top:470.04px" class="cls_010"><span class="cls_010">"description": "Whitepapers by rate",</span></div>
<div style="position:absolute;left:128.69px;top:480.84px" class="cls_010"><span class="cls_010">"nodes": [</span></div>
<div style="position:absolute;left:139.49px;top:491.64px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:502.44px" class="cls_010"><span class="cls_010">"id": "51",</span></div>
<div style="position:absolute;left:150.29px;top:513.24px" class="cls_010"><span class="cls_010">"name": "Between 0 and 1",</span></div>
<div style="position:absolute;left:150.29px;top:524.04px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:534.84px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:545.64px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:171.89px;top:556.44px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:171.89px;top:567.24px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:171.89px;top:578.04px" class="cls_010"><span class="cls_010">AND sc:averageRating:[0 TO 1]"</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 412 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:288652px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background428.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:150.29px;top:69.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:80.62px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:91.42px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:102.22px" class="cls_010"><span class="cls_010">"id": "52",</span></div>
<div style="position:absolute;left:150.29px;top:113.02px" class="cls_010"><span class="cls_010">"name": "Between 1 and 2",</span></div>
<div style="position:absolute;left:150.29px;top:123.82px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:134.62px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:145.42px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:171.89px;top:156.22px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:171.89px;top:167.02px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:171.89px;top:177.82px" class="cls_010"><span class="cls_010">AND sc:averageRating:[1 TO 2]"</span></div>
<div style="position:absolute;left:150.29px;top:188.62px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:199.42px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:210.22px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:221.02px" class="cls_010"><span class="cls_010">"id": "53",</span></div>
<div style="position:absolute;left:150.29px;top:231.82px" class="cls_010"><span class="cls_010">"name": "Between 2 and 3",</span></div>
<div style="position:absolute;left:150.29px;top:242.62px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:253.42px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:264.22px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:275.02px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:285.82px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:161.09px;top:296.62px" class="cls_010"><span class="cls_010">AND sc:averageRating:[2 TO 3]"</span></div>
<div style="position:absolute;left:150.29px;top:307.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:318.22px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:329.02px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:339.82px" class="cls_010"><span class="cls_010">"id": "54",</span></div>
<div style="position:absolute;left:150.29px;top:350.62px" class="cls_010"><span class="cls_010">"name": "Between 3 and 4",</span></div>
<div style="position:absolute;left:150.29px;top:361.42px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:372.22px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:383.02px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:171.89px;top:393.82px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:171.89px;top:404.62px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:171.89px;top:415.42px" class="cls_010"><span class="cls_010">AND sc:averageRating:[3 TO 4]"</span></div>
<div style="position:absolute;left:150.29px;top:426.22px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:437.02px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:139.49px;top:447.82px" class="cls_010"><span class="cls_010">{</span></div>
<div style="position:absolute;left:150.29px;top:458.62px" class="cls_010"><span class="cls_010">"id": "55",</span></div>
<div style="position:absolute;left:150.29px;top:469.42px" class="cls_010"><span class="cls_010">"name": "Between 4 and 5",</span></div>
<div style="position:absolute;left:150.29px;top:480.22px" class="cls_010"><span class="cls_010">"search": {</span></div>
<div style="position:absolute;left:161.09px;top:491.02px" class="cls_010"><span class="cls_010">"language": "fts-alfresco",</span></div>
<div style="position:absolute;left:161.09px;top:501.82px" class="cls_010"><span class="cls_010">"query": "(PATH:'%ACTUAL_PATH%//*')</span></div>
<div style="position:absolute;left:161.09px;top:512.62px" class="cls_010"><span class="cls_010">AND TYPE:'sc:whitepaper'</span></div>
<div style="position:absolute;left:161.09px;top:523.42px" class="cls_010"><span class="cls_010">AND sc:isActive:true</span></div>
<div style="position:absolute;left:161.09px;top:534.22px" class="cls_010"><span class="cls_010">AND sc:averageRating:[4 TO 5]"</span></div>
<div style="position:absolute;left:150.29px;top:545.02px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:139.49px;top:555.82px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:566.62px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:117.89px;top:577.42px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 413 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:289328px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background429.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. We are done with our JSON file and it is now complete. Upload this file in the</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">Data Dictionary</span><span class="cls_004"> | </span><span class="cls_013">Smart Folder Templates</span><span class="cls_004"> repository folder. Click on this</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">document and change the type to </span><span class="cls_007">Smart Folder Template</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:111.18px" class="cls_004"><span class="cls_004">8. I've been a bit messy and stored all my whitepapers in a folder called</span></div>
<div style="position:absolute;left:104.69px;top:123.78px" class="cls_004"><span class="cls_004">Whitepapers in my </span><span class="cls_007">Marketing</span><span class="cls_004"> site. But this is the perfect occasion to demonstrate</span></div>
<div style="position:absolute;left:104.69px;top:136.42px" class="cls_004"><span class="cls_004">the use of Smart Folders. Add the </span><span class="cls_007">System Smart Folder</span></div>
<div style="position:absolute;left:104.69px;top:149.05px" class="cls_007"><span class="cls_007">(smf:systemConfigSmartFolder)</span><span class="cls_004"> aspect to the </span><span class="cls_013">Whitepapers</span><span class="cls_004"> folder. Update</span></div>
<div style="position:absolute;left:104.69px;top:162.33px" class="cls_004"><span class="cls_004">properties and select the JSON file that we created:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 414 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:290004px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background430.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">9. Expand the folder and you should discover all virtual folders that we defined:</span></div>
<div style="position:absolute;left:86.07px;top:382.43px" class="cls_004"><span class="cls_004">10. You'll notice that all upload capabilities are disabled. It's because we didn't define</span></div>
<div style="position:absolute;left:104.69px;top:395.03px" class="cls_004"><span class="cls_004">any filling rules. The first one that we'll create is on the node with the </span><span class="cls_013">id</span><span class="cls_004"> property</span></div>
<div style="position:absolute;left:104.69px;top:408.31px" class="cls_004"><span class="cls_004">equals to </span><span class="cls_013">1</span><span class="cls_004">. The filling rule will change the type and add some aspects. This is not</span></div>
<div style="position:absolute;left:104.69px;top:421.59px" class="cls_004"><span class="cls_004">really required because we already have a rule on the folder. If you want to be</span></div>
<div style="position:absolute;left:104.69px;top:434.19px" class="cls_004"><span class="cls_004">sure that it works, you can remove these actions from the rule. The filling rule</span></div>
<div style="position:absolute;left:104.69px;top:446.79px" class="cls_004"><span class="cls_004">should look like this one and be added as a sibling of the </span><span class="cls_013">search</span><span class="cls_004"> object (don't</span></div>
<div style="position:absolute;left:104.69px;top:460.07px" class="cls_004"><span class="cls_004">forget the comma):</span></div>
<div style="position:absolute;left:117.89px;top:483.28px" class="cls_010"><span class="cls_010">"filing": {</span></div>
<div style="position:absolute;left:128.69px;top:494.08px" class="cls_010"><span class="cls_010">"path": "%ACTUAL_PATH%",</span></div>
<div style="position:absolute;left:128.69px;top:504.88px" class="cls_010"><span class="cls_010">"classification": {</span></div>
<div style="position:absolute;left:139.49px;top:515.68px" class="cls_010"><span class="cls_010">"type": "sc:whitepaper",</span></div>
<div style="position:absolute;left:139.49px;top:526.48px" class="cls_010"><span class="cls_010">"aspects": [</span></div>
<div style="position:absolute;left:171.89px;top:537.28px" class="cls_010"><span class="cls_010">"sc:webable",</span></div>
<div style="position:absolute;left:171.89px;top:548.08px" class="cls_010"><span class="cls_010">"sc:rateable"</span></div>
<div style="position:absolute;left:139.49px;top:558.88px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:128.69px;top:569.68px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:580.48px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 415 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:290680px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background431.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. Then, we are going to add a filling rule for each campaign. The only difference is</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">that we populate the </span><span class="cls_013">sc:campaign</span><span class="cls_004"> property. This is the rule for the</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_013"><span class="cls_013">Application Syndication</span><span class="cls_004">campaign:</span></div>
<div style="position:absolute;left:117.89px;top:120.27px" class="cls_010"><span class="cls_010">"filing": {</span></div>
<div style="position:absolute;left:128.69px;top:131.07px" class="cls_010"><span class="cls_010">"path": "%ACTUAL_PATH%",</span></div>
<div style="position:absolute;left:128.69px;top:141.87px" class="cls_010"><span class="cls_010">"classification": {</span></div>
<div style="position:absolute;left:139.49px;top:152.67px" class="cls_010"><span class="cls_010">"type": "sc:whitepaper",</span></div>
<div style="position:absolute;left:139.49px;top:163.47px" class="cls_010"><span class="cls_010">"aspects": [</span></div>
<div style="position:absolute;left:171.89px;top:174.27px" class="cls_010"><span class="cls_010">"sc:webable",</span></div>
<div style="position:absolute;left:171.89px;top:185.07px" class="cls_010"><span class="cls_010">"sc:rateable"</span></div>
<div style="position:absolute;left:161.09px;top:195.87px" class="cls_010"><span class="cls_010">]</span></div>
<div style="position:absolute;left:134.09px;top:206.67px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:128.69px;top:217.47px" class="cls_010"><span class="cls_010">"properties": {</span></div>
<div style="position:absolute;left:139.49px;top:228.27px" class="cls_010"><span class="cls_010">"sc:campaign": "Application Syndication"</span></div>
<div style="position:absolute;left:128.69px;top:239.07px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:249.87px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:86.07px;top:270.48px" class="cls_004"><span class="cls_004">12. Now, you should be able to add the filing rule for the other two campaigns.</span></div>
<div style="position:absolute;left:86.07px;top:285.24px" class="cls_004"><span class="cls_004">13. Save the JSON file and upload the new version in Alfresco Share.</span></div>
<div style="position:absolute;left:86.07px;top:300.00px" class="cls_004"><span class="cls_004">14. That's it. You can now test by yourself.</span></div>
<div style="position:absolute;left:56.69px;top:323.89px" class="cls_004"><span class="cls_004">Smart Folder is a very powerful tool for creating a dynamic folder hierarchy, and helps</span></div>
<div style="position:absolute;left:56.69px;top:336.49px" class="cls_004"><span class="cls_004">users find their documents more easily. Using the JSON structure, it's very easy to add or</span></div>
<div style="position:absolute;left:56.69px;top:349.09px" class="cls_004"><span class="cls_004">remove virtual folders and it's completely dynamic. Be aware that Smart Folders can use</span></div>
<div style="position:absolute;left:56.69px;top:361.69px" class="cls_004"><span class="cls_004">metadata inheritance. In our example, we defined the value of each campaign in the filing</span></div>
<div style="position:absolute;left:56.69px;top:374.29px" class="cls_004"><span class="cls_004">rule. In some use cases, you want to get the value from the physical folder (in our case the</span></div>
<div style="position:absolute;left:56.69px;top:386.89px" class="cls_004"><span class="cls_004">folder Marketing). If you are looking for more information, you can check the following</span></div>
<div style="position:absolute;left:56.69px;top:399.49px" class="cls_004"><span class="cls_004">page:</span></div>
<div style="position:absolute;left:56.69px;top:420.41px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/concepts/sf-intro.html">http://docs.alfresco.com/5.1/concepts/sf-intro.html</a> </div>
<div style="position:absolute;left:56.69px;top:458.04px" class="cls_008"><span class="cls_008">Alfresco mobile</span></div>
<div style="position:absolute;left:56.69px;top:485.77px" class="cls_004"><span class="cls_004">Accessing documents on the go becomes more and more vital for a lot of companies.</span></div>
<div style="position:absolute;left:56.69px;top:498.37px" class="cls_004"><span class="cls_004">Providing a web application is not enough anymore, assuming that employees will use their</span></div>
<div style="position:absolute;left:56.69px;top:510.97px" class="cls_004"><span class="cls_004">laptop connected to Internet. Now, we need to access information or to interact with the</span></div>
<div style="position:absolute;left:56.69px;top:523.57px" class="cls_004"><span class="cls_004">repository directly from smartphones or tablets.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 416 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:291356px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background432.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Alfresco already provides an iOS app and an Android app completely free. But some clients</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">want to customize their application completely. From the logo, or the app name, to the type</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">of documents that can be seen, or the possible actions, everything should be customizable.</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">Alfresco provides you a lot of options to achieve that:</span></div>
<div style="position:absolute;left:104.69px;top:130.03px" class="cls_007"><span class="cls_007">Alfresco Mobile SDK for Android</span><span class="cls_004">: Includes a set of APIs and samples that will</span></div>
<div style="position:absolute;left:104.69px;top:142.67px" class="cls_004"><span class="cls_004">simplify the development of your own app. Using these artifacts, you can build</span></div>
<div style="position:absolute;left:104.69px;top:155.27px" class="cls_004"><span class="cls_004">an application that connects to your Alfresco instance on-premises or Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:167.87px" class="cls_004"><span class="cls_004">Cloud.</span></div>
<div style="position:absolute;left:104.69px;top:180.47px" class="cls_004"><span class="cls_004">(</span><a href="http://docs.alfresco.com/mobile_sdk/android/concepts/mobile-sdk-android-intro.html">http://docs.alfresco.com/mobile_sdk/android/concepts/mobile-sdk-andro</a> </div>
<div style="position:absolute;left:104.69px;top:193.45px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/mobile_sdk/android/concepts/mobile-sdk-android-intro.html">id-intro.html</a> <span class="cls_004">)</span></div>
<div style="position:absolute;left:104.69px;top:208.59px" class="cls_007"><span class="cls_007">Alfresco Mobile SDK for iOS</span><span class="cls_004">: Alfresco provides the same facility if you want to</span></div>
<div style="position:absolute;left:104.69px;top:221.23px" class="cls_004"><span class="cls_004">develop an iOS application.</span></div>
<div style="position:absolute;left:104.69px;top:233.83px" class="cls_004"><span class="cls_004">(</span><a href="http://docs.alfresco.com/mobile_sdk/ios/concepts/mobile-sdk-ios-intro.html">http://docs.alfresco.com/mobile_sdk/ios/concepts/mobile-sdk-ios-intro</a> </div>
<div style="position:absolute;left:104.69px;top:246.81px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/mobile_sdk/ios/concepts/mobile-sdk-ios-intro.html">.html</a> <span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:271.08px" class="cls_004"><span class="cls_004">If you don't want to start from scratch, you can use samples provided in each SDK, but if</span></div>
<div style="position:absolute;left:56.69px;top:283.67px" class="cls_004"><span class="cls_004">you just want to make a slight change in the existing app, you can obtain the source code</span></div>
<div style="position:absolute;left:56.69px;top:296.27px" class="cls_004"><span class="cls_004">for the Android and iOS apps on GitHub:</span></div>
<div style="position:absolute;left:104.69px;top:319.51px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/Alfresco/alfresco-android-app">https://github.com/Alfresco/alfresco-android-app</a> </div>
<div style="position:absolute;left:104.69px;top:334.64px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/Alfresco/alfresco-ios-app">https://github.com/Alfresco/alfresco-ios-app</a> </div>
<div style="position:absolute;left:56.69px;top:357.41px" class="cls_004"><span class="cls_004">Finally, Alfresco provides another SDK for Appcelerator (</span><a href="http://www.appcelerator.com/">http://www.appcelerator.com/</a> <span class="cls_004">).</span></div>
<div style="position:absolute;left:56.69px;top:370.39px" class="cls_004"><span class="cls_004">This is an open source framework allowing the development of mobile applications in</span></div>
<div style="position:absolute;left:56.69px;top:382.99px" class="cls_004"><span class="cls_004">JavaScript and then package them for iOS, Android, or Windows Phone. We are going to</span></div>
<div style="position:absolute;left:56.69px;top:395.59px" class="cls_004"><span class="cls_004">use this framework in this tutorial to create our first Application.</span></div>
<div style="position:absolute;left:56.69px;top:408.19px" class="cls_004"><span class="cls_004">(</span><a href="http://docs.alfresco.com/mobile_sdk/appcelerator/concepts/mobile-sdk-appcelerator-intro.html)">http://docs.alfresco.com/mobile_sdk/appcelerator/concepts/mobile-sdk-appcelera</a> </div>
<div style="position:absolute;left:56.69px;top:420.49px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/mobile_sdk/appcelerator/concepts/mobile-sdk-appcelerator-intro.html)">tor-intro.html)</a> </div>
<div style="position:absolute;left:56.69px;top:440.97px" class="cls_004"><span class="cls_004">The next section will be based on MAC OS Sierra. It means that some screens, instructions,</span></div>
<div style="position:absolute;left:56.69px;top:453.57px" class="cls_004"><span class="cls_004">and folders may be different if you use a different OS. You'll need a Mac if you want to</span></div>
<div style="position:absolute;left:56.69px;top:466.17px" class="cls_004"><span class="cls_004">build iOS applications, if you are working on another OS, just stick to Android. If you use a</span></div>
<div style="position:absolute;left:56.69px;top:478.77px" class="cls_004"><span class="cls_004">Mac, you'll need to have Xcode installed on your computer. Refer to the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:491.37px" class="cls_004"><span class="cls_004">documentation if you have any questions by following the link above.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 417 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:292032px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background433.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - import and run the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:91.36px" class="cls_014"><span class="cls_014">Sample UI</span></div>
<div style="position:absolute;left:56.69px;top:116.58px" class="cls_004"><span class="cls_004">In this section, we are going to discover the Appcelerator development environment and</span></div>
<div style="position:absolute;left:56.69px;top:129.18px" class="cls_004"><span class="cls_004">how to configure it with the Alfresco SDK. Then, we'll import the sample application</span></div>
<div style="position:absolute;left:56.69px;top:141.78px" class="cls_004"><span class="cls_004">provided by Alfresco and run it on an iPhone.</span></div>
<div style="position:absolute;left:91.32px;top:163.51px" class="cls_004"><span class="cls_004">1. The first thing that we need to do is to download </span><span class="cls_007">Appcelerator Studio</span><span class="cls_004">. You'll</span></div>
<div style="position:absolute;left:104.69px;top:176.15px" class="cls_004"><span class="cls_004">need to sign up to Appcelerator if you don't have an account yet</span></div>
<div style="position:absolute;left:104.69px;top:188.75px" class="cls_004"><span class="cls_004">(</span><a href="http://www.appcelerator.com/signup/">http://www.appcelerator.com/signup/</a> <span class="cls_004">). When you are logged in, you should</span></div>
<div style="position:absolute;left:104.69px;top:201.73px" class="cls_004"><span class="cls_004">access this page:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 418 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:292708px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background434.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Click on </span><span class="cls_007">Appcelerator Studio IDE</span><span class="cls_004"> in the </span><span class="cls_007">Build mobile apps</span><span class="cls_004">panel. Download the</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">right version depending on your operating system.</span></div>
<div style="position:absolute;left:91.32px;top:439.32px" class="cls_004"><span class="cls_004">3. Then, follow the relevant instructions depending on your operating system:</span></div>
<div style="position:absolute;left:104.69px;top:451.24px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.appcelerator.com/platform/latest/#!/guide/Installing_Studio">http://docs.appcelerator.com/platform/latest/#!/guide/Installing_Studi</a> </div>
<div style="position:absolute;left:104.69px;top:462.04px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.appcelerator.com/platform/latest/#!/guide/Installing_Studio">o</a> </div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 419 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:293384px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background435.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. When it's installed, start </span><span class="cls_007">Appcelerator Studio</span><span class="cls_004">. Please note that the screens may be</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">slightly different if you don't use the same operating system. These instructions</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">are based on MAC OS Sierra. The first task is to decide where you want to store</span></div>
<div style="position:absolute;left:104.69px;top:108.34px" class="cls_004"><span class="cls_004">your project by selecting a workspace folder:</span></div>
<div style="position:absolute;left:91.32px;top:384.27px" class="cls_004"><span class="cls_004">5. Authenticate your Appcelerator account. Then, you'll receive an e-mail with an</span></div>
<div style="position:absolute;left:104.69px;top:396.87px" class="cls_004"><span class="cls_004">authorization code. Use this code when Appcelerator asks for it after the</span></div>
<div style="position:absolute;left:104.69px;top:409.47px" class="cls_004"><span class="cls_004">authentication.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 420 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:294060px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background436.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. At the first startup of the studio, you may have a window asking you to install</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">the </span><span class="cls_007">Titanium SDK</span><span class="cls_004">. This is required for us to be able to create our application.</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Install</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:91.32px;top:421.21px" class="cls_004"><span class="cls_004">7. When the SDK is installed, you need to download the sample project provided by</span></div>
<div style="position:absolute;left:104.69px;top:433.81px" class="cls_004"><span class="cls_004">Alfresco. Open the following URL:</span></div>
<div style="position:absolute;left:104.69px;top:446.41px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/Alfresco/alfresco-appcelerator-sdk">https://github.com/Alfresco/alfresco-appcelerator-sdk</a> <span class="cls_004">. Click on </span><span class="cls_007">Clone or</span></div>
<div style="position:absolute;left:104.69px;top:459.39px" class="cls_007"><span class="cls_007">download</span><span class="cls_004">, and then click on </span><span class="cls_007">Download ZIP</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 421 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:294736px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background437.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">8. When it's downloaded, unzip this file wherever you want. You should notice a</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">folder called </span><span class="cls_007">AlfrescoUI</span><span class="cls_004">. This is the folder that contains the sample project. Open</span></div>
<div style="position:absolute;left:104.69px;top:95.74px" class="cls_004"><span class="cls_004">Appcelerator Studio, and click on </span><span class="cls_007">File</span><span class="cls_004"> | </span><span class="cls_007">Import</span><span class="cls_004">. Then, select </span><span class="cls_007">Appcelerator</span><span class="cls_004"> |</span></div>
<div style="position:absolute;left:104.69px;top:108.38px" class="cls_007"><span class="cls_007">Existing Mobile Project</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:91.32px;top:415.84px" class="cls_004"><span class="cls_004">9. In the </span><span class="cls_007">Project directory</span><span class="cls_004"> field, look for the </span><span class="cls_007">AlfrescoUI</span><span class="cls_004"> folder that we extracted in</span></div>
<div style="position:absolute;left:104.69px;top:428.48px" class="cls_004"><span class="cls_004">the previous step. Click on </span><span class="cls_007">Finish</span><span class="cls_004">. You should have a new project in the </span><span class="cls_007">Project</span></div>
<div style="position:absolute;left:104.69px;top:441.12px" class="cls_007"><span class="cls_007">Explorer</span><span class="cls_004"> view:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 422 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:295412px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background438.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10. Before you are able to run this project, you need to install the SDK on your</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">system. Open the following URL:</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004"> </span><a href="https://github.com/alfresco/alfresco-appcelerator-sdk/releases/">https://github.com/Alfresco/alfresco-appcelerator-sdk/releases</a>, and download the</div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">SDK for Android and iOS. The current release at the time of writing is 1.2.</span></div>
<div style="position:absolute;left:104.69px;top:120.90px" class="cls_004"><span class="cls_004">Download the </span><span class="cls_013">com.alfresco.appcelerator.module.sdk-</span></div>
<div style="position:absolute;left:104.69px;top:134.18px" class="cls_013"><span class="cls_013">android-1.2.zip</span><span class="cls_004"> and </span><span class="cls_013">com.alfresco.appcelerator.module.sdk-</span></div>
<div style="position:absolute;left:104.69px;top:147.46px" class="cls_013"><span class="cls_013">iphone-1.2.zip</span><span class="cls_004"> ZIP files.</span></div>
<div style="position:absolute;left:86.07px;top:162.90px" class="cls_004"><span class="cls_004">11. After downloading these two modules, you need to install them in Appcelerator.</span></div>
<div style="position:absolute;left:104.69px;top:175.50px" class="cls_004"><span class="cls_004">Click on </span><span class="cls_007">Help</span><span class="cls_004"> | </span><span class="cls_007">Install Mobile Menu</span><span class="cls_028">…</span><span class="cls_004"> Select each ZIP file, and then</span></div>
<div style="position:absolute;left:104.69px;top:188.93px" class="cls_004"><span class="cls_004">pick</span><span class="cls_007">Titanium SDK</span><span class="cls_004"> as Output Location. Finally, click on </span><span class="cls_007">OK</span><span class="cls_004">. Follow the same</span></div>
<div style="position:absolute;left:104.69px;top:201.57px" class="cls_004"><span class="cls_004">procedures for both ZIP files.</span></div>
<div style="position:absolute;left:86.07px;top:429.50px" class="cls_004"><span class="cls_004">12. We need to define an icon for our application. Of course, you can use any icon.</span></div>
<div style="position:absolute;left:104.69px;top:442.10px" class="cls_004"><span class="cls_004">Appcelerator recommends using a 1024 x 1024 pixels image. If you have no idea,</span></div>
<div style="position:absolute;left:104.69px;top:454.70px" class="cls_004"><span class="cls_004">just go to </span><a href="https://www.iconfinder.com/">https://www.iconfinder.com/</a> <span class="cls_004">, and look for free icons or get the</span></div>
<div style="position:absolute;left:104.69px;top:467.68px" class="cls_004"><span class="cls_004">Alfresco logo</span></div>
<div style="position:absolute;left:104.69px;top:480.28px" class="cls_004"><span class="cls_004">here</span><span class="cls_022">-</span><a href="https://devproducts.alfresco.com/images/alfresco-icon.png">https://devproducts.alfresco.com/images/alfresco-icon.png</a> <span class="cls_004">. The</span></div>
<div style="position:absolute;left:104.69px;top:493.71px" class="cls_004"><span class="cls_004">maximum resolution on this website is 512 x 512 pixels. Just download a free icon</span></div>
<div style="position:absolute;left:104.69px;top:506.31px" class="cls_004"><span class="cls_004">in PNG format using the maximum resolution. Save the icon at the root of the</span></div>
<div style="position:absolute;left:104.69px;top:518.91px" class="cls_004"><span class="cls_004">project, and name it </span><span class="cls_013">DefaultIcon.png</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 423 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:296088px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background439.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">13. Now, you are ready to run the project. Right-click on the </span><span class="cls_007">AlfrescoUI</span><span class="cls_004"> project, and</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">click on </span><span class="cls_007">Run As</span><span class="cls_004">. Then, select the target platform that you want to test. We are</span></div>
<div style="position:absolute;left:104.69px;top:95.78px" class="cls_004"><span class="cls_004">selecting </span><span class="cls_007">iPhone 6</span><span class="cls_004">. You may have the following error message, if this is the case,</span></div>
<div style="position:absolute;left:104.69px;top:108.41px" class="cls_004"><span class="cls_004">start </span><span class="cls_007">XCode</span><span class="cls_004"> and accept the license.</span></div>
<div style="position:absolute;left:117.89px;top:131.66px" class="cls_010"><span class="cls_010">[ERROR] :Xcode EULA has not been accepted.</span></div>
<div style="position:absolute;left:117.89px;top:142.46px" class="cls_010"><span class="cls_010">[ERROR] :  Launch Xcode and accept the license.</span></div>
<div style="position:absolute;left:86.07px;top:163.07px" class="cls_004"><span class="cls_004">14. First, you may need to zoom out by clicking on </span><span class="cls_007">Window</span><span class="cls_004"> | </span><span class="cls_007">Scale</span><span class="cls_004">. Then, you</span></div>
<div style="position:absolute;left:104.69px;top:175.71px" class="cls_004"><span class="cls_004">should see something like this simulator:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 424 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:296764px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background440.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">15. If your Vagrant machine is up and running, click on </span><span class="cls_007">Log in</span><span class="cls_004">. You should see the</span></div>
<div style="position:absolute;left:104.69px;top:83.14px" class="cls_004"><span class="cls_004">list of folders and documents at the root of your repository:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 425 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:297440px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background441.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">16. Finally, if you browse to the folder that contains your whitepapers (for example</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">Sites</span><span class="cls_004"> | </span><span class="cls_013">marketing</span><span class="cls_004"> | </span><span class="cls_013">Whitepapers</span><span class="cls_004">). You should be able to see all your</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">documents and folders, as well as all virtual folders that we created in the</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">previous section:</span></div>
<div style="position:absolute;left:56.69px;top:411.91px" class="cls_004"><span class="cls_004">In this section, we discovered how to install Appcelerator studio, import the two SDKs</span></div>
<div style="position:absolute;left:56.69px;top:424.51px" class="cls_004"><span class="cls_004">provided by Alfresco, import the Sample UI application developed by Alfresco, and run it</span></div>
<div style="position:absolute;left:56.69px;top:437.11px" class="cls_004"><span class="cls_004">in a simulator. But we want to go a bit further than that and build our own application. Our</span></div>
<div style="position:absolute;left:56.69px;top:449.71px" class="cls_004"><span class="cls_004">application is going to be quite simple and allows everyone to access published</span></div>
<div style="position:absolute;left:56.69px;top:462.31px" class="cls_004"><span class="cls_004">whitepapers. Of course, this is not a book about Appcelerator or mobile development. We</span></div>
<div style="position:absolute;left:56.69px;top:474.91px" class="cls_004"><span class="cls_004">just want to show you how to use the </span><span class="cls_013">SearchService</span><span class="cls_004"> available in the Alfresco SDK and</span></div>
<div style="position:absolute;left:56.69px;top:488.19px" class="cls_004"><span class="cls_004">develop your own app.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 426 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:298116px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background442.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - create SomeCo mobile application</span></div>
<div style="position:absolute;left:56.69px;top:94.99px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">SampleUI</span><span class="cls_004"> application is what we call a </span><span class="cls_012">classic</span><span class="cls_004"> mobile application in the Appcelerator</span></div>
<div style="position:absolute;left:56.69px;top:108.27px" class="cls_004"><span class="cls_004">Studio. It means that the entire application is built from the JavaScript file called </span><span class="cls_013">app.js</span><span class="cls_004">. It</span></div>
<div style="position:absolute;left:56.69px;top:121.55px" class="cls_004"><span class="cls_004">contains the logic as well as the code that builds the UI. The Titanium SDK introduced a</span></div>
<div style="position:absolute;left:56.69px;top:134.15px" class="cls_004"><span class="cls_004">new framework called </span><span class="cls_007">Alloy</span><span class="cls_004">. Using it, you separate UI rendering and logic. You can build</span></div>
<div style="position:absolute;left:56.69px;top:146.79px" class="cls_004"><span class="cls_004">your UI using XML and a CSS-like syntax called TSS for style. Your JavaScript code</span></div>
<div style="position:absolute;left:56.69px;top:159.38px" class="cls_004"><span class="cls_004">contains only the logic of your application. To summarize, Alloy is a very useful framework</span></div>
<div style="position:absolute;left:56.69px;top:171.99px" class="cls_004"><span class="cls_004">for implementing a MVC (Model-View-Controller) approach. Don't forget that, even if you</span></div>
<div style="position:absolute;left:56.69px;top:184.59px" class="cls_004"><span class="cls_004">use XML and TSS, the SDK will compile everything in JavaScript, as you would do without</span></div>
<div style="position:absolute;left:56.69px;top:197.18px" class="cls_004"><span class="cls_004">using Alloy.</span></div>
<div style="position:absolute;left:91.32px;top:218.91px" class="cls_004"><span class="cls_004">1. Let's create your new project. Click on </span><span class="cls_007">File</span><span class="cls_004"> | </span><span class="cls_007">New</span><span class="cls_004"> | </span><span class="cls_007">Mobile App Project</span><span class="cls_004">. Select</span></div>
<div style="position:absolute;left:104.69px;top:231.55px" class="cls_007"><span class="cls_007">Alloy</span><span class="cls_004"> on the left side, and pick </span><span class="cls_007">Default Alloy Project</span><span class="cls_004">. Then, click on </span><span class="cls_007">Next</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 427 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:298792px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background443.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. Specify </span><span class="cls_013">SomeCoWhitepapers</span><span class="cls_004"> as </span><span class="cls_007">Project Name</span><span class="cls_004">, and </span><span class="cls_013">com.someco.whitepapers</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">for the </span><span class="cls_007">App Id</span><span class="cls_004">. Then, just leave all other options at the defaults and click on</span></div>
<div style="position:absolute;left:104.69px;top:96.42px" class="cls_007"><span class="cls_007">Finish</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 428 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:299468px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background444.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. It should open the </span><span class="cls_013">tiapp.xml</span><span class="cls_004"> file automatically. The first action is to add the</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">Alfresco SDK module in our project. In the top-right corner, you should find a</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">panel called </span><span class="cls_007">Modules</span><span class="cls_004"> containing all registered modules in this project. By</span></div>
<div style="position:absolute;left:104.69px;top:109.02px" class="cls_004"><span class="cls_004">default, there is only </span><span class="cls_013">ti.cloud</span><span class="cls_004"> module. Click on the Plus icon, and look for</span></div>
<div style="position:absolute;left:104.69px;top:122.30px" class="cls_013"><span class="cls_013">*alfresco*</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:91.32px;top:301.41px" class="cls_004"><span class="cls_004">4. Select the Alfresco SDK, click on </span><span class="cls_007">OK</span><span class="cls_004"> and save your file.</span></div>
<div style="position:absolute;left:91.32px;top:316.21px" class="cls_004"><span class="cls_004">5. Another file should be opened by default after the creation of the project called</span></div>
<div style="position:absolute;left:104.69px;top:328.81px" class="cls_013"><span class="cls_013">app</span><span class="cls_004"> | </span><span class="cls_013">views</span><span class="cls_004"> | </span><span class="cls_013">index.xml</span><span class="cls_004">. So far, it should just contain a Hello World label. We</span></div>
<div style="position:absolute;left:104.69px;top:342.08px" class="cls_004"><span class="cls_004">want to implement a list of items that contains all whitepapers. Replace the</span></div>
<div style="position:absolute;left:104.69px;top:354.68px" class="cls_004"><span class="cls_004">content with this code:</span></div>
<div style="position:absolute;left:117.89px;top:377.90px" class="cls_010"><span class="cls_010">&lt;Alloy&gt;</span></div>
<div style="position:absolute;left:128.69px;top:388.70px" class="cls_010"><span class="cls_010">&lt;Window class="container"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:399.50px" class="cls_010"><span class="cls_010">&lt;ListView id="elementsList"</span></div>
<div style="position:absolute;left:150.29px;top:410.30px" class="cls_010"><span class="cls_010">defaultItemTemplate="elementTemplate"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:421.10px" class="cls_010"><span class="cls_010">&lt;Templates&gt;</span></div>
<div style="position:absolute;left:161.09px;top:431.90px" class="cls_010"><span class="cls_010">&lt;ItemTemplate name="elementTemplate" height="80"&gt;</span></div>
<div style="position:absolute;left:171.89px;top:442.70px" class="cls_010"><span class="cls_010">&lt;View id="documentProperties"&gt;</span></div>
<div style="position:absolute;left:182.69px;top:453.50px" class="cls_010"><span class="cls_010">&lt;Label bindId="name" id="name" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:464.30px" class="cls_010"><span class="cls_010">&lt;View id="secondLine"&gt;</span></div>
<div style="position:absolute;left:193.49px;top:475.10px" class="cls_010"><span class="cls_010">&lt;Label class="line2 fieldLabel" text="Date: " /&gt;</span></div>
<div style="position:absolute;left:193.49px;top:485.90px" class="cls_010"><span class="cls_010">&lt;Label class="line2" bindId="date" id="date" /&gt;</span></div>
<div style="position:absolute;left:182.69px;top:496.70px" class="cls_010"><span class="cls_010">&lt;/View&gt;</span></div>
<div style="position:absolute;left:171.89px;top:507.50px" class="cls_010"><span class="cls_010">&lt;/View&gt;</span></div>
<div style="position:absolute;left:161.09px;top:518.30px" class="cls_010"><span class="cls_010">&lt;/ItemTemplate&gt;</span></div>
<div style="position:absolute;left:150.29px;top:529.10px" class="cls_010"><span class="cls_010">&lt;/Templates&gt;</span></div>
<div style="position:absolute;left:150.29px;top:539.90px" class="cls_010"><span class="cls_010">&lt;ListSection name="elements"&gt;&lt;/ListSection&gt;</span></div>
<div style="position:absolute;left:139.49px;top:550.70px" class="cls_010"><span class="cls_010">&lt;/ListView&gt;</span></div>
<div style="position:absolute;left:128.69px;top:561.50px" class="cls_010"><span class="cls_010">&lt;/Window&gt;</span></div>
<div style="position:absolute;left:117.89px;top:572.30px" class="cls_010"><span class="cls_010">&lt;/Alloy&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 429 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:300144px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background445.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6.</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Let's add some styling in the </span><span class="cls_013">app</span><span class="cls_004"> | </span><span class="cls_013">styles</span><span class="cls_004"> | </span><span class="cls_013">index.tss</span><span class="cls_004"> file and replace the</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">content with this code:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">".container": {</span></div>
<div style="position:absolute;left:117.89px;top:117.79px" class="cls_010"><span class="cls_010">backgroundColor: "white",</span></div>
<div style="position:absolute;left:128.69px;top:128.59px" class="cls_010"><span class="cls_010">top: 25</span></div>
<div style="position:absolute;left:117.89px;top:139.39px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:160.99px" class="cls_010"><span class="cls_010">"#documentProperties": {</span></div>
<div style="position:absolute;left:128.69px;top:171.79px" class="cls_010"><span class="cls_010">top: 0,</span></div>
<div style="position:absolute;left:128.69px;top:182.59px" class="cls_010"><span class="cls_010">left: 10,</span></div>
<div style="position:absolute;left:128.69px;top:193.39px" class="cls_010"><span class="cls_010">right: 0,</span></div>
<div style="position:absolute;left:128.69px;top:204.19px" class="cls_010"><span class="cls_010">bottom: 0,</span></div>
<div style="position:absolute;left:128.69px;top:214.99px" class="cls_010"><span class="cls_010">layout: "vertical",</span></div>
<div style="position:absolute;left:117.89px;top:225.79px" class="cls_010"><span class="cls_010">verticalAlign: Ti.UI.TEXT_VERTICAL_ALIGNMENT_CENTER</span></div>
<div style="position:absolute;left:117.89px;top:236.59px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:258.19px" class="cls_010"><span class="cls_010">"#name": {</span></div>
<div style="position:absolute;left:128.69px;top:268.99px" class="cls_010"><span class="cls_010">left: 0,</span></div>
<div style="position:absolute;left:128.69px;top:279.79px" class="cls_010"><span class="cls_010">top: 4,</span></div>
<div style="position:absolute;left:128.69px;top:290.59px" class="cls_010"><span class="cls_010">height: 55,</span></div>
<div style="position:absolute;left:128.69px;top:301.39px" class="cls_010"><span class="cls_010">color: "black",</span></div>
<div style="position:absolute;left:117.89px;top:312.19px" class="cls_010"><span class="cls_010">textAlign: Ti.UI.TEXT_ALIGNMENT_LEFT,</span></div>
<div style="position:absolute;left:128.69px;top:322.99px" class="cls_010"><span class="cls_010">font: {</span></div>
<div style="position:absolute;left:117.89px;top:333.79px" class="cls_010"><span class="cls_010">fontSize: 16</span></div>
<div style="position:absolute;left:128.69px;top:344.59px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:355.39px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:376.99px" class="cls_010"><span class="cls_010">"#secondLine": {</span></div>
<div style="position:absolute;left:128.69px;top:387.79px" class="cls_010"><span class="cls_010">left: 0,</span></div>
<div style="position:absolute;left:128.69px;top:398.59px" class="cls_010"><span class="cls_010">right: 0,</span></div>
<div style="position:absolute;left:128.69px;top:409.39px" class="cls_010"><span class="cls_010">layout: "horizontal"</span></div>
<div style="position:absolute;left:117.89px;top:420.19px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:441.79px" class="cls_010"><span class="cls_010">".fieldLabel": {</span></div>
<div style="position:absolute;left:128.69px;top:452.59px" class="cls_010"><span class="cls_010">color: "#999"</span></div>
<div style="position:absolute;left:117.89px;top:463.39px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:484.99px" class="cls_010"><span class="cls_010">".line2": {</span></div>
<div style="position:absolute;left:128.69px;top:495.79px" class="cls_010"><span class="cls_010">font: {</span></div>
<div style="position:absolute;left:139.49px;top:506.59px" class="cls_010"><span class="cls_010">fontSize: 10</span></div>
<div style="position:absolute;left:128.69px;top:517.39px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:528.19px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 430 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:300820px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background446.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. We have completed the UI design of our application. Now, we need to develop</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">our controller. Open the </span><span class="cls_013">app</span><span class="cls_004"> | </span><span class="cls_013">controllers</span><span class="cls_004"> | </span><span class="cls_013">index.js</span><span class="cls_004"> file and remove all</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">content. Then, we need to get the module, and create a session to connect to</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_004"><span class="cls_004">Alfresco. Change the properties if you want to connect to another Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:121.58px" class="cls_004"><span class="cls_004">instance:</span></div>
<div style="position:absolute;left:117.89px;top:144.79px" class="cls_010"><span class="cls_010">var SDKModule = require('com.alfresco.appcelerator.module.sdk');</span></div>
<div style="position:absolute;left:117.89px;top:155.59px" class="cls_010"><span class="cls_010">var properties = {</span></div>
<div style="position:absolute;left:128.69px;top:166.39px" class="cls_010"><span class="cls_010">serverUrl : "</span><a href="http://localhost:8080/alfresco" "="">http://localhost:8080/alfresco"</a>,</div>
<div style="position:absolute;left:128.69px;top:177.19px" class="cls_010"><span class="cls_010">serverUsername : "admin",</span></div>
<div style="position:absolute;left:128.69px;top:187.99px" class="cls_010"><span class="cls_010">serverPassword : "admin"</span></div>
<div style="position:absolute;left:117.89px;top:198.79px" class="cls_010"><span class="cls_010">};</span></div>
<div style="position:absolute;left:117.89px;top:209.59px" class="cls_010"><span class="cls_010">var repoSession = SDKModule.createRepositorySession(properties);</span></div>
<div style="position:absolute;left:91.32px;top:230.20px" class="cls_004"><span class="cls_004">8. Then, let's define the variable that will contain details about the available</span></div>
<div style="position:absolute;left:104.69px;top:242.80px" class="cls_004"><span class="cls_004">whitepapers:</span></div>
<div style="position:absolute;left:117.89px;top:266.01px" class="cls_010"><span class="cls_010">var items = [];</span></div>
<div style="position:absolute;left:91.32px;top:286.62px" class="cls_004"><span class="cls_004">9. Finally, we are creating two event listeners for when we'll create the session to</span></div>
<div style="position:absolute;left:104.69px;top:299.22px" class="cls_004"><span class="cls_004">connect to Alfresco. The error listener will just display a message to the user. The</span></div>
<div style="position:absolute;left:104.69px;top:311.82px" class="cls_004"><span class="cls_004">success listener is empty for the moment, but we'll populate it in the next step.</span></div>
<div style="position:absolute;left:104.69px;top:324.42px" class="cls_004"><span class="cls_004">Then, we connect to Alfresco and display the main UI:</span></div>
<div style="position:absolute;left:117.89px;top:347.63px" class="cls_010"><span class="cls_010">repoSession.addEventListener('error', function(e) {</span></div>
<div style="position:absolute;left:117.89px;top:358.43px" class="cls_010"><span class="cls_010">alert("ERROR: Cannot connect to server (" + e.errorcode + "): "</span></div>
<div style="position:absolute;left:123.29px;top:369.23px" class="cls_010"><span class="cls_010">+ e.errorstring);</span></div>
<div style="position:absolute;left:117.89px;top:380.03px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:117.89px;top:390.83px" class="cls_010"><span class="cls_010">repoSession.addEventListener('success', function(e) {</span></div>
<div style="position:absolute;left:117.89px;top:412.43px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:117.89px;top:423.23px" class="cls_010"><span class="cls_010">repoSession.connect();</span></div>
<div style="position:absolute;left:117.89px;top:434.03px" class="cls_010"><span class="cls_010">$.index.open();</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 431 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:301496px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background447.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10. Now, we need to populate the success event listener. The first step is to retrieve</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">the Alfresco Search service and add an error listener that will display a message:</span></div>
<div style="position:absolute;left:117.89px;top:106.31px" class="cls_010"><span class="cls_010">Ti.API.info("Connected to server: " + e.servername);</span></div>
<div style="position:absolute;left:117.89px;top:117.11px" class="cls_010"><span class="cls_010">var searchService = SDKModule.createSearchService();</span></div>
<div style="position:absolute;left:117.89px;top:127.91px" class="cls_010"><span class="cls_010">searchService.initialiseWithSession(repoSession);</span></div>
<div style="position:absolute;left:117.89px;top:138.71px" class="cls_010"><span class="cls_010">searchService.addEventListener('error', function(e) {</span></div>
<div style="position:absolute;left:128.69px;top:149.51px" class="cls_010"><span class="cls_010">alert(e.errorstring);</span></div>
<div style="position:absolute;left:117.89px;top:160.31px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:86.07px;top:180.92px" class="cls_004"><span class="cls_004">11. We need to create another listener that populates the items variable. This event</span></div>
<div style="position:absolute;left:104.69px;top:193.52px" class="cls_004"><span class="cls_004">will be called when a search is done and a new document will be found:</span></div>
<div style="position:absolute;left:117.89px;top:216.73px" class="cls_010"><span class="cls_010">searchService.addEventListener('documentnode', function(e) {</span></div>
<div style="position:absolute;left:117.89px;top:227.53px" class="cls_010"><span class="cls_010">var doc = e.document;</span></div>
<div style="position:absolute;left:117.89px;top:238.33px" class="cls_010"><span class="cls_010">items.push({</span></div>
<div style="position:absolute;left:117.89px;top:249.13px" class="cls_010"><span class="cls_010">name : {</span></div>
<div style="position:absolute;left:117.89px;top:259.93px" class="cls_010"><span class="cls_010">text : doc.name</span></div>
<div style="position:absolute;left:139.49px;top:270.73px" class="cls_010"><span class="cls_010">},</span></div>
<div style="position:absolute;left:117.89px;top:281.53px" class="cls_010"><span class="cls_010">date : {</span></div>
<div style="position:absolute;left:139.49px;top:292.33px" class="cls_010"><span class="cls_010">text :String.formatDate(doc.modifiedAt, "long")</span></div>
<div style="position:absolute;left:139.49px;top:303.13px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:313.93px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:117.89px;top:324.73px" class="cls_010"><span class="cls_010">$.elementsList.sections[0].setItems(items);</span></div>
<div style="position:absolute;left:117.89px;top:335.53px" class="cls_010"><span class="cls_010">});</span></div>
<div style="position:absolute;left:86.07px;top:356.14px" class="cls_004"><span class="cls_004">12. The final step is to actually send the query. We'll use CMIS to get all whitepapers</span></div>
<div style="position:absolute;left:104.69px;top:368.74px" class="cls_004"><span class="cls_004">with the </span><span class="cls_013">isActive</span><span class="cls_004"> property equal to </span><span class="cls_013">true</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:392.63px" class="cls_010"><span class="cls_010">var query = "SELECT * "</span></div>
<div style="position:absolute;left:128.69px;top:403.43px" class="cls_010"><span class="cls_010">+ "FROM sc:whitepaper AS wp"</span></div>
<div style="position:absolute;left:128.69px;top:414.23px" class="cls_010"><span class="cls_010">+ " JOIN sc:webable AS web"</span></div>
<div style="position:absolute;left:128.69px;top:425.03px" class="cls_010"><span class="cls_010">+ " ON wp.cmis:objectId = web.cmis:objectId"</span></div>
<div style="position:absolute;left:128.69px;top:435.83px" class="cls_010"><span class="cls_010">+ " WHERE web.sc:isActive = true";</span></div>
<div style="position:absolute;left:117.89px;top:446.63px" class="cls_010"><span class="cls_010">searchService.searchWithStatement(query);</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 432 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:302172px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background448.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">13. And you are done! Run the application in the same way as the previous section.</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">You should be able to see a similar screen to the following:</span></div>
<div style="position:absolute;left:56.69px;top:408.53px" class="cls_004"><span class="cls_004">In this section, you discovered how to create a new mobile application using the Alloy</span></div>
<div style="position:absolute;left:56.69px;top:421.13px" class="cls_004"><span class="cls_004">framework. We used the search service provided by the Alfresco SDK to execute a CMIS</span></div>
<div style="position:absolute;left:56.69px;top:433.73px" class="cls_004"><span class="cls_004">query and list all documents in a </span><span class="cls_013">ListView</span><span class="cls_004"> component. This app is very basic and could be</span></div>
<div style="position:absolute;left:56.69px;top:447.01px" class="cls_004"><span class="cls_004">greatly improved:</span></div>
<div style="position:absolute;left:104.69px;top:468.74px" class="cls_004"><span class="cls_004">By changing the displaying of documents, adding a thumbnail for each</span></div>
<div style="position:absolute;left:104.69px;top:481.34px" class="cls_004"><span class="cls_004">document, displaying the description of each document instead of the document</span></div>
<div style="position:absolute;left:104.69px;top:493.94px" class="cls_004"><span class="cls_004">name</span></div>
<div style="position:absolute;left:104.69px;top:508.70px" class="cls_004"><span class="cls_004">By adding new features like download or rate</span></div>
<div style="position:absolute;left:104.69px;top:523.46px" class="cls_004"><span class="cls_004">By displaying a new screen to add feedback on each whitepaper</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 433 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:302848px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background449.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Amazing Extensions</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">However, the goal of this section is not to build a full app from scratch but just show you</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">how to use this Alfresco SDK, and more specifically, the search service. You can download</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">the full HTML documentation at</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_010"><span class="cls_010"> </span><a href="https://github.com/Alfresco/alfresco-appcelerator-sdk/releases">https://github.com/Alfresco/alfresco-appcelerator-sdk/releases</a> <span class="cls_004"> to see all available</span></div>
<div style="position:absolute;left:56.69px;top:121.28px" class="cls_004"><span class="cls_004">services and methods provided.</span></div>
<div style="position:absolute;left:56.69px;top:160.03px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:187.76px" class="cls_004"><span class="cls_004">In this chapter, you learned how the Search Manager can be configure to customize the</span></div>
<div style="position:absolute;left:56.69px;top:200.36px" class="cls_004"><span class="cls_004">search results screen. You discover how you can add new facets based on your custom</span></div>
<div style="position:absolute;left:56.69px;top:212.96px" class="cls_004"><span class="cls_004">content model, and they can be displayed depending on the context: entire repository or</span></div>
<div style="position:absolute;left:56.69px;top:225.56px" class="cls_004"><span class="cls_004">specific site.</span></div>
<div style="position:absolute;left:56.69px;top:247.16px" class="cls_004"><span class="cls_004">Then, you discovered the concept of Smart Folders and how they can be used to create</span></div>
<div style="position:absolute;left:56.69px;top:259.76px" class="cls_004"><span class="cls_004">virtual classification based on metadata. You investigated the sample of smart folder JSON</span></div>
<div style="position:absolute;left:56.69px;top:272.36px" class="cls_004"><span class="cls_004">configuration provided by Alfresco. And then you created your own smart folder</span></div>
<div style="position:absolute;left:56.69px;top:284.96px" class="cls_004"><span class="cls_004">classification based on search queries.</span></div>
<div style="position:absolute;left:56.69px;top:306.56px" class="cls_004"><span class="cls_004">Finally, you learned that Alfresco provides you many ways to create your own mobile</span></div>
<div style="position:absolute;left:56.69px;top:319.16px" class="cls_004"><span class="cls_004">application. And you used the Appcelerator SDK to create your own application in</span></div>
<div style="position:absolute;left:56.69px;top:331.76px" class="cls_004"><span class="cls_004">JavaScript and package it for iOS.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 434 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:303524px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background450.jpg" width="541" height="666"></div>
<div style="position:absolute;left:384.72px;top:61.31px" class="cls_021"><span class="cls_021">10</span></div>
<div style="position:absolute;left:376.36px;top:167.48px" class="cls_011"><span class="cls_011">Security</span></div>
<div style="position:absolute;left:56.69px;top:226.47px" class="cls_004"><span class="cls_004">This chapter is all about security from both an authentication and an authorization</span></div>
<div style="position:absolute;left:56.69px;top:239.07px" class="cls_004"><span class="cls_004">perspective. By the end of this chapter, you'll know how to configure Alfresco to</span></div>
<div style="position:absolute;left:56.69px;top:251.67px" class="cls_004"><span class="cls_004">authenticate against LDAP, how to set up Single Sign-On (SSO), and how to work with</span></div>
<div style="position:absolute;left:56.69px;top:264.27px" class="cls_004"><span class="cls_004">Alfresco's security services. Specifically, you are going to learn how to:</span></div>
<div style="position:absolute;left:104.69px;top:286.00px" class="cls_004"><span class="cls_004">Install a basic OpenLDAP implementation</span></div>
<div style="position:absolute;left:104.69px;top:300.76px" class="cls_004"><span class="cls_004">Configure Alfresco to authenticate against LDAP, including </span><span class="cls_022">“</span><span class="cls_004">chaining</span><span class="cls_022">”</span><span class="cls_004"> LDAP</span></div>
<div style="position:absolute;left:104.69px;top:314.19px" class="cls_004"><span class="cls_004">with Alfresco authentication</span></div>
<div style="position:absolute;left:104.69px;top:328.95px" class="cls_004"><span class="cls_004">Configure LDAP synchronization</span></div>
<div style="position:absolute;left:104.69px;top:343.71px" class="cls_004"><span class="cls_004">Install and configure a popular open source SSO solution from JA-SIG</span></div>
<div style="position:absolute;left:104.69px;top:356.31px" class="cls_004"><span class="cls_004">called CAS</span></div>
<div style="position:absolute;left:104.69px;top:371.07px" class="cls_004"><span class="cls_004">Establish SSO between Alfresco and two of Tomcat's sample servlets</span></div>
<div style="position:absolute;left:104.69px;top:385.83px" class="cls_004"><span class="cls_004">Create users and groups with the Alfresco API</span></div>
<div style="position:absolute;left:104.69px;top:400.59px" class="cls_004"><span class="cls_004">Understand the out-of-the-box permissions</span></div>
<div style="position:absolute;left:104.69px;top:415.35px" class="cls_004"><span class="cls_004">Define a custom permission group or role, which you will then leverage to</span></div>
<div style="position:absolute;left:104.69px;top:427.95px" class="cls_004"><span class="cls_004">refactor how the SomeCo Web Enable/Disable links work</span></div>
<div style="position:absolute;left:56.69px;top:468.99px" class="cls_008"><span class="cls_008">Authenticating and synchronizing with LDAP</span></div>
<div style="position:absolute;left:56.69px;top:496.72px" class="cls_004"><span class="cls_004">Most production Alfresco implementations use something other than Alfresco to</span></div>
<div style="position:absolute;left:56.69px;top:509.32px" class="cls_004"><span class="cls_004">authenticate. That's because many enterprises already have a central user directory, and it</span></div>
<div style="position:absolute;left:56.69px;top:521.92px" class="cls_004"><span class="cls_004">makes a lot of sense to have Alfresco take advantage of that. There are almost as many</span></div>
<div style="position:absolute;left:56.69px;top:534.52px" class="cls_004"><span class="cls_004">different approaches to authentication as there are applications. Microsoft shops will often</span></div>
<div style="position:absolute;left:56.69px;top:547.12px" class="cls_004"><span class="cls_004">run NTLM or Kerberos authentication, both of which are supported by Alfresco. Most of</span></div>
<div style="position:absolute;left:56.69px;top:559.72px" class="cls_004"><span class="cls_004">the time, though, companies store users in one or more LDAP directories and then</span></div>
<div style="position:absolute;left:56.69px;top:572.32px" class="cls_004"><span class="cls_004">configure applications to authenticate against those directories.</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:304200px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background451.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">In this chapter, the directions refer to OpenLDAP. There are other open source LDAP</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">servers available such as Fedora Directory Server and Apache Directory. Proprietary</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">directory servers also work with Alfresco. The most common one is Microsoft Active</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">Directory, but others such as Sun ONE Directory Server and Novell eDirectory are known</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">to work with Alfresco as well.</span></div>
<div style="position:absolute;left:56.69px;top:157.60px" class="cls_014"><span class="cls_014">Step-by-step - setting up a local OpenLDAP</span></div>
<div style="position:absolute;left:56.69px;top:179.20px" class="cls_014"><span class="cls_014">server</span></div>
<div style="position:absolute;left:56.69px;top:204.42px" class="cls_004"><span class="cls_004">When testing out authentication against LDAP, you will want a local LDAP directory so</span></div>
<div style="position:absolute;left:56.69px;top:217.02px" class="cls_004"><span class="cls_004">that you can have full knowledge and control of the schema and other settings. We are</span></div>
<div style="position:absolute;left:56.69px;top:229.62px" class="cls_004"><span class="cls_004">lucky enough to be running CentOS, installing OpenLDAP is very easy.</span></div>
<div style="position:absolute;left:91.32px;top:251.35px" class="cls_004"><span class="cls_004">1. Login to your virtual machine, and authenticate as </span><span class="cls_013">root</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:275.24px" class="cls_010"><span class="cls_010">sudo su -</span></div>
<div style="position:absolute;left:91.32px;top:295.85px" class="cls_004"><span class="cls_004">2. Then, install OpenLDAP:</span></div>
<div style="position:absolute;left:117.89px;top:319.06px" class="cls_010"><span class="cls_010">yum -y install *openldap*</span></div>
<div style="position:absolute;left:91.32px;top:339.67px" class="cls_004"><span class="cls_004">3. Create the new database configuration:</span></div>
<div style="position:absolute;left:117.89px;top:362.88px" class="cls_010"><span class="cls_010">cp /usr/share/openldap-servers/DB_CONFIG.example</span></div>
<div style="position:absolute;left:139.49px;top:373.68px" class="cls_010"><span class="cls_010">/var/lib/ldap/DB_CONFIG</span></div>
<div style="position:absolute;left:139.49px;top:384.48px" class="cls_010"><span class="cls_010">chown ldap. /var/lib/ldap/DB_CONFIG</span></div>
<div style="position:absolute;left:91.32px;top:405.09px" class="cls_004"><span class="cls_004">4. Start LDAP:</span></div>
<div style="position:absolute;left:117.89px;top:428.30px" class="cls_010"><span class="cls_010">systemctl start slapd</span></div>
<div style="position:absolute;left:117.89px;top:439.10px" class="cls_010"><span class="cls_010">systemctl enable slapd</span></div>
<div style="position:absolute;left:91.32px;top:459.71px" class="cls_004"><span class="cls_004">5. Create an LDAP root password for administration purposes (in our case, I'll use</span></div>
<div style="position:absolute;left:104.69px;top:472.31px" class="cls_004"><span class="cls_004">the password </span><span class="cls_013">admin</span><span class="cls_004">):</span></div>
<div style="position:absolute;left:117.89px;top:496.20px" class="cls_010"><span class="cls_010">[root@localhost ~]# slappasswd</span></div>
<div style="position:absolute;left:117.89px;top:507.00px" class="cls_010"><span class="cls_010">New password: admin</span></div>
<div style="position:absolute;left:117.89px;top:517.80px" class="cls_010"><span class="cls_010">Re-enter new password: admin</span></div>
<div style="position:absolute;left:117.89px;top:528.60px" class="cls_010"><span class="cls_010">{SSHA}OcpQhMt6yOZHOTr5gCVH3/pWu2B8jatF</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 436 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:304876px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background452.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">6. The generated password in the previous step will be used in this step. Create a</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">file called </span><span class="cls_013">chrootpw.ldif</span><span class="cls_004"> (the location is not important) by typing:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">nano chrootpw.ldif</span></div>
<div style="position:absolute;left:91.32px;top:127.60px" class="cls_004"><span class="cls_004">7. And type the following content (replace the password in the last line with the</span></div>
<div style="position:absolute;left:104.69px;top:140.20px" class="cls_004"><span class="cls_004">value generated in the step 5):</span></div>
<div style="position:absolute;left:117.89px;top:163.41px" class="cls_010"><span class="cls_010">dn: olcDatabase={0}config,cn=config</span></div>
<div style="position:absolute;left:117.89px;top:174.21px" class="cls_010"><span class="cls_010">changetype: modify</span></div>
<div style="position:absolute;left:117.89px;top:185.01px" class="cls_010"><span class="cls_010">add: olcRootPW</span></div>
<div style="position:absolute;left:117.89px;top:195.81px" class="cls_010"><span class="cls_010">olcRootPW: {SSHA}OcpQhMt6yOZHOTr5gCVH3/pWu2B8jatF</span></div>
<div style="position:absolute;left:91.32px;top:216.43px" class="cls_004"><span class="cls_004">8. Then, save by typing </span><span class="cls_013">CTRL+X</span><span class="cls_004">, confirm by typing </span><span class="cls_013">Y</span><span class="cls_004">, and finally type on the </span><span class="cls_012">Enter</span></div>
<div style="position:absolute;left:104.69px;top:229.71px" class="cls_004"><span class="cls_004">key to validate the filename.</span></div>
<div style="position:absolute;left:91.32px;top:244.47px" class="cls_004"><span class="cls_004">9. And, finally, type the following command that will apply the current file that we</span></div>
<div style="position:absolute;left:104.69px;top:257.07px" class="cls_004"><span class="cls_004">defined above:</span></div>
<div style="position:absolute;left:117.89px;top:280.28px" class="cls_010"><span class="cls_010">ldapadd -Y EXTERNAL -H ldapi:/// -f chrootpw.ldif</span></div>
<div style="position:absolute;left:124.19px;top:300.76px" class="cls_004"><span class="cls_004">You should get these messages:</span></div>
<div style="position:absolute;left:117.89px;top:321.68px" class="cls_010"><span class="cls_010">SASL/EXTERNAL authentication started</span></div>
<div style="position:absolute;left:117.89px;top:332.48px" class="cls_010"><span class="cls_010">SASL username: gidNumber=0+uidNumber=0,</span></div>
<div style="position:absolute;left:128.69px;top:343.28px" class="cls_010"><span class="cls_010">cn=peercred,cn=external,cn=auth</span></div>
<div style="position:absolute;left:117.89px;top:354.08px" class="cls_010"><span class="cls_010">SASL SSF: 0</span></div>
<div style="position:absolute;left:117.89px;top:364.88px" class="cls_010"><span class="cls_010">modifying entry "olcDatabase={0}config,cn=config"</span></div>
<div style="position:absolute;left:86.07px;top:385.49px" class="cls_004"><span class="cls_004">10. Let's import some basic schemas provided by OpenLDAP by typing these three</span></div>
<div style="position:absolute;left:104.69px;top:398.09px" class="cls_004"><span class="cls_004">following commands:</span></div>
<div style="position:absolute;left:117.89px;top:421.30px" class="cls_010"><span class="cls_010">ldapadd -Y EXTERNAL -H ldapi:/// -f \</span></div>
<div style="position:absolute;left:117.89px;top:432.10px" class="cls_010"><span class="cls_010">/etc/openldap/schema/cosine.ldif</span></div>
<div style="position:absolute;left:117.89px;top:442.90px" class="cls_010"><span class="cls_010">ldapadd -Y EXTERNAL -H ldapi:/// -f \</span></div>
<div style="position:absolute;left:117.89px;top:453.70px" class="cls_010"><span class="cls_010">/etc/openldap/schema/nis.ldif</span></div>
<div style="position:absolute;left:117.89px;top:464.50px" class="cls_010"><span class="cls_010">ldapadd -Y EXTERNAL -H ldapi:/// -f \</span></div>
<div style="position:absolute;left:134.09px;top:475.30px" class="cls_010"><span class="cls_010">/etc/openldap/schema/inetorgperson.ldif</span></div>
<div style="position:absolute;left:124.19px;top:495.78px" class="cls_004"><span class="cls_004">The directory is now configured, but we need to create our domain for</span></div>
<div style="position:absolute;left:124.19px;top:508.38px" class="cls_004"><span class="cls_004">SomeCo. The easiest way to get things into and out of LDAP is by using LDIF</span></div>
<div style="position:absolute;left:124.19px;top:520.98px" class="cls_004"><span class="cls_004">files, as we already did in the previous steps to configure our OpenLDAP</span></div>
<div style="position:absolute;left:124.19px;top:533.58px" class="cls_004"><span class="cls_004">instance. An LDIF file is a plain-text file that follows a specific format. Once</span></div>
<div style="position:absolute;left:124.19px;top:546.18px" class="cls_004"><span class="cls_004">you create an LDIF file you can import it from the command line using</span></div>
<div style="position:absolute;left:124.19px;top:558.78px" class="cls_013"><span class="cls_013">ldapadd</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 437 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:305552px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background453.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. Let's create a new password for the LDAP domain manager (in our case, we'll use</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">secret</span><span class="cls_004">):</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">[root@localhost ~]# slappasswd</span></div>
<div style="position:absolute;left:117.89px;top:117.79px" class="cls_010"><span class="cls_010">New password: secret</span></div>
<div style="position:absolute;left:117.89px;top:128.59px" class="cls_010"><span class="cls_010">Re-enter new password: secret</span></div>
<div style="position:absolute;left:117.89px;top:139.39px" class="cls_010"><span class="cls_010">{SSHA}M4ZY3SXKeyR9W+xwB0U2dEmtvdLTZCzu</span></div>
<div style="position:absolute;left:86.07px;top:160.00px" class="cls_004"><span class="cls_004">12.</span></div>
<div style="position:absolute;left:104.69px;top:160.00px" class="cls_004"><span class="cls_004">Create a new </span><span class="cls_013">chdomain.ldif</span><span class="cls_004"> using </span><span class="cls_013">nano</span><span class="cls_004"> and write this content (be sure to</span></div>
<div style="position:absolute;left:104.69px;top:173.28px" class="cls_004"><span class="cls_004">replace the </span><span class="cls_013">olcRootPW</span><span class="cls_004"> with the value that you generated in the step above):</span></div>
<div style="position:absolute;left:117.89px;top:197.17px" class="cls_010"><span class="cls_010">dn: olcDatabase={1}monitor,cn=config</span></div>
<div style="position:absolute;left:117.89px;top:207.97px" class="cls_010"><span class="cls_010">changetype: modify</span></div>
<div style="position:absolute;left:117.89px;top:218.77px" class="cls_010"><span class="cls_010">replace: olcAccess</span></div>
<div style="position:absolute;left:117.89px;top:229.57px" class="cls_010"><span class="cls_010">olcAccess: {0}to * by dn.base="gidNumber=0+uidNumber=0,</span></div>
<div style="position:absolute;left:117.89px;top:240.37px" class="cls_010"><span class="cls_010">cn=peercred,cn=external,cn=auth"</span></div>
<div style="position:absolute;left:128.69px;top:251.17px" class="cls_010"><span class="cls_010">read by dn.base="cn=Manager,dc=someco,dc=com" read by * none</span></div>
<div style="position:absolute;left:117.89px;top:272.77px" class="cls_010"><span class="cls_010">dn: olcDatabase={2}hdb,cn=config</span></div>
<div style="position:absolute;left:117.89px;top:283.57px" class="cls_010"><span class="cls_010">changetype: modify</span></div>
<div style="position:absolute;left:117.89px;top:294.37px" class="cls_010"><span class="cls_010">replace: olcSuffix</span></div>
<div style="position:absolute;left:117.89px;top:305.17px" class="cls_010"><span class="cls_010">olcSuffix: dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:326.77px" class="cls_010"><span class="cls_010">dn: olcDatabase={2}hdb,cn=config</span></div>
<div style="position:absolute;left:117.89px;top:337.57px" class="cls_010"><span class="cls_010">changetype: modify</span></div>
<div style="position:absolute;left:117.89px;top:348.37px" class="cls_010"><span class="cls_010">replace: olcRootDN</span></div>
<div style="position:absolute;left:117.89px;top:359.17px" class="cls_010"><span class="cls_010">olcRootDN: cn=Manager,dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:380.77px" class="cls_010"><span class="cls_010">dn: olcDatabase={2}hdb,cn=config</span></div>
<div style="position:absolute;left:117.89px;top:391.57px" class="cls_010"><span class="cls_010">changetype: modify</span></div>
<div style="position:absolute;left:117.89px;top:402.37px" class="cls_010"><span class="cls_010">add: olcRootPW</span></div>
<div style="position:absolute;left:117.89px;top:413.17px" class="cls_010"><span class="cls_010">olcRootPW: {SSHA}M4ZY3SXKeyR9W+xwB0U2dEmtvdLTZCzu</span></div>
<div style="position:absolute;left:117.89px;top:434.77px" class="cls_010"><span class="cls_010">dn: olcDatabase={2}hdb,cn=config</span></div>
<div style="position:absolute;left:117.89px;top:445.57px" class="cls_010"><span class="cls_010">changetype: modify</span></div>
<div style="position:absolute;left:117.89px;top:456.37px" class="cls_010"><span class="cls_010">add: olcAccess</span></div>
<div style="position:absolute;left:117.89px;top:467.17px" class="cls_010"><span class="cls_010">olcAccess: {0}to attrs=userPassword,</span></div>
<div style="position:absolute;left:117.89px;top:477.97px" class="cls_010"><span class="cls_010">shadowLastChange by</span></div>
<div style="position:absolute;left:128.69px;top:488.77px" class="cls_010"><span class="cls_010">dn="cn=Manager,dc=someco,dc=com"</span></div>
<div style="position:absolute;left:117.89px;top:499.57px" class="cls_010"><span class="cls_010">write by anonymous auth by self write by * none</span></div>
<div style="position:absolute;left:117.89px;top:510.37px" class="cls_010"><span class="cls_010">olcAccess: {1}to dn.base="" by * read</span></div>
<div style="position:absolute;left:117.89px;top:521.17px" class="cls_010"><span class="cls_010">olcAccess: {2}to * by dn="cn=Manager,dc=someco,</span></div>
<div style="position:absolute;left:139.49px;top:531.97px" class="cls_010"><span class="cls_010">dc=com" write by * read</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 438 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:306228px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background454.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">13. Then, apply this LDIF file:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">ldapmodify -Y EXTERNAL -H ldapi:/// -f chdomain.ldif</span></div>
<div style="position:absolute;left:124.19px;top:114.19px" class="cls_004"><span class="cls_004">You should get these messages:</span></div>
<div style="position:absolute;left:117.89px;top:135.11px" class="cls_010"><span class="cls_010">SASL/EXTERNAL authentication started</span></div>
<div style="position:absolute;left:117.89px;top:145.91px" class="cls_010"><span class="cls_010">SASL username: gidNumber=0+uidNumber=0,cn=peercred,</span></div>
<div style="position:absolute;left:117.89px;top:156.71px" class="cls_010"><span class="cls_010">cn=external,cn=auth</span></div>
<div style="position:absolute;left:117.89px;top:167.51px" class="cls_010"><span class="cls_010">SASL SSF: 0</span></div>
<div style="position:absolute;left:117.89px;top:178.31px" class="cls_010"><span class="cls_010">modifying entry "olcDatabase={1}monitor,cn=config"</span></div>
<div style="position:absolute;left:117.89px;top:189.11px" class="cls_010"><span class="cls_010">modifying entry "olcDatabase={2}hdb,cn=config"</span></div>
<div style="position:absolute;left:117.89px;top:199.91px" class="cls_010"><span class="cls_010">modifying entry "olcDatabase={2}hdb,cn=config"</span></div>
<div style="position:absolute;left:117.89px;top:210.71px" class="cls_010"><span class="cls_010">modifying entry "olcDatabase={2}hdb,cn=config"</span></div>
<div style="position:absolute;left:117.89px;top:221.51px" class="cls_010"><span class="cls_010">modifying entry "olcDatabase={2}hdb,cn=config"</span></div>
<div style="position:absolute;left:56.69px;top:241.99px" class="cls_004"><span class="cls_004">We created the manager account, but it needs some data before it can be used.</span></div>
<div style="position:absolute;left:56.69px;top:254.59px" class="cls_004"><span class="cls_004">It needs:</span></div>
<div style="position:absolute;left:104.69px;top:276.32px" class="cls_004"><span class="cls_004">A root entry under which all other entries will be stored. The root entry will be</span></div>
<div style="position:absolute;left:104.69px;top:288.92px" class="cls_004"><span class="cls_004">called </span><span class="cls_013">dc=someco,dc=com</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:304.36px" class="cls_004"><span class="cls_004">A place to store SomeCo employees. It is common to call this people, so the entry</span></div>
<div style="position:absolute;left:104.69px;top:316.96px" class="cls_004"><span class="cls_004">will be named </span><span class="cls_013">ou=people,dc=someco,dc=com</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:332.40px" class="cls_004"><span class="cls_004">A place to store groups. Keeping it simple, the groups will live under an entry</span></div>
<div style="position:absolute;left:104.69px;top:345.00px" class="cls_004"><span class="cls_004">named </span><span class="cls_013">ou=groups,dc=someco,dc=com</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:369.57px" class="cls_004"><span class="cls_004">This structure isn't required for the directory to work with Alfresco-your production</span></div>
<div style="position:absolute;left:56.69px;top:382.17px" class="cls_004"><span class="cls_004">directory is probably very different. In fact, trying to wrangle a directory that has grown in</span></div>
<div style="position:absolute;left:56.69px;top:394.77px" class="cls_004"><span class="cls_004">fits and starts, over time, like an unkempt hedgerow, is where</span></div>
<div style="position:absolute;left:56.69px;top:407.37px" class="cls_004"><span class="cls_004">you'll spend most of your time getting Alfresco to work against your real-life</span></div>
<div style="position:absolute;left:56.69px;top:419.97px" class="cls_004"><span class="cls_004">LDAP directory.</span></div>
<div style="position:absolute;left:56.69px;top:441.57px" class="cls_004"><span class="cls_004">Populate the root directory entry, the people and group entries, and some test users by</span></div>
<div style="position:absolute;left:56.69px;top:454.17px" class="cls_004"><span class="cls_004">following these steps:</span></div>
<div style="position:absolute;left:91.32px;top:475.90px" class="cls_004"><span class="cls_004">1. Create an LDIF file called </span><span class="cls_013">root.ldif</span><span class="cls_004"> with the following content using the </span><span class="cls_013">nano</span></div>
<div style="position:absolute;left:104.69px;top:489.18px" class="cls_004"><span class="cls_004">command as we did before:</span></div>
<div style="position:absolute;left:117.89px;top:512.39px" class="cls_010"><span class="cls_010">dn: dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:523.19px" class="cls_010"><span class="cls_010">dc: someco</span></div>
<div style="position:absolute;left:117.89px;top:533.99px" class="cls_010"><span class="cls_010">description: Root LDAP entry for someco.com</span></div>
<div style="position:absolute;left:117.89px;top:544.79px" class="cls_010"><span class="cls_010">objectClass: dcObject</span></div>
<div style="position:absolute;left:117.89px;top:555.59px" class="cls_010"><span class="cls_010">objectClass: organizationalUnit</span></div>
<div style="position:absolute;left:117.89px;top:566.39px" class="cls_010"><span class="cls_010">ou: rootobject</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 439 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:306904px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background455.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">dn: ou=people,dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">ou: people</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">description: All people in organization</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">objectClass: organizationalUnit</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">dn: ou=groups,dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:134.62px" class="cls_010"><span class="cls_010">ou: groups</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">description: All groups in organization</span></div>
<div style="position:absolute;left:117.89px;top:156.22px" class="cls_010"><span class="cls_010">objectClass: organizationalUnit</span></div>
<div style="position:absolute;left:91.32px;top:176.83px" class="cls_004"><span class="cls_004">2. Import it into the LDAP directory using </span><span class="cls_013">ldapadd</span><span class="cls_004"> as follows:</span></div>
<div style="position:absolute;left:117.89px;top:200.72px" class="cls_010"><span class="cls_010">ldapadd -x -f root.ldif -Dcn=Manager,dc=someco,</span></div>
<div style="position:absolute;left:117.89px;top:211.52px" class="cls_010"><span class="cls_010">dc=com -wsecret</span></div>
<div style="position:absolute;left:124.19px;top:232.00px" class="cls_004"><span class="cls_004">You should get these messages:</span></div>
<div style="position:absolute;left:117.89px;top:252.92px" class="cls_010"><span class="cls_010">adding new entry "dc=someco,dc=com"</span></div>
<div style="position:absolute;left:117.89px;top:263.72px" class="cls_010"><span class="cls_010">adding new entry "ou=people,dc=someco,dc=com"</span></div>
<div style="position:absolute;left:117.89px;top:274.52px" class="cls_010"><span class="cls_010">adding new entry "ou=groups,dc=someco,dc=com"</span></div>
<div style="position:absolute;left:91.32px;top:295.13px" class="cls_004"><span class="cls_004">3. Now create a new LDIF file called </span><span class="cls_013">test-users.ldif</span><span class="cls_004"> with the following content,</span></div>
<div style="position:absolute;left:104.69px;top:308.41px" class="cls_004"><span class="cls_004">repeating (and modifying) the block to create as many test users as you want (be</span></div>
<div style="position:absolute;left:104.69px;top:321.01px" class="cls_004"><span class="cls_004">careful, you'll need to add one blank line between each block):</span></div>
<div style="position:absolute;left:117.89px;top:344.22px" class="cls_010"><span class="cls_010">dn: uid=tuser1,ou=people,dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:355.02px" class="cls_010"><span class="cls_010">cn: tuser1</span></div>
<div style="position:absolute;left:117.89px;top:365.82px" class="cls_010"><span class="cls_010">sn: User1</span></div>
<div style="position:absolute;left:117.89px;top:376.62px" class="cls_010"><span class="cls_010">givenName: Test</span></div>
<div style="position:absolute;left:117.89px;top:387.42px" class="cls_010"><span class="cls_010">objectclass: top</span></div>
<div style="position:absolute;left:117.89px;top:398.22px" class="cls_010"><span class="cls_010">objectclass: person</span></div>
<div style="position:absolute;left:117.89px;top:409.02px" class="cls_010"><span class="cls_010">objectclass: organizationalPerson</span></div>
<div style="position:absolute;left:117.89px;top:419.82px" class="cls_010"><span class="cls_010">objectclass: inetOrgPerson</span></div>
<div style="position:absolute;left:117.89px;top:430.62px" class="cls_010"><span class="cls_010">ou: People</span></div>
<div style="position:absolute;left:117.89px;top:441.42px" class="cls_010"><span class="cls_010">l: London</span></div>
<div style="position:absolute;left:117.89px;top:452.22px" class="cls_010"><span class="cls_010">uid: tuser1</span></div>
<div style="position:absolute;left:117.89px;top:463.02px" class="cls_010"><span class="cls_010">mail: tuser1@email.com</span></div>
<div style="position:absolute;left:117.89px;top:473.82px" class="cls_010"><span class="cls_010">userpassword: password</span></div>
<div style="position:absolute;left:91.32px;top:494.43px" class="cls_004"><span class="cls_004">4. Again, use </span><span class="cls_013">ldapadd</span><span class="cls_004"> to import the </span><span class="cls_013">test-users.ldif</span><span class="cls_004"> file into the directory:</span></div>
<div style="position:absolute;left:117.89px;top:518.32px" class="cls_010"><span class="cls_010">ldapadd -x -f test-users.ldif -Dcn=Manager,</span></div>
<div style="position:absolute;left:117.89px;top:529.12px" class="cls_010"><span class="cls_010">dc=someco,dc=com -wsecret</span></div>
<div style="position:absolute;left:124.19px;top:549.60px" class="cls_004"><span class="cls_004">You should get this message:</span></div>
<div style="position:absolute;left:117.89px;top:570.52px" class="cls_010"><span class="cls_010">adding new entry "uid=tuser1,ou=people,dc=someco,dc=com"</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 440 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:307580px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background456.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Now query the directory using </span><span class="cls_013">ldapsearch</span><span class="cls_004"> to verify that you can find one of</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">your test users. For example, the command to search for </span><span class="cls_013">tuser7</span><span class="cls_004"> is shown below.</span></div>
<div style="position:absolute;left:104.69px;top:97.06px" class="cls_004"><span class="cls_004">The </span><span class="cls_013">-LLL</span><span class="cls_004"> flag specifies that the results should be returned in LDIF format, which</span></div>
<div style="position:absolute;left:104.69px;top:110.34px" class="cls_004"><span class="cls_004">gives you a nice way to export data from the directory in a format that can be</span></div>
<div style="position:absolute;left:104.69px;top:122.94px" class="cls_004"><span class="cls_004">easily shared:</span></div>
<div style="position:absolute;left:117.89px;top:146.15px" class="cls_010"><span class="cls_010">ldapsearch -x -LLL -Dcn=Manager,dc=someco,</span></div>
<div style="position:absolute;left:117.89px;top:156.95px" class="cls_010"><span class="cls_010">dc=com -wsecret -b "ou=people,dc=someco,dc=com" "uid=tuser1"</span></div>
<div style="position:absolute;left:124.19px;top:177.43px" class="cls_004"><span class="cls_004">You should get this output:</span></div>
<div style="position:absolute;left:117.89px;top:198.35px" class="cls_010"><span class="cls_010">dn: uid=tuser1,ou=people,dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:209.15px" class="cls_010"><span class="cls_010">cn: tuser1</span></div>
<div style="position:absolute;left:117.89px;top:219.95px" class="cls_010"><span class="cls_010">sn: User1</span></div>
<div style="position:absolute;left:117.89px;top:230.75px" class="cls_010"><span class="cls_010">givenName: Test</span></div>
<div style="position:absolute;left:117.89px;top:241.55px" class="cls_010"><span class="cls_010">objectClass: top</span></div>
<div style="position:absolute;left:117.89px;top:252.35px" class="cls_010"><span class="cls_010">objectClass: person</span></div>
<div style="position:absolute;left:117.89px;top:263.15px" class="cls_010"><span class="cls_010">objectClass: organizationalPerson</span></div>
<div style="position:absolute;left:117.89px;top:273.95px" class="cls_010"><span class="cls_010">objectClass: inetOrgPerson</span></div>
<div style="position:absolute;left:117.89px;top:284.75px" class="cls_010"><span class="cls_010">ou: People</span></div>
<div style="position:absolute;left:117.89px;top:295.55px" class="cls_010"><span class="cls_010">l: London</span></div>
<div style="position:absolute;left:117.89px;top:306.35px" class="cls_010"><span class="cls_010">uid: tuser1</span></div>
<div style="position:absolute;left:117.89px;top:317.15px" class="cls_010"><span class="cls_010">mail: tuser1@email.com</span></div>
<div style="position:absolute;left:117.89px;top:327.95px" class="cls_010"><span class="cls_010">userPassword:: cGFzc3dvcmQ=</span></div>
<div style="position:absolute;left:122.09px;top:359.23px" class="cls_004"><span class="cls_004">The command-line tools </span><span class="cls_013">ldapadd</span><span class="cls_004">, </span><span class="cls_013">ldapdelete</span><span class="cls_004">, </span><span class="cls_013">ldapsearch</span><span class="cls_004">, and</span></div>
<div style="position:absolute;left:122.09px;top:372.51px" class="cls_013"><span class="cls_013">ldapmodify</span><span class="cls_004"> are common, quite easy-to-use tools for doing things such as</span></div>
<div style="position:absolute;left:122.09px;top:385.79px" class="cls_004"><span class="cls_004">validating an LDAP query, inspecting an attribute, or exporting directory</span></div>
<div style="position:absolute;left:122.09px;top:398.39px" class="cls_004"><span class="cls_004">data. If you don't have these, or you'd just rather use a GUI, there are</span></div>
<div style="position:absolute;left:122.09px;top:410.99px" class="cls_004"><span class="cls_004">several open source, graphical LDAP clients available. One of them is</span></div>
<div style="position:absolute;left:122.09px;top:423.59px" class="cls_004"><span class="cls_004">Apache Directory Studio, which can optionally run as an Eclipse plug-in</span></div>
<div style="position:absolute;left:122.09px;top:436.19px" class="cls_004"><span class="cls_004">and can talk to other LDAP-compliant directories. It isn't restricted to</span></div>
<div style="position:absolute;left:122.09px;top:448.79px" class="cls_004"><span class="cls_004">Apache Directory Server.</span></div>
<div style="position:absolute;left:91.32px;top:470.52px" class="cls_004"><span class="cls_004">6. Finally, import a test group. Create a new LDIF file called </span><span class="cls_013">test-groups.ldif</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:483.80px" class="cls_004"><span class="cls_004">Use the following example to create as many test groups as you'd like:</span></div>
<div style="position:absolute;left:117.89px;top:507.01px" class="cls_010"><span class="cls_010">dn: cn=Test Group 1,ou=groups,dc=someco,dc=com</span></div>
<div style="position:absolute;left:117.89px;top:517.81px" class="cls_010"><span class="cls_010">objectClass: top</span></div>
<div style="position:absolute;left:117.89px;top:528.61px" class="cls_010"><span class="cls_010">objectClass: groupOfNames</span></div>
<div style="position:absolute;left:117.89px;top:539.41px" class="cls_010"><span class="cls_010">cn: Test Group 1</span></div>
<div style="position:absolute;left:117.89px;top:550.21px" class="cls_010"><span class="cls_010">member: uid=tuser1,ou=people,dc=someco,dc=com</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 441 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:308256px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background457.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Then import the LDIF file using </span><span class="cls_013">ldapadd</span><span class="cls_004"> just like you've done in the previous</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">steps:</span></div>
<div style="position:absolute;left:117.89px;top:106.99px" class="cls_010"><span class="cls_010">ldapadd -x -f test-groups.ldif -Dcn=Manager,dc=someco,dc=com -</span></div>
<div style="position:absolute;left:74.69px;top:117.79px" class="cls_010"><span class="cls_010">wsecret</span></div>
<div style="position:absolute;left:124.19px;top:138.27px" class="cls_004"><span class="cls_004">You should get this message:</span></div>
<div style="position:absolute;left:117.89px;top:159.19px" class="cls_010"><span class="cls_010">adding new entry "cn=Test Group 1,ou=groups,dc=someco,dc=com"</span></div>
<div style="position:absolute;left:56.69px;top:179.67px" class="cls_004"><span class="cls_004">Assuming your data was loaded OK, you've now got a working directory server with a set</span></div>
<div style="position:absolute;left:56.69px;top:192.27px" class="cls_004"><span class="cls_004">of test users and a test group. Using an LDAP server in development can be helpful. For</span></div>
<div style="position:absolute;left:56.69px;top:204.87px" class="cls_004"><span class="cls_004">example, if you need a large number of test users, it is a lot easier to generate an LDIF file</span></div>
<div style="position:absolute;left:56.69px;top:217.47px" class="cls_004"><span class="cls_004">using a Perl script or something similar and then import that into LDAP, rather than either</span></div>
<div style="position:absolute;left:56.69px;top:230.07px" class="cls_004"><span class="cls_004">manually creating the users or using the Alfresco API to do it.</span></div>
<div style="position:absolute;left:122.09px;top:251.67px" class="cls_004"><span class="cls_004">For more information on working with OpenLDAP, take a look at</span></div>
<div style="position:absolute;left:122.09px;top:264.28px" class="cls_012"><span class="cls_012">Mastering OpenLDAP: Configuring, Securing and Integrating Directory</span></div>
<div style="position:absolute;left:122.09px;top:276.88px" class="cls_012"><span class="cls_012">Services</span><span class="cls_004">, by Matt Butcher, Packt Publishing.</span></div>
<div style="position:absolute;left:56.69px;top:326.17px" class="cls_014"><span class="cls_014">Step-by-step - configuring Alfresco to</span></div>
<div style="position:absolute;left:56.69px;top:347.77px" class="cls_014"><span class="cls_014">authenticate against LDAP</span></div>
<div style="position:absolute;left:56.69px;top:372.99px" class="cls_004"><span class="cls_004">Pointing Alfresco at LDAP is pretty easy. It involves modifying some properties in your</span></div>
<div style="position:absolute;left:56.69px;top:385.59px" class="cls_013"><span class="cls_013">alfresco-global.properties</span><span class="cls_004"> file. Even if we are doing this example using LDAP, you</span></div>
<div style="position:absolute;left:56.69px;top:398.87px" class="cls_004"><span class="cls_004">can obviously use other authentication mechanisms:</span></div>
<div style="position:absolute;left:104.69px;top:420.60px" class="cls_013"><span class="cls_013">external</span><span class="cls_004">: This is used to delegate the authentication to an external system</span></div>
<div style="position:absolute;left:104.69px;top:436.04px" class="cls_013"><span class="cls_013">alfrescoNtlm</span><span class="cls_004">: Performs authentication based on user and password</span></div>
<div style="position:absolute;left:104.69px;top:449.32px" class="cls_004"><span class="cls_004">information stored in Alfresco</span></div>
<div style="position:absolute;left:104.69px;top:464.08px" class="cls_013"><span class="cls_013">passthru</span><span class="cls_004">: Allows connection to the Windows domain controller</span></div>
<div style="position:absolute;left:104.69px;top:479.52px" class="cls_013"><span class="cls_013">ldap</span><span class="cls_004"> and </span><span class="cls_013">ldap-ad</span><span class="cls_004">: Allows connection to LDAP or ActiveDirectory systems</span></div>
<div style="position:absolute;left:104.69px;top:494.96px" class="cls_013"><span class="cls_013">kerberos</span><span class="cls_004">: Used to connect to systems using the Kerberos protocol</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 442 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:308932px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background458.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Then, you can configure your Alfresco instance with only one server, but you may need to</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">connect to multiple servers using multiple authentication systems. To cover this</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">requirement, Alfresco is using the concept of authentication chain. It is a priority-ordered</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">list of authentication subsystem instances and respects the following syntax (comma</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">separated list):</span></div>
<div style="position:absolute;left:117.89px;top:141.82px" class="cls_010"><span class="cls_010">instance_name1:type1,...,instance_namen:typen</span></div>
<div style="position:absolute;left:56.69px;top:162.30px" class="cls_004"><span class="cls_004">Let's take a look at the default authentication chain in Alfresco. Open the JAR library</span></div>
<div style="position:absolute;left:56.69px;top:174.90px" class="cls_013"><span class="cls_013">alfresco-repository-5.x.jar</span><span class="cls_004"> located in the </span><span class="cls_013">WEB-INF|lib</span><span class="cls_004"> folder of the Alfresco web</span></div>
<div style="position:absolute;left:56.69px;top:188.18px" class="cls_004"><span class="cls_004">application. If you unzip this JAR file, and open the file</span></div>
<div style="position:absolute;left:56.69px;top:200.78px" class="cls_013"><span class="cls_013">alfresco|repository.properties</span><span class="cls_004">, you should find the following property:</span></div>
<div style="position:absolute;left:117.89px;top:222.38px" class="cls_010"><span class="cls_010"># The default authentication chain</span></div>
<div style="position:absolute;left:117.89px;top:233.18px" class="cls_010"><span class="cls_010">authentication.chain=alfrescoNtlm1:alfrescoNtlm</span></div>
<div style="position:absolute;left:56.69px;top:253.66px" class="cls_004"><span class="cls_004">As you can see, the default value of the authentication is defining only one instance called</span></div>
<div style="position:absolute;left:56.69px;top:266.26px" class="cls_013"><span class="cls_013">alfrescoNtlm1</span><span class="cls_004"> and using the authentication system </span><span class="cls_013">alfrescoNtlm</span><span class="cls_004">. Let's go a little bit</span></div>
<div style="position:absolute;left:56.69px;top:279.54px" class="cls_004"><span class="cls_004">deeper and understand how these authentication systems are defined and configured. In</span></div>
<div style="position:absolute;left:56.69px;top:292.14px" class="cls_004"><span class="cls_004">the expanded JAR file, you can open the folder </span><span class="cls_013">alfresco|subsystems|Authentication</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:305.42px" class="cls_004"><span class="cls_004">This folder contains all available authentication subsystems. It's the first time that we talk</span></div>
<div style="position:absolute;left:56.69px;top:318.02px" class="cls_004"><span class="cls_004">about a subsystem. In the Alfresco world, a subsystem is a configurable module responsible</span></div>
<div style="position:absolute;left:56.69px;top:330.62px" class="cls_004"><span class="cls_004">for a sub-part of Alfresco functionality. Below this folder, you can find all authentication</span></div>
<div style="position:absolute;left:56.69px;top:343.22px" class="cls_004"><span class="cls_004">subsystems and the list of available properties. Some key points about subsystems:</span></div>
<div style="position:absolute;left:104.69px;top:364.95px" class="cls_004"><span class="cls_004">They can be stopped/started without stopping/starting the whole repository.</span></div>
<div style="position:absolute;left:104.69px;top:379.71px" class="cls_004"><span class="cls_004">They are used when there are several implementations of some functionality.</span></div>
<div style="position:absolute;left:104.69px;top:392.31px" class="cls_004"><span class="cls_004">Like authentication providers or search subsystems (Lucene, Solr1, Solr4, Solr6</span><span class="cls_022">…</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:417.03px" class="cls_004"><span class="cls_004">It's a good idea to get non-chained LDAP working first, and then modify the configuration</span></div>
<div style="position:absolute;left:56.69px;top:429.63px" class="cls_004"><span class="cls_004">to set up chaining. That way, if it doesn't go as planned, you can tell whether it is your</span></div>
<div style="position:absolute;left:56.69px;top:442.23px" class="cls_004"><span class="cls_004">LDAP server settings or the chaining configuration that's the culprit. To configure Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:454.83px" class="cls_004"><span class="cls_004">to authenticate against LDAP, do this:</span></div>
<div style="position:absolute;left:91.32px;top:476.56px" class="cls_004"><span class="cls_004">1. Stop Alfresco and edit the </span><span class="cls_013">alfresco-global.properties</span><span class="cls_004"> file:</span></div>
<div style="position:absolute;left:117.89px;top:500.45px" class="cls_010"><span class="cls_010">nano /opt/alfresco-one/tomcat/shared</span></div>
<div style="position:absolute;left:139.49px;top:511.25px" class="cls_010"><span class="cls_010">/classes/alfresco-global.properties</span></div>
<div style="position:absolute;left:91.32px;top:531.86px" class="cls_004"><span class="cls_004">2. Add the following property at the end of the file to replace the default</span></div>
<div style="position:absolute;left:104.69px;top:544.46px" class="cls_004"><span class="cls_004">authentication chain:</span></div>
<div style="position:absolute;left:117.89px;top:567.67px" class="cls_010"><span class="cls_010">### Authentication ###</span></div>
<div style="position:absolute;left:117.89px;top:578.47px" class="cls_010"><span class="cls_010">authentication.chain=ldap1:ldap</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 443 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:309608px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background459.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Save the file.</span></div>
<div style="position:absolute;left:91.32px;top:85.26px" class="cls_004"><span class="cls_004">4. Create a subfolder structure like this one</span></div>
<div style="position:absolute;left:104.69px;top:97.86px" class="cls_013"><span class="cls_013">subsystems|Authentication|ldap|ldap1</span><span class="cls_004"> in </span><span class="cls_013">|opt|alfresco-</span></div>
<div style="position:absolute;left:104.69px;top:111.14px" class="cls_013"><span class="cls_013">one|tomcat|shared|classes|alfresco|extension</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:126.58px" class="cls_004"><span class="cls_004">5. Create a new file called </span><span class="cls_013">ldap-authentication.properties</span><span class="cls_004"> in </span><span class="cls_013">ldap1</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:104.69px;top:139.86px" class="cls_004"><span class="cls_004">paste the content from the file of the same name located in</span></div>
<div style="position:absolute;left:104.69px;top:152.46px" class="cls_013"><span class="cls_013">alfresco|subsystems|Authentication|ldap</span><span class="cls_004"> from the expanded JAR file.</span></div>
<div style="position:absolute;left:104.69px;top:165.74px" class="cls_004"><span class="cls_004">This file contains all properties that you can configure.</span></div>
<div style="position:absolute;left:91.32px;top:180.50px" class="cls_004"><span class="cls_004">6. Edit your newly created file </span><span class="cls_013">ldap-authentication.properties</span><span class="cls_004"> and update</span></div>
<div style="position:absolute;left:104.69px;top:193.78px" class="cls_004"><span class="cls_004">the format of the usernames in the directory:</span></div>
<div style="position:absolute;left:117.89px;top:216.99px" class="cls_010"><span class="cls_010">ldap.authentication.userNameFormat=uid=%s,</span></div>
<div style="position:absolute;left:117.89px;top:227.79px" class="cls_010"><span class="cls_010">ou=people,dc=someco,dc=com</span></div>
<div style="position:absolute;left:91.32px;top:248.40px" class="cls_004"><span class="cls_004">7. Specify the host name and port of the LDAP directory:</span></div>
<div style="position:absolute;left:117.89px;top:271.61px" class="cls_010"><span class="cls_010"># The URL to connect to the LDAP server</span></div>
<div style="position:absolute;left:117.89px;top:282.41px" class="cls_010"><span class="cls_010">ldap.authentication.java.naming.provider.url</span></div>
<div style="position:absolute;left:128.69px;top:293.21px" class="cls_010"><span class="cls_010">=ldap://localhost:389</span></div>
<div style="position:absolute;left:91.32px;top:313.82px" class="cls_004"><span class="cls_004">8. Specify the </span><span class="cls_007">Domain Name</span><span class="cls_004"> (</span><span class="cls_007">DN</span><span class="cls_004">) of a user entry that can read people and groups.</span></div>
<div style="position:absolute;left:104.69px;top:326.46px" class="cls_004"><span class="cls_004">This will be used later when you configure synchronization. It isn't used for</span></div>
<div style="position:absolute;left:104.69px;top:339.06px" class="cls_004"><span class="cls_004">authentication. Alfresco binds as the authenticating user when attempting to</span></div>
<div style="position:absolute;left:104.69px;top:351.66px" class="cls_004"><span class="cls_004">authenticate:</span></div>
<div style="position:absolute;left:117.89px;top:374.87px" class="cls_010"><span class="cls_010"># The default principal to use (only used for LDAP sync)</span></div>
<div style="position:absolute;left:117.89px;top:385.67px" class="cls_010"><span class="cls_010">ldap.synchronization.java.naming.security</span></div>
<div style="position:absolute;left:128.69px;top:396.47px" class="cls_010"><span class="cls_010">.principal=cn=Manager,dc=someco,dc=com</span></div>
<div style="position:absolute;left:91.32px;top:417.08px" class="cls_004"><span class="cls_004">9. Specify the password of the user provided in the previous step:</span></div>
<div style="position:absolute;left:117.89px;top:440.29px" class="cls_010"><span class="cls_010"># The password for the default principal</span></div>
<div style="position:absolute;left:117.89px;top:451.09px" class="cls_010"><span class="cls_010">(only used for LDAP sync)</span></div>
<div style="position:absolute;left:117.89px;top:461.89px" class="cls_010"><span class="cls_010">ldap.synchronization.java.naming.security.credentials=secret</span></div>
<div style="position:absolute;left:86.07px;top:482.50px" class="cls_004"><span class="cls_004">10. Update the group search base:</span></div>
<div style="position:absolute;left:117.89px;top:505.71px" class="cls_010"><span class="cls_010"># The group search base restricts the LDAP group query</span></div>
<div style="position:absolute;left:117.89px;top:516.51px" class="cls_010"><span class="cls_010"># to a sub section of tree on the LDAP server.</span></div>
<div style="position:absolute;left:117.89px;top:527.31px" class="cls_010"><span class="cls_010">ldap.synchronization.groupSearchBase=ou=Groups,</span></div>
<div style="position:absolute;left:117.89px;top:538.11px" class="cls_010"><span class="cls_010">dc=someco,dc=com</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 444 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:310284px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background460.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">11. Update the user search base:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010"># The user search base restricts the LDAP user query</span></div>
<div style="position:absolute;left:117.89px;top:104.51px" class="cls_010"><span class="cls_010">#to a sub section of tree on the LDAP server.</span></div>
<div style="position:absolute;left:117.89px;top:115.31px" class="cls_010"><span class="cls_010">ldap.synchronization.userSearchBase=ou=People,</span></div>
<div style="position:absolute;left:117.89px;top:126.11px" class="cls_010"><span class="cls_010">dc=someco,dc=com</span></div>
<div style="position:absolute;left:86.07px;top:146.72px" class="cls_004"><span class="cls_004">12. Save the properties file.</span></div>
<div style="position:absolute;left:86.07px;top:161.48px" class="cls_004"><span class="cls_004">13. Restart Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:185.37px" class="cls_004"><span class="cls_004">To test the setup, attempt to log in. Unless you set up an </span><span class="cls_013">admin</span><span class="cls_004"> entry in your LDAP</span></div>
<div style="position:absolute;left:56.69px;top:198.65px" class="cls_004"><span class="cls_004">directory, you won't be able to log in as </span><span class="cls_013">admin</span><span class="cls_004">. You'll fix that shortly. Instead, try one of the</span></div>
<div style="position:absolute;left:56.69px;top:211.93px" class="cls_004"><span class="cls_004">test users you imported in the LDIF file.</span></div>
<div style="position:absolute;left:56.69px;top:233.53px" class="cls_004"><span class="cls_004">If you check the log file, you should see that Alfresco started the </span><span class="cls_013">ldap1</span><span class="cls_004"> authentication</span></div>
<div style="position:absolute;left:56.69px;top:246.81px" class="cls_004"><span class="cls_004">subsystem:</span></div>
<div style="position:absolute;left:74.69px;top:267.73px" class="cls_010"><span class="cls_010">Starting 'Authentication' subsystem, ID: [Authentication, managed, ldap1]</span></div>
<div style="position:absolute;left:74.69px;top:278.53px" class="cls_010"><span class="cls_010">Startup of 'Authentication' subsystem, ID: [Authentication, managed, ldap1]</span></div>
<div style="position:absolute;left:74.69px;top:289.33px" class="cls_010"><span class="cls_010">complete</span></div>
<div style="position:absolute;left:56.69px;top:309.81px" class="cls_004"><span class="cls_004">You probably noticed that the LDAP authentication subsystem includes two</span></div>
<div style="position:absolute;left:56.69px;top:322.41px" class="cls_004"><span class="cls_004">subcomponents: authentication and synchronization. They are both active by default (you</span></div>
<div style="position:absolute;left:56.69px;top:335.01px" class="cls_004"><span class="cls_004">can change these settings by modifying your property file). By checking the log file, you</span></div>
<div style="position:absolute;left:56.69px;top:347.61px" class="cls_004"><span class="cls_004">should see messages like these ones:</span></div>
<div style="position:absolute;left:74.69px;top:368.53px" class="cls_010"><span class="cls_010">Starting 'Synchronization' subsystem, ID: [Synchronization, default]</span></div>
<div style="position:absolute;left:74.69px;top:379.33px" class="cls_010"><span class="cls_010">Synchronizing users and groups with user registry 'ldap1'</span></div>
<div style="position:absolute;left:74.69px;top:390.13px" class="cls_010"><span class="cls_010">Retrieving all groups from user registry 'ldap1'</span></div>
<div style="position:absolute;left:74.69px;top:400.93px" class="cls_010"><span class="cls_010">Synchronization,Category=directory,id1=ldap1,id2=1 Group Analysis:</span></div>
<div style="position:absolute;left:74.69px;top:411.73px" class="cls_010"><span class="cls_010">Commencing batch of 1 entries</span></div>
<div style="position:absolute;left:74.69px;top:422.53px" class="cls_010"><span class="cls_010">Synchronization,Category=directory,id1=ldap1,id2=1 Group Analysis:</span></div>
<div style="position:absolute;left:74.69px;top:433.33px" class="cls_010"><span class="cls_010">Processed 1 entries out of 1. 100% complete. Rate: 16 per second. 0</span></div>
<div style="position:absolute;left:74.69px;top:444.13px" class="cls_010"><span class="cls_010">failures detected.</span></div>
<div style="position:absolute;left:74.69px;top:454.93px" class="cls_010"><span class="cls_010">Synchronization,Category=directory,id1=ldap1,id2=1 Group Analysis:</span></div>
<div style="position:absolute;left:74.69px;top:465.73px" class="cls_010"><span class="cls_010">Completed batch of 1 entries</span></div>
<div style="position:absolute;left:74.69px;top:476.53px" class="cls_010"><span class="cls_010">Synchronization,Category=directory,id1=ldap1,id2=3 Group Creation and</span></div>
<div style="position:absolute;left:74.69px;top:487.33px" class="cls_010"><span class="cls_010">AssociatiSynchronization,Category=directory,id1=ldap1,id2=3 Group Creation</span></div>
<div style="position:absolute;left:74.69px;top:498.13px" class="cls_010"><span class="cls_010">and Association Deletion: Completed batch of 1 entries</span></div>
<div style="position:absolute;left:74.69px;top:508.93px" class="cls_010"><span class="cls_010">Retrieving all users from user registry 'ldap1'</span></div>
<div style="position:absolute;left:74.69px;top:519.73px" class="cls_010"><span class="cls_010">Synchronization,Category=directory,id1=ldap1,id2=6 User Creation and</span></div>
<div style="position:absolute;left:74.69px;top:530.53px" class="cls_010"><span class="cls_010">Association: Commencing batch of 2 entries</span></div>
<div style="position:absolute;left:74.69px;top:541.33px" class="cls_010"><span class="cls_010">Synchronization,Category=directory,id1=ldap1,id2=6 User Creation and</span></div>
<div style="position:absolute;left:74.69px;top:552.13px" class="cls_010"><span class="cls_010">Association: Processed 2 entries out of 2. 100% complete. Rate: 0 per</span></div>
<div style="position:absolute;left:74.69px;top:562.93px" class="cls_010"><span class="cls_010">second. 0 failures detected.</span></div>
<div style="position:absolute;left:74.69px;top:573.73px" class="cls_010"><span class="cls_010">Synchronization,Category=directory,id1=ldap1,id2=6 User Creation and</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 445 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:310960px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background461.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:74.69px;top:69.82px" class="cls_010"><span class="cls_010">Association: Completed batch of 2 entries</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">Finished synchronizing users and groups with user registry 'ldap1'</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">1 user(s) and 1 group(s) processed</span></div>
<div style="position:absolute;left:56.69px;top:111.90px" class="cls_004"><span class="cls_004">It means that all available users in your LDAP server have been created in Alfresco. This</span></div>
<div style="position:absolute;left:56.69px;top:124.50px" class="cls_004"><span class="cls_004">synchronization job is executed every night at midnight. It's managed by the subsystem</span></div>
<div style="position:absolute;left:56.69px;top:137.10px" class="cls_007"><span class="cls_007">Synchronization</span><span class="cls_004"> that you can also find in your expanded JAR file. You may ask why it's</span></div>
<div style="position:absolute;left:56.69px;top:149.74px" class="cls_004"><span class="cls_004">executed when I start my Alfresco instance. If you open the file </span><span class="cls_013">default-</span></div>
<div style="position:absolute;left:56.69px;top:163.02px" class="cls_013"><span class="cls_013">synchronization.properties</span><span class="cls_004"> located in</span></div>
<div style="position:absolute;left:56.69px;top:176.30px" class="cls_013"><span class="cls_013">alfresco|subsystems|Synchronization|default</span><span class="cls_004"> in your expanded JAR file, you</span></div>
<div style="position:absolute;left:56.69px;top:189.58px" class="cls_004"><span class="cls_004">should find:</span></div>
<div style="position:absolute;left:74.69px;top:210.50px" class="cls_010"><span class="cls_010">synchronization.syncOnStartup=true</span></div>
<div style="position:absolute;left:56.69px;top:230.98px" class="cls_004"><span class="cls_004">You can do an additional, quick experiment. Now that Alfresco is started, use LDIF to add a</span></div>
<div style="position:absolute;left:56.69px;top:243.58px" class="cls_004"><span class="cls_004">new user in LDAP. If you log in with an existing user and look for it, you won't be able to</span></div>
<div style="position:absolute;left:56.69px;top:256.18px" class="cls_004"><span class="cls_004">find it. However, if you try to log in to Alfresco with this new user, you are able to log in.</span></div>
<div style="position:absolute;left:56.69px;top:268.78px" class="cls_004"><span class="cls_004">Additionally, if you check the Alfresco log file, you can see that a synchronization job has</span></div>
<div style="position:absolute;left:56.69px;top:281.38px" class="cls_004"><span class="cls_004">been started. If you look at the same property file listed above, you should see the following</span></div>
<div style="position:absolute;left:56.69px;top:293.98px" class="cls_004"><span class="cls_004">property:</span></div>
<div style="position:absolute;left:74.69px;top:314.90px" class="cls_010"><span class="cls_010">synchronization.syncWhenMissingPeopleLogIn=true</span></div>
<div style="position:absolute;left:56.69px;top:335.38px" class="cls_004"><span class="cls_004">This setting allows synchronization of users if a new user is trying to login but it's not</span></div>
<div style="position:absolute;left:56.69px;top:347.98px" class="cls_004"><span class="cls_004">created yet in Alfresco, because the nightly job has not been executed yet, so the user is not</span></div>
<div style="position:absolute;left:56.69px;top:360.58px" class="cls_004"><span class="cls_004">created yet in Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:397.28px" class="cls_014"><span class="cls_014">Step-by-step - configuring chaining</span></div>
<div style="position:absolute;left:56.69px;top:422.50px" class="cls_004"><span class="cls_004">With LDAP authentication turned on, you are no longer able to log in as </span><span class="cls_013">admin</span><span class="cls_004">. That's</span></div>
<div style="position:absolute;left:56.69px;top:435.78px" class="cls_004"><span class="cls_004">because you essentially swapped out Alfresco's out of the box authentication component for</span></div>
<div style="position:absolute;left:56.69px;top:448.38px" class="cls_004"><span class="cls_004">an LDAP authentication component, and </span><span class="cls_013">admin</span><span class="cls_004"> doesn't exist in LDAP.</span></div>
<div style="position:absolute;left:56.69px;top:470.66px" class="cls_004"><span class="cls_004">Sometimes, there is a requirement to configure Alfresco to try one authentication source</span></div>
<div style="position:absolute;left:56.69px;top:483.26px" class="cls_004"><span class="cls_004">and, if it fails, try another. Suppose, for example, that SomeCo's operational staff has a tight</span></div>
<div style="position:absolute;left:56.69px;top:495.86px" class="cls_004"><span class="cls_004">grip on the LDAP directory. The Alfresco team might need to troubleshoot a problem and</span></div>
<div style="position:absolute;left:56.69px;top:508.46px" class="cls_004"><span class="cls_004">would like to use test IDs, but the turnaround time on getting new entries added to LDAP is</span></div>
<div style="position:absolute;left:56.69px;top:521.06px" class="cls_004"><span class="cls_004">too lengthy. Plus, the directory team would rather not pollute the production server with a</span></div>
<div style="position:absolute;left:56.69px;top:533.66px" class="cls_004"><span class="cls_004">bunch of fake users named after characters from your favorite movies. One solution is to</span></div>
<div style="position:absolute;left:56.69px;top:546.26px" class="cls_004"><span class="cls_004">chain LDAP authentication to Alfresco's authentication so that if a user isn't found in LDAP,</span></div>
<div style="position:absolute;left:56.69px;top:558.86px" class="cls_004"><span class="cls_004">Alfresco will attempt to find a matching entry in its own repository.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 446 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:311636px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background462.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Of course, there are other reasons to use chaining. Maybe in your organization, users aren't</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">all centrally managed-some might be in LDAP, while others are in some other proprietary</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">store.</span></div>
<div style="position:absolute;left:56.69px;top:117.30px" class="cls_004"><span class="cls_004">Let's set up SomeCo to chain LDAP to Alfresco. Here are the steps:</span></div>
<div style="position:absolute;left:91.32px;top:139.03px" class="cls_004"><span class="cls_004">1. Stop Alfresco and edit the </span><span class="cls_013">alfresco-global.properties</span><span class="cls_004"> file:</span></div>
<div style="position:absolute;left:117.89px;top:162.92px" class="cls_010"><span class="cls_010">nano /opt/alfresco-one/tomcat/shared/classes</span></div>
<div style="position:absolute;left:117.89px;top:173.72px" class="cls_010"><span class="cls_010">/alfresco-global.properties</span></div>
<div style="position:absolute;left:91.32px;top:194.33px" class="cls_004"><span class="cls_004">2. Update your authentication chain with the following configuration. This</span></div>
<div style="position:absolute;left:104.69px;top:206.93px" class="cls_004"><span class="cls_004">configuration will try to authenticate the user against LDAP first, and then we'll</span></div>
<div style="position:absolute;left:104.69px;top:219.53px" class="cls_004"><span class="cls_004">try against Alfresco if the first authentication didn't work:</span></div>
<div style="position:absolute;left:117.89px;top:242.74px" class="cls_010"><span class="cls_010">authentication.chain= ldap1:ldap,alfrescoNtlm1:alfrescoNtlm</span></div>
<div style="position:absolute;left:91.32px;top:263.35px" class="cls_004"><span class="cls_004">3. Save the file.</span></div>
<div style="position:absolute;left:91.32px;top:278.11px" class="cls_004"><span class="cls_004">4. Restart Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:302.00px" class="cls_004"><span class="cls_004">You should now be able to log in using admin, one of the test users you created in a</span></div>
<div style="position:absolute;left:56.69px;top:314.60px" class="cls_004"><span class="cls_004">previous chapter, or one of the test users in LDAP.</span></div>
<div style="position:absolute;left:56.69px;top:353.35px" class="cls_008"><span class="cls_008">Setting up Single Sign-On (SSO)</span></div>
<div style="position:absolute;left:56.69px;top:381.08px" class="cls_004"><span class="cls_004">If multiple applications in the enterprise use the same LDAP server to authenticate, why</span></div>
<div style="position:absolute;left:56.69px;top:393.68px" class="cls_004"><span class="cls_004">force your users to re-enter the same username and password just because they are moving</span></div>
<div style="position:absolute;left:56.69px;top:406.28px" class="cls_004"><span class="cls_004">from one application to another? The answer, as usual, is time and money. However,</span></div>
<div style="position:absolute;left:56.69px;top:418.88px" class="cls_004"><span class="cls_004">implementing a Single Sign-On (SSO) solution and configuring Alfresco to leverage it may</span></div>
<div style="position:absolute;left:56.69px;top:431.48px" class="cls_004"><span class="cls_004">be easier than you think.</span></div>
<div style="position:absolute;left:56.69px;top:453.08px" class="cls_004"><span class="cls_004">There are many SSO providers available and specific implementations can vary</span></div>
<div style="position:absolute;left:56.69px;top:465.68px" class="cls_004"><span class="cls_004">dramatically from company to company. In the next exercise, you'll install an open source</span></div>
<div style="position:absolute;left:56.69px;top:478.28px" class="cls_004"><span class="cls_004">SSO server called CAS from JA-SIG, and then configure Alfresco to use it. This should give</span></div>
<div style="position:absolute;left:56.69px;top:490.88px" class="cls_004"><span class="cls_004">you just enough of a taste of SSO to determine if it makes sense in your organization and</span></div>
<div style="position:absolute;left:56.69px;top:503.48px" class="cls_004"><span class="cls_004">what might be involved for a full production rollout, whether using CAS or some other SSO</span></div>
<div style="position:absolute;left:56.69px;top:516.08px" class="cls_004"><span class="cls_004">package.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 447 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:312312px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background463.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Step-by-step - implementing SSO</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">This exercise involves downloading, installing, and configuring a base install of CAS, then</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_004"><span class="cls_004">installing and configuring Apache, and then configuring Alfresco. When that's done, you'll</span></div>
<div style="position:absolute;left:56.69px;top:120.18px" class="cls_004"><span class="cls_004">be able to visit Alfresco and other CAS-protected web applications without requiring more</span></div>
<div style="position:absolute;left:56.69px;top:132.78px" class="cls_004"><span class="cls_004">than one login. In a traditional architecture, Apache and CAS will be installed on a</span></div>
<div style="position:absolute;left:56.69px;top:145.38px" class="cls_004"><span class="cls_004">dedicated server to be re-usable by many applications. But in our case, to keep it simple,</span></div>
<div style="position:absolute;left:56.69px;top:157.98px" class="cls_004"><span class="cls_004">we'll install everything in the same virtual machine that we have.</span></div>
<div style="position:absolute;left:56.69px;top:356.75px" class="cls_004"><span class="cls_004">To install CAS and configure Alfresco for SSO, follow these steps:</span></div>
<div style="position:absolute;left:91.32px;top:378.48px" class="cls_004"><span class="cls_004">1. You're going to install CAS in a separate application server from Alfresco. We'll</span></div>
<div style="position:absolute;left:104.69px;top:391.08px" class="cls_004"><span class="cls_004">set up another Tomcat instance in the VM. You'll need to change its HTTP, SSL,</span></div>
<div style="position:absolute;left:104.69px;top:403.68px" class="cls_004"><span class="cls_004">and shutdown ports. We'll use 8081, 8444, and 8006 respectively in this example.</span></div>
<div style="position:absolute;left:104.69px;top:416.28px" class="cls_004"><span class="cls_004">We'll also use Apache to handle SSL and CAS, so we need to open the HTTP</span></div>
<div style="position:absolute;left:104.69px;top:428.88px" class="cls_004"><span class="cls_004">ports 1080 and 1443. The first action is to update our Vagrant file to open the</span></div>
<div style="position:absolute;left:104.69px;top:441.48px" class="cls_004"><span class="cls_004">HTTP and SSL ports of Tomcat and Apache. Let's first suspend our virtual</span></div>
<div style="position:absolute;left:104.69px;top:454.08px" class="cls_004"><span class="cls_004">machine by typing the following from the folder </span><span class="cls_013">vms|vagrant</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:477.97px" class="cls_010"><span class="cls_010">vagrant suspend</span></div>
<div style="position:absolute;left:91.32px;top:498.58px" class="cls_004"><span class="cls_004">2. Then, edit the file </span><span class="cls_013">Vagrantfile</span><span class="cls_004"> and these four rules:</span></div>
<div style="position:absolute;left:117.89px;top:522.47px" class="cls_010"><span class="cls_010"># Redirect CAS HTTP port</span></div>
<div style="position:absolute;left:117.89px;top:533.27px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 8081, host: 8081</span></div>
<div style="position:absolute;left:117.89px;top:544.07px" class="cls_010"><span class="cls_010"># Redirect CAS SSL port</span></div>
<div style="position:absolute;left:117.89px;top:554.87px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 8444, host: 8444</span></div>
<div style="position:absolute;left:117.89px;top:565.67px" class="cls_010"><span class="cls_010"># Redirect Apache HTTP port</span></div>
<div style="position:absolute;left:117.89px;top:576.47px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 1080, host: 1080</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 448 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:312988px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background464.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010"># Redirect Apache SSL port</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">config.vm.network "forwarded_port", guest: 1443, host: 1443</span></div>
<div style="position:absolute;left:91.32px;top:101.23px" class="cls_004"><span class="cls_004">3. Finally, let's reload your virtual machine:</span></div>
<div style="position:absolute;left:117.89px;top:124.44px" class="cls_010"><span class="cls_010">vagrant reload --provision</span></div>
<div style="position:absolute;left:124.19px;top:144.92px" class="cls_004"><span class="cls_004">You should see the following messages confirming that the new forwarding</span></div>
<div style="position:absolute;left:124.19px;top:157.52px" class="cls_004"><span class="cls_004">rules are added:</span></div>
<div style="position:absolute;left:117.89px;top:178.44px" class="cls_010"><span class="cls_010">==&gt; default: Forwarding ports...</span></div>
<div style="position:absolute;left:139.49px;top:189.24px" class="cls_010"><span class="cls_010">default: 8080 =&gt; 8080 (adapter 1)</span></div>
<div style="position:absolute;left:139.49px;top:200.04px" class="cls_010"><span class="cls_010">default: 8000 =&gt; 8000 (adapter 1)</span></div>
<div style="position:absolute;left:139.49px;top:210.84px" class="cls_010"><span class="cls_010">default: 9000 =&gt; 9000 (adapter 1)</span></div>
<div style="position:absolute;left:139.49px;top:221.64px" class="cls_010"><span class="cls_010">default: 8081 =&gt; 8081 (adapter 1)</span></div>
<div style="position:absolute;left:139.49px;top:232.44px" class="cls_010"><span class="cls_010">default: 8444 =&gt; 8444 (adapter 1)</span></div>
<div style="position:absolute;left:139.49px;top:243.24px" class="cls_010"><span class="cls_010">default: 1080 (guest) =&gt; 1080 (host) (adapter 1)</span></div>
<div style="position:absolute;left:139.49px;top:254.04px" class="cls_010"><span class="cls_010">default: 1443 (guest) =&gt; 1443 (host) (adapter 1)</span></div>
<div style="position:absolute;left:139.49px;top:264.84px" class="cls_010"><span class="cls_010">default: 22 =&gt; 2222 (adapter 1)</span></div>
<div style="position:absolute;left:91.32px;top:285.45px" class="cls_004"><span class="cls_004">4. Log back to your virtual machine by typing </span><span class="cls_013">vagrant ssh</span></div>
<div style="position:absolute;left:91.32px;top:300.89px" class="cls_004"><span class="cls_004">5. Log in as root by typing: </span><span class="cls_013">sudo su -</span></div>
<div style="position:absolute;left:91.32px;top:316.33px" class="cls_004"><span class="cls_004">6. Let's start by setting up a new Tomcat instance:</span></div>
<div style="position:absolute;left:117.89px;top:339.54px" class="cls_010"><span class="cls_010">cd /opt</span></div>
<div style="position:absolute;left:117.89px;top:350.34px" class="cls_010"><span class="cls_010">wget </span><a href="http://archive.apache.org/dist/tomcat/">http://archive.apache.org/dist/tomcat/</a> </div>
<div style="position:absolute;left:128.69px;top:361.14px" class="cls_010"><span class="cls_010">tomcat-6/v6.0.39/bin/apache-tomcat-6.0.39.zip</span></div>
<div style="position:absolute;left:117.89px;top:371.94px" class="cls_010"><span class="cls_010">unzip apache-tomcat-6.0.39.zip</span></div>
<div style="position:absolute;left:117.89px;top:382.74px" class="cls_010"><span class="cls_010">mv apache-tomcat-6.0.39 cas</span></div>
<div style="position:absolute;left:91.32px;top:403.35px" class="cls_004"><span class="cls_004">7. Let's change the default port used by Tomcat to avoid being in conflict with the</span></div>
<div style="position:absolute;left:104.69px;top:415.95px" class="cls_004"><span class="cls_004">Tomcat instance used by Alfresco. Edit the file </span><span class="cls_013">|opt|cas|conf|server.xml</span><span class="cls_007">.</span></div>
<div style="position:absolute;left:104.69px;top:429.23px" class="cls_004"><span class="cls_004">Change line 22 defining the shutdown port to the following line:</span></div>
<div style="position:absolute;left:117.89px;top:452.44px" class="cls_010"><span class="cls_010">&lt;Server port="8006" shutdown="SHUTDOWN"&gt;</span></div>
<div style="position:absolute;left:124.19px;top:472.92px" class="cls_004"><span class="cls_004">Change line  </span><span class="cls_013">90</span><span class="cls_004"> defining the AJP port to the following line:</span></div>
<div style="position:absolute;left:117.89px;top:494.52px" class="cls_010"><span class="cls_010">&lt;Connector port="8010"</span></div>
<div style="position:absolute;left:128.69px;top:505.32px" class="cls_010"><span class="cls_010">protocol="AJP/1.3"</span></div>
<div style="position:absolute;left:128.69px;top:516.12px" class="cls_010"><span class="cls_010">redirectPort="8444"</span></div>
<div style="position:absolute;left:128.69px;top:526.92px" class="cls_010"><span class="cls_010">enableLookups="false"</span></div>
<div style="position:absolute;left:117.89px;top:537.72px" class="cls_010"><span class="cls_010">/&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 449 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:313664px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background465.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">Change lines </span><span class="cls_013">69-71</span><span class="cls_004"> defining the connector on the port </span><span class="cls_013">8080</span><span class="cls_004"> to the following</span></div>
<div style="position:absolute;left:124.19px;top:83.78px" class="cls_004"><span class="cls_004">lines:</span></div>
<div style="position:absolute;left:117.89px;top:104.70px" class="cls_010"><span class="cls_010">&lt;Connector port="8081" maxHttpHeaderSize="8192"</span></div>
<div style="position:absolute;left:128.69px;top:115.50px" class="cls_010"><span class="cls_010">maxThreads="150"</span></div>
<div style="position:absolute;left:128.69px;top:126.30px" class="cls_010"><span class="cls_010">minSpareThreads="25"</span></div>
<div style="position:absolute;left:128.69px;top:137.10px" class="cls_010"><span class="cls_010">maxSpareThreads="75"</span></div>
<div style="position:absolute;left:128.69px;top:147.90px" class="cls_010"><span class="cls_010">enableLookups="false"</span></div>
<div style="position:absolute;left:128.69px;top:158.70px" class="cls_010"><span class="cls_010">redirectPort="8444"</span></div>
<div style="position:absolute;left:128.69px;top:169.50px" class="cls_010"><span class="cls_010">acceptCount="100"</span></div>
<div style="position:absolute;left:128.69px;top:180.30px" class="cls_010"><span class="cls_010">connectionTimeout="20000"</span></div>
<div style="position:absolute;left:128.69px;top:191.10px" class="cls_010"><span class="cls_010">disableUploadTimeout="true" /&gt;</span></div>
<div style="position:absolute;left:124.19px;top:211.58px" class="cls_004"><span class="cls_004">And finally add the following SSL connector below the previous connector:</span></div>
<div style="position:absolute;left:117.89px;top:232.50px" class="cls_010"><span class="cls_010">&lt;Connector port="8444" protocol="HTTP/1.1"</span></div>
<div style="position:absolute;left:128.69px;top:243.30px" class="cls_010"><span class="cls_010">SSLEnabled="true"</span></div>
<div style="position:absolute;left:128.69px;top:254.10px" class="cls_010"><span class="cls_010">maxThreads="150"</span></div>
<div style="position:absolute;left:128.69px;top:264.90px" class="cls_010"><span class="cls_010">scheme="https"</span></div>
<div style="position:absolute;left:128.69px;top:275.70px" class="cls_010"><span class="cls_010">secure="true"</span></div>
<div style="position:absolute;left:128.69px;top:286.50px" class="cls_010"><span class="cls_010">keystoreFile="/opt/cas/conf/keystore"</span></div>
<div style="position:absolute;left:128.69px;top:297.30px" class="cls_010"><span class="cls_010">keystorePass="secret"</span></div>
<div style="position:absolute;left:128.69px;top:308.10px" class="cls_010"><span class="cls_010">clientAuth="false"</span></div>
<div style="position:absolute;left:128.69px;top:318.90px" class="cls_010"><span class="cls_010">sslProtocol="TLS" /&gt;</span></div>
<div style="position:absolute;left:91.32px;top:339.51px" class="cls_004"><span class="cls_004">8. We need to check if the </span><span class="cls_013">JAVA_HOME</span><span class="cls_004"> environment variable is properly set. Just</span></div>
<div style="position:absolute;left:104.69px;top:352.79px" class="cls_004"><span class="cls_004">type:</span></div>
<div style="position:absolute;left:117.89px;top:376.00px" class="cls_010"><span class="cls_010">echo $JAVA_HOME</span></div>
<div style="position:absolute;left:124.19px;top:396.48px" class="cls_004"><span class="cls_004">If it returns nothing, you need to configure it. Just edit or create the file</span></div>
<div style="position:absolute;left:124.19px;top:409.08px" class="cls_013"><span class="cls_013">|etc|profile.d|java.sh</span><span class="cls_004"> by typing:</span></div>
<div style="position:absolute;left:117.89px;top:430.68px" class="cls_010"><span class="cls_010">nano /etc/profile.d/java.sh</span></div>
<div style="position:absolute;left:124.19px;top:451.16px" class="cls_004"><span class="cls_004">And add the following two lines:</span></div>
<div style="position:absolute;left:117.89px;top:472.08px" class="cls_010"><span class="cls_010">export JAVA_HOME=/opt/alfresco-one/java</span></div>
<div style="position:absolute;left:117.89px;top:482.88px" class="cls_010"><span class="cls_010">export PATH=$PATH:$JAVA_HOME/bin</span></div>
<div style="position:absolute;left:124.19px;top:503.36px" class="cls_004"><span class="cls_004">This file will be automatically loaded at the next session so you can logout</span></div>
<div style="position:absolute;left:124.19px;top:515.96px" class="cls_004"><span class="cls_004">and log back in. Or you can just ask to load this file:</span></div>
<div style="position:absolute;left:117.89px;top:536.88px" class="cls_010"><span class="cls_010">source /etc/profile.d/java.sh</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 450 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:314340px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background466.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">If you retype the </span><span class="cls_013">echo</span><span class="cls_004"> command, you should get:</span></div>
<div style="position:absolute;left:117.89px;top:92.10px" class="cls_010"><span class="cls_010">/opt/alfresco-one/java/</span></div>
<div style="position:absolute;left:91.32px;top:112.71px" class="cls_004"><span class="cls_004">9. Create the SSL key for your machine using Java's </span><span class="cls_007">keytool</span><span class="cls_004"> program:</span></div>
<div style="position:absolute;left:117.89px;top:135.96px" class="cls_010"><span class="cls_010">cd /opt/cas/conf</span></div>
<div style="position:absolute;left:117.89px;top:146.76px" class="cls_010"><span class="cls_010">keytool -keystore keystore -genkey</span></div>
<div style="position:absolute;left:123.29px;top:157.56px" class="cls_010"><span class="cls_010">-alias tomcat -keyalg RSA</span></div>
<div style="position:absolute;left:124.19px;top:178.04px" class="cls_004"><span class="cls_004">It will ask you for a password to protect your keystore. As you can see above,</span></div>
<div style="position:absolute;left:124.19px;top:190.64px" class="cls_004"><span class="cls_004">we used </span><span class="cls_013">secret</span><span class="cls_004"> as the password:</span></div>
<div style="position:absolute;left:117.89px;top:212.24px" class="cls_010"><span class="cls_010">Enter keystore password:  secret</span></div>
<div style="position:absolute;left:117.89px;top:223.04px" class="cls_010"><span class="cls_010">Re-enter new password: secret</span></div>
<div style="position:absolute;left:124.19px;top:243.52px" class="cls_004"><span class="cls_004">Then, it will ask for your first name and last name, you need to use the name</span></div>
<div style="position:absolute;left:124.19px;top:256.12px" class="cls_004"><span class="cls_004">of the machine running the CAS Tomcat server. In our case, it's </span><span class="cls_013">localhost</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:277.72px" class="cls_010"><span class="cls_010">What is your first and last name?</span></div>
<div style="position:absolute;left:128.69px;top:288.52px" class="cls_010"><span class="cls_010">[Unknown]:  localhost</span></div>
<div style="position:absolute;left:124.19px;top:309.00px" class="cls_004"><span class="cls_004">Then, you can keep </span><span class="cls_013">Unknown</span><span class="cls_004"> for the other questions:</span></div>
<div style="position:absolute;left:117.89px;top:330.60px" class="cls_010"><span class="cls_010">What is the name of your organizational unit?</span></div>
<div style="position:absolute;left:128.69px;top:341.40px" class="cls_010"><span class="cls_010">[Unknown]:</span></div>
<div style="position:absolute;left:117.89px;top:352.20px" class="cls_010"><span class="cls_010">What is the name of your organization?</span></div>
<div style="position:absolute;left:128.69px;top:363.00px" class="cls_010"><span class="cls_010">[Unknown]:</span></div>
<div style="position:absolute;left:117.89px;top:373.80px" class="cls_010"><span class="cls_010">What is the name of your City or Locality?</span></div>
<div style="position:absolute;left:128.69px;top:384.60px" class="cls_010"><span class="cls_010">[Unknown]:</span></div>
<div style="position:absolute;left:117.89px;top:395.40px" class="cls_010"><span class="cls_010">What is the name of your State or Province?</span></div>
<div style="position:absolute;left:128.69px;top:406.20px" class="cls_010"><span class="cls_010">[Unknown]:</span></div>
<div style="position:absolute;left:117.89px;top:417.00px" class="cls_010"><span class="cls_010">What is the two-letter country code for this unit?</span></div>
<div style="position:absolute;left:128.69px;top:427.80px" class="cls_010"><span class="cls_010">[Unknown]:</span></div>
<div style="position:absolute;left:134.09px;top:438.60px" class="cls_010"><span class="cls_010">It will ask you to confirm, be sure to type yes:</span></div>
<div style="position:absolute;left:117.89px;top:449.40px" class="cls_010"><span class="cls_010">Is CN=localhost, OU=Unknown, O=Unknown,</span></div>
<div style="position:absolute;left:117.89px;top:460.20px" class="cls_010"><span class="cls_010">L=Unknown, ST=Unknown, C=Unknown correct?</span></div>
<div style="position:absolute;left:128.69px;top:471.00px" class="cls_010"><span class="cls_010">[no]:  yes</span></div>
<div style="position:absolute;left:124.19px;top:491.48px" class="cls_004"><span class="cls_004">The last question is asking you if you want to set up another password for</span></div>
<div style="position:absolute;left:124.19px;top:504.08px" class="cls_004"><span class="cls_004">this certificate. In this case, we don't, so just type </span><span class="cls_013">ENTER</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:525.68px" class="cls_010"><span class="cls_010">Enter key password for &lt;tomcat&gt;</span></div>
<div style="position:absolute;left:134.09px;top:536.48px" class="cls_010"><span class="cls_010">(RETURN if same as keystore password):</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 451 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:315016px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background467.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">10. Let's start this Tomcat instance and validate that we have the basics properly</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">configured. Before starting Tomcat, we need to make all scripts executable:</span></div>
<div style="position:absolute;left:117.89px;top:106.31px" class="cls_010"><span class="cls_010">cd /opt/cas/bin</span></div>
<div style="position:absolute;left:117.89px;top:117.11px" class="cls_010"><span class="cls_010">chmod +x *.sh</span></div>
<div style="position:absolute;left:124.19px;top:137.59px" class="cls_004"><span class="cls_004">Then, we can start Tomcat:</span></div>
<div style="position:absolute;left:117.89px;top:158.51px" class="cls_010"><span class="cls_010">sh startup.sh</span></div>
<div style="position:absolute;left:86.07px;top:179.12px" class="cls_004"><span class="cls_004">11. If you open your browser to the URL </span><a href="http://localhost:8081/">http://localhost:8081/</a> <span class="cls_004">, you should</span></div>
<div style="position:absolute;left:104.69px;top:192.40px" class="cls_004"><span class="cls_004">get the following page:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 452 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:315692px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background468.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">12. Then, you can check if HTTPS is working properly by opening</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">https://localhost:8444/</span><span class="cls_004">. If you use Google Chrome, you'll have a screen</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">like this one. It's because we use a self-signed certificate. You just need to click on</span></div>
<div style="position:absolute;left:104.69px;top:108.98px" class="cls_007"><span class="cls_007">ADVANCED</span><span class="cls_004">, and then </span><span class="cls_007">Proceed.</span></div>
<div style="position:absolute;left:86.07px;top:393.20px" class="cls_004"><span class="cls_004">13. We confirmed that Tomcat is properly set up, so we can stop it:</span></div>
<div style="position:absolute;left:117.89px;top:416.41px" class="cls_010"><span class="cls_010">sh /opt/cas/bin/shutdown.sh</span></div>
<div style="position:absolute;left:86.07px;top:437.02px" class="cls_004"><span class="cls_004">14. Let's download and install the CAS server:</span></div>
<div style="position:absolute;left:117.89px;top:460.23px" class="cls_010"><span class="cls_010">cd /opt/cas/webapps/</span></div>
<div style="position:absolute;left:117.89px;top:471.03px" class="cls_010"><span class="cls_010">wget </span><a href="http://central.maven.org/maven2/org/jasig/">http://central.maven.org/maven2/org/jasig</a> </div>
<div style="position:absolute;left:128.69px;top:481.83px" class="cls_010"><span class="cls_010">/cas/cas-server-webapp/3.6.0/cas-server-webapp-3.6.0.war</span></div>
<div style="position:absolute;left:117.89px;top:492.63px" class="cls_010"><span class="cls_010">mv cas-server-webapp-3.6.0.war cas.war</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 453 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:316368px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background469.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">15. Restart Tomcat:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">sh /opt/cas/bin/startup.sh</span></div>
<div style="position:absolute;left:124.19px;top:114.19px" class="cls_004"><span class="cls_004">You should be able to see the login screen by pointing your browser to</span></div>
<div style="position:absolute;left:124.19px;top:126.79px" class="cls_013"><span class="cls_013">https://localhost:8444/cas</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:86.07px;top:438.74px" class="cls_004"><span class="cls_004">16. We didn't configure any authentication provider. If you check the log file, you</span></div>
<div style="position:absolute;left:104.69px;top:451.34px" class="cls_004"><span class="cls_004">should a message like this one:</span></div>
<div style="position:absolute;left:117.89px;top:474.55px" class="cls_010"><span class="cls_010">WARN</span></div>
<div style="position:absolute;left:117.89px;top:485.35px" class="cls_010"><span class="cls_010">[org.jasig.cas.authentication.handler.support</span></div>
<div style="position:absolute;left:128.69px;top:496.15px" class="cls_010"><span class="cls_010">.SimpleTestUsernamePasswordAuthenticationHandler] -</span></div>
<div style="position:absolute;left:117.89px;top:506.95px" class="cls_010"><span class="cls_010">&lt;org.jasig.cas.authentication.handler.support</span></div>
<div style="position:absolute;left:128.69px;top:517.75px" class="cls_010"><span class="cls_010">.SimpleTestUsernamePasswordAuthenticationHandler is only</span></div>
<div style="position:absolute;left:128.69px;top:528.55px" class="cls_010"><span class="cls_010">to be used in a testing environment.</span></div>
<div style="position:absolute;left:128.69px;top:539.35px" class="cls_010"><span class="cls_010">NEVER enable this in a production environment.&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 454 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:317044px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background470.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:124.19px;top:70.50px" class="cls_004"><span class="cls_004">It means that you can connect using any username/password combination</span></div>
<div style="position:absolute;left:124.19px;top:83.10px" class="cls_004"><span class="cls_004">where the password is the username. If you try with </span><span class="cls_013">test/test</span><span class="cls_004">, you should</span></div>
<div style="position:absolute;left:124.19px;top:96.38px" class="cls_004"><span class="cls_004">get a screen confirming that the login was successful:</span></div>
<div style="position:absolute;left:86.07px;top:412.15px" class="cls_004"><span class="cls_004">17. Be aware that the configuration of the SSL port of the Tomcat used by CAS is not</span></div>
<div style="position:absolute;left:104.69px;top:424.75px" class="cls_004"><span class="cls_004">necessary in our case because we'll use Apache to handle SSL. However, it's a</span></div>
<div style="position:absolute;left:104.69px;top:437.35px" class="cls_004"><span class="cls_004">required step if you decide not to use Apache.</span></div>
<div style="position:absolute;left:86.07px;top:452.11px" class="cls_004"><span class="cls_004">18. Now, we can start to install Apache. We'll use three important modules called</span></div>
<div style="position:absolute;left:104.69px;top:464.71px" class="cls_013"><span class="cls_013">mod_ssl</span><span class="cls_004"> to handle HTTPS, </span><span class="cls_013">mod_proxy_ajp</span><span class="cls_004"> to redirect queries to CAS and</span></div>
<div style="position:absolute;left:104.69px;top:477.99px" class="cls_004"><span class="cls_004">Alfresco using the AJP protocol, and </span><span class="cls_013">mod_auth_cas</span><span class="cls_004"> to manage the</span></div>
<div style="position:absolute;left:104.69px;top:491.27px" class="cls_004"><span class="cls_004">authentication between the web applications. The first ones are easily installable,</span></div>
<div style="position:absolute;left:104.69px;top:503.87px" class="cls_004"><span class="cls_004">but there are multiple versions of the last one and some of them are not</span></div>
<div style="position:absolute;left:104.69px;top:516.47px" class="cls_004"><span class="cls_004">compatible with the installation. We need to install the module from EPEL (Extra</span></div>
<div style="position:absolute;left:104.69px;top:529.07px" class="cls_004"><span class="cls_004">Packages for Enterprise Linux):</span></div>
<div style="position:absolute;left:117.89px;top:552.28px" class="cls_010"><span class="cls_010">yum -y install epel-release</span></div>
<div style="position:absolute;left:117.89px;top:563.08px" class="cls_010"><span class="cls_010">yum clean all</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 455 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:317720px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background471.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">19. We can install Apache with all required modules:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">yum install -y httpd mod_ssl httpd-devel apr</span></div>
<div style="position:absolute;left:117.89px;top:104.51px" class="cls_010"><span class="cls_010">apr-devel apr-util apr-util-devel mod_auth_cas</span></div>
<div style="position:absolute;left:86.07px;top:125.12px" class="cls_004"><span class="cls_004">20. When Apache is installed, we are going to change the listening ports. First, we</span></div>
<div style="position:absolute;left:104.69px;top:137.72px" class="cls_004"><span class="cls_004">need to change the default HTTP listening port 80 to 1080. Edit the file</span></div>
<div style="position:absolute;left:104.69px;top:150.32px" class="cls_013"><span class="cls_013">|etc|httpd|conf|httpd.conf</span><span class="cls_004">, identify the </span><span class="cls_013">Listen</span><span class="cls_004"> directive and change it to:</span></div>
<div style="position:absolute;left:117.89px;top:174.21px" class="cls_010"><span class="cls_010">Listen 1080</span></div>
<div style="position:absolute;left:124.19px;top:194.69px" class="cls_004"><span class="cls_004">Then, identify the </span><span class="cls_013">ServerName</span><span class="cls_004"> directive (that should be commented),</span></div>
<div style="position:absolute;left:124.19px;top:207.97px" class="cls_004"><span class="cls_004">uncomment it and change it to:</span></div>
<div style="position:absolute;left:117.89px;top:228.89px" class="cls_010"><span class="cls_010">ServerName localhost:1080</span></div>
<div style="position:absolute;left:86.07px;top:249.50px" class="cls_004"><span class="cls_004">21. We also need to change the SSL listening port </span><span class="cls_013">443</span><span class="cls_004"> to </span><span class="cls_013">1443</span><span class="cls_004">. Edit the file</span></div>
<div style="position:absolute;left:104.69px;top:262.78px" class="cls_013"><span class="cls_013">|etc|httpd|conf.d|ssl.conf</span><span class="cls_004">, identify the </span><span class="cls_013">Listen</span><span class="cls_004"> directive and change it to:</span></div>
<div style="position:absolute;left:117.89px;top:286.67px" class="cls_010"><span class="cls_010">Listen 1443 https</span></div>
<div style="position:absolute;left:101.69px;top:307.15px" class="cls_004"><span class="cls_004">Then, identify the </span><span class="cls_013">VirtualHost</span><span class="cls_004"> configuration and change it to:</span></div>
<div style="position:absolute;left:134.09px;top:328.75px" class="cls_010"><span class="cls_010">&lt;VirtualHost _default_:1443&gt;</span></div>
<div style="position:absolute;left:56.69px;top:349.23px" class="cls_004"><span class="cls_004">We need to configure the </span><span class="cls_013">mod_auth_cas</span><span class="cls_004"> module. Create the file</span></div>
<div style="position:absolute;left:56.69px;top:362.51px" class="cls_013"><span class="cls_013">|etc|httpd|conf.d|mod_auth_cas.conf</span><span class="cls_004">. The first lines added are to configure how</span></div>
<div style="position:absolute;left:56.69px;top:375.79px" class="cls_004"><span class="cls_004">Apache can connect to CAS, and where it can find the certificates that we'll generate in a</span></div>
<div style="position:absolute;left:56.69px;top:388.39px" class="cls_004"><span class="cls_004">later step:</span></div>
<div style="position:absolute;left:74.69px;top:409.31px" class="cls_010"><span class="cls_010">CASLoginURL </span><a href="https://localhost:1443/cas/login/">https://localhost:1443/cas/login</a> </div>
<div style="position:absolute;left:74.69px;top:420.11px" class="cls_010"><span class="cls_010">CASValidateURL </span><a href="https://localhost:1443/cas/servicevalidate/">https://localhost:1443/cas/serviceValidate</a> </div>
<div style="position:absolute;left:74.69px;top:430.91px" class="cls_010"><span class="cls_010">CASCertificatePath /etc/pki/tls/certs</span></div>
<div style="position:absolute;left:56.69px;top:451.39px" class="cls_004"><span class="cls_004">Then, we create the configuration for the </span><span class="cls_013">alfresco</span><span class="cls_004"> web application, but we disable the</span></div>
<div style="position:absolute;left:56.69px;top:464.67px" class="cls_004"><span class="cls_004">CAS authentication for some path like </span><span class="cls_013">scripts</span><span class="cls_004">, </span><span class="cls_013">css</span><span class="cls_004"> or </span><span class="cls_013">images</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:80.09px;top:486.27px" class="cls_010"><span class="cls_010">&lt;LocationMatch ^/alfresco/(?!service/|service$</span></div>
<div style="position:absolute;left:85.49px;top:497.07px" class="cls_010"><span class="cls_010">|webdav/|webdav$|s/|s$|scripts/|css/|images/).*&gt;</span></div>
<div style="position:absolute;left:101.69px;top:507.87px" class="cls_010"><span class="cls_010">AuthType CAS</span></div>
<div style="position:absolute;left:101.69px;top:518.67px" class="cls_010"><span class="cls_010">AuthName "CAS"</span></div>
<div style="position:absolute;left:101.69px;top:529.47px" class="cls_010"><span class="cls_010">require valid-user</span></div>
<div style="position:absolute;left:101.69px;top:540.27px" class="cls_010"><span class="cls_010">CASScope /alfresco</span></div>
<div style="position:absolute;left:101.69px;top:551.07px" class="cls_010"><span class="cls_010">CASAuthNHeader X-Alfresco-Remote-User</span></div>
<div style="position:absolute;left:80.09px;top:561.87px" class="cls_010"><span class="cls_010">&lt;/LocationMatch&gt;</span></div>
<div style="position:absolute;left:80.09px;top:572.67px" class="cls_010"><span class="cls_010">We add as well the configure for the share web application:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 456 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:318396px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background472.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:80.09px;top:69.82px" class="cls_010"><span class="cls_010">&lt;Location /share&gt;</span></div>
<div style="position:absolute;left:101.69px;top:80.62px" class="cls_010"><span class="cls_010">AuthType CAS</span></div>
<div style="position:absolute;left:101.69px;top:91.42px" class="cls_010"><span class="cls_010">AuthName "CAS"</span></div>
<div style="position:absolute;left:107.09px;top:102.22px" class="cls_010"><span class="cls_010">require valid-user</span></div>
<div style="position:absolute;left:101.69px;top:113.02px" class="cls_010"><span class="cls_010">CASScope /share</span></div>
<div style="position:absolute;left:101.69px;top:123.82px" class="cls_010"><span class="cls_010">CASAuthNHeader X-Alfresco-Remote-User</span></div>
<div style="position:absolute;left:80.09px;top:134.62px" class="cls_010"><span class="cls_010">&lt;/Location&gt;</span></div>
<div style="position:absolute;left:56.69px;top:155.10px" class="cls_004"><span class="cls_004">And finally, for testing purposes, we want to protect the out-of-the-box examples web</span></div>
<div style="position:absolute;left:56.69px;top:167.70px" class="cls_004"><span class="cls_004">application provided by Tomcat:</span></div>
<div style="position:absolute;left:80.09px;top:188.62px" class="cls_010"><span class="cls_010">&lt;Location /examples&gt;</span></div>
<div style="position:absolute;left:85.49px;top:199.42px" class="cls_010"><span class="cls_010">AuthType CAS</span></div>
<div style="position:absolute;left:85.49px;top:210.22px" class="cls_010"><span class="cls_010">AuthName "CAS"</span></div>
<div style="position:absolute;left:85.49px;top:221.02px" class="cls_010"><span class="cls_010">require valid-user</span></div>
<div style="position:absolute;left:85.49px;top:231.82px" class="cls_010"><span class="cls_010">CASScope /examples</span></div>
<div style="position:absolute;left:80.09px;top:242.62px" class="cls_010"><span class="cls_010">&lt;/Location&gt;</span></div>
<div style="position:absolute;left:56.69px;top:263.10px" class="cls_004"><span class="cls_004">We need to configure the </span><span class="cls_013">mod_proxy_ajp</span><span class="cls_004"> module that will redirect the queries between</span></div>
<div style="position:absolute;left:56.69px;top:276.38px" class="cls_004"><span class="cls_004">Apache and the two Tomcat instances that we have using the AJP protocol. Create the file</span></div>
<div style="position:absolute;left:56.69px;top:288.98px" class="cls_013"><span class="cls_013">|etc|httpd|conf.d|mod_proxy_ajp.conf</span><span class="cls_004">. First, we add a redirection on queries using</span></div>
<div style="position:absolute;left:56.69px;top:302.26px" class="cls_013"><span class="cls_013">/alfresco</span><span class="cls_004"> or </span><span class="cls_013">/share</span><span class="cls_004"> to the Tomcat containing our Alfresco web applications (configured</span></div>
<div style="position:absolute;left:56.69px;top:315.54px" class="cls_004"><span class="cls_004">with the default AJP port 8009):</span></div>
<div style="position:absolute;left:74.69px;top:336.46px" class="cls_010"><span class="cls_010">ProxyPass /alfresco ajp://localhost:8009/alfresco</span></div>
<div style="position:absolute;left:74.69px;top:347.26px" class="cls_010"><span class="cls_010">ProxyPassReverse /alfresco ajp://localhost:8009/alfresco</span></div>
<div style="position:absolute;left:74.69px;top:358.06px" class="cls_010"><span class="cls_010">ProxyPass /share ajp://localhost:8009/share</span></div>
<div style="position:absolute;left:74.69px;top:368.86px" class="cls_010"><span class="cls_010">ProxyPassReverse /share ajp://localhost:8009/share</span></div>
<div style="position:absolute;left:56.69px;top:389.34px" class="cls_004"><span class="cls_004">And then, we add a redirection on queries using </span><span class="cls_013">/cas</span><span class="cls_004"> to the Tomcat containing the CAS</span></div>
<div style="position:absolute;left:56.69px;top:402.62px" class="cls_004"><span class="cls_004">web application that we installed (configured with port 8010 in step 7):</span></div>
<div style="position:absolute;left:74.69px;top:423.54px" class="cls_010"><span class="cls_010">ProxyPass /cas ajp://localhost:8010/cas</span></div>
<div style="position:absolute;left:74.69px;top:434.34px" class="cls_010"><span class="cls_010">ProxyPassReverse /cas ajp://localhost:8010/cas</span></div>
<div style="position:absolute;left:56.69px;top:454.82px" class="cls_004"><span class="cls_004">Finally, for testing purposes, we redirect queries on </span><span class="cls_013">/examples</span><span class="cls_004"> to the CAS Tomcat:</span></div>
<div style="position:absolute;left:74.69px;top:476.42px" class="cls_010"><span class="cls_010">ProxyPass /examples ajp://localhost:8010/examples</span></div>
<div style="position:absolute;left:74.69px;top:487.22px" class="cls_010"><span class="cls_010">ProxyPassReverse /examples ajp://localhost:8010/examples</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 457 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:319072px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background473.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Then, we need to do the same thing for the SSL port. Edit the file</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_013"><span class="cls_013">|etc|httpd|conf.d|ssl.conf</span><span class="cls_004"> and add the following lines before the final </span><span class="cls_013">VirtualHost</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">closing tag:</span></div>
<div style="position:absolute;left:74.69px;top:117.30px" class="cls_010"><span class="cls_010">ProxyPass /cas ajp://localhost:8010/cas</span></div>
<div style="position:absolute;left:74.69px;top:128.10px" class="cls_010"><span class="cls_010">ProxyPassReverse /cas ajp://localhost:8010/cas</span></div>
<div style="position:absolute;left:74.69px;top:138.90px" class="cls_010"><span class="cls_010">ProxyPass /examples ajp://localhost:8010/examples</span></div>
<div style="position:absolute;left:74.69px;top:149.70px" class="cls_010"><span class="cls_010">ProxyPassReverse /examples ajp://localhost:8010/examples</span></div>
<div style="position:absolute;left:74.69px;top:160.50px" class="cls_010"><span class="cls_010">SSLVerifyClient optional</span></div>
<div style="position:absolute;left:74.69px;top:171.30px" class="cls_010"><span class="cls_010">SSLCACertificatePath /etc/pki/tls/certs/</span></div>
<div style="position:absolute;left:74.69px;top:182.10px" class="cls_010"><span class="cls_010">SSLOptions +StdEnvVars +ExportCertData</span></div>
<div style="position:absolute;left:56.69px;top:202.58px" class="cls_004"><span class="cls_004">Apache is now configured. We just need to generate the certificates that will be used</span></div>
<div style="position:absolute;left:56.69px;top:215.18px" class="cls_004"><span class="cls_004">between Alfresco, CAS, and Apache. Create the self-signed certificates:</span></div>
<div style="position:absolute;left:74.69px;top:236.10px" class="cls_010"><span class="cls_010">touch /etc/pki/CA/index.txt</span></div>
<div style="position:absolute;left:74.69px;top:246.90px" class="cls_010"><span class="cls_010">echo 01 &gt; /etc/pki/CA/serial</span></div>
<div style="position:absolute;left:74.69px;top:257.70px" class="cls_010"><span class="cls_010">cd /etc/pki/CA/</span></div>
<div style="position:absolute;left:74.69px;top:268.50px" class="cls_010"><span class="cls_010">openssl genrsa -out private/cakey.pem -des3 2048</span></div>
<div style="position:absolute;left:56.69px;top:288.98px" class="cls_004"><span class="cls_004">And use the passphrase secret:</span></div>
<div style="position:absolute;left:74.69px;top:309.90px" class="cls_010"><span class="cls_010">Generating RSA private key, 2048 bit long modulus</span></div>
<div style="position:absolute;left:74.69px;top:320.70px" class="cls_010"><span class="cls_010">.....................................+++</span></div>
<div style="position:absolute;left:74.69px;top:331.50px" class="cls_010"><span class="cls_010">.........+++</span></div>
<div style="position:absolute;left:74.69px;top:342.30px" class="cls_010"><span class="cls_010">e is 65537 (0x10001)</span></div>
<div style="position:absolute;left:74.69px;top:353.10px" class="cls_010"><span class="cls_010">Enter pass phrase for private/cakey.pem:secret</span></div>
<div style="position:absolute;left:74.69px;top:363.90px" class="cls_010"><span class="cls_010">Verifying - Enter pass phrase for private/cakey.pem:secret</span></div>
<div style="position:absolute;left:56.69px;top:384.38px" class="cls_004"><span class="cls_004">Then, type the following command and use the same pass phrase </span><span class="cls_013">secret</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:405.98px" class="cls_010"><span class="cls_010">openssl req -new -x509 -days 365</span></div>
<div style="position:absolute;left:74.69px;top:416.78px" class="cls_010"><span class="cls_010">-key private/cakey.pem -out cacert.pem -subj</span></div>
<div style="position:absolute;left:74.69px;top:427.58px" class="cls_010"><span class="cls_010">'/CN=localhost'</span></div>
<div style="position:absolute;left:56.69px;top:448.06px" class="cls_004"><span class="cls_004">We need to configure Apache to trust this self-signed certificate:</span></div>
<div style="position:absolute;left:74.69px;top:468.98px" class="cls_010"><span class="cls_010">cp cacert.pem /etc/pki/tls/certs/</span></div>
<div style="position:absolute;left:74.69px;top:479.78px" class="cls_010"><span class="cls_010">cd /etc/pki/tls/certs/</span></div>
<div style="position:absolute;left:74.69px;top:490.58px" class="cls_010"><span class="cls_010">ln -s cacert.pem `openssl x509 -hash -noout</span></div>
<div style="position:absolute;left:74.69px;top:501.38px" class="cls_010"><span class="cls_010">-in cacert.pem`.0</span></div>
<div style="position:absolute;left:56.69px;top:521.86px" class="cls_004"><span class="cls_004">Replace the HTTP server's test certificate with the certificate issued by Alfresco CA by</span></div>
<div style="position:absolute;left:56.69px;top:534.46px" class="cls_004"><span class="cls_004">typing:</span></div>
<div style="position:absolute;left:74.69px;top:555.38px" class="cls_010"><span class="cls_010">openssl req -nodes -new -out localhost.csr</span></div>
<div style="position:absolute;left:74.69px;top:566.18px" class="cls_010"><span class="cls_010">-keyout ../private/localhost.key</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 458 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:319748px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background474.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">And then, reply to the questions following this template:</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">Generating a 2048 bit RSA private key</span></div>
<div style="position:absolute;left:74.69px;top:102.22px" class="cls_010"><span class="cls_010">......................+++</span></div>
<div style="position:absolute;left:74.69px;top:113.02px" class="cls_010"><span class="cls_010">.....................................+++</span></div>
<div style="position:absolute;left:74.69px;top:123.82px" class="cls_010"><span class="cls_010">writing new private key to '../private/localhost.key'</span></div>
<div style="position:absolute;left:74.69px;top:134.62px" class="cls_010"><span class="cls_010">-----</span></div>
<div style="position:absolute;left:74.69px;top:145.42px" class="cls_010"><span class="cls_010">You are about to be asked to enter information that will be incorporated</span></div>
<div style="position:absolute;left:74.69px;top:156.22px" class="cls_010"><span class="cls_010">into your certificate request.</span></div>
<div style="position:absolute;left:74.69px;top:167.02px" class="cls_010"><span class="cls_010">What you are about to enter is what is called a Distinguished Name or a DN.</span></div>
<div style="position:absolute;left:74.69px;top:177.82px" class="cls_010"><span class="cls_010">There are quite a few fields but you can leave some blank</span></div>
<div style="position:absolute;left:74.69px;top:188.62px" class="cls_010"><span class="cls_010">For some fields there will be a default value,</span></div>
<div style="position:absolute;left:74.69px;top:199.42px" class="cls_010"><span class="cls_010">If you enter '.', the field will be left blank.</span></div>
<div style="position:absolute;left:74.69px;top:210.22px" class="cls_010"><span class="cls_010">-----</span></div>
<div style="position:absolute;left:74.69px;top:221.02px" class="cls_010"><span class="cls_010">Country Name (2 letter code) [XX]:UK</span></div>
<div style="position:absolute;left:74.69px;top:231.82px" class="cls_010"><span class="cls_010">State or Province Name (full name) []:Greater London</span></div>
<div style="position:absolute;left:74.69px;top:242.62px" class="cls_010"><span class="cls_010">Locality Name (eg, city) [Default City]:London</span></div>
<div style="position:absolute;left:74.69px;top:253.42px" class="cls_010"><span class="cls_010">Organization Name (eg, company) [Default Company Ltd]:SomeCo Ltd</span></div>
<div style="position:absolute;left:74.69px;top:264.22px" class="cls_010"><span class="cls_010">Organizational Unit Name (eg, section) []:</span></div>
<div style="position:absolute;left:74.69px;top:275.02px" class="cls_010"><span class="cls_010">Common Name (eg, your name or your server's hostname) []:localhost</span></div>
<div style="position:absolute;left:74.69px;top:285.82px" class="cls_010"><span class="cls_010">Email Address []:</span></div>
<div style="position:absolute;left:74.69px;top:307.42px" class="cls_010"><span class="cls_010">Please enter the following 'extra' attributes</span></div>
<div style="position:absolute;left:74.69px;top:318.22px" class="cls_010"><span class="cls_010">to be sent with your certificate request</span></div>
<div style="position:absolute;left:74.69px;top:329.02px" class="cls_010"><span class="cls_010">A challenge password []:</span></div>
<div style="position:absolute;left:74.69px;top:339.82px" class="cls_010"><span class="cls_010">An optional company name []:</span></div>
<div style="position:absolute;left:56.69px;top:360.30px" class="cls_004"><span class="cls_004">Then, sign the client certificate with our certificate:</span></div>
<div style="position:absolute;left:74.69px;top:381.22px" class="cls_010"><span class="cls_010">openssl x509 -req -days 365 -in localhost.csr -CA /etc/pki/CA/cacert.pem -</span></div>
<div style="position:absolute;left:74.69px;top:392.02px" class="cls_010"><span class="cls_010">CAkey /etc/pki/CA/private/cakey.pem -set_serial 01 -out localhost.crt</span></div>
<div style="position:absolute;left:56.69px;top:412.50px" class="cls_004"><span class="cls_004">And use the pass phrase </span><span class="cls_013">secret</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:434.10px" class="cls_010"><span class="cls_010">Signature ok</span></div>
<div style="position:absolute;left:74.69px;top:444.90px" class="cls_010"><span class="cls_010">subject=/C=UK/ST=Greater London/L=London/O=SomeCo Ltd/CN=localhost</span></div>
<div style="position:absolute;left:74.69px;top:455.70px" class="cls_010"><span class="cls_010">Getting CA Private Key</span></div>
<div style="position:absolute;left:90.89px;top:466.50px" class="cls_010"><span class="cls_010">Enter pass phrase for /etc/pki/CA/private/cakey.pem:secret</span></div>
<div style="position:absolute;left:56.69px;top:486.98px" class="cls_004"><span class="cls_004">The next step is creating the certificates that will be used between Share and the Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:499.58px" class="cls_004"><span class="cls_004">repository:</span></div>
<div style="position:absolute;left:74.69px;top:520.50px" class="cls_010"><span class="cls_010">openssl genrsa -des3 -out ../private/alfresco-system.key 1024</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 459 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:320424px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background475.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">And use the pass phrase </span><span class="cls_013">secret</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:56.69px;top:92.78px" class="cls_004"><span class="cls_004">Generating RSA private key, 1024 bit long modulus</span></div>
<div style="position:absolute;left:74.69px;top:113.70px" class="cls_010"><span class="cls_010">...........................++++++</span></div>
<div style="position:absolute;left:74.69px;top:124.50px" class="cls_010"><span class="cls_010">.......++++++</span></div>
<div style="position:absolute;left:74.69px;top:135.30px" class="cls_010"><span class="cls_010">e is 65537 (0x10001)</span></div>
<div style="position:absolute;left:74.69px;top:146.10px" class="cls_010"><span class="cls_010">Enter pass phrase for ../private/alfresco-system.key:secret</span></div>
<div style="position:absolute;left:74.69px;top:156.90px" class="cls_010"><span class="cls_010">Verifying - Enter pass phrase for ../private/alfresco-system.key:secret</span></div>
<div style="position:absolute;left:56.69px;top:177.38px" class="cls_004"><span class="cls_004">And generate the CSR certificate and use the pass phrase </span><span class="cls_013">secret</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:198.98px" class="cls_010"><span class="cls_010">openssl req -new -key ../private/alfresco-system.key -out alfresco-</span></div>
<div style="position:absolute;left:74.69px;top:209.78px" class="cls_010"><span class="cls_010">system.csr -subj '/CN=alfresco-system'</span></div>
<div style="position:absolute;left:56.69px;top:230.26px" class="cls_004"><span class="cls_004">Sign the client certificate and use the pass phrase </span><span class="cls_013">secret</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:251.86px" class="cls_010"><span class="cls_010">openssl x509 -req -days 365 -in alfresco-system.csr -CA</span></div>
<div style="position:absolute;left:74.69px;top:262.66px" class="cls_010"><span class="cls_010">/etc/pki/CA/cacert.pem -CAkey /etc/pki/CA/private/cakey.pem -set_serial 02</span></div>
<div style="position:absolute;left:74.69px;top:273.46px" class="cls_010"><span class="cls_010">-out alfresco-system.crt</span></div>
<div style="position:absolute;left:56.69px;top:293.94px" class="cls_004"><span class="cls_004">Package the certificate in the P12 format:</span></div>
<div style="position:absolute;left:74.69px;top:314.86px" class="cls_010"><span class="cls_010">openssl pkcs12 -export -out alfresco-system.p12 -in alfresco-system.crt -</span></div>
<div style="position:absolute;left:74.69px;top:325.66px" class="cls_010"><span class="cls_010">inkey ../private/alfresco-system.key -certfile /etc/pki/CA/cacert.pem</span></div>
<div style="position:absolute;left:56.69px;top:346.14px" class="cls_004"><span class="cls_004">And use the pass phrase </span><span class="cls_013">secret</span><span class="cls_004"> too:</span></div>
<div style="position:absolute;left:74.69px;top:367.74px" class="cls_010"><span class="cls_010">Enter pass phrase for ../private/alfresco-system.key:secret</span></div>
<div style="position:absolute;left:74.69px;top:378.54px" class="cls_010"><span class="cls_010">Enter Export Password:secret</span></div>
<div style="position:absolute;left:74.69px;top:389.34px" class="cls_010"><span class="cls_010">Verifying - Enter Export Password:secret</span></div>
<div style="position:absolute;left:56.69px;top:409.82px" class="cls_004"><span class="cls_004">Copy the P12 certificate into Share:</span></div>
<div style="position:absolute;left:74.69px;top:430.74px" class="cls_010"><span class="cls_010">cp alfresco-system.p12 /opt/alfresco-</span></div>
<div style="position:absolute;left:74.69px;top:441.54px" class="cls_010"><span class="cls_010">one/tomcat/shared/classes/alfresco/web-extension/</span></div>
<div style="position:absolute;left:56.69px;top:462.02px" class="cls_004"><span class="cls_004">Finally, generate the truststore that will be used by Alfresco Share:</span></div>
<div style="position:absolute;left:74.69px;top:482.94px" class="cls_010"><span class="cls_010">keytool -importcert -alias alfresco-system -keystore /opt/alfresco-</span></div>
<div style="position:absolute;left:74.69px;top:493.74px" class="cls_010"><span class="cls_010">one/tomcat/shared/classes/alfresco/web-extension/ssl-truststore -file</span></div>
<div style="position:absolute;left:74.69px;top:504.54px" class="cls_010"><span class="cls_010">/etc/pki/CA/cacert.pem</span></div>
<div style="position:absolute;left:56.69px;top:525.02px" class="cls_004"><span class="cls_004">Use the same pass phrase </span><span class="cls_013">secret</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:546.62px" class="cls_010"><span class="cls_010">Enter keystore password: secret</span></div>
<div style="position:absolute;left:74.69px;top:557.42px" class="cls_010"><span class="cls_010">Re-enter new password:secret</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 460 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:321100px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background476.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">And finally, confirm that you want to add the certificate to the truststore:</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">Trust this certificate? [no]:  yes</span></div>
<div style="position:absolute;left:74.69px;top:102.22px" class="cls_010"><span class="cls_010">Certificate was added to keystore</span></div>
<div style="position:absolute;left:56.69px;top:122.70px" class="cls_004"><span class="cls_004">We configured Apache and the Tomcat instance containing CAS. The last step is to</span></div>
<div style="position:absolute;left:56.69px;top:135.30px" class="cls_004"><span class="cls_004">configure the Alfresco repository and Share. First, stop Alfresco if it is running:</span></div>
<div style="position:absolute;left:74.69px;top:156.22px" class="cls_010"><span class="cls_010">service alfresco stop</span></div>
<div style="position:absolute;left:56.69px;top:176.70px" class="cls_004"><span class="cls_004">Then, we need to disable the authentication on the AJP port. Edit the file </span><span class="cls_013">|opt|alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:189.98px" class="cls_013"><span class="cls_013">one|tomcat|conf|server.xml</span><span class="cls_004"> and add a new attribute </span><span class="cls_013">tomcatAuthentication</span><span class="cls_004"> to the</span></div>
<div style="position:absolute;left:56.69px;top:203.26px" class="cls_004"><span class="cls_004">AJP connector using the value </span><span class="cls_013">false</span><span class="cls_004">. You should have:</span></div>
<div style="position:absolute;left:74.69px;top:224.86px" class="cls_010"><span class="cls_010">&lt;Connector port="8009" protocol="AJP/1.3" redirectPort="8443"</span></div>
<div style="position:absolute;left:74.69px;top:235.66px" class="cls_010"><span class="cls_010">tomcatAuthentication="false" /&gt;</span></div>
<div style="position:absolute;left:56.69px;top:256.14px" class="cls_004"><span class="cls_004">Alfresco needs to be configured to use the </span><span class="cls_013">external</span><span class="cls_004"> authentication subsystem instead of</span></div>
<div style="position:absolute;left:56.69px;top:269.42px" class="cls_004"><span class="cls_004">the default </span><span class="cls_013">alfrescoNtlm</span><span class="cls_004"> subsystem, or the </span><span class="cls_013">ldap</span><span class="cls_004"> subsystem that you may have</span></div>
<div style="position:absolute;left:56.69px;top:282.70px" class="cls_004"><span class="cls_004">configured previously. In this example, we'll configure the subsystem by listing all</span></div>
<div style="position:absolute;left:56.69px;top:295.30px" class="cls_004"><span class="cls_004">properties in the same file. You can see the property,</span></div>
<div style="position:absolute;left:56.69px;top:307.90px" class="cls_013"><span class="cls_013">external.authentication.proxyHeader</span><span class="cls_004">, it contains the header name that will be used</span></div>
<div style="position:absolute;left:56.69px;top:321.18px" class="cls_004"><span class="cls_004">to pass information between Apache and Alfresco. Edit the file </span><span class="cls_013">|opt|alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:334.46px" class="cls_013"><span class="cls_013">one|tomcat|shared|classes|alfresco-global.properties </span><span class="cls_004">and use the following</span></div>
<div style="position:absolute;left:56.69px;top:347.74px" class="cls_004"><span class="cls_004">properties (be sure that you have only one property, </span><span class="cls_013">authentication.chain</span><span class="cls_004">):</span></div>
<div style="position:absolute;left:74.69px;top:369.34px" class="cls_010"><span class="cls_010">authentication.chain=external1:external</span></div>
<div style="position:absolute;left:74.69px;top:380.14px" class="cls_010"><span class="cls_010">external.authentication.proxyUserName=</span></div>
<div style="position:absolute;left:74.69px;top:390.94px" class="cls_010"><span class="cls_010">external.authentication.enabled=true</span></div>
<div style="position:absolute;left:74.69px;top:401.74px" class="cls_010"><span class="cls_010">external.authentication.defaultAdministratorUserNames=admin</span></div>
<div style="position:absolute;left:74.69px;top:412.54px" class="cls_010"><span class="cls_010">external.authentication.proxyHeader=X-Alfresco-Remote-User</span></div>
<div style="position:absolute;left:91.32px;top:433.15px" class="cls_004"><span class="cls_004">1. Share needs to be configured too. Edit the file </span><span class="cls_013">|opt|alfresco-</span></div>
<div style="position:absolute;left:104.69px;top:445.65px" class="cls_013"><span class="cls_013">one|tomcat|shared|classes|alfresco|web-extension|share-config-</span></div>
<div style="position:absolute;left:104.69px;top:458.43px" class="cls_013"><span class="cls_013">custom.xml</span><span class="cls_004">. Locate a </span><span class="cls_013">config</span><span class="cls_004"> element with the </span><span class="cls_013">condition</span><span class="cls_004"> attribute equal to</span></div>
<div style="position:absolute;left:104.69px;top:471.71px" class="cls_013"><span class="cls_013">Remote</span><span class="cls_004">. Be careful, you may have more than one. So, find the one that is</span></div>
<div style="position:absolute;left:104.69px;top:484.99px" class="cls_004"><span class="cls_004">commented. It should look like the following code. Uncomment it, you should</span></div>
<div style="position:absolute;left:104.69px;top:497.59px" class="cls_004"><span class="cls_004">have this XML code containing six sub elements that we are going to explain:</span></div>
<div style="position:absolute;left:117.89px;top:520.80px" class="cls_010"><span class="cls_010">&lt;config evaluator="string-compare" condition="Remote"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:531.60px" class="cls_010"><span class="cls_010">&lt;remote&gt;</span></div>
<div style="position:absolute;left:139.49px;top:542.40px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:128.69px;top:553.20px" class="cls_010"><span class="cls_010">&lt;/remote&gt;</span></div>
<div style="position:absolute;left:117.89px;top:564.00px" class="cls_010"><span class="cls_010">&lt;/config&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 461 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:321776px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background477.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. The first element included in the remote tag is the SSL configuration. Be sure to</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">update the path and the password for the keystore and the truststore:</span></div>
<div style="position:absolute;left:117.89px;top:106.31px" class="cls_010"><span class="cls_010">&lt;ssl-config&gt;</span></div>
<div style="position:absolute;left:128.69px;top:117.11px" class="cls_010"><span class="cls_010">&lt;keystore-path&gt;/opt/alfresco-one/tomcat/shared</span></div>
<div style="position:absolute;left:139.49px;top:127.91px" class="cls_010"><span class="cls_010">/classes/alfresco/web-extension/alfresco-system.p12</span></div>
<div style="position:absolute;left:128.69px;top:138.71px" class="cls_010"><span class="cls_010">&lt;/keystore-path&gt;</span></div>
<div style="position:absolute;left:128.69px;top:149.51px" class="cls_010"><span class="cls_010">&lt;keystore-type&gt;pkcs12&lt;/keystore-type&gt;</span></div>
<div style="position:absolute;left:128.69px;top:160.31px" class="cls_010"><span class="cls_010">&lt;keystore-password&gt;secret&lt;/keystore-password&gt;</span></div>
<div style="position:absolute;left:128.69px;top:171.11px" class="cls_010"><span class="cls_010">&lt;truststore-path&gt;/opt/alfresco-one/tomcat/shared</span></div>
<div style="position:absolute;left:139.49px;top:181.91px" class="cls_010"><span class="cls_010">/classes/alfresco/web-extension/ssl-truststore</span></div>
<div style="position:absolute;left:128.69px;top:192.71px" class="cls_010"><span class="cls_010">&lt;/truststore-path&gt;</span></div>
<div style="position:absolute;left:128.69px;top:203.51px" class="cls_010"><span class="cls_010">&lt;truststore-type&gt;JCEKS&lt;/truststore-type&gt;</span></div>
<div style="position:absolute;left:128.69px;top:214.31px" class="cls_010"><span class="cls_010">&lt;truststore-password&gt;secret&lt;/truststore-password&gt;</span></div>
<div style="position:absolute;left:128.69px;top:225.11px" class="cls_010"><span class="cls_010">&lt;verify-hostname&gt;true&lt;/verify-hostname&gt;</span></div>
<div style="position:absolute;left:117.89px;top:235.91px" class="cls_010"><span class="cls_010">&lt;/ssl-config&gt;</span></div>
<div style="position:absolute;left:91.32px;top:256.52px" class="cls_004"><span class="cls_004">3. Then, we have the two connectors. Only change is required. Be sure to specify the</span></div>
<div style="position:absolute;left:104.69px;top:269.12px" class="cls_004"><span class="cls_004">right header name in the </span><span class="cls_013">userHeader</span><span class="cls_004"> tag:</span></div>
<div style="position:absolute;left:117.89px;top:293.01px" class="cls_010"><span class="cls_010">&lt;connector&gt;</span></div>
<div style="position:absolute;left:128.69px;top:303.81px" class="cls_010"><span class="cls_010">&lt;id&gt;alfrescoCookie&lt;/id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:314.61px" class="cls_010"><span class="cls_010">&lt;name&gt;Alfresco Connector&lt;/name&gt;</span></div>
<div style="position:absolute;left:128.69px;top:325.41px" class="cls_010"><span class="cls_010">&lt;description&gt;Connects to an Alfresco instance</span></div>
<div style="position:absolute;left:117.89px;top:336.21px" class="cls_010"><span class="cls_010">using cookie-based authentication&lt;/description&gt;</span></div>
<div style="position:absolute;left:128.69px;top:347.01px" class="cls_010"><span class="cls_010">&lt;class&gt;org.alfresco.web.site.servlet</span></div>
<div style="position:absolute;left:139.49px;top:357.81px" class="cls_010"><span class="cls_010">.SlingshotAlfrescoConnector&lt;/class&gt;</span></div>
<div style="position:absolute;left:117.89px;top:368.61px" class="cls_010"><span class="cls_010">&lt;/connector&gt;</span></div>
<div style="position:absolute;left:117.89px;top:390.21px" class="cls_010"><span class="cls_010">&lt;connector&gt;</span></div>
<div style="position:absolute;left:128.69px;top:401.01px" class="cls_010"><span class="cls_010">&lt;id&gt;alfrescoHeader&lt;/id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:411.81px" class="cls_010"><span class="cls_010">&lt;name&gt;Alfresco Connector&lt;/name&gt;</span></div>
<div style="position:absolute;left:128.69px;top:422.61px" class="cls_010"><span class="cls_010">&lt;description&gt;Connects to an Alfresco instance using</span></div>
<div style="position:absolute;left:139.49px;top:433.41px" class="cls_010"><span class="cls_010">header and cookie-based authentication&lt;/description&gt;</span></div>
<div style="position:absolute;left:128.69px;top:444.21px" class="cls_010"><span class="cls_010">&lt;class&gt;org.alfresco.web.site.servlet</span></div>
<div style="position:absolute;left:139.49px;top:455.01px" class="cls_010"><span class="cls_010">.SlingshotAlfrescoConnector&lt;/class&gt;</span></div>
<div style="position:absolute;left:128.69px;top:465.81px" class="cls_010"><span class="cls_010">&lt;userHeader&gt;X-Alfresco-Remote-User&lt;/userHeader&gt;</span></div>
<div style="position:absolute;left:117.89px;top:476.61px" class="cls_010"><span class="cls_010">&lt;/connector&gt;</span></div>
<div style="position:absolute;left:91.32px;top:497.22px" class="cls_004"><span class="cls_004">4. Finally, we can configure the three endpoints. The only difference with the</span></div>
<div style="position:absolute;left:104.69px;top:509.82px" class="cls_004"><span class="cls_004">configuration in the file is that we configure the three endpoints to use the</span></div>
<div style="position:absolute;left:104.69px;top:522.42px" class="cls_013"><span class="cls_013">alfrescoHeader</span><span class="cls_004"> connector in the tag </span><span class="cls_013">connector-id</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:546.31px" class="cls_010"><span class="cls_010">&lt;endpoint&gt;</span></div>
<div style="position:absolute;left:128.69px;top:557.11px" class="cls_010"><span class="cls_010">&lt;id&gt;alfresco&lt;/id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:567.91px" class="cls_010"><span class="cls_010">&lt;name&gt;Alfresco - user access&lt;/name&gt;</span></div>
<div style="position:absolute;left:128.69px;top:578.71px" class="cls_010"><span class="cls_010">&lt;description&gt;Access to Alfresco Repository WebScripts</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 462 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:322452px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background478.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">that require user authentication&lt;/description&gt;</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;connector-id&gt;alfrescoHeader&lt;/connector-id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:91.42px" class="cls_010"><span class="cls_010">&lt;endpoint-url&gt;</span><a href="http://localhost:8080/alfresco/wcs%3C/endpoint-url/">http://localhost:8080/alfresco/wcs&lt;/endpoint-url</a>&gt;</div>
<div style="position:absolute;left:128.69px;top:102.22px" class="cls_010"><span class="cls_010">&lt;identity&gt;user&lt;/identity&gt;</span></div>
<div style="position:absolute;left:128.69px;top:113.02px" class="cls_010"><span class="cls_010">&lt;external-auth&gt;true&lt;/external-auth&gt;</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">&lt;/endpoint&gt;</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">&lt;endpoint&gt;</span></div>
<div style="position:absolute;left:128.69px;top:156.22px" class="cls_010"><span class="cls_010">&lt;id&gt;alfresco-feed&lt;/id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:167.02px" class="cls_010"><span class="cls_010">&lt;parent-id&gt;alfresco&lt;/parent-id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:177.82px" class="cls_010"><span class="cls_010">&lt;name&gt;Alfresco Feed&lt;/name&gt;</span></div>
<div style="position:absolute;left:128.69px;top:188.62px" class="cls_010"><span class="cls_010">&lt;description&gt;Alfresco Feed - supports basic HTTP</span></div>
<div style="position:absolute;left:139.49px;top:199.42px" class="cls_010"><span class="cls_010">authentication via the EndPointProxyServlet&lt;/description&gt;</span></div>
<div style="position:absolute;left:128.69px;top:210.22px" class="cls_010"><span class="cls_010">&lt;connector-id&gt;alfrescoHeader&lt;/connector-id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:221.02px" class="cls_010"><span class="cls_010">&lt;endpoint-url&gt;</span><a href="http://localhost:8080/alfresco/wcs%3C/endpoint-url/">http://localhost:8080/alfresco/wcs&lt;/endpoint-url</a>&gt;</div>
<div style="position:absolute;left:128.69px;top:231.82px" class="cls_010"><span class="cls_010">&lt;identity&gt;user&lt;/identity&gt;</span></div>
<div style="position:absolute;left:128.69px;top:242.62px" class="cls_010"><span class="cls_010">&lt;external-auth&gt;true&lt;/external-auth&gt;</span></div>
<div style="position:absolute;left:117.89px;top:253.42px" class="cls_010"><span class="cls_010">&lt;/endpoint&gt;</span></div>
<div style="position:absolute;left:117.89px;top:275.02px" class="cls_010"><span class="cls_010">&lt;endpoint&gt;</span></div>
<div style="position:absolute;left:128.69px;top:285.82px" class="cls_010"><span class="cls_010">&lt;id&gt;alfresco-api&lt;/id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:296.62px" class="cls_010"><span class="cls_010">&lt;parent-id&gt;alfresco&lt;/parent-id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:307.42px" class="cls_010"><span class="cls_010">&lt;name&gt;Alfresco Public API - user access&lt;/name&gt;</span></div>
<div style="position:absolute;left:128.69px;top:318.22px" class="cls_010"><span class="cls_010">&lt;description&gt;Access to Alfresco Repository Public API</span></div>
<div style="position:absolute;left:139.49px;top:329.02px" class="cls_010"><span class="cls_010">that require user authentication.</span></div>
<div style="position:absolute;left:128.69px;top:339.82px" class="cls_010"><span class="cls_010">This makes use of the authentication that is provided</span></div>
<div style="position:absolute;left:139.49px;top:350.62px" class="cls_010"><span class="cls_010">by parent 'alfresco' endpoint.&lt;/description&gt;</span></div>
<div style="position:absolute;left:128.69px;top:361.42px" class="cls_010"><span class="cls_010">&lt;connector-id&gt;alfrescoHeader&lt;/connector-id&gt;</span></div>
<div style="position:absolute;left:128.69px;top:372.22px" class="cls_010"><span class="cls_010">&lt;endpoint-url&gt;</span><a href="http://localhost:8080/alfresco/api%3C/endpoint-url/">http://localhost:8080/alfresco/api&lt;/endpoint-url</a>&gt;</div>
<div style="position:absolute;left:128.69px;top:383.02px" class="cls_010"><span class="cls_010">&lt;identity&gt;user&lt;/identity&gt;</span></div>
<div style="position:absolute;left:128.69px;top:393.82px" class="cls_010"><span class="cls_010">&lt;external-auth&gt;true&lt;/external-auth&gt;</span></div>
<div style="position:absolute;left:117.89px;top:404.62px" class="cls_010"><span class="cls_010">&lt;/endpoint&gt;</span></div>
<div style="position:absolute;left:56.69px;top:434.36px" class="cls_004"><span class="cls_004">It's now time to start everything and to test:</span></div>
<div style="position:absolute;left:74.69px;top:455.28px" class="cls_010"><span class="cls_010">service</span></div>
<div style="position:absolute;left:117.89px;top:455.28px" class="cls_010"><span class="cls_010">alfresco start</span></div>
<div style="position:absolute;left:74.69px;top:466.08px" class="cls_010"><span class="cls_010">service</span></div>
<div style="position:absolute;left:117.89px;top:466.08px" class="cls_010"><span class="cls_010">httpd start</span></div>
<div style="position:absolute;left:74.69px;top:476.88px" class="cls_010"><span class="cls_010">sh /opt/cas/bin/startup.sh</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 463 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:323128px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background479.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">First, you can test that Apache works as expected by opening the URL</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_013"><span class="cls_013">https://localhost:1443/</span><span class="cls_004">. And you should see the following page:</span></div>
<div style="position:absolute;left:56.69px;top:296.05px" class="cls_004"><span class="cls_004">Now, start a new navigator in incognito mode. By doing that, when you close the window,</span></div>
<div style="position:absolute;left:56.69px;top:308.65px" class="cls_004"><span class="cls_004">it will delete all cookies stored in your browser. Open the URL</span></div>
<div style="position:absolute;left:56.69px;top:321.25px" class="cls_013"><span class="cls_013"> </span><a href="https://localhost:1443/examples/servlets/servlet/helloworldexample/">https://localhost:1443/examples/servlets/servlet/HelloWorldExample</a> <span class="cls_007">, </span><span class="cls_004">you</span></div>
<div style="position:absolute;left:56.69px;top:334.53px" class="cls_004"><span class="cls_004">should see the CAS login page and authenticate using any username and password (but be</span></div>
<div style="position:absolute;left:56.69px;top:347.13px" class="cls_004"><span class="cls_004">sure to provide a password equal to the username). Then you should be allowed to access</span></div>
<div style="position:absolute;left:56.69px;top:359.73px" class="cls_004"><span class="cls_004">it:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 464 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:323804px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background480.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Finally, try to open the following URL: </span><a href="https://localhost:1443/share/">https://localhost:1443/share/</a> <span class="cls_004">, and you'll</span></div>
<div style="position:absolute;left:56.69px;top:83.78px" class="cls_004"><span class="cls_004">access Alfresco Share and you'll be authenticated using the username that you used in CAS.</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">You'll notice that you can use any username and it will authenticate you. It's because we use</span></div>
<div style="position:absolute;left:56.69px;top:108.98px" class="cls_004"><span class="cls_004">the standard CAS web application that just validates that the username matches the</span></div>
<div style="position:absolute;left:56.69px;top:121.58px" class="cls_004"><span class="cls_004">password. The next step is to configure CAS to validate the authentication against LDAP.</span></div>
<div style="position:absolute;left:56.69px;top:156.23px" class="cls_023"><span class="cls_023">Logging Out</span></div>
<div style="position:absolute;left:56.69px;top:178.94px" class="cls_004"><span class="cls_004">You'll notice that the Logout link disappeared from Share because we enabled SSO. You</span></div>
<div style="position:absolute;left:56.69px;top:191.54px" class="cls_004"><span class="cls_004">may want to recreate this link. You just need to create a new menu item as we already did</span></div>
<div style="position:absolute;left:56.69px;top:204.14px" class="cls_004"><span class="cls_004">in the previous chapter redirecting to the CAS logout page. It will invalidate the session,</span></div>
<div style="position:absolute;left:56.69px;top:216.74px" class="cls_004"><span class="cls_004">and the user will have to re-login if he wants to access Alfresco Share.</span></div>
<div style="position:absolute;left:56.69px;top:253.44px" class="cls_014"><span class="cls_014">Step-by-step - configuring CAS to use LDAP for</span></div>
<div style="position:absolute;left:56.69px;top:275.04px" class="cls_014"><span class="cls_014">authentication</span></div>
<div style="position:absolute;left:56.69px;top:300.26px" class="cls_004"><span class="cls_004">This really has nothing to do with Alfresco, but it completes the picture. At this point, CAS</span></div>
<div style="position:absolute;left:56.69px;top:312.86px" class="cls_004"><span class="cls_004">is letting in anyone who specifies a username that matches their password. What it needs to</span></div>
<div style="position:absolute;left:56.69px;top:325.46px" class="cls_004"><span class="cls_004">do is use the same </span><span class="cls_013">OpenLDAP</span><span class="cls_004"> directory for authentication we pointed Alfresco to earlier.</span></div>
<div style="position:absolute;left:56.69px;top:338.74px" class="cls_004"><span class="cls_004">This involves creating a new WAR file with LDAP dependencies, and then changing the</span></div>
<div style="position:absolute;left:56.69px;top:351.34px" class="cls_004"><span class="cls_004">LDAP configuration.</span></div>
<div style="position:absolute;left:56.69px;top:372.94px" class="cls_004"><span class="cls_004">To get CAS working with LDAP, do this:</span></div>
<div style="position:absolute;left:91.32px;top:394.67px" class="cls_004"><span class="cls_004">1. First, we need to install Maven:</span></div>
<div style="position:absolute;left:117.89px;top:417.88px" class="cls_010"><span class="cls_010">cd /opt</span></div>
<div style="position:absolute;left:117.89px;top:428.68px" class="cls_010"><span class="cls_010">wget </span><a href="http://mirrors.ukfast.co.uk/sites/">http://mirrors.ukfast.co.uk/sites</a> </div>
<div style="position:absolute;left:117.89px;top:439.48px" class="cls_010"><span class="cls_010">/ftp.apache.org/maven/maven-3/3.3.9/binaries</span></div>
<div style="position:absolute;left:117.89px;top:450.28px" class="cls_010"><span class="cls_010">/apache-maven-3.3.9-bin.zip</span></div>
<div style="position:absolute;left:117.89px;top:461.08px" class="cls_010"><span class="cls_010">unzip apache-maven-3.3.9-bin.zip</span></div>
<div style="position:absolute;left:117.89px;top:471.88px" class="cls_010"><span class="cls_010">ln -s apache-maven-3.3.9 maven</span></div>
<div style="position:absolute;left:91.32px;top:492.49px" class="cls_004"><span class="cls_004">2. Then, we need to set up some environment variables. Create the file</span></div>
<div style="position:absolute;left:104.69px;top:505.09px" class="cls_013"><span class="cls_013">|etc|profile.d|maven.sh</span><span class="cls_004"> and add the following content:</span></div>
<div style="position:absolute;left:117.89px;top:528.98px" class="cls_010"><span class="cls_010">#!/bin/bash</span></div>
<div style="position:absolute;left:117.89px;top:539.78px" class="cls_010"><span class="cls_010">MAVEN_HOME=/opt/maven</span></div>
<div style="position:absolute;left:117.89px;top:550.58px" class="cls_010"><span class="cls_010">PATH=$MAVEN_HOME/bin:$PATH</span></div>
<div style="position:absolute;left:117.89px;top:561.38px" class="cls_010"><span class="cls_010">export PATH MAVEN_HOME</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 465 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:324480px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background481.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">3. Because we don't want to restart our VM, we are just going to reload our file:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">source /etc/profile.d/maven.sh</span></div>
<div style="position:absolute;left:91.32px;top:114.32px" class="cls_004"><span class="cls_004">4. Double-check that Maven is installed by typing:</span></div>
<div style="position:absolute;left:117.89px;top:137.53px" class="cls_010"><span class="cls_010">mvn -v</span></div>
<div style="position:absolute;left:124.19px;top:158.01px" class="cls_004"><span class="cls_004">You should get a trace like this one:</span></div>
<div style="position:absolute;left:117.89px;top:178.93px" class="cls_010"><span class="cls_010">Apache Maven 3.3.9 (bb52d8502b132ec0a5a3f4c09453c07478323dc5;</span></div>
<div style="position:absolute;left:117.89px;top:189.73px" class="cls_010"><span class="cls_010">2015-11-10T16:41:47+00:00)</span></div>
<div style="position:absolute;left:117.89px;top:200.53px" class="cls_010"><span class="cls_010">Maven home: /opt/maven</span></div>
<div style="position:absolute;left:117.89px;top:211.33px" class="cls_010"><span class="cls_010">Java version: 1.8.0_65, vendor: Oracle Corporation</span></div>
<div style="position:absolute;left:117.89px;top:222.13px" class="cls_010"><span class="cls_010">Java home: /opt/alfresco-one/java</span></div>
<div style="position:absolute;left:117.89px;top:232.93px" class="cls_010"><span class="cls_010">Default locale: en_US, platform encoding: UTF-8</span></div>
<div style="position:absolute;left:117.89px;top:243.73px" class="cls_010"><span class="cls_010">OS name: "linux", version: "3.10.0-327.el7.x86_64",</span></div>
<div style="position:absolute;left:117.89px;top:254.53px" class="cls_010"><span class="cls_010">arch: "amd64", family: "unix"</span></div>
<div style="position:absolute;left:91.32px;top:275.14px" class="cls_004"><span class="cls_004">5. We can build our own CAS web application. The first step is to create the</span></div>
<div style="position:absolute;left:104.69px;top:287.74px" class="cls_004"><span class="cls_004">required folder structure:</span></div>
<div style="position:absolute;left:117.89px;top:310.95px" class="cls_010"><span class="cls_010">cd /root</span></div>
<div style="position:absolute;left:117.89px;top:321.75px" class="cls_010"><span class="cls_010">mkdir -p custom-cas-server/src/main/webapp/WEB-INF/</span></div>
<div style="position:absolute;left:117.89px;top:332.55px" class="cls_010"><span class="cls_010">cd custom-cas-server</span></div>
<div style="position:absolute;left:91.32px;top:353.16px" class="cls_004"><span class="cls_004">6. Let's create the file </span><span class="cls_013">pom.xml</span><span class="cls_004"> in the current folder. This file will define what we</span></div>
<div style="position:absolute;left:104.69px;top:366.44px" class="cls_004"><span class="cls_004">need to create our custom CAS web application. Let's create the main structure:</span></div>
<div style="position:absolute;left:117.89px;top:389.65px" class="cls_010"><span class="cls_010">&lt;?xml version="1.0"?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:400.45px" class="cls_010"><span class="cls_010">&lt;project xmlns="</span><a href="http://maven.apache.org/pom/4.0.0" "="">http://maven.apache.org/POM/4.0.0"</a> </div>
<div style="position:absolute;left:117.89px;top:411.25px" class="cls_010"><span class="cls_010">xmlns:xsi="</span><a href="http://www.w3.org/2001/xmlschema-instance" "="">http://www.w3.org/2001/XMLSchema-instance"</a> </div>
<div style="position:absolute;left:117.89px;top:422.05px" class="cls_010"><span class="cls_010">xsi:schemaLocation="</span><a href="http://maven.apache.org/pom/4.0.0/">http://maven.apache.org/POM/4.0.0</a> </div>
<div style="position:absolute;left:117.89px;top:432.85px" class="cls_010"><span class="cls_010"> </span><a href="http://maven.apache.org/maven-v4_0_0.xsd" "="">http://maven.apache.org/maven-v4_0_0.xsd"</a>&gt;</div>
<div style="position:absolute;left:128.69px;top:443.65px" class="cls_010"><span class="cls_010">&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span></div>
<div style="position:absolute;left:128.69px;top:454.45px" class="cls_010"><span class="cls_010">&lt;groupId&gt;com.someco.cas&lt;/groupId&gt;</span></div>
<div style="position:absolute;left:128.69px;top:465.25px" class="cls_010"><span class="cls_010">&lt;artifactId&gt;someco-cas&lt;/artifactId&gt;</span></div>
<div style="position:absolute;left:128.69px;top:476.05px" class="cls_010"><span class="cls_010">&lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;</span></div>
<div style="position:absolute;left:134.09px;top:486.85px" class="cls_010"><span class="cls_010">&lt;packaging&gt;war&lt;/packaging&gt;</span></div>
<div style="position:absolute;left:128.69px;top:497.65px" class="cls_010"><span class="cls_010">&lt;name&gt;SomeCo CAS webapp&lt;/name&gt;</span></div>
<div style="position:absolute;left:128.69px;top:508.45px" class="cls_010"><span class="cls_010">&lt;organization&gt;</span></div>
<div style="position:absolute;left:139.49px;top:519.25px" class="cls_010"><span class="cls_010">&lt;name&gt;SomeCo&lt;/name&gt;</span></div>
<div style="position:absolute;left:139.49px;top:530.05px" class="cls_010"><span class="cls_010">&lt;url&gt;</span><a href="http://www.someco.com%3C/url/">http://www.someco.com&lt;/url</a>&gt;</div>
<div style="position:absolute;left:128.69px;top:540.85px" class="cls_010"><span class="cls_010">&lt;/organization&gt;</span></div>
<div style="position:absolute;left:128.69px;top:551.65px" class="cls_010"><span class="cls_010">&lt;description&gt;SomeCo's configuration of the</span></div>
<div style="position:absolute;left:139.49px;top:562.45px" class="cls_010"><span class="cls_010">JA-SIG CAS server.&lt;/description&gt;</span></div>
<div style="position:absolute;left:117.89px;top:573.25px" class="cls_010"><span class="cls_010">&lt;/project&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 466 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:325156px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background482.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Then, in the </span><span class="cls_013">project</span><span class="cls_004"> element, we'll add the following </span><span class="cls_013">dependencies</span><span class="cls_004"> elements.</span></div>
<div style="position:absolute;left:104.69px;top:83.78px" class="cls_004"><span class="cls_004">We have three dependencies: (1) the main WAR file containing the web</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">application; (2) the main CAS library; (3) the library to use LDAP:</span></div>
<div style="position:absolute;left:117.89px;top:119.59px" class="cls_010"><span class="cls_010">&lt;dependencies&gt;</span></div>
<div style="position:absolute;left:128.69px;top:130.39px" class="cls_010"><span class="cls_010">&lt;dependency&gt;</span></div>
<div style="position:absolute;left:139.49px;top:141.19px" class="cls_010"><span class="cls_010">&lt;groupId&gt;org.jasig.cas&lt;/groupId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:151.99px" class="cls_010"><span class="cls_010">&lt;artifactId&gt;cas-server-webapp&lt;/artifactId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:162.79px" class="cls_010"><span class="cls_010">&lt;version&gt;3.6.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:139.49px;top:173.59px" class="cls_010"><span class="cls_010">&lt;type&gt;war&lt;/type&gt;</span></div>
<div style="position:absolute;left:128.69px;top:184.39px" class="cls_010"><span class="cls_010">&lt;/dependency&gt;</span></div>
<div style="position:absolute;left:128.69px;top:195.19px" class="cls_010"><span class="cls_010">&lt;dependency&gt;</span></div>
<div style="position:absolute;left:139.49px;top:205.99px" class="cls_010"><span class="cls_010">&lt;groupId&gt;org.jasig.cas&lt;/groupId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:216.79px" class="cls_010"><span class="cls_010">&lt;artifactId&gt;cas-server-core&lt;/artifactId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:227.59px" class="cls_010"><span class="cls_010">&lt;version&gt;3.6.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:128.69px;top:238.39px" class="cls_010"><span class="cls_010">&lt;/dependency&gt;</span></div>
<div style="position:absolute;left:128.69px;top:249.19px" class="cls_010"><span class="cls_010">&lt;dependency&gt;</span></div>
<div style="position:absolute;left:139.49px;top:259.99px" class="cls_010"><span class="cls_010">&lt;groupId&gt;org.jasig.cas&lt;/groupId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:270.79px" class="cls_010"><span class="cls_010">&lt;artifactId&gt;cas-server-support-ldap&lt;/artifactId&gt;</span></div>
<div style="position:absolute;left:139.49px;top:281.59px" class="cls_010"><span class="cls_010">&lt;version&gt;3.6.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:128.69px;top:292.39px" class="cls_010"><span class="cls_010">&lt;/dependency&gt;</span></div>
<div style="position:absolute;left:117.89px;top:303.19px" class="cls_010"><span class="cls_010">&lt;/dependencies&gt;</span></div>
<div style="position:absolute;left:91.32px;top:323.80px" class="cls_004"><span class="cls_004">8. Then, we need to customize the building of the WAR file by specifying, for</span></div>
<div style="position:absolute;left:104.69px;top:336.40px" class="cls_004"><span class="cls_004">example, the name of the WAR file that we want:</span></div>
<div style="position:absolute;left:117.89px;top:359.61px" class="cls_010"><span class="cls_010">&lt;build&gt;</span></div>
<div style="position:absolute;left:128.69px;top:370.41px" class="cls_010"><span class="cls_010">&lt;finalName&gt;cas&lt;/finalName&gt;</span></div>
<div style="position:absolute;left:128.69px;top:381.21px" class="cls_010"><span class="cls_010">&lt;plugins&gt;</span></div>
<div style="position:absolute;left:139.49px;top:392.01px" class="cls_010"><span class="cls_010">&lt;plugin&gt;</span></div>
<div style="position:absolute;left:150.29px;top:402.81px" class="cls_010"><span class="cls_010">&lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;</span></div>
<div style="position:absolute;left:150.29px;top:413.61px" class="cls_010"><span class="cls_010">&lt;version&gt;3.0&lt;/version&gt;</span></div>
<div style="position:absolute;left:150.29px;top:424.41px" class="cls_010"><span class="cls_010">&lt;configuration&gt;</span></div>
<div style="position:absolute;left:161.09px;top:435.21px" class="cls_010"><span class="cls_010">&lt;source&gt;1.5&lt;/source&gt;</span></div>
<div style="position:absolute;left:161.09px;top:446.01px" class="cls_010"><span class="cls_010">&lt;target&gt;1.5&lt;/target&gt;</span></div>
<div style="position:absolute;left:150.29px;top:456.81px" class="cls_010"><span class="cls_010">&lt;/configuration&gt;</span></div>
<div style="position:absolute;left:139.49px;top:467.61px" class="cls_010"><span class="cls_010">&lt;/plugin&gt;</span></div>
<div style="position:absolute;left:128.69px;top:478.41px" class="cls_010"><span class="cls_010">&lt;/plugins&gt;</span></div>
<div style="position:absolute;left:117.89px;top:489.21px" class="cls_010"><span class="cls_010">&lt;/build&gt;</span></div>
<div style="position:absolute;left:91.32px;top:509.82px" class="cls_004"><span class="cls_004">9. And, we finally need to configure this file to specify where the CAS dependencies</span></div>
<div style="position:absolute;left:104.69px;top:522.42px" class="cls_004"><span class="cls_004">should be downloaded:</span></div>
<div style="position:absolute;left:117.89px;top:545.63px" class="cls_010"><span class="cls_010">&lt;repositories&gt;</span></div>
<div style="position:absolute;left:128.69px;top:556.43px" class="cls_010"><span class="cls_010">&lt;repository&gt;</span></div>
<div style="position:absolute;left:139.49px;top:567.23px" class="cls_010"><span class="cls_010">&lt;id&gt;jasig-repository&lt;/id&gt;</span></div>
<div style="position:absolute;left:139.49px;top:578.03px" class="cls_010"><span class="cls_010">&lt;name&gt;JA-SIG Maven2 Repository&lt;/name&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 467 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:325832px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background483.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">&lt;url&gt;</span><a href="http://developer.ja-sig.org/maven2%3C/url/">http://developer.ja-sig.org/maven2&lt;/url</a>&gt;</div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/repository&gt;</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/repositories&gt;</span></div>
<div style="position:absolute;left:86.07px;top:112.03px" class="cls_004"><span class="cls_004">10.</span></div>
<div style="position:absolute;left:104.69px;top:112.03px" class="cls_004"><span class="cls_004">The Maven file is now ready. However, we still have one last step. Create the file</span></div>
<div style="position:absolute;left:104.69px;top:124.63px" class="cls_013"><span class="cls_013">deployerConfigContext.xml</span><span class="cls_004"> in the folder </span><span class="cls_013">|root|custom-cas-</span></div>
<div style="position:absolute;left:104.69px;top:137.91px" class="cls_013"><span class="cls_013">server|src|main|webapp|WEB-INF</span><span class="cls_004">. The file is a bit lengthy but you can find it</span></div>
<div style="position:absolute;left:104.69px;top:151.19px" class="cls_004"><span class="cls_004">in the code attached to this chapter. Let's start by creating the bean that handles</span></div>
<div style="position:absolute;left:104.69px;top:163.79px" class="cls_004"><span class="cls_004">the authentication handlers:</span></div>
<div style="position:absolute;left:117.89px;top:187.00px" class="cls_010"><span class="cls_010">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:197.80px" class="cls_010"><span class="cls_010">&lt;beans xmlns="</span><a href="http://www.springframework.org/schema/beans" "="">http://www.springframework.org/schema/beans"</a> </div>
<div style="position:absolute;left:117.89px;top:208.60px" class="cls_010"><span class="cls_010">xmlns:xsi="</span><a href="http://www.w3.org/2001/xmlschema-instance" "="">http://www.w3.org/2001/XMLSchema-instance"</a> </div>
<div style="position:absolute;left:123.29px;top:219.40px" class="cls_010"><span class="cls_010">xmlns:p="</span><a href="http://www.springframework.org/schema/p" "="">http://www.springframework.org/schema/p"</a> </div>
<div style="position:absolute;left:117.89px;top:230.20px" class="cls_010"><span class="cls_010">xmlns:tx="</span><a href="http://www.springframework.org/schema/tx" "="">http://www.springframework.org/schema/tx"</a> </div>
<div style="position:absolute;left:117.89px;top:241.00px" class="cls_010"><span class="cls_010">xmlns:sec="</span><a href="http://www.springframework.org/schema/security" "="">http://www.springframework.org/schema/security"</a> </div>
<div style="position:absolute;left:117.89px;top:251.80px" class="cls_010"><span class="cls_010">xsi:schemaLocation="</span><a href="http://www.springframework.org/schema/beans/">http://www.springframework.org/schema/beans</a> </div>
<div style="position:absolute;left:117.89px;top:262.60px" class="cls_010"><span class="cls_010"> </span><a href="http://www.springframework.org/schema/beans/spring-beans-3.1.xsd/">http://www.springframework.org/schema/beans/spring-beans-3.1.xsd</a> </div>
<div style="position:absolute;left:123.29px;top:273.40px" class="cls_010"><span class="cls_010"> </span><a href="http://www.springframework.org/schema/tx/">http://www.springframework.org/schema/tx</a> </div>
<div style="position:absolute;left:117.89px;top:284.20px" class="cls_010"><span class="cls_010"> </span><a href="http://www.springframework.org/schema/tx/spring-tx-3.1.xsd/">http://www.springframework.org/schema/tx/spring-tx-3.1.xsd</a> </div>
<div style="position:absolute;left:117.89px;top:295.00px" class="cls_010"><span class="cls_010"> </span><a href="http://www.springframework.org/schema/security/">http://www.springframework.org/schema/security</a> </div>
<div style="position:absolute;left:117.89px;top:305.80px" class="cls_010"><span class="cls_010"> </span><a href="http://www.springframework.org/schema/security/">http://www.springframework.org/schema/security</a> </div>
<div style="position:absolute;left:117.89px;top:316.60px" class="cls_010"><span class="cls_010">/spring-security-3.1.xsd"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:327.40px" class="cls_010"><span class="cls_010">&lt;bean id="authenticationManager"</span></div>
<div style="position:absolute;left:117.89px;top:338.20px" class="cls_010"><span class="cls_010">class="org.jasig.cas.authentication.AuthenticationManagerImpl"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:349.00px" class="cls_010"><span class="cls_010">&lt;property name="credentialsToPrincipalResolvers"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:359.80px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:370.60px" class="cls_010"><span class="cls_010">&lt;bean</span></div>
<div style="position:absolute;left:161.09px;top:381.40px" class="cls_010"><span class="cls_010">class="org.jasig.cas.authentication.principal</span></div>
<div style="position:absolute;left:161.09px;top:392.20px" class="cls_010"><span class="cls_010">.UsernamePasswordCredentialsToPrincipalResolver"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:403.00px" class="cls_010"><span class="cls_010">&lt;property name="attributeRepository"</span></div>
<div style="position:absolute;left:161.09px;top:413.80px" class="cls_010"><span class="cls_010">ref="attributeRepository"/&gt;</span></div>
<div style="position:absolute;left:150.29px;top:424.60px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:150.29px;top:435.40px" class="cls_010"><span class="cls_010">&lt;bean</span></div>
<div style="position:absolute;left:161.09px;top:446.20px" class="cls_010"><span class="cls_010">class="org.jasig.cas.authentication.principal</span></div>
<div style="position:absolute;left:161.09px;top:457.00px" class="cls_010"><span class="cls_010">.HttpBasedServiceCredentialsToPrincipalResolver"/&gt;</span></div>
<div style="position:absolute;left:139.49px;top:467.80px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:478.60px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:128.69px;top:489.40px" class="cls_010"><span class="cls_010">&lt;property name="authenticationHandlers"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:500.20px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:511.00px" class="cls_010"><span class="cls_010">&lt;bean</span></div>
<div style="position:absolute;left:161.09px;top:521.80px" class="cls_010"><span class="cls_010">class="org.jasig.cas.authentication.handler</span></div>
<div style="position:absolute;left:161.09px;top:532.60px" class="cls_010"><span class="cls_010">.support.HttpBasedServiceCredentialsAuthenticationHandler"</span></div>
<div style="position:absolute;left:161.09px;top:543.40px" class="cls_010"><span class="cls_010">p:httpClient-ref="httpClient"/&gt;</span></div>
<div style="position:absolute;left:150.29px;top:554.20px" class="cls_010"><span class="cls_010">&lt;bean class="org.jasig.cas.adaptors.ldap</span></div>
<div style="position:absolute;left:139.49px;top:565.00px" class="cls_010"><span class="cls_010">.BindLdapAuthenticationHandler"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:575.80px" class="cls_010"><span class="cls_010">&lt;property name="filter" value="uid=%u"/&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 468 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:326508px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background484.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:161.09px;top:69.82px" class="cls_010"><span class="cls_010">&lt;property name="searchBase"</span></div>
<div style="position:absolute;left:161.09px;top:80.62px" class="cls_010"><span class="cls_010">value="ou=People,dc=someco,dc=com"/&gt;</span></div>
<div style="position:absolute;left:161.09px;top:91.42px" class="cls_010"><span class="cls_010">&lt;property name="contextSource" ref="contextSource"/&gt;</span></div>
<div style="position:absolute;left:150.29px;top:102.22px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:139.49px;top:113.02px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:123.82px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:134.62px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:86.07px;top:166.03px" class="cls_004"><span class="cls_004">11. Then, let's add the bean that defines how to connect to our local LDAP instance:</span></div>
<div style="position:absolute;left:117.89px;top:189.24px" class="cls_010"><span class="cls_010">&lt;bean id="contextSource"</span></div>
<div style="position:absolute;left:117.89px;top:200.04px" class="cls_010"><span class="cls_010">class="org.springframework.ldap.core.support.LdapContextSource"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:210.84px" class="cls_010"><span class="cls_010">&lt;property name="pooled" value="true"/&gt;</span></div>
<div style="position:absolute;left:128.69px;top:221.64px" class="cls_010"><span class="cls_010">&lt;property name="urls"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:232.44px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:243.24px" class="cls_010"><span class="cls_010">&lt;value&gt;ldap://localhost:389/&lt;/value&gt;</span></div>
<div style="position:absolute;left:139.49px;top:254.04px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:264.84px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:128.69px;top:275.64px" class="cls_010"><span class="cls_010">&lt;property name="userDn" value="cn=Manager,dc=someco,dc=com"/&gt;</span></div>
<div style="position:absolute;left:128.69px;top:286.44px" class="cls_010"><span class="cls_010">&lt;property name="password" value="secret"/&gt;</span></div>
<div style="position:absolute;left:128.69px;top:297.24px" class="cls_010"><span class="cls_010">&lt;property name="baseEnvironmentProperties"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:308.04px" class="cls_010"><span class="cls_010">&lt;map&gt;</span></div>
<div style="position:absolute;left:150.29px;top:318.84px" class="cls_010"><span class="cls_010">&lt;entry&gt;</span></div>
<div style="position:absolute;left:161.09px;top:329.64px" class="cls_010"><span class="cls_010">&lt;key&gt;</span></div>
<div style="position:absolute;left:171.89px;top:340.44px" class="cls_010"><span class="cls_010">&lt;value&gt;java.naming.security.authentication&lt;/value&gt;</span></div>
<div style="position:absolute;left:161.09px;top:351.24px" class="cls_010"><span class="cls_010">&lt;/key&gt;</span></div>
<div style="position:absolute;left:161.09px;top:362.04px" class="cls_010"><span class="cls_010">&lt;value&gt;simple&lt;/value&gt;</span></div>
<div style="position:absolute;left:150.29px;top:372.84px" class="cls_010"><span class="cls_010">&lt;/entry&gt;</span></div>
<div style="position:absolute;left:139.49px;top:383.64px" class="cls_010"><span class="cls_010">&lt;/map&gt;</span></div>
<div style="position:absolute;left:128.69px;top:394.44px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:405.24px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:425.85px" class="cls_004"><span class="cls_004">12. Finally, we need to add some other beans required by CAS:</span></div>
<div style="position:absolute;left:117.89px;top:449.06px" class="cls_010"><span class="cls_010">&lt;user-service id="userDetailsService"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:459.86px" class="cls_010"><span class="cls_010">&lt;user name="admin" password="notused"</span></div>
<div style="position:absolute;left:139.49px;top:470.66px" class="cls_010"><span class="cls_010">authorities="ROLE_ADMIN"/&gt;</span></div>
<div style="position:absolute;left:117.89px;top:481.46px" class="cls_010"><span class="cls_010">&lt;/user-service&gt;</span></div>
<div style="position:absolute;left:117.89px;top:492.26px" class="cls_010"><span class="cls_010">&lt;bean id="attributeRepository"</span></div>
<div style="position:absolute;left:139.49px;top:503.06px" class="cls_010"><span class="cls_010">class="org.jasig.services.persondir</span></div>
<div style="position:absolute;left:139.49px;top:513.86px" class="cls_010"><span class="cls_010">.support.StubPersonAttributeDao"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:524.66px" class="cls_010"><span class="cls_010">&lt;property name="backingMap"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:535.46px" class="cls_010"><span class="cls_010">&lt;map&gt;</span></div>
<div style="position:absolute;left:150.29px;top:546.26px" class="cls_010"><span class="cls_010">&lt;entry key="uid" value="uid"/&gt;</span></div>
<div style="position:absolute;left:150.29px;top:557.06px" class="cls_010"><span class="cls_010">&lt;entry key="eduPersonAffiliation"</span></div>
<div style="position:absolute;left:161.09px;top:567.86px" class="cls_010"><span class="cls_010">value="eduPersonAffiliation"/&gt;</span></div>
<div style="position:absolute;left:150.29px;top:578.66px" class="cls_010"><span class="cls_010">&lt;entry key="groupMembership" value="groupMembership"/&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 469 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:327184px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background485.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/map&gt;</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">&lt;bean id="serviceRegistryDao"</span></div>
<div style="position:absolute;left:117.89px;top:113.02px" class="cls_010"><span class="cls_010">class="org.jasig.cas.services.InMemoryServiceRegistryDaoImpl"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:123.82px" class="cls_010"><span class="cls_010">&lt;property name="registeredServices"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:134.62px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:145.42px" class="cls_010"><span class="cls_010">&lt;bean class="org.jasig.cas.services.RegexRegisteredService"&gt;</span></div>
<div style="position:absolute;left:161.09px;top:156.22px" class="cls_010"><span class="cls_010">&lt;property name="id" value="0"/&gt;</span></div>
<div style="position:absolute;left:161.09px;top:167.02px" class="cls_010"><span class="cls_010">&lt;property name="name" value="HTTP and IMAP"/&gt;</span></div>
<div style="position:absolute;left:161.09px;top:177.82px" class="cls_010"><span class="cls_010">&lt;property name="description"</span></div>
<div style="position:absolute;left:161.09px;top:188.62px" class="cls_010"><span class="cls_010">value="Allows HTTP(S) and IMAP(S) protocols"/&gt;</span></div>
<div style="position:absolute;left:161.09px;top:199.42px" class="cls_010"><span class="cls_010">&lt;property name="serviceId" value="^(https?|imaps?)://.*"/&gt;</span></div>
<div style="position:absolute;left:161.09px;top:210.22px" class="cls_010"><span class="cls_010">&lt;property name="evaluationOrder" value="10000001"/&gt;</span></div>
<div style="position:absolute;left:150.29px;top:221.02px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:139.49px;top:231.82px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:242.62px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:253.42px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:117.89px;top:264.22px" class="cls_010"><span class="cls_010">&lt;bean id="auditTrailManager"</span></div>
<div style="position:absolute;left:117.89px;top:275.02px" class="cls_010"><span class="cls_010">class="com.github.inspektr.audit.support</span></div>
<div style="position:absolute;left:117.89px;top:285.82px" class="cls_010"><span class="cls_010">.Slf4jLoggingAuditTrailManager"/&gt;</span></div>
<div style="position:absolute;left:117.89px;top:296.62px" class="cls_010"><span class="cls_010">&lt;bean id="healthCheckMonitor"</span></div>
<div style="position:absolute;left:117.89px;top:307.42px" class="cls_010"><span class="cls_010">class="org.jasig.cas.monitor.HealthCheckMonitor"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:318.22px" class="cls_010"><span class="cls_010">&lt;property name="monitors"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:329.02px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:339.82px" class="cls_010"><span class="cls_010">&lt;bean class="org.jasig.cas.monitor.MemoryMonitor"</span></div>
<div style="position:absolute;left:161.09px;top:350.62px" class="cls_010"><span class="cls_010">freeMemoryWarnThreshold="10"/&gt;</span></div>
<div style="position:absolute;left:150.29px;top:361.42px" class="cls_010"><span class="cls_010">&lt;bean class="org.jasig.cas.monitor.SessionMonitor"</span></div>
<div style="position:absolute;left:161.09px;top:372.22px" class="cls_010"><span class="cls_010">ticketRegistry-ref="ticketRegistry"</span></div>
<div style="position:absolute;left:161.09px;top:383.02px" class="cls_010"><span class="cls_010">serviceTicketCountWarnThreshold="5000"</span></div>
<div style="position:absolute;left:161.09px;top:393.82px" class="cls_010"><span class="cls_010">sessionCountWarnThreshold="100000"/&gt;</span></div>
<div style="position:absolute;left:139.49px;top:404.62px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:415.42px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:426.22px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:446.83px" class="cls_004"><span class="cls_004">13.</span></div>
<div style="position:absolute;left:104.69px;top:446.83px" class="cls_004"><span class="cls_004">We are ready to package our custom CAS web application. Go to the</span></div>
<div style="position:absolute;left:104.69px;top:459.43px" class="cls_013"><span class="cls_013">|root|custom-cas-server</span><span class="cls_004"> folder and type:</span></div>
<div style="position:absolute;left:117.89px;top:483.32px" class="cls_010"><span class="cls_010">mvn clean package</span></div>
<div style="position:absolute;left:124.19px;top:503.80px" class="cls_004"><span class="cls_004">It will download all required artifacts and that may take a few minutes. Then</span></div>
<div style="position:absolute;left:124.19px;top:516.40px" class="cls_004"><span class="cls_004">you should get a trace like this one:</span></div>
<div style="position:absolute;left:117.89px;top:537.32px" class="cls_010"><span class="cls_010">[INFO] --- maven-war-plugin:2.2:war</span></div>
<div style="position:absolute;left:117.89px;top:548.12px" class="cls_010"><span class="cls_010">(default-war) @ someco-cas ---</span></div>
<div style="position:absolute;left:117.89px;top:558.92px" class="cls_010"><span class="cls_010">[INFO] Packaging webapp</span></div>
<div style="position:absolute;left:117.89px;top:569.72px" class="cls_010"><span class="cls_010">[INFO] Assembling webapp [someco-cas] in</span></div>
<div style="position:absolute;left:123.29px;top:580.52px" class="cls_010"><span class="cls_010">[/root/custom-cas-server/target/cas]</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 470 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:327860px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background486.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">[INFO] Processing war project</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">[INFO] Copying webapp resources</span></div>
<div style="position:absolute;left:123.29px;top:91.42px" class="cls_010"><span class="cls_010">[/root/custom-cas-server/src/main/webapp]</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">[INFO] Processing overlay</span></div>
<div style="position:absolute;left:123.29px;top:113.02px" class="cls_010"><span class="cls_010">[ id org.jasig.cas:cas-server-webapp]</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">[INFO] Webapp assembled in [2066 msecs]</span></div>
<div style="position:absolute;left:117.89px;top:134.62px" class="cls_010"><span class="cls_010">[INFO] Building war:</span></div>
<div style="position:absolute;left:123.29px;top:145.42px" class="cls_010"><span class="cls_010">/root/custom-cas-server/target/cas.war</span></div>
<div style="position:absolute;left:117.89px;top:156.22px" class="cls_010"><span class="cls_010">[INFO] WEB-INF/web.xml already added, skipping</span></div>
<div style="position:absolute;left:117.89px;top:167.02px" class="cls_010"><span class="cls_010">[INFO] ---------------------------------------</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">[INFO] BUILD SUCCESS</span></div>
<div style="position:absolute;left:117.89px;top:188.62px" class="cls_010"><span class="cls_010">[INFO] --------------------------------------</span></div>
<div style="position:absolute;left:117.89px;top:199.42px" class="cls_010"><span class="cls_010">[INFO] Total time: 7.713 s</span></div>
<div style="position:absolute;left:117.89px;top:210.22px" class="cls_010"><span class="cls_010">[INFO] Finished at: 2016-11-26T18:35:58+00:00</span></div>
<div style="position:absolute;left:117.89px;top:221.02px" class="cls_010"><span class="cls_010">[INFO] Final Memory: 11M/58M</span></div>
<div style="position:absolute;left:117.89px;top:231.82px" class="cls_010"><span class="cls_010">[INFO] ---------------------------------------</span></div>
<div style="position:absolute;left:86.07px;top:252.43px" class="cls_004"><span class="cls_004">14. Stop the Tomcat instance containing CAS:</span></div>
<div style="position:absolute;left:117.89px;top:275.64px" class="cls_010"><span class="cls_010">sh /opt/cas/bin/shutdown.sh</span></div>
<div style="position:absolute;left:86.07px;top:296.25px" class="cls_004"><span class="cls_004">15. Remove the existing CAS web application:</span></div>
<div style="position:absolute;left:117.89px;top:319.46px" class="cls_010"><span class="cls_010">rm -rf /opt/cas/webapps/cas*</span></div>
<div style="position:absolute;left:86.07px;top:340.07px" class="cls_004"><span class="cls_004">16. Then, move our custom web application to Tomcat:</span></div>
<div style="position:absolute;left:117.89px;top:363.28px" class="cls_010"><span class="cls_010">mv target/cas.war /opt/cas/webapps/</span></div>
<div style="position:absolute;left:86.07px;top:383.89px" class="cls_004"><span class="cls_004">17. Now restart your CAS Tomcat server and attempt to log in. You should be able to</span></div>
<div style="position:absolute;left:104.69px;top:396.49px" class="cls_004"><span class="cls_004">log in using any of the test users you loaded into LDAP.</span></div>
<div style="position:absolute;left:117.89px;top:419.70px" class="cls_010"><span class="cls_010">sh /opt/cas/bin/startup.sh</span></div>
<div style="position:absolute;left:56.69px;top:440.18px" class="cls_004"><span class="cls_004">You now have SSO working between Alfresco and two other webapps, and CAS is using</span></div>
<div style="position:absolute;left:56.69px;top:452.78px" class="cls_004"><span class="cls_004">your OpenLDAP directory for authentication. You can now try to log in to CAS using the</span></div>
<div style="position:absolute;left:56.69px;top:465.38px" class="cls_004"><span class="cls_004">user that you defined in your LDAP instance.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 471 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:328536px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background487.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:69.65px" class="cls_008"><span class="cls_008">Working with security services</span></div>
<div style="position:absolute;left:56.69px;top:97.38px" class="cls_004"><span class="cls_004">The first part of this chapter was about authentication, or knowing who the user is. This</span></div>
<div style="position:absolute;left:56.69px;top:109.98px" class="cls_004"><span class="cls_004">section is about authorization, which is about specifying what the user can do once he/she is</span></div>
<div style="position:absolute;left:56.69px;top:122.58px" class="cls_004"><span class="cls_004">authenticated. First, you'll see how to secure the admin user and give additional users</span></div>
<div style="position:absolute;left:56.69px;top:135.18px" class="cls_004"><span class="cls_004">admin rights. Then you'll learn how to use Alfresco's security services classes to create users</span></div>
<div style="position:absolute;left:56.69px;top:147.78px" class="cls_004"><span class="cls_004">and groups with the API. And finally, you'll see how to declare your own custom</span></div>
<div style="position:absolute;left:56.69px;top:160.38px" class="cls_004"><span class="cls_004">permission groups when the out-of-the-box permission groups don't meet your needs.</span></div>
<div style="position:absolute;left:56.69px;top:197.08px" class="cls_014"><span class="cls_014">Securing the admin user</span></div>
<div style="position:absolute;left:56.69px;top:222.30px" class="cls_004"><span class="cls_004">As you and everyone else in the world knows, the default password for Alfresco's admin</span></div>
<div style="position:absolute;left:56.69px;top:234.90px" class="cls_004"><span class="cls_004">account is </span><span class="cls_013">admin</span><span class="cls_004">. If you use the installer, it will prompt you for a password. If you are</span></div>
<div style="position:absolute;left:56.69px;top:248.18px" class="cls_004"><span class="cls_004">using Alfresco for authentication (and even if you aren't), you should change the password</span></div>
<div style="position:absolute;left:56.69px;top:260.78px" class="cls_004"><span class="cls_004">for the admin user after you set up your Alfresco instance. If you use LDAP or some other</span></div>
<div style="position:absolute;left:56.69px;top:273.38px" class="cls_004"><span class="cls_004">source for authentication and create an entry in the directory for </span><span class="cls_013">admin</span><span class="cls_004">, change the</span></div>
<div style="position:absolute;left:56.69px;top:286.66px" class="cls_004"><span class="cls_004">password for the admin user in that system. The admin is the all-powerful super user, and</span></div>
<div style="position:absolute;left:56.69px;top:299.26px" class="cls_004"><span class="cls_004">so securing the admin account is an important step.</span></div>
<div style="position:absolute;left:56.69px;top:335.96px" class="cls_014"><span class="cls_014">Granting additional users admin rights</span></div>
<div style="position:absolute;left:56.69px;top:361.18px" class="cls_004"><span class="cls_004">Most organizations have more than one person helping support the Alfresco infrastructure.</span></div>
<div style="position:absolute;left:56.69px;top:373.78px" class="cls_004"><span class="cls_004">You could share the admin password with whoever needs it, but a better practice is to</span></div>
<div style="position:absolute;left:56.69px;top:386.38px" class="cls_004"><span class="cls_004">assign admin rights to specific users.</span></div>
<div style="position:absolute;left:56.69px;top:407.98px" class="cls_004"><span class="cls_004">You have two main ways to grant administration rights to a user. The first one is to add a</span></div>
<div style="position:absolute;left:56.69px;top:420.58px" class="cls_004"><span class="cls_004">user to the special group called </span><span class="cls_013">ALFRESCO_ADMINISTRATORS</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:91.32px;top:442.99px" class="cls_004"><span class="cls_004">1. Log in to Alfresco Share as Administrator and click on </span><span class="cls_007">Admin Tools</span><span class="cls_004"> in the top</span></div>
<div style="position:absolute;left:104.69px;top:455.63px" class="cls_004"><span class="cls_004">banner.</span></div>
<div style="position:absolute;left:91.32px;top:470.39px" class="cls_004"><span class="cls_004">2. Click on </span><span class="cls_007">Groups</span><span class="cls_004"> in the left menu bar.</span></div>
<div style="position:absolute;left:91.32px;top:485.19px" class="cls_004"><span class="cls_004">3. Type </span><span class="cls_007">ALFRESCO</span><span class="cls_004"> in the search bar, and click on </span><span class="cls_007">Browse.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 472 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:329212px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background488.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:178.46px" class="cls_004"><span class="cls_004">4. Click on the group </span><span class="cls_013">ALFRESCO_ADMINISTRATORS</span><span class="cls_004">. You'll notice three available</span></div>
<div style="position:absolute;left:104.69px;top:191.74px" class="cls_004"><span class="cls_004">actions: (1) Create a new subgroup; (2) Add an existing group; (3) Add an</span></div>
<div style="position:absolute;left:104.69px;top:204.34px" class="cls_004"><span class="cls_004">existing user. If you already have an LDAP group with all your administrators,</span></div>
<div style="position:absolute;left:104.69px;top:216.94px" class="cls_004"><span class="cls_004">you can just add this group as a subgroup. Update LDAP and when it's</span></div>
<div style="position:absolute;left:104.69px;top:229.54px" class="cls_004"><span class="cls_004">resynchronized with Alfresco, it will automatically give administrator privileges</span></div>
<div style="position:absolute;left:104.69px;top:242.14px" class="cls_004"><span class="cls_004">to the new LDAP group members.</span></div>
<div style="position:absolute;left:124.19px;top:266.03px" class="cls_004"><span class="cls_004">In our case, we are just clicking on the </span><span class="cls_007">Add User</span><span class="cls_004"> icon. Search for the user you</span></div>
<div style="position:absolute;left:124.19px;top:278.67px" class="cls_004"><span class="cls_004">are looking for:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 473 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:329888px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background489.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">5. Click on </span><span class="cls_007">Add.</span></div>
<div style="position:absolute;left:124.19px;top:94.43px" class="cls_004"><span class="cls_004">The previous steps explain how to grant privilege access to a user using</span></div>
<div style="position:absolute;left:124.19px;top:107.03px" class="cls_004"><span class="cls_004">Alfresco Share. It's possible to configure this information at the configuration</span></div>
<div style="position:absolute;left:124.19px;top:119.63px" class="cls_004"><span class="cls_004">level. To achieve that, you need to update the </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:124.19px;top:132.91px" class="cls_013"><span class="cls_013">global.properties</span><span class="cls_004"> file located in </span><span class="cls_013">&lt;TOMCAT_HOME&gt;|shared|classes</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:124.19px;top:146.19px" class="cls_004"><span class="cls_004">However, the property that you can use is different depending on the</span></div>
<div style="position:absolute;left:124.19px;top:158.79px" class="cls_004"><span class="cls_004">authentication subsystem that you use, and some subsystems don't provide</span></div>
<div style="position:absolute;left:124.19px;top:171.39px" class="cls_004"><span class="cls_004">it:</span></div>
<div style="position:absolute;left:104.69px;top:193.12px" class="cls_004"><span class="cls_004">NTLM: Not available</span></div>
<div style="position:absolute;left:104.69px;top:207.88px" class="cls_004"><span class="cls_004">External: </span><span class="cls_013">external.authentication.defaultAdministratorUserNames</span></div>
<div style="position:absolute;left:104.69px;top:223.32px" class="cls_004"><span class="cls_004">* Kerberos: </span><span class="cls_013">kerberos.authentication.defaultAdministratorUserNames</span></div>
<div style="position:absolute;left:104.69px;top:238.76px" class="cls_004"><span class="cls_004">LDAP: </span><span class="cls_013">ldap.authentication.defaultAdministratorUserNames</span></div>
<div style="position:absolute;left:104.69px;top:254.20px" class="cls_004"><span class="cls_004">Passthru: </span><span class="cls_013">passthru.authentication.defaultAdministratorUserNames</span></div>
<div style="position:absolute;left:56.69px;top:278.77px" class="cls_004"><span class="cls_004">You can just re-define one of these properties in your file and override it with a comma</span></div>
<div style="position:absolute;left:56.69px;top:291.37px" class="cls_004"><span class="cls_004">separated list of usernames that should be configured as Alfresco administrator.</span></div>
<div style="position:absolute;left:56.69px;top:328.07px" class="cls_014"><span class="cls_014">Creating users and Groups Programmatically</span></div>
<div style="position:absolute;left:56.69px;top:353.29px" class="cls_004"><span class="cls_004">The easiest way to load users into Alfresco, if you don't have any use registry as LDAP, is to</span></div>
<div style="position:absolute;left:56.69px;top:365.89px" class="cls_004"><span class="cls_004">upload a CSV file as explained on this page:</span></div>
<div style="position:absolute;left:56.69px;top:378.49px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/tasks/admintools-upload-users.html">http://docs.alfresco.com/5.1/tasks/admintools-upload-users.html</a> <span class="cls_004">. But there may be</span></div>
<div style="position:absolute;left:56.69px;top:391.47px" class="cls_004"><span class="cls_004">times when you need to create users or groups dynamically with the API. For example, you</span></div>
<div style="position:absolute;left:56.69px;top:404.07px" class="cls_004"><span class="cls_004">might be writing a custom client that enables a user or group management. Or, you may</span></div>
<div style="position:absolute;left:56.69px;top:416.67px" class="cls_004"><span class="cls_004">need to create a bunch of service accounts used by different American states.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 474 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:330564px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background490.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">First, you should understand how users are stored. Every Alfresco user, whether</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">or not Alfresco is handling authentication, is stored in the </span><span class="cls_013">SpacesStore</span><span class="cls_004"> as a</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_013"><span class="cls_013">cm:person</span><span class="cls_004"> object. You can see these objects by using the node browser to navigate</span></div>
<div style="position:absolute;left:56.69px;top:109.66px" class="cls_004"><span class="cls_004">to System/People:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 475 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:331240px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background491.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Users managed by Alfresco (where Alfresco is the authentication source) are stored in the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_013"><span class="cls_013">alfrescoUserStore</span><span class="cls_004"> as </span><span class="cls_013">usr:user</span><span class="cls_004"> objects under System/People. Again, using the node</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">browser you can see these objects:</span></div>
<div style="position:absolute;left:56.69px;top:408.40px" class="cls_004"><span class="cls_004">Groups are stored in </span><span class="cls_013">SpacesStore</span><span class="cls_004"> as well as under System/Authorities as</span></div>
<div style="position:absolute;left:56.69px;top:421.68px" class="cls_013"><span class="cls_013">cm:authorityContainer</span><span class="cls_004">. The node browser for the Alfresco administrators group looks</span></div>
<div style="position:absolute;left:56.69px;top:434.96px" class="cls_004"><span class="cls_004">like this:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 476 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:331916px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background492.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:335.51px" class="cls_004"><span class="cls_004">You may have taken a look at the </span><span class="cls_013">userModel.xml</span><span class="cls_004"> model packaged in the</span></div>
<div style="position:absolute;left:56.69px;top:348.79px" class="cls_013"><span class="cls_013">org|alfresco|repo|security|authentication</span><span class="cls_004"> folder within the </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:362.07px" class="cls_013"><span class="cls_013">repository-*.jar</span><span class="cls_004"> available in the </span><span class="cls_013">WEB-INF|lib</span><span class="cls_004">folder of your Alfresco installation</span></div>
<div style="position:absolute;left:56.69px;top:375.35px" class="cls_004"><span class="cls_004">(you'll notice that this model is not located with all the other ones in </span><span class="cls_013">alfresco|model</span><span class="cls_004"> of</span></div>
<div style="position:absolute;left:56.69px;top:388.63px" class="cls_004"><span class="cls_004">the same JAR file). As you can tell by inspecting the model file, the </span><span class="cls_013">usr:user</span><span class="cls_004"> type inherits</span></div>
<div style="position:absolute;left:56.69px;top:401.91px" class="cls_004"><span class="cls_004">from </span><span class="cls_013">usr:authority</span><span class="cls_004">. If you look at the </span><span class="cls_013">contentModel.xml</span><span class="cls_004"> (located in</span></div>
<div style="position:absolute;left:56.69px;top:415.19px" class="cls_013"><span class="cls_013">alfresco|model</span><span class="cls_004">), groups aren't called groups at all. They are </span><span class="cls_013">cm:authorityContainer</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:428.47px" class="cls_004"><span class="cls_004">which inherit from </span><span class="cls_013">cm:authority</span><span class="cls_004"> and have an association to other authority objects</span></div>
<div style="position:absolute;left:56.69px;top:441.75px" class="cls_004"><span class="cls_004">(groups can contain both users and other groups).</span></div>
<div style="position:absolute;left:56.69px;top:463.35px" class="cls_004"><span class="cls_004">Knowing where and how users and groups are stored is important for troubleshooting and</span></div>
<div style="position:absolute;left:56.69px;top:475.95px" class="cls_004"><span class="cls_004">administrative tasks. It also explains why, when you create users through the API and if</span></div>
<div style="position:absolute;left:56.69px;top:488.55px" class="cls_004"><span class="cls_004">you are creating an Alfresco user (that is, Alfresco manages the user instead of LDAP), you</span></div>
<div style="position:absolute;left:56.69px;top:501.15px" class="cls_004"><span class="cls_004">have to create both the </span><span class="cls_013">usr:user</span><span class="cls_004"> object and the </span><span class="cls_013">cm:person</span><span class="cls_004"> object. As you'll see in the next</span></div>
<div style="position:absolute;left:56.69px;top:514.42px" class="cls_004"><span class="cls_004">exercise, the </span><span class="cls_013">AuthenticationService</span><span class="cls_004"> manages </span><span class="cls_013">usr:user</span><span class="cls_004"> objects while the</span></div>
<div style="position:absolute;left:56.69px;top:527.71px" class="cls_013"><span class="cls_013">PersonService</span><span class="cls_004"> is in charge of </span><span class="cls_013">cm:person</span><span class="cls_004"> objects.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 477 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:332592px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background493.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Step-by-step - creating users and groups through the</span></div>
<div style="position:absolute;left:56.69px;top:89.07px" class="cls_023"><span class="cls_023">Java services</span></div>
<div style="position:absolute;left:56.69px;top:111.78px" class="cls_004"><span class="cls_004">In this section, we are going to create users and groups in a Java-backed webscript that will</span></div>
<div style="position:absolute;left:56.69px;top:124.38px" class="cls_004"><span class="cls_004">generate an HTML output to review what the webscript accomplished. We'll quickly go</span></div>
<div style="position:absolute;left:56.69px;top:136.99px" class="cls_004"><span class="cls_004">through creating the webscript skeleton that we covered in </span><span class="cls_010">Chapter 7</span><span class="cls_004">, </span><span class="cls_012">Exposing Content</span></div>
<div style="position:absolute;left:56.69px;top:149.97px" class="cls_012"><span class="cls_012">through a RESTful API with Web Scripts</span><span class="cls_004">, but we'll spend more time on how we create a user</span></div>
<div style="position:absolute;left:56.69px;top:162.57px" class="cls_004"><span class="cls_004">and group in Java. We'll focus on creating users and groups based on American states.</span></div>
<div style="position:absolute;left:56.69px;top:184.17px" class="cls_004"><span class="cls_004">We could discuss the advantage of implementing this feature in a webscript. It's possible to</span></div>
<div style="position:absolute;left:56.69px;top:196.77px" class="cls_004"><span class="cls_004">use another way called bootstrap in Alfresco to import users and groups as explained on</span></div>
<div style="position:absolute;left:56.69px;top:209.37px" class="cls_004"><span class="cls_004">this page:</span></div>
<div style="position:absolute;left:56.69px;top:221.97px" class="cls_010"><span class="cls_010"> </span><a href="http://docs.alfresco.com/5.1/references/dev-extension-points-bootstrap.html">http://docs.alfresco.com/5.1/references/dev-extension-points-bootstrap.html</a> <span class="cls_004">. As</span></div>
<div style="position:absolute;left:56.69px;top:234.95px" class="cls_004"><span class="cls_004">you can see, it consists of writing some XML documents representing the data that you</span></div>
<div style="position:absolute;left:56.69px;top:247.55px" class="cls_004"><span class="cls_004">want to import, and then a Spring bean to ask Alfresco to load this data at startup. This</span></div>
<div style="position:absolute;left:56.69px;top:260.15px" class="cls_004"><span class="cls_004">capability can be very useful but it means that you can't execute it on demand. Let's assume</span></div>
<div style="position:absolute;left:56.69px;top:272.75px" class="cls_004"><span class="cls_004">that you want to deliver the first version of your application for only five American states.</span></div>
<div style="position:absolute;left:56.69px;top:285.35px" class="cls_004"><span class="cls_004">But then, you need to give access to five new states, so you'll need to follow the same</span></div>
<div style="position:absolute;left:56.69px;top:297.95px" class="cls_004"><span class="cls_004">process by defining a bunch of XML documents again. By using a webscript, you can run it</span></div>
<div style="position:absolute;left:56.69px;top:310.55px" class="cls_004"><span class="cls_004">whenever and wherever you want and will just create the missing groups or users.</span></div>
<div style="position:absolute;left:91.32px;top:332.28px" class="cls_004"><span class="cls_004">1. Let's start by creating a new folder in your repo project</span></div>
<div style="position:absolute;left:104.69px;top:344.10px" class="cls_013"><span class="cls_013">src|main|amp|config|alfresco|extension|templates|webscripts|com</span></div>
<div style="position:absolute;left:104.69px;top:356.88px" class="cls_013"><span class="cls_013">|someco|data</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:372.32px" class="cls_004"><span class="cls_004">2. Then, create the definition file, </span><span class="cls_013">init.get.desc.xml</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:396.21px" class="cls_010"><span class="cls_010">&lt;webscript&gt;</span></div>
<div style="position:absolute;left:128.69px;top:407.01px" class="cls_010"><span class="cls_010">&lt;shortname&gt;Initialize the repository</span></div>
<div style="position:absolute;left:139.49px;top:417.81px" class="cls_010"><span class="cls_010">for the SomeCo project&lt;/shortname&gt;</span></div>
<div style="position:absolute;left:128.69px;top:428.61px" class="cls_010"><span class="cls_010">&lt;url&gt;/someco/init&lt;/url&gt;</span></div>
<div style="position:absolute;left:128.69px;top:439.41px" class="cls_010"><span class="cls_010">&lt;format default="html"&gt;extension&lt;/format&gt;</span></div>
<div style="position:absolute;left:128.69px;top:450.21px" class="cls_010"><span class="cls_010">&lt;authentication&gt;admin&lt;/authentication&gt;</span></div>
<div style="position:absolute;left:128.69px;top:461.01px" class="cls_010"><span class="cls_010">&lt;transaction&gt;required&lt;/transaction&gt;</span></div>
<div style="position:absolute;left:117.89px;top:471.81px" class="cls_010"><span class="cls_010">&lt;/webscript&gt;</span></div>
<div style="position:absolute;left:91.32px;top:492.42px" class="cls_004"><span class="cls_004">3. Then, just copy the HTML Freemarker file, </span><span class="cls_013">init.get.html.ftl</span><span class="cls_004"> from the code</span></div>
<div style="position:absolute;left:104.69px;top:505.70px" class="cls_004"><span class="cls_004">attached to this chapter. The most interesting part is the </span><span class="cls_013">body</span><span class="cls_004"> element that</span></div>
<div style="position:absolute;left:104.69px;top:518.98px" class="cls_004"><span class="cls_004">displays all messages provided by the Java code:</span></div>
<div style="position:absolute;left:117.89px;top:542.19px" class="cls_010"><span class="cls_010">&lt;body&gt;</span></div>
<div style="position:absolute;left:128.69px;top:552.99px" class="cls_010"><span class="cls_010">&lt;div class="index"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:563.79px" class="cls_010"><span class="cls_010">&lt;div class="title"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:574.59px" class="cls_010"><span class="cls_010">&lt;h1&gt;Alfresco Artifacts Intialisation&lt;/h1&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 478 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:333268px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background494.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:139.49px;top:80.62px" class="cls_010"><span class="cls_010">&lt;div class="index-list"&gt;</span></div>
<div style="position:absolute;left:150.29px;top:91.42px" class="cls_010"><span class="cls_010">&lt;#list messages as message&gt;</span></div>
<div style="position:absolute;left:161.09px;top:102.22px" class="cls_010"><span class="cls_010">&lt;p&gt;${message}&lt;/p&gt;</span></div>
<div style="position:absolute;left:150.29px;top:113.02px" class="cls_010"><span class="cls_010">&lt;/#list&gt;</span></div>
<div style="position:absolute;left:139.49px;top:123.82px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:128.69px;top:134.62px" class="cls_010"><span class="cls_010">&lt;/div&gt;</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">&lt;/body&gt;</span></div>
<div style="position:absolute;left:91.32px;top:166.03px" class="cls_004"><span class="cls_004">4. Update the </span><span class="cls_013">webscript-context.xml</span><span class="cls_004"> fileto create the association between the</span></div>
<div style="position:absolute;left:104.69px;top:179.31px" class="cls_004"><span class="cls_004">webscript definition and the Java class by adding the following bean:</span></div>
<div style="position:absolute;left:117.89px;top:202.52px" class="cls_010"><span class="cls_010">&lt;bean id="webscript.com.someco.data.init.get"</span></div>
<div style="position:absolute;left:117.89px;top:213.32px" class="cls_010"><span class="cls_010">class="com.someco.repo.scripts.InitializeRepository"</span></div>
<div style="position:absolute;left:123.29px;top:224.12px" class="cls_010"><span class="cls_010">parent="webscript"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:234.92px" class="cls_010"><span class="cls_010">&lt;property name="serviceRegistry" ref="ServiceRegistry" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:245.72px" class="cls_010"><span class="cls_010">&lt;property name="alfrescoGlobalProperties"</span></div>
<div style="position:absolute;left:139.49px;top:256.52px" class="cls_010"><span class="cls_010">ref="global-properties" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:267.32px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:91.32px;top:287.93px" class="cls_004"><span class="cls_004">5. Open </span><span class="cls_013">alfresco-global.properties</span><span class="cls_004"> in</span></div>
<div style="position:absolute;left:104.69px;top:301.21px" class="cls_013"><span class="cls_013">src|main|amp|config|alfresco|module|repo</span><span class="cls_004"> and add the following</span></div>
<div style="position:absolute;left:104.69px;top:314.49px" class="cls_004"><span class="cls_004">properties:</span></div>
<div style="position:absolute;left:117.89px;top:337.70px" class="cls_010"><span class="cls_010">someco.groups=AL,AK,AZ,AR,CA,CO,CT,DE,FL,GA,HI,ID,</span></div>
<div style="position:absolute;left:139.49px;top:348.50px" class="cls_010"><span class="cls_010">IL,IN,IA,KS,KY,LA,ME,MD,MA,MI,MN,MS,MO,MT,NE,NV,</span></div>
<div style="position:absolute;left:139.49px;top:359.30px" class="cls_010"><span class="cls_010">NH,NJ,NM,NY,NC,ND,OH,OK,OR,PA,RI,SC,SD,</span></div>
<div style="position:absolute;left:139.49px;top:370.10px" class="cls_010"><span class="cls_010">TN,TX,UT,VT,VA,WA,WV,WI,WY</span></div>
<div style="position:absolute;left:117.89px;top:380.90px" class="cls_010"><span class="cls_010">someco.groupDisplayName.AL=Alabama</span></div>
<div style="position:absolute;left:117.89px;top:391.70px" class="cls_010"><span class="cls_010">someco.groupDisplayName.AK=Alaska</span></div>
<div style="position:absolute;left:117.89px;top:402.50px" class="cls_010"><span class="cls_010">someco.groupDisplayName.AZ=Arizona</span></div>
<div style="position:absolute;left:117.89px;top:413.30px" class="cls_010"><span class="cls_010">someco.groupDisplayName.AR=Arkansas</span></div>
<div style="position:absolute;left:117.89px;top:424.10px" class="cls_010"><span class="cls_010">someco.groupDisplayName.CA=California</span></div>
<div style="position:absolute;left:117.89px;top:434.90px" class="cls_010"><span class="cls_010">someco.groupDisplayName.CO=Colorado</span></div>
<div style="position:absolute;left:117.89px;top:445.70px" class="cls_010"><span class="cls_010">someco.groupDisplayName.CT=Connecticut</span></div>
<div style="position:absolute;left:117.89px;top:456.50px" class="cls_010"><span class="cls_010">someco.groupDisplayName.DE=Delaware</span></div>
<div style="position:absolute;left:117.89px;top:467.30px" class="cls_010"><span class="cls_010">someco.groupDisplayName.FL=Florida</span></div>
<div style="position:absolute;left:117.89px;top:478.10px" class="cls_010"><span class="cls_010">someco.groupDisplayName.GA=Georgia</span></div>
<div style="position:absolute;left:117.89px;top:488.90px" class="cls_010"><span class="cls_010">someco.groupDisplayName.HI=Hawaii</span></div>
<div style="position:absolute;left:117.89px;top:499.70px" class="cls_010"><span class="cls_010">someco.groupDisplayName.ID=Idaho</span></div>
<div style="position:absolute;left:117.89px;top:510.50px" class="cls_010"><span class="cls_010">someco.groupDisplayName.IL=Illinois</span></div>
<div style="position:absolute;left:117.89px;top:521.30px" class="cls_010"><span class="cls_010">someco.groupDisplayName.IN=Indiana</span></div>
<div style="position:absolute;left:117.89px;top:532.10px" class="cls_010"><span class="cls_010">someco.groupDisplayName.IA=Iowa</span></div>
<div style="position:absolute;left:117.89px;top:542.90px" class="cls_010"><span class="cls_010">someco.groupDisplayName.KS=Kansas</span></div>
<div style="position:absolute;left:117.89px;top:553.70px" class="cls_010"><span class="cls_010">someco.groupDisplayName.KY=Kentucky</span></div>
<div style="position:absolute;left:117.89px;top:564.50px" class="cls_010"><span class="cls_010">someco.groupDisplayName.LA=Louisiana</span></div>
<div style="position:absolute;left:117.89px;top:575.30px" class="cls_010"><span class="cls_010">someco.groupDisplayName.ME=Maine</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 479 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:333944px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background495.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">someco.groupDisplayName.MD=Maryland</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">someco.groupDisplayName.MA=Massachusetts</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">someco.groupDisplayName.MI=Michigan</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">someco.groupDisplayName.MN=Minnesota</span></div>
<div style="position:absolute;left:117.89px;top:113.02px" class="cls_010"><span class="cls_010">someco.groupDisplayName.MS=Mississippi</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">someco.groupDisplayName.MO=Missouri</span></div>
<div style="position:absolute;left:117.89px;top:134.62px" class="cls_010"><span class="cls_010">someco.groupDisplayName.MT=Montana</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">someco.groupDisplayName.NE=Nebraska</span></div>
<div style="position:absolute;left:117.89px;top:156.22px" class="cls_010"><span class="cls_010">someco.groupDisplayName.NV=Nevada</span></div>
<div style="position:absolute;left:117.89px;top:167.02px" class="cls_010"><span class="cls_010">someco.groupDisplayName.NH=New Hampshire</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">someco.groupDisplayName.NJ=New Jersey</span></div>
<div style="position:absolute;left:117.89px;top:188.62px" class="cls_010"><span class="cls_010">someco.groupDisplayName.NM=New Mexico</span></div>
<div style="position:absolute;left:117.89px;top:199.42px" class="cls_010"><span class="cls_010">someco.groupDisplayName.NY=New York</span></div>
<div style="position:absolute;left:117.89px;top:210.22px" class="cls_010"><span class="cls_010">someco.groupDisplayName.NC=North Carolina</span></div>
<div style="position:absolute;left:117.89px;top:221.02px" class="cls_010"><span class="cls_010">someco.groupDisplayName.ND=North Dakota</span></div>
<div style="position:absolute;left:117.89px;top:231.82px" class="cls_010"><span class="cls_010">someco.groupDisplayName.OH=Ohio</span></div>
<div style="position:absolute;left:117.89px;top:242.62px" class="cls_010"><span class="cls_010">someco.groupDisplayName.OK=Oklahoma</span></div>
<div style="position:absolute;left:117.89px;top:253.42px" class="cls_010"><span class="cls_010">someco.groupDisplayName.OR=Oregon</span></div>
<div style="position:absolute;left:117.89px;top:264.22px" class="cls_010"><span class="cls_010">someco.groupDisplayName.PA=Pennsylvania</span></div>
<div style="position:absolute;left:117.89px;top:275.02px" class="cls_010"><span class="cls_010">someco.groupDisplayName.RI=Rhode Island</span></div>
<div style="position:absolute;left:117.89px;top:285.82px" class="cls_010"><span class="cls_010">someco.groupDisplayName.SC=South Carolina</span></div>
<div style="position:absolute;left:117.89px;top:296.62px" class="cls_010"><span class="cls_010">someco.groupDisplayName.SD=South Dakota</span></div>
<div style="position:absolute;left:117.89px;top:307.42px" class="cls_010"><span class="cls_010">someco.groupDisplayName.TN=Tennessee</span></div>
<div style="position:absolute;left:117.89px;top:318.22px" class="cls_010"><span class="cls_010">someco.groupDisplayName.TX=Texas</span></div>
<div style="position:absolute;left:117.89px;top:329.02px" class="cls_010"><span class="cls_010">someco.groupDisplayName.UT=Utah</span></div>
<div style="position:absolute;left:117.89px;top:339.82px" class="cls_010"><span class="cls_010">someco.groupDisplayName.VT=Vermont</span></div>
<div style="position:absolute;left:117.89px;top:350.62px" class="cls_010"><span class="cls_010">someco.groupDisplayName.VA=Virginia</span></div>
<div style="position:absolute;left:117.89px;top:361.42px" class="cls_010"><span class="cls_010">someco.groupDisplayName.WA=Washington</span></div>
<div style="position:absolute;left:117.89px;top:372.22px" class="cls_010"><span class="cls_010">someco.groupDisplayName.WV=West Virginia</span></div>
<div style="position:absolute;left:117.89px;top:383.02px" class="cls_010"><span class="cls_010">someco.groupDisplayName.WI=Wisconsin</span></div>
<div style="position:absolute;left:117.89px;top:393.82px" class="cls_010"><span class="cls_010">someco.groupDisplayName.WY=Wyoming</span></div>
<div style="position:absolute;left:91.32px;top:414.43px" class="cls_004"><span class="cls_004">6.</span></div>
<div style="position:absolute;left:104.69px;top:414.43px" class="cls_004"><span class="cls_004">It's now time to create the</span></div>
<div style="position:absolute;left:104.69px;top:427.03px" class="cls_013"><span class="cls_013">com.someco.repo.scripts.InitializeRepository</span><span class="cls_004"> Java class that will</span></div>
<div style="position:absolute;left:104.69px;top:440.31px" class="cls_004"><span class="cls_004">handle the creation of the users and the groups. We won't go into the details of</span></div>
<div style="position:absolute;left:104.69px;top:452.91px" class="cls_004"><span class="cls_004">the Java class as you already know how to do that. The first method that we add</span></div>
<div style="position:absolute;left:104.69px;top:465.51px" class="cls_004"><span class="cls_004">is to create a root group that calls another method:</span></div>
<div style="position:absolute;left:117.89px;top:488.72px" class="cls_010"><span class="cls_010">private List&lt;String&gt;checkGroup(String groupName,</span></div>
<div style="position:absolute;left:150.29px;top:499.52px" class="cls_010"><span class="cls_010">String groupDisplayName) {</span></div>
<div style="position:absolute;left:128.69px;top:510.32px" class="cls_010"><span class="cls_010">return checkGroup(groupName, groupDisplayName, null);</span></div>
<div style="position:absolute;left:117.89px;top:521.12px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 480 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:334620px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background496.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">7. Then, we create the method (called by the previous one) that creates a group in a</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">parent group:</span></div>
<div style="position:absolute;left:117.89px;top:106.31px" class="cls_010"><span class="cls_010">private List&lt;String&gt; checkGroup(String groupName,</span></div>
<div style="position:absolute;left:117.89px;top:117.11px" class="cls_010"><span class="cls_010">String groupDisplayName, String parentName) {</span></div>
<div style="position:absolute;left:128.69px;top:127.91px" class="cls_010"><span class="cls_010">Set&lt;String&gt; zones = Collections.singleton("APP.DEFAULT");</span></div>
<div style="position:absolute;left:128.69px;top:138.71px" class="cls_010"><span class="cls_010">List&lt;String&gt; messages = new ArrayList&lt;String&gt;();</span></div>
<div style="position:absolute;left:128.69px;top:160.31px" class="cls_010"><span class="cls_010">AuthorityService authorityService</span></div>
<div style="position:absolute;left:139.49px;top:171.11px" class="cls_010"><span class="cls_010">= serviceRegistry.getAuthorityService();</span></div>
<div style="position:absolute;left:128.69px;top:192.71px" class="cls_010"><span class="cls_010">if (authorityService.authorityExists(</span></div>
<div style="position:absolute;left:139.49px;top:203.51px" class="cls_010"><span class="cls_010">"GROUP_" + groupName.toUpperCase()))</span></div>
<div style="position:absolute;left:117.89px;top:214.31px" class="cls_010"><span class="cls_010">messages.add("The group " + groupName + " already exists.");</span></div>
<div style="position:absolute;left:128.69px;top:225.11px" class="cls_010"><span class="cls_010">else {</span></div>
<div style="position:absolute;left:139.49px;top:235.91px" class="cls_010"><span class="cls_010">String groupInfo = authorityService.createAuthority(</span></div>
<div style="position:absolute;left:139.49px;top:246.71px" class="cls_010"><span class="cls_010">AuthorityType.GROUP,</span></div>
<div style="position:absolute;left:139.49px;top:257.51px" class="cls_010"><span class="cls_010">groupName.toUpperCase(),</span></div>
<div style="position:absolute;left:139.49px;top:268.31px" class="cls_010"><span class="cls_010">groupDisplayName, zones);</span></div>
<div style="position:absolute;left:139.49px;top:279.11px" class="cls_010"><span class="cls_010">if (parentName != null)</span></div>
<div style="position:absolute;left:150.29px;top:289.91px" class="cls_010"><span class="cls_010">authorityService.addAuthority(</span></div>
<div style="position:absolute;left:161.09px;top:300.71px" class="cls_010"><span class="cls_010">"GROUP_" + parentName.toUpperCase(),</span></div>
<div style="position:absolute;left:161.09px;top:311.51px" class="cls_010"><span class="cls_010">"GROUP_" + groupName.toUpperCase());</span></div>
<div style="position:absolute;left:161.09px;top:322.31px" class="cls_010"><span class="cls_010">messages.add("The group " + groupInfo</span></div>
<div style="position:absolute;left:182.69px;top:333.11px" class="cls_010"><span class="cls_010">+ " has been created.");</span></div>
<div style="position:absolute;left:128.69px;top:343.91px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:128.69px;top:354.71px" class="cls_010"><span class="cls_010">return messages;</span></div>
<div style="position:absolute;left:117.89px;top:365.51px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:56.69px;top:385.99px" class="cls_004"><span class="cls_004">The first element that you notice is the creation of the </span><span class="cls_013">zones</span><span class="cls_004"> variable. Zones are used in</span></div>
<div style="position:absolute;left:56.69px;top:399.27px" class="cls_004"><span class="cls_004">Alfresco to partition authorities. For example, Alfresco uses zones to record from which</span></div>
<div style="position:absolute;left:56.69px;top:411.87px" class="cls_004"><span class="cls_004">LDAP the users and groups are synchronized. Zones are used to hide groups from the</span></div>
<div style="position:absolute;left:56.69px;top:424.47px" class="cls_004"><span class="cls_004">administration pages in Alfresco Share. Then, we check if the authority already exists. If it</span></div>
<div style="position:absolute;left:56.69px;top:437.07px" class="cls_004"><span class="cls_004">doesn't exist, we create the new group and assign it to a parent group if one has been</span></div>
<div style="position:absolute;left:56.69px;top:449.67px" class="cls_004"><span class="cls_004">provided.</span></div>
<div style="position:absolute;left:91.32px;top:471.40px" class="cls_004"><span class="cls_004">1. Then, in the </span><span class="cls_013">executeImpl</span><span class="cls_004"> method, after defining the variables that we'll need:</span></div>
<div style="position:absolute;left:117.89px;top:495.29px" class="cls_010"><span class="cls_010">PersonService personService = serviceRegistry.getPersonService();</span></div>
<div style="position:absolute;left:117.89px;top:506.09px" class="cls_010"><span class="cls_010">AuthorityService authorityService =</span></div>
<div style="position:absolute;left:139.49px;top:516.89px" class="cls_010"><span class="cls_010">serviceRegistry.getAuthorityService();</span></div>
<div style="position:absolute;left:117.89px;top:527.69px" class="cls_010"><span class="cls_010">MutableAuthenticationService authenticationService =</span></div>
<div style="position:absolute;left:117.89px;top:538.49px" class="cls_010"><span class="cls_010">serviceRegistry.getAuthenticationService();</span></div>
<div style="position:absolute;left:117.89px;top:549.29px" class="cls_010"><span class="cls_010">List&lt;String&gt; messages = new ArrayList&lt;String&gt;();</span></div>
<div style="position:absolute;left:117.89px;top:560.09px" class="cls_010"><span class="cls_010">Map&lt;String, Object&gt; model = new HashMap&lt;String, Object&gt;();</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 481 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:335296px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background497.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">2. And we create the root SomeCo group:</span></div>
<div style="position:absolute;left:117.89px;top:93.71px" class="cls_010"><span class="cls_010">messages.addAll(checkGroup("SOMECO", "Someco User Group"));</span></div>
<div style="position:absolute;left:91.32px;top:114.32px" class="cls_004"><span class="cls_004">3. We get the variable containing all groups that we want to create. For each of</span></div>
<div style="position:absolute;left:104.69px;top:126.92px" class="cls_004"><span class="cls_004">them, we retrieve the display name and we create the group in the root group</span></div>
<div style="position:absolute;left:104.69px;top:139.52px" class="cls_004"><span class="cls_004">that we created in the previous step:</span></div>
<div style="position:absolute;left:117.89px;top:162.73px" class="cls_010"><span class="cls_010">if (alfrescoGlobalProperties.containsKey("someco.groups")) {</span></div>
<div style="position:absolute;left:117.89px;top:173.53px" class="cls_010"><span class="cls_010">String[] groupNames = alfrescoGlobalProperties.getProperty(</span></div>
<div style="position:absolute;left:117.89px;top:184.33px" class="cls_010"><span class="cls_010">"someco.groups").split(",");</span></div>
<div style="position:absolute;left:128.69px;top:195.13px" class="cls_010"><span class="cls_010">for (String groupName : groupNames) {</span></div>
<div style="position:absolute;left:139.49px;top:205.93px" class="cls_010"><span class="cls_010">String groupDisplayName =</span></div>
<div style="position:absolute;left:117.89px;top:216.73px" class="cls_010"><span class="cls_010">alfrescoGlobalProperties.getProperty(</span></div>
<div style="position:absolute;left:117.89px;top:227.53px" class="cls_010"><span class="cls_010">"someco.groupDisplayName." + groupName);</span></div>
<div style="position:absolute;left:117.89px;top:238.33px" class="cls_010"><span class="cls_010">messages.addAll(</span></div>
<div style="position:absolute;left:117.89px;top:249.13px" class="cls_010"><span class="cls_010">checkGroup(groupName, groupDisplayName, "SOMECO"));</span></div>
<div style="position:absolute;left:117.89px;top:259.93px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:128.69px;top:270.73px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:117.89px;top:281.53px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:302.14px" class="cls_004"><span class="cls_004">4. After creating the group for each state, we just need to add below the creation of</span></div>
<div style="position:absolute;left:104.69px;top:314.74px" class="cls_004"><span class="cls_004">a user. For the username, we just add the underscore character at the end and at</span></div>
<div style="position:absolute;left:104.69px;top:327.34px" class="cls_004"><span class="cls_004">the beginning of the group name:</span></div>
<div style="position:absolute;left:117.89px;top:350.55px" class="cls_010"><span class="cls_010">String username = "_" + groupName + "_";</span></div>
<div style="position:absolute;left:117.89px;top:361.35px" class="cls_010"><span class="cls_010">if (personService.personExists(username)) {</span></div>
<div style="position:absolute;left:117.89px;top:372.15px" class="cls_010"><span class="cls_010">messages.add("The user " + username + " already exists.");</span></div>
<div style="position:absolute;left:117.89px;top:382.95px" class="cls_010"><span class="cls_010">} else {</span></div>
<div style="position:absolute;left:128.69px;top:393.75px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:117.89px;top:404.55px" class="cls_010"><span class="cls_010">}</span></div>
<div style="position:absolute;left:91.32px;top:425.16px" class="cls_004"><span class="cls_004">5. If the user doesn't exist, we create it, configure the password to be the same as the</span></div>
<div style="position:absolute;left:104.69px;top:437.76px" class="cls_004"><span class="cls_004">username and we add it to the relevant group:</span></div>
<div style="position:absolute;left:117.89px;top:460.97px" class="cls_010"><span class="cls_010">// Create the user</span></div>
<div style="position:absolute;left:117.89px;top:471.77px" class="cls_010"><span class="cls_010">HashMap&lt;QName, Serializable&gt; properties =</span></div>
<div style="position:absolute;left:117.89px;top:482.57px" class="cls_010"><span class="cls_010">new HashMap&lt;QName, Serializable&gt;();</span></div>
<div style="position:absolute;left:117.89px;top:493.37px" class="cls_010"><span class="cls_010">properties.put(ContentModel.PROP_USERNAME, username);</span></div>
<div style="position:absolute;left:117.89px;top:504.17px" class="cls_010"><span class="cls_010">properties.put(ContentModel.PROP_FIRSTNAME, "Service Account");</span></div>
<div style="position:absolute;left:117.89px;top:514.97px" class="cls_010"><span class="cls_010">properties.put(ContentModel.PROP_LASTNAME, groupName);</span></div>
<div style="position:absolute;left:117.89px;top:525.77px" class="cls_010"><span class="cls_010">properties.put(ContentModel.PROP_ORGANIZATION, "SomeCo");</span></div>
<div style="position:absolute;left:117.89px;top:536.57px" class="cls_010"><span class="cls_010">personService.createPerson(properties);</span></div>
<div style="position:absolute;left:117.89px;top:547.37px" class="cls_010"><span class="cls_010">// Create the authentication</span></div>
<div style="position:absolute;left:117.89px;top:558.17px" class="cls_010"><span class="cls_010">authenticationService.createAuthentication(username,</span></div>
<div style="position:absolute;left:117.89px;top:568.97px" class="cls_010"><span class="cls_010">username.toCharArray());</span></div>
<div style="position:absolute;left:117.89px;top:579.77px" class="cls_010"><span class="cls_010">authenticationService.setAuthenticationEnabled(username, true);</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 482 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:335972px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background498.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:117.89px;top:69.82px" class="cls_010"><span class="cls_010">// Add the user to the group</span></div>
<div style="position:absolute;left:117.89px;top:80.62px" class="cls_010"><span class="cls_010">authorityService.addAuthority("GROUP_" + groupName.toUpperCase(),</span></div>
<div style="position:absolute;left:117.89px;top:91.42px" class="cls_010"><span class="cls_010">username);</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">messages.add("The user " + username + " has been created.");</span></div>
<div style="position:absolute;left:91.32px;top:122.83px" class="cls_004"><span class="cls_004">6. Package, deploy, and test.</span></div>
<div style="position:absolute;left:56.69px;top:146.72px" class="cls_004"><span class="cls_004">If you open the URL: </span><a href="http://127.0.0.1:8080/alfresco/s/someco/init/">http://127.0.0.1:8080/alfresco/s/someco/init</a> <span class="cls_004">, you should</span></div>
<div style="position:absolute;left:56.69px;top:160.00px" class="cls_004"><span class="cls_004">get a screen that looks like this where you can see which user and group have been created:</span></div>
<div style="position:absolute;left:56.69px;top:460.02px" class="cls_004"><span class="cls_004">Feel free to refresh the page and you'll see different messages telling you that all users and</span></div>
<div style="position:absolute;left:56.69px;top:472.62px" class="cls_004"><span class="cls_004">groups already exist. Then, you can delete random groups or users, run the webscript again</span></div>
<div style="position:absolute;left:56.69px;top:485.22px" class="cls_004"><span class="cls_004">to be sure that everything is all right. You should now have a basic idea about how to work</span></div>
<div style="position:absolute;left:56.69px;top:497.82px" class="cls_004"><span class="cls_004">with the three main security services: </span><span class="cls_013">AuthenticationService</span><span class="cls_004">, </span><span class="cls_013">AuthorityService</span><span class="cls_004">, and</span></div>
<div style="position:absolute;left:56.69px;top:511.10px" class="cls_013"><span class="cls_013">PersonService</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 483 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:336648px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background499.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:69.76px" class="cls_014"><span class="cls_014">Understanding permission definitions</span></div>
<div style="position:absolute;left:56.69px;top:94.98px" class="cls_004"><span class="cls_004">Alfresco's out-of-the-box permission definitions are stored in</span></div>
<div style="position:absolute;left:56.69px;top:107.58px" class="cls_013"><span class="cls_013">alfresco|model|permissionDefinitions.xml</span><span class="cls_004"> bundled in the JAR file </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:120.86px" class="cls_013"><span class="cls_013">repository-5.x.jar</span><span class="cls_004">. If you've ever wondered what the difference is between a</span></div>
<div style="position:absolute;left:56.69px;top:134.14px" class="cls_004"><span class="cls_004">Contributor and Editor, this is the file that holds the answer. As you may already observe,</span></div>
<div style="position:absolute;left:56.69px;top:146.74px" class="cls_004"><span class="cls_004">there are specific roles for Share sites as well. Those roles are in the</span></div>
<div style="position:absolute;left:56.69px;top:159.34px" class="cls_013"><span class="cls_013">sitePermissionDefinitions.xml</span><span class="cls_004"> file contained in the folder than</span></div>
<div style="position:absolute;left:56.69px;top:172.62px" class="cls_013"><span class="cls_013">permissionDefinitions.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:194.90px" class="cls_004"><span class="cls_004">Like just about everything else in Alfresco, the permission definitions can be extended. This</span></div>
<div style="position:absolute;left:56.69px;top:207.50px" class="cls_004"><span class="cls_004">can be really helpful when the out-of-the-box permissions don't give you exactly what you</span></div>
<div style="position:absolute;left:56.69px;top:220.10px" class="cls_004"><span class="cls_004">need. You'll work through such an example in a bit. But first, let's take a peek at how the</span></div>
<div style="position:absolute;left:56.69px;top:232.70px" class="cls_004"><span class="cls_004">five permission groups or </span><span class="cls_022">“</span><span class="cls_004">roles</span><span class="cls_022">”</span><span class="cls_004"> you see in Share are defined, and then we'll take a look at</span></div>
<div style="position:absolute;left:56.69px;top:246.13px" class="cls_004"><span class="cls_004">the specific site roles.</span></div>
<div style="position:absolute;left:56.69px;top:280.78px" class="cls_023"><span class="cls_023">Permission groups</span></div>
<div style="position:absolute;left:56.69px;top:303.49px" class="cls_004"><span class="cls_004">Permission Groups roll up other Permission Group(s) and Permission(s) into higher-level</span></div>
<div style="position:absolute;left:56.69px;top:316.09px" class="cls_004"><span class="cls_004">concepts that make sense to people who have to deal with permissions. In Alfresco Share,</span></div>
<div style="position:absolute;left:56.69px;top:328.69px" class="cls_004"><span class="cls_004">these are labeled </span><span class="cls_022">“</span><span class="cls_004">roles</span><span class="cls_022">”</span><span class="cls_004">, although technically they are permission groups.</span></div>
<div style="position:absolute;left:56.69px;top:351.12px" class="cls_004"><span class="cls_004">In Alfresco, users are assigned to groups. Groups are assigned to roles for specific folders</span></div>
<div style="position:absolute;left:56.69px;top:363.72px" class="cls_004"><span class="cls_004">and objects. Individual users can also be assigned roles, but using groups is a much better</span></div>
<div style="position:absolute;left:56.69px;top:376.32px" class="cls_004"><span class="cls_004">practice. When an individual changes job roles, it is much easier to simply change his/her</span></div>
<div style="position:absolute;left:56.69px;top:388.92px" class="cls_004"><span class="cls_004">group membership than updating every object where he/she has been given individual</span></div>
<div style="position:absolute;left:56.69px;top:401.52px" class="cls_004"><span class="cls_004">access.</span></div>
<div style="position:absolute;left:56.69px;top:423.12px" class="cls_004"><span class="cls_004">Suppose Caroline is in a group called </span><span class="cls_022">“</span><span class="cls_004">HR Administrators</span><span class="cls_022">”</span><span class="cls_004">, which is given the role of</span></div>
<div style="position:absolute;left:56.69px;top:436.55px" class="cls_007"><span class="cls_007">Contributor</span><span class="cls_004"> on the </span><span class="cls_022">“</span><span class="cls_004">resume</span><span class="cls_022">”</span><span class="cls_004"> folder. Using the following diagram, let's figure out what</span></div>
<div style="position:absolute;left:56.69px;top:449.98px" class="cls_004"><span class="cls_004">Caroline can do:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 484 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:337324px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background500.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:266.06px" class="cls_004"><span class="cls_004">The diagram shows that </span><span class="cls_007">Contributor</span><span class="cls_004"> is a permission group that includes the </span><span class="cls_007">Consumer</span><span class="cls_004">,</span></div>
<div style="position:absolute;left:56.69px;top:278.70px" class="cls_007"><span class="cls_007">AddChildren</span><span class="cls_004">, and </span><span class="cls_007">ReadPermissions</span><span class="cls_004"> permission groups. Each of these permission groups</span></div>
<div style="position:absolute;left:56.69px;top:291.34px" class="cls_004"><span class="cls_004">includes others, eventually leading to the following list of</span></div>
<div style="position:absolute;left:56.69px;top:303.94px" class="cls_004"><span class="cls_004">low-level permissions for a </span><span class="cls_007">Contributor</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:104.69px;top:325.70px" class="cls_004"><span class="cls_004">_ReadProperties</span></div>
<div style="position:absolute;left:104.69px;top:340.46px" class="cls_004"><span class="cls_004">_ReadChildren</span></div>
<div style="position:absolute;left:104.69px;top:355.22px" class="cls_004"><span class="cls_004">_ReadContent</span></div>
<div style="position:absolute;left:104.69px;top:369.98px" class="cls_004"><span class="cls_004">_CreateChildren</span></div>
<div style="position:absolute;left:104.69px;top:384.74px" class="cls_004"><span class="cls_004">_LinkChildren</span></div>
<div style="position:absolute;left:104.69px;top:399.50px" class="cls_004"><span class="cls_004">_ReadPermissions</span></div>
<div style="position:absolute;left:56.69px;top:423.39px" class="cls_004"><span class="cls_004">So, Caroline can read the resume folder's properties, can see the children listed</span></div>
<div style="position:absolute;left:56.69px;top:435.99px" class="cls_004"><span class="cls_004">in the folder, and can even read the content of the folder object. She can add new</span></div>
<div style="position:absolute;left:56.69px;top:448.59px" class="cls_004"><span class="cls_004">files to the folder and can read the permissions of the folder. But Caroline can't change</span></div>
<div style="position:absolute;left:56.69px;top:461.19px" class="cls_004"><span class="cls_004">anything she doesn't own because she lacks </span><span class="cls_007">_WriteProperties</span><span class="cls_004"> and</span></div>
<div style="position:absolute;left:56.69px;top:473.83px" class="cls_007"><span class="cls_007">_WriteContent</span><span class="cls_004"> permissions.</span></div>
<div style="position:absolute;left:56.69px;top:495.47px" class="cls_004"><span class="cls_004">The </span><span class="cls_022">“</span><span class="cls_004">can't change anything she doesn't own</span><span class="cls_022">”</span><span class="cls_004"> caveat is important to understand. Owners</span></div>
<div style="position:absolute;left:56.69px;top:508.90px" class="cls_004"><span class="cls_004">have full control over their content. An owner can be explicitly set or can be implicitly</span></div>
<div style="position:absolute;left:56.69px;top:521.50px" class="cls_004"><span class="cls_004">based on the creator of the content. So in this case, even though Caroline is just a</span></div>
<div style="position:absolute;left:56.69px;top:534.10px" class="cls_007"><span class="cls_007">Contributor</span><span class="cls_004">, she'd still be able to change anything she created unless the ownership of</span></div>
<div style="position:absolute;left:56.69px;top:546.73px" class="cls_004"><span class="cls_004">those objects is changed.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 485 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:338000px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background501.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Because Caroline is in a group, if she were to move to a different department and be back-</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_004"><span class="cls_004">filled by another person-Justin, for example-it would be easy to simply remove Caroline</span></div>
<div style="position:absolute;left:56.69px;top:95.70px" class="cls_004"><span class="cls_004">from the group and add Justin. Now Caroline would no longer be able to add content to the</span></div>
<div style="position:absolute;left:56.69px;top:108.30px" class="cls_004"><span class="cls_004">folder, but Justin would. Unless the ownership is changed, though, she will continue to be</span></div>
<div style="position:absolute;left:56.69px;top:120.90px" class="cls_004"><span class="cls_004">able to make changes to any content she owns unless a script is run to change the</span></div>
<div style="position:absolute;left:56.69px;top:133.50px" class="cls_004"><span class="cls_004">ownership to Justin or someone else.</span></div>
<div style="position:absolute;left:56.69px;top:168.15px" class="cls_023"><span class="cls_023">Permissions</span></div>
<div style="position:absolute;left:56.69px;top:190.86px" class="cls_004"><span class="cls_004">As shown in the diagram, at some point, permission groups stop including additional</span></div>
<div style="position:absolute;left:56.69px;top:203.46px" class="cls_004"><span class="cls_004">permission groups. In other words, you get to the lowest level in the tree. How, then, do</span></div>
<div style="position:absolute;left:56.69px;top:216.06px" class="cls_004"><span class="cls_004">permission groups get tied to actual, low-level permissions? Each permission is granted to a</span></div>
<div style="position:absolute;left:56.69px;top:228.66px" class="cls_004"><span class="cls_004">permission group, sometimes conditionally. In the diagram, the </span><span class="cls_007">_Lock</span><span class="cls_004"> permission is only</span></div>
<div style="position:absolute;left:56.69px;top:241.30px" class="cls_004"><span class="cls_004">granted to the </span><span class="cls_007">Lock</span><span class="cls_004"> permission group when the user also has </span><span class="cls_007">Write</span><span class="cls_004"> permission on that</span></div>
<div style="position:absolute;left:56.69px;top:253.94px" class="cls_004"><span class="cls_004">node:</span></div>
<div style="position:absolute;left:74.69px;top:274.86px" class="cls_010"><span class="cls_010">&lt;permission name="_Lock" requiresType="false" expose="false"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:285.66px" class="cls_010"><span class="cls_010">&lt;grantedToGroup permissionGroup="Lock" /&gt;</span></div>
<div style="position:absolute;left:96.29px;top:296.46px" class="cls_010"><span class="cls_010">&lt;requiredPermission on="node" type="sys:base"  name="Write"/&gt;</span></div>
<div style="position:absolute;left:74.69px;top:307.26px" class="cls_010"><span class="cls_010">&lt;/permission&gt;</span></div>
<div style="position:absolute;left:56.69px;top:340.78px" class="cls_023"><span class="cls_023">Permission sets</span></div>
<div style="position:absolute;left:56.69px;top:363.50px" class="cls_004"><span class="cls_004">Permission sets are collections of permission groups specific to an Alfresco type. For</span></div>
<div style="position:absolute;left:56.69px;top:376.10px" class="cls_004"><span class="cls_004">example, the permission groups applicable to a </span><span class="cls_013">cm:folder</span><span class="cls_004"> object are:</span></div>
<div style="position:absolute;left:104.69px;top:398.51px" class="cls_004"><span class="cls_004">Coordinator</span></div>
<div style="position:absolute;left:104.69px;top:413.27px" class="cls_004"><span class="cls_004">Collaborator</span></div>
<div style="position:absolute;left:104.69px;top:428.03px" class="cls_004"><span class="cls_004">Contributor</span></div>
<div style="position:absolute;left:104.69px;top:442.79px" class="cls_004"><span class="cls_004">Editor</span></div>
<div style="position:absolute;left:104.69px;top:457.55px" class="cls_004"><span class="cls_004">Consumer</span></div>
<div style="position:absolute;left:104.69px;top:472.31px" class="cls_004"><span class="cls_004">RecordsAdministrator (not exposed to the UI out-of-the-box)</span></div>
<div style="position:absolute;left:56.69px;top:496.20px" class="cls_004"><span class="cls_004">On the other hand, the permission groups relevant to a </span><span class="cls_013">st:site</span><span class="cls_004"> (an Alfresco Share site)</span></div>
<div style="position:absolute;left:56.69px;top:509.48px" class="cls_004"><span class="cls_004">listed in the file </span><span class="cls_013">sitePermissionDefinitions.xml</span><span class="cls_004"> are:</span></div>
<div style="position:absolute;left:104.69px;top:531.89px" class="cls_004"><span class="cls_004">SiteManager</span></div>
<div style="position:absolute;left:104.69px;top:546.65px" class="cls_004"><span class="cls_004">SiteCollaborator</span></div>
<div style="position:absolute;left:104.69px;top:561.41px" class="cls_004"><span class="cls_004">SiteContributor</span></div>
<div style="position:absolute;left:104.69px;top:576.17px" class="cls_004"><span class="cls_004">SiteConsumer</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 486 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:338676px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background502.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">Permission sets can also be tied to aspects. For example, when an object has the</span></div>
<div style="position:absolute;left:56.69px;top:83.10px" class="cls_013"><span class="cls_013">cm:ownable</span><span class="cls_004"> aspect applied, one of the things you can do is take ownership of that object</span></div>
<div style="position:absolute;left:56.69px;top:96.38px" class="cls_004"><span class="cls_004">(that is, set the </span><span class="cls_022">“</span><span class="cls_004">owner</span><span class="cls_022">”</span><span class="cls_004"> attribute). But you have to have a specific permission level to do</span></div>
<div style="position:absolute;left:56.69px;top:109.81px" class="cls_004"><span class="cls_004">that. So, there is a permission set tied to the </span><span class="cls_013">cm:ownable</span><span class="cls_004"> aspect called </span><span class="cls_013">TakeOwnership</span><span class="cls_004"> that</span></div>
<div style="position:absolute;left:56.69px;top:123.09px" class="cls_004"><span class="cls_004">includes the permission group </span><span class="cls_013">SetOwner</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:74.69px;top:144.69px" class="cls_010"><span class="cls_010">&lt;permissionSet type="cm:ownable" expose="selected"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:155.49px" class="cls_010"><span class="cls_010">&lt;permissionGroup name="TakeOwnership" requiresType="false"</span></div>
<div style="position:absolute;left:96.29px;top:166.29px" class="cls_010"><span class="cls_010">expose="false"&gt;</span></div>
<div style="position:absolute;left:112.49px;top:177.09px" class="cls_010"><span class="cls_010">&lt;includePermissionGroup permissionGroup="SetOwner"</span></div>
<div style="position:absolute;left:117.89px;top:187.89px" class="cls_010"><span class="cls_010">type="cm:ownable" /&gt;</span></div>
<div style="position:absolute;left:96.29px;top:198.69px" class="cls_010"><span class="cls_010">&lt;/permissionGroup&gt;</span></div>
<div style="position:absolute;left:96.29px;top:209.49px" class="cls_010"><span class="cls_010">&lt;permissionGroup name="SetOwner" requiresType="false"</span></div>
<div style="position:absolute;left:96.29px;top:220.29px" class="cls_010"><span class="cls_010">expose="false"/&gt;</span></div>
<div style="position:absolute;left:117.89px;top:231.09px" class="cls_010"><span class="cls_010">&lt;permission name="_SetOwner" expose="false" requiresType="false"&gt;</span></div>
<div style="position:absolute;left:112.49px;top:241.89px" class="cls_010"><span class="cls_010">&lt;grantedToGroup permissionGroup="SetOwner" /&gt;</span></div>
<div style="position:absolute;left:112.49px;top:252.69px" class="cls_010"><span class="cls_010">&lt;requiredPermission on="node" type="sys:base"</span></div>
<div style="position:absolute;left:117.89px;top:263.49px" class="cls_010"><span class="cls_010">name="_WriteProperties" /&gt;</span></div>
<div style="position:absolute;left:96.29px;top:274.29px" class="cls_010"><span class="cls_010">&lt;/permission&gt;</span></div>
<div style="position:absolute;left:74.69px;top:285.09px" class="cls_010"><span class="cls_010">&lt;/permissionSet&gt;</span></div>
<div style="position:absolute;left:56.69px;top:340.22px" class="cls_023"><span class="cls_023">Step-by-step - setting up a publisher custom role</span></div>
<div style="position:absolute;left:56.69px;top:362.94px" class="cls_004"><span class="cls_004">In </span><span class="cls_010">Chapter 5</span><span class="cls_004">, </span><span class="cls_012">Customizing Alfresco Share</span><span class="cls_004">, you implemented action evaluator classes that</span></div>
<div style="position:absolute;left:56.69px;top:375.92px" class="cls_004"><span class="cls_004">made sure only members of the Publisher group would see the action items related to</span></div>
<div style="position:absolute;left:56.69px;top:388.52px" class="cls_004"><span class="cls_004">setting the flag that determines if a piece of content should show up on the portal or not. It</span></div>
<div style="position:absolute;left:56.69px;top:401.12px" class="cls_004"><span class="cls_004">worked fine at the time, but now that you know about customizing the out-of-the-box</span></div>
<div style="position:absolute;left:56.69px;top:413.72px" class="cls_004"><span class="cls_004">permissions, you can do better. First, here are some of the issues with the original approach:</span></div>
<div style="position:absolute;left:104.69px;top:435.45px" class="cls_004"><span class="cls_004">The group name was hardcoded in the Spring configuration file </span><span class="cls_013">share-</span></div>
<div style="position:absolute;left:104.69px;top:448.73px" class="cls_013"><span class="cls_013">slingshot-application-context.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:104.69px;top:464.17px" class="cls_004"><span class="cls_004">It assumed that the list of people who were allowed to use the action links was</span></div>
<div style="position:absolute;left:104.69px;top:476.77px" class="cls_004"><span class="cls_004">the same across the entire organization. If, for example, Sales wanted to use the</span></div>
<div style="position:absolute;left:104.69px;top:489.37px" class="cls_004"><span class="cls_004">action to publish something on the portal as well as Marketing, individuals from</span></div>
<div style="position:absolute;left:104.69px;top:501.97px" class="cls_004"><span class="cls_004">both teams would have to be added to the Publisher group (or groups within that</span></div>
<div style="position:absolute;left:104.69px;top:514.57px" class="cls_004"><span class="cls_004">group) meaning they could publish or un-publish each other's content.</span></div>
<div style="position:absolute;left:104.69px;top:529.33px" class="cls_004"><span class="cls_004">It assumed that if you had Write permissions on the node, you should see</span></div>
<div style="position:absolute;left:104.69px;top:541.93px" class="cls_004"><span class="cls_004">the link. The evaluator then performed the group check. So users still had</span></div>
<div style="position:absolute;left:104.69px;top:554.53px" class="cls_004"><span class="cls_004">to belong to the Publisher group, even if they had Write permission.</span></div>
<div style="position:absolute;left:104.69px;top:567.13px" class="cls_004"><span class="cls_004">But because not everyone who has Write is in the Publisher group, it is a</span></div>
<div style="position:absolute;left:104.69px;top:579.73px" class="cls_004"><span class="cls_004">bit inefficient.</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 487 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:339352px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background503.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">People who can publish content to the portal can also change the content. Let's</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">suppose that SomeCo wants more fine-grained control. Thus, people who are</span></div>
<div style="position:absolute;left:104.69px;top:95.70px" class="cls_004"><span class="cls_004">only supposed to enable or disable the web flag should not be able to actually</span></div>
<div style="position:absolute;left:104.69px;top:108.30px" class="cls_004"><span class="cls_004">change any content.</span></div>
<div style="position:absolute;left:56.69px;top:132.19px" class="cls_004"><span class="cls_004">You can address these issues by implementing a custom role. Let's call it </span><span class="cls_013">SitePublisher</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:56.69px;top:145.47px" class="cls_004"><span class="cls_004">Instead of having an evaluator check for membership in a particular group, groups can be</span></div>
<div style="position:absolute;left:56.69px;top:158.07px" class="cls_004"><span class="cls_004">assigned to the </span><span class="cls_013">SitePublisher</span><span class="cls_004"> role. The action can then check to see if the current user</span></div>
<div style="position:absolute;left:56.69px;top:171.35px" class="cls_004"><span class="cls_004">has that role, and hide the link if he/she doesn't.</span></div>
<div style="position:absolute;left:56.69px;top:192.95px" class="cls_004"><span class="cls_004">This also has the advantage of being able to split up responsibilities more granularly. In one</span></div>
<div style="position:absolute;left:56.69px;top:205.55px" class="cls_004"><span class="cls_004">site, the Sales group could be assigned to </span><span class="cls_013">SitePublisher</span><span class="cls_004">, while in another site the</span></div>
<div style="position:absolute;left:56.69px;top:218.83px" class="cls_004"><span class="cls_004">Marketing group could have that role.</span></div>
<div style="position:absolute;left:56.69px;top:240.43px" class="cls_004"><span class="cls_004">Because it is a custom role, you have more control over what people with that permission</span></div>
<div style="position:absolute;left:56.69px;top:253.03px" class="cls_004"><span class="cls_004">can do. In this case, a </span><span class="cls_013">SitePublisher</span><span class="cls_004"> should be able to read everything but edit only the</span></div>
<div style="position:absolute;left:56.69px;top:266.31px" class="cls_004"><span class="cls_004">properties. (They have to be able to edit the properties because the </span><span class="cls_013">sc:isActive</span><span class="cls_004"> flag is a</span></div>
<div style="position:absolute;left:56.69px;top:279.59px" class="cls_004"><span class="cls_004">property on the object.)</span></div>
<div style="position:absolute;left:56.69px;top:301.19px" class="cls_004"><span class="cls_004">Finally, this gives your administrator accounts access to the action items. In the old</span></div>
<div style="position:absolute;left:56.69px;top:313.79px" class="cls_004"><span class="cls_004">approach, you had to remember to add </span><span class="cls_013">admin</span><span class="cls_004"> to the Publisher group. Because</span></div>
<div style="position:absolute;left:56.69px;top:327.07px" class="cls_004"><span class="cls_004">administrators get all permissions, when the action item checks to see if the administrator</span></div>
<div style="position:absolute;left:56.69px;top:339.67px" class="cls_004"><span class="cls_004">has </span><span class="cls_013">SitePublisher</span><span class="cls_004"> permissions, it will return true and the link will be displayed (subject</span></div>
<div style="position:absolute;left:56.69px;top:352.95px" class="cls_004"><span class="cls_004">to the logic in the evaluator classes).</span></div>
<div style="position:absolute;left:56.69px;top:374.55px" class="cls_004"><span class="cls_004">Now that you're convinced this is a great idea, go do it. This is going to involve defining a</span></div>
<div style="position:absolute;left:56.69px;top:387.15px" class="cls_004"><span class="cls_004">new permission group (</span><span class="cls_013">EnableFlag</span><span class="cls_004">), and another one for sites (</span><span class="cls_013">SitePublisher</span><span class="cls_004">) in a new</span></div>
<div style="position:absolute;left:56.69px;top:400.43px" class="cls_004"><span class="cls_004">permission definitions file, externalizing the role name, changing the permission required to</span></div>
<div style="position:absolute;left:56.69px;top:413.03px" class="cls_004"><span class="cls_004">see the action item, and refactoring the evaluator definition to use the new permission.</span></div>
<div style="position:absolute;left:56.69px;top:434.63px" class="cls_004"><span class="cls_004">Here are the steps:</span></div>
<div style="position:absolute;left:91.32px;top:456.36px" class="cls_004"><span class="cls_004">1. Copy the out-of-the-box </span><span class="cls_013">permissionDefinitions.xml</span><span class="cls_004"> file into your project</span></div>
<div style="position:absolute;left:104.69px;top:469.64px" class="cls_004"><span class="cls_004">under </span><span class="cls_013">src|main|amp|config|alfresco|module|repo|model</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:485.08px" class="cls_004"><span class="cls_004">2. Rename the file to </span><span class="cls_013">scPermissionDefinitions.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:500.52px" class="cls_004"><span class="cls_004">3. Modify </span><span class="cls_013">scPermissionDefinitions.xml</span><span class="cls_004"> to include your custom permission.</span></div>
<div style="position:absolute;left:104.69px;top:513.80px" class="cls_004"><span class="cls_004">The first thing to do is locate the permission group </span><span class="cls_013">ChangePermissions</span><span class="cls_004">. Add</span></div>
<div style="position:absolute;left:104.69px;top:527.08px" class="cls_004"><span class="cls_004">below this group, the following permission group:</span></div>
<div style="position:absolute;left:117.89px;top:550.29px" class="cls_010"><span class="cls_010">&lt;permissionGroup name="EnableFlag" expose="true"</span></div>
<div style="position:absolute;left:117.89px;top:561.09px" class="cls_010"><span class="cls_010">allowFullControl="false" /&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 488 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:340028px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background504.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:91.32px;top:70.50px" class="cls_004"><span class="cls_004">4. Save the </span><span class="cls_013">scPermissionDefinitions.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:85.94px" class="cls_004"><span class="cls_004">5. Copy the out-of-the-box </span><span class="cls_013">sitePermissionDefinitions.xml</span><span class="cls_004"> file into your</span></div>
<div style="position:absolute;left:104.69px;top:99.22px" class="cls_004"><span class="cls_004">project under </span><span class="cls_013">src|main|amp|config|alfresco|module|repo|model</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:114.66px" class="cls_004"><span class="cls_004">6. Rename the file to </span><span class="cls_013">scSitePermissionDefinitions.xml</span><span class="cls_004">.</span></div>
<div style="position:absolute;left:91.32px;top:130.10px" class="cls_004"><span class="cls_004">7. You want users to be able to grant people the </span><span class="cls_013">SitePublisher</span><span class="cls_004"> permission on</span></div>
<div style="position:absolute;left:104.69px;top:143.38px" class="cls_004"><span class="cls_004">Share sites. Add a new permission group </span><span class="cls_013">SitePublisher</span><span class="cls_004"> that includes the</span></div>
<div style="position:absolute;left:104.69px;top:156.66px" class="cls_013"><span class="cls_013">EnableFlag</span><span class="cls_004"> permission group defined above in the permission set for </span><span class="cls_013">st:site</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:180.55px" class="cls_010"><span class="cls_010">&lt;permissionGroup name="SitePublisher"</span></div>
<div style="position:absolute;left:117.89px;top:191.35px" class="cls_010"><span class="cls_010">allowFullControl="false" expose="true"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:202.15px" class="cls_010"><span class="cls_010">&lt;includePermissionGroup permissionGroup="Consumer"</span></div>
<div style="position:absolute;left:139.49px;top:212.95px" class="cls_010"><span class="cls_010">type="cm:cmobject" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:223.75px" class="cls_010"><span class="cls_010">&lt;includePermissionGroup permissionGroup="ReadPermissions"</span></div>
<div style="position:absolute;left:139.49px;top:234.55px" class="cls_010"><span class="cls_010">type="sys:base" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:245.35px" class="cls_010"><span class="cls_010">&lt;includePermissionGroup permissionGroup="WriteProperties"</span></div>
<div style="position:absolute;left:139.49px;top:256.15px" class="cls_010"><span class="cls_010">type="sys:base" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:266.95px" class="cls_010"><span class="cls_010">&lt;includePermissionGroup permissionGroup="EnableFlag"</span></div>
<div style="position:absolute;left:139.49px;top:277.75px" class="cls_010"><span class="cls_010">type="sys:base" /&gt;</span></div>
<div style="position:absolute;left:117.89px;top:288.55px" class="cls_010"><span class="cls_010">&lt;/permissionGroup&gt;</span></div>
<div style="position:absolute;left:91.32px;top:309.16px" class="cls_004"><span class="cls_004">8. Save the </span><span class="cls_013">scSitePermissionDefinitions.xml</span><span class="cls_004"> file.</span></div>
<div style="position:absolute;left:91.32px;top:324.60px" class="cls_004"><span class="cls_004">9. Create a new context file </span><span class="cls_013">permission-context.xml</span><span class="cls_004"> in</span></div>
<div style="position:absolute;left:104.69px;top:337.88px" class="cls_013"><span class="cls_013">src|main|amp|config|alfresco|module|repo|context</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:361.77px" class="cls_010"><span class="cls_010">&lt;?xml version='1.0' encoding='UTF-8'?&gt;</span></div>
<div style="position:absolute;left:117.89px;top:372.57px" class="cls_010"><span class="cls_010">&lt;!DOCTYPE beans PUBLIC '-//SPRING//DTD BEAN//EN'</span></div>
<div style="position:absolute;left:117.89px;top:383.37px" class="cls_010"><span class="cls_010">'</span><a href="http://www.springframework.org/dtd/spring-beans.dtd&#39;/">http://www.springframework.org/dtd/spring-beans.dtd'</a>&gt;</div>
<div style="position:absolute;left:117.89px;top:394.17px" class="cls_010"><span class="cls_010">&lt;beans&gt;</span></div>
<div style="position:absolute;left:117.89px;top:404.97px" class="cls_010"><span class="cls_010">[...]</span></div>
<div style="position:absolute;left:117.89px;top:415.77px" class="cls_010"><span class="cls_010">&lt;/beans&gt;</span></div>
<div style="position:absolute;left:86.07px;top:436.38px" class="cls_004"><span class="cls_004">10. Override the out-of-the-box </span><span class="cls_013">permissionsModelDAO</span><span class="cls_004"> bean with your own to</span></div>
<div style="position:absolute;left:104.69px;top:449.66px" class="cls_004"><span class="cls_004">point to the custom permissions definition file you were just modifying:</span></div>
<div style="position:absolute;left:117.89px;top:472.87px" class="cls_010"><span class="cls_010">&lt;bean id='permissionsModelDAO'</span></div>
<div style="position:absolute;left:117.89px;top:483.67px" class="cls_010"><span class="cls_010">class="org.alfresco.repo.security</span></div>
<div style="position:absolute;left:139.49px;top:494.47px" class="cls_010"><span class="cls_010">.permissions.impl.model.PermissionModel" init-method="init"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:505.27px" class="cls_010"><span class="cls_010">&lt;property name="model"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:516.07px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco/module/${project.artifactId}/model</span></div>
<div style="position:absolute;left:134.09px;top:526.87px" class="cls_010"><span class="cls_010">/scPermissionDefinitions.xml&lt;/value&gt;</span></div>
<div style="position:absolute;left:128.69px;top:537.67px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:128.69px;top:548.47px" class="cls_010"><span class="cls_010">&lt;property name="dtdSchema"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:559.27px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco/model/permissionSchema.dtd&lt;/value&gt;</span></div>
<div style="position:absolute;left:128.69px;top:570.07px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:128.69px;top:580.87px" class="cls_010"><span class="cls_010">&lt;property name="nodeService"&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 489 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:340704px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background505.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:139.49px;top:69.82px" class="cls_010"><span class="cls_010">&lt;ref bean="nodeService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:80.62px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:128.69px;top:91.42px" class="cls_010"><span class="cls_010">&lt;property name="dictionaryService"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:102.22px" class="cls_010"><span class="cls_010">&lt;ref bean="dictionaryService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:113.02px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:144.43px" class="cls_004"><span class="cls_004">11. Override the out-of-the-box </span><span class="cls_013">siteService_permissionBootstrap</span><span class="cls_004"> bean with</span></div>
<div style="position:absolute;left:104.69px;top:157.71px" class="cls_004"><span class="cls_004">your own to point to the new permissions definition file for the Share site:</span></div>
<div style="position:absolute;left:117.89px;top:180.92px" class="cls_010"><span class="cls_010">&lt;bean id="siteService_permissionBootstrap"</span></div>
<div style="position:absolute;left:128.69px;top:191.72px" class="cls_010"><span class="cls_010">parent="permissionModelBootstrap"&gt;</span></div>
<div style="position:absolute;left:117.89px;top:202.52px" class="cls_010"><span class="cls_010">&lt;property name="model"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:213.32px" class="cls_010"><span class="cls_010">&lt;value&gt;alfresco/module/${project.artifactId}/model</span></div>
<div style="position:absolute;left:134.09px;top:224.12px" class="cls_010"><span class="cls_010">/scSitePermissionDefinitions.xml&lt;/value&gt;</span></div>
<div style="position:absolute;left:117.89px;top:234.92px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:245.72px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:266.33px" class="cls_004"><span class="cls_004">12. The last bean that we need to add is the overriding of the</span></div>
<div style="position:absolute;left:104.69px;top:278.93px" class="cls_013"><span class="cls_013">baseJsonConversionComponent</span><span class="cls_004"> bean. We need to update it to make the new</span></div>
<div style="position:absolute;left:104.69px;top:292.21px" class="cls_004"><span class="cls_004">permission group </span><span class="cls_013">EnableFlag</span><span class="cls_004"> available in the Share configuration file:</span></div>
<div style="position:absolute;left:117.89px;top:316.10px" class="cls_010"><span class="cls_010">&lt;bean id="baseJsonConversionComponent" abstract="true"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:326.90px" class="cls_010"><span class="cls_010">&lt;property name="nodeService" ref="NodeService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:337.70px" class="cls_010"><span class="cls_010">&lt;property name="publicServiceAccessService"</span></div>
<div style="position:absolute;left:139.49px;top:348.50px" class="cls_010"><span class="cls_010">ref="PublicServiceAccessService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:359.30px" class="cls_010"><span class="cls_010">&lt;property name="namespaceService" ref="NamespaceService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:370.10px" class="cls_010"><span class="cls_010">&lt;property name="fileFolderService" ref="FileFolderService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:380.90px" class="cls_010"><span class="cls_010">&lt;property name="lockService" ref="LockService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:391.70px" class="cls_010"><span class="cls_010">&lt;property name="permissionService" ref="PermissionService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:402.50px" class="cls_010"><span class="cls_010">&lt;property name="contentService" ref="ContentService" /&gt;</span></div>
<div style="position:absolute;left:128.69px;top:413.30px" class="cls_010"><span class="cls_010">&lt;property name="userPermissions"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:424.10px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:434.90px" class="cls_010"><span class="cls_010">&lt;value&gt;Unlock&lt;/value&gt;</span></div>
<div style="position:absolute;left:150.29px;top:445.70px" class="cls_010"><span class="cls_010">&lt;value&gt;CancelCheckOut&lt;/value&gt;</span></div>
<div style="position:absolute;left:150.29px;top:456.50px" class="cls_010"><span class="cls_010">&lt;value&gt;ChangePermissions&lt;/value&gt;</span></div>
<div style="position:absolute;left:150.29px;top:467.30px" class="cls_010"><span class="cls_010">&lt;value&gt;CreateChildren&lt;/value&gt;</span></div>
<div style="position:absolute;left:150.29px;top:478.10px" class="cls_010"><span class="cls_010">&lt;value&gt;Delete&lt;/value&gt;</span></div>
<div style="position:absolute;left:150.29px;top:488.90px" class="cls_010"><span class="cls_010">&lt;value&gt;Write&lt;/value&gt;</span></div>
<div style="position:absolute;left:150.29px;top:499.70px" class="cls_010"><span class="cls_010">&lt;value&gt;EnableFlag&lt;/value&gt;</span></div>
<div style="position:absolute;left:139.49px;top:510.50px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:521.30px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:532.10px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 490 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:341380px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background506.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">13. We have now completed the configuration on the Alfresco side. The first thing</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_004"><span class="cls_004">that we need to configure on the Share side is the messages. Edit the file,</span></div>
<div style="position:absolute;left:104.69px;top:94.92px" class="cls_013"><span class="cls_013">share|src|main|amp|config|alfresco|web-</span></div>
<div style="position:absolute;left:104.69px;top:107.70px" class="cls_013"><span class="cls_013">extension|messages|share.properties</span><span class="cls_004"> and add the following lines:</span></div>
<div style="position:absolute;left:117.89px;top:131.59px" class="cls_010"><span class="cls_010">role.SitePublisher=SomeCo Publisher</span></div>
<div style="position:absolute;left:117.89px;top:142.39px" class="cls_010"><span class="cls_010">role.SitePublisher.description=has view-only</span></div>
<div style="position:absolute;left:117.89px;top:153.19px" class="cls_010"><span class="cls_010">rights in a site but can enable/disable the published flag.</span></div>
<div style="position:absolute;left:117.89px;top:163.99px" class="cls_010"><span class="cls_010">group.SitePublisher=SomeCo Publishers</span></div>
<div style="position:absolute;left:86.07px;top:184.60px" class="cls_004"><span class="cls_004">14. We need to change the evaluators that use the group membership to show/hide</span></div>
<div style="position:absolute;left:104.69px;top:197.20px" class="cls_004"><span class="cls_004">the flag related actions. Edit the file</span></div>
<div style="position:absolute;left:104.69px;top:209.02px" class="cls_013"><span class="cls_013">share|src|main|amp|config|alfresco|web-extension|share-</span></div>
<div style="position:absolute;left:104.69px;top:221.80px" class="cls_013"><span class="cls_013">slingshot-application-context.xml</span><span class="cls_004"> and locate the evaluator</span></div>
<div style="position:absolute;left:104.69px;top:235.08px" class="cls_013"><span class="cls_013">evaluator.doclib.action.isSomecoPublishable</span><span class="cls_004">. Remove the reference to</span></div>
<div style="position:absolute;left:104.69px;top:248.36px" class="cls_004"><span class="cls_004">the evaluator </span><span class="cls_013">evaluator.doclib.action.isSomecoPublisher</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:272.25px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoPublishable"</span></div>
<div style="position:absolute;left:117.89px;top:283.05px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.chainedMatchAll"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:293.85px" class="cls_010"><span class="cls_010">&lt;property name="evaluators"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:304.65px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:315.45px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWhitepaper" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:326.25px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebable" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:337.05px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebInactive" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:347.85px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:358.65px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:369.45px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:86.07px;top:390.06px" class="cls_004"><span class="cls_004">15. Do the same for the evaluator</span></div>
<div style="position:absolute;left:104.69px;top:402.66px" class="cls_013"><span class="cls_013">evaluator.doclib.action.isSomecoUnpublishable</span><span class="cls_004">:</span></div>
<div style="position:absolute;left:117.89px;top:426.55px" class="cls_010"><span class="cls_010">&lt;bean id="evaluator.doclib.action.isSomecoUnpublishable"</span></div>
<div style="position:absolute;left:128.69px;top:437.35px" class="cls_010"><span class="cls_010">parent="evaluator.doclib.action.chainedMatchAll"&gt;</span></div>
<div style="position:absolute;left:128.69px;top:448.15px" class="cls_010"><span class="cls_010">&lt;property name="evaluators"&gt;</span></div>
<div style="position:absolute;left:139.49px;top:458.95px" class="cls_010"><span class="cls_010">&lt;list&gt;</span></div>
<div style="position:absolute;left:150.29px;top:469.75px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWhitepaper" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:480.55px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebable" /&gt;</span></div>
<div style="position:absolute;left:150.29px;top:491.35px" class="cls_010"><span class="cls_010">&lt;ref bean="evaluator.doclib.action.isSomecoWebActive" /&gt;</span></div>
<div style="position:absolute;left:139.49px;top:502.15px" class="cls_010"><span class="cls_010">&lt;/list&gt;</span></div>
<div style="position:absolute;left:128.69px;top:512.95px" class="cls_010"><span class="cls_010">&lt;/property&gt;</span></div>
<div style="position:absolute;left:117.89px;top:523.75px" class="cls_010"><span class="cls_010">&lt;/bean&gt;</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 491 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:342056px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background507.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:86.07px;top:70.50px" class="cls_004"><span class="cls_004">16. Finally, we need to change the definition of the actions in</span></div>
<div style="position:absolute;left:104.69px;top:83.10px" class="cls_013"><span class="cls_013">share|src|main|resources|META-INF|share-config-custom.xml</span><span class="cls_004">. Locate</span></div>
<div style="position:absolute;left:104.69px;top:96.38px" class="cls_004"><span class="cls_004">the actions </span><span class="cls_013">someco-web-enable</span><span class="cls_004"> and </span><span class="cls_013">someco-web-disable</span><span class="cls_004"> and change the</span></div>
<div style="position:absolute;left:104.69px;top:109.66px" class="cls_013"><span class="cls_013">permissions</span><span class="cls_004"> tag to use the new </span><span class="cls_013">EnableFlag</span><span class="cls_004"> permission group:</span></div>
<div style="position:absolute;left:117.89px;top:133.55px" class="cls_010"><span class="cls_010">&lt;permissions&gt;</span></div>
<div style="position:absolute;left:128.69px;top:144.35px" class="cls_010"><span class="cls_010">&lt;permission allow="true"&gt;EnableFlag&lt;/permission&gt;</span></div>
<div style="position:absolute;left:117.89px;top:155.15px" class="cls_010"><span class="cls_010">&lt;/permissions&gt;</span></div>
<div style="position:absolute;left:86.07px;top:175.76px" class="cls_004"><span class="cls_004">17. Save the changes you made everywhere.</span></div>
<div style="position:absolute;left:86.07px;top:190.52px" class="cls_004"><span class="cls_004">18. Package, deploy your changes, and then restart Alfresco.</span></div>
<div style="position:absolute;left:56.69px;top:214.41px" class="cls_004"><span class="cls_004">To test out your changes, log in to Alfresco Share as Site Manager of the Marketing site. Go</span></div>
<div style="position:absolute;left:56.69px;top:227.01px" class="cls_004"><span class="cls_004">to the dashboard of the site and click on </span><span class="cls_007">Site Members</span><span class="cls_004">. Click on </span><span class="cls_007">Add User</span><span class="cls_004"> and search for a</span></div>
<div style="position:absolute;left:56.69px;top:239.65px" class="cls_004"><span class="cls_004">new user. You should be able to select the new </span><span class="cls_007">SomeCo Publisher</span><span class="cls_004"> role:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 492 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:342732px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background508.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:70.50px" class="cls_004"><span class="cls_004">By going back to the dashboard, you should see your new user as </span><span class="cls_007">SomeCo Publisher</span><span class="cls_004"> in the</span></div>
<div style="position:absolute;left:56.69px;top:83.14px" class="cls_007"><span class="cls_007">Site Members</span><span class="cls_004"> dashlet:</span></div>
<div style="position:absolute;left:56.69px;top:249.70px" class="cls_004"><span class="cls_004">When you log out and log in again as the user you just granted the publisher role, you</span></div>
<div style="position:absolute;left:56.69px;top:262.30px" class="cls_004"><span class="cls_004">should see, and be able to successfully execute, the enable and disable actions, as well as all</span></div>
<div style="position:absolute;left:56.69px;top:274.90px" class="cls_004"><span class="cls_004">out-of-the-box </span><span class="cls_012">Consumer</span><span class="cls_004"> actions:</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 493 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:343408px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background509.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:56.69px;top:69.87px" class="cls_023"><span class="cls_023">Global Permissions</span></div>
<div style="position:absolute;left:56.69px;top:92.58px" class="cls_004"><span class="cls_004">The last section in the </span><span class="cls_013">permissionDefinitions.xml</span><span class="cls_004"> file is a set of global permissions.</span></div>
<div style="position:absolute;left:56.69px;top:105.86px" class="cls_004"><span class="cls_004">Global permissions, as the name implies, apply to everything and supersede any other</span></div>
<div style="position:absolute;left:56.69px;top:118.46px" class="cls_004"><span class="cls_004">permissions that might be set on the object. The list of global permissions is short:</span></div>
<div style="position:absolute;left:104.69px;top:140.19px" class="cls_004"><span class="cls_004">Those belonging to the Administrator role always have full control</span></div>
<div style="position:absolute;left:104.69px;top:154.95px" class="cls_004"><span class="cls_004">Content owners (people belonging to the Owner role for a particular piece of</span></div>
<div style="position:absolute;left:104.69px;top:167.55px" class="cls_004"><span class="cls_004">content) always have full control</span></div>
<div style="position:absolute;left:104.69px;top:182.31px" class="cls_004"><span class="cls_004">Lock owners (people belonging to the Lock Owner role for a particular piece of</span></div>
<div style="position:absolute;left:104.69px;top:194.91px" class="cls_004"><span class="cls_004">content) always have Unlock, CheckIn, and Cancel Checkout permissions</span></div>
<div style="position:absolute;left:56.69px;top:231.85px" class="cls_023"><span class="cls_023">Mapping Permissions to Methods</span></div>
<div style="position:absolute;left:56.69px;top:254.56px" class="cls_004"><span class="cls_004">The names of the low-level permissions are pretty descriptive, but you might be wondering</span></div>
<div style="position:absolute;left:56.69px;top:267.16px" class="cls_004"><span class="cls_004">how these permissions are hooked in to the Alfresco API. As mentioned earlier in the</span></div>
<div style="position:absolute;left:56.69px;top:279.76px" class="cls_004"><span class="cls_004">chapter, Alfresco uses Spring Security. Spring Security bean configurations map methods in</span></div>
<div style="position:absolute;left:56.69px;top:292.36px" class="cls_004"><span class="cls_004">Alfresco's service classes to permissions. You can see the mapping in </span><span class="cls_013">alfresco|public-</span></div>
<div style="position:absolute;left:56.69px;top:305.64px" class="cls_013"><span class="cls_013">services-security-context.xml</span><span class="cls_004"> packaged in the JAR file </span><span class="cls_013">alfresco-</span></div>
<div style="position:absolute;left:56.69px;top:318.92px" class="cls_013"><span class="cls_013">repository-5.x.jar</span><span class="cls_004">. Following is a portion of the mapping for the NodeService with</span></div>
<div style="position:absolute;left:56.69px;top:332.20px" class="cls_004"><span class="cls_004">methods requiring the </span><span class="cls_013">ReadProperties</span><span class="cls_004"> permission highlighted, as an example:</span></div>
<div style="position:absolute;left:74.69px;top:353.80px" class="cls_010"><span class="cls_010">&lt;bean id="NodeService_security"</span></div>
<div style="position:absolute;left:74.69px;top:364.60px" class="cls_010"><span class="cls_010">class="org.alfresco.repo.security.permissions.impl.acegi.MethodSecurityInte</span></div>
<div style="position:absolute;left:74.69px;top:375.40px" class="cls_010"><span class="cls_010">rceptor"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:386.20px" class="cls_010"><span class="cls_010">&lt;property name="authenticationManager"&gt;&lt;ref</span></div>
<div style="position:absolute;left:74.69px;top:397.00px" class="cls_010"><span class="cls_010">bean="authenticationManager"/&gt;&lt;/property&gt;</span></div>
<div style="position:absolute;left:96.29px;top:407.80px" class="cls_010"><span class="cls_010">&lt;property name="accessDecisionManager"&gt;&lt;ref</span></div>
<div style="position:absolute;left:74.69px;top:418.60px" class="cls_010"><span class="cls_010">local="accessDecisionManager"/&gt;&lt;/property&gt;</span></div>
<div style="position:absolute;left:96.29px;top:429.40px" class="cls_010"><span class="cls_010">&lt;property name="afterInvocationManager"&gt;&lt;ref</span></div>
<div style="position:absolute;left:74.69px;top:440.20px" class="cls_010"><span class="cls_010">local="afterInvocationManager"/&gt;&lt;/property&gt;</span></div>
<div style="position:absolute;left:96.29px;top:451.00px" class="cls_010"><span class="cls_010">&lt;property name="objectDefinitionSource"&gt;</span></div>
<div style="position:absolute;left:96.29px;top:461.80px" class="cls_010"><span class="cls_010">&lt;value&gt;</span></div>
<div style="position:absolute;left:117.89px;top:472.60px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService.</span></div>
<div style="position:absolute;left:128.69px;top:483.40px" class="cls_010"><span class="cls_010">getStores=ACL_ALLOW,AFTER_ACL_NODE.sys:base.ReadProperties</span></div>
<div style="position:absolute;left:117.89px;top:494.20px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:128.69px;top:505.00px" class="cls_010"><span class="cls_010">.createStore=ACL_METHOD.ROLE_ADMINISTRATOR</span></div>
<div style="position:absolute;left:117.89px;top:515.80px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:128.69px;top:526.60px" class="cls_010"><span class="cls_010">.exists=ACL_ALLOW</span></div>
<div style="position:absolute;left:117.89px;top:537.40px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:128.69px;top:548.20px" class="cls_010"><span class="cls_010">.getNodeStatus=ACL_NODE.0.sys:base.ReadProperties</span></div>
<div style="position:absolute;left:117.89px;top:559.00px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:128.69px;top:569.80px" class="cls_010"><span class="cls_010">.getNodeRef=AFTER_ACL_NODE.sys:base.ReadProperties</span></div>
<div style="position:absolute;left:117.89px;top:580.60px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 494 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:344084px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background510.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:74.69px;top:80.62px" class="cls_010"><span class="cls_010">.getAllRootNodes=ACL_NODE.0.sys:base.ReadProperties,AFTER_ACL_NODE.sys:base</span></div>
<div style="position:absolute;left:74.69px;top:91.42px" class="cls_010"><span class="cls_010">.ReadProperties</span></div>
<div style="position:absolute;left:117.89px;top:102.22px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:128.69px;top:113.02px" class="cls_010"><span class="cls_010">.getRootNode=ACL_NODE.0.sys:base.ReadProperties</span></div>
<div style="position:absolute;left:117.89px;top:123.82px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:128.69px;top:134.62px" class="cls_010"><span class="cls_010">.createNode=ACL_NODE.0.sys:base.CreateChildren</span></div>
<div style="position:absolute;left:117.89px;top:145.42px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:74.69px;top:167.02px" class="cls_010"><span class="cls_010">.moveNode=ACL_NODE.0.sys:base.DeleteNode,ACL_NODE.1.sys:base.CreateChildren</span></div>
<div style="position:absolute;left:117.89px;top:177.82px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:123.29px;top:188.62px" class="cls_010"><span class="cls_010">.setChildAssociationIndex=ACL_PARENT.0.sys:base.WriteProperties</span></div>
<div style="position:absolute;left:117.89px;top:199.42px" class="cls_010"><span class="cls_010">org.alfresco.service.cmr.repository.NodeService</span></div>
<div style="position:absolute;left:128.69px;top:210.22px" class="cls_010"><span class="cls_010">.getType=ACL_ALLOW</span></div>
<div style="position:absolute;left:56.69px;top:241.50px" class="cls_004"><span class="cls_004">If you develop your own services, you can follow the same pattern to secure your methods</span></div>
<div style="position:absolute;left:56.69px;top:254.10px" class="cls_004"><span class="cls_004">using the same set of permission definitions.</span></div>
<div style="position:absolute;left:56.69px;top:292.85px" class="cls_008"><span class="cls_008">Summary</span></div>
<div style="position:absolute;left:56.69px;top:320.58px" class="cls_004"><span class="cls_004">When you started out the chapter, you had an Alfresco server that only knew about the</span></div>
<div style="position:absolute;left:56.69px;top:333.18px" class="cls_004"><span class="cls_004">users stored in its repository. By now, your server is not only authenticating against an</span></div>
<div style="position:absolute;left:56.69px;top:345.78px" class="cls_004"><span class="cls_004">external LDAP directory, but can also share a session with other web applications through</span></div>
<div style="position:absolute;left:56.69px;top:358.38px" class="cls_004"><span class="cls_004">the magic of Single Sign-On (SSO).</span></div>
<div style="position:absolute;left:56.69px;top:379.98px" class="cls_004"><span class="cls_004">You saw some sample code for working with three of Alfresco's security services classes</span></div>
<div style="position:absolute;left:56.69px;top:392.58px" class="cls_004"><span class="cls_004">(</span><span class="cls_013">AuthenticationService</span><span class="cls_004">, </span><span class="cls_013">AuthorityService</span><span class="cls_004">, and </span><span class="cls_013">PersonService</span><span class="cls_004">)</span></div>
<div style="position:absolute;left:56.69px;top:405.86px" class="cls_004"><span class="cls_004">and also learned where Alfresco keeps its permission definitions (and how to</span></div>
<div style="position:absolute;left:56.69px;top:418.46px" class="cls_004"><span class="cls_004">extend them).</span></div>
<div style="position:absolute;left:56.69px;top:440.06px" class="cls_004"><span class="cls_004">Specifically, you learned how to:</span></div>
<div style="position:absolute;left:104.69px;top:461.79px" class="cls_004"><span class="cls_004">Install a basic OpenLDAP implementation</span></div>
<div style="position:absolute;left:104.69px;top:476.55px" class="cls_004"><span class="cls_004">Configure Alfresco to authenticate against LDAP, including </span><span class="cls_022">“</span><span class="cls_004">chaining</span><span class="cls_022">”</span><span class="cls_004"> LDAP</span></div>
<div style="position:absolute;left:104.69px;top:489.98px" class="cls_004"><span class="cls_004">with Alfresco authentication</span></div>
<div style="position:absolute;left:104.69px;top:504.74px" class="cls_004"><span class="cls_004">Configure LDAP synchronization</span></div>
<div style="position:absolute;left:104.69px;top:519.50px" class="cls_004"><span class="cls_004">Install and configure a popular open source SSO solution from JA-SIG</span></div>
<div style="position:absolute;left:104.69px;top:532.10px" class="cls_004"><span class="cls_004">called CAS</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 495 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:344760px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background511.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:43.67px" class="cls_019"><span class="cls_019">Security</span></div>
<div style="position:absolute;left:104.69px;top:70.50px" class="cls_004"><span class="cls_004">Establish SSO between Alfresco and two of Tomcat's sample servlets</span></div>
<div style="position:absolute;left:104.69px;top:85.26px" class="cls_004"><span class="cls_004">Create users and groups with the Alfresco API</span></div>
<div style="position:absolute;left:104.69px;top:100.02px" class="cls_004"><span class="cls_004">Understand the out-of-the-box permissions</span></div>
<div style="position:absolute;left:104.69px;top:114.78px" class="cls_004"><span class="cls_004">Define a custom permission group or role, which you then leveraged to refactor</span></div>
<div style="position:absolute;left:104.69px;top:127.38px" class="cls_004"><span class="cls_004">how the SomeCo Web Enable/Disable links work</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 496 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:345436px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background512.jpg" width="541" height="666"></div>
<div style="position:absolute;left:411.34px;top:69.12px" class="cls_011"><span class="cls_011">Index</span></div>
<div style="position:absolute;left:285.30px;top:164.17px" class="cls_009"><span class="cls_009">examples  </span><span class="cls_010">28</span></div>
<div style="position:absolute;left:56.69px;top:164.05px" class="cls_041"><span class="cls_041">A</span></div>
<div style="position:absolute;left:285.30px;top:175.63px" class="cls_009"><span class="cls_009">integration, with other systems  </span><span class="cls_010">30</span></div>
<div style="position:absolute;left:56.69px;top:184.80px" class="cls_009"><span class="cls_009">action configurable</span></div>
<div style="position:absolute;left:285.30px;top:187.09px" class="cls_009"><span class="cls_009">RESTful API, creating  </span><span class="cls_010">29</span></div>
<div style="position:absolute;left:64.20px;top:196.26px" class="cls_009"><span class="cls_009">creating, in Alfresco Share  </span><span class="cls_010">128</span><span class="cls_009">, </span><span class="cls_010">130</span></div>
<div style="position:absolute;left:277.80px;top:198.55px" class="cls_009"><span class="cls_009">advanced web scripts  </span><span class="cls_010">316</span></div>
<div style="position:absolute;left:56.69px;top:207.72px" class="cls_009"><span class="cls_009">actions</span></div>
<div style="position:absolute;left:277.80px;top:210.01px" class="cls_009"><span class="cls_009">Aikau</span></div>
<div style="position:absolute;left:64.20px;top:219.18px" class="cls_009"><span class="cls_009">content operations, encapsulating in  </span><span class="cls_010">120</span></div>
<div style="position:absolute;left:285.30px;top:221.48px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">173</span></div>
<div style="position:absolute;left:64.20px;top:230.64px" class="cls_009"><span class="cls_009">creating, that require user-specified parameters</span></div>
<div style="position:absolute;left:285.30px;top:232.94px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">173</span></div>
<div style="position:absolute;left:70.19px;top:241.09px" class="cls_010"><span class="cls_010">127</span></div>
<div style="position:absolute;left:277.80px;top:244.40px" class="cls_009"><span class="cls_009">Alfresco add-Ons</span></div>
<div style="position:absolute;left:64.20px;top:252.36px" class="cls_009"><span class="cls_009">hiding, from end users  </span><span class="cls_010">127</span></div>
<div style="position:absolute;left:285.30px;top:255.86px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">20</span></div>
<div style="position:absolute;left:56.69px;top:263.82px" class="cls_009"><span class="cls_009">Activiti API</span></div>
<div style="position:absolute;left:277.80px;top:267.32px" class="cls_009"><span class="cls_009">Alfresco all-in-one (AIO)</span></div>
<div style="position:absolute;left:378.82px;top:267.32px" class="cls_010"><span class="cls_010">35</span></div>
<div style="position:absolute;left:64.20px;top:275.29px" class="cls_009"><span class="cls_009">third-party review, implementing  </span><span class="cls_010">373</span><span class="cls_009">, </span><span class="cls_010">374</span><span class="cls_009">, </span><span class="cls_010">375</span><span class="cls_009">,</span></div>
<div style="position:absolute;left:277.80px;top:278.78px" class="cls_009"><span class="cls_009">Alfresco APIs</span></div>
<div style="position:absolute;left:70.19px;top:286.74px" class="cls_010"><span class="cls_010">379</span><span class="cls_009">, </span><span class="cls_010">383</span><span class="cls_009">, </span><span class="cls_010">387</span></div>
<div style="position:absolute;left:285.30px;top:290.24px" class="cls_009"><span class="cls_009">Alfresco One API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:64.20px;top:298.21px" class="cls_009"><span class="cls_009">third-party review, making robust  </span><span class="cls_010">388</span></div>
<div style="position:absolute;left:285.30px;top:301.70px" class="cls_009"><span class="cls_009">CMS API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:64.20px;top:309.67px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">372</span></div>
<div style="position:absolute;left:285.30px;top:313.16px" class="cls_009"><span class="cls_009">Foundation API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:56.69px;top:321.13px" class="cls_009"><span class="cls_009">Activiti documentation</span></div>
<div style="position:absolute;left:285.30px;top:324.62px" class="cls_009"><span class="cls_009">FreeMaker API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:64.20px;top:332.59px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">336</span></div>
<div style="position:absolute;left:285.30px;top:336.08px" class="cls_009"><span class="cls_009">Web script framework  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:56.69px;top:344.05px" class="cls_009"><span class="cls_009">Activiti graphical process designer</span></div>
<div style="position:absolute;left:277.80px;top:347.54px" class="cls_009"><span class="cls_009">Alfresco architecture</span></div>
<div style="position:absolute;left:64.20px;top:355.51px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">328</span></div>
<div style="position:absolute;left:285.30px;top:359.00px" class="cls_009"><span class="cls_009">characteristics</span></div>
<div style="position:absolute;left:347.82px;top:359.00px" class="cls_010"><span class="cls_010">18</span></div>
<div style="position:absolute;left:56.69px;top:366.97px" class="cls_009"><span class="cls_009">Activiti process designer</span></div>
<div style="position:absolute;left:285.30px;top:370.46px" class="cls_009"><span class="cls_009">high-level architecture</span></div>
<div style="position:absolute;left:378.33px;top:370.46px" class="cls_010"><span class="cls_010">18</span><span class="cls_009">, </span><span class="cls_010">19</span></div>
<div style="position:absolute;left:64.20px;top:378.43px" class="cls_009"><span class="cls_009">used, for creating processes  </span><span class="cls_010">330</span><span class="cls_009">, </span><span class="cls_010">331</span><span class="cls_009">, </span><span class="cls_010">333</span><span class="cls_009">, </span><span class="cls_010">334</span></div>
<div style="position:absolute;left:277.80px;top:381.92px" class="cls_009"><span class="cls_009">Alfresco code</span></div>
<div style="position:absolute;left:56.69px;top:389.89px" class="cls_009"><span class="cls_009">Activiti-related API</span></div>
<div style="position:absolute;left:285.30px;top:393.38px" class="cls_009"><span class="cls_009">modification, avoiding</span></div>
<div style="position:absolute;left:376.84px;top:393.38px" class="cls_010"><span class="cls_010">65</span></div>
<div style="position:absolute;left:64.20px;top:401.35px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">239</span></div>
<div style="position:absolute;left:277.80px;top:404.84px" class="cls_009"><span class="cls_009">Alfresco Community 201605  </span><span class="cls_010">32</span></div>
<div style="position:absolute;left:56.69px;top:412.81px" class="cls_009"><span class="cls_009">Activiti</span></div>
<div style="position:absolute;left:277.80px;top:416.30px" class="cls_009"><span class="cls_009">Alfresco Community Edition  </span><span class="cls_010">32</span></div>
<div style="position:absolute;left:64.20px;top:424.27px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">324</span></div>
<div style="position:absolute;left:277.80px;top:427.76px" class="cls_009"><span class="cls_009">Alfresco configuration</span></div>
<div style="position:absolute;left:64.20px;top:435.73px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:439.22px" class="cls_009"><span class="cls_009">modification, avoiding</span></div>
<div style="position:absolute;left:376.84px;top:439.22px" class="cls_010"><span class="cls_010">65</span></div>
<div style="position:absolute;left:56.69px;top:447.19px" class="cls_009"><span class="cls_009">ActivitiDesigner</span></div>
<div style="position:absolute;left:277.80px;top:450.68px" class="cls_009"><span class="cls_009">Alfresco demo shell</span></div>
<div style="position:absolute;left:64.20px;top:458.65px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">328</span></div>
<div style="position:absolute;left:285.30px;top:462.14px" class="cls_009"><span class="cls_009">running  </span><span class="cls_010">258</span><span class="cls_009">, </span><span class="cls_010">260</span></div>
<div style="position:absolute;left:64.20px;top:470.11px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">329</span></div>
<div style="position:absolute;left:277.80px;top:473.60px" class="cls_009"><span class="cls_009">Alfresco Development Environment (ADF)</span></div>
<div style="position:absolute;left:56.69px;top:481.57px" class="cls_009"><span class="cls_009">admin user</span></div>
<div style="position:absolute;left:285.30px;top:485.07px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">230</span><span class="cls_009">, </span><span class="cls_010">231</span></div>
<div style="position:absolute;left:64.20px;top:493.03px" class="cls_009"><span class="cls_009">securing  </span><span class="cls_010">472</span></div>
<div style="position:absolute;left:285.30px;top:496.52px" class="cls_009"><span class="cls_009">components  </span><span class="cls_010">231</span></div>
<div style="position:absolute;left:56.69px;top:504.49px" class="cls_009"><span class="cls_009">advanced customization, Alfresco</span></div>
<div style="position:absolute;left:285.30px;top:507.99px" class="cls_009"><span class="cls_009">environments, preparing  </span><span class="cls_010">232</span></div>
<div style="position:absolute;left:64.20px;top:515.95px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">28</span></div>
<div style="position:absolute;left:285.30px;top:519.45px" class="cls_009"><span class="cls_009">new virtual machine, creating  </span><span class="cls_010">235</span></div>
<div style="position:absolute;left:64.20px;top:527.41px" class="cls_009"><span class="cls_009">Alfresco Share customization  </span><span class="cls_010">29</span></div>
<div style="position:absolute;left:277.80px;top:530.91px" class="cls_009"><span class="cls_009">Alfresco Enterprise</span></div>
<div style="position:absolute;left:64.20px;top:538.87px" class="cls_009"><span class="cls_009">automatic operations, performing on content  </span><span class="cls_010">29</span></div>
<div style="position:absolute;left:285.30px;top:542.37px" class="cls_009"><span class="cls_009">modules installation, checking  </span><span class="cls_010">60</span></div>
<div style="position:absolute;left:64.20px;top:550.34px" class="cls_009"><span class="cls_009">complex business processes, streamlining with</span></div>
<div style="position:absolute;left:277.80px;top:553.83px" class="cls_009"><span class="cls_009">Alfresco in the Cloud  </span><span class="cls_010">32</span></div>
<div style="position:absolute;left:70.19px;top:561.79px" class="cls_009"><span class="cls_009">advanced workflows  </span><span class="cls_010">30</span></div>
<div style="position:absolute;left:277.80px;top:565.29px" class="cls_009"><span class="cls_009">Alfresco Mobile  </span><span class="cls_010">417</span></div>
<div style="position:absolute;left:64.20px;top:573.26px" class="cls_009"><span class="cls_009">content model, extending  </span><span class="cls_010">28</span></div>
<div style="position:absolute;left:277.80px;top:576.75px" class="cls_009"><span class="cls_009">Alfresco Mobile SDK for Android</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:346112px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background513.jpg" width="541" height="666"></div>
<div style="position:absolute;left:64.20px;top:70.57px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">417</span></div>
<div style="position:absolute;left:285.30px;top:70.57px" class="cls_009"><span class="cls_009">customizing  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:64.20px;top:82.03px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">417</span></div>
<div style="position:absolute;left:285.30px;top:82.03px" class="cls_009"><span class="cls_009">dashlets  </span><span class="cls_010">202</span></div>
<div style="position:absolute;left:56.69px;top:93.49px" class="cls_009"><span class="cls_009">Alfresco Mobile SDK for iOS</span></div>
<div style="position:absolute;left:285.30px;top:93.49px" class="cls_009"><span class="cls_009">downloading  </span><span class="cls_010">51</span></div>
<div style="position:absolute;left:64.20px;top:104.95px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">417</span></div>
<div style="position:absolute;left:285.30px;top:104.95px" class="cls_009"><span class="cls_009">example document types  </span><span class="cls_010">16</span></div>
<div style="position:absolute;left:64.20px;top:116.42px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">417</span></div>
<div style="position:absolute;left:285.30px;top:116.42px" class="cls_009"><span class="cls_009">extending  </span><span class="cls_010">61</span></div>
<div style="position:absolute;left:56.69px;top:127.88px" class="cls_009"><span class="cls_009">Alfresco Module Packages (AMP)  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:285.30px;top:127.88px" class="cls_009"><span class="cls_009">extension mechanism  </span><span class="cls_010">61</span></div>
<div style="position:absolute;left:56.69px;top:139.34px" class="cls_009"><span class="cls_009">Alfresco Node browser  </span><span class="cls_010">70</span></div>
<div style="position:absolute;left:285.30px;top:139.34px" class="cls_009"><span class="cls_009">installing</span></div>
<div style="position:absolute;left:325.32px;top:139.34px" class="cls_010"><span class="cls_010">50</span></div>
<div style="position:absolute;left:56.69px;top:150.80px" class="cls_009"><span class="cls_009">Alfresco Office Services (AOS)  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:285.30px;top:150.80px" class="cls_009"><span class="cls_009">major standards  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:56.69px;top:162.26px" class="cls_009"><span class="cls_009">Alfresco One  </span><span class="cls_010">32</span></div>
<div style="position:absolute;left:285.30px;top:162.26px" class="cls_009"><span class="cls_009">open source components  </span><span class="cls_010">20</span></div>
<div style="position:absolute;left:56.69px;top:173.72px" class="cls_009"><span class="cls_009">Alfresco One API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:285.30px;top:173.72px" class="cls_009"><span class="cls_009">protocols  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:56.69px;top:185.18px" class="cls_009"><span class="cls_009">Alfresco repository  </span><span class="cls_010">72</span></div>
<div style="position:absolute;left:285.30px;top:185.18px" class="cls_009"><span class="cls_009">workflow options, comparing  </span><span class="cls_010">393</span></div>
<div style="position:absolute;left:56.69px;top:196.64px" class="cls_009"><span class="cls_009">Alfresco Repository AMP  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:277.80px;top:196.64px" class="cls_009"><span class="cls_009">Alloy framework  </span><span class="cls_010">427</span></div>
<div style="position:absolute;left:56.69px;top:208.10px" class="cls_009"><span class="cls_009">Alfresco repository web application  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:277.80px;top:208.10px" class="cls_009"><span class="cls_009">AMP modules</span></div>
<div style="position:absolute;left:56.69px;top:219.56px" class="cls_009"><span class="cls_009">Alfresco Sample UI</span></div>
<div style="position:absolute;left:285.30px;top:219.56px" class="cls_009"><span class="cls_009">deploying  </span><span class="cls_010">58</span></div>
<div style="position:absolute;left:64.20px;top:231.02px" class="cls_009"><span class="cls_009">importing  </span><span class="cls_010">418</span><span class="cls_009">, </span><span class="cls_010">420</span><span class="cls_009">, </span><span class="cls_010">421</span><span class="cls_009">, </span><span class="cls_010">423</span><span class="cls_009">, </span><span class="cls_010">426</span></div>
<div style="position:absolute;left:277.80px;top:231.02px" class="cls_009"><span class="cls_009">Angular web application</span></div>
<div style="position:absolute;left:64.20px;top:242.48px" class="cls_009"><span class="cls_009">running  </span><span class="cls_010">418</span><span class="cls_009">, </span><span class="cls_010">420</span><span class="cls_009">, </span><span class="cls_010">421</span><span class="cls_009">, </span><span class="cls_010">423</span><span class="cls_009">, </span><span class="cls_010">426</span></div>
<div style="position:absolute;left:285.30px;top:242.48px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:242.48px" class="cls_010"><span class="cls_010">247</span><span class="cls_009">, </span><span class="cls_010">249</span><span class="cls_009">, </span><span class="cls_010">253</span><span class="cls_009">, </span><span class="cls_010">255</span></div>
<div style="position:absolute;left:56.69px;top:253.94px" class="cls_009"><span class="cls_009">Alfresco SDK  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:285.30px;top:253.94px" class="cls_009"><span class="cls_009">prerequisites, installing</span></div>
<div style="position:absolute;left:381.83px;top:253.94px" class="cls_010"><span class="cls_010">248</span></div>
<div style="position:absolute;left:56.69px;top:265.40px" class="cls_009"><span class="cls_009">Alfresco Share AMP  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:277.80px;top:265.40px" class="cls_009"><span class="cls_009">Angular</span></div>
<div style="position:absolute;left:56.69px;top:276.86px" class="cls_009"><span class="cls_009">Alfresco Share web application  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:285.30px;top:276.86px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">247</span></div>
<div style="position:absolute;left:56.69px;top:288.32px" class="cls_009"><span class="cls_009">Alfresco Share</span></div>
<div style="position:absolute;left:277.80px;top:288.32px" class="cls_009"><span class="cls_009">Apache Axis</span></div>
<div style="position:absolute;left:64.20px;top:299.78px" class="cls_009"><span class="cls_009">action configurable, creating in</span></div>
<div style="position:absolute;left:191.26px;top:299.78px" class="cls_010"><span class="cls_010">128</span><span class="cls_009">, </span><span class="cls_010">130</span></div>
<div style="position:absolute;left:285.30px;top:299.78px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:64.20px;top:311.24px" class="cls_009"><span class="cls_009">action evaluators, writing to hide UI</span></div>
<div style="position:absolute;left:209.26px;top:311.24px" class="cls_010"><span class="cls_010">182</span></div>
<div style="position:absolute;left:277.80px;top:311.24px" class="cls_009"><span class="cls_009">Apache Chemistry</span></div>
<div style="position:absolute;left:64.20px;top:322.70px" class="cls_009"><span class="cls_009">action evaluators, writing to show UI  </span><span class="cls_010">182</span></div>
<div style="position:absolute;left:285.30px;top:322.70px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">111</span></div>
<div style="position:absolute;left:64.20px;top:334.16px" class="cls_009"><span class="cls_009">action item, adding to set web flag  </span><span class="cls_010">178</span><span class="cls_009">, </span><span class="cls_010">180</span><span class="cls_009">,</span></div>
<div style="position:absolute;left:277.80px;top:334.16px" class="cls_009"><span class="cls_009">Apache FOP</span></div>
<div style="position:absolute;left:70.19px;top:344.60px" class="cls_010"><span class="cls_010">181</span></div>
<div style="position:absolute;left:285.30px;top:345.62px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:64.20px;top:355.88px" class="cls_009"><span class="cls_009">action item, restricting by permission</span></div>
<div style="position:absolute;left:214.74px;top:355.88px" class="cls_010"><span class="cls_010">182</span></div>
<div style="position:absolute;left:277.80px;top:357.08px" class="cls_009"><span class="cls_009">Apache Maven project</span></div>
<div style="position:absolute;left:64.20px;top:367.34px" class="cls_009"><span class="cls_009">customizing  </span><span class="cls_010">29</span><span class="cls_009">, </span><span class="cls_010">172</span></div>
<div style="position:absolute;left:285.30px;top:368.54px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">38</span></div>
<div style="position:absolute;left:64.20px;top:378.80px" class="cls_009"><span class="cls_009">evaluators, creating</span></div>
<div style="position:absolute;left:147.74px;top:378.80px" class="cls_010"><span class="cls_010">183</span></div>
<div style="position:absolute;left:277.80px;top:380.00px" class="cls_009"><span class="cls_009">Apache POI</span></div>
<div style="position:absolute;left:64.20px;top:390.26px" class="cls_009"><span class="cls_009">form rendering, modifying  </span><span class="cls_010">186</span></div>
<div style="position:absolute;left:285.30px;top:391.46px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:64.20px;top:401.73px" class="cls_009"><span class="cls_009">menu items, adding  </span><span class="cls_010">173</span><span class="cls_009">, </span><span class="cls_010">174</span><span class="cls_009">, </span><span class="cls_010">175</span></div>
<div style="position:absolute;left:277.80px;top:402.92px" class="cls_009"><span class="cls_009">Apache Solr</span></div>
<div style="position:absolute;left:64.20px;top:413.18px" class="cls_009"><span class="cls_009">status field, modifying to display Stoplight</span></div>
<div style="position:absolute;left:285.30px;top:414.39px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:70.19px;top:424.65px" class="cls_009"><span class="cls_009">Indicator</span></div>
<div style="position:absolute;left:109.71px;top:424.65px" class="cls_010"><span class="cls_010">190</span></div>
<div style="position:absolute;left:277.80px;top:425.85px" class="cls_009"><span class="cls_009">Appcelerator Studio</span></div>
<div style="position:absolute;left:64.20px;top:436.11px" class="cls_009"><span class="cls_009">text area field, used for modifying form rendering</span></div>
<div style="position:absolute;left:285.30px;top:437.31px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">420</span></div>
<div style="position:absolute;left:70.19px;top:446.55px" class="cls_010"><span class="cls_010">187</span></div>
<div style="position:absolute;left:277.80px;top:448.77px" class="cls_009"><span class="cls_009">Appcelerator</span></div>
<div style="position:absolute;left:56.69px;top:457.83px" class="cls_009"><span class="cls_009">Alfresco UI</span></div>
<div style="position:absolute;left:285.30px;top:460.23px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">417</span><span class="cls_009">, </span><span class="cls_010">418</span></div>
<div style="position:absolute;left:64.20px;top:469.29px" class="cls_009"><span class="cls_009">process, wiring to  </span><span class="cls_010">337</span></div>
<div style="position:absolute;left:277.80px;top:471.69px" class="cls_009"><span class="cls_009">aspect  </span><span class="cls_010">84</span></div>
<div style="position:absolute;left:56.69px;top:480.75px" class="cls_009"><span class="cls_009">Alfresco WCM</span></div>
<div style="position:absolute;left:277.80px;top:483.15px" class="cls_009"><span class="cls_009">associations</span></div>
<div style="position:absolute;left:64.20px;top:492.21px" class="cls_009"><span class="cls_009">example  </span><span class="cls_010">14</span></div>
<div style="position:absolute;left:285.30px;top:494.61px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">82</span><span class="cls_009">, </span><span class="cls_010">83</span></div>
<div style="position:absolute;left:56.69px;top:503.67px" class="cls_009"><span class="cls_009">Alfresco</span></div>
<div style="position:absolute;left:285.30px;top:506.07px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:506.07px" class="cls_010"><span class="cls_010">114</span></div>
<div style="position:absolute;left:64.20px;top:515.13px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">8</span></div>
<div style="position:absolute;left:64.20px;top:526.59px" class="cls_009"><span class="cls_009">add-ons  </span><span class="cls_010">20</span></div>
<div style="position:absolute;left:277.80px;top:522.27px" class="cls_041"><span class="cls_041">B</span></div>
<div style="position:absolute;left:64.20px;top:538.05px" class="cls_009"><span class="cls_009">advanced customization  </span><span class="cls_010">28</span></div>
<div style="position:absolute;left:277.80px;top:543.02px" class="cls_009"><span class="cls_009">basic action</span></div>
<div style="position:absolute;left:64.20px;top:549.51px" class="cls_009"><span class="cls_009">basic customization  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:285.30px;top:554.48px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:554.48px" class="cls_010"><span class="cls_010">121</span></div>
<div style="position:absolute;left:64.20px;top:560.97px" class="cls_009"><span class="cls_009">configuring, to authenticate against LDAP  </span><span class="cls_010">442</span><span class="cls_009">,</span></div>
<div style="position:absolute;left:277.80px;top:565.94px" class="cls_009"><span class="cls_009">basic customization, Alfresco</span></div>
<div style="position:absolute;left:70.19px;top:572.43px" class="cls_010"><span class="cls_010">443</span><span class="cls_009">, </span><span class="cls_010">444</span></div>
<div style="position:absolute;left:285.30px;top:577.40px" class="cls_009"><span class="cls_009">custom site configuration  </span><span class="cls_010">26</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 498 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:346788px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background514.jpg" width="541" height="666"></div>
<div style="position:absolute;left:64.20px;top:70.57px" class="cls_009"><span class="cls_009">dashlets  </span><span class="cls_010">24</span></div>
<div style="position:absolute;left:285.30px;top:70.57px" class="cls_009"><span class="cls_009">Java, using for  </span><span class="cls_010">304</span></div>
<div style="position:absolute;left:64.20px;top:82.03px" class="cls_009"><span class="cls_009">simple workflow  </span><span class="cls_010">27</span></div>
<div style="position:absolute;left:285.30px;top:82.03px" class="cls_009"><span class="cls_009">JavaScript, using for  </span><span class="cls_010">304</span></div>
<div style="position:absolute;left:56.69px;top:93.49px" class="cls_009"><span class="cls_009">batch manipulation</span></div>
<div style="position:absolute;left:277.80px;top:93.49px" class="cls_009"><span class="cls_009">critical functionality requisites, for basic document</span></div>
<div style="position:absolute;left:64.20px;top:104.95px" class="cls_009"><span class="cls_009">JavaScript, using for  </span><span class="cls_010">110</span></div>
<div style="position:absolute;left:291.30px;top:104.95px" class="cls_009"><span class="cls_009">management</span></div>
<div style="position:absolute;left:56.69px;top:116.42px" class="cls_009"><span class="cls_009">behavior</span></div>
<div style="position:absolute;left:285.30px;top:116.42px" class="cls_009"><span class="cls_009">customizable user interface  </span><span class="cls_010">11</span></div>
<div style="position:absolute;left:64.20px;top:127.88px" class="cls_009"><span class="cls_009">binding, to child types</span></div>
<div style="position:absolute;left:155.75px;top:127.88px" class="cls_010"><span class="cls_010">148</span></div>
<div style="position:absolute;left:285.30px;top:127.88px" class="cls_009"><span class="cls_009">easy integration with authoring tools  </span><span class="cls_010">10</span></div>
<div style="position:absolute;left:56.69px;top:139.34px" class="cls_009"><span class="cls_009">behaviors</span></div>
<div style="position:absolute;left:285.30px;top:139.34px" class="cls_009"><span class="cls_009">library services</span></div>
<div style="position:absolute;left:350.31px;top:139.34px" class="cls_010"><span class="cls_010">10</span></div>
<div style="position:absolute;left:64.20px;top:150.80px" class="cls_009"><span class="cls_009">logic, binding to custom types  </span><span class="cls_010">139</span></div>
<div style="position:absolute;left:285.30px;top:150.80px" class="cls_009"><span class="cls_009">scalability/reliability</span></div>
<div style="position:absolute;left:366.81px;top:150.80px" class="cls_010"><span class="cls_010">10</span></div>
<div style="position:absolute;left:56.69px;top:162.26px" class="cls_009"><span class="cls_009">box policies</span></div>
<div style="position:absolute;left:285.30px;top:162.26px" class="cls_009"><span class="cls_009">security</span></div>
<div style="position:absolute;left:321.31px;top:162.26px" class="cls_010"><span class="cls_010">10</span></div>
<div style="position:absolute;left:64.20px;top:173.72px" class="cls_009"><span class="cls_009">figuring out</span></div>
<div style="position:absolute;left:113.73px;top:173.72px" class="cls_010"><span class="cls_010">144</span></div>
<div style="position:absolute;left:285.30px;top:173.72px" class="cls_009"><span class="cls_009">workflow  </span><span class="cls_010">10</span></div>
<div style="position:absolute;left:56.69px;top:185.18px" class="cls_009"><span class="cls_009">BPM (Business Process Management)  </span><span class="cls_010">323</span></div>
<div style="position:absolute;left:277.80px;top:185.18px" class="cls_009"><span class="cls_009">cross-domain scripting limitation</span></div>
<div style="position:absolute;left:56.69px;top:196.64px" class="cls_009"><span class="cls_009">Business Process Model and Notation (BPMN)</span></div>
<div style="position:absolute;left:285.30px;top:196.64px" class="cls_009"><span class="cls_009">dealing with  </span><span class="cls_010">311</span></div>
<div style="position:absolute;left:70.19px;top:207.08px" class="cls_010"><span class="cls_010">324</span></div>
<div style="position:absolute;left:277.80px;top:208.10px" class="cls_009"><span class="cls_009">custom content-centric applications  </span><span class="cls_010">14</span></div>
<div style="position:absolute;left:277.80px;top:219.56px" class="cls_009"><span class="cls_009">custom dashlets</span></div>
<div style="position:absolute;left:56.69px;top:223.10px" class="cls_041"><span class="cls_041">C</span></div>
<div style="position:absolute;left:285.30px;top:231.02px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:231.02px" class="cls_010"><span class="cls_010">201</span></div>
<div style="position:absolute;left:56.69px;top:243.85px" class="cls_009"><span class="cls_009">CAS</span></div>
<div style="position:absolute;left:277.80px;top:242.48px" class="cls_009"><span class="cls_009">custom dialog</span></div>
<div style="position:absolute;left:64.20px;top:255.31px" class="cls_009"><span class="cls_009">configuring, to use LDAP for authentication  </span><span class="cls_010">465</span><span class="cls_009">,</span></div>
<div style="position:absolute;left:285.30px;top:253.94px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:253.94px" class="cls_010"><span class="cls_010">198</span></div>
<div style="position:absolute;left:70.19px;top:266.77px" class="cls_010"><span class="cls_010">467</span><span class="cls_009">, </span><span class="cls_010">469</span><span class="cls_009">, </span><span class="cls_010">471</span></div>
<div style="position:absolute;left:277.80px;top:265.40px" class="cls_009"><span class="cls_009">custom mobile application  </span><span class="cls_010">15</span></div>
<div style="position:absolute;left:56.69px;top:278.23px" class="cls_009"><span class="cls_009">case management (CM)  </span><span class="cls_010">9</span></div>
<div style="position:absolute;left:277.80px;top:276.86px" class="cls_009"><span class="cls_009">custom pages</span></div>
<div style="position:absolute;left:56.69px;top:289.69px" class="cls_009"><span class="cls_009">chaining</span></div>
<div style="position:absolute;left:285.30px;top:288.32px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:288.32px" class="cls_010"><span class="cls_010">218</span></div>
<div style="position:absolute;left:64.20px;top:301.15px" class="cls_009"><span class="cls_009">configuring</span></div>
<div style="position:absolute;left:113.22px;top:301.15px" class="cls_010"><span class="cls_010">446</span></div>
<div style="position:absolute;left:277.80px;top:299.78px" class="cls_009"><span class="cls_009">custom rule action</span></div>
<div style="position:absolute;left:56.69px;top:312.61px" class="cls_009"><span class="cls_009">CIFS  </span><span class="cls_010">11</span><span class="cls_009">, </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:285.30px;top:311.24px" class="cls_009"><span class="cls_009">requisites</span></div>
<div style="position:absolute;left:328.82px;top:311.24px" class="cls_010"><span class="cls_010">121</span></div>
<div style="position:absolute;left:56.69px;top:324.07px" class="cls_009"><span class="cls_009">classpath</span></div>
<div style="position:absolute;left:277.80px;top:322.70px" class="cls_009"><span class="cls_009">custom UI</span></div>
<div style="position:absolute;left:64.20px;top:335.53px" class="cls_009"><span class="cls_009">versus repository  </span><span class="cls_010">288</span></div>
<div style="position:absolute;left:285.30px;top:334.16px" class="cls_009"><span class="cls_009">developing, JavaScript API used  </span><span class="cls_010">240</span><span class="cls_009">, </span><span class="cls_010">244</span><span class="cls_009">, </span><span class="cls_010">246</span></div>
<div style="position:absolute;left:56.69px;top:346.99px" class="cls_009"><span class="cls_009">CMIS API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:56.69px;top:358.45px" class="cls_009"><span class="cls_009">CMIS</span></div>
<div style="position:absolute;left:277.80px;top:350.36px" class="cls_041"><span class="cls_041">D</span></div>
<div style="position:absolute;left:64.20px;top:369.91px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:277.80px;top:371.11px" class="cls_009"><span class="cls_009">Dashlet listing Whitepapers</span></div>
<div style="position:absolute;left:64.20px;top:381.37px" class="cls_009"><span class="cls_009">content, creating with</span></div>
<div style="position:absolute;left:154.24px;top:381.37px" class="cls_010"><span class="cls_010">111</span></div>
<div style="position:absolute;left:285.30px;top:382.57px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:382.57px" class="cls_010"><span class="cls_010">205</span><span class="cls_009">, </span><span class="cls_010">206</span></div>
<div style="position:absolute;left:56.69px;top:392.83px" class="cls_009"><span class="cls_009">collaboration</span></div>
<div style="position:absolute;left:112.72px;top:392.83px" class="cls_010"><span class="cls_010">9</span></div>
<div style="position:absolute;left:277.80px;top:394.03px" class="cls_009"><span class="cls_009">dashlets, Alfresco</span></div>
<div style="position:absolute;left:56.69px;top:404.29px" class="cls_009"><span class="cls_009">Content Management System (CMS)  </span><span class="cls_010">264</span></div>
<div style="position:absolute;left:285.30px;top:405.49px" class="cls_009"><span class="cls_009">My Activities  </span><span class="cls_010">202</span></div>
<div style="position:absolute;left:56.69px;top:415.75px" class="cls_009"><span class="cls_009">content operations</span></div>
<div style="position:absolute;left:277.80px;top:416.95px" class="cls_009"><span class="cls_009">dashlets, examples</span></div>
<div style="position:absolute;left:64.20px;top:427.21px" class="cls_009"><span class="cls_009">encapsulating, in actions  </span><span class="cls_010">120</span></div>
<div style="position:absolute;left:285.30px;top:428.41px" class="cls_009"><span class="cls_009">Saved Search  </span><span class="cls_010">25</span></div>
<div style="position:absolute;left:56.69px;top:438.67px" class="cls_009"><span class="cls_009">content transformer</span></div>
<div style="position:absolute;left:285.30px;top:439.87px" class="cls_009"><span class="cls_009">Web View  </span><span class="cls_010">26</span></div>
<div style="position:absolute;left:64.20px;top:450.13px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">166</span></div>
<div style="position:absolute;left:277.80px;top:451.33px" class="cls_009"><span class="cls_009">dashlets</span></div>
<div style="position:absolute;left:64.20px;top:461.60px" class="cls_009"><span class="cls_009">writing</span></div>
<div style="position:absolute;left:95.20px;top:461.60px" class="cls_010"><span class="cls_010">167</span></div>
<div style="position:absolute;left:285.30px;top:462.80px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">24</span></div>
<div style="position:absolute;left:56.69px;top:473.05px" class="cls_009"><span class="cls_009">content-as-a-service  </span><span class="cls_010">264</span></div>
<div style="position:absolute;left:285.30px;top:474.26px" class="cls_009"><span class="cls_009">filters, adding to</span></div>
<div style="position:absolute;left:353.84px;top:474.26px" class="cls_010"><span class="cls_010">208</span><span class="cls_009">, </span><span class="cls_010">211</span></div>
<div style="position:absolute;left:56.69px;top:484.52px" class="cls_009"><span class="cls_009">content-centric applications</span></div>
<div style="position:absolute;left:170.74px;top:484.52px" class="cls_010"><span class="cls_010">263</span></div>
<div style="position:absolute;left:277.80px;top:485.72px" class="cls_009"><span class="cls_009">data</span></div>
<div style="position:absolute;left:56.69px;top:495.98px" class="cls_009"><span class="cls_009">content</span></div>
<div style="position:absolute;left:285.30px;top:497.18px" class="cls_009"><span class="cls_009">retrieving, with web scripts</span></div>
<div style="position:absolute;left:395.83px;top:497.18px" class="cls_010"><span class="cls_010">274</span></div>
<div style="position:absolute;left:64.20px;top:507.44px" class="cls_009"><span class="cls_009">creating, CmisClientClass used  </span><span class="cls_010">113</span></div>
<div style="position:absolute;left:285.30px;top:508.64px" class="cls_009"><span class="cls_009">storing, in process variables</span></div>
<div style="position:absolute;left:401.84px;top:508.64px" class="cls_010"><span class="cls_010">365</span></div>
<div style="position:absolute;left:64.20px;top:518.90px" class="cls_009"><span class="cls_009">creating, with CMIS  </span><span class="cls_010">111</span></div>
<div style="position:absolute;left:277.80px;top:520.10px" class="cls_009"><span class="cls_009">Day Zero configuration guide</span></div>
<div style="position:absolute;left:64.20px;top:530.36px" class="cls_009"><span class="cls_009">creating, with JavaScript  </span><span class="cls_010">109</span></div>
<div style="position:absolute;left:285.30px;top:531.56px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">57</span></div>
<div style="position:absolute;left:64.20px;top:541.82px" class="cls_009"><span class="cls_009">deleting</span></div>
<div style="position:absolute;left:100.72px;top:541.82px" class="cls_010"><span class="cls_010">117</span></div>
<div style="position:absolute;left:277.80px;top:543.02px" class="cls_009"><span class="cls_009">default mapping</span></div>
<div style="position:absolute;left:64.20px;top:553.28px" class="cls_009"><span class="cls_009">searching for  </span><span class="cls_010">115</span></div>
<div style="position:absolute;left:285.30px;top:554.48px" class="cls_009"><span class="cls_009">overriding</span></div>
<div style="position:absolute;left:329.82px;top:554.48px" class="cls_010"><span class="cls_010">165</span></div>
<div style="position:absolute;left:64.20px;top:564.74px" class="cls_009"><span class="cls_009">working with  </span><span class="cls_010">108</span></div>
<div style="position:absolute;left:277.80px;top:565.94px" class="cls_009"><span class="cls_009">deleted ratings</span></div>
<div style="position:absolute;left:56.69px;top:576.20px" class="cls_009"><span class="cls_009">controller logic</span></div>
<div style="position:absolute;left:285.30px;top:577.40px" class="cls_009"><span class="cls_009">handling  </span><span class="cls_010">156</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 499 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:347464px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background515.jpg" width="541" height="666"></div>
<div style="position:absolute;left:56.69px;top:70.57px" class="cls_009"><span class="cls_009">dialog</span></div>
<div style="position:absolute;left:285.30px;top:70.57px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">29</span></div>
<div style="position:absolute;left:64.20px;top:82.03px" class="cls_009"><span class="cls_009">creating, to publish whitepapers  </span><span class="cls_010">199</span></div>
<div style="position:absolute;left:285.30px;top:82.03px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span><span class="cls_009">, </span><span class="cls_010">206</span></div>
<div style="position:absolute;left:56.69px;top:93.49px" class="cls_009"><span class="cls_009">digital asset management (DAM)  </span><span class="cls_010">9</span></div>
<div style="position:absolute;left:277.80px;top:93.49px" class="cls_009"><span class="cls_009">FTP  </span><span class="cls_010">11</span><span class="cls_009">, </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:56.69px;top:104.95px" class="cls_009"><span class="cls_009">Directory Server  </span><span class="cls_010">11</span></div>
<div style="position:absolute;left:56.69px;top:116.42px" class="cls_009"><span class="cls_009">document management (DM)</span></div>
<div style="position:absolute;left:277.80px;top:109.69px" class="cls_041"><span class="cls_041">G</span></div>
<div style="position:absolute;left:64.20px;top:127.88px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">8</span><span class="cls_009">, </span><span class="cls_010">9</span></div>
<div style="position:absolute;left:277.80px;top:130.44px" class="cls_009"><span class="cls_009">generator, Alfresco</span></div>
<div style="position:absolute;left:64.20px;top:139.34px" class="cls_009"><span class="cls_009">critical functionality requisites</span></div>
<div style="position:absolute;left:185.74px;top:139.34px" class="cls_010"><span class="cls_010">10</span></div>
<div style="position:absolute;left:285.30px;top:141.90px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">261</span></div>
<div style="position:absolute;left:56.69px;top:150.80px" class="cls_009"><span class="cls_009">Domain Name (DN)  </span><span class="cls_010">444</span></div>
<div style="position:absolute;left:277.80px;top:153.36px" class="cls_009"><span class="cls_009">GhostScript</span></div>
<div style="position:absolute;left:56.69px;top:162.26px" class="cls_009"><span class="cls_009">dynamic user assignment</span></div>
<div style="position:absolute;left:285.30px;top:164.82px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:64.20px;top:173.72px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">362</span></div>
<div style="position:absolute;left:277.80px;top:176.29px" class="cls_009"><span class="cls_009">global permissions  </span><span class="cls_010">494</span></div>
<div style="position:absolute;left:277.80px;top:187.74px" class="cls_009"><span class="cls_009">Google Docs  </span><span class="cls_010">20</span></div>
<div style="position:absolute;left:56.69px;top:189.92px" class="cls_041"><span class="cls_041">E</span></div>
<div style="position:absolute;left:277.80px;top:199.21px" class="cls_009"><span class="cls_009">groups</span></div>
<div style="position:absolute;left:56.69px;top:210.67px" class="cls_009"><span class="cls_009">ECM  </span><span class="cls_010">238</span></div>
<div style="position:absolute;left:285.30px;top:210.67px" class="cls_009"><span class="cls_009">creating, programmatically  </span><span class="cls_010">474</span></div>
<div style="position:absolute;left:56.69px;top:222.13px" class="cls_009"><span class="cls_009">embedded workflow engines  </span><span class="cls_010">324</span></div>
<div style="position:absolute;left:285.30px;top:222.13px" class="cls_009"><span class="cls_009">creating, through Java services  </span><span class="cls_010">478</span></div>
<div style="position:absolute;left:56.69px;top:233.59px" class="cls_009"><span class="cls_009">end users</span></div>
<div style="position:absolute;left:285.30px;top:233.59px" class="cls_009"><span class="cls_009">tasks, assigning to  </span><span class="cls_010">349</span></div>
<div style="position:absolute;left:64.20px;top:245.05px" class="cls_009"><span class="cls_009">action, hiding from  </span><span class="cls_010">127</span></div>
<div style="position:absolute;left:56.69px;top:256.51px" class="cls_009"><span class="cls_009">enterprise content management (ECM)  </span><span class="cls_010">8</span></div>
<div style="position:absolute;left:277.80px;top:249.79px" class="cls_041"><span class="cls_041">H</span></div>
<div style="position:absolute;left:56.69px;top:267.97px" class="cls_009"><span class="cls_009">extension mechanism, Alfresco</span></div>
<div style="position:absolute;left:277.80px;top:270.54px" class="cls_009"><span class="cls_009">Hello World process definition</span></div>
<div style="position:absolute;left:64.20px;top:279.43px" class="cls_009"><span class="cls_009">Alfresco configuration files</span></div>
<div style="position:absolute;left:174.24px;top:279.43px" class="cls_010"><span class="cls_010">63</span></div>
<div style="position:absolute;left:285.30px;top:282.00px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:282.00px" class="cls_010"><span class="cls_010">325</span></div>
<div style="position:absolute;left:64.20px;top:290.89px" class="cls_009"><span class="cls_009">framework files  </span><span class="cls_010">62</span></div>
<div style="position:absolute;left:277.80px;top:293.46px" class="cls_009"><span class="cls_009">Hibernate</span></div>
<div style="position:absolute;left:64.20px;top:302.35px" class="cls_009"><span class="cls_009">standard Java web application files  </span><span class="cls_010">62</span></div>
<div style="position:absolute;left:285.30px;top:304.92px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:316.38px" class="cls_009"><span class="cls_009">HTTP protocol  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:56.69px;top:318.55px" class="cls_041"><span class="cls_041">F</span></div>
<div style="position:absolute;left:56.69px;top:339.30px" class="cls_009"><span class="cls_009">faceted search</span></div>
<div style="position:absolute;left:277.80px;top:332.58px" class="cls_041"><span class="cls_041">I</span></div>
<div style="position:absolute;left:64.20px;top:350.76px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">397</span></div>
<div style="position:absolute;left:277.80px;top:353.33px" class="cls_009"><span class="cls_009">ImageMagick</span></div>
<div style="position:absolute;left:64.20px;top:362.22px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">397</span></div>
<div style="position:absolute;left:285.30px;top:364.79px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:56.69px;top:373.68px" class="cls_009"><span class="cls_009">fast facts</span></div>
<div style="position:absolute;left:97.71px;top:373.68px" class="cls_010"><span class="cls_010">285</span></div>
<div style="position:absolute;left:277.80px;top:376.25px" class="cls_009"><span class="cls_009">imaging  </span><span class="cls_010">9</span></div>
<div style="position:absolute;left:56.69px;top:385.14px" class="cls_009"><span class="cls_009">file upload</span></div>
<div style="position:absolute;left:277.80px;top:387.71px" class="cls_009"><span class="cls_009">IMAP  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:64.20px;top:396.60px" class="cls_009"><span class="cls_009">using, in multipart request</span></div>
<div style="position:absolute;left:172.24px;top:396.60px" class="cls_010"><span class="cls_010">313</span></div>
<div style="position:absolute;left:277.80px;top:399.17px" class="cls_009"><span class="cls_009">indicators</span></div>
<div style="position:absolute;left:56.69px;top:408.06px" class="cls_009"><span class="cls_009">files</span></div>
<div style="position:absolute;left:285.30px;top:410.63px" class="cls_009"><span class="cls_009">creating, for status indicators</span></div>
<div style="position:absolute;left:405.35px;top:410.63px" class="cls_010"><span class="cls_010">193</span></div>
<div style="position:absolute;left:64.20px;top:419.52px" class="cls_009"><span class="cls_009">metadata, extracting from  </span><span class="cls_010">159</span></div>
<div style="position:absolute;left:285.30px;top:422.09px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">193</span></div>
<div style="position:absolute;left:56.69px;top:430.98px" class="cls_009"><span class="cls_009">filing rule</span></div>
<div style="position:absolute;left:97.71px;top:430.98px" class="cls_010"><span class="cls_010">401</span></div>
<div style="position:absolute;left:277.80px;top:433.55px" class="cls_009"><span class="cls_009">initial Whitepaper submission workfow</span></div>
<div style="position:absolute;left:56.69px;top:442.44px" class="cls_009"><span class="cls_009">filters</span></div>
<div style="position:absolute;left:285.30px;top:445.01px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:445.01px" class="cls_010"><span class="cls_010">350</span><span class="cls_009">, </span><span class="cls_010">352</span><span class="cls_009">, </span><span class="cls_010">353</span><span class="cls_009">, </span><span class="cls_010">356</span><span class="cls_009">, </span><span class="cls_010">358</span><span class="cls_009">, </span><span class="cls_010">359</span></div>
<div style="position:absolute;left:64.20px;top:453.90px" class="cls_009"><span class="cls_009">adding, to dashlets  </span><span class="cls_010">208</span><span class="cls_009">, </span><span class="cls_010">211</span></div>
<div style="position:absolute;left:277.80px;top:456.47px" class="cls_009"><span class="cls_009">integrated development environment (IDE)  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:56.69px;top:465.36px" class="cls_009"><span class="cls_009">form data</span></div>
<div style="position:absolute;left:64.20px;top:476.82px" class="cls_009"><span class="cls_009">handling  </span><span class="cls_010">311</span></div>
<div style="position:absolute;left:277.80px;top:472.67px" class="cls_041"><span class="cls_041">J</span></div>
<div style="position:absolute;left:56.69px;top:488.28px" class="cls_009"><span class="cls_009">form-based Hello World</span></div>
<div style="position:absolute;left:277.80px;top:493.42px" class="cls_009"><span class="cls_009">Java services</span></div>
<div style="position:absolute;left:64.20px;top:499.74px" class="cls_009"><span class="cls_009">implementing  </span><span class="cls_010">312</span></div>
<div style="position:absolute;left:285.30px;top:504.88px" class="cls_009"><span class="cls_009">groups, creating through  </span><span class="cls_010">478</span></div>
<div style="position:absolute;left:56.69px;top:511.21px" class="cls_009"><span class="cls_009">Foundation API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:285.30px;top:516.34px" class="cls_009"><span class="cls_009">users, creating through  </span><span class="cls_010">478</span></div>
<div style="position:absolute;left:56.69px;top:522.66px" class="cls_009"><span class="cls_009">framework files</span></div>
<div style="position:absolute;left:277.80px;top:527.80px" class="cls_009"><span class="cls_009">Java-backed web scripts</span></div>
<div style="position:absolute;left:64.20px;top:534.13px" class="cls_009"><span class="cls_009">Alfresco configuration files</span></div>
<div style="position:absolute;left:174.24px;top:534.13px" class="cls_010"><span class="cls_010">63</span></div>
<div style="position:absolute;left:285.30px;top:539.26px" class="cls_009"><span class="cls_009">content, making rateable  </span><span class="cls_010">311</span></div>
<div style="position:absolute;left:64.20px;top:545.59px" class="cls_009"><span class="cls_009">solution-specific files</span></div>
<div style="position:absolute;left:151.72px;top:545.59px" class="cls_010"><span class="cls_010">64</span></div>
<div style="position:absolute;left:285.30px;top:550.72px" class="cls_009"><span class="cls_009">web scripts calls, adding to SomeCo's whitepaper</span></div>
<div style="position:absolute;left:64.20px;top:557.05px" class="cls_009"><span class="cls_009">Spring configuration files</span></div>
<div style="position:absolute;left:167.74px;top:557.05px" class="cls_010"><span class="cls_010">62</span></div>
<div style="position:absolute;left:291.30px;top:562.18px" class="cls_009"><span class="cls_009">web page  </span><span class="cls_010">309</span></div>
<div style="position:absolute;left:56.69px;top:568.51px" class="cls_009"><span class="cls_009">FreeMarker API  </span><span class="cls_010">31</span></div>
<div style="position:absolute;left:285.30px;top:573.64px" class="cls_009"><span class="cls_009">writing</span></div>
<div style="position:absolute;left:316.31px;top:573.64px" class="cls_010"><span class="cls_010">295</span></div>
<div style="position:absolute;left:56.69px;top:579.97px" class="cls_009"><span class="cls_009">FreeMarker</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 500 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:348140px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background516.jpg" width="541" height="666"></div>
<div style="position:absolute;left:64.20px;top:70.57px" class="cls_009"><span class="cls_009">writing, to handle ratings posts</span></div>
<div style="position:absolute;left:190.76px;top:70.57px" class="cls_010"><span class="cls_010">295</span><span class="cls_009">, </span><span class="cls_010">297</span><span class="cls_009">, </span><span class="cls_010">301</span></div>
<div style="position:absolute;left:285.30px;top:70.57px" class="cls_009"><span class="cls_009">customizing  </span><span class="cls_010">159</span></div>
<div style="position:absolute;left:56.69px;top:82.03px" class="cls_009"><span class="cls_009">Java</span></div>
<div style="position:absolute;left:285.30px;top:82.03px" class="cls_009"><span class="cls_009">HTML  </span><span class="cls_010">165</span></div>
<div style="position:absolute;left:64.20px;top:93.49px" class="cls_009"><span class="cls_009">simple behavior, writing in  </span><span class="cls_010">140</span></div>
<div style="position:absolute;left:285.30px;top:93.49px" class="cls_009"><span class="cls_009">mail  </span><span class="cls_010">165</span></div>
<div style="position:absolute;left:64.20px;top:104.95px" class="cls_009"><span class="cls_009">using, for controller logic</span></div>
<div style="position:absolute;left:166.74px;top:104.95px" class="cls_010"><span class="cls_010">304</span></div>
<div style="position:absolute;left:285.30px;top:104.95px" class="cls_009"><span class="cls_009">Microsoft Office  </span><span class="cls_010">165</span></div>
<div style="position:absolute;left:56.69px;top:116.42px" class="cls_009"><span class="cls_009">JavaScript API</span></div>
<div style="position:absolute;left:285.30px;top:116.42px" class="cls_009"><span class="cls_009">MP3  </span><span class="cls_010">165</span></div>
<div style="position:absolute;left:64.20px;top:127.88px" class="cls_009"><span class="cls_009">used, for developing custom UI  </span><span class="cls_010">240</span><span class="cls_009">, </span><span class="cls_010">244</span><span class="cls_009">, </span><span class="cls_010">246</span></div>
<div style="position:absolute;left:285.30px;top:127.88px" class="cls_009"><span class="cls_009">OpenOffice.org  </span><span class="cls_010">165</span></div>
<div style="position:absolute;left:56.69px;top:139.34px" class="cls_009"><span class="cls_009">JavaScript application</span></div>
<div style="position:absolute;left:285.30px;top:139.34px" class="cls_009"><span class="cls_009">XML  </span><span class="cls_010">165</span></div>
<div style="position:absolute;left:64.20px;top:150.80px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:101.22px;top:150.80px" class="cls_010"><span class="cls_010">238</span></div>
<div style="position:absolute;left:277.80px;top:150.80px" class="cls_009"><span class="cls_009">metadata mapping</span></div>
<div style="position:absolute;left:56.69px;top:162.26px" class="cls_009"><span class="cls_009">JavaScript</span></div>
<div style="position:absolute;left:285.30px;top:162.26px" class="cls_009"><span class="cls_009">customizing  </span><span class="cls_010">159</span></div>
<div style="position:absolute;left:64.20px;top:173.72px" class="cls_009"><span class="cls_009">content, creating with</span></div>
<div style="position:absolute;left:154.24px;top:173.72px" class="cls_010"><span class="cls_010">109</span></div>
<div style="position:absolute;left:277.80px;top:173.72px" class="cls_009"><span class="cls_009">metadata template</span></div>
<div style="position:absolute;left:64.20px;top:185.18px" class="cls_009"><span class="cls_009">simple behavior, writing in  </span><span class="cls_010">146</span></div>
<div style="position:absolute;left:285.30px;top:185.18px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:185.18px" class="cls_010"><span class="cls_010">195</span></div>
<div style="position:absolute;left:64.20px;top:196.64px" class="cls_009"><span class="cls_009">using, for batch manipulation  </span><span class="cls_010">110</span></div>
<div style="position:absolute;left:285.30px;top:196.64px" class="cls_009"><span class="cls_009">creating, for Operations document  </span><span class="cls_010">196</span></div>
<div style="position:absolute;left:64.20px;top:208.10px" class="cls_009"><span class="cls_009">using, for controller logic</span></div>
<div style="position:absolute;left:166.74px;top:208.10px" class="cls_010"><span class="cls_010">304</span></div>
<div style="position:absolute;left:277.80px;top:208.10px" class="cls_009"><span class="cls_009">metadata</span></div>
<div style="position:absolute;left:285.30px;top:219.56px" class="cls_009"><span class="cls_009">extracting, from files</span></div>
<div style="position:absolute;left:370.83px;top:219.56px" class="cls_010"><span class="cls_010">159</span></div>
<div style="position:absolute;left:56.69px;top:224.30px" class="cls_041"><span class="cls_041">K</span></div>
<div style="position:absolute;left:277.80px;top:231.02px" class="cls_009"><span class="cls_009">methods</span></div>
<div style="position:absolute;left:285.30px;top:242.48px" class="cls_009"><span class="cls_009">permissions, mapping to  </span><span class="cls_010">494</span></div>
<div style="position:absolute;left:56.69px;top:245.05px" class="cls_009"><span class="cls_009">knowledge management (KM)  </span><span class="cls_010">9</span></div>
<div style="position:absolute;left:277.80px;top:253.94px" class="cls_009"><span class="cls_009">model manager  </span><span class="cls_010">118</span></div>
<div style="position:absolute;left:56.69px;top:256.51px" class="cls_009"><span class="cls_009">Kofax  </span><span class="cls_010">20</span></div>
<div style="position:absolute;left:277.80px;top:265.40px" class="cls_009"><span class="cls_009">Model-View-Control (MVC)  </span><span class="cls_010">29</span></div>
<div style="position:absolute;left:277.80px;top:276.86px" class="cls_009"><span class="cls_009">Model-View-Controller (MVC)  </span><span class="cls_010">266</span></div>
<div style="position:absolute;left:56.69px;top:272.71px" class="cls_041"><span class="cls_041">L</span></div>
<div style="position:absolute;left:277.80px;top:288.32px" class="cls_009"><span class="cls_009">modeling</span></div>
<div style="position:absolute;left:56.69px;top:293.46px" class="cls_009"><span class="cls_009">LDAP</span></div>
<div style="position:absolute;left:285.30px;top:299.78px" class="cls_009"><span class="cls_009">best practices  </span><span class="cls_010">92</span></div>
<div style="position:absolute;left:64.20px;top:304.92px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:285.30px;top:311.24px" class="cls_009"><span class="cls_009">overview  </span><span class="cls_010">90</span></div>
<div style="position:absolute;left:64.20px;top:316.38px" class="cls_009"><span class="cls_009">using, for authentication</span></div>
<div style="position:absolute;left:164.76px;top:316.38px" class="cls_010"><span class="cls_010">435</span></div>
<div style="position:absolute;left:277.80px;top:322.70px" class="cls_009"><span class="cls_009">Module Management Tool (MMT)  </span><span class="cls_010">58</span></div>
<div style="position:absolute;left:64.20px;top:327.84px" class="cls_009"><span class="cls_009">using, for synchronization  </span><span class="cls_010">436</span></div>
<div style="position:absolute;left:277.80px;top:334.16px" class="cls_009"><span class="cls_009">Mozilla Rhino JavaScript Engine</span></div>
<div style="position:absolute;left:56.69px;top:339.30px" class="cls_009"><span class="cls_009">LibreOffice</span></div>
<div style="position:absolute;left:285.30px;top:345.62px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:64.20px;top:350.76px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:357.08px" class="cls_009"><span class="cls_009">multi-instances</span></div>
<div style="position:absolute;left:56.69px;top:362.22px" class="cls_009"><span class="cls_009">listeners</span></div>
<div style="position:absolute;left:285.30px;top:368.54px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">370</span></div>
<div style="position:absolute;left:64.20px;top:373.68px" class="cls_009"><span class="cls_009">used, for adding logic to workflows  </span><span class="cls_010">365</span></div>
<div style="position:absolute;left:277.80px;top:380.00px" class="cls_009"><span class="cls_009">multipart request</span></div>
<div style="position:absolute;left:56.69px;top:385.14px" class="cls_009"><span class="cls_009">local OpenLDAP server</span></div>
<div style="position:absolute;left:285.30px;top:391.46px" class="cls_009"><span class="cls_009">file upload, using in</span></div>
<div style="position:absolute;left:367.35px;top:391.46px" class="cls_010"><span class="cls_010">313</span></div>
<div style="position:absolute;left:64.20px;top:396.60px" class="cls_009"><span class="cls_009">setting up  </span><span class="cls_010">436</span><span class="cls_009">, </span><span class="cls_010">437</span><span class="cls_009">, </span><span class="cls_010">439</span><span class="cls_009">, </span><span class="cls_010">442</span></div>
<div style="position:absolute;left:277.80px;top:402.92px" class="cls_009"><span class="cls_009">MVC (Model-View-Controller)  </span><span class="cls_010">247</span></div>
<div style="position:absolute;left:56.69px;top:408.06px" class="cls_009"><span class="cls_009">Log4j  </span><span class="cls_010">66</span></div>
<div style="position:absolute;left:56.69px;top:419.52px" class="cls_009"><span class="cls_009">logic</span></div>
<div style="position:absolute;left:277.80px;top:419.13px" class="cls_041"><span class="cls_041">N</span></div>
<div style="position:absolute;left:64.20px;top:430.98px" class="cls_009"><span class="cls_009">adding, to Whitepaper submission workflow  </span><span class="cls_010">367</span></div>
<div style="position:absolute;left:277.80px;top:439.87px" class="cls_009"><span class="cls_009">new rating behavior</span></div>
<div style="position:absolute;left:64.20px;top:442.44px" class="cls_009"><span class="cls_009">adding, to workflow  </span><span class="cls_010">365</span></div>
<div style="position:absolute;left:64.20px;top:453.90px" class="cls_009"><span class="cls_009">binding, to multiple types/aspects  </span><span class="cls_010">144</span></div>
<div style="position:absolute;left:285.30px;top:451.33px" class="cls_009"><span class="cls_009">testing</span></div>
<div style="position:absolute;left:316.82px;top:451.33px" class="cls_010"><span class="cls_010">154</span><span class="cls_009">, </span><span class="cls_010">156</span></div>
<div style="position:absolute;left:277.80px;top:462.80px" class="cls_009"><span class="cls_009">node types</span></div>
<div style="position:absolute;left:285.30px;top:474.26px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:56.69px;top:470.10px" class="cls_041"><span class="cls_041">M</span></div>
<div style="position:absolute;left:285.30px;top:485.72px" class="cls_009"><span class="cls_009">Call Activity</span></div>
<div style="position:absolute;left:336.81px;top:485.72px" class="cls_010"><span class="cls_010">336</span></div>
<div style="position:absolute;left:56.69px;top:490.85px" class="cls_009"><span class="cls_009">Maven archetypes</span></div>
<div style="position:absolute;left:285.30px;top:497.18px" class="cls_009"><span class="cls_009">End Event  </span><span class="cls_010">336</span></div>
<div style="position:absolute;left:64.20px;top:502.31px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:285.30px;top:508.64px" class="cls_009"><span class="cls_009">Exclusive Gateway  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:64.20px;top:513.77px" class="cls_009"><span class="cls_009">Alfresco all-in-one (AIO)</span></div>
<div style="position:absolute;left:165.22px;top:513.77px" class="cls_010"><span class="cls_010">35</span></div>
<div style="position:absolute;left:285.30px;top:520.10px" class="cls_009"><span class="cls_009">Java Service Task  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:64.20px;top:525.23px" class="cls_009"><span class="cls_009">Alfresco Repository AMP  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:285.30px;top:531.56px" class="cls_009"><span class="cls_009">Parallel Gateway  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:64.20px;top:536.69px" class="cls_009"><span class="cls_009">Alfresco Share AMP  </span><span class="cls_010">35</span></div>
<div style="position:absolute;left:285.30px;top:543.02px" class="cls_009"><span class="cls_009">Script Task  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:56.69px;top:548.15px" class="cls_009"><span class="cls_009">Maven Central repository</span></div>
<div style="position:absolute;left:285.30px;top:554.48px" class="cls_009"><span class="cls_009">Start Event  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:64.20px;top:559.61px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">41</span></div>
<div style="position:absolute;left:285.30px;top:565.94px" class="cls_009"><span class="cls_009">Sub Process  </span><span class="cls_010">336</span></div>
<div style="position:absolute;left:56.69px;top:571.08px" class="cls_009"><span class="cls_009">metadata extractors</span></div>
<div style="position:absolute;left:285.30px;top:577.40px" class="cls_009"><span class="cls_009">User task  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:64.20px;top:582.53px" class="cls_009"><span class="cls_009">Adobe PDF  </span><span class="cls_010">165</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 501 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:348816px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background517.jpg" width="541" height="666"></div>
<div style="position:absolute;left:285.30px;top:70.57px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:70.57px" class="cls_010"><span class="cls_010">324</span></div>
<div style="position:absolute;left:56.69px;top:70.45px" class="cls_041"><span class="cls_041">O</span></div>
<div style="position:absolute;left:285.30px;top:82.03px" class="cls_009"><span class="cls_009">Hello World process definition  </span><span class="cls_010">325</span></div>
<div style="position:absolute;left:56.69px;top:91.20px" class="cls_009"><span class="cls_009">Office Services  </span><span class="cls_010">20</span></div>
<div style="position:absolute;left:285.30px;top:93.49px" class="cls_009"><span class="cls_009">versioning  </span><span class="cls_010">336</span></div>
<div style="position:absolute;left:56.69px;top:102.66px" class="cls_009"><span class="cls_009">open source components, Alfresco</span></div>
<div style="position:absolute;left:277.80px;top:104.95px" class="cls_009"><span class="cls_009">process variables</span></div>
<div style="position:absolute;left:64.20px;top:114.12px" class="cls_009"><span class="cls_009">Activiti</span></div>
<div style="position:absolute;left:95.20px;top:114.12px" class="cls_010"><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:116.42px" class="cls_009"><span class="cls_009">data, storing in</span></div>
<div style="position:absolute;left:349.34px;top:116.42px" class="cls_010"><span class="cls_010">365</span></div>
<div style="position:absolute;left:64.20px;top:125.58px" class="cls_009"><span class="cls_009">Apache Axis  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:127.88px" class="cls_009"><span class="cls_009">used, for adding logic to workflows  </span><span class="cls_010">365</span></div>
<div style="position:absolute;left:64.20px;top:137.04px" class="cls_009"><span class="cls_009">Apache FOP  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:139.34px" class="cls_009"><span class="cls_009">processes, wiring to Alfresco UI</span></div>
<div style="position:absolute;left:64.20px;top:148.50px" class="cls_009"><span class="cls_009">Apache POI  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:150.80px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">337</span></div>
<div style="position:absolute;left:64.20px;top:159.96px" class="cls_009"><span class="cls_009">Apache Solr  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:162.26px" class="cls_009"><span class="cls_009">Hello World argument, grabbing from user  </span><span class="cls_010">338</span><span class="cls_009">,</span></div>
<div style="position:absolute;left:64.20px;top:171.43px" class="cls_009"><span class="cls_009">FreeMarker  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:291.30px;top:173.72px" class="cls_010"><span class="cls_010">340</span><span class="cls_009">, </span><span class="cls_010">342</span><span class="cls_009">, </span><span class="cls_010">344</span><span class="cls_009">, </span><span class="cls_010">345</span><span class="cls_009">, </span><span class="cls_010">346</span></div>
<div style="position:absolute;left:64.20px;top:182.88px" class="cls_009"><span class="cls_009">GhostScript  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:185.18px" class="cls_009"><span class="cls_009">processes</span></div>
<div style="position:absolute;left:64.20px;top:194.35px" class="cls_009"><span class="cls_009">Hibernate  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:196.64px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">337</span></div>
<div style="position:absolute;left:64.20px;top:205.81px" class="cls_009"><span class="cls_009">ImageMagick  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:208.10px" class="cls_009"><span class="cls_009">creating, activiti process designer used</span></div>
<div style="position:absolute;left:445.37px;top:208.10px" class="cls_010"><span class="cls_010">330</span><span class="cls_009">,</span></div>
<div style="position:absolute;left:64.20px;top:217.27px" class="cls_009"><span class="cls_009">LibreOffice</span></div>
<div style="position:absolute;left:112.72px;top:217.27px" class="cls_010"><span class="cls_010">21</span></div>
<div style="position:absolute;left:291.30px;top:219.56px" class="cls_010"><span class="cls_010">331</span><span class="cls_009">, </span><span class="cls_010">333</span><span class="cls_009">, </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:64.20px;top:228.73px" class="cls_009"><span class="cls_009">Mozilla Rhino JavaScript Engine  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:231.02px" class="cls_009"><span class="cls_009">property indexing</span></div>
<div style="position:absolute;left:64.20px;top:240.19px" class="cls_009"><span class="cls_009">OpenSymphony Quartz  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:285.30px;top:242.48px" class="cls_009"><span class="cls_009">managing  </span><span class="cls_010">89</span></div>
<div style="position:absolute;left:64.20px;top:251.65px" class="cls_009"><span class="cls_009">Spring ACEGI  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:253.94px" class="cls_009"><span class="cls_009">publisher custom role</span></div>
<div style="position:absolute;left:56.69px;top:263.11px" class="cls_009"><span class="cls_009">OpenSearch</span></div>
<div style="position:absolute;left:285.30px;top:265.40px" class="cls_009"><span class="cls_009">setting up  </span><span class="cls_010">487</span><span class="cls_009">, </span><span class="cls_010">488</span><span class="cls_009">, </span><span class="cls_010">490</span><span class="cls_009">, </span><span class="cls_010">493</span></div>
<div style="position:absolute;left:64.20px;top:274.57px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:56.69px;top:286.03px" class="cls_009"><span class="cls_009">OpenSymphony Quartz</span></div>
<div style="position:absolute;left:277.80px;top:281.60px" class="cls_041"><span class="cls_041">R</span></div>
<div style="position:absolute;left:64.20px;top:297.49px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:302.35px" class="cls_009"><span class="cls_009">RAD project</span></div>
<div style="position:absolute;left:56.69px;top:308.95px" class="cls_009"><span class="cls_009">Operations document</span></div>
<div style="position:absolute;left:285.30px;top:313.81px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:322.32px;top:313.81px" class="cls_010"><span class="cls_010">42</span><span class="cls_009">, </span><span class="cls_010">44</span></div>
<div style="position:absolute;left:64.20px;top:320.41px" class="cls_009"><span class="cls_009">metadata template, creating for  </span><span class="cls_010">196</span></div>
<div style="position:absolute;left:277.80px;top:325.27px" class="cls_009"><span class="cls_009">rapid application development (RAD)  </span><span class="cls_010">36</span><span class="cls_009">, </span><span class="cls_010">41</span></div>
<div style="position:absolute;left:56.69px;top:331.87px" class="cls_009"><span class="cls_009">options, workflow</span></div>
<div style="position:absolute;left:277.80px;top:336.73px" class="cls_009"><span class="cls_009">rating web script HTML response page</span></div>
<div style="position:absolute;left:64.20px;top:343.33px" class="cls_009"><span class="cls_009">embedded workflow engines  </span><span class="cls_010">324</span></div>
<div style="position:absolute;left:285.30px;top:348.19px" class="cls_009"><span class="cls_009">delete ratings link, implementing  </span><span class="cls_010">308</span></div>
<div style="position:absolute;left:64.20px;top:354.79px" class="cls_009"><span class="cls_009">roll your own  </span><span class="cls_010">323</span></div>
<div style="position:absolute;left:277.80px;top:359.65px" class="cls_009"><span class="cls_009">records management (RM)  </span><span class="cls_010">9</span></div>
<div style="position:absolute;left:64.20px;top:366.25px" class="cls_009"><span class="cls_009">standalone engines  </span><span class="cls_010">323</span></div>
<div style="position:absolute;left:277.80px;top:371.11px" class="cls_009"><span class="cls_009">repository</span></div>
<div style="position:absolute;left:56.69px;top:377.71px" class="cls_009"><span class="cls_009">out-of-the-box association  </span><span class="cls_010">84</span></div>
<div style="position:absolute;left:285.30px;top:382.57px" class="cls_009"><span class="cls_009">versus classpath  </span><span class="cls_010">288</span></div>
<div style="position:absolute;left:277.80px;top:394.03px" class="cls_009"><span class="cls_009">Request for proposal (RFP)  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:56.69px;top:393.91px" class="cls_041"><span class="cls_041">P</span></div>
<div style="position:absolute;left:277.80px;top:405.49px" class="cls_009"><span class="cls_009">required value</span></div>
<div style="position:absolute;left:56.69px;top:414.66px" class="cls_009"><span class="cls_009">page</span></div>
<div style="position:absolute;left:285.30px;top:416.95px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">285</span></div>
<div style="position:absolute;left:64.20px;top:426.12px" class="cls_009"><span class="cls_009">creating, to list Webable documents  </span><span class="cls_010">218</span></div>
<div style="position:absolute;left:277.80px;top:428.41px" class="cls_009"><span class="cls_009">requires new value</span></div>
<div style="position:absolute;left:56.69px;top:437.58px" class="cls_009"><span class="cls_009">permission definitions  </span><span class="cls_010">484</span></div>
<div style="position:absolute;left:285.30px;top:439.87px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">285</span></div>
<div style="position:absolute;left:56.69px;top:449.04px" class="cls_009"><span class="cls_009">permission groups  </span><span class="cls_010">484</span></div>
<div style="position:absolute;left:277.80px;top:451.33px" class="cls_009"><span class="cls_009">rule actions</span></div>
<div style="position:absolute;left:328.82px;top:451.33px" class="cls_010"><span class="cls_010">27</span></div>
<div style="position:absolute;left:56.69px;top:460.50px" class="cls_009"><span class="cls_009">permission sets  </span><span class="cls_010">486</span></div>
<div style="position:absolute;left:56.69px;top:471.96px" class="cls_009"><span class="cls_009">permissions</span></div>
<div style="position:absolute;left:277.80px;top:467.53px" class="cls_041"><span class="cls_041">S</span></div>
<div style="position:absolute;left:64.20px;top:483.42px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">486</span></div>
<div style="position:absolute;left:277.80px;top:488.28px" class="cls_009"><span class="cls_009">search  </span><span class="cls_010">9</span></div>
<div style="position:absolute;left:64.20px;top:494.88px" class="cls_009"><span class="cls_009">mapping, to methods  </span><span class="cls_010">494</span></div>
<div style="position:absolute;left:277.80px;top:499.74px" class="cls_009"><span class="cls_009">search manager</span></div>
<div style="position:absolute;left:56.69px;top:506.34px" class="cls_009"><span class="cls_009">portals</span></div>
<div style="position:absolute;left:88.71px;top:506.34px" class="cls_010"><span class="cls_010">9</span></div>
<div style="position:absolute;left:285.30px;top:511.21px" class="cls_009"><span class="cls_009">configuring</span></div>
<div style="position:absolute;left:334.32px;top:511.21px" class="cls_010"><span class="cls_010">396</span><span class="cls_009">, </span><span class="cls_010">398</span><span class="cls_009">, </span><span class="cls_010">400</span></div>
<div style="position:absolute;left:56.69px;top:517.80px" class="cls_009"><span class="cls_009">prerequisites, for Alfresco customization</span></div>
<div style="position:absolute;left:285.30px;top:522.66px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">396</span><span class="cls_009">, </span><span class="cls_010">398</span></div>
<div style="position:absolute;left:64.20px;top:529.27px" class="cls_009"><span class="cls_009">JDK  </span><span class="cls_010">37</span></div>
<div style="position:absolute;left:277.80px;top:534.13px" class="cls_009"><span class="cls_009">security services</span></div>
<div style="position:absolute;left:64.20px;top:540.73px" class="cls_009"><span class="cls_009">Maven  </span><span class="cls_010">38</span></div>
<div style="position:absolute;left:285.30px;top:545.59px" class="cls_009"><span class="cls_009">working with  </span><span class="cls_010">472</span></div>
<div style="position:absolute;left:64.20px;top:552.19px" class="cls_009"><span class="cls_009">Spring Loaded  </span><span class="cls_010">36</span></div>
<div style="position:absolute;left:277.80px;top:557.05px" class="cls_009"><span class="cls_009">silent install</span></div>
<div style="position:absolute;left:56.69px;top:563.65px" class="cls_009"><span class="cls_009">process definitions</span></div>
<div style="position:absolute;left:285.30px;top:568.51px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">233</span></div>
<div style="position:absolute;left:64.20px;top:575.11px" class="cls_009"><span class="cls_009">alternative deployment methods, using  </span><span class="cls_010">336</span></div>
<div style="position:absolute;left:277.80px;top:579.97px" class="cls_009"><span class="cls_009">simple behavior</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 502 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:349492px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background518.jpg" width="541" height="666"></div>
<div style="position:absolute;left:64.20px;top:70.57px" class="cls_009"><span class="cls_009">writing, in Java</span></div>
<div style="position:absolute;left:128.72px;top:70.57px" class="cls_010"><span class="cls_010">140</span></div>
<div style="position:absolute;left:285.30px;top:70.57px" class="cls_009"><span class="cls_009">XSL FO  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:64.20px;top:82.03px" class="cls_009"><span class="cls_009">writing, in JavaScript</span></div>
<div style="position:absolute;left:151.72px;top:82.03px" class="cls_010"><span class="cls_010">146</span></div>
<div style="position:absolute;left:285.30px;top:82.03px" class="cls_009"><span class="cls_009">XSLT  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:56.69px;top:93.49px" class="cls_009"><span class="cls_009">simple workflows</span></div>
<div style="position:absolute;left:277.80px;top:93.49px" class="cls_009"><span class="cls_009">status indicators</span></div>
<div style="position:absolute;left:64.20px;top:104.95px" class="cls_009"><span class="cls_009">limitations</span></div>
<div style="position:absolute;left:109.21px;top:104.95px" class="cls_010"><span class="cls_010">27</span></div>
<div style="position:absolute;left:285.30px;top:104.95px" class="cls_009"><span class="cls_009">indicators, creating for</span></div>
<div style="position:absolute;left:378.84px;top:104.95px" class="cls_010"><span class="cls_010">193</span></div>
<div style="position:absolute;left:56.69px;top:116.42px" class="cls_009"><span class="cls_009">Single Sign-On (SSO)</span></div>
<div style="position:absolute;left:277.80px;top:116.42px" class="cls_009"><span class="cls_009">Surf  </span><span class="cls_010">20</span></div>
<div style="position:absolute;left:64.20px;top:127.88px" class="cls_009"><span class="cls_009">implementing  </span><span class="cls_010">448</span><span class="cls_009">, </span><span class="cls_010">450</span><span class="cls_009">, </span><span class="cls_010">453</span><span class="cls_009">, </span><span class="cls_010">455</span><span class="cls_009">, </span><span class="cls_010">461</span><span class="cls_009">, </span><span class="cls_010">464</span></div>
<div style="position:absolute;left:64.20px;top:139.34px" class="cls_009"><span class="cls_009">setting up  </span><span class="cls_010">447</span></div>
<div style="position:absolute;left:277.80px;top:132.61px" class="cls_041"><span class="cls_041">T</span></div>
<div style="position:absolute;left:56.69px;top:150.80px" class="cls_009"><span class="cls_009">Smart Folder template</span></div>
<div style="position:absolute;left:277.80px;top:153.36px" class="cls_009"><span class="cls_009">task listener</span></div>
<div style="position:absolute;left:330.81px;top:153.36px" class="cls_010"><span class="cls_010">365</span></div>
<div style="position:absolute;left:64.20px;top:162.26px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:101.22px;top:162.26px" class="cls_010"><span class="cls_010">409</span><span class="cls_009">, </span><span class="cls_010">411</span><span class="cls_009">, </span><span class="cls_010">414</span><span class="cls_009">, </span><span class="cls_010">415</span></div>
<div style="position:absolute;left:277.80px;top:164.82px" class="cls_009"><span class="cls_009">Task Management dialog</span></div>
<div style="position:absolute;left:56.69px;top:173.72px" class="cls_009"><span class="cls_009">Smart Folders</span></div>
<div style="position:absolute;left:285.30px;top:176.29px" class="cls_009"><span class="cls_009">actions, controlling from</span></div>
<div style="position:absolute;left:385.34px;top:176.29px" class="cls_010"><span class="cls_010">360</span></div>
<div style="position:absolute;left:64.20px;top:185.18px" class="cls_009"><span class="cls_009">configuring</span></div>
<div style="position:absolute;left:113.22px;top:185.18px" class="cls_010"><span class="cls_010">401</span><span class="cls_009">, </span><span class="cls_010">403</span><span class="cls_009">, </span><span class="cls_010">404</span><span class="cls_009">, </span><span class="cls_010">406</span></div>
<div style="position:absolute;left:277.80px;top:187.74px" class="cls_009"><span class="cls_009">tasks</span></div>
<div style="position:absolute;left:64.20px;top:196.64px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">401</span><span class="cls_009">, </span><span class="cls_010">403</span><span class="cls_009">, </span><span class="cls_010">404</span></div>
<div style="position:absolute;left:285.30px;top:199.21px" class="cls_009"><span class="cls_009">assigning, to groups  </span><span class="cls_010">348</span></div>
<div style="position:absolute;left:56.69px;top:208.10px" class="cls_009"><span class="cls_009">SMTP  </span><span class="cls_010">11</span><span class="cls_009">, </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:285.30px;top:210.67px" class="cls_009"><span class="cls_009">assigning, to users  </span><span class="cls_010">348</span></div>
<div style="position:absolute;left:56.69px;top:219.56px" class="cls_009"><span class="cls_009">solutions</span></div>
<div style="position:absolute;left:277.80px;top:222.13px" class="cls_009"><span class="cls_009">third-party review</span></div>
<div style="position:absolute;left:64.20px;top:231.02px" class="cls_009"><span class="cls_009">building, with Web Script Framework  </span><span class="cls_010">271</span></div>
<div style="position:absolute;left:285.30px;top:233.59px" class="cls_009"><span class="cls_009">timer, adding to  </span><span class="cls_010">389</span></div>
<div style="position:absolute;left:56.69px;top:242.48px" class="cls_009"><span class="cls_009">SomeCo mobile application</span></div>
<div style="position:absolute;left:277.80px;top:245.05px" class="cls_009"><span class="cls_009">timer events  </span><span class="cls_010">389</span></div>
<div style="position:absolute;left:64.20px;top:253.94px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:101.22px;top:253.94px" class="cls_010"><span class="cls_010">427</span><span class="cls_009">, </span><span class="cls_010">429</span><span class="cls_009">, </span><span class="cls_010">431</span><span class="cls_009">, </span><span class="cls_010">433</span></div>
<div style="position:absolute;left:277.80px;top:256.51px" class="cls_009"><span class="cls_009">timers</span></div>
<div style="position:absolute;left:56.69px;top:265.40px" class="cls_009"><span class="cls_009">SomeCo whitepapers</span></div>
<div style="position:absolute;left:285.30px;top:267.97px" class="cls_009"><span class="cls_009">adding, to third-party review</span></div>
<div style="position:absolute;left:401.35px;top:267.97px" class="cls_010"><span class="cls_010">389</span></div>
<div style="position:absolute;left:64.20px;top:276.86px" class="cls_009"><span class="cls_009">planning  </span><span class="cls_010">272</span></div>
<div style="position:absolute;left:285.30px;top:279.43px" class="cls_009"><span class="cls_009">using  </span><span class="cls_010">389</span></div>
<div style="position:absolute;left:56.69px;top:288.32px" class="cls_009"><span class="cls_009">SomeCo</span></div>
<div style="position:absolute;left:277.80px;top:290.89px" class="cls_009"><span class="cls_009">token  </span><span class="cls_010">335</span></div>
<div style="position:absolute;left:64.20px;top:299.78px" class="cls_009"><span class="cls_009">content model, defining  </span><span class="cls_010">74</span></div>
<div style="position:absolute;left:277.80px;top:302.35px" class="cls_009"><span class="cls_009">troubleshooting tools</span></div>
<div style="position:absolute;left:56.69px;top:311.24px" class="cls_009"><span class="cls_009">SPP  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:285.30px;top:313.81px" class="cls_009"><span class="cls_009">Log4j  </span><span class="cls_010">65</span></div>
<div style="position:absolute;left:56.69px;top:322.70px" class="cls_009"><span class="cls_009">Spring ACEGI</span></div>
<div style="position:absolute;left:64.20px;top:334.16px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">21</span></div>
<div style="position:absolute;left:277.80px;top:330.01px" class="cls_041"><span class="cls_041">U</span></div>
<div style="position:absolute;left:56.69px;top:345.62px" class="cls_009"><span class="cls_009">Spring configuration files</span></div>
<div style="position:absolute;left:160.24px;top:345.62px" class="cls_010"><span class="cls_010">62</span></div>
<div style="position:absolute;left:277.80px;top:350.76px" class="cls_009"><span class="cls_009">UI</span></div>
<div style="position:absolute;left:56.69px;top:357.08px" class="cls_009"><span class="cls_009">Spring Loaded</span></div>
<div style="position:absolute;left:285.30px;top:362.22px" class="cls_009"><span class="cls_009">configuring</span></div>
<div style="position:absolute;left:334.32px;top:362.22px" class="cls_010"><span class="cls_010">95</span></div>
<div style="position:absolute;left:64.20px;top:368.54px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">36</span></div>
<div style="position:absolute;left:285.30px;top:373.68px" class="cls_009"><span class="cls_009">display labels, externalizing</span></div>
<div style="position:absolute;left:399.84px;top:373.68px" class="cls_010"><span class="cls_010">104</span></div>
<div style="position:absolute;left:64.20px;top:380.00px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">36</span></div>
<div style="position:absolute;left:285.30px;top:385.14px" class="cls_009"><span class="cls_009">properties, adding to advanced search  </span><span class="cls_010">105</span></div>
<div style="position:absolute;left:56.69px;top:391.46px" class="cls_009"><span class="cls_009">Spring Tool Suite (STS)</span></div>
<div style="position:absolute;left:285.30px;top:396.60px" class="cls_009"><span class="cls_009">Share forms, configuring  </span><span class="cls_010">95</span></div>
<div style="position:absolute;left:64.20px;top:402.92px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">35</span><span class="cls_009">, </span><span class="cls_010">39</span></div>
<div style="position:absolute;left:285.30px;top:408.06px" class="cls_009"><span class="cls_009">types, adding to advanced search  </span><span class="cls_010">106</span></div>
<div style="position:absolute;left:64.20px;top:414.39px" class="cls_009"><span class="cls_009">download link  </span><span class="cls_010">39</span></div>
<div style="position:absolute;left:285.30px;top:419.52px" class="cls_009"><span class="cls_009">types, adding to Alfresco Share dropdowns  </span><span class="cls_010">98</span></div>
<div style="position:absolute;left:64.20px;top:425.85px" class="cls_009"><span class="cls_009">installing</span></div>
<div style="position:absolute;left:104.21px;top:425.85px" class="cls_010"><span class="cls_010">39</span></div>
<div style="position:absolute;left:277.80px;top:430.98px" class="cls_009"><span class="cls_009">user ratings calculator</span></div>
<div style="position:absolute;left:56.69px;top:437.31px" class="cls_009"><span class="cls_009">standalone engines  </span><span class="cls_010">323</span></div>
<div style="position:absolute;left:285.30px;top:442.44px" class="cls_009"><span class="cls_009">writing</span></div>
<div style="position:absolute;left:316.31px;top:442.44px" class="cls_010"><span class="cls_010">148</span><span class="cls_009">, </span><span class="cls_010">149</span></div>
<div style="position:absolute;left:56.69px;top:448.77px" class="cls_009"><span class="cls_009">standards/protocols, Alfresco</span></div>
<div style="position:absolute;left:277.80px;top:453.90px" class="cls_009"><span class="cls_009">users admin rights</span></div>
<div style="position:absolute;left:64.20px;top:460.23px" class="cls_009"><span class="cls_009">Alfresco Office Services  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:285.30px;top:465.36px" class="cls_009"><span class="cls_009">granting  </span><span class="cls_010">472</span><span class="cls_009">, </span><span class="cls_010">473</span></div>
<div style="position:absolute;left:64.20px;top:471.69px" class="cls_009"><span class="cls_009">CIFS  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:277.80px;top:476.82px" class="cls_009"><span class="cls_009">users</span></div>
<div style="position:absolute;left:64.20px;top:483.15px" class="cls_009"><span class="cls_009">CMIS  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:285.30px;top:488.28px" class="cls_009"><span class="cls_009">creating, programmatically  </span><span class="cls_010">474</span></div>
<div style="position:absolute;left:64.20px;top:494.61px" class="cls_009"><span class="cls_009">FTP  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:285.30px;top:499.74px" class="cls_009"><span class="cls_009">creating, through Java services  </span><span class="cls_010">478</span></div>
<div style="position:absolute;left:64.20px;top:506.07px" class="cls_009"><span class="cls_009">HTTP  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:285.30px;top:511.21px" class="cls_009"><span class="cls_009">tasks, assigning to  </span><span class="cls_010">348</span></div>
<div style="position:absolute;left:64.20px;top:517.53px" class="cls_009"><span class="cls_009">IMAP  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:64.20px;top:528.99px" class="cls_009"><span class="cls_009">OpenSearch  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:277.80px;top:527.40px" class="cls_041"><span class="cls_041">V</span></div>
<div style="position:absolute;left:64.20px;top:540.45px" class="cls_009"><span class="cls_009">SMTP  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:277.80px;top:548.15px" class="cls_009"><span class="cls_009">Vagrant</span></div>
<div style="position:absolute;left:64.20px;top:551.91px" class="cls_009"><span class="cls_009">SOAP  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:285.30px;top:559.61px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">51</span></div>
<div style="position:absolute;left:64.20px;top:563.37px" class="cls_009"><span class="cls_009">SPP  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:285.30px;top:571.08px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">51</span></div>
<div style="position:absolute;left:64.20px;top:574.83px" class="cls_009"><span class="cls_009">WebDAV  </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:277.80px;top:582.53px" class="cls_009"><span class="cls_009">virtual machine</span></div>
<div style="position:absolute;left:254.71px;top:605.74px" class="cls_018"><span class="cls_018">[ 503 ]</span></div>
</div>
<div style="position:absolute;left:50%;margin-left:-270px;top:350168px;width:541px;height:666px;border-style:outset;overflow:hidden">
<div style="position:absolute;left:0px;top:0px">
<img src="./background519.jpg" width="541" height="666"></div>
<div style="position:absolute;left:64.20px;top:70.57px" class="cls_009"><span class="cls_009">creating</span></div>
<div style="position:absolute;left:101.22px;top:70.57px" class="cls_010"><span class="cls_010">51</span></div>
<div style="position:absolute;left:285.30px;top:70.57px" class="cls_009"><span class="cls_009">data, retrieving with</span></div>
<div style="position:absolute;left:368.33px;top:70.57px" class="cls_010"><span class="cls_010">274</span></div>
<div style="position:absolute;left:56.69px;top:82.03px" class="cls_009"><span class="cls_009">VirtualBox</span></div>
<div style="position:absolute;left:285.30px;top:82.03px" class="cls_009"><span class="cls_009">debugging  </span><span class="cls_010">284</span></div>
<div style="position:absolute;left:64.20px;top:93.49px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">51</span></div>
<div style="position:absolute;left:285.30px;top:93.49px" class="cls_009"><span class="cls_009">errors, handling</span></div>
<div style="position:absolute;left:352.83px;top:93.49px" class="cls_010"><span class="cls_010">292</span></div>
<div style="position:absolute;left:64.20px;top:104.95px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">51</span></div>
<div style="position:absolute;left:285.30px;top:104.95px" class="cls_009"><span class="cls_009">optional arguments, specifying  </span><span class="cls_010">291</span></div>
<div style="position:absolute;left:285.30px;top:116.41px" class="cls_009"><span class="cls_009">organizing  </span><span class="cls_010">286</span></div>
<div style="position:absolute;left:56.69px;top:121.15px" class="cls_041"><span class="cls_041">W</span></div>
<div style="position:absolute;left:285.30px;top:127.88px" class="cls_009"><span class="cls_009">overriding</span></div>
<div style="position:absolute;left:329.82px;top:127.88px" class="cls_010"><span class="cls_010">286</span></div>
<div style="position:absolute;left:56.69px;top:141.90px" class="cls_009"><span class="cls_009">web content management (WCM)</span></div>
<div style="position:absolute;left:285.30px;top:139.34px" class="cls_009"><span class="cls_009">rating, retrieving for whitepaper</span></div>
<div style="position:absolute;left:414.35px;top:139.34px" class="cls_010"><span class="cls_010">288</span></div>
<div style="position:absolute;left:285.30px;top:150.80px" class="cls_009"><span class="cls_009">URL pattern, selecting  </span><span class="cls_010">287</span></div>
<div style="position:absolute;left:64.20px;top:153.36px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">9</span><span class="cls_009">, </span><span class="cls_010">12</span></div>
<div style="position:absolute;left:64.20px;top:164.82px" class="cls_009"><span class="cls_009">content authoring tools  </span><span class="cls_010">12</span></div>
<div style="position:absolute;left:285.30px;top:162.26px" class="cls_009"><span class="cls_009">wiring, to UI widgets  </span><span class="cls_010">304</span></div>
<div style="position:absolute;left:285.30px;top:173.72px" class="cls_009"><span class="cls_009">writing, to list whitepapers</span></div>
<div style="position:absolute;left:393.34px;top:173.72px" class="cls_010"><span class="cls_010">275</span><span class="cls_009">, </span><span class="cls_010">279</span><span class="cls_009">, </span><span class="cls_010">281</span></div>
<div style="position:absolute;left:64.20px;top:176.29px" class="cls_009"><span class="cls_009">separation of presentation, from content  </span><span class="cls_010">13</span></div>
<div style="position:absolute;left:64.20px;top:187.74px" class="cls_009"><span class="cls_009">systematic publication or deployment  </span><span class="cls_010">14</span></div>
<div style="position:absolute;left:277.80px;top:185.18px" class="cls_009"><span class="cls_009">WebDAV  </span><span class="cls_010">11</span><span class="cls_009">, </span><span class="cls_010">22</span></div>
<div style="position:absolute;left:277.80px;top:196.64px" class="cls_009"><span class="cls_009">whitepaper  </span><span class="cls_010">77</span></div>
<div style="position:absolute;left:56.69px;top:199.21px" class="cls_009"><span class="cls_009">web script authentication</span></div>
<div style="position:absolute;left:64.20px;top:210.67px" class="cls_009"><span class="cls_009">dealing with  </span><span class="cls_010">317</span></div>
<div style="position:absolute;left:277.80px;top:208.10px" class="cls_009"><span class="cls_009">Whitepaper submission workflow</span></div>
<div style="position:absolute;left:285.30px;top:219.56px" class="cls_009"><span class="cls_009">logic, adding to</span></div>
<div style="position:absolute;left:350.84px;top:219.56px" class="cls_010"><span class="cls_010">367</span></div>
<div style="position:absolute;left:56.69px;top:222.13px" class="cls_009"><span class="cls_009">Web Script Beans</span></div>
<div style="position:absolute;left:64.20px;top:233.59px" class="cls_009"><span class="cls_009">correct ID, using for</span></div>
<div style="position:absolute;left:147.73px;top:233.59px" class="cls_010"><span class="cls_010">303</span></div>
<div style="position:absolute;left:277.80px;top:231.02px" class="cls_009"><span class="cls_009">widget</span></div>
<div style="position:absolute;left:285.30px;top:242.48px" class="cls_009"><span class="cls_009">used, for posting ratings  </span><span class="cls_010">305</span></div>
<div style="position:absolute;left:56.69px;top:245.05px" class="cls_009"><span class="cls_009">web script cache</span></div>
<div style="position:absolute;left:277.80px;top:253.94px" class="cls_009"><span class="cls_009">workflow initiator</span></div>
<div style="position:absolute;left:64.20px;top:256.51px" class="cls_009"><span class="cls_009">controlling</span></div>
<div style="position:absolute;left:110.22px;top:256.51px" class="cls_010"><span class="cls_010">318</span></div>
<div style="position:absolute;left:56.69px;top:267.97px" class="cls_009"><span class="cls_009">Web Script Framework</span></div>
<div style="position:absolute;left:285.30px;top:265.40px" class="cls_009"><span class="cls_009">enabling  </span><span class="cls_010">361</span></div>
<div style="position:absolute;left:277.80px;top:276.86px" class="cls_009"><span class="cls_009">workflow-specific content model  </span><span class="cls_010">347</span></div>
<div style="position:absolute;left:64.20px;top:279.43px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">263</span></div>
<div style="position:absolute;left:64.20px;top:290.89px" class="cls_009"><span class="cls_009">arguments, specifying  </span><span class="cls_010">269</span></div>
<div style="position:absolute;left:277.80px;top:288.32px" class="cls_009"><span class="cls_009">workflow</span></div>
<div style="position:absolute;left:285.30px;top:299.78px" class="cls_009"><span class="cls_009">about  </span><span class="cls_010">321</span></div>
<div style="position:absolute;left:64.20px;top:302.35px" class="cls_009"><span class="cls_009">configuring</span></div>
<div style="position:absolute;left:113.22px;top:302.35px" class="cls_010"><span class="cls_010">268</span></div>
<div style="position:absolute;left:64.20px;top:313.81px" class="cls_009"><span class="cls_009">controller logic, adding</span></div>
<div style="position:absolute;left:159.24px;top:313.81px" class="cls_010"><span class="cls_010">267</span></div>
<div style="position:absolute;left:285.30px;top:311.24px" class="cls_009"><span class="cls_009">debugging  </span><span class="cls_010">392</span></div>
<div style="position:absolute;left:285.30px;top:322.70px" class="cls_009"><span class="cls_009">logic, adding to</span></div>
<div style="position:absolute;left:350.84px;top:322.70px" class="cls_010"><span class="cls_010">365</span></div>
<div style="position:absolute;left:64.20px;top:325.27px" class="cls_009"><span class="cls_009">Hello World web script  </span><span class="cls_010">265</span></div>
<div style="position:absolute;left:64.20px;top:336.73px" class="cls_009"><span class="cls_009">HTTP method, sepcifying  </span><span class="cls_010">268</span></div>
<div style="position:absolute;left:285.30px;top:334.16px" class="cls_009"><span class="cls_009">options  </span><span class="cls_010">322</span></div>
<div style="position:absolute;left:277.80px;top:345.62px" class="cls_009"><span class="cls_009">WYSIWYG (What You See Is What You Get)  </span><span class="cls_010">13</span></div>
<div style="position:absolute;left:64.20px;top:348.19px" class="cls_009"><span class="cls_009">Model-View-Controller pattern, following  </span><span class="cls_010">266</span></div>
<div style="position:absolute;left:64.20px;top:359.65px" class="cls_009"><span class="cls_009">ratings API, planning  </span><span class="cls_010">272</span></div>
<div style="position:absolute;left:64.20px;top:371.11px" class="cls_009"><span class="cls_009">response format, specifying  </span><span class="cls_010">269</span></div>
<div style="position:absolute;left:277.80px;top:361.82px" class="cls_041"><span class="cls_041">X</span></div>
<div style="position:absolute;left:64.20px;top:382.57px" class="cls_009"><span class="cls_009">solutions, building with</span></div>
<div style="position:absolute;left:159.24px;top:382.57px" class="cls_010"><span class="cls_010">271</span></div>
<div style="position:absolute;left:277.80px;top:382.57px" class="cls_009"><span class="cls_009">XPath</span></div>
<div style="position:absolute;left:64.20px;top:394.03px" class="cls_009"><span class="cls_009">web scripts, deploying  </span><span class="cls_010">270</span></div>
<div style="position:absolute;left:285.30px;top:394.03px" class="cls_009"><span class="cls_009">reference  </span><span class="cls_010">285</span></div>
<div style="position:absolute;left:56.69px;top:405.49px" class="cls_009"><span class="cls_009">web scripts</span></div>
<div style="position:absolute;left:277.80px;top:405.49px" class="cls_009"><span class="cls_009">XSL FO  </span><span class="cls_010">23</span></div>
<div style="position:absolute;left:277.80px;top:416.95px" class="cls_009"><span class="cls_009">XSLT  </span><span class="cls_010">23</span></div>
</div>



</body></html>